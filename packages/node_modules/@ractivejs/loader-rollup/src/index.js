import { toParts, toModule, isComponentPath, replaceExtension } from '@ractivejs/utils-component'

export default function (options) {
  return {
    name: '@ractivejs/loader-rollup',
    transform: (content, id) => {
      if (!isComponentPath(id) || id.indexOf('commonjs-proxy:') !== -1) return null
      const parts = toParts(content)
      const source = id
      const file = replaceExtension(id, '.js')
      return toModule({ source, file, parts })
    }
  }
}
