{"version":3,"file":"runtime.min.js","sources":["../src/view/Fragment.js","../src/Ractive/prototype/reset.js","../src/Ractive/prototype/reverse.js","../src/Ractive/prototype/shift.js","../src/Ractive/prototype/sort.js","../src/Ractive/prototype/splice.js","../src/Ractive/prototype/unshift.js","../src/Ractive/prototype.js","../src/Ractive/static/styles.js","../src/extend/_extend.js","../src/Ractive.js","../src/utils/parseJSON.js","../src/view/items/component/Mapping.js","../src/view/items/element/specials/Option.js","../src/view/items/Partial.js","../src/model/specials/KeyModel.js","../src/view/RepeatedFragment.js","../src/view/items/Section.js","../src/view/items/element/specials/Select.js","../src/view/items/element/specials/Textarea.js","../src/view/items/Text.js","../src/config/visibility.js","../src/view/items/element/transitions/prefix.js","../src/view/items/element/transitions/createTransitions.js","../src/view/items/element/transitions/hyphenate.js","../src/view/items/element/Transition.js","../src/view/items/triple/insertHtml.js","../src/view/items/Triple.js","../src/view/items/createItem.js","../src/view/items/Component.js","../src/view/items/element/Decorator.js","../src/view/items/Doctype.js","../src/view/items/element/binding/Binding.js","../src/view/items/element/binding/CheckboxBinding.js","../src/view/items/element/binding/getBindingGroup.js","../src/view/items/element/binding/CheckboxNameBinding.js","../src/view/items/element/binding/ContentEditableBinding.js","../src/view/items/element/binding/GenericBinding.js","../src/view/items/element/binding/FileBinding.js","../src/view/items/element/binding/MultipleSelectBinding.js","../src/view/items/element/binding/NumericBinding.js","../src/view/items/element/binding/RadioBinding.js","../src/view/items/element/binding/RadioNameBinding.js","../src/view/items/element/binding/SingleSelectBinding.js","../src/view/items/Element.js","../src/view/items/element/specials/Form.js","../src/view/items/element/ElementEvents.js","../src/view/items/component/RactiveEvent.js","../src/view/items/shared/EventDirective.js","../src/view/items/shared/Mustache.js","../src/view/items/Interpolator.js","../src/view/items/element/specials/Input.js","../src/parse/Parser.js","../src/parse/converters/expressions/primary/literal/stringLiteral/makeQuotedStringMatcher.js","../src/parse/converters/expressions/primary/literal/readStringLiteral.js","../src/parse/converters/expressions/primary/literal/readNumberLiteral.js","../src/parse/converters/expressions/shared/patterns.js","../src/parse/converters/expressions/shared/readKey.js","../src/Ractive/prototype/observe/Observer.js","../src/Ractive/prototype/observe/Pattern.js","../src/Ractive/prototype/observe/Array.js","../src/Ractive/prototype/observeOnce.js","../src/Ractive/prototype/shared/trim.js","../src/Ractive/prototype/shared/notEmptyString.js","../src/Ractive/prototype/pop.js","../src/Ractive/prototype/push.js","../src/global/css.js","../src/Ractive/config/custom/adapt.js","../src/utils/cleanCss.js","../src/Ractive/config/custom/css/transform.js","../src/model/specials/CSSModel.js","../src/Ractive/config/custom/css/css.js","../src/Ractive/config/custom/data.js","../src/config/template.js","../src/Ractive/config/custom/template.js","../src/Ractive/config/registries.js","../src/Ractive/config/config.js","../src/view/items/shared/Item.js","../src/model/ComputationChild.js","../src/model/Computation.js","../src/view/resolvers/ExpressionProxy.js","../src/view/resolvers/ReferenceExpressionProxy.js","../src/view/items/Alias.js","../src/utils/html.js","../src/view/helpers/specialAttrs.js","../src/view/items/element/attribute/getUpdateDelegate.js","../src/view/items/element/attribute/propertyNames.js","../src/view/items/element/ConditionalAttribute.js","../src/view/items/element/Attribute.js","../src/view/items/element/BindingFlag.js","../src/view/items/Comment.js","../src/model/specials/RactiveModel.js","../src/model/RootModel.js","../src/Ractive/construct.js","../src/Ractive/static/sharedSet.js","../src/Ractive/static/sharedGet.js","../src/Ractive/static/use.js","../src/extend/_macro.js","../src/Ractive/static/keypaths.js","../src/Ractive/static/findPlugin.js","../src/polyfills/Object.assign.js","../src/utils/object.js","../src/utils/is.js","../src/polyfills/performance.now.js","../src/polyfills/array.find.js","../src/polyfills/node.contains.js","../src/polyfills/Promise.js","../src/polyfills/requestAnimationFrame.js","../src/Ractive/config/defaults.js","../src/utils/log.js","../src/Ractive/static/easing.js","../src/config/environment.js","../src/config/errors.js","../src/Ractive/static/interpolators.js","../src/shared/keypaths.js","../src/utils/bind.js","../src/model/ModelBase.js","../src/global/capture.js","../src/model/LinkModel.js","../src/shared/getFunction.js","../src/parse/_parse.js","../src/Ractive/config/runtime-parser.js","../src/global/TransitionManager.js","../src/global/runloop.js","../src/shared/Ticker.js","../src/model/helpers/getPrefixer.js","../src/model/Model.js","../src/model/specials/SharedModel.js","../src/view/resolvers/resolveReference.js","../src/shared/getRactiveContext.js","../src/shared/set.js","../src/Ractive/prototype/shared/add.js","../src/Ractive/prototype/animate.js","../src/events/fireEvent.js","../src/events/Hook.js","../src/config/types.js","../src/Ractive/prototype/shared/makeArrayMethod.js","../src/shared/Context.js","../src/Ractive/static/getContext.js","../src/utils/dom.js","../src/config/namespaces.js","../src/Ractive/config/wrapPrototypeMethod.js","../src/Ractive/config/deprecate.js","../src/view/resolvers/resolve.js","../src/utils/hyphenateCamel.js","../src/Ractive/prototype/teardown.js","../src/Ractive/helpers/subscribe.js","../src/view/items/shared/directiveArgs.js","../src/view/items/element/binding/handleDomEvent.js","../src/utils/getSelectedOptions.js","../src/view/items/element/binding/selectBinding.js","../src/view/items/shared/progressiveText.js","../src/view/items/partial/getPartialTemplate.js","../src/view/items/component/getComponentConstructor.js","../src/view/items/asyncProxy.js","../src/view/items/Await.js","../src/view/helpers/processItems.js","../src/Ractive/initialise.js","../src/Ractive/render.js","../src/Ractive/prototype/render.js","../src/Ractive/prototype/resetPartial.js","../src/Ractive/prototype/resetTemplate.js","../src/Ractive/prototype/set.js","../src/Ractive/prototype/subtract.js","../src/Ractive/prototype/toggle.js","../src/Ractive/prototype/toCSS.js","../src/Ractive/prototype/toHTML.js","../src/Ractive/prototype/toText.js","../src/Ractive/prototype/transition.js","../src/Ractive/prototype/unlink.js","../src/Ractive/prototype/unrender.js","../src/Ractive/prototype/updateModel.js","../src/Ractive/prototype/use.js","../src/Ractive/static/isInstance.js","../src/Ractive/static/styleGet.js","../src/utils/noop.js","../src/shared/registry.js","../src/shared/interpolate.js","../src/utils/array.js","../src/shared/methodCallers.js","../src/shared/rebind.js","../src/parse/utils/createFunction.js","../src/Ractive/helpers/getComputationSignature.js","../src/Ractive/prototype/add.js","../src/events/eventStack.js","../src/shared/anchors.js","../src/Ractive/prototype/attachChild.js","../src/Ractive/prototype/compute.js","../src/Ractive/prototype/detach.js","../src/Ractive/prototype/detachChild.js","../src/Ractive/prototype/find.js","../src/Ractive/prototype/findAll.js","../src/Ractive/prototype/findAllComponents.js","../src/Ractive/prototype/findComponent.js","../src/Ractive/prototype/findContainer.js","../src/Ractive/prototype/findParent.js","../src/view/items/shared/findElement.js","../src/shared/getNewIndices.js","../src/Ractive/prototype/update.js","../src/Ractive/prototype/fire.js","../src/Ractive/prototype/get.js","../src/Ractive/prototype/getContext.js","../src/Ractive/prototype/insert.js","../src/Ractive/prototype/link.js","../src/Ractive/prototype/observe.js","../src/Ractive/prototype/off.js","../src/Ractive/prototype/on.js","../src/Ractive/prototype/once.js","../src/Ractive/prototype/readLink.js","../src/utils/id.js","../src/Ractive/static/styleSet.js"],"sourcesContent":["import { ELEMENT, YIELDER } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport { findMap } from 'utils/array';\nimport { getContext, findParentWithContext } from 'shared/getRactiveContext';\nimport { shuffled, toEscapedString, toString } from 'shared/methodCallers';\nimport createItem from './items/createItem';\nimport processItems from './helpers/processItems';\nimport parseJSON from 'utils/parseJSON';\nimport { createDocumentFragment } from 'utils/dom';\nimport KeyModel from 'src/model/specials/KeyModel';\n\nexport default class Fragment {\n  constructor(options) {\n    this.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n    this.isRoot = !options.owner.up;\n    this.parent = this.isRoot ? null : this.owner.up;\n    this.ractive = options.ractive || (this.isRoot ? options.owner : this.parent.ractive);\n\n    this.componentParent = this.isRoot && this.ractive.component ? this.ractive.component.up : null;\n    if (!this.isRoot || this.ractive.delegate) {\n      this.delegate = this.owner.containerFragment\n        ? this.owner.containerFragment && this.owner.containerFragment.delegate\n        : (this.componentParent && this.componentParent.delegate) ||\n          (this.parent && this.parent.delegate);\n    } else {\n      this.delegate = false;\n    }\n\n    this.context = null;\n    this.rendered = false;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    if ('cssIds' in options) {\n      this.cssIds = options.cssIds && options.cssIds.length && options.cssIds;\n    } else {\n      this.cssIds = this.parent ? this.parent.cssIds : null;\n    }\n\n    this.dirty = false;\n    this.dirtyValue = true; // used for attribute values\n\n    this.template = options.template || [];\n    this.createItems();\n  }\n\n  bind(context) {\n    this.context = context;\n    const len = this.items.length;\n    for (let i = 0; i < len; i++) this.items[i].bind();\n    this.bound = true;\n\n    // in rare cases, a forced resolution (or similar) will cause the\n    // fragment to be dirty before it's even finished binding. In those\n    // cases we update immediately\n    if (this.dirty) this.update();\n\n    return this;\n  }\n\n  bubble() {\n    this.dirtyValue = true;\n\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.isRoot) {\n        // TODO encapsulate 'is component root, but not overall root' check?\n        if (this.ractive.component) {\n          this.ractive.component.bubble();\n        } else if (this.bound) {\n          runloop.addFragment(this);\n        }\n      } else {\n        this.owner.bubble(this.index);\n      }\n    }\n  }\n\n  createItems() {\n    // this is a hot code path\n    const max = this.template.length;\n    this.items = [];\n    for (let i = 0; i < max; i++) {\n      this.items[i] = createItem({\n        up: this,\n        template: this.template[i],\n        index: i\n      });\n    }\n  }\n\n  destroyed() {\n    const len = this.items.length;\n    for (let i = 0; i < len; i++) this.items[i].destroyed();\n    if (this.pathModel) this.pathModel.destroyed();\n    if (this.rootModel) this.rootModel.destroyed();\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      docFrag.appendChild(xs[i].detach());\n    }\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.items, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAll && i.findAll(selector, options));\n    }\n  }\n\n  findComponent(name, options) {\n    return findMap(this.items, i => i.findComponent(name, options));\n  }\n\n  findAllComponents(name, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAllComponents && i.findAllComponents(name, options));\n    }\n  }\n\n  findContext() {\n    const base = findParentWithContext(this);\n    if (!base || !base.context) return this.ractive.viewmodel;\n    else return base.context;\n  }\n\n  findNextNode(item) {\n    // search for the next node going forward\n    if (item) {\n      let it;\n      for (let i = item.index + 1; i < this.items.length; i++) {\n        it = this.items[i];\n        if (!it || !it.firstNode) continue;\n\n        const node = it.firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    // if this is the root fragment, and there are no more items,\n    // it means we're at the end...\n    if (this.isRoot) {\n      if (this.ractive.component) {\n        return this.ractive.component.up.findNextNode(this.ractive.component);\n      }\n\n      // TODO possible edge case with other content\n      // appended to this.ractive.el?\n      return null;\n    }\n\n    if (this.parent) return this.owner.findNextNode(this); // the argument is in case the parent is a RepeatedFragment\n  }\n\n  findParentNode() {\n    let fragment = this;\n\n    do {\n      if (fragment.owner.type === ELEMENT) {\n        return fragment.owner.node;\n      }\n\n      if (fragment.isRoot && !fragment.ractive.component) {\n        // TODO encapsulate check\n        return fragment.ractive.el;\n      }\n\n      if (fragment.owner.type === YIELDER) {\n        fragment = fragment.owner.containerFragment;\n      } else {\n        fragment = fragment.componentParent || fragment.parent; // TODO ugh\n      }\n    } while (fragment);\n\n    throw new Error('Could not find parent node'); // TODO link to issue tracker\n  }\n\n  firstNode(skipParent) {\n    const node = findMap(this.items, i => i.firstNode(true));\n    if (node) return node;\n    if (skipParent) return null;\n\n    return this.parent.findNextNode(this.owner);\n  }\n\n  getKey() {\n    return this.keyModel || (this.keyModel = new KeyModel(this.key));\n  }\n\n  getIndex() {\n    return this.idxModel || (this.idxModel = new KeyModel(this.index));\n  }\n\n  rebind(next) {\n    this.context = next;\n    if (this.rootModel) this.rootModel.context = this.context;\n    if (this.pathModel) this.pathModel.context = this.context;\n  }\n\n  rebound(update) {\n    this.items.forEach(x => x.rebound(update));\n    if (update) {\n      if (this.rootModel) this.rootModel.applyValue(this.context.getKeypath(this.ractive.root));\n      if (this.pathModel) this.pathModel.applyValue(this.context.getKeypath());\n    }\n  }\n\n  render(target, occupants) {\n    if (this.rendered) throw new Error('Fragment is already rendered!');\n    this.rendered = true;\n\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      xs[i].render(target, occupants);\n    }\n  }\n\n  resetTemplate(template) {\n    const wasBound = this.bound;\n    const wasRendered = this.rendered;\n\n    // TODO ensure transitions are disabled globally during reset\n\n    if (wasBound) {\n      if (wasRendered) this.unrender(true);\n      this.unbind();\n    }\n\n    this.template = template;\n    this.createItems();\n\n    if (wasBound) {\n      this.bind(this.context);\n\n      if (wasRendered) {\n        const parentNode = this.findParentNode();\n        const anchor = this.findNextNode();\n\n        if (anchor) {\n          const docFrag = createDocumentFragment();\n          this.render(docFrag);\n          parentNode.insertBefore(docFrag, anchor);\n        } else {\n          this.render(parentNode);\n        }\n      }\n    }\n  }\n\n  shuffled() {\n    this.items.forEach(shuffled);\n    if (this.rootModel) this.rootModel.applyValue(this.context.getKeypath(this.ractive.root));\n    if (this.pathModel) this.pathModel.applyValue(this.context.getKeypath());\n  }\n\n  toString(escape) {\n    return this.items.map(escape ? toEscapedString : toString).join('');\n  }\n\n  unbind() {\n    this.context = null;\n    const len = this.items.length;\n    for (let i = 0; i < len; i++) this.items[i].unbind();\n    this.bound = false;\n\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    const len = this.items.length;\n    for (let i = 0; i < len; i++) this.items[i].unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      if (!this.updating) {\n        this.dirty = false;\n        this.updating = true;\n        const len = this.items.length;\n        for (let i = 0; i < len; i++) this.items[i].update();\n        this.updating = false;\n      } else if (this.isRoot) {\n        runloop.addFragmentToRoot(this);\n      }\n    }\n  }\n\n  valueOf() {\n    if (this.items.length === 1) {\n      return this.items[0].valueOf();\n    }\n\n    if (this.dirtyValue) {\n      const values = {};\n      const source = processItems(this.items, values, this.ractive._guid);\n      const parsed = parseJSON(source, values);\n\n      this.value = parsed ? parsed.value : this.toString();\n\n      this.dirtyValue = false;\n    }\n\n    return this.value;\n  }\n}\nFragment.prototype.getContext = getContext;\nFragment.prototype.getKeypath = getKeypath;\n\nexport function getKeypath(root) {\n  const base = findParentWithContext(this);\n  let model;\n  if (root) {\n    if (!this.rootModel) {\n      this.rootModel = new KeyModel(\n        this.context.getKeypath(this.ractive.root),\n        this.context,\n        this.ractive.root\n      );\n      model = this.rootModel;\n    } else return this.rootModel;\n  } else {\n    if (!this.pathModel) {\n      this.pathModel = new KeyModel(this.context.getKeypath(), this.context);\n      model = this.pathModel;\n    } else return this.pathModel;\n  }\n\n  if (base && base.context) base.getKeypath(root).registerChild(model);\n\n  return model;\n}\n","import runloop from 'src/global/runloop';\nimport config from '../config/config';\nimport hooks from '../../events/Hook';\nimport dataConfigurator from '../config/custom/data';\nimport { isObjectType } from 'utils/is';\n\nconst shouldRerender = ['template', 'partials', 'components', 'decorators', 'events'];\n\nexport default function Ractive$reset(data) {\n  data = data || {};\n\n  if (!isObjectType(data)) {\n    throw new Error('The reset method takes either no arguments, or an object containing new data');\n  }\n\n  // TEMP need to tidy this up\n  data = dataConfigurator.init(this.constructor, this, { data });\n\n  const promise = runloop.start();\n\n  // If the root object is wrapped, try and use the wrapper's reset value\n  const wrapper = this.viewmodel.wrapper;\n  if (wrapper && wrapper.reset) {\n    if (wrapper.reset(data) === false) {\n      // reset was rejected, we need to replace the object\n      this.viewmodel.set(data);\n    }\n  } else {\n    this.viewmodel.set(data);\n  }\n\n  // reset config items and track if need to rerender\n  const changes = config.reset(this);\n  let rerender;\n\n  let i = changes.length;\n  while (i--) {\n    if (shouldRerender.indexOf(changes[i]) > -1) {\n      rerender = true;\n      break;\n    }\n  }\n\n  if (rerender) {\n    hooks.unrender.fire(this);\n    this.fragment.resetTemplate(this.template);\n    hooks.render.fire(this);\n    hooks.complete.fire(this);\n  }\n\n  runloop.end();\n\n  hooks.reset.fire(this, data);\n\n  return promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('reverse').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('shift').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('sort').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('splice').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('unshift').path;\n","import add from './prototype/add';\nimport animate from './prototype/animate';\nimport attachChild from './prototype/attachChild';\nimport compute from './prototype/compute';\nimport detach from './prototype/detach';\nimport detachChild from './prototype/detachChild';\nimport find from './prototype/find';\nimport findAll from './prototype/findAll';\nimport findAllComponents from './prototype/findAllComponents';\nimport findComponent from './prototype/findComponent';\nimport findContainer from './prototype/findContainer';\nimport findParent from './prototype/findParent';\nimport fire from './prototype/fire';\nimport get from './prototype/get';\nimport getContext from './prototype/getContext';\nimport insert from './prototype/insert';\nimport link from './prototype/link';\nimport observe from './prototype/observe';\nimport observeOnce from './prototype/observeOnce';\nimport off from './prototype/off';\nimport on from './prototype/on';\nimport once from './prototype/once';\nimport pop from './prototype/pop';\nimport push from './prototype/push';\nimport readLink from './prototype/readLink';\nimport render from './prototype/render';\nimport reset from './prototype/reset';\nimport resetPartial from './prototype/resetPartial';\nimport resetTemplate from './prototype/resetTemplate';\nimport reverse from './prototype/reverse';\nimport set from './prototype/set';\nimport shift from './prototype/shift';\nimport sort from './prototype/sort';\nimport splice from './prototype/splice';\nimport subtract from './prototype/subtract';\nimport teardown from './prototype/teardown';\nimport toggle from './prototype/toggle';\nimport toCSS from './prototype/toCSS';\nimport toHTML from './prototype/toHTML';\nimport toText from './prototype/toText';\nimport transition from './prototype/transition';\nimport unlink from './prototype/unlink';\nimport unrender from './prototype/unrender';\nimport unshift from './prototype/unshift';\nimport update from './prototype/update';\nimport updateModel from './prototype/updateModel';\nimport use from './prototype/use';\n\nconst proto = {\n  add,\n  animate,\n  attachChild,\n  compute,\n  detach,\n  detachChild,\n  find,\n  findAll,\n  findAllComponents,\n  findComponent,\n  findContainer,\n  findParent,\n  fire,\n  get,\n  getContext,\n  insert,\n  link,\n  observe,\n  observeOnce,\n  off,\n  on,\n  once,\n  pop,\n  push,\n  readLink,\n  render,\n  reset,\n  resetPartial,\n  resetTemplate,\n  reverse,\n  set,\n  shift,\n  sort,\n  splice,\n  subtract,\n  teardown,\n  toggle,\n  toCSS,\n  toCss: toCSS,\n  toHTML,\n  toHtml: toHTML,\n  toText,\n  transition,\n  unlink,\n  unrender,\n  unshift,\n  update,\n  updateModel,\n  use\n};\n\nexport default proto;\n","import { isFunction } from 'utils/is';\nimport { addCSS, applyCSS } from 'src/global/css';\nimport { recomputeCSS } from './styleSet';\n\nconst styles = [];\n\nexport function addStyle(id, css) {\n  if (styles.find(s => s.id === id))\n    throw new Error(`Extra styles with the id '${id}' have already been added.`);\n  styles.push({ id, css });\n\n  if (!this.css) {\n    Object.defineProperty(this, 'css', { configurable: false, writable: false, value: buildCSS });\n  }\n\n  if (!this._cssDef) {\n    Object.defineProperty(this, '_cssDef', {\n      configurable: true,\n      writable: false,\n      value: {\n        transform: false,\n        id: 'Ractive.addStyle'\n      }\n    });\n\n    addCSS(this._cssDef);\n  }\n\n  recomputeCSS(this);\n  applyCSS(true);\n}\n\nfunction buildCSS(data) {\n  return styles\n    .map(s => `\\n/* ---- extra style ${s.id} */\\n` + (isFunction(s.css) ? s.css(data) : s.css))\n    .join('');\n}\n\nexport function hasStyle(id) {\n  return !!styles.find(s => s.id === id);\n}\n","import config from '../Ractive/config/config';\nimport dataConfigurator from '../Ractive/config/custom/data';\nimport construct from '../Ractive/construct';\nimport initialise from '../Ractive/initialise';\nimport Ractive from '../Ractive';\nimport isInstance from '../Ractive/static/isInstance';\nimport styleSet from '../Ractive/static/styleSet';\nimport styleGet from '../Ractive/static/styleGet';\nimport { addStyle, hasStyle } from '../Ractive/static/styles';\nimport sharedSet from '../Ractive/static/sharedSet';\nimport sharedGet from '../Ractive/static/sharedGet';\nimport use from '../Ractive/static/use';\nimport { create, defineProperties, toPairs, defineProperty } from 'utils/object';\nimport { isArray, isFunction } from 'utils/is';\n\nconst callsSuper = /super\\s*\\(|\\.call\\s*\\(\\s*this/;\n\nexport function extend(...options) {\n  if (!options.length) {\n    return extendOne(this);\n  } else {\n    return options.reduce(extendOne, this);\n  }\n}\n\nexport function extendWith(Class, options = {}) {\n  return extendOne(this, options, Class);\n}\n\nfunction extendOne(Parent, options = {}, Target) {\n  let proto;\n  let Child = isFunction(Target) && Target;\n\n  if (options.prototype instanceof Ractive) {\n    throw new Error(`Ractive no longer supports multiple inheritance.`);\n  }\n\n  if (Child) {\n    if (!(Child.prototype instanceof Parent)) {\n      throw new Error(\n        `Only classes that inherit the appropriate prototype may be used with extend`\n      );\n    }\n    if (!callsSuper.test(Child.toString())) {\n      throw new Error(`Only classes that call super in their constructor may be used with extend`);\n    }\n\n    proto = Child.prototype;\n  } else {\n    Child = function(options) {\n      if (!(this instanceof Child)) return new Child(options);\n\n      construct(this, options || {});\n      initialise(this, options || {}, {});\n    };\n\n    proto = create(Parent.prototype);\n    proto.constructor = Child;\n\n    Child.prototype = proto;\n  }\n\n  // Static properties\n  defineProperties(Child, {\n    // alias prototype as defaults\n    defaults: { value: proto },\n\n    extend: { value: extend, writable: true, configurable: true },\n    extendWith: { value: extendWith, writable: true, configurable: true },\n    extensions: { value: [] },\n    use: { value: use },\n\n    isInstance: { value: isInstance },\n\n    Parent: { value: Parent },\n    Ractive: { value: Ractive },\n\n    styleGet: { value: styleGet.bind(Child), configurable: true },\n    styleSet: { value: styleSet.bind(Child), configurable: true }\n  });\n\n  // extend configuration\n  config.extend(Parent, proto, options, Child);\n\n  // store event and observer registries on the constructor when extending\n  Child._on = (Parent._on || []).concat(toPairs(options.on));\n  Child._observe = (Parent._observe || []).concat(toPairs(options.observe));\n\n  Parent.extensions.push(Child);\n\n  // attribute defs are not inherited, but they need to be stored\n  if (options.attributes) {\n    let attrs;\n\n    // allow an array of optional props or an object with arrays for optional and required props\n    if (isArray(options.attributes)) {\n      attrs = { optional: options.attributes, required: [] };\n    } else {\n      attrs = options.attributes;\n    }\n\n    // make sure the requisite keys actually store arrays\n    if (!isArray(attrs.required)) attrs.required = [];\n    if (!isArray(attrs.optional)) attrs.optional = [];\n\n    Child.attributes = attrs;\n  }\n\n  dataConfigurator.extend(Parent, proto, options, Child);\n\n  defineProperty(Child, 'helpers', { writable: true, value: proto.helpers });\n\n  if (isArray(options.use)) Child.use.apply(Child, options.use);\n\n  return Child;\n}\n\ndefineProperties(Ractive, {\n  sharedGet: { value: sharedGet },\n  sharedSet: { value: sharedSet },\n  styleGet: { configurable: true, value: styleGet.bind(Ractive) },\n  styleSet: { configurable: true, value: styleSet.bind(Ractive) },\n  addCSS: { configurable: false, value: addStyle.bind(Ractive) },\n  hasCSS: { configurable: false, value: hasStyle.bind(Ractive) }\n});\n","import './polyfills/Object.assign';\nimport './polyfills/array.find';\nimport './polyfills/node.contains';\nimport './polyfills/performance.now';\nimport './polyfills/Promise';\nimport './polyfills/requestAnimationFrame';\n\nimport defaults from './Ractive/config/defaults';\nimport easing from './Ractive/static/easing';\nimport interpolators from './Ractive/static/interpolators';\nimport { svg, win } from './config/environment';\nimport proto from './Ractive/prototype';\nimport { extend, extendWith } from './extend/_extend';\nimport macro from './extend/_macro';\nimport parse from './parse/_parse';\nimport getContext from './Ractive/static/getContext';\nimport isInstance from './Ractive/static/isInstance';\nimport use from './Ractive/static/use';\nimport construct from './Ractive/construct';\nimport initialise from './Ractive/initialise';\nimport { getCSS } from './global/css';\nimport { escapeKey, unescapeKey, normalise } from './shared/keypaths';\nimport { joinKeys, splitKeypath } from './Ractive/static/keypaths';\nimport shared from './Ractive/shared';\nimport { findPlugin } from './Ractive/static/findPlugin';\nimport parseJSON from './utils/parseJSON';\nimport CSSModel from './model/specials/CSSModel';\nimport { data as sharedData } from './model/specials/SharedModel';\nimport { extern } from './shared/getRactiveContext';\nimport { warn } from 'utils/log';\n\nimport { assign, defineProperty, defineProperties } from 'utils/object';\n\nexport default function Ractive(options) {\n  if (!(this instanceof Ractive)) return new Ractive(options);\n\n  construct(this, options || {});\n  initialise(this, options || {}, {});\n}\n\n// check to see if we're being asked to force Ractive as a global for some weird environments\nif (win && !win.Ractive) {\n  let opts = '';\n  const script =\n    document.currentScript ||\n    /* istanbul ignore next */ document.querySelector('script[data-ractive-options]');\n\n  if (script) opts = script.getAttribute('data-ractive-options') || '';\n\n  /* istanbul ignore next */\n  if (~opts.indexOf('ForceGlobal')) win.Ractive = Ractive;\n} else if (win) {\n  warn(`Ractive already appears to be loaded while loading BUILD_PLACEHOLDER_VERSION.`);\n}\n\nassign(Ractive.prototype, proto, defaults);\nRactive.prototype.constructor = Ractive;\n\n// alias prototype as `defaults`\nRactive.defaults = Ractive.prototype;\n\n// share defaults with the parser\nshared.defaults = Ractive.defaults;\nshared.Ractive = Ractive;\n\n// static properties\ndefineProperties(Ractive, {\n  // debug flag\n  DEBUG: { writable: true, value: true },\n  DEBUG_PROMISES: { writable: true, value: true },\n\n  // static methods:\n  extend: { value: extend },\n  extendWith: { value: extendWith },\n  escapeKey: { value: escapeKey },\n  evalObjectString: { value: parseJSON },\n  findPlugin: { value: findPlugin },\n  getContext: { value: getContext },\n  getCSS: { value: getCSS },\n  isInstance: { value: isInstance },\n  joinKeys: { value: joinKeys },\n  macro: { value: macro },\n  normaliseKeypath: { value: normalise },\n  parse: { value: parse },\n  splitKeypath: { value: splitKeypath },\n  // sharedSet and styleSet are in _extend because circular refs\n  unescapeKey: { value: unescapeKey },\n  use: { value: use },\n\n  // support\n  enhance: { writable: true, value: false },\n  svg: { value: svg },\n\n  // version\n  VERSION: { value: 'BUILD_PLACEHOLDER_VERSION' },\n\n  // plugins\n  adaptors: { writable: true, value: {} },\n  components: { writable: true, value: {} },\n  decorators: { writable: true, value: {} },\n  easing: { writable: true, value: easing },\n  events: { writable: true, value: {} },\n  extensions: { value: [] },\n  helpers: { writable: true, value: defaults.helpers },\n  interpolators: { writable: true, value: interpolators },\n  partials: { writable: true, value: {} },\n  transitions: { writable: true, value: {} },\n\n  // CSS variables\n  cssData: { configurable: true, value: {} },\n\n  // access to @shared without an instance\n  sharedData: { value: sharedData },\n\n  // for getting the source Ractive lib from a constructor\n  Ractive: { value: Ractive },\n\n  // to allow extending contexts\n  Context: { value: extern.Context.prototype }\n});\n\n// cssData must already be in place\ndefineProperty(Ractive, '_cssModel', {\n  configurable: true,\n  value: new CSSModel(Ractive)\n});\n\ndefineProperty(Ractive.prototype, 'rendered', {\n  get() {\n    return this.fragment && this.fragment.rendered;\n  }\n});\n","import Parser from 'parse/Parser';\nimport readStringLiteral from 'parse/converters/expressions/primary/literal/readStringLiteral';\nimport readKey from 'parse/converters/expressions/shared/readKey';\nimport { hasOwn, keys } from 'utils/object';\n\n// simple JSON parser, without the restrictions of JSON parse\n// (i.e. having to double-quote keys).\n//\n// If passed a hash of values as the second argument, ${placeholders}\n// will be replaced with those values\n\nconst specials = {\n  true: true,\n  false: false,\n  null: null,\n  undefined\n};\n\nconst specialsPattern = new RegExp('^(?:' + keys(specials).join('|') + ')');\nconst numberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\nconst placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\nconst placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\nconst onlyWhitespace = /^\\s*$/;\n\nconst JsonParser = Parser.extend({\n  init(str, options) {\n    this.values = options.values;\n    this.sp();\n  },\n\n  postProcess(result) {\n    if (result.length !== 1 || !onlyWhitespace.test(this.leftover)) {\n      return null;\n    }\n\n    return { value: result[0].v };\n  },\n\n  converters: [\n    function getPlaceholder(parser) {\n      if (!parser.values) return null;\n\n      const placeholder = parser.matchPattern(placeholderAtStartPattern);\n\n      if (placeholder && hasOwn(parser.values, placeholder)) {\n        return { v: parser.values[placeholder] };\n      }\n    },\n\n    function getSpecial(parser) {\n      const special = parser.matchPattern(specialsPattern);\n      if (special) return { v: specials[special] };\n    },\n\n    function getNumber(parser) {\n      const number = parser.matchPattern(numberPattern);\n      if (number) return { v: +number };\n    },\n\n    function getString(parser) {\n      const stringLiteral = readStringLiteral(parser);\n      const values = parser.values;\n\n      if (stringLiteral && values) {\n        return {\n          v: stringLiteral.v.replace(\n            placeholderPattern,\n            (match, $1) => ($1 in values ? values[$1] : $1)\n          )\n        };\n      }\n\n      return stringLiteral;\n    },\n\n    function getObject(parser) {\n      if (!parser.matchString('{')) return null;\n\n      const result = {};\n\n      parser.sp();\n\n      if (parser.matchString('}')) {\n        return { v: result };\n      }\n\n      let pair;\n      while ((pair = getKeyValuePair(parser))) {\n        result[pair.key] = pair.value;\n\n        parser.sp();\n\n        if (parser.matchString('}')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n      }\n\n      return null;\n    },\n\n    function getArray(parser) {\n      if (!parser.matchString('[')) return null;\n\n      const result = [];\n\n      parser.sp();\n\n      if (parser.matchString(']')) {\n        return { v: result };\n      }\n\n      let valueToken;\n      while ((valueToken = parser.read())) {\n        result.push(valueToken.v);\n\n        parser.sp();\n\n        if (parser.matchString(']')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n\n        parser.sp();\n      }\n\n      return null;\n    }\n  ]\n});\n\nfunction getKeyValuePair(parser) {\n  parser.sp();\n\n  const key = readKey(parser);\n\n  if (!key) return null;\n\n  const pair = { key };\n\n  parser.sp();\n  if (!parser.matchString(':')) {\n    return null;\n  }\n  parser.sp();\n\n  const valueToken = parser.read();\n\n  if (!valueToken) return null;\n\n  pair.value = valueToken.v;\n  return pair;\n}\n\nexport default function(str, values) {\n  const parser = new JsonParser(str, { values });\n  return parser.result;\n}\n","import { INTERPOLATOR } from '../../../config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport parseJSON from '../../../utils/parseJSON';\nimport resolve from '../../resolvers/resolve';\nimport runloop from '../../../global/runloop';\nimport { warnIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isArray, isObjectType, isString } from 'utils/is';\n\nexport default class Mapping extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = this.element.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.element.attributeByName[this.name] = this;\n\n    this.value = options.template.f;\n  }\n\n  bind() {\n    const template = this.template.f;\n    const viewmodel = this.element.instance.viewmodel;\n\n    if (template === 0) {\n      // empty attributes are `true`\n      viewmodel.joinKey(this.name).set(true);\n    } else if (isString(template)) {\n      const parsed = parseJSON(template);\n      viewmodel.joinKey(this.name).set(parsed ? parsed.value : template);\n    } else if (isArray(template)) {\n      createMapping(this, true);\n    }\n  }\n\n  rebound(update) {\n    if (this.boundFragment) this.boundFragment.rebound(update);\n    if (this.link) {\n      this.model = resolve(this.up, this.template.f[0]);\n      const model = this.element.instance.viewmodel.joinAll(splitKeypath(this.name));\n      model.link(this.model, this.name, { mapping: true });\n    }\n  }\n\n  render() {}\n\n  unbind() {\n    if (this.model) this.model.unregister(this);\n    if (this.boundFragment) this.boundFragment.unbind();\n\n    if (this.element.bound) {\n      if (this.link.target === this.model) this.link.owner.unlink();\n    }\n  }\n\n  unrender() {}\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.boundFragment) this.boundFragment.update();\n    }\n  }\n}\n\nfunction createMapping(item) {\n  const template = item.template.f;\n  const viewmodel = item.element.instance.viewmodel;\n  const childData = viewmodel.value;\n\n  if (template.length === 1 && template[0].t === INTERPOLATOR) {\n    const model = resolve(item.up, template[0]);\n    const val = model.get(false);\n\n    // if the interpolator is not static\n    if (!template[0].s) {\n      item.model = model;\n      item.link = viewmodel.createLink(item.name, model, template[0].r, {\n        mapping: true\n      });\n\n      // initialize parent side of the mapping from child data\n      if (val === undefined && !model.isReadonly && item.name in childData) {\n        model.set(childData[item.name]);\n      }\n    } else if (!isObjectType(val) || template[0].x) {\n      // copy non-object, non-computed vals through\n      viewmodel.joinKey(splitKeypath(item.name)).set(val);\n    } else {\n      // warn about trying to copy an object\n      warnIfDebug(`Cannot copy non-computed object value from static mapping '${item.name}'`);\n    }\n\n    // if the item isn't going to manage the model, give it a change to tear down if it's computed\n    if (model !== item.model) model.unregister();\n  } else {\n    item.boundFragment = new Fragment({\n      owner: item,\n      template\n    }).bind();\n\n    item.model = viewmodel.joinKey(splitKeypath(item.name));\n    item.model.set(item.boundFragment.valueOf());\n\n    // item is a *bit* of a hack\n    item.boundFragment.bubble = () => {\n      Fragment.prototype.bubble.call(item.boundFragment);\n      // defer this to avoid mucking around model deps if there happens to be an expression involved\n      runloop.scheduleTask(() => {\n        item.boundFragment.update();\n        item.model.set(item.boundFragment.valueOf());\n      });\n    };\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport Element from '../../Element';\nimport findElement from '../../shared/findElement';\nimport { isArray } from 'utils/is';\n\nexport default class Option extends Element {\n  constructor(options) {\n    const template = options.template;\n    if (!template.a) template.a = {};\n\n    // If the value attribute is missing, use the element's content,\n    // as long as it isn't disabled\n    if (template.a.value === undefined && !('disabled' in template.a)) {\n      template.a.value = template.f || '';\n    }\n\n    super(options);\n\n    this.select = findElement(this.parent || this.up, false, 'select');\n  }\n\n  bind() {\n    if (!this.select) {\n      super.bind();\n      return;\n    }\n\n    // If the select has a value, it overrides the `selected` attribute on\n    // this option - so we delete the attribute\n    const selectedAttribute = this.attributeByName.selected;\n    if (selectedAttribute && this.select.getAttribute('value') !== undefined) {\n      const index = this.attributes.indexOf(selectedAttribute);\n      this.attributes.splice(index, 1);\n      delete this.attributeByName.selected;\n    }\n\n    super.bind();\n    this.select.options.push(this);\n  }\n\n  bubble() {\n    // if we're using content as value, may need to update here\n    const value = this.getAttribute('value');\n    if (this.node && this.node.value !== value) {\n      this.node._ractive.value = value;\n    }\n    super.bubble();\n  }\n\n  getAttribute(name) {\n    const attribute = this.attributeByName[name];\n    return attribute\n      ? attribute.getValue()\n      : name === 'value' && this.fragment\n        ? this.fragment.valueOf()\n        : undefined;\n  }\n\n  isSelected() {\n    const optionValue = this.getAttribute('value');\n\n    if (optionValue === undefined || !this.select) {\n      return false;\n    }\n\n    const selectValue = this.select.getAttribute('value');\n\n    if (this.select.compare(selectValue, optionValue)) {\n      return true;\n    }\n\n    if (this.select.getAttribute('multiple') && isArray(selectValue)) {\n      let i = selectValue.length;\n      while (i--) {\n        if (this.select.compare(selectValue[i], optionValue)) {\n          return true;\n        }\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n\n    if (!this.attributeByName.value) {\n      this.node._ractive.value = this.getAttribute('value');\n    }\n  }\n\n  unbind() {\n    super.unbind();\n\n    if (this.select) {\n      removeFromArray(this.select.options, this);\n    }\n  }\n}\n","import { ELEMENT, PARTIAL, SECTION, SECTION_WITH, YIELDER } from 'config/types';\nimport { assign, create, hasOwn, keys } from 'utils/object';\nimport { isArray, isFunction, isObjectType, isString } from 'utils/is';\nimport noop from 'utils/noop';\nimport { MustacheContainer } from './shared/Mustache';\nimport Fragment from '../Fragment';\nimport getPartialTemplate from './partial/getPartialTemplate';\nimport { resolveAliases } from './Alias';\nimport { warnOnceIfDebug, warnIfDebug } from 'utils/log';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport runloop from 'src/global/runloop';\nimport { applyCSS } from 'src/global/css';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function Partial(options) {\n  MustacheContainer.call(this, options);\n\n  const tpl = options.template;\n\n  // yielder is a special form of partial that will later require special handling\n  if (tpl.t === YIELDER) {\n    this.yielder = 1;\n  } else if (tpl.t === ELEMENT) {\n    // this is a macro partial, complete with macro constructor\n    // leaving this as an element will confuse up-template searches\n    this.type = PARTIAL;\n    this.macro = options.macro;\n  }\n}\n\nconst proto = (Partial.prototype = create(MustacheContainer.prototype));\n\nassign(proto, {\n  constructor: Partial,\n\n  bind() {\n    const template = this.template;\n\n    if (this.yielder) {\n      // the container is the instance that owns this node\n      this.container = this.up.ractive;\n      this.component = this.container.component;\n      this.containerFragment = this.up;\n\n      // normal component\n      if (this.component) {\n        // yields skip the owning instance and go straight to the surrounding context\n        this.up = this.component.up;\n\n        // {{yield}} is equivalent to {{yield content}}\n        if (!template.r && !template.x && !template.tx) this.refName = 'content';\n      } else {\n        // plain-ish instance that may be attached to a parent later\n        this.fragment = new Fragment({\n          owner: this,\n          template: []\n        });\n        this.fragment.bind();\n        return;\n      }\n    }\n\n    // this is a macro/super partial\n    if (this.macro) {\n      this.fn = this.macro;\n    } else {\n      // this is a plain partial or yielder\n      if (!this.refName) this.refName = template.r;\n\n      // if the refName exists as a partial, this is a plain old partial reference where no model binding will happen\n      if (this.refName) {\n        partialFromValue(this, this.refName);\n      }\n\n      // this is a dynamic/inline partial\n      if (!this.partial && !this.fn) {\n        MustacheContainer.prototype.bind.call(this);\n        if (this.model) partialFromValue(this, this.model.get());\n      }\n    }\n\n    if (!this.partial && !this.fn) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    createFragment(this, this.partial || []);\n\n    // macro/super partial\n    if (this.fn) initMacro(this);\n\n    this.fragment.bind();\n  },\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.yielder) {\n        this.containerFragment.bubble();\n      } else {\n        this.up.bubble();\n      }\n    }\n  },\n\n  findNextNode() {\n    return (this.containerFragment || this.up).findNextNode(this);\n  },\n\n  handleChange() {\n    this.dirtyTemplate = true;\n    this.externalChange = true;\n    this.bubble();\n  },\n\n  rebound(update) {\n    const aliases = this.fragment && this.fragment.aliases;\n    if (aliases) {\n      for (const k in aliases) {\n        if (aliases[k].rebound) aliases[k].rebound(update);\n        else {\n          aliases[k].unreference();\n          aliases[k] = 0;\n        }\n      }\n      if (this.template.z) {\n        resolveAliases(this.template.z, this.containerFragment || this.up, aliases);\n      }\n    }\n    if (this._attrs) {\n      keys(this._attrs).forEach(k => this._attrs[k].rebound(update));\n    }\n    MustacheContainer.prototype.rebound.call(this, update);\n  },\n\n  refreshAttrs() {\n    keys(this._attrs).forEach(k => {\n      this.handle.attributes[k] = !this._attrs[k].items.length || this._attrs[k].valueOf();\n    });\n  },\n\n  resetTemplate() {\n    if (this.fn && this.proxy) {\n      if (this.externalChange) {\n        if (isFunction(this.proxy.teardown)) this.proxy.teardown();\n        this.fn = this.proxy = null;\n      } else {\n        this.partial = this.fnTemplate;\n        return true;\n      }\n    }\n\n    const partial = this.partial;\n    this.partial = null;\n\n    if (this.refName) {\n      this.partial = getPartialTemplate(this.ractive, this.refName, this.up);\n    }\n\n    if (!this.partial && this.model) {\n      partialFromValue(this, this.model.get());\n    }\n\n    if (!this.fn && partial === this.partial) return false;\n\n    this.unbindAttrs();\n\n    if (this.fn) {\n      initMacro(this);\n      if (isFunction(this.proxy.render)) runloop.scheduleTask(() => this.proxy.render());\n    } else if (!this.partial) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    return true;\n  },\n\n  render(target, occupants) {\n    if (this.fn && this.fn._cssDef && !this.fn._cssDef.applied) applyCSS();\n\n    this.fragment.render(target, occupants);\n\n    if (this.proxy && isFunction(this.proxy.render)) this.proxy.render();\n  },\n\n  unbind() {\n    this.fragment.unbind();\n\n    this.fragment.aliases = null;\n\n    this.unbindAttrs();\n\n    MustacheContainer.prototype.unbind.call(this);\n  },\n\n  unbindAttrs() {\n    if (this._attrs) {\n      keys(this._attrs).forEach(k => {\n        this._attrs[k].unbind();\n      });\n    }\n  },\n\n  unrender(shouldDestroy) {\n    if (this.proxy && isFunction(this.proxy.teardown)) this.proxy.teardown();\n\n    this.fragment.unrender(shouldDestroy);\n  },\n\n  update() {\n    const proxy = this.proxy;\n    this.updating = 1;\n\n    if (this.dirtyAttrs) {\n      this.dirtyAttrs = false;\n      keys(this._attrs).forEach(k => this._attrs[k].update());\n      this.refreshAttrs();\n      if (isFunction(proxy.update)) proxy.update(this.handle.attributes);\n    }\n\n    if (this.dirtyTemplate) {\n      this.dirtyTemplate = false;\n      this.resetTemplate() && this.fragment.resetTemplate(this.partial || []);\n    }\n\n    if (this.dirty) {\n      this.dirty = false;\n      if (proxy && isFunction(proxy.invalidate)) proxy.invalidate();\n      this.fragment.update();\n    }\n\n    this.externalChange = false;\n    this.updating = 0;\n  }\n});\n\nfunction createFragment(self, partial) {\n  self.partial = partial;\n  contextifyTemplate(self);\n\n  const options = {\n    owner: self,\n    template: self.partial\n  };\n\n  if (self.yielder) options.ractive = self.container.parent;\n\n  if (self.fn) options.cssIds = self.fn._cssIds;\n\n  const fragment = (self.fragment = new Fragment(options));\n\n  // partials may have aliases that need to be in place before binding\n  if (self.template.z) {\n    fragment.aliases = resolveAliases(self.template.z, self.containerFragment || self.up);\n  }\n}\n\nfunction contextifyTemplate(self) {\n  if (self.template.c) {\n    self.partial = [{ t: SECTION, n: SECTION_WITH, f: self.partial }];\n    assign(self.partial[0], self.template.c);\n    if (self.yielder) self.partial[0].y = self;\n  }\n}\n\nfunction partialFromValue(self, value, okToParse) {\n  let tpl = value;\n\n  if (isArray(tpl)) {\n    self.partial = tpl;\n  } else if (tpl && isObjectType(tpl)) {\n    if (isArray(tpl.t)) self.partial = tpl.t;\n    else if (isString(tpl.template))\n      self.partial = parsePartial(tpl.template, tpl.template, self.ractive).t;\n  } else if (isFunction(tpl) && tpl.styleSet) {\n    self.fn = tpl;\n    if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n  } else if (tpl != null) {\n    tpl = getPartialTemplate(self.ractive, '' + tpl, self.containerFragment || self.up);\n    if (tpl) {\n      self.name = value;\n      if (tpl.styleSet) {\n        self.fn = tpl;\n        if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n      } else self.partial = tpl;\n    } else if (okToParse) {\n      self.partial = parsePartial('' + value, '' + value, self.ractive).t;\n    } else {\n      self.name = value;\n    }\n  }\n\n  return self.partial;\n}\n\nfunction setTemplate(template) {\n  partialFromValue(this, template, true);\n\n  if (!this.initing) {\n    this.dirtyTemplate = true;\n    this.fnTemplate = this.partial;\n\n    if (this.updating) {\n      this.bubble();\n      runloop.promise();\n    } else {\n      const promise = runloop.start();\n\n      this.bubble();\n      runloop.end();\n\n      return promise;\n    }\n  }\n}\n\nfunction aliasLocal(ref, name) {\n  const aliases = this.fragment.aliases || (this.fragment.aliases = {});\n  if (!name) {\n    aliases[ref] = this._data;\n  } else {\n    aliases[name] = this._data.joinAll(splitKeypath(ref));\n  }\n}\n\nconst extras = 'extra-attributes';\n\nfunction initMacro(self) {\n  const fn = self.fn;\n  const fragment = self.fragment;\n\n  // defensively copy the template in case it changes\n  const template = (self.template = assign({}, self.template));\n  const handle = (self.handle = fragment.getContext({\n    proxy: self,\n    aliasLocal,\n    name: self.template.e || self.name,\n    attributes: {},\n    setTemplate: setTemplate.bind(self),\n    template\n  }));\n\n  if (!template.p) template.p = {};\n  template.p = handle.partials = assign({}, template.p);\n  if (!hasOwn(template.p, 'content')) template.p.content = template.f || [];\n\n  if (isArray(fn.attributes)) {\n    self._attrs = {};\n\n    const invalidate = function() {\n      this.dirty = true;\n      self.dirtyAttrs = true;\n      self.bubble();\n    };\n\n    if (isArray(template.m)) {\n      const attrs = template.m;\n      template.p[extras] = template.m = attrs.filter(a => !~fn.attributes.indexOf(a.n));\n      attrs.filter(a => ~fn.attributes.indexOf(a.n)).forEach(a => {\n        const fragment = new Fragment({\n          template: a.f,\n          owner: self\n        });\n        fragment.bubble = invalidate;\n        fragment.findFirstNode = noop;\n        self._attrs[a.n] = fragment;\n      });\n    } else {\n      template.p[extras] = [];\n    }\n  } else {\n    template.p[extras] = template.m;\n  }\n\n  if (self._attrs) {\n    keys(self._attrs).forEach(k => {\n      self._attrs[k].bind();\n    });\n    self.refreshAttrs();\n  }\n\n  self.initing = 1;\n  self.proxy = fn(handle, handle.attributes) || {};\n  if (!self.partial) self.partial = [];\n  self.fnTemplate = self.partial;\n  self.initing = 0;\n\n  contextifyTemplate(self);\n  fragment.resetTemplate(self.partial);\n}\n\nfunction parsePartial(name, partial, ractive) {\n  let parsed;\n\n  try {\n    parsed = parser.parse(partial, parser.getParseOptions(ractive));\n  } catch (e) {\n    warnIfDebug(`Could not parse partial from expression '${name}'\\n${e.message}`);\n  }\n\n  return parsed || { t: [] };\n}\n","import { addToArray, removeFromArray } from 'utils/array';\nimport { unescapeKey } from 'shared/keypaths';\nimport { capture } from 'src/global/capture';\nimport { handleChange } from 'src/shared/methodCallers';\nimport noop from 'utils/noop';\n\nexport default class KeyModel {\n  constructor(value, context, instance) {\n    this.value = this.key = value;\n    this.context = context;\n    this.isReadonly = this.isKey = true;\n    this.deps = [];\n    this.links = [];\n    this.children = [];\n    this.instance = instance;\n  }\n\n  applyValue(value) {\n    if (value !== this.value) {\n      this.value = this.key = value;\n      this.deps.forEach(handleChange);\n      this.links.forEach(handleChange);\n      this.children.forEach(c => {\n        c.applyValue(c.context.getKeypath(c.instance));\n      });\n    }\n  }\n\n  destroyed() {\n    if (this.upstream) this.upstream.unregisterChild(this);\n  }\n\n  get(shouldCapture) {\n    if (shouldCapture) capture(this);\n    return unescapeKey(this.value);\n  }\n\n  getKeypath() {\n    return unescapeKey(this.value);\n  }\n\n  has() {\n    return false;\n  }\n\n  rebind(next, previous) {\n    let i = this.deps.length;\n    while (i--) this.deps[i].rebind(next, previous, false);\n\n    i = this.links.length;\n    while (i--) this.links[i].relinking(next, false);\n  }\n\n  register(dependant) {\n    this.deps.push(dependant);\n  }\n\n  registerChild(child) {\n    addToArray(this.children, child);\n    child.upstream = this;\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  unregister(dependant) {\n    removeFromArray(this.deps, dependant);\n  }\n\n  unregisterChild(child) {\n    removeFromArray(this.children, child);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n}\n\nKeyModel.prototype.reference = noop;\nKeyModel.prototype.unreference = noop;\n","import { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject, isObjectType } from 'utils/is';\nimport { findMap, buildNewIndices } from 'utils/array';\nimport { toEscapedString, toString, shuffled } from 'shared/methodCallers';\nimport Fragment, { getKeypath } from './Fragment';\nimport { ELEMENT } from 'config/types';\nimport { getContext } from 'shared/getRactiveContext';\nimport { keys } from 'utils/object';\nimport KeyModel from 'src/model/specials/KeyModel';\nimport { splitKeypath } from '../shared/keypaths';\nimport resolve from './resolvers/resolve';\n\nconst keypathString = /^\"(\\\\\"|[^\"])+\"$/;\n\nexport default class RepeatedFragment {\n  constructor(options) {\n    this.parent = options.owner.up;\n\n    // bit of a hack, so reference resolution works without another\n    // layer of indirection\n    this.up = this;\n    this.owner = options.owner;\n    this.ractive = this.parent.ractive;\n    this.delegate =\n      this.ractive.delegate !== false && (this.parent.delegate || findDelegate(this.parent));\n    // delegation disabled by directive\n    if (this.delegate && this.delegate.delegate === false) this.delegate = false;\n    // let the element know it's a delegate handler\n    if (this.delegate) this.delegate.delegate = this.delegate;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    this.cssIds = 'cssIds' in options ? options.cssIds : this.parent ? this.parent.cssIds : null;\n\n    this.context = null;\n    this.rendered = false;\n    this.iterations = [];\n\n    this.template = options.template;\n\n    this.indexRef = options.indexRef;\n    this.keyRef = options.keyRef;\n\n    this.pendingNewIndices = null;\n    this.previousIterations = null;\n\n    // track array versus object so updates of type rest\n    this.isArray = false;\n  }\n\n  bind(context) {\n    this.context = context;\n    this.bound = true;\n    const value = context.get();\n\n    const aliases = (this.aliases = this.owner.template.z && this.owner.template.z.slice());\n\n    const shuffler = aliases && aliases.find(a => a.n === 'shuffle');\n    if (shuffler && shuffler.x && shuffler.x.x) {\n      if (shuffler.x.x.s === 'true') this.shuffler = true;\n      else if (keypathString.test(shuffler.x.x.s))\n        this.shuffler = splitKeypath(shuffler.x.x.s.slice(1, -1));\n    }\n\n    if (this.shuffler) this.values = shuffleValues(this, this.shuffler);\n\n    if (this.source) this.source.model.unbind(this.source);\n    const source = context.isComputed && aliases && aliases.find(a => a.n === 'source');\n    if (source && source.x && source.x.r) {\n      const model = resolve(this, source.x);\n      this.source = {\n        handleChange() {},\n        rebind(next) {\n          this.model.unregister(this);\n          this.model = next;\n          next.register(this);\n        }\n      };\n      this.source.model = model;\n      model.register(this.source);\n    }\n\n    // {{#each array}}...\n    if ((this.isArray = isArray(value))) {\n      // we can't use map, because of sparse arrays\n      this.iterations = [];\n      const max = (this.length = value.length);\n      for (let i = 0; i < max; i += 1) {\n        this.iterations[i] = this.createIteration(i, i);\n      }\n    } else if (isObject(value)) {\n      // {{#each object}}...\n      this.isArray = false;\n\n      // TODO this is a dreadful hack. There must be a neater way\n      if (this.indexRef) {\n        const refs = this.indexRef.split(',');\n        this.keyRef = refs[0];\n        this.indexRef = refs[1];\n      }\n\n      const ks = keys(value);\n      this.length = ks.length;\n\n      this.iterations = ks.map((key, index) => {\n        return this.createIteration(key, index);\n      });\n    }\n\n    return this;\n  }\n\n  bubble(index) {\n    if (!this.bubbled) this.bubbled = [];\n    this.bubbled.push(index);\n\n    if (!this.rebounding) this.owner.bubble();\n  }\n\n  createIteration(key, index) {\n    const fragment = new Fragment({\n      owner: this,\n      template: this.template\n    });\n\n    fragment.isIteration = true;\n    fragment.delegate = this.delegate;\n\n    if (this.aliases) fragment.aliases = {};\n    swizzleFragment(this, fragment, key, index);\n\n    return fragment.bind(fragment.context);\n  }\n\n  destroyed() {\n    const len = this.iterations.length;\n    for (let i = 0; i < len; i++) this.iterations[i].destroyed();\n    if (this.pathModel) this.pathModel.destroyed();\n    if (this.rootModel) this.rootModel.destroyed();\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    this.iterations.forEach(fragment => docFrag.appendChild(fragment.detach()));\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.iterations, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    return this.iterations.forEach(i => i.findAll(selector, options));\n  }\n\n  findAllComponents(name, options) {\n    return this.iterations.forEach(i => i.findAllComponents(name, options));\n  }\n\n  findComponent(name, options) {\n    return findMap(this.iterations, i => i.findComponent(name, options));\n  }\n\n  findContext() {\n    return this.context;\n  }\n\n  findNextNode(iteration) {\n    if (iteration.index < this.iterations.length - 1) {\n      for (let i = iteration.index + 1; i < this.iterations.length; i++) {\n        const node = this.iterations[i].firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    return this.owner.findNextNode();\n  }\n\n  firstNode(skipParent) {\n    return this.iterations[0] ? this.iterations[0].firstNode(skipParent) : null;\n  }\n\n  getLast() {\n    return this.lastModel || (this.lastModel = new KeyModel(this.length - 1));\n  }\n\n  rebind(next) {\n    this.context = next;\n    if (this.source) return;\n    this.iterations.forEach(fragment => {\n      swizzleFragment(this, fragment, fragment.key, fragment.index);\n    });\n  }\n\n  rebound(update) {\n    this.context = this.owner.model;\n    this.iterations.forEach((f, i) => {\n      f.context = contextFor(this, f, i);\n      f.rebound(update);\n    });\n  }\n\n  render(target, occupants) {\n    const xs = this.iterations;\n    if (xs) {\n      const len = xs.length;\n      for (let i = 0; i < len; i++) {\n        xs[i].render(target, occupants);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  shuffle(newIndices, merge) {\n    if (!this.pendingNewIndices) this.previousIterations = this.iterations.slice();\n\n    if (!this.pendingNewIndices) this.pendingNewIndices = [];\n\n    this.pendingNewIndices.push(newIndices);\n\n    const iterations = [];\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      if (newIndex === -1) return;\n\n      const fragment = this.iterations[oldIndex];\n      iterations[newIndex] = fragment;\n\n      if (newIndex !== oldIndex && fragment) {\n        fragment.dirty = true;\n        if (merge) fragment.shouldRebind = 1;\n      }\n    });\n\n    this.iterations = iterations;\n\n    // if merging, we're in the midst of an update already\n    if (!merge) this.bubble();\n  }\n\n  shuffled() {\n    this.iterations.forEach(shuffled);\n  }\n\n  toString(escape) {\n    return this.iterations ? this.iterations.map(escape ? toEscapedString : toString).join('') : '';\n  }\n\n  unbind() {\n    this.bound = false;\n    if (this.source) this.source.model.unregister(this.source);\n    const len = this.iterations.length;\n    for (let i = 0; i < len; i++) this.iterations[i].unbind();\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    let len = this.iterations.length;\n    for (let i = 0; i < len; i++) this.iterations[i].unrender(shouldDestroy);\n    if (this.pendingNewIndices && this.previousIterations) {\n      len = this.previousIterations.length;\n      for (let i = 0; i < len; i++) this.previousIterations[i].unrender(shouldDestroy);\n    }\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.pendingNewIndices) {\n      this.bubbled.length = 0;\n      this.updatePostShuffle();\n      return;\n    }\n\n    if (this.updating) return;\n    this.updating = true;\n\n    if (this.shuffler) {\n      const values = shuffleValues(this, this.shuffler);\n      this.shuffle(buildNewIndices(this.values, values), true);\n      this.updatePostShuffle();\n    } else {\n      let len = this.iterations.length;\n      for (let i = 0; i < len; i++) {\n        const f = this.iterations[i];\n        f && f.idxModel && f.idxModel.applyValue(i);\n      }\n\n      const value = this.context.get();\n      const wasArray = this.isArray;\n\n      let toRemove;\n      let oldKeys;\n      let reset = true;\n      let i;\n\n      if ((this.isArray = isArray(value))) {\n        // if there's a source to map back to, make sure everything stays bound correctly\n        if (this.source) {\n          this.rebounding = 1;\n          const source = this.source.model.get();\n          this.iterations.forEach((f, c) => {\n            if (c < value.length && f.lastValue !== value[c] && ~(i = source.indexOf(value[c]))) {\n              swizzleFragment(this, f, c, c);\n              f.rebound(true);\n            }\n          });\n          this.rebounding = 0;\n        }\n\n        if (wasArray) {\n          reset = false;\n          if (this.iterations.length > value.length) {\n            toRemove = this.iterations.splice(value.length);\n          }\n        }\n      } else if (isObject(value) && !wasArray) {\n        reset = false;\n        toRemove = [];\n        oldKeys = {};\n        i = this.iterations.length;\n\n        while (i--) {\n          const fragment = this.iterations[i];\n          if (fragment.key in value) {\n            oldKeys[fragment.key] = true;\n          } else {\n            this.iterations.splice(i, 1);\n            toRemove.push(fragment);\n          }\n        }\n      }\n\n      const newLength = isArray(value) ? value.length : isObject(value) ? keys(value).length : 0;\n      this.length = newLength;\n      this.updateLast();\n\n      if (reset) {\n        toRemove = this.iterations;\n        this.iterations = [];\n      }\n\n      if (toRemove) {\n        len = toRemove.length;\n        for (let i = 0; i < len; i++) toRemove[i].unbind().unrender(true);\n      }\n\n      // update the remaining ones\n      if (!reset && this.isArray && this.bubbled && this.bubbled.length) {\n        const bubbled = this.bubbled;\n        this.bubbled = [];\n        len = bubbled.length;\n        for (let i = 0; i < len; i++)\n          this.iterations[bubbled[i]] && this.iterations[bubbled[i]].update();\n      } else {\n        len = this.iterations.length;\n        for (let i = 0; i < len; i++) this.iterations[i].update();\n      }\n\n      // add new iterations\n      let docFrag;\n      let fragment;\n\n      if (newLength > this.iterations.length) {\n        docFrag = this.rendered ? createDocumentFragment() : null;\n        i = this.iterations.length;\n\n        if (isArray(value)) {\n          while (i < value.length) {\n            fragment = this.createIteration(i, i);\n\n            this.iterations.push(fragment);\n            if (this.rendered) fragment.render(docFrag);\n\n            i += 1;\n          }\n        } else if (isObject(value)) {\n          // TODO this is a dreadful hack. There must be a neater way\n          if (this.indexRef && !this.keyRef) {\n            const refs = this.indexRef.split(',');\n            this.keyRef = refs[0];\n            this.indexRef = refs[1];\n          }\n\n          keys(value).forEach(key => {\n            if (!oldKeys || !(key in oldKeys)) {\n              fragment = this.createIteration(key, i);\n\n              this.iterations.push(fragment);\n              if (this.rendered) fragment.render(docFrag);\n\n              i += 1;\n            }\n          });\n        }\n\n        if (this.rendered) {\n          const parentNode = this.parent.findParentNode();\n          const anchor = this.parent.findNextNode(this.owner);\n\n          parentNode.insertBefore(docFrag, anchor);\n        }\n      }\n    }\n\n    this.updating = false;\n  }\n\n  updateLast() {\n    if (this.lastModel) this.lastModel.applyValue(this.length - 1);\n  }\n\n  updatePostShuffle() {\n    const newIndices = this.pendingNewIndices[0];\n    const parentNode = this.rendered ? this.parent.findParentNode() : null;\n    const nextNode = parentNode && this.owner.findNextNode();\n    const docFrag = parentNode ? createDocumentFragment() : null;\n\n    // map first shuffle through\n    this.pendingNewIndices.slice(1).forEach(indices => {\n      newIndices.forEach((newIndex, oldIndex) => {\n        newIndices[oldIndex] = indices[newIndex];\n      });\n    });\n\n    const len = (this.length = this.context.get().length);\n    const prev = this.previousIterations;\n    const iters = this.iterations;\n    const value = this.context.get();\n    const stash = {};\n    let idx, dest, pos, next, anchor, rebound;\n\n    const map = new Array(newIndices.length);\n    newIndices.forEach((e, i) => (map[e] = i));\n\n    this.updateLast();\n\n    idx = pos = 0;\n    while (idx < len) {\n      dest = newIndices[pos];\n      next = null;\n      rebound = false;\n\n      if (dest === -1) {\n        // drop it like it's hot\n        prev[pos].unbind().unrender(true);\n        prev[pos++] = 0;\n      } else if (dest > idx) {\n        // need to stash or pull one up\n        next = newIndices[pos + 1]; // TODO: maybe a shouldMove function that tracks multiple entries?\n        if (next <= dest) {\n          stash[dest] = prev[pos];\n          prev[pos++] = null;\n        } else {\n          next = stash[idx] || prev[map[idx]];\n          prev[map[idx]] = null;\n          anchor = prev[nextRendered(pos, newIndices, prev)];\n          anchor = (anchor && parentNode && anchor.firstNode()) || nextNode;\n\n          if (next) {\n            rebound = this.source && next.lastValue !== value[idx];\n            swizzleFragment(this, next, idx, idx);\n            if (parentNode) parentNode.insertBefore(next.detach(), anchor);\n          } else {\n            next = iters[idx] = this.createIteration(idx, idx);\n            if (parentNode) {\n              next.render(docFrag);\n              parentNode.insertBefore(docFrag, anchor);\n            }\n          }\n\n          idx++;\n        }\n      } else {\n        // all is well\n        next = iters[idx];\n        anchor = prev[nextRendered(pos, newIndices, prev)];\n        anchor = (anchor && parentNode && anchor.firstNode()) || nextNode;\n        if (!next) {\n          next = iters[idx] = this.createIteration(idx, idx);\n          if (parentNode) {\n            next.render(docFrag);\n            parentNode.insertBefore(docFrag, anchor);\n          }\n        } else if (pos !== idx || stash[idx]) {\n          rebound = this.source && next.lastValue !== value[idx];\n          swizzleFragment(this, next, idx, idx);\n          if (stash[idx] && parentNode) parentNode.insertBefore(next.detach(), anchor);\n        }\n\n        idx++;\n        prev[pos++] = null;\n      }\n\n      if (next && isObjectType(next)) {\n        if (next.shouldRebind || rebound) {\n          next.rebound(rebound);\n          next.shouldRebind = 0;\n        }\n        next.update();\n        next.shuffled();\n      }\n    }\n\n    // clean up any stragglers\n    const plen = prev.length;\n    for (let i = 0; i < plen; i++) prev[i] && prev[i].unbind().unrender(true);\n\n    if (this.shuffler) this.values = shuffleValues(this, this.shuffler);\n\n    this.pendingNewIndices = null;\n    this.previousIterations = null;\n  }\n}\n\nRepeatedFragment.prototype.getContext = getContext;\nRepeatedFragment.prototype.getKeypath = getKeypath;\n\n// find the topmost delegate\nfunction findDelegate(start) {\n  let frag = start;\n  let delegate, el;\n\n  out: while (frag) {\n    // find next element\n    el = 0;\n    while (!el && frag) {\n      if (frag.owner.type === ELEMENT) el = frag.owner;\n      if (frag.owner.ractive && frag.owner.ractive.delegate === false) break out;\n      frag = frag.parent || frag.componentParent;\n    }\n\n    if (el.delegate === false) break out;\n    delegate = el.delegate || el;\n\n    // find next repeated fragment\n    while (frag) {\n      if (frag.iterations) break;\n      if (frag.owner.ractive && frag.owner.ractive.delegate === false) break out;\n      frag = frag.parent || frag.componentParent;\n    }\n  }\n\n  return delegate;\n}\n\nfunction nextRendered(start, newIndices, frags) {\n  const len = newIndices.length;\n  for (let i = start; i < len; i++) {\n    if (~newIndices[i] && frags[i] && frags[i].rendered) return i;\n  }\n}\n\nfunction swizzleFragment(section, fragment, key, idx) {\n  const model = section.context ? contextFor(section, fragment, key) : undefined;\n\n  fragment.key = key;\n  fragment.index = idx;\n  fragment.context = model;\n  if (section.source) fragment.lastValue = model && model.get();\n\n  if (fragment.idxModel) fragment.idxModel.applyValue(idx);\n  if (fragment.keyModel) fragment.keyModel.applyValue(key);\n  if (fragment.pathModel) {\n    fragment.pathModel.context = model;\n    fragment.pathModel.applyValue(model.getKeypath());\n  }\n  if (fragment.rootModel) {\n    fragment.rootModel.context = model;\n    fragment.rootModel.applyValue(model.getKeypath(fragment.ractive.root));\n  }\n\n  // handle any aliases\n  const aliases = fragment.aliases;\n  section.aliases &&\n    section.aliases.forEach(a => {\n      if (a.x.r === '.') aliases[a.n] = model;\n      else if (a.x.r === '@index') aliases[a.n] = fragment.getIndex();\n      else if (a.x.r === '@key') aliases[a.n] = fragment.getKey();\n      else if (a.x.r === '@keypath') aliases[a.n] = fragment.getKeypath();\n      else if (a.x.r === '@rootpath') aliases[a.n] = fragment.getKeypath(true);\n    });\n}\n\nfunction shuffleValues(section, shuffler) {\n  if (shuffler === true) {\n    return section.context.get().slice();\n  } else {\n    return section.context.get().map(v => shuffler.reduce((a, c) => a && a[c], v));\n  }\n}\n\nfunction contextFor(section, fragment, key) {\n  if (section.source) {\n    let idx;\n    const source = section.source.model.get();\n    if (source.indexOf && ~(idx = source.indexOf(section.context.joinKey(key).get())))\n      return section.source.model.joinKey(idx);\n  }\n\n  return section.context.joinKey(key);\n}\n","import {\n  SECTION_EACH,\n  SECTION_IF,\n  SECTION_IF_WITH,\n  SECTION_UNLESS,\n  SECTION_WITH\n} from 'config/types';\nimport { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject, isObjectLike } from 'utils/is';\nimport { keep } from 'shared/set';\nimport runloop from 'src/global/runloop';\nimport Fragment from '../Fragment';\nimport RepeatedFragment from '../RepeatedFragment';\nimport { MustacheContainer } from './shared/Mustache';\nimport { keys } from 'utils/object';\n\nfunction isEmpty(value) {\n  return (\n    !value ||\n    (isArray(value) && value.length === 0) ||\n    (isObject(value) && keys(value).length === 0)\n  );\n}\n\nfunction getType(value, hasIndexRef) {\n  if (hasIndexRef || isArray(value)) return SECTION_EACH;\n  if (isObjectLike(value)) return SECTION_IF_WITH;\n  if (value === undefined) return null;\n  return SECTION_IF;\n}\n\nexport default class Section extends MustacheContainer {\n  constructor(options) {\n    super(options);\n\n    this.sectionType = options.template.n || null;\n    this.templateSectionType = this.sectionType;\n    this.subordinate = options.template.l === 1;\n    this.fragment = null;\n  }\n\n  bind() {\n    super.bind();\n\n    if (this.subordinate) {\n      this.sibling = this.up.items[this.up.items.indexOf(this) - 1];\n      this.sibling.nextSibling = this;\n    }\n\n    // if we managed to bind, we need to create children\n    if (this.model) {\n      this.dirty = true;\n      this.update();\n    } else if (\n      this.sectionType &&\n      this.sectionType === SECTION_UNLESS &&\n      (!this.sibling || !this.sibling.isTruthy())\n    ) {\n      this.fragment = new Fragment({\n        owner: this,\n        template: this.template.f\n      }).bind();\n    }\n  }\n\n  detach() {\n    const frag = this.fragment || this.detached;\n    return frag ? frag.detach() : super.detach();\n  }\n\n  isTruthy() {\n    if (this.subordinate && this.sibling.isTruthy()) return true;\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    return !!value && (this.templateSectionType === SECTION_IF_WITH || !isEmpty(value));\n  }\n\n  rebind(next, previous, safe) {\n    if (super.rebind(next, previous, safe)) {\n      if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n        this.fragment.rebind(next);\n      }\n    }\n  }\n\n  rebound(update) {\n    if (this.model) {\n      if (this.model.rebound) this.model.rebound(update);\n      else {\n        super.unbind();\n        super.bind();\n        if (\n          this.sectionType === SECTION_WITH ||\n          this.sectionType === SECTION_IF_WITH ||\n          this.sectionType === SECTION_EACH\n        ) {\n          if (this.fragment) this.fragment.rebind(this.model);\n        }\n\n        if (update) this.bubble();\n      }\n    }\n    if (this.fragment) this.fragment.rebound(update);\n  }\n\n  render(target, occupants) {\n    this.rendered = true;\n    if (this.fragment) this.fragment.render(target, occupants);\n  }\n\n  shuffle(newIndices) {\n    if (this.fragment && this.sectionType === SECTION_EACH) {\n      this.fragment.shuffle(newIndices);\n    }\n  }\n\n  unbind() {\n    super.unbind();\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (!this.dirty) return;\n\n    if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n      this.fragment.context = this.model;\n    }\n\n    if (!this.model && this.sectionType !== SECTION_UNLESS) return;\n\n    this.dirty = false;\n\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    const siblingFalsey = !this.subordinate || !this.sibling.isTruthy();\n    const lastType = this.sectionType;\n\n    // watch for switching section types\n    if (this.sectionType === null || this.templateSectionType === null)\n      this.sectionType = getType(value, this.template.i);\n    if (lastType && lastType !== this.sectionType && this.fragment) {\n      if (this.rendered) {\n        this.fragment.unbind().unrender(true);\n      }\n\n      this.fragment = null;\n    }\n\n    let newFragment;\n\n    const fragmentShouldExist =\n      this.sectionType === SECTION_EACH || // each always gets a fragment, which may have no iterations\n      this.sectionType === SECTION_WITH || // with (partial context) always gets a fragment\n      (siblingFalsey && (this.sectionType === SECTION_UNLESS ? !this.isTruthy() : this.isTruthy())); // if, unless, and if-with depend on siblings and the condition\n\n    if (fragmentShouldExist) {\n      if (!this.fragment) this.fragment = this.detached;\n\n      if (this.fragment) {\n        // check for detached fragment\n        if (this.detached) {\n          attach(this, this.fragment);\n          this.detached = false;\n          this.rendered = true;\n        }\n\n        if (!this.fragment.bound) this.fragment.bind(this.model);\n        this.fragment.update();\n      } else {\n        if (this.sectionType === SECTION_EACH) {\n          newFragment = new RepeatedFragment({\n            owner: this,\n            template: this.template.f,\n            indexRef: this.template.i\n          }).bind(this.model);\n        } else {\n          // only with and if-with provide context - if and unless do not\n          const context =\n            this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS\n              ? this.model\n              : null;\n          newFragment = new Fragment({\n            owner: this,\n            template: this.template.f\n          }).bind(context);\n        }\n      }\n    } else {\n      if (this.fragment && this.rendered) {\n        if (keep !== true) {\n          this.fragment.unbind().unrender(true);\n        } else {\n          this.unrender(false);\n          this.detached = this.fragment;\n          runloop.promise().then(() => {\n            if (this.detached) this.detach();\n          });\n        }\n      } else if (this.fragment) {\n        this.fragment.unbind();\n      }\n\n      this.fragment = null;\n    }\n\n    if (newFragment) {\n      if (this.rendered) {\n        attach(this, newFragment);\n      }\n\n      this.fragment = newFragment;\n    }\n\n    if (this.nextSibling) {\n      this.nextSibling.dirty = true;\n      this.nextSibling.update();\n    }\n  }\n}\n\nfunction attach(section, fragment) {\n  const anchor = section.up.findNextNode(section);\n\n  if (anchor) {\n    const docFrag = createDocumentFragment();\n    fragment.render(docFrag);\n\n    anchor.parentNode.insertBefore(docFrag, anchor);\n  } else {\n    fragment.render(section.up.findParentNode());\n  }\n}\n","import { toArray } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Element from '../../Element';\nimport { isArray, isFunction } from 'utils/is';\n\nexport default class Select extends Element {\n  constructor(options) {\n    super(options);\n    this.options = [];\n  }\n\n  foundNode(node) {\n    if (this.binding) {\n      const selectedOptions = getSelectedOptions(node);\n\n      if (selectedOptions.length > 0) {\n        this.selectedOptions = selectedOptions;\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.sync();\n\n    const node = this.node;\n\n    let i = node.options.length;\n    while (i--) {\n      node.options[i].defaultSelected = node.options[i].selected;\n    }\n\n    this.rendered = true;\n  }\n\n  sync() {\n    const selectNode = this.node;\n\n    if (!selectNode) return;\n\n    const options = toArray(selectNode.options);\n\n    if (this.selectedOptions) {\n      options.forEach(o => {\n        if (this.selectedOptions.indexOf(o) >= 0) o.selected = true;\n        else o.selected = false;\n      });\n      this.binding.setFromNode(selectNode);\n      delete this.selectedOptions;\n      return;\n    }\n\n    const selectValue = this.getAttribute('value');\n    const isMultiple = this.getAttribute('multiple');\n    const array = isMultiple && isArray(selectValue);\n\n    // If the <select> has a specified value, that should override\n    // these options\n    if (selectValue !== undefined) {\n      let optionWasSelected;\n\n      options.forEach(o => {\n        const optionValue = o._ractive ? o._ractive.value : o.value;\n        const shouldSelect = isMultiple\n          ? array && this.valueContains(selectValue, optionValue)\n          : this.compare(selectValue, optionValue);\n\n        if (shouldSelect) {\n          optionWasSelected = true;\n        }\n\n        o.selected = shouldSelect;\n      });\n\n      if (!optionWasSelected && !isMultiple) {\n        if (this.binding) {\n          this.binding.forceUpdate();\n        }\n      }\n    } else if (this.binding && this.binding.forceUpdate) {\n      // Otherwise the value should be initialised according to which\n      // <option> element is selected, if twoway binding is in effect\n      this.binding.forceUpdate();\n    }\n  }\n  valueContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.compare(optionValue, selectValue[i])) return true;\n    }\n  }\n  compare(optionValue, selectValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(selectValue, optionValue);\n      }\n      if (selectValue && optionValue) {\n        return selectValue[comparator] == optionValue[comparator];\n      }\n    }\n    return selectValue == optionValue;\n  }\n  update() {\n    const dirty = this.dirty;\n    super.update();\n    if (dirty) {\n      this.sync();\n    }\n  }\n}\n","import { ATTRIBUTE } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport Input from './Input';\nimport { isBindable } from '../binding/selectBinding';\nimport createItem from '../../createItem';\nimport Fragment from '../../../Fragment';\n\nexport default class Textarea extends Input {\n  constructor(options) {\n    const template = options.template;\n\n    options.deferContent = true;\n\n    super(options);\n\n    // check for single interpolator binding\n    if (!this.attributeByName.value) {\n      if (template.f && isBindable({ template })) {\n        (this.attributes || (this.attributes = [])).push(\n          createItem({\n            owner: this,\n            template: { t: ATTRIBUTE, f: template.f, n: 'value' },\n            up: this.up\n          })\n        );\n      } else {\n        this.fragment = new Fragment({\n          owner: this,\n          cssIds: null,\n          template: template.f\n        });\n      }\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.rendered && !this.binding && this.fragment) {\n        runloop.scheduleTask(() => {\n          this.dirty = false;\n          this.node.value = this.fragment.toString();\n        });\n      }\n\n      this.up.bubble(); // default behaviour\n    }\n  }\n}\n","import { TEXT } from 'config/types';\nimport { escapeHtml } from 'utils/html';\nimport { detachNode } from 'utils/dom';\nimport noop from 'utils/noop';\nimport Item from './shared/Item';\nimport progressiveText from './shared/progressiveText';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Text extends Item {\n  constructor(options) {\n    super(options);\n    this.type = TEXT;\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, this.template);\n  }\n\n  toString(escape) {\n    return escape ? escapeHtml(this.template) : this.template;\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  valueOf() {\n    return this.template;\n  }\n}\n\nconst proto = Text.prototype;\nproto.bind = proto.unbind = proto.update = noop;\n","import { win, doc, vendors } from './environment';\n\nexport let visible;\nlet hidden = 'hidden';\n\nif (doc) {\n  let prefix;\n\n  /* istanbul ignore next */\n  if (hidden in doc) {\n    prefix = '';\n  } else {\n    let i = vendors.length;\n    while (i--) {\n      const vendor = vendors[i];\n      hidden = vendor + 'Hidden';\n\n      if (hidden in doc) {\n        prefix = vendor;\n        break;\n      }\n    }\n  }\n\n  /* istanbul ignore else */\n  if (prefix !== undefined) {\n    doc.addEventListener(prefix + 'visibilitychange', onChange);\n    onChange();\n  } else {\n    // gah, we're in an old browser\n    if ('onfocusout' in doc) {\n      doc.addEventListener('focusout', onHide);\n      doc.addEventListener('focusin', onShow);\n    } else {\n      win.addEventListener('pagehide', onHide);\n      win.addEventListener('blur', onHide);\n\n      win.addEventListener('pageshow', onShow);\n      win.addEventListener('focus', onShow);\n    }\n\n    visible = true; // until proven otherwise. Not ideal but hey\n  }\n}\n\nfunction onChange() {\n  visible = !doc[hidden];\n}\n\n/* istanbul ignore next */\nfunction onHide() {\n  visible = false;\n}\n\n/* istanbul ignore next */\nfunction onShow() {\n  visible = true;\n}\n","import { isClient, vendors } from 'config/environment';\nimport { createElement } from 'utils/dom';\nimport hyphenateCamel from 'utils/hyphenateCamel';\n\nlet prefix;\n\n/* istanbul ignore next */\nif (!isClient) {\n  prefix = null;\n} else {\n  const prefixCache = {};\n  const testStyle = createElement('div').style;\n\n  // technically this also normalizes on hyphenated styles as well\n  prefix = function(prop) {\n    if (!prefixCache[prop]) {\n      const name = hyphenateCamel(prop);\n\n      if (testStyle[prop] !== undefined) {\n        prefixCache[prop] = name;\n      } else {\n        /* istanbul ignore next */\n        // test vendors...\n        let i = vendors.length;\n        while (i--) {\n          const vendor = `-${vendors[i]}-${name}`;\n          if (testStyle[vendor] !== undefined) {\n            prefixCache[prop] = vendor;\n            break;\n          }\n        }\n      }\n    }\n\n    return prefixCache[prop];\n  };\n}\n\nexport default prefix;\n","import { missingPlugin } from 'config/errors';\nimport { isClient } from 'config/environment';\nimport { warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { createElement } from 'utils/dom';\nimport interpolate from 'shared/interpolate';\nimport Ticker from 'shared/Ticker';\nimport hyphenate from './hyphenate';\nimport { isFunction, isString } from 'utils/is';\n\nlet createTransitions;\n\nif (!isClient) {\n  createTransitions = null;\n} else {\n  const testStyle = createElement('div').style;\n  const linear = x => x;\n\n  const canUseCssTransitions = {};\n  const cannotUseCssTransitions = {};\n\n  // determine some facts about our environment\n  let TRANSITION;\n  let TRANSITIONEND;\n  let CSS_TRANSITIONS_ENABLED;\n  let TRANSITION_DURATION;\n  let TRANSITION_PROPERTY;\n  let TRANSITION_TIMING_FUNCTION;\n\n  if (testStyle.transition !== undefined) {\n    TRANSITION = 'transition';\n    TRANSITIONEND = 'transitionend';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else if (testStyle.webkitTransition !== undefined) {\n    TRANSITION = 'webkitTransition';\n    TRANSITIONEND = 'webkitTransitionEnd';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else {\n    CSS_TRANSITIONS_ENABLED = false;\n  }\n\n  if (TRANSITION) {\n    TRANSITION_DURATION = TRANSITION + 'Duration';\n    TRANSITION_PROPERTY = TRANSITION + 'Property';\n    TRANSITION_TIMING_FUNCTION = TRANSITION + 'TimingFunction';\n  }\n\n  createTransitions = function(t, to, options, changedProperties, resolve) {\n    // Wait a beat (otherwise the target styles will be applied immediately)\n    // TODO use a fastdom-style mechanism?\n    setTimeout(() => {\n      let jsTransitionsComplete;\n      let cssTransitionsComplete;\n      let cssTimeout; // eslint-disable-line prefer-const\n\n      function transitionDone() {\n        clearTimeout(cssTimeout);\n      }\n\n      function checkComplete() {\n        if (jsTransitionsComplete && cssTransitionsComplete) {\n          t.unregisterCompleteHandler(transitionDone);\n          // will changes to events and fire have an unexpected consequence here?\n          t.ractive.fire(t.name + ':end', t.node, t.isIntro);\n          resolve();\n        }\n      }\n\n      // this is used to keep track of which elements can use CSS to animate\n      // which properties\n      const hashPrefix = (t.node.namespaceURI || '') + t.node.tagName;\n\n      // need to reset transition properties\n      const style = t.node.style;\n      const previous = {\n        property: style[TRANSITION_PROPERTY],\n        timing: style[TRANSITION_TIMING_FUNCTION],\n        duration: style[TRANSITION_DURATION]\n      };\n\n      function transitionEndHandler(event) {\n        const index = changedProperties.indexOf(event.propertyName);\n\n        if (index !== -1) {\n          changedProperties.splice(index, 1);\n        }\n\n        if (changedProperties.length) {\n          // still transitioning...\n          return;\n        }\n\n        clearTimeout(cssTimeout);\n        cssTransitionsDone();\n      }\n\n      function cssTransitionsDone() {\n        style[TRANSITION_PROPERTY] = previous.property;\n        style[TRANSITION_TIMING_FUNCTION] = previous.duration;\n        style[TRANSITION_DURATION] = previous.timing;\n\n        t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n        cssTransitionsComplete = true;\n        checkComplete();\n      }\n\n      t.node.addEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n      // safety net in case transitionend never fires\n      cssTimeout = setTimeout(() => {\n        changedProperties = [];\n        cssTransitionsDone();\n      }, options.duration + (options.delay || 0) + 50);\n      t.registerCompleteHandler(transitionDone);\n\n      style[TRANSITION_PROPERTY] = changedProperties.join(',');\n      const easingName = hyphenate(options.easing || 'linear');\n      style[TRANSITION_TIMING_FUNCTION] = easingName;\n      const cssTiming = style[TRANSITION_TIMING_FUNCTION] === easingName;\n      style[TRANSITION_DURATION] = options.duration / 1000 + 's';\n\n      setTimeout(() => {\n        let i = changedProperties.length;\n        let hash;\n        let originalValue = null;\n        let index;\n        const propertiesToTransitionInJs = [];\n        let prop;\n        let suffix;\n        let interpolator;\n\n        while (i--) {\n          prop = changedProperties[i];\n          hash = hashPrefix + prop;\n\n          if (cssTiming && CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[hash]) {\n            const initial = style[prop];\n            style[prop] = to[prop];\n\n            // If we're not sure if CSS transitions are supported for\n            // this tag/property combo, find out now\n            if (!(hash in canUseCssTransitions)) {\n              originalValue = t.getStyle(prop);\n\n              // if this property is transitionable in this browser,\n              // the current style will be different from the target style\n              canUseCssTransitions[hash] = t.getStyle(prop) != to[prop];\n              cannotUseCssTransitions[hash] = !canUseCssTransitions[hash];\n\n              // Reset, if we're going to use timers after all\n              if (cannotUseCssTransitions[hash]) {\n                style[prop] = initial;\n              }\n            }\n          }\n\n          if (!cssTiming || !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[hash]) {\n            // we need to fall back to timer-based stuff\n            if (originalValue === null) originalValue = t.getStyle(prop);\n\n            // need to remove this from changedProperties, otherwise transitionEndHandler\n            // will get confused\n            index = changedProperties.indexOf(prop);\n            if (index === -1) {\n              warnIfDebug(\n                'Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!',\n                { node: t.node }\n              );\n            } else {\n              changedProperties.splice(index, 1);\n            }\n\n            // TODO Determine whether this property is animatable at all\n\n            suffix = /[^\\d]*$/.exec(originalValue)[0];\n            interpolator = interpolate(parseFloat(originalValue), parseFloat(to[prop]));\n\n            // ...then kick off a timer-based transition\n            if (interpolator) {\n              propertiesToTransitionInJs.push({\n                name: prop,\n                interpolator,\n                suffix\n              });\n            } else {\n              style[prop] = to[prop];\n            }\n\n            originalValue = null;\n          }\n        }\n\n        // javascript transitions\n        if (propertiesToTransitionInJs.length) {\n          let easing;\n\n          if (isString(options.easing)) {\n            easing = t.ractive.easing[options.easing];\n\n            if (!easing) {\n              warnOnceIfDebug(missingPlugin(options.easing, 'easing'));\n              easing = linear;\n            }\n          } else if (isFunction(options.easing)) {\n            easing = options.easing;\n          } else {\n            easing = linear;\n          }\n\n          new Ticker({\n            duration: options.duration,\n            easing,\n            step(pos) {\n              let i = propertiesToTransitionInJs.length;\n              while (i--) {\n                const prop = propertiesToTransitionInJs[i];\n                style[prop.name] = prop.interpolator(pos) + prop.suffix;\n              }\n            },\n            complete() {\n              jsTransitionsComplete = true;\n              checkComplete();\n            }\n          });\n        } else {\n          jsTransitionsComplete = true;\n        }\n\n        if (changedProperties.length) {\n          style[TRANSITION_PROPERTY] = changedProperties.join(',');\n        } else {\n          style[TRANSITION_PROPERTY] = 'none';\n\n          // We need to cancel the transitionEndHandler, and deal with\n          // the fact that it will never fire\n          t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n          cssTransitionsComplete = true;\n          checkComplete();\n        }\n      }, 0);\n    }, options.delay || 0);\n  };\n}\n\nexport default createTransitions;\n","import { vendors } from 'config/environment';\n\nconst vendorPattern = new RegExp('^(?:' + vendors.join('|') + ')([A-Z])');\n\nexport default function(str) {\n  /* istanbul ignore next */\n  if (!str) return ''; // edge case\n\n  /* istanbul ignore next */\n  if (vendorPattern.test(str)) str = '-' + str;\n\n  return str.replace(/[A-Z]/g, match => '-' + match.toLowerCase());\n}\n","import { win } from 'config/environment';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isFunction, isNumber, isString } from 'utils/is';\nimport noop from 'utils/noop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { findInViewHierarchy } from 'shared/registry';\nimport { visible } from 'config/visibility';\nimport findElement from '../shared/findElement';\nimport prefix from './transitions/prefix';\nimport createTransitions from './transitions/createTransitions';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport { assign, hasOwn, keys } from 'utils/object';\n\nconst getComputedStyle = win && win.getComputedStyle;\nconst resolved = Promise.resolve();\n\nconst names = {\n  t0: 'intro-outro',\n  t1: 'intro',\n  t2: 'outro'\n};\n\nexport default class Transition {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.ractive = this.owner.ractive;\n    this.template = options.template;\n    this.up = options.up;\n    this.options = options;\n    this.onComplete = [];\n  }\n\n  animateStyle(style, value, options) {\n    if (arguments.length === 4) {\n      throw new Error(\n        't.animateStyle() returns a promise - use .then() instead of passing a callback'\n      );\n    }\n\n    // Special case - page isn't visible. Don't animate anything, because\n    // that way you'll never get CSS transitionend events\n    if (!visible) {\n      this.setStyle(style, value);\n      return resolved;\n    }\n\n    let to;\n\n    if (isString(style)) {\n      to = {};\n      to[style] = value;\n    } else {\n      to = style;\n\n      // shuffle arguments\n      options = value;\n    }\n\n    return new Promise(fulfil => {\n      // Edge case - if duration is zero, set style synchronously and complete\n      if (!options.duration) {\n        this.setStyle(to);\n        fulfil();\n        return;\n      }\n\n      // Get a list of the properties we're animating\n      const propertyNames = keys(to);\n      const changedProperties = [];\n\n      // Store the current styles\n      const computedStyle = getComputedStyle(this.node);\n\n      let i = propertyNames.length;\n      while (i--) {\n        const prop = propertyNames[i];\n        const name = prefix(prop);\n\n        const current = computedStyle[prefix(prop)];\n\n        // record the starting points\n        const init = this.node.style[name];\n        if (!(name in this.originals)) this.originals[name] = this.node.style[name];\n        this.node.style[name] = to[prop];\n        this.targets[name] = this.node.style[name];\n        this.node.style[name] = init;\n\n        // we need to know if we're actually changing anything\n        if (current != to[prop]) {\n          // use != instead of !==, so we can compare strings with numbers\n          changedProperties.push(name);\n\n          // if we happened to prefix, make sure there is a properly prefixed value\n          to[name] = to[prop];\n\n          // make the computed style explicit, so we can animate where\n          // e.g. height='auto'\n          this.node.style[name] = current;\n        }\n      }\n\n      // If we're not actually changing anything, the transitionend event\n      // will never fire! So we complete early\n      if (!changedProperties.length) {\n        fulfil();\n        return;\n      }\n\n      createTransitions(this, to, options, changedProperties, fulfil);\n    });\n  }\n\n  bind() {\n    const options = this.options;\n    const type = options.template && options.template.v;\n    if (type) {\n      if (type === 't0' || type === 't1') this.element.intro = this;\n      if (type === 't0' || type === 't2') this.element.outro = this;\n      this.eventName = names[type];\n    }\n\n    const ractive = this.owner.ractive;\n\n    this.name = options.name || options.template.n;\n\n    if (options.params) {\n      this.params = options.params;\n    }\n\n    if (isFunction(this.name)) {\n      this._fn = this.name;\n      this.name = this._fn.name;\n    } else {\n      this._fn = findInViewHierarchy('transitions', ractive, this.name);\n    }\n\n    if (!this._fn) {\n      warnOnceIfDebug(missingPlugin(this.name, 'transition'), { ractive });\n    }\n\n    setupArgsFn(this, options.template);\n  }\n\n  getParams() {\n    if (this.params) return this.params;\n\n    // get expression args if supplied\n    if (this.fn) {\n      const values = resolveArgs(this, this.template, this.up).map(model => {\n        if (!model) return undefined;\n\n        return model.get();\n      });\n      return this.fn.apply(this.ractive, values);\n    }\n  }\n\n  getStyle(props) {\n    const computedStyle = getComputedStyle(this.node);\n\n    if (isString(props)) {\n      return computedStyle[prefix(props)];\n    }\n\n    if (!isArray(props)) {\n      throw new Error(\n        'Transition$getStyle must be passed a string, or an array of strings representing CSS properties'\n      );\n    }\n\n    const styles = {};\n\n    let i = props.length;\n    while (i--) {\n      const prop = props[i];\n      let value = computedStyle[prefix(prop)];\n\n      if (value === '0px') value = 0;\n      styles[prop] = value;\n    }\n\n    return styles;\n  }\n\n  processParams(params, defaults) {\n    if (isNumber(params)) {\n      params = { duration: params };\n    } else if (isString(params)) {\n      if (params === 'slow') {\n        params = { duration: 600 };\n      } else if (params === 'fast') {\n        params = { duration: 200 };\n      } else {\n        params = { duration: 400 };\n      }\n    } else if (!params) {\n      params = {};\n    }\n\n    return assign({}, defaults, params);\n  }\n\n  registerCompleteHandler(fn) {\n    addToArray(this.onComplete, fn);\n  }\n\n  setStyle(style, value) {\n    if (isString(style)) {\n      const name = prefix(style);\n      if (!hasOwn(this.originals, name)) this.originals[name] = this.node.style[name];\n      this.node.style[name] = value;\n      this.targets[name] = this.node.style[name];\n    } else {\n      let prop;\n      for (prop in style) {\n        if (hasOwn(style, prop)) {\n          this.setStyle(prop, style[prop]);\n        }\n      }\n    }\n\n    return this;\n  }\n\n  shouldFire(type) {\n    if (!this.ractive.transitionsEnabled) return false;\n\n    // check for noIntro and noOutro cases, which only apply when the owner ractive is rendering and unrendering, respectively\n    if (type === 'intro' && this.ractive.rendering && nearestProp('noIntro', this.ractive, true))\n      return false;\n    if (type === 'outro' && this.ractive.unrendering && nearestProp('noOutro', this.ractive, false))\n      return false;\n\n    const params = this.getParams(); // this is an array, the params object should be the first member\n    // if there's not a parent element, this can't be nested, so roll on\n    if (!this.element.parent) return true;\n\n    // if there is a local param, it takes precedent\n    if (params && params[0] && isObject(params[0]) && 'nested' in params[0]) {\n      if (params[0].nested !== false) return true;\n    } else {\n      // use the nearest instance setting\n      // find the nearest instance that actually has a nested setting\n      if (nearestProp('nestedTransitions', this.ractive) !== false) return true;\n    }\n\n    // check to see if this is actually a nested transition\n    let el = this.element.parent;\n    while (el) {\n      if (el[type] && el[type].starting) return false;\n      el = el.parent;\n    }\n\n    return true;\n  }\n\n  start() {\n    const node = (this.node = this.element.node);\n    const originals = (this.originals = {}); //= node.getAttribute( 'style' );\n    const targets = (this.targets = {});\n\n    let completed;\n    const args = this.getParams();\n\n    // create t.complete() - we don't want this on the prototype,\n    // because we don't want `this` silliness when passing it as\n    // an argument\n    this.complete = noReset => {\n      this.starting = false;\n      if (completed) {\n        return;\n      }\n\n      this.onComplete.forEach(fn => fn());\n      if (!noReset && this.isIntro) {\n        for (const k in targets) {\n          if (node.style[k] === targets[k]) node.style[k] = originals[k];\n        }\n      }\n\n      this._manager.remove(this);\n\n      completed = true;\n    };\n\n    // If the transition function doesn't exist, abort\n    if (!this._fn) {\n      this.complete();\n      return;\n    }\n\n    const promise = this._fn.apply(this.ractive, [this].concat(args));\n    if (promise) promise.then(this.complete);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    if (!this.element.attributes.unbinding) {\n      const type = this.options && this.options.template && this.options.template.v;\n      if (type === 't0' || type === 't1') this.element.intro = null;\n      if (type === 't0' || type === 't2') this.element.outro = null;\n    }\n  }\n\n  unregisterCompleteHandler(fn) {\n    removeFromArray(this.onComplete, fn);\n  }\n}\n\nconst proto = Transition.prototype;\nproto.destroyed = proto.rebound = proto.render = proto.unrender = proto.update = noop;\n\nfunction nearestProp(prop, ractive, rendering) {\n  let instance = ractive;\n  while (instance) {\n    if (\n      hasOwn(instance, prop) &&\n      (rendering === undefined || rendering ? instance.rendering : instance.unrendering)\n    )\n      return instance[prop];\n    instance = instance.component && instance.component.ractive;\n  }\n\n  return ractive[prop];\n}\n","import { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\n\nconst elementCache = {};\n\nlet ieBug;\nlet ieBlacklist;\n\ntry {\n  createElement('table').innerHTML = 'foo';\n} catch (/* istanbul ignore next */ err) {\n  ieBug = true;\n\n  ieBlacklist = {\n    TABLE: ['<table class=\"x\">', '</table>'],\n    THEAD: ['<table><thead class=\"x\">', '</thead></table>'],\n    TBODY: ['<table><tbody class=\"x\">', '</tbody></table>'],\n    TR: ['<table><tr class=\"x\">', '</tr></table>'],\n    SELECT: ['<select class=\"x\">', '</select>']\n  };\n}\n\nexport default function(html, node) {\n  const nodes = [];\n\n  // render 0 and false\n  if (html == null || html === '') return nodes;\n\n  let container;\n  let wrapper;\n  let selectedOption;\n\n  /* istanbul ignore if */\n  if (ieBug && (wrapper = ieBlacklist[node.tagName])) {\n    container = element('DIV');\n    container.innerHTML = wrapper[0] + html + wrapper[1];\n    container = container.querySelector('.x');\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  } else if (node.namespaceURI === svg) {\n    container = element('DIV');\n    container.innerHTML = '<svg class=\"x\">' + html + '</svg>';\n    container = container.querySelector('.x');\n  } else if (node.tagName === 'TEXTAREA') {\n    container = createElement('div');\n\n    if (typeof container.textContent !== 'undefined') {\n      container.textContent = html;\n    } else {\n      container.innerHTML = html;\n    }\n  } else {\n    container = element(node.tagName);\n    container.innerHTML = html;\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  }\n\n  let child;\n  while ((child = container.firstChild)) {\n    nodes.push(child);\n    container.removeChild(child);\n  }\n\n  // This is really annoying. Extracting <option> nodes from the\n  // temporary container <select> causes the remaining ones to\n  // become selected. So now we have to deselect them. IE8, you\n  // amaze me. You really do\n  // ...and now Chrome too\n  let i;\n  if (node.tagName === 'SELECT') {\n    i = nodes.length;\n    while (i--) {\n      if (nodes[i] !== selectedOption) {\n        nodes[i].selected = false;\n      }\n    }\n  }\n\n  return nodes;\n}\n\nfunction element(tagName) {\n  return elementCache[tagName] || (elementCache[tagName] = createElement(tagName));\n}\n","import { createDocumentFragment, matches } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport { decodeCharacterReferences } from 'utils/html';\nimport runloop from 'src/global/runloop';\nimport Mustache from './shared/Mustache';\nimport insertHtml from './triple/insertHtml';\nimport { inAttribute } from './element/Attribute';\n\nexport default class Triple extends Mustache {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    if (this.nodes) this.nodes.forEach(node => docFrag.appendChild(node));\n    return docFrag;\n  }\n\n  find(selector) {\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) return node;\n\n      const queryResult = node.querySelector(selector);\n      if (queryResult) return queryResult;\n    }\n\n    return null;\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) result.push(node);\n\n      const queryAllResult = node.querySelectorAll(selector);\n      if (queryAllResult) {\n        result.push.apply(result, queryAllResult);\n      }\n    }\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  firstNode() {\n    return this.rendered && this.nodes[0];\n  }\n\n  render(target, occupants, anchor) {\n    if (!this.nodes) {\n      const html = this.model ? this.model.get() : '';\n      this.nodes = insertHtml(html, target);\n    }\n\n    let nodes = this.nodes;\n\n    // progressive enhancement\n    if (occupants) {\n      let i = -1;\n      let next;\n\n      // start with the first node that should be rendered\n      while (occupants.length && (next = this.nodes[i + 1])) {\n        let n;\n        // look through the occupants until a matching node is found\n        while ((n = occupants.shift())) {\n          const t = n.nodeType;\n\n          if (\n            t === next.nodeType &&\n            ((t === 1 && n.outerHTML === next.outerHTML) ||\n              ((t === 3 || t === 8) && n.nodeValue === next.nodeValue))\n          ) {\n            this.nodes.splice(++i, 1, n); // replace the generated node with the existing one\n            break;\n          } else {\n            target.removeChild(n); // remove the non-matching existing node\n          }\n        }\n      }\n\n      if (i >= 0) {\n        // update the list of remaining nodes to attach, excluding any that were replaced by existing nodes\n        nodes = this.nodes.slice(i);\n      }\n\n      // update the anchor to be the next occupant\n      if (occupants.length) anchor = occupants[0];\n    }\n\n    // attach any remainging nodes to the parent\n    if (nodes.length) {\n      const frag = createDocumentFragment();\n      nodes.forEach(n => frag.appendChild(n));\n\n      if (anchor) {\n        target.insertBefore(frag, anchor);\n      } else {\n        target.appendChild(frag);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  toString() {\n    let value = this.model && this.model.get();\n    value = value != null ? '' + value : '';\n\n    return inAttribute() ? decodeCharacterReferences(value) : value;\n  }\n\n  unrender() {\n    if (this.nodes)\n      this.nodes.forEach(node => {\n        // defer detachment until all relevant outros are done\n        runloop.detachWhenReady({\n          node,\n          detach() {\n            detachNode(node);\n          }\n        });\n      });\n    this.rendered = false;\n    this.nodes = null;\n  }\n\n  update() {\n    if (this.rendered && this.dirty) {\n      this.dirty = false;\n\n      this.unrender();\n      this.render(this.up.findParentNode(), null, this.up.findNextNode(this));\n    } else {\n      // make sure to reset the dirty flag even if not rendered\n      this.dirty = false;\n    }\n  }\n}\n","import {\n  ALIAS,\n  ANCHOR,\n  AWAIT,\n  COMMENT,\n  COMPONENT,\n  DOCTYPE,\n  ELEMENT,\n  INTERPOLATOR,\n  PARTIAL,\n  SECTION,\n  TRIPLE,\n  YIELDER\n} from 'config/types';\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, EVENT, TRANSITION } from 'config/types';\nimport Alias from './Alias';\nimport Attribute from './element/Attribute';\nimport BindingFlag from './element/BindingFlag';\nimport Comment from './Comment';\nimport Component from './Component';\nimport Decorator from './element/Decorator';\nimport Doctype from './Doctype';\nimport Form from './element/specials/Form';\nimport Element from './Element';\nimport EventDirective from './shared/EventDirective';\nimport Interpolator from './Interpolator';\nimport Input from './element/specials/Input';\nimport Mapping from './component/Mapping';\nimport Option from './element/specials/Option';\nimport Partial from './Partial';\nimport Section from './Section';\nimport Select from './element/specials/Select';\nimport Textarea from './element/specials/Textarea';\nimport Text from './Text';\nimport Transition from './element/Transition';\nimport Triple from './Triple';\nimport getComponentConstructor from './component/getComponentConstructor';\nimport findElement from './shared/findElement';\nimport { findInstance } from 'shared/registry';\nimport asyncProxy from './asyncProxy';\nimport Await from './Await';\nimport { isString, isFunction } from 'utils/is';\n\nconst constructors = {};\nconstructors[ALIAS] = Alias;\nconstructors[ANCHOR] = Component;\nconstructors[AWAIT] = Await;\nconstructors[DOCTYPE] = Doctype;\nconstructors[INTERPOLATOR] = Interpolator;\nconstructors[PARTIAL] = Partial;\nconstructors[SECTION] = Section;\nconstructors[TRIPLE] = Triple;\nconstructors[YIELDER] = Partial;\n\nconstructors[ATTRIBUTE] = Attribute;\nconstructors[BINDING_FLAG] = BindingFlag;\nconstructors[DECORATOR] = Decorator;\nconstructors[EVENT] = EventDirective;\nconstructors[TRANSITION] = Transition;\nconstructors[COMMENT] = Comment;\n\nconst specialElements = {\n  doctype: Doctype,\n  form: Form,\n  input: Input,\n  option: Option,\n  select: Select,\n  textarea: Textarea\n};\n\nexport default function createItem(options) {\n  if (isString(options.template)) {\n    return new Text(options);\n  }\n\n  let ctor;\n  let name;\n  const type = options.template.t;\n\n  if (type === ELEMENT) {\n    name = options.template.e;\n\n    // could be a macro partial\n    ctor = findInstance('partials', options.up.ractive, name);\n    if (ctor) {\n      ctor = ctor.partials[name];\n      if (ctor.styleSet) {\n        options.macro = ctor;\n        return new Partial(options);\n      }\n    }\n\n    // could be component or element\n    ctor = getComponentConstructor(options.up.ractive, name);\n    if (ctor) {\n      if (isFunction(ctor.then)) {\n        return asyncProxy(ctor, options);\n      } else {\n        return new Component(options, ctor);\n      }\n    }\n\n    ctor = specialElements[name.toLowerCase()] || Element;\n    return new ctor(options);\n  }\n\n  let Item;\n\n  // component mappings are a special case of attribute\n  if (type === ATTRIBUTE) {\n    let el = options.owner;\n    if (!el || (el.type !== ANCHOR && el.type !== COMPONENT && el.type !== ELEMENT)) {\n      el = findElement(options.up);\n    }\n    options.element = el;\n\n    Item = el.type === COMPONENT || el.type === ANCHOR ? Mapping : Attribute;\n  } else {\n    Item = constructors[type];\n  }\n\n  if (!Item) throw new Error(`Unrecognised item type ${type}`);\n\n  return new Item(options);\n}\n","import runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\nimport { bind, render as callRender, unbind, unrender, update } from 'shared/methodCallers';\nimport { teardown } from 'src/Ractive/prototype/teardown';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { warnIfDebug } from 'utils/log';\nimport { createDocumentFragment } from 'utils/dom';\nimport {\n  ANCHOR,\n  ATTRIBUTE,\n  BINDING_FLAG,\n  COMPONENT,\n  DECORATOR,\n  EVENT,\n  TRANSITION,\n  YIELDER\n} from 'config/types';\nimport construct from 'src/Ractive/construct';\nimport initialise from 'src/Ractive/initialise';\nimport render from 'src/Ractive/render';\nimport Item from './shared/Item';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { assign, create } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\n\nexport default class Component extends Item {\n  constructor(options, ComponentConstructor) {\n    super(options);\n    let template = options.template;\n    this.isAnchor = template.t === ANCHOR;\n    this.type = this.isAnchor ? ANCHOR : COMPONENT; // override ELEMENT from super\n    let attrs = template.m;\n\n    const partials = template.p || {};\n    if (!('content' in partials)) partials.content = template.f || [];\n    this._partials = partials; // TEMP\n\n    if (this.isAnchor) {\n      this.name = template.n;\n\n      this.addChild = addChild;\n      this.removeChild = removeChild;\n    } else {\n      const instance = create(ComponentConstructor.prototype);\n\n      this.instance = instance;\n      this.name = template.e;\n\n      if (instance.el || instance.target) {\n        warnIfDebug(\n          `The <${this.name}> component has a default '${\n            instance.el ? 'el' : 'target'\n          }' property; it has been disregarded`\n        );\n        instance.el = instance.target = null;\n      }\n\n      // find container\n      let fragment = options.up;\n      let container;\n      while (fragment) {\n        if (fragment.owner.type === YIELDER) {\n          container = fragment.owner.container;\n          break;\n        }\n\n        fragment = fragment.parent;\n      }\n\n      // add component-instance-specific properties\n      instance.parent = this.up.ractive;\n      instance.container = container || null;\n      instance.root = instance.parent.root;\n      instance.component = this;\n\n      construct(this.instance, { partials });\n\n      // these can be modified during construction\n      template = this.template;\n      attrs = template.m;\n\n      // allow components that are so inclined to add programmatic mappings\n      if (isArray(this.mappings)) {\n        attrs = (attrs || []).concat(this.mappings);\n      } else if (isString(this.mappings)) {\n        attrs = (attrs || []).concat(parser.parse(this.mappings, { attributes: true }).t);\n      }\n\n      // for hackability, this could be an open option\n      // for any ractive instance, but for now, just\n      // for components and just for ractive...\n      instance._inlinePartials = partials;\n    }\n\n    this.attributeByName = {};\n    this.attributes = [];\n\n    if (attrs) {\n      const leftovers = [];\n      attrs.forEach(template => {\n        switch (template.t) {\n          case ATTRIBUTE:\n          case EVENT:\n            this.attributes.push(\n              createItem({\n                owner: this,\n                up: this.up,\n                template\n              })\n            );\n            break;\n\n          case TRANSITION:\n          case BINDING_FLAG:\n          case DECORATOR:\n            break;\n\n          default:\n            leftovers.push(template);\n            break;\n        }\n      });\n\n      if (leftovers.length) {\n        this.attributes.push(\n          new ConditionalAttribute({\n            owner: this,\n            up: this.up,\n            template: leftovers\n          })\n        );\n      }\n    }\n\n    this.eventHandlers = [];\n  }\n\n  bind() {\n    if (!this.isAnchor) {\n      this.attributes.forEach(bind);\n      this.eventHandlers.forEach(bind);\n\n      initialise(\n        this.instance,\n        {\n          partials: this._partials\n        },\n        {\n          cssIds: this.up.cssIds\n        }\n      );\n\n      if (this.instance.target || this.instance.el) this.extern = true;\n\n      this.bound = true;\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (!this.isAnchor && this.instance.fragment) this.instance.fragment.destroyed();\n  }\n\n  detach() {\n    if (this.isAnchor) {\n      if (this.instance) return this.instance.fragment.detach();\n      return createDocumentFragment();\n    }\n\n    return this.instance.fragment.detach();\n  }\n\n  find(selector, options) {\n    if (this.instance) return this.instance.fragment.find(selector, options);\n  }\n\n  findAll(selector, options) {\n    if (this.instance) this.instance.fragment.findAll(selector, options);\n  }\n\n  findComponent(name, options) {\n    if (!name || this.name === name) return this.instance;\n\n    if (this.instance.fragment) {\n      return this.instance.fragment.findComponent(name, options);\n    }\n  }\n\n  findAllComponents(name, options) {\n    const { result } = options;\n\n    if (this.instance && (!name || this.name === name)) {\n      result.push(this.instance);\n    }\n\n    if (this.instance) this.instance.findAllComponents(name, options);\n  }\n\n  firstNode(skipParent) {\n    if (this.instance) return this.instance.fragment.firstNode(skipParent);\n  }\n\n  getContext(...assigns) {\n    assigns.unshift(this.instance);\n    return getRactiveContext.apply(null, assigns);\n  }\n\n  rebound(update) {\n    this.attributes.forEach(x => x.rebound(update));\n  }\n\n  render(target, occupants) {\n    if (this.isAnchor) {\n      this.rendered = true;\n      this.target = target;\n\n      if (!checking.length) {\n        checking.push(this.ractive);\n        if (occupants) {\n          this.occupants = occupants;\n          checkAnchors();\n          this.occupants = null;\n        } else {\n          runloop.scheduleTask(checkAnchors, true);\n        }\n      }\n    } else {\n      this.attributes.forEach(callRender);\n      this.eventHandlers.forEach(callRender);\n\n      if (this.extern) {\n        this.instance.delegate = false;\n        this.instance.render();\n      } else {\n        render(this.instance, target, null, occupants);\n      }\n\n      this.rendered = true;\n    }\n  }\n\n  shuffled() {\n    super.shuffled();\n    this.instance &&\n      !this.instance.isolated &&\n      this.instance.fragment &&\n      this.instance.fragment.shuffled();\n  }\n\n  toString() {\n    if (this.instance) return this.instance.toHTML();\n  }\n\n  unbind() {\n    if (!this.isAnchor) {\n      this.bound = false;\n\n      this.attributes.forEach(unbind);\n\n      teardown(this.instance, () => runloop.promise());\n    }\n  }\n\n  unrender(shouldDestroy) {\n    this.shouldDestroy = shouldDestroy;\n\n    if (this.isAnchor) {\n      if (this.item) unrenderItem(this, this.item);\n      this.target = null;\n      if (!checking.length) {\n        checking.push(this.ractive);\n        runloop.scheduleTask(checkAnchors, true);\n      }\n    } else {\n      this.instance.unrender();\n      this.instance.el = this.instance.target = null;\n      this.attributes.forEach(unrender);\n      this.eventHandlers.forEach(unrender);\n    }\n\n    this.rendered = false;\n  }\n\n  update() {\n    this.dirty = false;\n    if (this.instance) {\n      this.instance.fragment.update();\n      this.attributes.forEach(update);\n      this.eventHandlers.forEach(update);\n    }\n  }\n}\n\nfunction addChild(meta) {\n  if (this.item) this.removeChild(this.item);\n\n  const child = meta.instance;\n  meta.anchor = this;\n\n  meta.up = this.up;\n  meta.name = meta.nameOption || this.name;\n  this.name = meta.name;\n\n  if (!child.isolated) child.viewmodel.attached(this.up);\n\n  // render as necessary\n  if (this.rendered) {\n    renderItem(this, meta);\n  }\n}\n\nfunction removeChild(meta) {\n  // unrender as necessary\n  if (this.item === meta) {\n    unrenderItem(this, meta);\n    this.name = this.template.n;\n  }\n}\n\nfunction renderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = false;\n  meta.up = anchor.up;\n\n  anchor.item = meta;\n  anchor.instance = meta.instance;\n  const nextNode = anchor.up.findNextNode(anchor);\n\n  if (meta.instance.fragment.rendered) {\n    meta.instance.unrender();\n  }\n\n  meta.partials = meta.instance.partials;\n  meta.instance.partials = assign(create(meta.partials), meta.partials, anchor._partials);\n\n  meta.instance.fragment.unbind();\n  meta.instance.fragment.componentParent = anchor.up;\n  meta.instance.fragment.bind(meta.instance.viewmodel);\n\n  anchor.attributes.forEach(bind);\n  anchor.eventHandlers.forEach(bind);\n  anchor.attributes.forEach(callRender);\n  anchor.eventHandlers.forEach(callRender);\n\n  const target = anchor.up.findParentNode();\n  render(meta.instance, target, target.contains(nextNode) ? nextNode : null, anchor.occupants);\n\n  if (meta.lastBound !== anchor) {\n    meta.lastBound = anchor;\n  }\n}\n\nfunction unrenderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = true;\n  meta.instance.unrender();\n\n  anchor.eventHandlers.forEach(unrender);\n  anchor.attributes.forEach(unrender);\n  anchor.eventHandlers.forEach(unbind);\n  anchor.attributes.forEach(unbind);\n\n  meta.instance.el = meta.instance.anchor = null;\n  meta.instance.fragment.componentParent = null;\n  meta.up = null;\n  meta.anchor = null;\n  anchor.item = null;\n  anchor.instance = null;\n}\n\nlet checking = [];\nexport function checkAnchors() {\n  const list = checking;\n  checking = [];\n\n  list.forEach(updateAnchors);\n}\n","import { findInViewHierarchy } from 'shared/registry';\nimport { warnOnce } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport noop from 'utils/noop';\nimport runloop from 'src/global/runloop';\nimport { rebindMatch } from 'src/shared/rebind';\nimport findElement from '../shared/findElement';\nimport { setupArgsFn, teardownArgsFn } from '../shared/directiveArgs';\n\nconst missingDecorator = {\n  update: noop,\n  teardown: noop\n};\n\nexport default class Decorator {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.up = options.up || this.owner.up;\n    this.ractive = this.owner.ractive;\n    const template = (this.template = options.template);\n\n    this.name = template.n;\n\n    this.node = null;\n    this.handle = null;\n\n    this.element.decorators.push(this);\n  }\n\n  bind() {\n    setupArgsFn(this, this.template, this.up, { register: true });\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      // decorators may be owned directly by an element or by a fragment if conditional\n      this.owner.bubble();\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n    this.shouldDestroy = true;\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebind(next, previous, safe) {\n    const idx = this.models.indexOf(previous);\n    if (!~idx) return;\n\n    next = rebindMatch(this.template.f.r[idx], next, previous);\n    if (next === previous) return;\n\n    previous.unregister(this);\n    this.models.splice(idx, 1, next);\n    if (next) next.addShuffleRegister(this, 'mark');\n\n    if (!safe) this.bubble();\n  }\n\n  rebound(update) {\n    teardownArgsFn(this, this.template);\n    setupArgsFn(this, this.template, this.up, { register: true });\n    if (update) this.bubble();\n  }\n\n  render() {\n    this.shouldDestroy = false;\n    if (this.handle) this.unrender();\n    runloop.scheduleTask(() => {\n      // bail if the host element has managed to become unrendered\n      if (!this.element.rendered) return;\n\n      const fn = findInViewHierarchy('decorators', this.ractive, this.name);\n\n      if (!fn) {\n        warnOnce(missingPlugin(this.name, 'decorator'));\n        this.handle = missingDecorator;\n        return;\n      }\n\n      this.node = this.element.node;\n\n      let args;\n      if (this.fn) {\n        args = this.models.map(model => {\n          if (!model) return undefined;\n\n          return model.get();\n        });\n        args = this.fn.apply(this.ractive, args);\n      }\n\n      this.handle = fn.apply(this.ractive, [this.node].concat(args));\n\n      if (!this.handle || !this.handle.teardown) {\n        throw new Error(\n          `The '${this.name}' decorator must return an object with a teardown method`\n        );\n      }\n\n      // watch out for decorators that cause their host element to be unrendered\n      if (this.shouldDestroy) this.destroyed();\n    }, true);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    teardownArgsFn(this, this.template);\n  }\n\n  unrender(shouldDestroy) {\n    if ((!shouldDestroy || this.element.rendered) && this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n  }\n\n  update() {\n    const instance = this.handle;\n\n    if (!this.dirty) {\n      if (instance && instance.invalidate) {\n        runloop.scheduleTask(() => instance.invalidate(), true);\n      }\n      return;\n    }\n\n    this.dirty = false;\n\n    if (instance) {\n      if (!instance.update) {\n        this.unrender();\n        this.render();\n      } else {\n        const args = this.models.map(model => model && model.get());\n        instance.update.apply(this.ractive, this.fn.apply(this.ractive, args));\n      }\n    }\n  }\n}\n","import noop from 'utils/noop';\nimport Item from './shared/Item';\n\nexport default class Doctype extends Item {\n  toString() {\n    return '<!DOCTYPE' + this.template.a + '>';\n  }\n}\n\nconst proto = Doctype.prototype;\nproto.bind = proto.render = proto.teardown = proto.unbind = proto.unrender = proto.update = noop;\n","import runloop from 'src/global/runloop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport noop from 'utils/noop';\nimport findElement from '../../shared/findElement';\n\nexport default class Binding {\n  constructor(element, name = 'value') {\n    this.element = element;\n    this.ractive = element.ractive;\n    this.attribute = element.attributeByName[name];\n\n    const interpolator = this.attribute.interpolator;\n    interpolator.twowayBinding = this;\n\n    const model = interpolator.model;\n\n    if (model.isReadonly && !model.setRoot) {\n      const keypath = model.getKeypath().replace(/^@/, '');\n      warnOnceIfDebug(\n        `Cannot use two-way binding on <${\n          element.name\n        }> element: ${keypath} is read-only. To suppress this warning use <${\n          element.name\n        } twoway='false'...>`,\n        { ractive: this.ractive }\n      );\n      return false;\n    }\n\n    this.attribute.isTwoway = true;\n    this.model = model;\n\n    // initialise value, if it's undefined\n    let value = model.get();\n    this.wasUndefined = value === undefined;\n\n    if (value === undefined && this.getInitialValue) {\n      value = this.getInitialValue();\n      model.set(value);\n    }\n    this.lastVal(true, value);\n\n    const parentForm = findElement(this.element, false, 'form');\n    if (parentForm) {\n      this.resetValue = value;\n      parentForm.formBindings.push(this);\n    }\n  }\n\n  bind() {\n    this.model.registerTwowayBinding(this);\n  }\n\n  handleChange() {\n    const value = this.getValue();\n    if (this.lastVal() === value) return;\n\n    runloop.start();\n    this.attribute.locked = true;\n    this.model.set(value);\n    this.lastVal(true, value);\n\n    // if the value changes before observers fire, unlock to be updatable cause something weird and potentially freezy is up\n    if (this.model.get() !== value) this.attribute.locked = false;\n    else runloop.scheduleTask(() => (this.attribute.locked = false));\n\n    runloop.end();\n  }\n\n  lastVal(setting, value) {\n    if (setting) this.lastValue = value;\n    else return this.lastValue;\n  }\n\n  rebind(next, previous) {\n    if (this.model && this.model === previous) previous.unregisterTwowayBinding(this);\n    if (next) {\n      this.model = next;\n      runloop.scheduleTask(() => next.registerTwowayBinding(this));\n    }\n  }\n\n  rebound() {\n    if (this.model) this.model.unregisterTwowayBinding(this);\n    this.model = this.attribute.interpolator.model;\n    this.model.registerTwowayBinding(this);\n  }\n\n  render() {\n    this.node = this.element.node;\n    this.node._ractive.binding = this;\n    this.rendered = true; // TODO is this used anywhere?\n  }\n\n  setFromNode(node) {\n    this.model.set(node.value);\n  }\n\n  unbind() {\n    this.model.unregisterTwowayBinding(this);\n  }\n}\n\nBinding.prototype.unrender = noop;\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class CheckboxBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n    this.element.off('click', handleDomEvent);\n  }\n\n  getInitialValue() {\n    return !!this.element.getAttribute('checked');\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\n\nexport default function getBindingGroup(group, model, getValue) {\n  const hash = `${group}-bindingGroup`;\n  return model[hash] || (model[hash] = new BindingGroup(hash, model, getValue));\n}\n\nclass BindingGroup {\n  constructor(hash, model, getValue) {\n    this.model = model;\n    this.hash = hash;\n    this.getValue = () => {\n      this.value = getValue.call(this);\n      return this.value;\n    };\n\n    this.bindings = [];\n  }\n\n  add(binding) {\n    this.bindings.push(binding);\n  }\n\n  bind() {\n    this.value = this.model.get();\n    this.model.registerTwowayBinding(this);\n    this.bound = true;\n  }\n\n  remove(binding) {\n    removeFromArray(this.bindings, binding);\n    if (!this.bindings.length) {\n      this.unbind();\n    }\n  }\n\n  unbind() {\n    this.model.unregisterTwowayBinding(this);\n    this.bound = false;\n    delete this.model[this.hash];\n  }\n}\n\nBindingGroup.prototype.rebind = Binding.prototype.rebind;\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\nimport { isArray } from 'utils/is';\n\nconst push = [].push;\n\nfunction getValue() {\n  const all = this.bindings\n    .filter(b => b.node && b.node.checked)\n    .map(b => b.element.getAttribute('value'));\n  const res = [];\n  all.forEach(v => {\n    if (!this.bindings[0].arrayContains(res, v)) res.push(v);\n  });\n  return res;\n}\n\nexport default class CheckboxNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n    // Each input has a reference to an array containing it and its\n    // group, as two-way binding depends on being able to ascertain\n    // the status of all inputs within the group\n    this.group = getBindingGroup('checkboxes', this.model, getValue);\n    this.group.add(this);\n\n    if (this.noInitialValue) {\n      this.group.noInitialValue = true;\n    }\n\n    // If no initial value was set, and this input is checked, we\n    // update the model\n    if (this.group.noInitialValue && this.element.getAttribute('checked')) {\n      const existingValue = this.model.get();\n      const bindingValue = this.element.getAttribute('value');\n\n      if (!this.arrayContains(existingValue, bindingValue)) {\n        push.call(existingValue, bindingValue); // to avoid triggering runloop with array adaptor\n      }\n    }\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n  }\n\n  getInitialValue() {\n    // This only gets called once per group (of inputs that\n    // share a name), because it only gets called if there\n    // isn't an initial value. By the same token, we can make\n    // a note of that fact that there was no initial value,\n    // and populate it using any `checked` attributes that\n    // exist (which users should avoid, but which we should\n    // support anyway to avoid breaking expectations)\n    this.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\n    return [];\n  }\n\n  getValue() {\n    return this.group.value;\n  }\n\n  handleChange() {\n    this.isChecked = this.element.node.checked;\n    this.group.value = this.model.get();\n    const value = this.element.getAttribute('value');\n    if (this.isChecked && !this.arrayContains(this.group.value, value)) {\n      this.group.value.push(value);\n    } else if (!this.isChecked && this.arrayContains(this.group.value, value)) {\n      this.removeFromArray(this.group.value, value);\n    }\n    // make sure super knows there's a change\n    this.lastValue = null;\n    super.handleChange();\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    const existingValue = this.model.get();\n    const bindingValue = this.element.getAttribute('value');\n\n    if (isArray(existingValue)) {\n      this.isChecked = this.arrayContains(existingValue, bindingValue);\n    } else {\n      this.isChecked = this.element.compare(existingValue, bindingValue);\n    }\n    node.name = '{{' + this.model.getKeypath() + '}}';\n    node.checked = this.isChecked;\n\n    this.element.on('change', handleDomEvent);\n\n    // in case of IE emergency, bind to click event as well\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.group.bindings.forEach(binding => (binding.wasUndefined = true));\n\n    if (node.checked) {\n      const valueSoFar = this.group.getValue();\n      valueSoFar.push(this.element.getAttribute('value'));\n\n      this.group.model.set(valueSoFar);\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n    el.off('click', handleDomEvent);\n  }\n\n  arrayContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.element.compare(optionValue, selectValue[i])) return true;\n    }\n    return false;\n  }\n\n  removeFromArray(array, item) {\n    if (!array) return;\n    let i = array.length;\n    while (i--) {\n      if (this.element.compare(item, array[i])) {\n        array.splice(i, 1);\n      }\n    }\n  }\n}\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class ContentEditableBinding extends Binding {\n  getInitialValue() {\n    return this.element.fragment ? this.element.fragment.toString() : '';\n  }\n\n  getValue() {\n    return this.element.node.innerHTML;\n  }\n\n  render() {\n    super.render();\n\n    const el = this.element;\n\n    el.on('change', handleDomEvent);\n    el.on('blur', handleDomEvent);\n\n    if (!this.ractive.lazy) {\n      el.on('input', handleDomEvent);\n\n      if (this.node.attachEvent) {\n        el.on('keyup', handleDomEvent);\n      }\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.innerHTML);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('blur', handleDomEvent);\n    el.off('change', handleDomEvent);\n    el.off('input', handleDomEvent);\n    el.off('keyup', handleDomEvent);\n  }\n}\n","import { isNumeric } from 'utils/is';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nfunction handleBlur() {\n  handleDomEvent.call(this);\n\n  const value = this._ractive.binding.model.get();\n  this.value = value == undefined ? '' : value;\n}\n\nfunction handleDelay(delay) {\n  let timeout;\n\n  return function() {\n    if (timeout) clearTimeout(timeout);\n\n    timeout = setTimeout(() => {\n      const binding = this._ractive.binding;\n      if (binding.rendered) handleDomEvent.call(this);\n      timeout = null;\n    }, delay);\n  };\n}\n\nexport default class GenericBinding extends Binding {\n  getInitialValue() {\n    return '';\n  }\n\n  getValue() {\n    return this.node.value;\n  }\n\n  render() {\n    super.render();\n\n    // any lazy setting for this element overrides the root\n    // if the value is a number, it's a timeout\n    let lazy = this.ractive.lazy;\n    let timeout = false;\n    const el = this.element;\n\n    if ('lazy' in this.element) {\n      lazy = this.element.lazy;\n    }\n\n    if (isNumeric(lazy)) {\n      timeout = +lazy;\n      lazy = false;\n    }\n\n    this.handler = timeout ? handleDelay(timeout) : handleDomEvent;\n\n    const node = this.node;\n\n    el.on('change', handleDomEvent);\n\n    if (node.type !== 'file') {\n      if (!lazy) {\n        el.on('input', this.handler);\n\n        // IE is a special snowflake\n        if (node.attachEvent) {\n          el.on('keyup', this.handler);\n        }\n      }\n\n      el.on('blur', handleBlur);\n    }\n  }\n\n  unrender() {\n    const el = this.element;\n    this.rendered = false;\n\n    el.off('change', handleDomEvent);\n    el.off('input', this.handler);\n    el.off('keyup', this.handler);\n    el.off('blur', handleBlur);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class FileBinding extends GenericBinding {\n  getInitialValue() {\n    /* istanbul ignore next */\n    return undefined;\n  }\n\n  getValue() {\n    /* istanbul ignore next */\n    return this.node.files;\n  }\n\n  render() {\n    /* istanbul ignore next */\n    this.element.lazy = false;\n    /* istanbul ignore next */\n    super.render();\n  }\n\n  setFromNode(node) {\n    /* istanbul ignore next */\n    this.model.set(node.files);\n  }\n}\n","import { arrayContentsMatch } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class MultipleSelectBinding extends Binding {\n  getInitialValue() {\n    return this.element.options\n      .filter(option => option.getAttribute('selected'))\n      .map(option => option.getAttribute('value'));\n  }\n\n  getValue() {\n    const options = this.element.node.options;\n    const len = options.length;\n\n    const selectedValues = [];\n\n    for (let i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (option.selected) {\n        const optionValue = option._ractive ? option._ractive.value : option.value;\n        selectedValues.push(optionValue);\n      }\n    }\n\n    return selectedValues;\n  }\n\n  handleChange() {\n    const attribute = this.attribute;\n    const previousValue = attribute.getValue();\n\n    const value = this.getValue();\n\n    if (previousValue === undefined || !arrayContentsMatch(value, previousValue)) {\n      super.handleChange();\n    }\n\n    return this;\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.model.get() === undefined) {\n      // get value from DOM, if possible\n      this.handleChange();\n    }\n  }\n\n  setFromNode(node) {\n    const selectedOptions = getSelectedOptions(node);\n    let i = selectedOptions.length;\n    const result = new Array(i);\n\n    while (i--) {\n      const option = selectedOptions[i];\n      result[i] = option._ractive ? option._ractive.value : option.value;\n    }\n\n    this.model.set(result);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class NumericBinding extends GenericBinding {\n  getInitialValue() {\n    return undefined;\n  }\n\n  getValue() {\n    const value = parseFloat(this.node.value);\n    return isNaN(value) ? undefined : value;\n  }\n\n  setFromNode(node) {\n    const value = parseFloat(node.value);\n    if (!isNaN(value)) this.model.set(value);\n  }\n}\n","import runloop from 'src/global/runloop';\nimport { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nconst siblings = {};\n\nfunction getSiblings(hash) {\n  return siblings[hash] || (siblings[hash] = []);\n}\n\nexport default class RadioBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n\n    this.siblings = getSiblings(this.ractive._guid + this.element.getAttribute('name'));\n    this.siblings.push(this);\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  handleChange() {\n    runloop.start();\n\n    this.siblings.forEach(binding => {\n      binding.model.set(binding.getValue());\n    });\n\n    runloop.end();\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n\n  unbind() {\n    removeFromArray(this.siblings, this);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n    this.element.off('click', handleDomEvent);\n  }\n}\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\n\nfunction getValue() {\n  const checked = this.bindings.filter(b => b.node.checked);\n  if (checked.length > 0) {\n    return checked[0].element.getAttribute('value');\n  }\n}\n\nexport default class RadioNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.group = getBindingGroup('radioname', this.model, getValue);\n    this.group.add(this);\n\n    if (element.checked) {\n      this.group.value = this.getValue();\n    }\n\n    this.attribute.interpolator.pathChanged = () => this.updateName();\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('checked')) {\n      return this.element.getAttribute('value');\n    }\n  }\n\n  getValue() {\n    return this.element.getAttribute('value');\n  }\n\n  handleChange() {\n    // If this <input> is the one that's checked, then the value of its\n    // `name` model gets set to its value\n    if (this.node.checked) {\n      this.group.value = this.getValue();\n      super.handleChange();\n    }\n\n    this.updateName();\n  }\n\n  lastVal(setting, value) {\n    if (!this.group) return;\n    if (setting) this.group.lastValue = value;\n    else return this.group.lastValue;\n  }\n\n  rebind(next, previous) {\n    super.rebind(next, previous);\n    this.updateName();\n  }\n\n  rebound(update) {\n    super.rebound(update);\n    this.updateName();\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    this.updateName();\n    node.checked = this.element.compare(this.model.get(), this.element.getAttribute('value'));\n\n    this.element.on('change', handleDomEvent);\n\n    if (node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    if (node.checked) {\n      this.group.model.set(this.element.getAttribute('value'));\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n    el.off('click', handleDomEvent);\n  }\n\n  updateName() {\n    if (this.node) this.node.name = `{{${this.model.getKeypath()}}}`;\n  }\n}\n","import runloop from 'src/global/runloop';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class SingleSelectBinding extends Binding {\n  forceUpdate() {\n    const value = this.getValue();\n\n    if (value !== undefined) {\n      this.attribute.locked = true;\n      runloop.scheduleTask(() => (this.attribute.locked = false));\n      this.model.set(value);\n    }\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('value') !== undefined) {\n      return;\n    }\n\n    const options = this.element.options;\n    const len = options.length;\n\n    if (!len) return;\n\n    let value;\n    let optionWasSelected;\n    let i = len;\n\n    // take the final selected option...\n    while (i--) {\n      const option = options[i];\n\n      if (option.getAttribute('selected')) {\n        if (!option.getAttribute('disabled')) {\n          value = option.getAttribute('value');\n        }\n\n        optionWasSelected = true;\n        break;\n      }\n    }\n\n    // or the first non-disabled option, if none are selected\n    if (!optionWasSelected) {\n      while (++i < len) {\n        if (!options[i].getAttribute('disabled')) {\n          value = options[i].getAttribute('value');\n          break;\n        }\n      }\n    }\n\n    // This is an optimisation (aka hack) that allows us to forgo some\n    // other more expensive work\n    // TODO does it still work? seems at odds with new architecture\n    if (value !== undefined) {\n      this.element.attributeByName.value.value = value;\n    }\n\n    return value;\n  }\n\n  getValue() {\n    const options = this.node.options;\n    const len = options.length;\n\n    let i;\n    for (i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (options[i].selected && !options[i].disabled) {\n        return option._ractive ? option._ractive.value : option.value;\n      }\n    }\n  }\n\n  render() {\n    super.render();\n    this.element.on('change', handleDomEvent);\n  }\n\n  setFromNode(node) {\n    const option = getSelectedOptions(node)[0];\n    this.model.set(option._ractive ? option._ractive.value : option.value);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import { ATTRIBUTE, BINDING_FLAG, DECORATOR, DELEGATE_FLAG, EVENT, TRANSITION } from 'config/types';\nimport { win } from 'config/environment';\nimport { html, svg } from 'config/namespaces';\nimport { toArray, addToArray, removeFromArray } from 'utils/array';\nimport { escapeHtml, voidElements } from 'utils/html';\nimport { createElement, detachNode, matches, safeAttributeString } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport Context from 'shared/Context';\nimport { destroyed } from 'shared/methodCallers';\nimport { ContainerItem } from './shared/Item';\nimport Fragment from '../Fragment';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport findElement from './shared/findElement';\nimport selectBinding from './element/binding/selectBinding';\nimport { assign, create, defineProperty, keys } from 'utils/object';\nimport { isString } from 'utils/is';\n\nconst endsWithSemi = /;\\s*$/;\n\nexport default class Element extends ContainerItem {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.e.toLowerCase();\n\n    // find parent element\n    this.parent = findElement(this.up, false);\n\n    if (this.parent && this.parent.name === 'option') {\n      throw new Error(\n        `An <option> element cannot contain other elements (encountered <${this.name}>)`\n      );\n    }\n\n    this.decorators = [];\n\n    // create attributes\n    this.attributeByName = {};\n\n    let attrs;\n    let n, attr, val, cls, name, template, leftovers;\n\n    const m = this.template.m;\n    const len = (m && m.length) || 0;\n\n    for (let i = 0; i < len; i++) {\n      template = m[i];\n      if (template.g) {\n        (this.statics || (this.statics = {}))[template.n] = isString(template.f)\n          ? template.f\n          : template.n;\n      } else {\n        switch (template.t) {\n          case ATTRIBUTE:\n          case BINDING_FLAG:\n          case DECORATOR:\n          case EVENT:\n          case TRANSITION:\n            attr = createItem({\n              owner: this,\n              up: this.up,\n              template\n            });\n\n            n = template.n;\n\n            attrs = attrs || (attrs = this.attributes = []);\n\n            if (n === 'value') val = attr;\n            else if (n === 'name') name = attr;\n            else if (n === 'class') cls = attr;\n            else attrs.push(attr);\n\n            break;\n\n          case DELEGATE_FLAG:\n            this.delegate = false;\n            break;\n\n          default:\n            (leftovers || (leftovers = [])).push(template);\n            break;\n        }\n      }\n    }\n\n    if (val) attrs.push(val);\n    if (name) attrs.push(name);\n    if (cls) attrs.unshift(cls);\n\n    if (leftovers) {\n      (attrs || (this.attributes = [])).push(\n        new ConditionalAttribute({\n          owner: this,\n          up: this.up,\n          template: leftovers\n        })\n      );\n\n      // empty leftovers array\n      leftovers = [];\n    }\n\n    // create children\n    if (options.template.f && !options.deferContent) {\n      this.fragment = new Fragment({\n        template: options.template.f,\n        owner: this,\n        cssIds: null\n      });\n    }\n\n    this.binding = null; // filled in later\n  }\n\n  bind() {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.binding = true;\n      const len = attrs.length;\n      for (let i = 0; i < len; i++) attrs[i].bind();\n      attrs.binding = false;\n    }\n\n    if (this.fragment) this.fragment.bind();\n\n    // create two-way binding if necessary\n    if (!this.binding) this.recreateTwowayBinding();\n    else this.binding.bind();\n  }\n\n  createTwowayBinding() {\n    if ('twoway' in this ? this.twoway : this.ractive.twoway) {\n      const Binding = selectBinding(this);\n      if (Binding) {\n        const binding = new Binding(this);\n        if (binding && binding.model) return binding;\n      }\n    }\n  }\n\n  destroyed() {\n    if (this.attributes) this.attributes.forEach(destroyed);\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  detach() {\n    // if this element is no longer rendered, the transitions are complete and the attributes can be torn down\n    if (!this.rendered) this.destroyed();\n\n    return detachNode(this.node);\n  }\n\n  find(selector, options) {\n    if (this.node && matches(this.node, selector)) return this.node;\n    if (this.fragment) {\n      return this.fragment.find(selector, options);\n    }\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n\n    if (matches(this.node, selector)) {\n      result.push(this.node);\n    }\n\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findNextNode() {\n    return null;\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getAttribute(name) {\n    if (this.statics && name in this.statics) return this.statics[name];\n    const attribute = this.attributeByName[name];\n    return attribute ? attribute.getValue() : undefined;\n  }\n\n  getContext(...assigns) {\n    if (this.fragment) return this.fragment.getContext(...assigns);\n\n    if (!this.ctx) this.ctx = new Context(this.up, this);\n    assigns.unshift(create(this.ctx));\n    return assign.apply(null, assigns);\n  }\n\n  off(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = this.listeners && this.listeners[event];\n\n    if (!ref) return;\n    removeFromArray(ref, callback);\n\n    if (delegate) {\n      const listeners =\n        (delegate.listeners || (delegate.listeners = [])) &&\n        (delegate.listeners[event] || (delegate.listeners[event] = []));\n      if (listeners.refs && !--listeners.refs) delegate.off(event, delegateHandler, true);\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        rem.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, true);\n        add.call(n, event, handler, false);\n      }\n    }\n  }\n\n  on(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = (this.listeners || (this.listeners = {}))[event] || (this.listeners[event] = []);\n\n    if (delegate) {\n      const listeners =\n        ((delegate.listeners || (delegate.listeners = [])) && delegate.listeners[event]) ||\n        (delegate.listeners[event] = []);\n      if (!listeners.refs) {\n        listeners.refs = 0;\n        delegate.on(event, delegateHandler, true);\n        listeners.refs++;\n      } else {\n        listeners.refs++;\n      }\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        add.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, false);\n        add.call(n, event, handler, true);\n      }\n    }\n\n    addToArray(this.listeners[event], callback);\n  }\n\n  recreateTwowayBinding() {\n    if (this.binding) {\n      this.binding.unbind();\n      this.binding.unrender();\n    }\n\n    if ((this.binding = this.createTwowayBinding())) {\n      this.binding.bind();\n      if (this.rendered) this.binding.render();\n    }\n  }\n\n  rebound(update) {\n    super.rebound(update);\n    if (this.attributes) this.attributes.forEach(x => x.rebound(update));\n    if (this.binding) this.binding.rebound(update);\n  }\n\n  render(target, occupants) {\n    // TODO determine correct namespace\n    this.namespace = getNamespace(this);\n\n    let node;\n    let existing = false;\n\n    if (occupants) {\n      let n;\n      while ((n = occupants.shift())) {\n        if (\n          n.nodeName.toUpperCase() === this.template.e.toUpperCase() &&\n          n.namespaceURI === this.namespace\n        ) {\n          this.node = node = n;\n          existing = true;\n          break;\n        } else {\n          detachNode(n);\n        }\n      }\n    }\n\n    if (!existing && this.node) {\n      node = this.node;\n      target.appendChild(node);\n      existing = true;\n    }\n\n    if (!node) {\n      const name = this.template.e;\n      node = createElement(\n        this.namespace === html ? name.toLowerCase() : name,\n        this.namespace,\n        this.getAttribute('is')\n      );\n      this.node = node;\n    }\n\n    if (this.statics) {\n      keys(this.statics).forEach(k => {\n        node.setAttribute(k, this.statics[k]);\n      });\n    }\n\n    // tie the node to this vdom element\n    defineProperty(node, '_ractive', {\n      value: {\n        proxy: this\n      },\n      configurable: true\n    });\n\n    if (existing && this.foundNode) this.foundNode(node);\n\n    // register intro before rendering content so children can find the intro\n    const intro = this.intro;\n    if (intro && intro.shouldFire('intro')) {\n      intro.isIntro = true;\n      intro.isOutro = false;\n      runloop.registerTransition(intro);\n    }\n\n    if (this.fragment) {\n      const children = existing ? toArray(node.childNodes) : undefined;\n\n      this.fragment.render(node, children);\n\n      // clean up leftover children\n      if (children) {\n        children.forEach(detachNode);\n      }\n    }\n\n    if (existing) {\n      // store initial values for two-way binding\n      if (this.binding && this.binding.wasUndefined) this.binding.setFromNode(node);\n      // remove unused attributes\n      let i = node.attributes.length;\n      while (i--) {\n        const name = node.attributes[i].name;\n        if (!(name in this.attributeByName) && (!this.statics || !(name in this.statics)))\n          node.removeAttribute(name);\n      }\n    }\n\n    // Is this a top-level node of a component? If so, we may need to add\n    // a data-ractive-css attribute, for CSS encapsulation\n    if (this.up.cssIds) {\n      node.setAttribute('data-ractive-css', this.up.cssIds.map(x => `{${x}}`).join(' '));\n    }\n\n    if (this.attributes) {\n      const len = this.attributes.length;\n      for (let i = 0; i < len; i++) this.attributes[i].render();\n    }\n    if (this.binding) this.binding.render();\n\n    if (!this.up.delegate && this.listeners) {\n      const ls = this.listeners;\n      for (const k in ls) {\n        if (ls[k] && ls[k].length) this.node.addEventListener(k, handler, !!ls[k].refs);\n      }\n    }\n\n    if (!existing) {\n      target.appendChild(node);\n    }\n\n    this.rendered = true;\n  }\n\n  toString() {\n    const tagName = this.template.e;\n\n    let attrs = (this.attributes && this.attributes.map(stringifyAttribute).join('')) || '';\n\n    if (this.statics)\n      keys(this.statics).forEach(\n        k => k !== 'class' && k !== 'style' && (attrs = ` ${k}=\"${this.statics[k]}\"` + attrs)\n      );\n\n    // Special case - selected options\n    if (this.name === 'option' && this.isSelected()) {\n      attrs += ' selected';\n    }\n\n    // Special case - two-way radio name bindings\n    if (this.name === 'input' && inputIsCheckedRadio(this)) {\n      attrs += ' checked';\n    }\n\n    // Special case style and class attributes and directives\n    let style = this.statics ? this.statics.style : undefined;\n    let cls = this.statics ? this.statics.class : undefined;\n    this.attributes &&\n      this.attributes.forEach(attr => {\n        if (attr.name === 'class') {\n          cls = (cls || '') + (cls ? ' ' : '') + safeAttributeString(attr.getString());\n        } else if (attr.name === 'style') {\n          style = (style || '') + (style ? ' ' : '') + safeAttributeString(attr.getString());\n          if (style && !endsWithSemi.test(style)) style += ';';\n        } else if (attr.style) {\n          style =\n            (style || '') +\n            (style ? ' ' : '') +\n            `${attr.style}: ${safeAttributeString(attr.getString())};`;\n        } else if (attr.inlineClass && attr.getValue()) {\n          cls = (cls || '') + (cls ? ' ' : '') + attr.inlineClass;\n        }\n      });\n    // put classes first, then inline style\n    if (style !== undefined) attrs = ' style' + (style ? `=\"${style}\"` : '') + attrs;\n    if (cls !== undefined) attrs = ' class' + (cls ? `=\"${cls}\"` : '') + attrs;\n\n    if (this.up.cssIds) {\n      attrs += ` data-ractive-css=\"${this.up.cssIds.map(x => `{${x}}`).join(' ')}\"`;\n    }\n\n    let str = `<${tagName}${attrs}>`;\n\n    if (voidElements[this.name.toLowerCase()]) return str;\n\n    // Special case - textarea\n    if (this.name === 'textarea' && this.getAttribute('value') !== undefined) {\n      str += escapeHtml(this.getAttribute('value'));\n    } else if (this.getAttribute('contenteditable') !== undefined) {\n      // Special case - contenteditable\n      str += this.getAttribute('value') || '';\n    }\n\n    if (this.fragment) {\n      str += this.fragment.toString(!/^(?:script|style)$/i.test(this.template.e)); // escape text unless script/style\n    }\n\n    str += `</${tagName}>`;\n    return str;\n  }\n\n  unbind() {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.unbinding = true;\n      const len = attrs.length;\n      for (let i = 0; i < len; i++) attrs[i].unbind();\n      attrs.unbinding = false;\n    }\n\n    if (this.binding) this.binding.unbind();\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (!this.rendered) return;\n    this.rendered = false;\n\n    // unrendering before intro completed? complete it now\n    // TODO should be an API for aborting transitions\n    const transition = this.intro;\n    if (transition && transition.complete) transition.complete();\n\n    // Detach as soon as we can\n    if (this.name === 'option') {\n      // <option> elements detach immediately, so that\n      // their parent <select> element syncs correctly, and\n      // since option elements can't have transitions anyway\n      this.detach();\n    } else if (shouldDestroy) {\n      runloop.detachWhenReady(this);\n    }\n\n    // outro transition\n    const outro = this.outro;\n    if (outro && outro.shouldFire('outro')) {\n      outro.isIntro = false;\n      outro.isOutro = true;\n      runloop.registerTransition(outro);\n    }\n\n    if (this.fragment) this.fragment.unrender();\n\n    if (this.binding) this.binding.unrender();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n\n      const attrs = this.attributes;\n      if (attrs) {\n        const len = attrs.length;\n        for (let i = 0; i < len; i++) attrs[i].update();\n      }\n\n      if (this.fragment) this.fragment.update();\n    }\n  }\n}\n\nfunction inputIsCheckedRadio(element) {\n  const nameAttr = element.attributeByName.name;\n  return (\n    element.getAttribute('type') === 'radio' &&\n    (nameAttr || {}).interpolator &&\n    element.getAttribute('value') === nameAttr.interpolator.model.get()\n  );\n}\n\nfunction stringifyAttribute(attribute) {\n  const str = attribute.toString();\n  return str ? ' ' + str : '';\n}\n\nfunction getNamespace(element) {\n  // Use specified namespace...\n  const xmlns = element.getAttribute('xmlns');\n  if (xmlns) return xmlns;\n\n  // ...or SVG namespace, if this is an <svg> element\n  if (element.name === 'svg') return svg;\n\n  const parent = element.parent;\n\n  if (parent) {\n    // ...or HTML, if the parent is a <foreignObject>\n    if (parent.name === 'foreignobject') return html;\n\n    // ...or inherit from the parent node\n    return parent.node.namespaceURI;\n  }\n\n  return element.ractive.el.namespaceURI;\n}\n\nfunction delegateHandler(ev) {\n  const name = ev.type;\n  const end = ev.currentTarget;\n  const endEl = end._ractive && end._ractive.proxy;\n  let node = ev.target;\n  let bubble = true;\n  let listeners;\n\n  // starting with the origin node, walk up the DOM looking for ractive nodes with a matching event listener\n  while (bubble && node && node !== end) {\n    const proxy = node._ractive && node._ractive.proxy;\n    if (proxy && proxy.up.delegate === endEl && shouldFire(ev, node, end)) {\n      listeners = proxy.listeners && proxy.listeners[name];\n\n      if (listeners) {\n        const len = listeners.length;\n        for (let i = 0; i < len; i++) bubble = listeners[i].call(node, ev) !== false && bubble;\n      }\n    }\n\n    node = node.parentNode || node.correspondingUseElement; // SVG with a <use> element in certain environments\n  }\n\n  return bubble;\n}\n\nconst UIEvent = win !== null ? win.UIEvent : null;\nfunction shouldFire(event, start, end) {\n  if (UIEvent && event instanceof UIEvent) {\n    let node = start;\n    while (node && node !== end) {\n      if (node.disabled) return false;\n      node = node.parentNode || node.correspondingUseElement;\n    }\n  }\n\n  return true;\n}\n\nfunction handler(ev) {\n  const el = this._ractive.proxy;\n  let listeners;\n  if (el.listeners && (listeners = el.listeners[ev.type])) {\n    const len = listeners.length;\n    for (let i = 0; i < len; i++) listeners[i].call(this, ev);\n  }\n}\n","import runloop from 'src/global/runloop';\nimport Element from '../../Element';\n\nexport default class Form extends Element {\n  constructor(options) {\n    super(options);\n    this.formBindings = [];\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.on('reset', handleReset);\n  }\n\n  unrender(shouldDestroy) {\n    this.off('reset', handleReset);\n    super.unrender(shouldDestroy);\n  }\n}\n\nfunction handleReset() {\n  const element = this._ractive.proxy;\n\n  runloop.start();\n  element.formBindings.forEach(updateModel);\n  runloop.end();\n}\n\nfunction updateModel(binding) {\n  binding.model.set(binding.resetValue);\n}\n","import { fatal } from 'utils/log';\nimport runloop from 'src/global/runloop';\nimport { win } from 'config/environment';\n\n// because IE\nconst whitelist = {\n  animationend: 1,\n  animationiteration: 1,\n  animationstart: 1,\n  transitioncancel: 1,\n  transitionend: 1,\n  transitionstart: 1,\n  transitionrun: 1\n};\n\nclass DOMEvent {\n  constructor(name, owner) {\n    if (name.indexOf('*') !== -1) {\n      fatal(\n        `Only component proxy-events may contain \"*\" wildcards, <${\n          owner.name\n        } on-${name}=\"...\"/> is not valid`\n      );\n    }\n\n    this.name = name;\n    this.owner = owner;\n    this.handler = null;\n  }\n\n  bind() {}\n\n  render(directive) {\n    const name = this.name;\n\n    const register = () => {\n      const node = this.owner.node;\n      const on = `on${name}`;\n\n      // this is probably a custom event fired from a decorator or manually\n      if (!(on in node) && !(on in win) && !whitelist[name]) return;\n\n      this.owner.on(\n        name,\n        (this.handler = event => {\n          return directive.fire({\n            node,\n            original: event,\n            event,\n            name\n          });\n        })\n      );\n    };\n\n    if (name !== 'load') {\n      // schedule events so that they take place after twoway binding\n      runloop.scheduleTask(register, true);\n    } else {\n      // unless its a load event\n      register();\n    }\n  }\n\n  unbind() {}\n\n  unrender() {\n    if (this.handler) this.owner.off(this.name, this.handler);\n  }\n}\n\nclass CustomEvent {\n  constructor(eventPlugin, owner, name, args) {\n    this.eventPlugin = eventPlugin;\n    this.owner = owner;\n    this.name = name;\n    this.handler = null;\n    this.args = args;\n  }\n\n  bind() {}\n\n  render(directive) {\n    runloop.scheduleTask(() => {\n      const node = this.owner.node;\n\n      this.handler = this.eventPlugin.apply(\n        this.owner.ractive,\n        [\n          node,\n          (event = {}) => {\n            if (event.original) event.event = event.original;\n            else event.original = event.event;\n\n            event.name = this.name;\n            event.node = event.node || node;\n            return directive.fire(event);\n          }\n        ].concat(this.args || [])\n      );\n    });\n  }\n\n  unbind() {}\n\n  unrender() {\n    this.handler.teardown();\n  }\n}\n\nexport { DOMEvent, CustomEvent };\n","import Context from '../../../shared/Context';\n\nexport default class RactiveEvent {\n  constructor(component, name) {\n    this.component = component;\n    this.name = name;\n    this.handler = null;\n  }\n\n  bind(directive) {\n    const ractive = this.component.instance;\n\n    this.handler = ractive.on(this.name, (...args) => {\n      // watch for reproxy\n      if (args[0] instanceof Context) {\n        const ctx = args.shift();\n        ctx.component = ractive;\n        directive.fire(ctx, args);\n      } else {\n        directive.fire({}, args);\n      }\n\n      // cancel bubbling\n      return false;\n    });\n  }\n\n  render() {}\n\n  unbind() {\n    this.handler.cancel();\n  }\n\n  unrender() {}\n}\n","import { ANCHOR, COMPONENT } from 'config/types';\nimport { warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport fireEvent from 'src/events/fireEvent';\nimport { splitKeypath } from 'shared/keypaths';\nimport { findInViewHierarchy } from 'shared/registry';\nimport findElement from './findElement';\nimport { DOMEvent, CustomEvent } from '../element/ElementEvents';\nimport RactiveEvent from '../component/RactiveEvent';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport Context from 'src/shared/Context';\nimport { isArray, isString } from 'utils/is';\nimport getFunction from 'shared/getFunction';\nimport resolveReference from '../../resolvers/resolveReference';\n\nconst specialPattern = /^(event|arguments|@node|@event|@context)(\\..+)?$/;\nconst dollarArgsPattern = /^\\$(\\d+)(\\..+)?$/;\n\nexport default class EventDirective {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up, true);\n    this.template = options.template;\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n    this.events = [];\n  }\n\n  bind() {\n    if (this.element.type === COMPONENT || this.element.type === ANCHOR) {\n      this.template.n.forEach(n => {\n        this.events.push(new RactiveEvent(this.element, n));\n      });\n    } else {\n      let args;\n      if ((args = this.template.a)) {\n        const rs = args.r.map(r => {\n          const model = resolveReference(this.up, r);\n          return model ? model.get() : undefined;\n        });\n        try {\n          args = getFunction(args.s, rs.length).apply(null, rs);\n        } catch (err) {\n          args = null;\n          warnIfDebug(\n            `Failed to compute args for event on-${this.template.n.join('- ')}: ${err.message ||\n              err}`\n          );\n        }\n      }\n\n      this.template.n.forEach(n => {\n        const fn = findInViewHierarchy('events', this.ractive, n);\n        if (fn) {\n          this.events.push(new CustomEvent(fn, this.element, n, args));\n        } else {\n          this.events.push(new DOMEvent(n, this.element));\n        }\n      });\n    }\n\n    // method calls\n    this.models = null;\n\n    addToArray(this.element.events || (this.element.events = []), this);\n\n    setupArgsFn(this, this.template);\n    if (!this.fn) this.action = this.template.f;\n\n    this.events.forEach(e => e.bind(this));\n  }\n\n  destroyed() {\n    this.events.forEach(e => e.unrender());\n  }\n\n  fire(event, args = []) {\n    const context =\n      event instanceof Context && event.refire ? event : this.element.getContext(event);\n\n    if (this.fn) {\n      const values = [];\n\n      const models = resolveArgs(this, this.template, this.up, {\n        specialRef(ref) {\n          const specialMatch = specialPattern.exec(ref);\n          if (specialMatch) {\n            // on-click=\"foo(event.node)\"\n            return {\n              special: specialMatch[1],\n              keys: specialMatch[2] ? splitKeypath(specialMatch[2].substr(1)) : []\n            };\n          }\n\n          const dollarMatch = dollarArgsPattern.exec(ref);\n          if (dollarMatch) {\n            // on-click=\"foo($1)\"\n            return {\n              special: 'arguments',\n              keys: [dollarMatch[1] - 1].concat(\n                dollarMatch[2] ? splitKeypath(dollarMatch[2].substr(1)) : []\n              )\n            };\n          }\n        }\n      });\n\n      if (models) {\n        models.forEach(model => {\n          if (!model) return values.push(undefined);\n\n          if (model.special) {\n            const which = model.special;\n            let obj;\n\n            if (which === '@node') {\n              obj = this.element.node;\n            } else if (which === '@event') {\n              obj = event && event.event;\n            } else if (which === 'event') {\n              warnOnceIfDebug(\n                `The event reference available to event directives is deprecated and should be replaced with @context and @event`\n              );\n              obj = context;\n            } else if (which === '@context') {\n              obj = context;\n            } else {\n              obj = args;\n            }\n\n            const keys = model.keys.slice();\n\n            while (obj && keys.length) obj = obj[keys.shift()];\n            return values.push(obj);\n          }\n\n          if (model.wrapper) {\n            return values.push(model.wrapperValue);\n          }\n\n          values.push(model.get());\n        });\n      }\n\n      // make event available as `this.event`\n      const ractive = this.ractive;\n      const oldEvent = ractive.event;\n\n      ractive.event = context;\n      const returned = this.fn.apply(ractive, values);\n      let result = returned.pop();\n\n      // Auto prevent and stop if return is explicitly false\n      if (result === false) {\n        const original = event ? event.original : undefined;\n        if (original) {\n          original.preventDefault && original.preventDefault();\n          original.stopPropagation && original.stopPropagation();\n        } else {\n          warnOnceIfDebug(\n            `handler '${this.template.n.join(\n              ' '\n            )}' returned false, but there is no event available to cancel`\n          );\n        }\n      } else if (!returned.length && isArray(result) && isString(result[0])) {\n        // watch for proxy events\n        result = fireEvent(this.ractive, result.shift(), context, result);\n      }\n\n      ractive.event = oldEvent;\n\n      return result;\n    } else {\n      return fireEvent(this.ractive, this.action, context, args);\n    }\n  }\n\n  handleChange() {}\n\n  render() {\n    this.events.forEach(e => e.render(this));\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    removeFromArray(this.element.events, this);\n    this.events.forEach(e => e.unbind());\n  }\n\n  unrender() {\n    this.events.forEach(e => e.unrender());\n  }\n}\n\nEventDirective.prototype.update = noop;\nEventDirective.prototype.rebound = noop;\n","import { rebindMatch } from 'shared/rebind';\nimport Item, { ContainerItem } from './Item';\nimport resolve from '../../resolvers/resolve';\nimport { assign } from 'utils/object';\n\nexport default class Mustache extends Item {\n  constructor(options) {\n    super(options);\n\n    if (options.owner) this.parent = options.owner;\n\n    this.isStatic = !!options.template.s;\n\n    this.model = null;\n    this.dirty = false;\n  }\n\n  bind() {\n    // yield mustaches and inner contexts should resolve in container context\n    const start = this.template.y\n      ? this.template.y.containerFragment\n      : this.containerFragment || this.up;\n    // try to find a model for this view\n    const model = resolve(start, this.template);\n\n    if (model) {\n      const value = model.get();\n\n      if (this.isStatic) {\n        this.model = { get: () => value };\n        model.unreference();\n        return;\n      }\n\n      model.register(this);\n      this.model = model;\n    }\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebind(next, previous, safe) {\n    if (this.isStatic) return;\n\n    next = rebindMatch(this.template, next, previous, this.up);\n    if (next === this.model) return false;\n\n    if (this.model) {\n      this.model.unregister(this);\n    }\n    if (next) next.addShuffleRegister(this, 'mark');\n    this.model = next;\n    if (!safe) this.handleChange();\n    return true;\n  }\n\n  rebound(update) {\n    if (this.model) {\n      if (this.model.rebound) this.model.rebound(update);\n      else {\n        this.model.unregister(this);\n        this.bind();\n      }\n\n      if (update) this.bubble();\n    }\n    if (this.fragment) this.fragment.rebound(update);\n  }\n\n  unbind() {\n    if (!this.isStatic) {\n      this.model && this.model.unregister(this);\n      this.model = undefined;\n    }\n  }\n}\n\nexport function MustacheContainer(options) {\n  Mustache.call(this, options);\n}\n\nconst proto = (MustacheContainer.prototype = Object.create(ContainerItem.prototype));\n\nassign(proto, Mustache.prototype, { constructor: MustacheContainer });\n","import progressiveText from './shared/progressiveText';\nimport { escapeHtml } from 'utils/html';\nimport { safeToStringValue } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport Mustache from './shared/Mustache';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Interpolator extends Mustache {\n  bubble() {\n    if (this.owner) this.owner.bubble();\n    super.bubble();\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getString() {\n    return this.model ? safeToStringValue(this.model.get()) : '';\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    const value = (this.value = this.getString());\n\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, value);\n  }\n\n  toString(escape) {\n    const string = this.getString();\n    return escape ? escapeHtml(string) : string;\n  }\n\n  unrender(shouldDestroy) {\n    if (shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.rendered) {\n        const value = this.getString();\n        if (value !== this.value) this.node.data = this.value = value;\n      }\n    }\n  }\n\n  valueOf() {\n    return this.model ? this.model.get() : undefined;\n  }\n}\n","import Element from '../../Element';\nimport { isFunction } from 'utils/is';\n\nexport default class Input extends Element {\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.node.defaultValue = this.node.value;\n  }\n  compare(value, attrValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(value, attrValue);\n      }\n      if (value && attrValue) {\n        return value[comparator] == attrValue[comparator];\n      }\n    }\n    return value == attrValue;\n  }\n}\n","import { warnIfDebug } from 'utils/log';\nimport { create, hasOwn } from 'utils/object';\n\nconst leadingWhitespace = /^\\s+/;\n\nconst ParseError = function(message) {\n  this.name = 'ParseError';\n  this.message = message;\n  try {\n    throw new Error(message);\n  } catch (e) {\n    this.stack = e.stack;\n  }\n};\n\nParseError.prototype = Error.prototype;\n\nconst Parser = function(str, options) {\n  let item;\n  let lineStart = 0;\n\n  this.str = str;\n  this.options = options || {};\n  this.pos = 0;\n\n  this.lines = this.str.split('\\n');\n  this.lineEnds = this.lines.map(line => {\n    const lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n    lineStart = lineEnd;\n    return lineEnd;\n  }, 0);\n\n  // Custom init logic\n  if (this.init) this.init(str, options);\n\n  const items = [];\n\n  while (this.pos < this.str.length && (item = this.read())) {\n    items.push(item);\n  }\n\n  this.leftover = this.remaining();\n  this.result = this.postProcess ? this.postProcess(items, options) : items;\n};\n\nParser.prototype = {\n  read(converters) {\n    let i, item;\n\n    if (!converters) converters = this.converters;\n\n    const pos = this.pos;\n\n    const len = converters.length;\n    for (i = 0; i < len; i += 1) {\n      this.pos = pos; // reset for each attempt\n\n      if ((item = converters[i](this))) {\n        return item;\n      }\n    }\n\n    return null;\n  },\n\n  getContextMessage(pos, message) {\n    const [lineNum, columnNum] = this.getLinePos(pos);\n    if (this.options.contextLines === -1) {\n      return [lineNum, columnNum, `${message} at line ${lineNum} character ${columnNum}`];\n    }\n\n    const line = this.lines[lineNum - 1];\n\n    let contextUp = '';\n    let contextDown = '';\n    if (this.options.contextLines) {\n      const start =\n        lineNum - 1 - this.options.contextLines < 0 ? 0 : lineNum - 1 - this.options.contextLines;\n      contextUp = this.lines\n        .slice(start, lineNum - 1 - start)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      contextDown = this.lines\n        .slice(lineNum, lineNum + this.options.contextLines)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      if (contextUp) {\n        contextUp += '\\n';\n      }\n      if (contextDown) {\n        contextDown = '\\n' + contextDown;\n      }\n    }\n\n    let numTabs = 0;\n    const annotation =\n      contextUp +\n      line.replace(/\\t/g, (match, char) => {\n        if (char < columnNum) {\n          numTabs += 1;\n        }\n\n        return '  ';\n      }) +\n      '\\n' +\n      new Array(columnNum + numTabs).join(' ') +\n      '^----' +\n      contextDown;\n\n    return [\n      lineNum,\n      columnNum,\n      `${message} at line ${lineNum} character ${columnNum}:\\n${annotation}`\n    ];\n  },\n\n  getLinePos(char) {\n    let lineNum = 0;\n    let lineStart = 0;\n\n    while (char >= this.lineEnds[lineNum]) {\n      lineStart = this.lineEnds[lineNum];\n      lineNum += 1;\n    }\n\n    const columnNum = char - lineStart;\n    return [lineNum + 1, columnNum + 1, char]; // line/col should be one-based, not zero-based!\n  },\n\n  error(message) {\n    const [lineNum, columnNum, msg] = this.getContextMessage(this.pos, message);\n\n    const error = new ParseError(msg);\n\n    error.line = lineNum;\n    error.character = columnNum;\n    error.shortMessage = message;\n\n    throw error;\n  },\n\n  matchString(string) {\n    if (this.str.substr(this.pos, string.length) === string) {\n      this.pos += string.length;\n      return string;\n    }\n  },\n\n  matchPattern(pattern) {\n    let match;\n\n    if ((match = pattern.exec(this.remaining()))) {\n      this.pos += match[0].length;\n      return match[1] || match[0];\n    }\n  },\n\n  sp() {\n    this.matchPattern(leadingWhitespace);\n  },\n\n  remaining() {\n    return this.str.substring(this.pos);\n  },\n\n  nextChar() {\n    return this.str.charAt(this.pos);\n  },\n\n  warn(message) {\n    const msg = this.getContextMessage(this.pos, message)[2];\n\n    warnIfDebug(msg);\n  }\n};\n\nParser.extend = function(proto) {\n  const Parent = this;\n  const Child = function(str, options) {\n    Parser.call(this, str, options);\n  };\n\n  Child.prototype = create(Parent.prototype);\n\n  for (const key in proto) {\n    if (hasOwn(proto, key)) {\n      Child.prototype[key] = proto[key];\n    }\n  }\n\n  Child.extend = Parser.extend;\n  return Child;\n};\n\nexport default Parser;\n","// Match one or more characters until: \", ', \\, or EOL/EOF.\n// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\nconst stringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n// Match one escape sequence, including the backslash.\nexport const escapeSequencePattern = /^\\\\(?:[`'\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n// Match one ES5 line continuation (backslash + line terminator).\nexport const lineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n// Helper for defining getDoubleQuotedString and getSingleQuotedString.\nexport default function(okQuote) {\n  return function(parser) {\n    let literal = '\"';\n    let done = false;\n    let next;\n\n    while (!done) {\n      next =\n        parser.matchPattern(stringMiddlePattern) ||\n        parser.matchPattern(escapeSequencePattern) ||\n        parser.matchString(okQuote);\n      if (next) {\n        if (next === `\"`) {\n          literal += `\\\\\"`;\n        } else if (next === `\\\\'`) {\n          literal += `'`;\n        } else {\n          literal += next;\n        }\n      } else {\n        next = parser.matchPattern(lineContinuationPattern);\n        if (next) {\n          // convert \\(newline-like) into a \\u escape, which is allowed in JSON\n          literal += '\\\\u' + ('000' + next.charCodeAt(1).toString(16)).slice(-4);\n        } else {\n          done = true;\n        }\n      }\n    }\n\n    literal += '\"';\n\n    // use JSON.parse to interpret escapes\n    return JSON.parse(literal);\n  };\n}\n","import { STRING_LITERAL } from '../../../../../config/types';\nimport makeQuotedStringMatcher from './stringLiteral/makeQuotedStringMatcher';\n\nconst singleMatcher = makeQuotedStringMatcher(`\"`);\nconst doubleMatcher = makeQuotedStringMatcher(`'`);\n\nexport default function(parser) {\n  const start = parser.pos;\n  const quote = parser.matchString(`'`) || parser.matchString(`\"`);\n\n  if (quote) {\n    const string = (quote === `'` ? singleMatcher : doubleMatcher)(parser);\n\n    if (!parser.matchString(quote)) {\n      parser.pos = start;\n      return null;\n    }\n\n    return {\n      t: STRING_LITERAL,\n      v: string\n    };\n  }\n\n  return null;\n}\n","import { NUMBER_LITERAL } from '../../../../../config/types';\n\n// bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\nconst numberPattern = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\nexport default function readNumberLiteral(parser) {\n  let result;\n\n  if ((result = parser.matchPattern(numberPattern))) {\n    return {\n      t: NUMBER_LITERAL,\n      v: result\n    };\n  }\n\n  return null;\n}\n","export const name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\nexport const spreadPattern = /^\\s*\\.{3}/;\nexport const legalReference = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:\\.(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nexport const relaxedName = /^[a-zA-Z_$][-\\/a-zA-Z_$0-9]*(?:\\.(?:[a-zA-Z_$][-\\/a-zA-Z_$0-9]*))*/;\n","import readStringLiteral from '../primary/literal/readStringLiteral';\nimport readNumberLiteral from '../primary/literal/readNumberLiteral';\nimport { name as namePattern } from './patterns';\n\nconst identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n// http://mathiasbynens.be/notes/javascript-properties\n// can be any name, string literal, or number literal\nexport default function readKey(parser) {\n  let token;\n\n  if ((token = readStringLiteral(parser))) {\n    return identifier.test(token.v) ? token.v : '\"' + token.v.replace(/\"/g, '\\\\\"') + '\"';\n  }\n\n  if ((token = readNumberLiteral(parser))) {\n    return token.v;\n  }\n\n  if ((token = parser.matchPattern(namePattern))) {\n    return token;\n  }\n\n  return null;\n}\n","import { isEqual, isFunction } from 'utils/is';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\nimport { rebindMatch } from 'shared/rebind';\nimport { create } from 'utils/object';\n\nexport default class Observer {\n  constructor(ractive, model, callback, options) {\n    this.context = options.context || ractive;\n    this.callback = callback;\n    this.ractive = ractive;\n    this.keypath = options.keypath;\n    this.options = options;\n\n    if (model) this.resolved(model);\n\n    if (isFunction(options.old)) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    if (options.init !== false) {\n      this.dirty = true;\n      this.dispatch();\n    } else {\n      updateOld(this);\n    }\n\n    this.dirty = false;\n  }\n\n  cancel() {\n    this.cancelled = true;\n    if (this.model) {\n      this.model.unregister(this);\n    } else {\n      this.resolver.unbind();\n    }\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    if (!this.cancelled) {\n      this.callback.call(this.context, this.newValue, this.oldValue, this.keypath);\n      updateOld(this, true);\n      this.dirty = false;\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty) {\n      const newValue = this.model.get();\n      if (isEqual(newValue, this.oldValue)) return;\n\n      this.newValue = newValue;\n\n      if (this.options.strict && this.newValue === this.oldValue) return;\n\n      runloop.addObserver(this, this.options.defer);\n      this.dirty = true;\n\n      if (this.options.once) runloop.scheduleTask(() => this.cancel());\n    } else {\n      // make sure the newValue stays updated in case this observer gets touched multiple times in one loop\n      this.newValue = this.model.get();\n    }\n  }\n\n  rebind(next, previous) {\n    next = rebindMatch(this.keypath, next, previous);\n    if (next === this.model) return false;\n\n    if (this.model) this.model.unregister(this);\n    if (next) next.addShuffleTask(() => this.resolved(next));\n  }\n\n  resolved(model) {\n    this.model = model;\n\n    this.oldValue = undefined;\n    this.newValue = model.get();\n\n    model.register(this);\n  }\n}\n\nfunction updateOld(observer, fresh) {\n  const next = fresh\n    ? observer.model\n      ? observer.model.get()\n      : observer.newValue\n    : observer.newValue;\n  observer.oldValue = observer.oldFn\n    ? observer.oldFn.call(observer.oldContext, undefined, next, observer.keypath)\n    : next;\n}\n","import { escapeKey } from 'shared/keypaths';\nimport { removeFromArray } from 'utils/array';\nimport { isArray, isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport { create, keys } from 'utils/object';\n\nconst star = /\\*+/g;\n\nexport default class PatternObserver {\n  constructor(ractive, baseModel, keys, callback, options) {\n    this.context = options.context || ractive;\n    this.ractive = ractive;\n    this.baseModel = baseModel;\n    this.keys = keys;\n    this.callback = callback;\n\n    const pattern = keys.join('\\\\.').replace(star, '(.+)');\n    const baseKeypath = (this.baseKeypath = baseModel.getKeypath(ractive));\n    this.pattern = new RegExp(`^${baseKeypath ? baseKeypath + '\\\\.' : ''}${pattern}$`);\n    this.recursive = keys.length === 1 && keys[0] === '**';\n    if (this.recursive) this.keys = ['*'];\n    if (options.old) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    this.oldValues = {};\n    this.newValues = {};\n\n    this.defer = options.defer;\n    this.once = options.once;\n    this.strict = options.strict;\n\n    this.dirty = false;\n    this.changed = [];\n    this.partial = false;\n    this.links = options.links;\n\n    const models = baseModel.findMatches(this.keys);\n\n    models.forEach(model => {\n      this.newValues[model.getKeypath(this.ractive)] = model.get();\n    });\n\n    if (options.init !== false) {\n      this.dispatch();\n    } else {\n      updateOld(this, this.newValues);\n    }\n\n    baseModel.registerPatternObserver(this);\n  }\n\n  cancel() {\n    this.baseModel.unregisterPatternObserver(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    const newValues = this.newValues;\n    this.newValues = {};\n    keys(newValues).forEach(keypath => {\n      const newValue = newValues[keypath];\n      const oldValue = this.oldValues[keypath];\n\n      if (this.strict && newValue === oldValue) return;\n      if (isEqual(newValue, oldValue)) return;\n\n      let args = [newValue, oldValue, keypath];\n      if (keypath) {\n        const wildcards = this.pattern.exec(keypath);\n        if (wildcards) {\n          args = args.concat(wildcards.slice(1));\n        }\n      }\n\n      this.callback.apply(this.context, args);\n    });\n\n    updateOld(this, newValues, this.partial);\n\n    this.dirty = false;\n  }\n\n  notify(key) {\n    this.changed.push(key);\n  }\n\n  shuffle(newIndices) {\n    if (!isArray(this.baseModel.value)) return;\n\n    const max = this.baseModel.value.length;\n\n    for (let i = 0; i < newIndices.length; i++) {\n      if (newIndices[i] === -1 || newIndices[i] === i) continue;\n      this.changed.push([i]);\n    }\n\n    for (let i = newIndices.touchedFrom; i < max; i++) {\n      this.changed.push([i]);\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty || this.changed.length) {\n      if (!this.dirty) this.newValues = {};\n\n      if (!this.changed.length) {\n        this.baseModel.findMatches(this.keys).forEach(model => {\n          const keypath = model.getKeypath(this.ractive);\n          this.newValues[keypath] = model.get();\n        });\n        this.partial = false;\n      } else {\n        let count = 0;\n\n        if (this.recursive) {\n          this.changed.forEach(keys => {\n            const model = this.baseModel.joinAll(keys);\n            if (model.isLink && !this.links) return;\n            count++;\n            this.newValues[model.getKeypath(this.ractive)] = model.get();\n          });\n        } else {\n          const ok = this.baseModel.isRoot\n            ? this.changed.map(keys => keys.map(escapeKey).join('.'))\n            : this.changed.map(keys => this.baseKeypath + '.' + keys.map(escapeKey).join('.'));\n\n          this.baseModel.findMatches(this.keys).forEach(model => {\n            const keypath = model.getKeypath(this.ractive);\n            const check = k => {\n              return (\n                (k.indexOf(keypath) === 0 &&\n                  (k.length === keypath.length || k[keypath.length] === '.')) ||\n                (keypath.indexOf(k) === 0 &&\n                  (k.length === keypath.length || keypath[k.length] === '.'))\n              );\n            };\n\n            // is this model on a changed keypath?\n            if (ok.filter(check).length) {\n              count++;\n              this.newValues[keypath] = model.get();\n            }\n          });\n        }\n\n        // no valid change triggered, so bail to avoid breakage\n        if (!count) return;\n\n        this.partial = true;\n      }\n\n      runloop.addObserver(this, this.defer);\n      this.dirty = true;\n      this.changed.length = 0;\n\n      if (this.once) this.cancel();\n    }\n  }\n}\n\nfunction updateOld(observer, vals, partial) {\n  const olds = observer.oldValues;\n\n  if (observer.oldFn) {\n    if (!partial) observer.oldValues = {};\n\n    keys(vals).forEach(k => {\n      const args = [olds[k], vals[k], k];\n      const parts = observer.pattern.exec(k);\n      if (parts) {\n        args.push.apply(args, parts.slice(1));\n      }\n      observer.oldValues[k] = observer.oldFn.apply(observer.oldContext, args);\n    });\n  } else {\n    if (partial) {\n      keys(vals).forEach(k => (olds[k] = vals[k]));\n    } else {\n      observer.oldValues = vals;\n    }\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport { isArray } from 'utils/is';\nimport runloop from 'src/global/runloop';\n\nfunction negativeOne() {\n  return -1;\n}\n\nexport default class ArrayObserver {\n  constructor(ractive, model, callback, options) {\n    this.ractive = ractive;\n    this.model = model;\n    this.keypath = model.getKeypath();\n    this.callback = callback;\n    this.options = options;\n\n    this.pending = null;\n\n    model.register(this);\n\n    if (options.init !== false) {\n      this.sliced = [];\n      this.shuffle([]);\n      this.dispatch();\n    } else {\n      this.sliced = this.slice();\n    }\n  }\n\n  cancel() {\n    this.model.unregister(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    this.callback(this.pending);\n    this.pending = null;\n    if (this.options.once) this.cancel();\n  }\n\n  handleChange(path) {\n    if (this.pending) {\n      // post-shuffle\n      runloop.addObserver(this, this.options.defer);\n    } else if (!path) {\n      // entire array changed\n      this.shuffle(this.sliced.map(negativeOne));\n      this.handleChange();\n    }\n  }\n\n  shuffle(newIndices) {\n    const newValue = this.slice();\n\n    const inserted = [];\n    const deleted = [];\n    let start;\n\n    const hadIndex = {};\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      hadIndex[newIndex] = true;\n\n      if (newIndex !== oldIndex && start === undefined) {\n        start = oldIndex;\n      }\n\n      if (newIndex === -1) {\n        deleted.push(this.sliced[oldIndex]);\n      }\n    });\n\n    if (start === undefined) start = newIndices.length;\n\n    const len = newValue.length;\n    for (let i = 0; i < len; i += 1) {\n      if (!hadIndex[i]) inserted.push(newValue[i]);\n    }\n\n    this.pending = { inserted, deleted, start };\n    this.sliced = newValue;\n  }\n\n  slice() {\n    const value = this.model.get();\n    return isArray(value) ? value.slice() : [];\n  }\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { assign } from 'utils/object';\n\nconst onceOptions = { init: false, once: true };\n\nexport default function observeOnce(keypath, callback, options) {\n  if (isObject(keypath) || isFunction(keypath)) {\n    options = assign(callback || {}, onceOptions);\n    return this.observe(keypath, options);\n  }\n\n  options = assign(options || {}, onceOptions);\n  return this.observe(keypath, callback, options);\n}\n","export default str => str.trim();\n","export default str => str !== '';\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('pop').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('push').path;\n","import { doc } from '../config/environment';\n\nconst PREFIX = '/* Ractive.js component styles */';\n\n// Holds current definitions of styles.\nconst styleDefinitions = [];\n\n// Flag to tell if we need to update the CSS\nlet isDirty = false;\n\n// These only make sense on the browser. See additional setup below.\nlet styleElement = null;\nlet useCssText = null;\n\nexport function addCSS(styleDefinition) {\n  styleDefinitions.push(styleDefinition);\n  isDirty = true;\n}\n\nexport function applyCSS(force) {\n  const styleElement = style();\n\n  // Apply only seems to make sense when we're in the DOM. Server-side renders\n  // can call toCSS to get the updated CSS.\n  if (!styleElement || (!force && !isDirty)) return;\n\n  if (useCssText) {\n    styleElement.styleSheet.cssText = getCSS(null);\n  } else {\n    styleElement.innerHTML = getCSS(null);\n  }\n\n  isDirty = false;\n}\n\nexport function getCSS(cssIds) {\n  const filteredStyleDefinitions = cssIds\n    ? styleDefinitions.filter(style => ~cssIds.indexOf(style.id))\n    : styleDefinitions;\n\n  filteredStyleDefinitions.forEach(d => (d.applied = true));\n\n  return filteredStyleDefinitions.reduce(\n    (styles, style) => `${styles ? `${styles}\\n\\n/* {${style.id}} */\\n${style.styles}` : ''}`,\n    PREFIX\n  );\n}\n\nfunction style() {\n  // If we're on the browser, additional setup needed.\n  if (doc && !styleElement) {\n    styleElement = doc.createElement('style');\n    styleElement.type = 'text/css';\n    styleElement.setAttribute('data-ractive-css', '');\n\n    doc.getElementsByTagName('head')[0].appendChild(styleElement);\n\n    useCssText = !!styleElement.styleSheet;\n  }\n\n  return styleElement;\n}\n","import { ensureArray, combine } from 'utils/array';\n\nexport default {\n  extend: (Parent, proto, options) => {\n    proto.adapt = combine(proto.adapt, ensureArray(options.adapt));\n  },\n\n  init() {}\n};\n","const remove = /\\/\\*(?:[\\s\\S]*?)\\*\\//g;\nconst escape = /url\\(\\s*(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\1\\s*\\)|url\\((?:\\\\[\\s\\S]|[^)])*\\)|(['\"])(?:\\\\[\\s\\S]|(?!\\2).)*\\2/gi;\nconst value = /\\0(\\d+)/g;\n\n// Removes comments and strings from the given CSS to make it easier to parse.\n// Callback receives the cleaned CSS and a function which can be used to put\n// the removed strings back in place after parsing is done.\nexport default function(css, callback, additionalReplaceRules = []) {\n  const values = [];\n  const reconstruct = css => css.replace(value, (match, n) => values[n]);\n  css = css.replace(escape, match => `\\0${values.push(match) - 1}`).replace(remove, '');\n\n  additionalReplaceRules.forEach(pattern => {\n    css = css.replace(pattern, match => `\\0${values.push(match) - 1}`);\n  });\n\n  return callback(css, reconstruct);\n}\n","import cleanCss from 'utils/cleanCss';\n\nconst selectorsPattern = /(?:^|\\}|\\{)\\s*([^\\{\\}\\0]+)\\s*(?=\\{)/g;\nconst keyframesDeclarationPattern = /@keyframes\\s+[^\\{\\}]+\\s*\\{(?:[^{}]+|\\{[^{}]+})*}/gi;\nconst selectorUnitPattern = /((?:(?:\\[[^\\]]+\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\nconst excludePattern = /^(?:@|\\d+%)/;\nconst dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\nfunction trim(str) {\n  return str.trim();\n}\n\nfunction extractString(unit) {\n  return unit.str;\n}\n\nfunction transformSelector(selector, parent) {\n  const selectorUnits = [];\n  let match;\n\n  while ((match = selectorUnitPattern.exec(selector))) {\n    selectorUnits.push({\n      str: match[0],\n      base: match[1],\n      modifiers: match[2]\n    });\n  }\n\n  // For each simple selector within the selector, we need to create a version\n  // that a) combines with the id, and b) is inside the id\n  const base = selectorUnits.map(extractString);\n\n  const transformed = [];\n  let i = selectorUnits.length;\n\n  while (i--) {\n    const appended = base.slice();\n\n    // Pseudo-selectors should go after the attribute selector\n    const unit = selectorUnits[i];\n    appended[i] = unit.base + parent + unit.modifiers || '';\n\n    const prepended = base.slice();\n    prepended[i] = parent + ' ' + prepended[i];\n\n    transformed.push(appended.join(' '), prepended.join(' '));\n  }\n\n  return transformed.join(', ');\n}\n\nexport default function transformCss(css, id) {\n  const dataAttr = `[data-ractive-css~=\"{${id}}\"]`;\n\n  let transformed;\n\n  if (dataRvcGuidPattern.test(css)) {\n    transformed = css.replace(dataRvcGuidPattern, dataAttr);\n  } else {\n    transformed = cleanCss(\n      css,\n      (css, reconstruct) => {\n        css = css.replace(selectorsPattern, (match, $1) => {\n          // don't transform at-rules and keyframe declarations\n          if (excludePattern.test($1)) return match;\n\n          const selectors = $1.split(',').map(trim);\n          const transformed =\n            selectors.map(selector => transformSelector(selector, dataAttr)).join(', ') + ' ';\n\n          return match.replace($1, transformed);\n        });\n\n        return reconstruct(css);\n      },\n      [keyframesDeclarationPattern]\n    );\n  }\n\n  return transformed;\n}\n","import { SharedModel } from './SharedModel';\nimport { applyChanges } from '../../Ractive/static/styleSet';\n\nexport default class CSSModel extends SharedModel {\n  constructor(component) {\n    super(component.cssData, '@style');\n    this.component = component;\n  }\n\n  downstreamChanged(path, depth) {\n    if (this.locked) return;\n\n    const component = this.component;\n\n    component.extensions.forEach(e => {\n      const model = e._cssModel;\n      model.mark();\n      model.downstreamChanged(path, depth || 1);\n    });\n\n    if (!depth) {\n      applyChanges(component, true);\n    }\n  }\n}\n","import { addCSS, applyCSS } from 'src/global/css';\nimport transformCss from './transform';\nimport { uuid } from 'utils/id';\nimport { warnIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport { splitKeypath } from 'shared/keypaths';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperty } from 'utils/object';\nimport { isString, isFunction, isObjectType } from 'utils/is';\n\nconst hasCurly = /\\{/;\nexport default {\n  name: 'css',\n\n  // Called when creating a new component definition\n  extend: (Parent, proto, options, Child) => {\n    Child._cssIds = gatherIds(Parent);\n\n    defineProperty(Child, 'cssData', {\n      configurable: true,\n      value: assign(create(Parent.cssData), options.cssData || {})\n    });\n\n    defineProperty(Child, '_cssModel', {\n      configurable: true,\n      value: new CSSModel(Child)\n    });\n\n    if (options.css) initCSS(options, Child, proto);\n  },\n\n  // Called when creating a new component instance\n  init: (Parent, target, options) => {\n    if (!options.css) return;\n\n    warnIfDebug(`\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\n\nconst Component = Ractive.extend({\n\t...\n\tcss: '/* your css */',\n\t...\n});\n\nconst componentInstance = new Component({ ... })\n\t\t`);\n  }\n};\n\nfunction gatherIds(start) {\n  let cmp = start;\n  const ids = [];\n\n  while (cmp) {\n    if (cmp.prototype.cssId) ids.push(cmp.prototype.cssId);\n    cmp = cmp.Parent;\n  }\n\n  return ids;\n}\n\nexport function evalCSS(component, css) {\n  if (isString(css)) return css;\n\n  const cssData = component.cssData;\n  const model = component._cssModel;\n  const data = function data(path) {\n    return model.joinAll(splitKeypath(path)).get();\n  };\n  data.__proto__ = cssData;\n\n  const result = css.call(component, data);\n  return isString(result) ? result : '';\n}\n\nexport function initCSS(options, target, proto) {\n  let css =\n    options.css === true\n      ? ''\n      : isString(options.css) && !hasCurly.test(options.css)\n        ? getElement(options.css) || options.css\n        : options.css;\n  let cssProp = css;\n\n  const id = options.cssId || uuid();\n\n  if (isObjectType(css)) {\n    css = 'textContent' in css ? css.textContent : css.innerHTML;\n    cssProp = css;\n  } else if (isFunction(css)) {\n    cssProp = css;\n    css = evalCSS(target, css);\n  }\n\n  const def = { transform: !options.noCssTransform };\n\n  defineProperty(target, '_cssDef', { configurable: true, value: def });\n\n  defineProperty(target, 'css', {\n    get() {\n      return cssProp;\n    },\n    set(next) {\n      cssProp = next;\n      const css = evalCSS(target, cssProp);\n      const styles = def.styles;\n      def.styles = def.transform ? transformCss(css, id) : css;\n      if (def.applied && styles !== def.styles) applyCSS(true);\n    }\n  });\n\n  def.styles = def.transform ? transformCss(css, id) : css;\n  def.id = proto.cssId = id;\n  target._cssIds.push(id);\n\n  addCSS(target._cssDef);\n}\n","import { fatal, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { isArray, isObject, isFunction, isObjectType } from 'utils/is';\nimport bind from 'utils/bind';\n\nfunction validate(data) {\n  // Warn if userOptions.data is a non-POJO\n  if (data && data.constructor !== Object) {\n    if (isFunction(data)) {\n      // TODO do we need to support this in the new Ractive() case?\n    } else if (!isObjectType(data)) {\n      fatal(`data option must be an object or a function, \\`${data}\\` is not valid`);\n    } else {\n      warnIfDebug(\n        'If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged'\n      );\n    }\n  }\n}\n\nexport default {\n  name: 'data',\n\n  extend: (Parent, proto, options) => {\n    let key;\n    let value;\n\n    // check for non-primitives, which could cause mutation-related bugs\n    if (options.data && isObject(options.data)) {\n      for (key in options.data) {\n        value = options.data[key];\n\n        if (value && isObjectType(value)) {\n          if (isObject(value) || isArray(value)) {\n            warnIfDebug(`Passing a \\`data\\` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }`);\n          }\n        }\n      }\n    }\n\n    proto.data = combine(proto.data, options.data);\n  },\n\n  init: (Parent, ractive, options) => {\n    let result = combine(Parent.prototype.data, options.data);\n\n    if (isFunction(result)) result = result.call(ractive);\n\n    // bind functions to the ractive instance at the top level,\n    // unless it's a non-POJO (in which case alarm bells should ring)\n    if (result && result.constructor === Object) {\n      for (const prop in result) {\n        if (isFunction(result[prop])) {\n          const value = result[prop];\n          result[prop] = bind(value, ractive);\n          result[prop]._r_unbound = value;\n        }\n      }\n    }\n\n    return result || {};\n  },\n\n  reset(ractive) {\n    const result = this.init(ractive.constructor, ractive, ractive.viewmodel);\n    ractive.viewmodel.root.set(result);\n    return true;\n  }\n};\n\nfunction emptyData() {\n  return {};\n}\n\nfunction combine(parentValue, childValue) {\n  validate(childValue);\n\n  const parentIsFn = isFunction(parentValue);\n\n  // Very important, otherwise child instance can become\n  // the default data object on Ractive or a component.\n  // then ractive.set() ends up setting on the prototype!\n  if (!childValue && !parentIsFn) {\n    // this needs to be a function so that it can still inherit parent defaults\n    childValue = emptyData;\n  }\n\n  const childIsFn = isFunction(childValue);\n\n  // Fast path, where we just need to copy properties from\n  // parent to child\n  if (!parentIsFn && !childIsFn) {\n    return fromProperties(childValue, parentValue);\n  }\n\n  return function() {\n    const child = childIsFn ? callDataFunction(childValue, this) : childValue;\n    const parent = parentIsFn ? callDataFunction(parentValue, this) : parentValue;\n\n    return fromProperties(child, parent);\n  };\n}\n\nfunction callDataFunction(fn, context) {\n  const data = fn.call(context);\n\n  if (!data) return;\n\n  if (!isObjectType(data)) {\n    fatal('Data function must return an object');\n  }\n\n  if (data.constructor !== Object) {\n    warnOnceIfDebug(\n      'Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged'\n    );\n  }\n\n  return data;\n}\n\nfunction fromProperties(primary, secondary) {\n  if (primary && secondary) {\n    for (const key in secondary) {\n      if (!(key in primary)) {\n        primary[key] = secondary[key];\n      }\n    }\n\n    return primary;\n  }\n\n  return primary || secondary;\n}\n","export const TEMPLATE_VERSION = 4;\n","import { TEMPLATE_VERSION } from 'config/template';\nimport { addFunctions } from 'shared/getFunction';\nimport parser from '../runtime-parser';\nimport { hasOwn } from 'utils/object';\nimport { isFunction, isNumber, isString } from 'utils/is';\n\nexport default {\n  name: 'template',\n\n  extend(Parent, proto, options) {\n    // only assign if exists\n    if ('template' in options) {\n      const template = options.template;\n\n      if (isFunction(template)) {\n        proto.template = template;\n      } else {\n        proto.template = parseTemplate(template, proto);\n      }\n    }\n  },\n\n  init(Parent, ractive, options) {\n    // TODO because of prototypal inheritance, we might just be able to use\n    // ractive.template, and not bother passing through the Parent object.\n    // At present that breaks the test mocks' expectations\n    let template = 'template' in options ? options.template : Parent.prototype.template;\n    template = template || { v: TEMPLATE_VERSION, t: [] };\n\n    if (isFunction(template)) {\n      const fn = template;\n      template = getDynamicTemplate(ractive, fn);\n\n      ractive._config.template = {\n        fn,\n        result: template\n      };\n    }\n\n    template = parseTemplate(template, ractive);\n\n    // TODO the naming of this is confusing - ractive.template refers to [...],\n    // but Component.prototype.template refers to {v:1,t:[],p:[]}...\n    // it's unnecessary, because the developer never needs to access\n    // ractive.template\n    ractive.template = template.t;\n\n    if (template.p) {\n      extendPartials(ractive.partials, template.p);\n    }\n  },\n\n  reset(ractive) {\n    const result = resetValue(ractive);\n\n    if (result) {\n      const parsed = parseTemplate(result, ractive);\n\n      ractive.template = parsed.t;\n      extendPartials(ractive.partials, parsed.p, true);\n\n      return true;\n    }\n  }\n};\n\nfunction resetValue(ractive) {\n  const initial = ractive._config.template;\n\n  // If this isn't a dynamic template, there's nothing to do\n  if (!initial || !initial.fn) {\n    return;\n  }\n\n  const result = getDynamicTemplate(ractive, initial.fn);\n\n  // TODO deep equality check to prevent unnecessary re-rendering\n  // in the case of already-parsed templates\n  if (result !== initial.result) {\n    initial.result = result;\n    return result;\n  }\n}\n\nfunction getDynamicTemplate(ractive, fn) {\n  return fn.call(ractive, {\n    fromId: parser.fromId,\n    isParsed: parser.isParsed,\n    parse(template, options = parser.getParseOptions(ractive)) {\n      return parser.parse(template, options);\n    }\n  });\n}\n\nfunction parseTemplate(template, ractive) {\n  if (isString(template)) {\n    // parse will validate and add expression functions\n    template = parseAsString(template, ractive);\n  } else {\n    // need to validate and add exp for already parsed template\n    validate(template);\n    addFunctions(template);\n  }\n\n  return template;\n}\n\nfunction parseAsString(template, ractive) {\n  // ID of an element containing the template?\n  if (template[0] === '#') {\n    template = parser.fromId(template);\n  }\n\n  return parser.parseFor(template, ractive);\n}\n\nfunction validate(template) {\n  // Check that the template even exists\n  if (template == undefined) {\n    throw new Error(`The template cannot be ${template}.`);\n  } else if (!isNumber(template.v)) {\n    // Check the parsed template has a version at all\n    throw new Error(\n      \"The template parser was passed a non-string template, but the template doesn't have a version.  Make sure you're passing in the template you think you are.\"\n    );\n  } else if (template.v !== TEMPLATE_VERSION) {\n    // Check we're using the correct version\n    throw new Error(\n      `Mismatched template version (expected ${TEMPLATE_VERSION}, got ${\n        template.v\n      }) Please ensure you are using the latest version of Ractive.js in your build process as well as in your app`\n    );\n  }\n}\n\nfunction extendPartials(existingPartials, newPartials, overwrite) {\n  if (!newPartials) return;\n\n  // TODO there's an ambiguity here - we need to overwrite in the `reset()`\n  // case, but not initially...\n\n  for (const key in newPartials) {\n    if (overwrite || !hasOwn(existingPartials, key)) {\n      existingPartials[key] = newPartials[key];\n    }\n  }\n}\n","import { assign, create, keys } from 'utils/object';\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'computed',\n  'decorators',\n  'easing',\n  'events',\n  'helpers',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nconst registriesOnDefaults = ['computed', 'helpers'];\n\nclass Registry {\n  constructor(name, useDefaults) {\n    this.name = name;\n    this.useDefaults = useDefaults;\n  }\n\n  extend(Parent, proto, options) {\n    const parent = this.useDefaults ? Parent.defaults : Parent;\n    const target = this.useDefaults ? proto : proto.constructor;\n    this.configure(parent, target, options);\n  }\n\n  init() {\n    // noop\n  }\n\n  configure(Parent, target, options) {\n    const name = this.name;\n    const option = options[name];\n\n    const registry = create(Parent[name]);\n\n    assign(registry, option);\n\n    target[name] = registry;\n  }\n\n  reset(ractive) {\n    const registry = ractive[this.name];\n    let changed = false;\n\n    keys(registry).forEach(key => {\n      const item = registry[key];\n\n      if (item._fn) {\n        if (item._fn.isOwner) {\n          registry[key] = item._fn;\n        } else {\n          delete registry[key];\n        }\n        changed = true;\n      }\n    });\n\n    return changed;\n  }\n}\n\nconst registries = registryNames.map(name => {\n  const putInDefaults = registriesOnDefaults.indexOf(name) > -1;\n  return new Registry(name, putInDefaults);\n});\n\nexport default registries;\n","import { warnIfDebug } from 'utils/log';\nimport adaptConfigurator from './custom/adapt';\nimport cssConfigurator from './custom/css/css';\nimport dataConfigurator from './custom/data';\nimport templateConfigurator from './custom/template';\nimport defaults from './defaults';\nimport registries from './registries';\nimport wrapPrototype from './wrapPrototypeMethod';\nimport deprecate from './deprecate';\nimport RactiveProto from '../prototype';\nimport { hasOwn, keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\nimport hooks from 'src/events/Hook';\n\nconst config = {\n  extend: (Parent, proto, options, Child) => configure('extend', Parent, proto, options, Child),\n  init: (Parent, ractive, options) => configure('init', Parent, ractive, options),\n  reset: ractive => order.filter(c => c.reset && c.reset(ractive)).map(c => c.name)\n};\n\nconst custom = {\n  adapt: adaptConfigurator,\n  computed: config,\n  css: cssConfigurator,\n  data: dataConfigurator,\n  helpers: config,\n  template: templateConfigurator\n};\n\nconst defaultKeys = keys(defaults);\n\nconst isStandardKey = makeObj(defaultKeys.filter(key => !custom[key]));\n\n// blacklisted keys that we don't double extend\nconst isBlacklisted = makeObj(\n  defaultKeys.concat(registries.map(r => r.name), ['on', 'observe', 'attributes', 'cssData', 'use'])\n);\n\nconst order = [].concat(\n  defaultKeys.filter(key => !registries[key] && !custom[key]),\n  registries,\n  //custom.data,\n  custom.template,\n  custom.css\n);\n\nfunction configure(method, Parent, target, options, Child) {\n  deprecate(options);\n\n  for (const key in options) {\n    if (hasOwn(isStandardKey, key)) {\n      const value = options[key];\n\n      // warn the developer if they passed a function and ignore its value\n\n      // NOTE: we allow some functions on \"el\" because we duck type element lists\n      // and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n      // function object as the result of querySelector methods\n      if (key !== 'el' && isFunction(value)) {\n        warnIfDebug(\n          `${key} is a Ractive option that does not expect a function and will be ignored`,\n          method === 'init' ? target : null\n        );\n      } else {\n        target[key] = value;\n      }\n    }\n  }\n\n  // disallow combination of `append` and `enhance`\n  if (target.append && target.enhance) {\n    throw new Error('Cannot use append and enhance at the same time');\n  }\n\n  registries.forEach(registry => {\n    registry[method](Parent, target, options, Child);\n  });\n\n  adaptConfigurator[method](Parent, target, options, Child);\n  templateConfigurator[method](Parent, target, options, Child);\n  cssConfigurator[method](Parent, target, options, Child);\n\n  extendOtherMethods(Parent.prototype, target, options);\n}\n\nconst _super = /\\b_super\\b/;\nfunction extendOtherMethods(parent, target, options) {\n  for (const key in options) {\n    if (!isBlacklisted[key] && hasOwn(options, key)) {\n      let member = options[key];\n\n      // if this is a method that overwrites a method, wrap it:\n      if (isFunction(member)) {\n        if (\n          (key in RactiveProto ||\n            (key.slice(0, 2) === 'on' && key.slice(2) in hooks && key in target)) &&\n          !_super.test(member.toString())\n        ) {\n          warnIfDebug(\n            `Overriding Ractive prototype function '${key}' without calling the '${_super}' method can be very dangerous.`\n          );\n        }\n        member = wrapPrototype(parent, key, member);\n      }\n\n      target[key] = member;\n    }\n  }\n}\n\nfunction makeObj(array) {\n  const obj = {};\n  array.forEach(x => (obj[x] = true));\n  return obj;\n}\n\nexport default config;\n","import { createDocumentFragment } from 'utils/dom';\nimport noop from 'utils/noop';\n\nexport default class Item {\n  constructor(options) {\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n\n    this.template = options.template;\n    this.index = options.index;\n    this.type = options.template.t;\n\n    this.dirty = false;\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  find() {\n    return null;\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  findNextNode() {\n    return this.up.findNextNode(this);\n  }\n\n  rebound(update) {\n    if (this.fragment) this.fragment.rebound(update);\n  }\n\n  shuffled() {\n    if (this.fragment) this.fragment.shuffled();\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n}\n\nItem.prototype.findAll = noop;\nItem.prototype.findAllComponents = noop;\n\nexport class ContainerItem extends Item {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    return this.fragment ? this.fragment.detach() : createDocumentFragment();\n  }\n\n  find(selector) {\n    if (this.fragment) {\n      return this.fragment.find(selector);\n    }\n  }\n\n  findAll(selector, options) {\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findComponent(name) {\n    if (this.fragment) {\n      return this.fragment.findComponent(name);\n    }\n  }\n\n  findAllComponents(name, options) {\n    if (this.fragment) {\n      this.fragment.findAllComponents(name, options);\n    }\n  }\n\n  firstNode(skipParent) {\n    return this.fragment && this.fragment.firstNode(skipParent);\n  }\n\n  toString(escape) {\n    return this.fragment ? this.fragment.toString(escape) : '';\n  }\n}\n","import { capture } from 'src/global/capture';\nimport Model from './Model';\nimport { handleChange, mark, marked } from 'shared/methodCallers';\nimport { hasOwn } from 'utils/object';\n\nexport default class ComputationChild extends Model {\n  constructor(parent, key) {\n    super(parent, key);\n\n    this.isReadonly = !this.root.ractive.syncComputedChildren;\n    this.dirty = true;\n    this.isComputed = true;\n  }\n\n  get setRoot() {\n    return this.parent.setRoot;\n  }\n\n  applyValue(value) {\n    super.applyValue(value);\n\n    if (!this.isReadonly) {\n      let source = this.parent;\n      // computed models don't have a shuffle method\n      while (source && source.shuffle) {\n        source = source.parent;\n      }\n\n      if (source) {\n        source.dependencies.forEach(mark);\n      }\n    }\n\n    if (this.setRoot) {\n      this.setRoot.set(this.setRoot.value);\n    }\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      this.dirty = false;\n      const parentValue = this.parent.get();\n      this.value = parentValue ? parentValue[this.key] : undefined;\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    }\n\n    return (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n      ? this.wrapperValue\n      : this.value;\n  }\n\n  handleChange() {\n    if (this.dirty) return;\n    this.dirty = true;\n\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n    this.deps.forEach(handleChange);\n    this.children.forEach(handleChange);\n  }\n\n  joinKey(key) {\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new ComputationChild(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n}\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { capture, startCapturing, stopCapturing } from 'src/global/capture';\nimport { warnIfDebug } from 'utils/log';\nimport Model, { shared } from './Model';\nimport { maybeBind, noVirtual } from './ModelBase';\nimport ComputationChild from './ComputationChild';\nimport { hasConsole } from 'config/environment';\nimport { isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\n\nexport default class Computation extends Model {\n  constructor(parent, signature, key) {\n    super(parent, key);\n\n    this.signature = signature;\n\n    this.isReadonly = !this.signature.setter;\n    this.isComputed = true;\n\n    this.dependencies = [];\n\n    this.children = [];\n    this.childByKey = {};\n\n    this.deps = [];\n\n    this.dirty = true;\n\n    // TODO: is there a less hackish way to do this?\n    this.shuffle = undefined;\n  }\n\n  get setRoot() {\n    if (this.signature.setter) return this;\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      this.dirty = false;\n      const old = this.value;\n      this.value = this.getValue();\n      // this may cause a view somewhere to update, so it must be in a runloop\n      if (!runloop.active()) {\n        runloop.start();\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n        runloop.end();\n      } else {\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n      }\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    }\n\n    // if capturing, this value needs to be unwrapped because it's for external use\n    return maybeBind(\n      this,\n      // if unwrap is supplied, it overrides capture\n      this.wrapper && (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture)\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  getContext() {\n    return this.parent.isRoot ? this.root.ractive : this.parent.get(false, noVirtual);\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      result = this.signature.getter.call(this.root.ractive, this.getContext());\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n\n      // TODO this is all well and good in Chrome, but...\n      // ...also, should encapsulate this stuff better, and only\n      // show it if Ractive.DEBUG\n      if (hasConsole) {\n        if (console.groupCollapsed)\n          console.groupCollapsed(\n            '%cshow details',\n            'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n          );\n        const sig = this.signature;\n        console.error(\n          `${err.name}: ${err.message}\\n\\n${sig.getterString}${\n            sig.getterUseStack ? '\\n\\n' + err.stack : ''\n          }`\n        );\n        if (console.groupCollapsed) console.groupEnd();\n      }\n    }\n\n    const dependencies = stopCapturing();\n    this.setDependencies(dependencies);\n\n    return result;\n  }\n\n  mark() {\n    this.handleChange();\n  }\n\n  rebind(next, previous) {\n    // computations will grab all of their deps again automagically\n    if (next !== previous) this.handleChange();\n  }\n\n  set(value) {\n    if (this.isReadonly) {\n      throw new Error(`Cannot set read-only computed value '${this.key}'`);\n    }\n\n    this.signature.setter(value);\n    this.mark();\n  }\n\n  setDependencies(dependencies) {\n    // unregister any soft dependencies we no longer have\n    let i = this.dependencies.length;\n    while (i--) {\n      const model = this.dependencies[i];\n      if (!~dependencies.indexOf(model)) model.unregister(this);\n    }\n\n    // and add any new ones\n    i = dependencies.length;\n    while (i--) {\n      const model = dependencies[i];\n      if (!~this.dependencies.indexOf(model)) model.register(this);\n    }\n\n    this.dependencies = dependencies;\n  }\n\n  teardown() {\n    let i = this.dependencies.length;\n    while (i--) {\n      if (this.dependencies[i]) this.dependencies[i].unregister(this);\n    }\n    if (this.parent.computed[this.key] === this) delete this.parent.computed[this.key];\n    super.teardown();\n  }\n}\n\nconst prototype = Computation.prototype;\nconst child = ComputationChild.prototype;\nprototype.handleChange = child.handleChange;\nprototype.joinKey = child.joinKey;\n\nshared.Computation = Computation;\n","import { removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport { warnIfDebug } from 'utils/log';\nimport Model from 'src/model/Model';\nimport Computation from 'src/model/Computation';\nimport { startCapturing, stopCapturing } from 'src/global/capture';\nimport getFunction from 'shared/getFunction';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from './resolveReference';\n\nexport default class ExpressionProxy extends Model {\n  constructor(fragment, template) {\n    super(fragment.ractive.viewmodel, null);\n\n    this.fragment = fragment;\n    this.template = template;\n\n    this.isReadonly = true;\n    this.isComputed = true;\n    this.dirty = true;\n\n    this.fn =\n      fragment.ractive.allowExpressions === false\n        ? noop\n        : getFunction(template.s, template.r.length);\n\n    this.models = this.template.r.map(ref => {\n      return resolveReference(this.fragment, ref);\n    });\n    this.dependencies = [];\n\n    this.shuffle = undefined;\n\n    this.bubble();\n  }\n\n  bubble(actuallyChanged = true) {\n    // refresh the keypath\n    this.keypath = undefined;\n\n    if (actuallyChanged) {\n      this.handleChange();\n    }\n  }\n\n  getKeypath() {\n    if (!this.template) return '@undefined';\n    if (!this.keypath) {\n      this.keypath =\n        '@' +\n        this.template.s.replace(/_(\\d+)/g, (match, i) => {\n          if (i >= this.models.length) return match;\n\n          const model = this.models[i];\n          return model ? model.getKeypath() : '@undefined';\n        });\n    }\n\n    return this.keypath;\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      const params = this.models.map(m => (m ? m.get(true) : undefined));\n      result = this.fn.apply(this.fragment.ractive, params);\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n    }\n\n    const dependencies = stopCapturing();\n    // remove missing deps\n    this.dependencies.filter(d => !~dependencies.indexOf(d)).forEach(d => {\n      d.unregister(this);\n      removeFromArray(this.dependencies, d);\n    });\n    // register new deps\n    dependencies.filter(d => !~this.dependencies.indexOf(d)).forEach(d => {\n      d.register(this);\n      this.dependencies.push(d);\n    });\n\n    return result;\n  }\n\n  notifyUpstream() {}\n\n  rebind(next, previous, safe) {\n    const idx = this.models.indexOf(previous);\n\n    if (~idx) {\n      next = rebindMatch(this.template.r[idx], next, previous);\n      if (next !== previous) {\n        previous.unregister(this);\n        this.models.splice(idx, 1, next);\n        if (next) next.addShuffleRegister(this, 'mark');\n      }\n    }\n    this.bubble(!safe);\n  }\n\n  rebound(update) {\n    this.models = this.template.r.map(ref => resolveReference(this.fragment, ref));\n    if (update) this.bubble(true);\n  }\n\n  retrieve() {\n    return this.get();\n  }\n\n  teardown() {\n    this.fragment = undefined;\n    if (this.dependencies) this.dependencies.forEach(d => d.unregister(this));\n    super.teardown();\n  }\n\n  unreference() {\n    super.unreference();\n    collect(this);\n  }\n\n  unregister(dep) {\n    super.unregister(dep);\n    collect(this);\n  }\n\n  unregisterLink(link) {\n    super.unregisterLink(link);\n    collect(this);\n  }\n}\n\nconst prototype = ExpressionProxy.prototype;\nconst computation = Computation.prototype;\nprototype.get = computation.get;\nprototype.handleChange = computation.handleChange;\nprototype.joinKey = computation.joinKey;\nprototype.mark = computation.mark;\nprototype.unbind = noop;\n\nfunction collect(model) {\n  if (!model.deps.length && !model.refs && !model.links.length) model.teardown();\n}\n","import { fireShuffleTasks } from 'src/model/ModelBase';\nimport { REFERENCE } from 'config/types';\nimport { rebindMatch } from 'shared/rebind';\nimport { isArray, isString } from 'utils/is';\nimport { escapeKey } from 'shared/keypaths';\nimport ExpressionProxy from './ExpressionProxy';\nimport resolveReference from './resolveReference';\nimport resolve from './resolve';\n\nimport LinkModel, { Missing } from 'src/model/LinkModel';\n\nexport default class ReferenceExpressionProxy extends LinkModel {\n  constructor(fragment, template) {\n    super(null, null, null, '@undefined');\n    this.root = fragment.ractive.viewmodel;\n    this.template = template;\n    this.rootLink = true;\n    this.template = template;\n    this.fragment = fragment;\n\n    this.rebound();\n  }\n\n  getKeypath() {\n    return this.model ? this.model.getKeypath() : '@undefined';\n  }\n\n  rebound() {\n    const fragment = this.fragment;\n    const template = this.template;\n\n    let base = (this.base = resolve(fragment, template));\n    let idx;\n\n    if (this.proxy) {\n      teardown(this);\n    }\n\n    const proxy = (this.proxy = {\n      rebind: (next, previous) => {\n        if (previous === base) {\n          next = rebindMatch(template, next, previous);\n          if (next !== base) {\n            this.base = base = next;\n          }\n        } else if (~(idx = members.indexOf(previous))) {\n          next = rebindMatch(template.m[idx].n, next, previous);\n          if (next !== members[idx]) {\n            members.splice(idx, 1, next || Missing);\n          }\n        }\n\n        if (next !== previous) {\n          previous.unregister(proxy);\n          if (next) next.addShuffleTask(() => next.register(proxy));\n        }\n      },\n      handleChange: () => {\n        pathChanged();\n      }\n    });\n\n    base.register(proxy);\n\n    const members = (this.members = template.m.map(tpl => {\n      if (isString(tpl)) {\n        return { get: () => tpl };\n      }\n\n      let model;\n\n      if (tpl.t === REFERENCE) {\n        model = resolveReference(fragment, tpl.n);\n        model.register(proxy);\n\n        return model;\n      }\n\n      model = new ExpressionProxy(fragment, tpl);\n      model.register(proxy);\n      return model;\n    }));\n\n    const pathChanged = () => {\n      const model = base.joinAll(\n        members.reduce((list, m) => {\n          const k = m.get();\n          if (isArray(k)) return list.concat(k);\n          else list.push(escapeKey(String(k)));\n          return list;\n        }, [])\n      );\n\n      if (model !== this.model) {\n        this.model = model;\n        this.relinking(model);\n        fireShuffleTasks();\n        refreshPathDeps(this);\n      }\n    };\n\n    pathChanged();\n  }\n\n  teardown() {\n    teardown(this);\n    super.teardown();\n  }\n\n  unreference() {\n    super.unreference();\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n\n  unregister(dep) {\n    super.unregister(dep);\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n}\n\nfunction teardown(proxy) {\n  if (proxy.base) proxy.base.unregister(proxy.proxy);\n  if (proxy.models) {\n    proxy.models.forEach(m => {\n      if (m.unregister) m.unregister(proxy);\n    });\n  }\n}\n\nfunction refreshPathDeps(proxy) {\n  let len = proxy.deps.length;\n  let i, v;\n\n  for (i = 0; i < len; i++) {\n    v = proxy.deps[i];\n    if (v.pathChanged) v.pathChanged();\n    if (v.fragment && v.fragment.pathModel) v.fragment.pathModel.applyValue(proxy.getKeypath());\n  }\n\n  len = proxy.children.length;\n  for (i = 0; i < len; i++) {\n    refreshPathDeps(proxy.children[i]);\n  }\n}\n\nconst eproto = ExpressionProxy.prototype;\nconst proto = ReferenceExpressionProxy.prototype;\n\nproto.unreference = eproto.unreference;\nproto.unregister = eproto.unregister;\nproto.unregisterLink = eproto.unregisterLink;\n","import Fragment from '../Fragment';\nimport { ContainerItem } from './shared/Item';\nimport resolve from '../resolvers/resolve';\n\nexport function resolveAliases(aliases, fragment, dest = {}) {\n  for (let i = 0; i < aliases.length; i++) {\n    if (!dest[aliases[i].n]) {\n      const m = resolve(fragment, aliases[i].x);\n      dest[aliases[i].n] = m;\n      m.reference();\n    }\n  }\n\n  return dest;\n}\n\nexport default class Alias extends ContainerItem {\n  constructor(options) {\n    super(options);\n\n    this.fragment = null;\n  }\n\n  bind() {\n    this.fragment = new Fragment({\n      owner: this,\n      template: this.template.f\n    });\n\n    this.fragment.aliases = resolveAliases(this.template.z, this.up);\n    this.fragment.bind();\n  }\n\n  rebound(update) {\n    const aliases = this.fragment.aliases;\n    for (const k in aliases) {\n      if (aliases[k].rebound) aliases[k].rebound(update);\n      else {\n        aliases[k].unreference();\n        aliases[k] = 0;\n      }\n    }\n\n    resolveAliases(this.template.z, this.up, aliases);\n\n    if (this.fragment) this.fragment.rebound(update);\n  }\n\n  render(target, occupants) {\n    this.rendered = true;\n    if (this.fragment) this.fragment.render(target, occupants);\n  }\n\n  unbind() {\n    for (const k in this.fragment.aliases) {\n      this.fragment.aliases[k].unreference();\n    }\n\n    this.fragment.aliases = {};\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      this.fragment.update();\n    }\n  }\n}\n","import { keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\n// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\n//export const booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\nexport const booleanAttributes = {\n  allowfullscreen: 1,\n  async: 1,\n  autofocus: 1,\n  autoplay: 1,\n  checked: 1,\n  compact: 1,\n  controls: 1,\n  declare: 1,\n  default: 1,\n  defaultchecked: 1,\n  defaultmuted: 1,\n  defaultselected: 1,\n  defer: 1,\n  disabled: 1,\n  enabled: 1,\n  formnovalidate: 1,\n  hidden: 1,\n  indeterminate: 1,\n  inert: 1,\n  ismap: 1,\n  itemscope: 1,\n  loop: 1,\n  multiple: 1,\n  muted: 1,\n  nohref: 1,\n  noresize: 1,\n  noshade: 1,\n  novalidate: 1,\n  nowrap: 1,\n  open: 1,\n  pauseonexit: 1,\n  readonly: 1,\n  required: 1,\n  reversed: 1,\n  scoped: 1,\n  seamless: 1,\n  selected: 1,\n  sortable: 1,\n  translate: 1,\n  truespeed: 1,\n  typemustmatch: 1,\n  visible: 1\n};\nexport const voidElements = {\n  area: 1,\n  base: 1,\n  br: 1,\n  col: 1,\n  command: 1,\n  doctype: 1,\n  embed: 1,\n  hr: 1,\n  img: 1,\n  input: 1,\n  keygen: 1,\n  link: 1,\n  meta: 1,\n  param: 1,\n  source: 1,\n  track: 1,\n  wbr: 1\n};\n\nconst htmlEntities = {\n  quot: 34,\n  amp: 38,\n  apos: 39,\n  lt: 60,\n  gt: 62,\n  nbsp: 160,\n  iexcl: 161,\n  cent: 162,\n  pound: 163,\n  curren: 164,\n  yen: 165,\n  brvbar: 166,\n  sect: 167,\n  uml: 168,\n  copy: 169,\n  ordf: 170,\n  laquo: 171,\n  not: 172,\n  shy: 173,\n  reg: 174,\n  macr: 175,\n  deg: 176,\n  plusmn: 177,\n  sup2: 178,\n  sup3: 179,\n  acute: 180,\n  micro: 181,\n  para: 182,\n  middot: 183,\n  cedil: 184,\n  sup1: 185,\n  ordm: 186,\n  raquo: 187,\n  frac14: 188,\n  frac12: 189,\n  frac34: 190,\n  iquest: 191,\n  Agrave: 192,\n  Aacute: 193,\n  Acirc: 194,\n  Atilde: 195,\n  Auml: 196,\n  Aring: 197,\n  AElig: 198,\n  Ccedil: 199,\n  Egrave: 200,\n  Eacute: 201,\n  Ecirc: 202,\n  Euml: 203,\n  Igrave: 204,\n  Iacute: 205,\n  Icirc: 206,\n  Iuml: 207,\n  ETH: 208,\n  Ntilde: 209,\n  Ograve: 210,\n  Oacute: 211,\n  Ocirc: 212,\n  Otilde: 213,\n  Ouml: 214,\n  times: 215,\n  Oslash: 216,\n  Ugrave: 217,\n  Uacute: 218,\n  Ucirc: 219,\n  Uuml: 220,\n  Yacute: 221,\n  THORN: 222,\n  szlig: 223,\n  agrave: 224,\n  aacute: 225,\n  acirc: 226,\n  atilde: 227,\n  auml: 228,\n  aring: 229,\n  aelig: 230,\n  ccedil: 231,\n  egrave: 232,\n  eacute: 233,\n  ecirc: 234,\n  euml: 235,\n  igrave: 236,\n  iacute: 237,\n  icirc: 238,\n  iuml: 239,\n  eth: 240,\n  ntilde: 241,\n  ograve: 242,\n  oacute: 243,\n  ocirc: 244,\n  otilde: 245,\n  ouml: 246,\n  divide: 247,\n  oslash: 248,\n  ugrave: 249,\n  uacute: 250,\n  ucirc: 251,\n  uuml: 252,\n  yacute: 253,\n  thorn: 254,\n  yuml: 255,\n  OElig: 338,\n  oelig: 339,\n  Scaron: 352,\n  scaron: 353,\n  Yuml: 376,\n  fnof: 402,\n  circ: 710,\n  tilde: 732,\n  Alpha: 913,\n  Beta: 914,\n  Gamma: 915,\n  Delta: 916,\n  Epsilon: 917,\n  Zeta: 918,\n  Eta: 919,\n  Theta: 920,\n  Iota: 921,\n  Kappa: 922,\n  Lambda: 923,\n  Mu: 924,\n  Nu: 925,\n  Xi: 926,\n  Omicron: 927,\n  Pi: 928,\n  Rho: 929,\n  Sigma: 931,\n  Tau: 932,\n  Upsilon: 933,\n  Phi: 934,\n  Chi: 935,\n  Psi: 936,\n  Omega: 937,\n  alpha: 945,\n  beta: 946,\n  gamma: 947,\n  delta: 948,\n  epsilon: 949,\n  zeta: 950,\n  eta: 951,\n  theta: 952,\n  iota: 953,\n  kappa: 954,\n  lambda: 955,\n  mu: 956,\n  nu: 957,\n  xi: 958,\n  omicron: 959,\n  pi: 960,\n  rho: 961,\n  sigmaf: 962,\n  sigma: 963,\n  tau: 964,\n  upsilon: 965,\n  phi: 966,\n  chi: 967,\n  psi: 968,\n  omega: 969,\n  thetasym: 977,\n  upsih: 978,\n  piv: 982,\n  ensp: 8194,\n  emsp: 8195,\n  thinsp: 8201,\n  zwnj: 8204,\n  zwj: 8205,\n  lrm: 8206,\n  rlm: 8207,\n  ndash: 8211,\n  mdash: 8212,\n  lsquo: 8216,\n  rsquo: 8217,\n  sbquo: 8218,\n  ldquo: 8220,\n  rdquo: 8221,\n  bdquo: 8222,\n  dagger: 8224,\n  Dagger: 8225,\n  bull: 8226,\n  hellip: 8230,\n  permil: 8240,\n  prime: 8242,\n  Prime: 8243,\n  lsaquo: 8249,\n  rsaquo: 8250,\n  oline: 8254,\n  frasl: 8260,\n  euro: 8364,\n  image: 8465,\n  weierp: 8472,\n  real: 8476,\n  trade: 8482,\n  alefsym: 8501,\n  larr: 8592,\n  uarr: 8593,\n  rarr: 8594,\n  darr: 8595,\n  harr: 8596,\n  crarr: 8629,\n  lArr: 8656,\n  uArr: 8657,\n  rArr: 8658,\n  dArr: 8659,\n  hArr: 8660,\n  forall: 8704,\n  part: 8706,\n  exist: 8707,\n  empty: 8709,\n  nabla: 8711,\n  isin: 8712,\n  notin: 8713,\n  ni: 8715,\n  prod: 8719,\n  sum: 8721,\n  minus: 8722,\n  lowast: 8727,\n  radic: 8730,\n  prop: 8733,\n  infin: 8734,\n  ang: 8736,\n  and: 8743,\n  or: 8744,\n  cap: 8745,\n  cup: 8746,\n  int: 8747,\n  there4: 8756,\n  sim: 8764,\n  cong: 8773,\n  asymp: 8776,\n  ne: 8800,\n  equiv: 8801,\n  le: 8804,\n  ge: 8805,\n  sub: 8834,\n  sup: 8835,\n  nsub: 8836,\n  sube: 8838,\n  supe: 8839,\n  oplus: 8853,\n  otimes: 8855,\n  perp: 8869,\n  sdot: 8901,\n  lceil: 8968,\n  rceil: 8969,\n  lfloor: 8970,\n  rfloor: 8971,\n  lang: 9001,\n  rang: 9002,\n  loz: 9674,\n  spades: 9824,\n  clubs: 9827,\n  hearts: 9829,\n  diams: 9830\n};\nconst controlCharacters = [\n  8364,\n  129,\n  8218,\n  402,\n  8222,\n  8230,\n  8224,\n  8225,\n  710,\n  8240,\n  352,\n  8249,\n  338,\n  141,\n  381,\n  143,\n  144,\n  8216,\n  8217,\n  8220,\n  8221,\n  8226,\n  8211,\n  8212,\n  732,\n  8482,\n  353,\n  8250,\n  339,\n  157,\n  382,\n  376\n];\nconst entityPattern = new RegExp(\n  '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + keys(htmlEntities).join('|') + '));?',\n  'g'\n);\nconst codePointSupport = isFunction(String.fromCodePoint);\nconst codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\n\nexport function decodeCharacterReferences(html) {\n  return html.replace(entityPattern, (match, entity) => {\n    let code;\n\n    // Handle named entities\n    if (entity[0] !== '#') {\n      code = htmlEntities[entity];\n    } else if (entity[1] === 'x') {\n      code = parseInt(entity.substring(2), 16);\n    } else {\n      code = parseInt(entity.substring(1), 10);\n    }\n\n    if (!code) {\n      return match;\n    }\n\n    return codeToChar(validateCode(code));\n  });\n}\n\nconst lessThan = /</g;\nconst greaterThan = />/g;\nconst amp = /&/g;\nconst invalid = 65533;\n\nexport function escapeHtml(str) {\n  return str\n    .replace(amp, '&amp;')\n    .replace(lessThan, '&lt;')\n    .replace(greaterThan, '&gt;');\n}\n\n// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n// to replace them ourselves\n//\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\n/* istanbul ignore next */\nfunction validateCode(code) {\n  if (!code) {\n    return invalid;\n  }\n\n  // line feed becomes generic whitespace\n  if (code === 10) {\n    return 32;\n  }\n\n  // ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n  if (code < 128) {\n    return code;\n  }\n\n  // code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n  // to correct the mistake or we'll end up with missing  signs and so on\n  if (code <= 159) {\n    return controlCharacters[code - 128];\n  }\n\n  // basic multilingual plane\n  if (code < 55296) {\n    return code;\n  }\n\n  // UTF-16 surrogate halves\n  if (code <= 57343) {\n    return invalid;\n  }\n\n  // rest of the basic multilingual plane\n  if (code <= 65535) {\n    return code;\n  } else if (!codePointSupport) {\n    return invalid;\n  }\n\n  // supplementary multilingual plane 0x10000 - 0x1ffff\n  if (code >= 65536 && code <= 131071) {\n    return code;\n  }\n\n  // supplementary ideographic plane 0x20000 - 0x2ffff\n  if (code >= 131072 && code <= 196607) {\n    return code;\n  }\n\n  return invalid;\n}\n","import cleanCss from 'utils/cleanCss';\nimport { isString } from 'utils/is';\n\nconst space = /\\s+/;\n\nexport function readStyle(css) {\n  if (!isString(css)) return {};\n\n  return cleanCss(css, (css, reconstruct) => {\n    return css\n      .split(';')\n      .filter(rule => !!rule.trim())\n      .map(reconstruct)\n      .reduce((rules, rule) => {\n        const i = rule.indexOf(':');\n        const name = rule.substr(0, i).trim();\n        rules[name] = rule.substr(i + 1).trim();\n        return rules;\n      }, {});\n  });\n}\n\nexport function readClass(str) {\n  const list = str.split(space);\n\n  // remove any empty entries\n  let i = list.length;\n  while (i--) {\n    if (!list[i]) list.splice(i, 1);\n  }\n\n  return list;\n}\n","import { html } from 'config/namespaces';\nimport { safeToStringValue } from 'utils/dom';\nimport { arrayContains } from 'utils/array';\nimport noop from 'utils/noop';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport { readStyle, readClass } from 'src/view/helpers/specialAttrs';\nimport { keys as objectKeys } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\n\nconst textTypes = [\n  undefined,\n  'text',\n  'search',\n  'url',\n  'email',\n  'hidden',\n  'password',\n  'search',\n  'reset',\n  'submit'\n];\n\nexport default function getUpdateDelegate(attribute) {\n  const { element, name } = attribute;\n\n  if (name === 'value') {\n    if (attribute.interpolator) attribute.interpolator.bound = true;\n\n    // special case - selects\n    if (element.name === 'select' && name === 'value') {\n      return element.getAttribute('multiple') ? updateMultipleSelectValue : updateSelectValue;\n    }\n\n    if (element.name === 'textarea') return updateStringValue;\n\n    // special case - contenteditable\n    if (element.getAttribute('contenteditable') != null) return updateContentEditableValue;\n\n    // special case - <input>\n    if (element.name === 'input') {\n      const type = element.getAttribute('type');\n\n      // type='file' value='{{fileList}}'>\n      if (type === 'file') return noop; // read-only\n\n      // type='radio' name='{{twoway}}'\n      if (type === 'radio' && element.binding && element.binding.attribute.name === 'name')\n        return updateRadioValue;\n\n      if (~textTypes.indexOf(type)) return updateStringValue;\n    }\n\n    return updateValue;\n  }\n\n  const node = element.node;\n\n  // special case - <input type='radio' name='{{twoway}}' value='foo'>\n  if (attribute.isTwoway && name === 'name') {\n    if (node.type === 'radio') return updateRadioName;\n    if (node.type === 'checkbox') return updateCheckboxName;\n  }\n\n  if (name === 'style') return updateStyleAttribute;\n\n  if (name.indexOf('style-') === 0) return updateInlineStyle;\n\n  // special case - class names. IE fucks things up, again\n  if (name === 'class' && (!node.namespaceURI || node.namespaceURI === html))\n    return updateClassName;\n\n  if (name.indexOf('class-') === 0) return updateInlineClass;\n\n  if (attribute.isBoolean) {\n    const type = element.getAttribute('type');\n    if (attribute.interpolator && name === 'checked' && (type === 'checkbox' || type === 'radio'))\n      attribute.interpolator.bound = true;\n    return updateBoolean;\n  }\n\n  if (attribute.namespace && attribute.namespace !== attribute.node.namespaceURI)\n    return updateNamespacedAttribute;\n\n  return updateAttribute;\n}\n\nfunction updateMultipleSelectValue(reset) {\n  let value = this.getValue();\n\n  if (!isArray(value)) value = [value];\n\n  const options = this.node.options;\n  let i = options.length;\n\n  if (reset) {\n    while (i--) options[i].selected = false;\n  } else {\n    while (i--) {\n      const option = options[i];\n      const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n\n      option.selected = arrayContains(value, optionValue);\n    }\n  }\n}\n\nfunction updateSelectValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    // TODO is locked still a thing?\n    this.node._ractive.value = value;\n\n    const options = this.node.options;\n    let i = options.length;\n    let wasSelected = false;\n\n    if (reset) {\n      while (i--) options[i].selected = false;\n    } else {\n      while (i--) {\n        const option = options[i];\n        const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n        if (option.disabled && option.selected) wasSelected = true;\n\n        if (optionValue == value) {\n          // double equals as we may be comparing numbers with strings\n          option.selected = true;\n          return;\n        }\n      }\n    }\n\n    if (!wasSelected) this.node.selectedIndex = -1;\n  }\n}\n\nfunction updateContentEditableValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    if (reset) this.node.innerHTML = '';\n    else this.node.innerHTML = value === undefined ? '' : value;\n  }\n}\n\nfunction updateRadioValue(reset) {\n  const node = this.node;\n  const wasChecked = node.checked;\n\n  const value = this.getValue();\n\n  if (reset) return (node.checked = false);\n\n  //node.value = this.element.getAttribute( 'value' );\n  node.value = this.node._ractive.value = value;\n  node.checked = this.element.compare(value, this.element.getAttribute('name'));\n\n  // This is a special case - if the input was checked, and the value\n  // changed so that it's no longer checked, the twoway binding is\n  // most likely out of date. To fix it we have to jump through some\n  // hoops... this is a little kludgy but it works\n  if (wasChecked && !node.checked && this.element.binding && this.element.binding.rendered) {\n    this.element.binding.group.model.set(this.element.binding.group.getValue());\n  }\n}\n\nfunction updateValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node.removeAttribute('value');\n      this.node.value = this.node._ractive.value = null;\n    } else {\n      const value = this.getValue();\n\n      this.node.value = this.node._ractive.value = value;\n      this.node.setAttribute('value', safeToStringValue(value));\n    }\n  }\n}\n\nfunction updateStringValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node._ractive.value = '';\n      this.node.removeAttribute('value');\n    } else {\n      const value = this.getValue();\n\n      this.node._ractive.value = value;\n\n      this.node.value = safeToStringValue(value);\n      this.node.setAttribute('value', safeToStringValue(value));\n    }\n  }\n}\n\nfunction updateRadioName(reset) {\n  if (reset) this.node.checked = false;\n  else this.node.checked = this.element.compare(this.getValue(), this.element.binding.getValue());\n}\n\nfunction updateCheckboxName(reset) {\n  const { element, node } = this;\n  const binding = element.binding;\n\n  const value = this.getValue();\n  const valueAttribute = element.getAttribute('value');\n\n  if (reset) {\n    // TODO: WAT?\n  }\n\n  if (!isArray(value)) {\n    binding.isChecked = node.checked = element.compare(value, valueAttribute);\n  } else {\n    let i = value.length;\n    while (i--) {\n      if (element.compare(valueAttribute, value[i])) {\n        binding.isChecked = node.checked = true;\n        return;\n      }\n    }\n    binding.isChecked = node.checked = false;\n  }\n}\n\nfunction updateStyleAttribute(reset) {\n  const props = reset ? {} : readStyle(this.getValue() || '');\n  const style = this.node.style;\n  const keys = objectKeys(props);\n  const prev = this.previous || [];\n\n  let i = 0;\n  while (i < keys.length) {\n    if (keys[i] in style) {\n      const safe = props[keys[i]].replace('!important', '');\n      style.setProperty(keys[i], safe, safe.length !== props[keys[i]].length ? 'important' : '');\n    }\n    i++;\n  }\n\n  // remove now-missing attrs\n  i = prev.length;\n  while (i--) {\n    if (!~keys.indexOf(prev[i]) && prev[i] in style) style.setProperty(prev[i], '', '');\n  }\n\n  this.previous = keys;\n}\n\nfunction updateInlineStyle(reset) {\n  if (!this.style) {\n    this.style = hyphenateCamel(this.name.substr(6));\n  }\n\n  if (reset && this.node.style.getPropertyValue(this.style) !== this.last) return;\n\n  const value = reset ? '' : safeToStringValue(this.getValue());\n  const safe = value.replace('!important', '');\n  this.node.style.setProperty(this.style, safe, safe.length !== value.length ? 'important' : '');\n  this.last = this.node.style.getPropertyValue(this.style);\n}\n\nfunction updateClassName(reset) {\n  const value = reset ? [] : readClass(safeToStringValue(this.getValue()));\n\n  // watch out for werdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const prev = this.previous || [];\n\n  const className = value.concat(attr.filter(c => !~prev.indexOf(c))).join(' ');\n\n  if (className !== cls) {\n    if (!isString(this.node.className)) {\n      this.node.className.baseVal = className;\n    } else {\n      this.node.className = className;\n    }\n  }\n\n  this.previous = value;\n}\n\nfunction updateInlineClass(reset) {\n  const name = this.name.substr(6);\n\n  // watch out for werdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const value = reset ? false : this.getValue();\n\n  if (!this.inlineClass) this.inlineClass = name;\n\n  if (value && !~attr.indexOf(name)) attr.push(name);\n  else if (!value && ~attr.indexOf(name)) attr.splice(attr.indexOf(name), 1);\n\n  if (!isString(this.node.className)) {\n    this.node.className.baseVal = attr.join(' ');\n  } else {\n    this.node.className = attr.join(' ');\n  }\n}\n\nfunction updateBoolean(reset) {\n  // with two-way binding, only update if the change wasn't initiated by the user\n  // otherwise the cursor will often be sent to the wrong place\n  if (!this.locked) {\n    if (reset) {\n      if (this.useProperty) this.node[this.propertyName] = false;\n      this.node.removeAttribute(this.propertyName);\n    } else {\n      if (this.useProperty) {\n        this.node[this.propertyName] = this.getValue();\n      } else {\n        const val = this.getValue();\n        if (val) {\n          this.node.setAttribute(this.propertyName, isString(val) ? val : '');\n        } else {\n          this.node.removeAttribute(this.propertyName);\n        }\n      }\n    }\n  }\n}\n\nexport function updateAttribute(reset) {\n  if (reset) {\n    if (this.node.getAttribute(this.name) === this.value) {\n      this.node.removeAttribute(this.name);\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttribute(this.name, this.value);\n  }\n}\n\nexport function updateNamespacedAttribute(reset) {\n  if (reset) {\n    if (\n      this.value ===\n      this.node.getAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1))\n    ) {\n      this.node.removeAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1));\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttributeNS(\n      this.namespace,\n      this.name.slice(this.name.indexOf(':') + 1),\n      this.value\n    );\n  }\n}\n","export default {\n  'accept-charset': 'acceptCharset',\n  accesskey: 'accessKey',\n  bgcolor: 'bgColor',\n  class: 'className',\n  codebase: 'codeBase',\n  colspan: 'colSpan',\n  contenteditable: 'contentEditable',\n  datetime: 'dateTime',\n  dirname: 'dirName',\n  for: 'htmlFor',\n  'http-equiv': 'httpEquiv',\n  ismap: 'isMap',\n  maxlength: 'maxLength',\n  novalidate: 'noValidate',\n  pubdate: 'pubDate',\n  readonly: 'readOnly',\n  rowspan: 'rowSpan',\n  tabindex: 'tabIndex',\n  usemap: 'useMap'\n};\n","import { doc } from 'config/environment';\nimport { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\n\nconst div = doc ? createElement('div') : null;\n\nlet attributes = false;\nexport function inAttributes() {\n  return attributes;\n}\n\nexport default class ConditionalAttribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.attributes = [];\n\n    this.owner = options.owner;\n\n    this.fragment = new Fragment({\n      ractive: this.ractive,\n      owner: this,\n      template: this.template\n    });\n\n    // this fragment can't participate in node-y things\n    this.fragment.findNextNode = noop;\n\n    this.dirty = false;\n  }\n\n  bind() {\n    this.fragment.bind();\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.owner.bubble();\n    }\n  }\n\n  destroyed() {\n    this.unrender();\n  }\n\n  render() {\n    this.node = this.owner.node;\n    if (this.node) {\n      this.isSvg = this.node.namespaceURI === svg;\n    }\n\n    attributes = true;\n    if (!this.rendered) this.fragment.render();\n\n    this.rendered = true;\n    this.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n    this.update();\n    attributes = false;\n  }\n\n  toString() {\n    return this.fragment.toString();\n  }\n\n  unbind() {\n    this.fragment.unbind();\n  }\n\n  unrender() {\n    this.rendered = false;\n    this.fragment.unrender();\n  }\n\n  update() {\n    let str;\n    let attrs;\n\n    if (this.dirty) {\n      this.dirty = false;\n\n      const current = attributes;\n      attributes = true;\n      this.fragment.update();\n\n      if (this.rendered && this.node) {\n        str = this.fragment.toString();\n\n        attrs = parseAttributes(str, this.isSvg);\n\n        // any attributes that previously existed but no longer do\n        // must be removed\n        this.attributes.filter(a => notIn(attrs, a)).forEach(a => {\n          this.node.removeAttribute(a.name);\n        });\n\n        attrs.forEach(a => {\n          this.node.setAttribute(a.name, a.value);\n        });\n\n        this.attributes = attrs;\n      }\n\n      attributes = current || false;\n    }\n  }\n}\n\nconst onlyWhitespace = /^\\s*$/;\nfunction parseAttributes(str, isSvg) {\n  if (onlyWhitespace.test(str)) return [];\n  const tagName = isSvg ? 'svg' : 'div';\n  return str\n    ? (div.innerHTML = `<${tagName} ${str}></${tagName}>`) && toArray(div.childNodes[0].attributes)\n    : [];\n}\n\nfunction notIn(haystack, needle) {\n  let i = haystack.length;\n\n  while (i--) {\n    if (haystack[i].name === needle.name) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import { INTERPOLATOR } from 'config/types';\nimport namespaces from 'config/namespaces';\nimport { safeAttributeString } from 'utils/dom';\nimport { booleanAttributes } from 'utils/html';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\nimport findElement from '../shared/findElement';\nimport getUpdateDelegate from './attribute/getUpdateDelegate';\nimport propertyNames from './attribute/propertyNames';\nimport { inAttributes } from './ConditionalAttribute';\nimport { isArray, isString } from 'utils/is';\n\nfunction lookupNamespace(node, prefix) {\n  const qualified = `xmlns:${prefix}`;\n\n  while (node) {\n    if (node.hasAttribute && node.hasAttribute(qualified)) return node.getAttribute(qualified);\n    node = node.parentNode;\n  }\n\n  return namespaces[prefix];\n}\n\nlet attribute = false;\nexport function inAttribute() {\n  return attribute;\n}\n\nexport default class Attribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n    this.namespace = null;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = options.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.rendered = false;\n    this.updateDelegate = null;\n    this.fragment = null;\n\n    this.element.attributeByName[this.name] = this;\n\n    if (!isArray(options.template.f)) {\n      this.value = options.template.f;\n      if (this.value === 0) {\n        this.value = '';\n      } else if (this.value === undefined) {\n        this.value = true;\n      }\n      return;\n    } else {\n      this.fragment = new Fragment({\n        owner: this,\n        template: options.template.f\n      });\n    }\n\n    this.interpolator =\n      this.fragment &&\n      this.fragment.items.length === 1 &&\n      this.fragment.items[0].type === INTERPOLATOR &&\n      this.fragment.items[0];\n\n    if (this.interpolator) this.interpolator.owner = this;\n  }\n\n  bind() {\n    if (this.fragment) {\n      this.fragment.bind();\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.up.bubble();\n      this.element.bubble();\n      this.dirty = true;\n    }\n  }\n\n  firstNode() {}\n\n  getString() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.toString()\n      : this.value != null\n        ? '' + this.value\n        : '';\n    attribute = false;\n    return value;\n  }\n\n  // TODO could getValue ever be called for a static attribute,\n  // or can we assume that this.fragment exists?\n  getValue() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.valueOf()\n      : booleanAttributes[this.name.toLowerCase()]\n        ? true\n        : this.value;\n    attribute = false;\n    return value;\n  }\n\n  render() {\n    const node = this.element.node;\n    this.node = node;\n\n    // should we use direct property access, or setAttribute?\n    if (!node.namespaceURI || node.namespaceURI === namespaces.html) {\n      this.propertyName = propertyNames[this.name] || this.name;\n\n      if (node[this.propertyName] !== undefined) {\n        this.useProperty = true;\n      }\n\n      // is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n      // node.selected = true rather than node.setAttribute( 'selected', '' )\n      if (booleanAttributes[this.name.toLowerCase()] || this.isTwoway) {\n        this.isBoolean = true;\n      }\n\n      if (this.propertyName === 'value') {\n        node._ractive.value = this.value;\n      }\n    }\n\n    if (node.namespaceURI) {\n      const index = this.name.indexOf(':');\n      if (index !== -1) {\n        this.namespace = lookupNamespace(node, this.name.slice(0, index));\n      } else {\n        this.namespace = node.namespaceURI;\n      }\n    }\n\n    this.rendered = true;\n    this.updateDelegate = getUpdateDelegate(this);\n    this.updateDelegate();\n  }\n\n  toString() {\n    if (inAttributes()) return '';\n    attribute = true;\n\n    const value = this.getValue();\n\n    // Special case - select and textarea values (should not be stringified)\n    if (\n      this.name === 'value' &&\n      (this.element.getAttribute('contenteditable') !== undefined ||\n        (this.element.name === 'select' || this.element.name === 'textarea'))\n    ) {\n      return;\n    }\n\n    // Special case  bound radio `name` attributes\n    if (\n      this.name === 'name' &&\n      this.element.name === 'input' &&\n      this.interpolator &&\n      this.element.getAttribute('type') === 'radio'\n    ) {\n      return `name=\"{{${this.interpolator.model.getKeypath()}}}\"`;\n    }\n\n    // Special case - style and class attributes and directives\n    if (\n      this.owner === this.element &&\n      (this.name === 'style' || this.name === 'class' || this.style || this.inlineClass)\n    ) {\n      return;\n    }\n\n    if (\n      !this.rendered &&\n      this.owner === this.element &&\n      (!this.name.indexOf('style-') || !this.name.indexOf('class-'))\n    ) {\n      if (!this.name.indexOf('style-')) {\n        this.style = hyphenateCamel(this.name.substr(6));\n      } else {\n        this.inlineClass = this.name.substr(6);\n      }\n\n      return;\n    }\n\n    if (booleanAttributes[this.name.toLowerCase()])\n      return value\n        ? isString(value)\n          ? `${this.name}=\"${safeAttributeString(value)}\"`\n          : this.name\n        : '';\n    if (value == null) return '';\n\n    const str = safeAttributeString(this.getString());\n    attribute = false;\n\n    return str ? `${this.name}=\"${str}\"` : this.name;\n  }\n\n  unbind() {\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender() {\n    this.updateDelegate(true);\n\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      let binding;\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      if (this.rendered) this.updateDelegate();\n      if (this.isTwoway && !this.locked) {\n        this.interpolator.twowayBinding.lastVal(true, this.interpolator.model.get());\n      } else if (this.name === 'value' && (binding = this.element.binding)) {\n        // special case: name bound element with dynamic value\n        const attr = binding.attribute;\n        if (attr && !attr.dirty && attr.rendered) {\n          this.element.binding.attribute.updateDelegate();\n        }\n      }\n    }\n  }\n}\n","import { INTERPOLATOR, ELEMENT } from 'config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport { isArray } from 'utils/is';\n\nexport default class BindingFlag extends Item {\n  constructor(options) {\n    super(options);\n\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.flag = options.template.v === 'l' ? 'lazy' : 'twoway';\n    this.bubbler = this.owner === this.element ? this.element : this.up;\n\n    if (this.element.type === ELEMENT) {\n      if (isArray(options.template.f)) {\n        this.fragment = new Fragment({\n          owner: this,\n          template: options.template.f\n        });\n      }\n\n      this.interpolator =\n        this.fragment &&\n        this.fragment.items.length === 1 &&\n        this.fragment.items[0].type === INTERPOLATOR &&\n        this.fragment.items[0];\n    }\n  }\n\n  bind() {\n    if (this.fragment) this.fragment.bind();\n    set(this, this.getValue(), true);\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.bubbler.bubble();\n      this.dirty = true;\n    }\n  }\n\n  getValue() {\n    if (this.fragment) return this.fragment.valueOf();\n    else if ('value' in this) return this.value;\n    else if ('f' in this.template) return this.template.f;\n    else return true;\n  }\n\n  render() {\n    set(this, this.getValue(), true);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    if (this.fragment) this.fragment.unbind();\n\n    delete this.element[this.flag];\n  }\n\n  unrender() {\n    if (this.element.rendered) this.element.recreateTwowayBinding();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      set(this, this.getValue(), true);\n    }\n  }\n}\n\nfunction set(flag, value, update) {\n  if (value === 0) {\n    flag.value = true;\n  } else if (value === 'true') {\n    flag.value = true;\n  } else if (value === 'false' || value === '0') {\n    flag.value = false;\n  } else {\n    flag.value = value;\n  }\n\n  const current = flag.element[flag.flag];\n  flag.element[flag.flag] = flag.value;\n  if (update && !flag.element.attributes.binding && current !== flag.value) {\n    flag.element.recreateTwowayBinding();\n  }\n\n  return flag.value;\n}\n","import Item from './shared/Item';\nimport noop from 'utils/noop';\nimport { detachNode } from 'utils/dom';\nimport { doc } from 'config/environment';\nimport { assign, create } from 'utils/object';\n\nexport default function Comment(options) {\n  Item.call(this, options);\n}\n\nconst proto = create(Item.prototype);\n\nassign(proto, {\n  bind: noop,\n  unbind: noop,\n  update: noop,\n\n  detach() {\n    return detachNode(this.node);\n  },\n\n  firstNode() {\n    return this.node;\n  },\n\n  render(target) {\n    this.rendered = true;\n\n    this.node = doc.createComment(this.template.c);\n    target.appendChild(this.node);\n  },\n\n  toString() {\n    return `<!-- ${this.template.c} -->`;\n  },\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n});\n\nComment.prototype = proto;\n","import { SharedModel } from './SharedModel';\nimport { Missing } from '../LinkModel';\nimport { create } from 'utils/object';\n\nexport default class RactiveModel extends SharedModel {\n  constructor(ractive) {\n    super(ractive, '@this');\n    this.ractive = ractive;\n  }\n\n  joinKey(key) {\n    const model = super.joinKey(key);\n\n    if ((key === 'root' || key === 'parent') && !model.isLink) return initLink(model, key);\n    else if (key === 'data') return this.ractive.viewmodel;\n    else if (key === 'cssData') return this.ractive.constructor._cssModel;\n\n    return model;\n  }\n}\n\nfunction initLink(model, key) {\n  model.applyValue = function(value) {\n    this.parent.value[key] = value;\n    if (value && value.viewmodel) {\n      this.link(value.viewmodel.getRactiveModel(), key);\n      this._link.markedAll();\n    } else {\n      this.link(create(Missing), key);\n      this._link.markedAll();\n    }\n  };\n\n  if (key === 'root') {\n    const mark = model.mark;\n    model.mark = function(force) {\n      if (this._marking) return;\n      this._marking = true;\n      mark.apply(this, force);\n      this._marking = false;\n    };\n  }\n\n  model.applyValue(model.parent.ractive[key], key);\n  model._link.set = v => model.applyValue(v);\n  model._link.applyValue = v => model.applyValue(v);\n\n  return model._link;\n}\n","import { capture } from 'src/global/capture';\nimport Model from './Model';\nimport { handleChange, mark } from 'shared/methodCallers';\nimport RactiveModel from './specials/RactiveModel';\nimport SharedModel, { GlobalModel, SharedModel as SharedBase } from './specials/SharedModel';\nimport { splitKeypath, unescapeKey } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\n\nconst specialModels = {\n  '@this'(root) {\n    return root.getRactiveModel();\n  },\n  '@global'() {\n    return GlobalModel;\n  },\n  '@shared'() {\n    return SharedModel;\n  },\n  '@style'(root) {\n    return root.getRactiveModel().joinKey('cssData');\n  },\n  '@helpers'(root) {\n    return root.getHelpers();\n  }\n};\nspecialModels['@'] = specialModels['@this'];\n\nexport default class RootModel extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.ractive = options.ractive; // TODO sever this link\n\n    this.value = options.data;\n    this.adaptors = options.adapt;\n    this.adapt();\n  }\n\n  attached(fragment) {\n    attachImplicits(this, fragment);\n  }\n\n  createLink(keypath, target, targetPath, options) {\n    const keys = splitKeypath(keypath);\n\n    let model = this;\n    while (keys.length) {\n      const key = keys.shift();\n      model = model.childByKey[key] || model.joinKey(key);\n    }\n\n    return model.link(target, targetPath, options);\n  }\n\n  detached() {\n    detachImplicits(this);\n  }\n\n  get(shouldCapture, options) {\n    if (shouldCapture) capture(this);\n\n    if (!options || options.virtual !== false) {\n      return this.getVirtual();\n    } else {\n      return this.value;\n    }\n  }\n\n  getHelpers() {\n    if (!this.helpers) this.helpers = new SharedBase(this.ractive.helpers, 'helpers');\n    return this.helpers;\n  }\n\n  getKeypath() {\n    return '';\n  }\n\n  getRactiveModel() {\n    return this.ractiveModel || (this.ractiveModel = new RactiveModel(this.ractive));\n  }\n\n  getValueChildren() {\n    const children = super.getValueChildren(this.value);\n\n    this.children.forEach(child => {\n      if (child._link) {\n        const idx = children.indexOf(child);\n        if (~idx) children.splice(idx, 1, child._link);\n        else children.push(child._link);\n      }\n    });\n\n    return children;\n  }\n\n  has(key) {\n    if (key[0] === '~' && key[1] === '/') key = key.slice(2);\n    if (specialModels[key] || key === '') return true;\n\n    if (super.has(key)) {\n      return true;\n    } else {\n      const unescapedKey = unescapeKey(key);\n\n      // mappings/links and computations\n      if (this.childByKey[unescapedKey] && this.childByKey[unescapedKey]._link) return true;\n    }\n  }\n\n  joinKey(key, opts) {\n    if (key[0] === '~' && key[1] === '/') key = key.slice(2);\n\n    if (key[0] === '@') {\n      const fn = specialModels[key];\n      if (fn) return fn(this);\n    } else {\n      return super.joinKey(key, opts);\n    }\n  }\n\n  set(value) {\n    // TODO wrapping root node is a baaaad idea. We should prevent this\n    const wrapper = this.wrapper;\n    if (wrapper) {\n      const shouldTeardown = !wrapper.reset || wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        wrapper.teardown();\n        this.wrapper = null;\n        this.value = value;\n        this.adapt();\n      }\n    } else {\n      this.value = value;\n      this.adapt();\n    }\n\n    this.deps.forEach(handleChange);\n    this.children.forEach(mark);\n  }\n\n  retrieve() {\n    return this.wrapper ? this.wrapper.get() : this.value;\n  }\n\n  teardown() {\n    super.teardown();\n    this.ractiveModel && this.ractiveModel.teardown();\n  }\n}\nRootModel.prototype.update = noop;\n\nfunction attachImplicits(model, fragment) {\n  if (model._link && model._link.implicit && model._link.isDetached()) {\n    model.attach(fragment);\n  }\n\n  // look for virtual children to relink and cascade\n  for (const k in model.childByKey) {\n    if (k in model.value) {\n      attachImplicits(model.childByKey[k], fragment);\n    } else if (!model.childByKey[k]._link || model.childByKey[k]._link.isDetached()) {\n      const mdl = resolveReference(fragment, k);\n      if (mdl) {\n        model.childByKey[k].link(mdl, k, { implicit: true });\n      }\n    }\n  }\n}\n\nfunction detachImplicits(model) {\n  if (model._link && model._link.implicit) {\n    model.unlink();\n  }\n\n  for (const k in model.childByKey) {\n    detachImplicits(model.childByKey[k]);\n  }\n}\n","import { fatal, warnIfDebug, welcome } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { ensureArray, combine } from 'utils/array';\nimport { findInViewHierarchy } from 'shared/registry';\nimport dataConfigurator from './config/custom/data';\nimport RootModel from 'src/model/RootModel';\nimport hooks from 'src/events/Hook';\nimport subscribe from './helpers/subscribe';\nimport Ractive from '../Ractive';\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, INTERPOLATOR, TRANSITION } from 'config/types';\nimport { assign, create, hasOwn } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\nimport { compute } from 'src/Ractive/prototype/compute';\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'decorators',\n  'easing',\n  'events',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nconst protoRegistries = ['computed', 'helpers'];\n\nlet uid = 0;\n\nexport default function construct(ractive, options) {\n  if (Ractive.DEBUG) welcome();\n\n  initialiseProperties(ractive);\n  handleAttributes(ractive);\n\n  // set up event subscribers\n  subscribe(ractive, options, 'on');\n\n  // if there's not a delegation setting, inherit from parent if it's not default\n  if (\n    !hasOwn(options, 'delegate') &&\n    ractive.parent &&\n    ractive.parent.delegate !== ractive.delegate\n  ) {\n    ractive.delegate = false;\n  }\n\n  // plugins that need to run at construct\n  if (isArray(options.use)) {\n    ractive.use.apply(ractive, options.use.filter(p => p.construct));\n  }\n\n  // TODO don't allow `onconstruct` with `new Ractive()`, there's no need for it\n  hooks.construct.fire(ractive, options);\n\n  // Add registries\n  let i = registryNames.length;\n  while (i--) {\n    const name = registryNames[i];\n    ractive[name] = assign(create(ractive.constructor[name] || null), options[name]);\n  }\n\n  i = protoRegistries.length;\n  while (i--) {\n    const name = protoRegistries[i];\n    ractive[name] = assign(create(ractive.constructor.prototype[name]), options[name]);\n  }\n\n  if (ractive._attributePartial) {\n    ractive.partials['extra-attributes'] = ractive._attributePartial;\n    delete ractive._attributePartial;\n  }\n\n  // Create a viewmodel\n  const viewmodel = new RootModel({\n    adapt: getAdaptors(ractive, ractive.adapt, options),\n    data: dataConfigurator.init(ractive.constructor, ractive, options),\n    ractive\n  });\n\n  // once resolved, share the adaptors array between the root model and instance\n  ractive.adapt = viewmodel.adaptors;\n\n  ractive.viewmodel = viewmodel;\n\n  for (const k in ractive.computed) {\n    compute.call(ractive, k, ractive.computed[k]);\n  }\n}\n\nfunction getAdaptors(ractive, protoAdapt, options) {\n  protoAdapt = protoAdapt.map(lookup);\n  const adapt = ensureArray(options.adapt).map(lookup);\n\n  const srcs = [protoAdapt, adapt];\n  if (ractive.parent && !ractive.isolated) {\n    srcs.push(ractive.parent.viewmodel.adaptors);\n  }\n\n  return combine.apply(null, srcs);\n\n  function lookup(adaptor) {\n    if (isString(adaptor)) {\n      adaptor = findInViewHierarchy('adaptors', ractive, adaptor);\n\n      if (!adaptor) {\n        fatal(missingPlugin(adaptor, 'adaptor'));\n      }\n    }\n\n    return adaptor;\n  }\n}\n\nfunction initialiseProperties(ractive) {\n  // Generate a unique identifier, for places where you'd use a weak map if it\n  // existed\n  ractive._guid = 'r-' + uid++;\n\n  // events\n  ractive._subs = create(null);\n  ractive._nsSubs = 0;\n\n  // storage for item configuration from instantiation to reset,\n  // like dynamic functions or original values\n  ractive._config = {};\n\n  // events\n  ractive.event = null;\n  ractive._eventQueue = [];\n\n  // observers\n  ractive._observers = [];\n\n  // external children\n  ractive._children = [];\n  ractive._children.byName = {};\n  ractive.children = ractive._children;\n\n  if (!ractive.component) {\n    ractive.root = ractive;\n    ractive.parent = ractive.container = null; // TODO container still applicable?\n  }\n}\n\nfunction handleAttributes(ractive) {\n  const component = ractive.component;\n  const attributes = ractive.constructor.attributes;\n\n  if (attributes && component) {\n    const tpl = component.template;\n    const attrs = tpl.m ? tpl.m.slice() : [];\n\n    // grab all of the passed attribute names\n    const props = attrs.filter(a => a.t === ATTRIBUTE).map(a => a.n);\n\n    // warn about missing requireds\n    attributes.required.forEach(p => {\n      if (!~props.indexOf(p)) {\n        warnIfDebug(`Component '${component.name}' requires attribute '${p}' to be provided`);\n      }\n    });\n\n    // set up a partial containing non-property attributes\n    const all = attributes.optional.concat(attributes.required);\n    const partial = [];\n    let i = attrs.length;\n    while (i--) {\n      const a = attrs[i];\n      if (a.t === ATTRIBUTE && !~all.indexOf(a.n)) {\n        if (attributes.mapAll) {\n          // map the attribute if requested and make the extra attribute in the partial refer to the mapping\n          partial.unshift({\n            t: ATTRIBUTE,\n            n: a.n,\n            f: [{ t: INTERPOLATOR, r: `~/${a.n}` }]\n          });\n        } else {\n          // transfer the attribute to the extra attributes partal\n          partial.unshift(attrs.splice(i, 1)[0]);\n        }\n      } else if (\n        !attributes.mapAll &&\n        (a.t === DECORATOR || a.t === TRANSITION || a.t === BINDING_FLAG)\n      ) {\n        partial.unshift(attrs.splice(i, 1)[0]);\n      }\n    }\n\n    if (partial.length) component.template = { t: tpl.t, e: tpl.e, f: tpl.f, m: attrs, p: tpl.p };\n    ractive._attributePartial = partial;\n  }\n}\n","import { build, set } from '../../shared/set';\nimport SharedModel from '../../model/specials/SharedModel';\nimport { isObjectType } from 'utils/is';\n\nexport default function sharedSet(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = SharedModel;\n\n  return set(build({ viewmodel: model }, keypath, value, true), opts);\n}\n","import SharedModel from '../../model/specials/SharedModel';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function sharedGet(keypath) {\n  return SharedModel.joinAll(splitKeypath(keypath)).get();\n}\n","import { isFunction } from 'utils/is';\n\nexport default function use(...plugins) {\n  plugins.forEach(p => {\n    isFunction(p) &&\n      p({\n        proto: this.prototype,\n        Ractive: this.Ractive,\n        instance: this\n      });\n  });\n  return this;\n}\n","import styleGet from '../Ractive/static/styleGet';\nimport styleSet from '../Ractive/static/styleSet';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperties, defineProperty } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nimport { initCSS } from 'src/Ractive/config/custom/css/css';\n\nexport default function macro(fn, opts) {\n  if (!isFunction(fn)) throw new Error(`The macro must be a function`);\n\n  assign(fn, opts);\n\n  defineProperties(fn, {\n    extensions: { value: [] },\n    _cssIds: { value: [] },\n    cssData: { value: assign(create(this.cssData), fn.cssData || {}) },\n\n    styleGet: { value: styleGet.bind(fn) },\n    styleSet: { value: styleSet.bind(fn) }\n  });\n\n  defineProperty(fn, '_cssModel', { value: new CSSModel(fn) });\n\n  if (fn.css) initCSS(fn, fn, fn);\n\n  this.extensions.push(fn);\n\n  return fn;\n}\n","import { escapeKey, splitKeypath as splitKeypathI, unescapeKey } from 'shared/keypaths';\n\nexport function joinKeys(...keys) {\n  return keys.map(escapeKey).join('.');\n}\n\nexport function splitKeypath(keypath) {\n  return splitKeypathI(keypath).map(unescapeKey);\n}\n","import { findInViewHierarchy } from 'shared/registry';\n\nexport function findPlugin(name, type, instance) {\n  return findInViewHierarchy(type, instance, name);\n}\n","/* istanbul ignore if */\nif (!Object.assign) {\n  Object.assign = function(target, ...sources) {\n    if (target == null) throw new TypeError('Cannot convert undefined or null to object');\n\n    const to = Object(target);\n    const sourcesLength = sources.length;\n\n    for (let index = 0; index < sourcesLength; index++) {\n      const nextSource = sources[index];\n      for (const nextKey in nextSource) {\n        if (!Object.prototype.hasOwnProperty.call(nextSource, nextKey)) continue;\n        to[nextKey] = nextSource[nextKey];\n      }\n    }\n\n    return to;\n  };\n}\n","export function hasOwn(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function fillGaps(target, ...sources) {\n  for (let i = 0; i < sources.length; i++) {\n    const source = sources[i];\n    for (const key in source) {\n      // Source can be a prototype-less object.\n      if (key in target || !hasOwn(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nexport function toPairs(obj = {}) {\n  const pairs = [];\n  for (const key in obj) {\n    // Source can be a prototype-less object.\n    if (!hasOwn(obj, key)) continue;\n    pairs.push([key, obj[key]]);\n  }\n  return pairs;\n}\n\nconst obj = Object;\n\nexport const assign = obj.assign;\n\nexport const create = obj.create;\n\nexport const defineProperty = obj.defineProperty;\n\nexport const defineProperties = obj.defineProperties;\n\nexport const keys = obj.keys;\n","const toString = Object.prototype.toString;\nconst arrayLikePattern = /^\\[object (?:Array|FileList)\\]$/;\n\nexport function isArrayLike(obj) {\n  return arrayLikePattern.test(toString.call(obj));\n}\n\nexport const isArray = Array.isArray;\n\nexport function isEqual(a, b) {\n  if (a === null && b === null) {\n    return true;\n  }\n\n  if (isObjectType(a) || isObjectType(b)) {\n    return false;\n  }\n\n  return a === b;\n}\n\n// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\nexport function isNumeric(thing) {\n  return !isNaN(parseFloat(thing)) && isFinite(thing);\n}\n\nexport function isObject(thing) {\n  return thing && toString.call(thing) === '[object Object]';\n}\n\nexport function isObjectLike(thing) {\n  return !!(thing && (isObjectType(thing) || isFunction(thing)));\n}\n\nexport function isObjectType(thing) {\n  return typeof thing === 'object';\n}\n\nexport function isFunction(thing) {\n  return typeof thing === 'function';\n}\n\nexport function isString(thing) {\n  return typeof thing === 'string';\n}\n\nexport function isNumber(thing) {\n  return typeof thing === 'number';\n}\n","/* istanbul ignore if */\nif (typeof window !== 'undefined' && window.performance && !window.performance.now) {\n  window.performance = window.performance || {};\n\n  const nowOffset = Date.now();\n\n  window.performance.now = function() {\n    return Date.now() - nowOffset;\n  };\n}\n","import { hasOwn, defineProperty } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\n/* istanbul ignore if */\nif (!Array.prototype.find) {\n  defineProperty(Array.prototype, 'find', {\n    value(callback, thisArg) {\n      if (this === null || this === undefined)\n        throw new TypeError('Array.prototype.find called on null or undefined');\n\n      if (!isFunction(callback)) throw new TypeError(`${callback} is not a function`);\n\n      const array = Object(this);\n      const arrayLength = array.length >>> 0;\n\n      for (let index = 0; index < arrayLength; index++) {\n        if (!hasOwn(array, index)) continue;\n        if (!callback.call(thisArg, array[index], index, array)) continue;\n        return array[index];\n      }\n\n      return undefined;\n    },\n    configurable: true,\n    writable: true\n  });\n}\n","// NOTE: Node doesn't exist in IE8. Nothing can be done.\n/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  window.Node &&\n  window.Node.prototype &&\n  !window.Node.prototype.contains\n) {\n  Node.prototype.contains = function(node) {\n    if (!node) throw new TypeError('node required');\n\n    do {\n      if (this === node) return true;\n    } while ((node = node && node.parentNode));\n\n    return false;\n  };\n}\n","import { isFunction, isObjectType } from 'utils/is';\n\n/* istanbul ignore if */\nif (typeof window !== 'undefined' && !window.Promise) {\n  const PENDING = {};\n  const FULFILLED = {};\n  const REJECTED = {};\n\n  const Promise = (window.Promise = function(callback) {\n    const fulfilledHandlers = [];\n    const rejectedHandlers = [];\n    let state = PENDING;\n    let result;\n    let dispatchHandlers;\n\n    const makeResolver = newState => {\n      return function(value) {\n        if (state !== PENDING) return;\n        result = value;\n        state = newState;\n        dispatchHandlers = makeDispatcher(\n          state === FULFILLED ? fulfilledHandlers : rejectedHandlers,\n          result\n        );\n        wait(dispatchHandlers);\n      };\n    };\n\n    const fulfill = makeResolver(FULFILLED);\n    const reject = makeResolver(REJECTED);\n\n    try {\n      callback(fulfill, reject);\n    } catch (err) {\n      reject(err);\n    }\n\n    return {\n      // `then()` returns a Promise - 2.2.7\n      then(onFulfilled, onRejected) {\n        const promise2 = new Promise((fulfill, reject) => {\n          const processResolutionHandler = (handler, handlers, forward) => {\n            if (isFunction(handler)) {\n              handlers.push(p1result => {\n                try {\n                  resolve(promise2, handler(p1result), fulfill, reject);\n                } catch (err) {\n                  reject(err);\n                }\n              });\n            } else {\n              handlers.push(forward);\n            }\n          };\n\n          processResolutionHandler(onFulfilled, fulfilledHandlers, fulfill);\n          processResolutionHandler(onRejected, rejectedHandlers, reject);\n\n          if (state !== PENDING) {\n            wait(dispatchHandlers);\n          }\n        });\n        return promise2;\n      },\n      catch(onRejected) {\n        return this.then(null, onRejected);\n      }\n    };\n  });\n\n  Promise.all = function(promises) {\n    return new Promise((fulfil, reject) => {\n      const result = [];\n      let pending;\n      let i;\n\n      if (!promises.length) {\n        fulfil(result);\n        return;\n      }\n\n      const processPromise = (promise, i) => {\n        if (promise && isFunction(promise.then)) {\n          promise.then(value => {\n            result[i] = value;\n            --pending || fulfil(result);\n          }, reject);\n        } else {\n          result[i] = promise;\n          --pending || fulfil(result);\n        }\n      };\n\n      pending = i = promises.length;\n\n      while (i--) {\n        processPromise(promises[i], i);\n      }\n    });\n  };\n\n  Promise.resolve = function(value) {\n    return new Promise(fulfill => {\n      fulfill(value);\n    });\n  };\n\n  Promise.reject = function(reason) {\n    return new Promise((fulfill, reject) => {\n      reject(reason);\n    });\n  };\n\n  // TODO use MutationObservers or something to simulate setImmediate\n  const wait = function(callback) {\n    setTimeout(callback, 0);\n  };\n\n  const makeDispatcher = function(handlers, result) {\n    return function() {\n      for (let handler; (handler = handlers.shift()); ) {\n        handler(result);\n      }\n    };\n  };\n\n  const resolve = function(promise, x, fulfil, reject) {\n    let then;\n    if (x === promise) {\n      throw new TypeError(`A promise's fulfillment handler cannot return the same promise`);\n    }\n    if (x instanceof Promise) {\n      x.then(fulfil, reject);\n    } else if (x && (isObjectType(x) || isFunction(x))) {\n      try {\n        then = x.then;\n      } catch (e) {\n        reject(e);\n        return;\n      }\n      if (isFunction(then)) {\n        let called;\n\n        const resolvePromise = function(y) {\n          if (called) return;\n          called = true;\n          resolve(promise, y, fulfil, reject);\n        };\n        const rejectPromise = function(r) {\n          if (called) return;\n          called = true;\n          reject(r);\n        };\n\n        try {\n          then.call(x, resolvePromise, rejectPromise);\n        } catch (e) {\n          if (!called) {\n            reject(e);\n            called = true;\n            return;\n          }\n        }\n      } else {\n        fulfil(x);\n      }\n    } else {\n      fulfil(x);\n    }\n  };\n}\n","/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  !(window.requestAnimationFrame && window.cancelAnimationFrame)\n) {\n  let lastTime = 0;\n  window.requestAnimationFrame = function(callback) {\n    const currentTime = Date.now();\n    const timeToNextCall = Math.max(0, 16 - (currentTime - lastTime));\n    const id = window.setTimeout(() => {\n      callback(currentTime + timeToNextCall);\n    }, timeToNextCall);\n    lastTime = currentTime + timeToNextCall;\n    return id;\n  };\n  window.cancelAnimationFrame = function(id) {\n    clearTimeout(id);\n  };\n}\n","import { create } from 'utils/object';\n\nexport default {\n  // render placement:\n  el: void 0,\n  append: false,\n  delegate: true,\n  enhance: false,\n\n  // template:\n  template: null,\n\n  // parse:\n  allowExpressions: true,\n  delimiters: ['{{', '}}'],\n  tripleDelimiters: ['{{{', '}}}'],\n  staticDelimiters: ['[[', ']]'],\n  staticTripleDelimiters: ['[[[', ']]]'],\n  csp: true,\n  interpolate: false,\n  preserveWhitespace: false,\n  sanitize: false,\n  stripComments: true,\n  contextLines: 0,\n\n  // data & binding:\n  data: create(null),\n  helpers: create(null),\n  computed: create(null),\n  syncComputedChildren: false,\n  resolveInstanceMembers: false,\n  warnAboutAmbiguity: false,\n  adapt: [],\n  isolated: true,\n  twoway: true,\n  lazy: false,\n\n  // transitions:\n  noIntro: false,\n  noOutro: false,\n  transitionsEnabled: true,\n  complete: void 0,\n  nestedTransitions: true,\n\n  // css:\n  css: null,\n  noCssTransform: false\n};\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { hasConsole } from '../config/environment';\nimport Ractive from '../Ractive';\nimport noop from './noop';\nimport { isObjectType } from 'utils/is';\n\nconst alreadyWarned = {};\nlet log, printWarning, welcome;\n\nif (hasConsole) {\n  const welcomeIntro = [\n    `%cRactive.js %cBUILD_PLACEHOLDER_VERSION %cin debug mode, %cmore...`,\n    'color: rgb(114, 157, 52); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n  ];\n  const welcomeMessage = `You're running Ractive BUILD_PLACEHOLDER_VERSION in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://ractive.js.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n`;\n\n  welcome = () => {\n    if (Ractive.WELCOME_MESSAGE === false) {\n      welcome = noop;\n      return;\n    }\n    const message = 'WELCOME_MESSAGE' in Ractive ? Ractive.WELCOME_MESSAGE : welcomeMessage;\n    const hasGroup = !!console.groupCollapsed;\n    if (hasGroup) console.groupCollapsed.apply(console, welcomeIntro);\n    console.log(message);\n    if (hasGroup) {\n      console.groupEnd(welcomeIntro);\n    }\n\n    welcome = noop;\n  };\n\n  printWarning = (message, args) => {\n    welcome();\n\n    // extract information about the instance this message pertains to, if applicable\n    if (isObjectType(args[args.length - 1])) {\n      const options = args.pop();\n      const ractive = options ? options.ractive : null;\n\n      if (ractive) {\n        // if this is an instance of a component that we know the name of, add\n        // it to the message\n        let name;\n        if (ractive.component && (name = ractive.component.name)) {\n          message = `<${name}> ${message}`;\n        }\n\n        let node;\n        if (\n          (node =\n            options.node || (ractive.fragment && ractive.fragment.rendered && ractive.find('*')))\n        ) {\n          args.push(node);\n        }\n      }\n    }\n\n    console.warn.apply(\n      console,\n      ['%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);'].concat(\n        args\n      )\n    );\n  };\n\n  log = function() {\n    console.log.apply(console, arguments);\n  };\n} else {\n  printWarning = log = welcome = noop;\n}\n\nfunction format(message, args) {\n  return message.replace(/%s/g, () => args.shift());\n}\n\nfunction fatal(message, ...args) {\n  message = format(message, args);\n  throw new Error(message);\n}\n\nfunction logIfDebug() {\n  if (Ractive.DEBUG) {\n    log.apply(null, arguments);\n  }\n}\n\nfunction warn(message, ...args) {\n  message = format(message, args);\n  printWarning(message, args);\n}\n\nfunction warnOnce(message, ...args) {\n  message = format(message, args);\n\n  if (alreadyWarned[message]) {\n    return;\n  }\n\n  alreadyWarned[message] = true;\n  printWarning(message, args);\n}\n\nfunction warnIfDebug() {\n  if (Ractive.DEBUG) {\n    warn.apply(null, arguments);\n  }\n}\n\nfunction warnOnceIfDebug() {\n  if (Ractive.DEBUG) {\n    warnOnce.apply(null, arguments);\n  }\n}\n\nexport { fatal, log, logIfDebug, warn, warnOnce, warnIfDebug, warnOnceIfDebug, welcome };\n","// These are a subset of the easing equations found at\n// https://raw.github.com/danro/easing-js - license info\n// follows:\n\n// --------------------------------------------------\n// easing.js v0.5.4\n// Generic set of easing functions with AMD support\n// https://github.com/danro/easing-js\n// This code may be freely distributed under the MIT license\n// http://danro.mit-license.org/\n// --------------------------------------------------\n// All functions adapted from Thomas Fuchs & Jeremy Kahn\n// Easing Equations (c) 2003 Robert Penner, BSD license\n// https://raw.github.com/danro/easing-js/master/LICENSE\n// --------------------------------------------------\n\n// In that library, the functions named easeIn, easeOut, and\n// easeInOut below are named easeInCubic, easeOutCubic, and\n// (you guessed it) easeInOutCubic.\n//\n// You can add additional easing functions to this list, and they\n// will be globally available.\n\nexport default {\n  linear(pos) {\n    return pos;\n  },\n  easeIn(pos) {\n    /* istanbul ignore next */\n    return Math.pow(pos, 3);\n  },\n  easeOut(pos) {\n    return Math.pow(pos - 1, 3) + 1;\n  },\n  easeInOut(pos) {\n    /* istanbul ignore next */\n    if ((pos /= 0.5) < 1) {\n      return 0.5 * Math.pow(pos, 3);\n    }\n    /* istanbul ignore next */\n    return 0.5 * (Math.pow(pos - 2, 3) + 2);\n  }\n};\n","/* eslint no-console:\"off\" */\nimport { isFunction } from 'utils/is';\n\nconst win = typeof window !== 'undefined' ? window : null;\nconst doc = win ? document : null;\nconst isClient = !!doc;\nconst hasConsole =\n  typeof console !== 'undefined' && isFunction(console.warn) && isFunction(console.warn.apply);\n\nconst svg = doc\n  ? doc.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1')\n  : false;\n\nconst vendors = ['o', 'ms', 'moz', 'webkit'];\n\nexport { win, doc, isClient, hasConsole, svg, vendors };\n","// Error messages that are used (or could be) in multiple places\nexport const badArguments = 'Bad arguments';\nexport const noRegistryFunctionReturn =\n  'A function was specified for \"%s\" %s, but no %s was returned';\nexport const missingPlugin = (name, type) =>\n  `Missing \"${name}\" ${type} plugin. You may need to download a plugin via http://ractive.js.org/integrations/#${type}s`;\n","import { isArray, isObject, isNumeric } from 'utils/is';\nimport interpolate from 'shared/interpolate';\nimport { hasOwn } from 'utils/object';\n\nconst interpolators = {\n  number(from, to) {\n    if (!isNumeric(from) || !isNumeric(to)) {\n      return null;\n    }\n\n    from = +from;\n    to = +to;\n\n    const delta = to - from;\n\n    if (!delta) {\n      return function() {\n        return from;\n      };\n    }\n\n    return function(t) {\n      return from + t * delta;\n    };\n  },\n\n  array(from, to) {\n    let len, i;\n\n    if (!isArray(from) || !isArray(to)) {\n      return null;\n    }\n\n    const intermediate = [];\n    const interpolators = [];\n\n    i = len = Math.min(from.length, to.length);\n    while (i--) {\n      interpolators[i] = interpolate(from[i], to[i]);\n    }\n\n    // surplus values - don't interpolate, but don't exclude them either\n    for (i = len; i < from.length; i += 1) {\n      intermediate[i] = from[i];\n    }\n\n    for (i = len; i < to.length; i += 1) {\n      intermediate[i] = to[i];\n    }\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        intermediate[i] = interpolators[i](t);\n      }\n\n      return intermediate;\n    };\n  },\n\n  object(from, to) {\n    if (!isObject(from) || !isObject(to)) {\n      return null;\n    }\n\n    const properties = [];\n    const intermediate = {};\n    const interpolators = {};\n\n    for (const prop in from) {\n      if (hasOwn(from, prop)) {\n        if (hasOwn(to, prop)) {\n          properties.push(prop);\n          interpolators[prop] = interpolate(from[prop], to[prop]) || (() => to[prop]);\n        } else {\n          intermediate[prop] = from[prop];\n        }\n      }\n    }\n\n    for (const prop in to) {\n      if (hasOwn(to, prop) && !hasOwn(from, prop)) {\n        intermediate[prop] = to[prop];\n      }\n    }\n\n    const len = properties.length;\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        const prop = properties[i];\n\n        intermediate[prop] = interpolators[prop](t);\n      }\n\n      return intermediate;\n    };\n  }\n};\n\nexport default interpolators;\n","import { isString } from 'utils/is';\n\nconst refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\nconst splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\nconst escapeKeyPattern = /\\\\|\\./g;\nconst unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\n\nexport function escapeKey(key) {\n  if (isString(key)) {\n    return key.replace(escapeKeyPattern, '\\\\$&');\n  }\n\n  return key;\n}\n\nexport function normalise(ref) {\n  return ref ? ref.replace(refPattern, '.$1') : '';\n}\n\nexport function splitKeypath(keypath) {\n  const result = [];\n  let match;\n\n  keypath = normalise(keypath);\n\n  while ((match = splitPattern.exec(keypath))) {\n    const index = match.index + match[1].length;\n    result.push(keypath.substr(0, index));\n    keypath = keypath.substr(index + 1);\n  }\n\n  result.push(keypath);\n\n  return result;\n}\n\nexport function unescapeKey(key) {\n  if (isString(key)) {\n    return key.replace(unescapeKeyPattern, '$1$2');\n  }\n\n  return key;\n}\n","const fnBind = Function.prototype.bind;\n\nexport default function bind(fn, context) {\n  if (!/this/.test(fn.toString())) return fn;\n\n  const bound = fnBind.call(fn, context);\n  for (const prop in fn) bound[prop] = fn[prop];\n\n  return bound;\n}\n","import { escapeKey, unescapeKey } from 'shared/keypaths';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isFunction } from 'utils/is';\nimport bind from 'utils/bind';\nimport { create, keys as objectKeys } from 'utils/object';\n\nconst shuffleTasks = { early: [], mark: [] };\nconst registerQueue = { early: [], mark: [] };\nexport const noVirtual = { virtual: false };\n\nexport default class ModelBase {\n  constructor(parent) {\n    this.deps = [];\n\n    this.children = [];\n    this.childByKey = {};\n    this.links = [];\n\n    this.bindings = [];\n\n    if (parent) {\n      this.parent = parent;\n      this.root = parent.root;\n    }\n  }\n\n  addShuffleTask(task, stage = 'early') {\n    shuffleTasks[stage].push(task);\n  }\n  addShuffleRegister(item, stage = 'early') {\n    registerQueue[stage].push({ model: this, item });\n  }\n\n  downstreamChanged() {}\n\n  findMatches(keys) {\n    const len = keys.length;\n\n    let existingMatches = [this];\n    let matches;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const key = keys[i];\n\n      if (key === '*') {\n        matches = [];\n        existingMatches.forEach(model => {\n          matches.push.apply(matches, model.getValueChildren(model.get()));\n        });\n      } else {\n        matches = existingMatches.map(model => model.joinKey(key));\n      }\n\n      existingMatches = matches;\n    }\n\n    return matches;\n  }\n\n  getKeypath(ractive) {\n    if (ractive !== this.ractive && this._link) return this._link.target.getKeypath(ractive);\n\n    if (!this.keypath) {\n      const parent = this.parent && this.parent.getKeypath(ractive);\n      this.keypath = parent\n        ? `${this.parent.getKeypath(ractive)}.${escapeKey(this.key)}`\n        : escapeKey(this.key);\n    }\n\n    return this.keypath;\n  }\n\n  getValueChildren(value) {\n    let children;\n    if (isArray(value)) {\n      children = [];\n      if ('length' in this && this.length !== value.length) {\n        children.push(this.joinKey('length'));\n      }\n      value.forEach((m, i) => {\n        children.push(this.joinKey(i));\n      });\n    } else if (isObject(value) || isFunction(value)) {\n      children = objectKeys(value).map(key => this.joinKey(key));\n    } else if (value != null) {\n      children = [];\n    }\n\n    const computed = this.computed;\n    if (computed) {\n      children.push.apply(children, objectKeys(computed).map(k => this.joinKey(k)));\n    }\n\n    return children;\n  }\n\n  getVirtual(shouldCapture) {\n    const value = this.get(shouldCapture, { virtual: false });\n    if (isObject(value)) {\n      const result = isArray(value) ? [] : create(null);\n\n      let keys = objectKeys(value);\n      let i = keys.length;\n      while (i--) {\n        const child = this.childByKey[keys[i]];\n        if (!child) result[keys[i]] = value[keys[i]];\n        else if (child._link) result[keys[i]] = child._link.getVirtual();\n        else result[keys[i]] = child.getVirtual();\n      }\n\n      i = this.children.length;\n      while (i--) {\n        const child = this.children[i];\n        if (!(child.key in result) && child._link) {\n          result[child.key] = child._link.getVirtual();\n        }\n      }\n\n      if (this.computed) {\n        keys = objectKeys(this.computed);\n        i = keys.length;\n        while (i--) {\n          result[keys[i]] = this.computed[keys[i]].get();\n        }\n      }\n\n      return result;\n    } else return value;\n  }\n\n  has(key) {\n    if (this._link) return this._link.has(key);\n\n    const value = this.get(false, noVirtual);\n    if (!value) return false;\n\n    key = unescapeKey(key);\n    if ((isFunction(value) || isObject(value)) && key in value) return true;\n\n    let computed = this.computed;\n    if (computed && key in this.computed) return true;\n\n    computed = this.root.ractive && this.root.ractive.computed;\n    if (computed) {\n      objectKeys(computed).forEach(k => {\n        if (computed[k].pattern && computed[k].pattern.test(this.getKeypath())) return true;\n      });\n    }\n\n    return false;\n  }\n\n  joinAll(keys, opts) {\n    let model = this;\n    for (let i = 0; i < keys.length; i += 1) {\n      if (\n        opts &&\n        opts.lastLink === false &&\n        i + 1 === keys.length &&\n        model.childByKey[keys[i]] &&\n        model.childByKey[keys[i]]._link\n      )\n        return model.childByKey[keys[i]];\n      model = model.joinKey(keys[i], opts);\n    }\n\n    return model;\n  }\n\n  notifyUpstream(startPath) {\n    let parent = this.parent;\n    const path = startPath || [this.key];\n    while (parent) {\n      if (parent.patterns) parent.patterns.forEach(o => o.notify(path.slice()));\n      path.unshift(parent.key);\n      parent.links.forEach(l => l.notifiedUpstream(path, this.root));\n      parent.deps.forEach(d => d.handleChange(path));\n      parent.downstreamChanged(startPath);\n      parent = parent.parent;\n    }\n  }\n\n  rebind(next, previous, safe) {\n    if (this._link) {\n      this._link.rebind(next, previous, false);\n    }\n\n    // tell the deps to move to the new target\n    let i = this.deps.length;\n    while (i--) {\n      if (this.deps[i].rebind) this.deps[i].rebind(next, previous, safe);\n    }\n\n    i = this.links.length;\n    while (i--) {\n      const link = this.links[i];\n      // only relink the root of the link tree\n      if (link.owner && link.owner._link) link.relinking(next, safe);\n    }\n\n    i = this.children.length;\n    while (i--) {\n      const child = this.children[i];\n      child.rebind(next ? next.joinKey(child.key) : undefined, child, safe);\n    }\n\n    i = this.bindings.length;\n    while (i--) {\n      this.bindings[i].rebind(next, previous, safe);\n    }\n  }\n\n  reference() {\n    'refs' in this ? this.refs++ : (this.refs = 1);\n  }\n\n  register(dep) {\n    this.deps.push(dep);\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  registerPatternObserver(observer) {\n    (this.patterns || (this.patterns = [])).push(observer);\n    this.register(observer);\n  }\n\n  registerTwowayBinding(binding) {\n    this.bindings.push(binding);\n  }\n\n  unreference() {\n    if ('refs' in this) this.refs--;\n  }\n\n  unregister(dep) {\n    removeFromArray(this.deps, dep);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n\n  unregisterPatternObserver(observer) {\n    removeFromArray(this.patterns, observer);\n    this.unregister(observer);\n  }\n\n  unregisterTwowayBinding(binding) {\n    removeFromArray(this.bindings, binding);\n  }\n\n  updateFromBindings(cascade) {\n    let i = this.bindings.length;\n    while (i--) {\n      const value = this.bindings[i].getValue();\n      if (value !== this.value) this.set(value);\n    }\n\n    // check for one-way bindings if there are no two-ways\n    if (!this.bindings.length) {\n      const oneway = findBoundValue(this.deps);\n      if (oneway && oneway.value !== this.value) this.set(oneway.value);\n    }\n\n    if (cascade) {\n      this.children.forEach(updateFromBindings);\n      this.links.forEach(updateFromBindings);\n      if (this._link) this._link.updateFromBindings(cascade);\n    }\n  }\n}\n\n// TODO: this may be better handled by overreiding `get` on models with a parent that isRoot\nexport function maybeBind(model, value, shouldBind) {\n  if (shouldBind && isFunction(value) && model.parent && model.parent.isRoot) {\n    if (!model.boundValue) {\n      model.boundValue = bind(value._r_unbound || value, model.parent.ractive);\n    }\n\n    return model.boundValue;\n  }\n\n  return value;\n}\n\nfunction updateFromBindings(model) {\n  model.updateFromBindings(true);\n}\n\nexport function findBoundValue(list) {\n  let i = list.length;\n  while (i--) {\n    if (list[i].bound) {\n      const owner = list[i].owner;\n      if (owner) {\n        const value = owner.name === 'checked' ? owner.node.checked : owner.node.value;\n        return { value };\n      }\n    }\n  }\n}\n\nexport function fireShuffleTasks(stage) {\n  if (!stage) {\n    fireShuffleTasks('early');\n    fireShuffleTasks('mark');\n  } else {\n    const tasks = shuffleTasks[stage];\n    shuffleTasks[stage] = [];\n    let i = tasks.length;\n    while (i--) tasks[i]();\n\n    const register = registerQueue[stage];\n    registerQueue[stage] = [];\n    i = register.length;\n    while (i--) register[i].model.register(register[i].item);\n  }\n}\n\nexport function shuffle(model, newIndices, link, unsafe) {\n  model.shuffling = true;\n\n  let i = newIndices.length;\n  while (i--) {\n    const idx = newIndices[i];\n    // nothing is actually changing, so move in the index and roll on\n    if (i === idx) {\n      continue;\n    }\n\n    // rebind the children on i to idx\n    if (i in model.childByKey)\n      model.childByKey[i].rebind(\n        !~idx ? undefined : model.joinKey(idx),\n        model.childByKey[i],\n        !unsafe\n      );\n  }\n\n  const upstream = model.source().length !== model.source().value.length;\n\n  model.links.forEach(l => l.shuffle(newIndices));\n  if (!link) fireShuffleTasks('early');\n\n  i = model.deps.length;\n  while (i--) {\n    if (model.deps[i].shuffle) model.deps[i].shuffle(newIndices);\n  }\n\n  model[link ? 'marked' : 'mark']();\n  if (!link) fireShuffleTasks('mark');\n\n  if (upstream) model.notifyUpstream();\n\n  model.shuffling = false;\n}\n","const stack = [];\nlet captureGroup;\n\nexport function startCapturing() {\n  stack.push((captureGroup = []));\n}\n\nexport function stopCapturing() {\n  const dependencies = stack.pop();\n  captureGroup = stack[stack.length - 1];\n  return dependencies;\n}\n\nexport function capture(model) {\n  if (captureGroup) {\n    captureGroup.push(model);\n  }\n}\n","import ModelBase, { fireShuffleTasks, maybeBind, shuffle } from './ModelBase';\nimport { capture } from '../global/capture';\nimport { handleChange, marked, markedAll, teardown } from 'shared/methodCallers';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\nimport { hasOwn } from 'utils/object';\n\n// temporary placeholder target for detached implicit links\nexport const Missing = {\n  key: '@missing',\n  animate: noop,\n  applyValue: noop,\n  get: noop,\n  getKeypath() {\n    return this.key;\n  },\n  joinAll() {\n    return this;\n  },\n  joinKey() {\n    return this;\n  },\n  mark: noop,\n  registerLink: noop,\n  shufle: noop,\n  set: noop,\n  unregisterLink: noop\n};\nMissing.parent = Missing;\n\nexport default class LinkModel extends ModelBase {\n  constructor(parent, owner, target, key) {\n    super(parent);\n\n    this.owner = owner;\n    this.target = target;\n    this.key = key === undefined ? owner.key : key;\n    if (owner && owner.isLink) this.sourcePath = `${owner.sourcePath}.${this.key}`;\n\n    if (target) target.registerLink(this);\n\n    if (parent) this.isReadonly = parent.isReadonly;\n\n    this.isLink = true;\n  }\n\n  animate(from, to, options, interpolator) {\n    return this.target.animate(from, to, options, interpolator);\n  }\n\n  applyValue(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.applyValue(value);\n  }\n\n  attach(fragment) {\n    const model = resolveReference(fragment, this.key);\n    if (model) {\n      this.relinking(model, false);\n    } else {\n      // if there is no link available, move everything here to real models\n      this.owner.unlink();\n    }\n  }\n\n  detach() {\n    this.relinking(Missing, false);\n  }\n\n  get(shouldCapture, opts = {}) {\n    if (shouldCapture) {\n      capture(this);\n\n      // may need to tell the target to unwrap\n      opts.unwrap = 'unwrap' in opts ? opts.unwrap : true;\n    }\n\n    const bind = 'shouldBind' in opts ? opts.shouldBind : true;\n    opts.shouldBind = this.mapping && this.target.parent && this.target.parent.isRoot;\n\n    return maybeBind(this, this.target.get(false, opts), bind);\n  }\n\n  getKeypath(ractive) {\n    if (ractive && ractive !== this.root.ractive) return this.target.getKeypath(ractive);\n\n    return super.getKeypath(ractive);\n  }\n\n  handleChange() {\n    this.deps.forEach(handleChange);\n    this.links.forEach(handleChange);\n    this.notifyUpstream();\n  }\n\n  isDetached() {\n    return this.virtual && this.target === Missing;\n  }\n\n  joinKey(key) {\n    // TODO: handle nested links\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new LinkModel(this, this, this.target.joinKey(key), key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n\n  mark(force) {\n    this.target.mark(force);\n  }\n\n  marked() {\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n\n    this.deps.forEach(handleChange);\n  }\n\n  markedAll() {\n    this.children.forEach(markedAll);\n    this.marked();\n  }\n\n  notifiedUpstream(startPath, root) {\n    this.links.forEach(l => l.notifiedUpstream(startPath, this.root));\n    this.deps.forEach(handleChange);\n    if (startPath && this.rootLink && this.root !== root) {\n      const path = startPath.slice(1);\n      path.unshift(this.key);\n      this.notifyUpstream(path);\n    }\n  }\n\n  relinked() {\n    this.target.registerLink(this);\n    this.children.forEach(c => c.relinked());\n  }\n\n  relinking(target, safe) {\n    if (this.rootLink && this.sourcePath)\n      target = rebindMatch(this.sourcePath, target, this.target);\n    if (!target || this.target === target) return;\n\n    this.target && this.target.unregisterLink(this);\n\n    this.target = target;\n    this.children.forEach(c => {\n      c.relinking(target.joinKey(c.key), safe);\n    });\n\n    if (this.rootLink)\n      this.addShuffleTask(() => {\n        this.relinked();\n        if (!safe) {\n          this.markedAll();\n          this.notifyUpstream();\n        }\n      });\n  }\n\n  set(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.set(value);\n  }\n\n  shuffle(newIndices) {\n    // watch for extra shuffles caused by a shuffle in a downstream link\n    if (this.shuffling) return;\n\n    // let the real model handle firing off shuffles\n    if (!this.target.shuffling) {\n      if (this.target.shuffle) {\n        this.target.shuffle(newIndices);\n      } else {\n        // the target is a computation, which can't shuffle\n        this.target.mark();\n      }\n    } else {\n      shuffle(this, newIndices, true);\n    }\n  }\n\n  source() {\n    if (this.target.source) return this.target.source();\n    else return this.target;\n  }\n\n  teardown() {\n    if (this._link) this._link.teardown();\n    this.target.unregisterLink(this);\n    this.children.forEach(teardown);\n  }\n}\n\nModelBase.prototype.link = function link(model, keypath, options) {\n  const lnk = this._link || new LinkModel(this.parent, this, model, this.key);\n  lnk.implicit = options && options.implicit;\n  lnk.mapping = options && options.mapping;\n  lnk.sourcePath = keypath;\n  lnk.rootLink = true;\n  if (this._link) this._link.relinking(model, false);\n  this.rebind(lnk, this, false);\n  fireShuffleTasks();\n\n  this._link = lnk;\n  lnk.markedAll();\n\n  this.notifyUpstream();\n  return lnk;\n};\n\nModelBase.prototype.unlink = function unlink() {\n  if (this._link) {\n    const ln = this._link;\n    this._link = undefined;\n    ln.rebind(this, ln, false);\n    fireShuffleTasks();\n    ln.teardown();\n    this.notifyUpstream();\n  }\n};\n","import { createFunction } from '../Ractive/config/runtime-parser';\nimport { create, keys } from 'utils/object';\n\nconst functions = create(null);\n\nexport default function getFunction(str, i) {\n  if (functions[str]) return functions[str];\n  return (functions[str] = createFunction(str, i));\n}\n\nexport function addFunctions(template) {\n  if (!template) return;\n\n  const exp = template.e;\n\n  if (!exp) return;\n\n  keys(exp).forEach(str => {\n    if (functions[str]) return;\n    functions[str] = exp[str];\n  });\n}\n","import { TEMPLATE_VERSION } from 'config/template';\nimport Parser from './Parser';\nimport readMustache from './converters/readMustache';\nimport readTriple from './converters/mustache/readTriple';\nimport readUnescaped from './converters/mustache/readUnescaped';\nimport readPartial from './converters/mustache/readPartial';\nimport readMustacheComment from './converters/mustache/readMustacheComment';\nimport readInterpolator from './converters/mustache/readInterpolator';\nimport readSection from './converters/mustache/readSection';\nimport readHtmlComment from './converters/readHtmlComment';\nimport readElement from './converters/readElement';\nimport readText from './converters/readText';\nimport readPartialDefinitionSection from './converters/readPartialDefinitionSection';\nimport readTemplate from './converters/readTemplate';\nimport readExpression from './converters/readExpression';\nimport { fromExpression } from './utils/createFunction';\nimport cleanup from './utils/cleanup';\nimport insertExpressions from './utils/insertExpressions';\nimport flattenExpression from './utils/flattenExpression';\nimport shared from '../Ractive/shared';\nimport { assign, keys } from 'utils/object';\nimport { isObjectType } from 'utils/is';\n\n// See https://github.com/ractivejs/template-spec for information\n// about the Ractive template specification\n\nconst STANDARD_READERS = [\n  readPartial,\n  readUnescaped,\n  readSection,\n  readInterpolator,\n  readMustacheComment\n];\nconst TRIPLE_READERS = [readTriple];\n\nexport const READERS = [readMustache, readHtmlComment, readElement, readText];\nexport const PARTIAL_READERS = [readPartialDefinitionSection];\n\nconst preserveWhitespaceElements = { pre: 1, script: 1, style: 1, textarea: 1 };\n\nconst defaultInterpolate = { textarea: true, script: true, style: true, template: true };\n\nconst StandardParser = Parser.extend({\n  init(str, options) {\n    const tripleDelimiters = options.tripleDelimiters || shared.defaults.tripleDelimiters;\n    const staticDelimiters = options.staticDelimiters || shared.defaults.staticDelimiters;\n    const staticTripleDelimiters =\n      options.staticTripleDelimiters || shared.defaults.staticTripleDelimiters;\n\n    this.standardDelimiters = options.delimiters || shared.defaults.delimiters;\n\n    this.tags = [\n      {\n        isStatic: false,\n        isTriple: false,\n        open: this.standardDelimiters[0],\n        close: this.standardDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: false,\n        isTriple: true,\n        open: tripleDelimiters[0],\n        close: tripleDelimiters[1],\n        readers: TRIPLE_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: false,\n        open: staticDelimiters[0],\n        close: staticDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: true,\n        open: staticTripleDelimiters[0],\n        close: staticTripleDelimiters[1],\n        readers: TRIPLE_READERS\n      }\n    ];\n\n    this.contextLines = options.contextLines || shared.defaults.contextLines;\n\n    this.sortMustacheTags();\n\n    this.sectionDepth = 0;\n    this.elementStack = [];\n\n    this.interpolate = assign(\n      {},\n      defaultInterpolate,\n      shared.defaults.interpolate,\n      options.interpolate\n    );\n\n    if (options.sanitize === true) {\n      options.sanitize = {\n        // blacklist from https://code.google.com/p/google-caja/source/browse/trunk/src/com/google/caja/lang/html/html4-elements-whitelist.json\n        elements: 'applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title'.split(\n          ' '\n        ),\n        eventAttributes: true\n      };\n    }\n\n    this.stripComments = options.stripComments !== false;\n    this.preserveWhitespace = isObjectType(options.preserveWhitespace)\n      ? false\n      : options.preserveWhitespace;\n    this.sanitizeElements = options.sanitize && options.sanitize.elements;\n    this.sanitizeEventAttributes = options.sanitize && options.sanitize.eventAttributes;\n    this.includeLinePositions = options.includeLinePositions;\n    this.textOnlyMode = options.textOnlyMode;\n    this.csp = options.csp;\n    this.allowExpressions = options.allowExpressions;\n\n    if (options.expression) this.converters = [readExpression];\n\n    if (options.attributes) this.inTag = true;\n\n    // special whitespace handling requested for certain elements\n    this.whiteSpaceElements = assign({}, options.preserveWhitespace, preserveWhitespaceElements);\n  },\n\n  postProcess(result, options) {\n    if (options.expression) {\n      const expr = flattenExpression(result[0]);\n      expr.e = fromExpression(expr.s, expr.r.length);\n      return expr;\n    } else {\n      // special case - empty string\n      if (!result.length) {\n        return { t: [], v: TEMPLATE_VERSION };\n      }\n\n      if (this.sectionDepth > 0) {\n        this.error('A section was left open');\n      }\n\n      cleanup(\n        result[0].t,\n        this.stripComments,\n        this.preserveWhitespace,\n        !this.preserveWhitespace,\n        !this.preserveWhitespace,\n        this.whiteSpaceElements\n      );\n\n      if (this.csp !== false) {\n        const expr = {};\n        insertExpressions(result[0].t, expr);\n        if (keys(expr).length) result[0].e = expr;\n      }\n\n      return result[0];\n    }\n  },\n\n  converters: [readTemplate],\n\n  sortMustacheTags() {\n    // Sort in order of descending opening delimiter length (longer first),\n    // to protect against opening delimiters being substrings of each other\n    this.tags.sort((a, b) => {\n      return b.open.length - a.open.length;\n    });\n  }\n});\n\nexport default function parse(template, options) {\n  return new StandardParser(template, options || {}).result;\n}\n","import { fromExpression } from 'parse/utils/createFunction';\nimport { doc } from 'config/environment';\nimport { fatal } from 'utils/log';\nimport { addFunctions } from 'shared/getFunction';\nimport parse from 'parse/_parse';\nimport { isString } from 'utils/is';\n\nconst parseOptions = [\n  'delimiters',\n  'tripleDelimiters',\n  'staticDelimiters',\n  'staticTripleDelimiters',\n  'csp',\n  'interpolate',\n  'preserveWhitespace',\n  'sanitize',\n  'stripComments',\n  'contextLines',\n  'allowExpressions',\n  'attributes'\n];\n\nconst TEMPLATE_INSTRUCTIONS = `Either preparse or use a ractive runtime source that includes the parser. `;\n\nconst COMPUTATION_INSTRUCTIONS = `Either include a version of Ractive that can parse or convert your computation strings to functions.`;\n\nfunction throwNoParse(method, error, instructions) {\n  if (!method) {\n    fatal(`Missing Ractive.parse - cannot parse ${error}. ${instructions}`);\n  }\n}\n\nexport function createFunction(body, length) {\n  throwNoParse(fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS);\n  return fromExpression(body, length);\n}\n\nexport function createFunctionFromString(str, bindTo) {\n  throwNoParse(parse, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS);\n  const tpl = parse(str, { expression: true });\n  return function() {\n    return tpl.e.apply(bindTo, tpl.r.map(r => bindTo.get(r)));\n  };\n}\n\nconst parser = {\n  fromId(id, options) {\n    if (!doc) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Cannot retrieve template #${id} as Ractive is not running in a browser.`);\n    }\n\n    if (id) id = id.replace(/^#/, '');\n\n    let template;\n\n    if (!(template = doc.getElementById(id))) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Could not find template element with id #${id}`);\n    }\n\n    if (template.tagName.toUpperCase() !== 'SCRIPT') {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Template element with id #${id}, must be a <script> element`);\n    }\n\n    return 'textContent' in template ? template.textContent : template.innerHTML;\n  },\n\n  isParsed(template) {\n    return !isString(template);\n  },\n\n  getParseOptions(ractive) {\n    // Could be Ractive or a Component\n    if (ractive.defaults) {\n      ractive = ractive.defaults;\n    }\n\n    return parseOptions.reduce((val, key) => {\n      val[key] = ractive[key];\n      return val;\n    }, {});\n  },\n\n  parse(template, options) {\n    throwNoParse(parse, 'template', TEMPLATE_INSTRUCTIONS);\n    const parsed = parse(template, options);\n    addFunctions(parsed);\n    return parsed;\n  },\n\n  parseFor(template, ractive) {\n    return this.parse(template, this.getParseOptions(ractive));\n  }\n};\n\nexport default parser;\n","import { removeFromArray } from 'utils/array';\nimport { isFunction } from 'utils/is';\n\nexport default class TransitionManager {\n  constructor(callback, parent) {\n    this.callback = callback;\n    this.parent = parent;\n\n    this.intros = [];\n    this.outros = [];\n\n    this.children = [];\n    this.totalChildren = this.outroChildren = 0;\n\n    this.detachQueue = [];\n    this.outrosComplete = false;\n\n    if (parent) {\n      parent.addChild(this);\n    }\n  }\n\n  add(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    transition.starting = true;\n    list.push(transition);\n  }\n\n  addChild(child) {\n    this.children.push(child);\n\n    this.totalChildren += 1;\n    this.outroChildren += 1;\n  }\n\n  decrementOutros() {\n    this.outroChildren -= 1;\n    check(this);\n  }\n\n  decrementTotal() {\n    this.totalChildren -= 1;\n    check(this);\n  }\n\n  detachNodes() {\n    let len = this.detachQueue.length;\n    for (let i = 0; i < len; i++) this.detachQueue[i].detach();\n    len = this.children.length;\n    for (let i = 0; i < len; i++) this.children[i].detachNodes();\n    this.detachQueue = [];\n  }\n\n  ready() {\n    if (this.detachQueue.length) detachImmediate(this);\n  }\n\n  remove(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    removeFromArray(list, transition);\n    check(this);\n  }\n\n  start() {\n    this.children.forEach(c => c.start());\n    this.intros.concat(this.outros).forEach(t => t.start());\n    this.ready = true;\n    check(this);\n  }\n}\n\nfunction check(tm) {\n  if (!tm.ready || tm.outros.length || tm.outroChildren) return;\n\n  // If all outros are complete, and we haven't already done this,\n  // we notify the parent if there is one, otherwise\n  // start detaching nodes\n  if (!tm.outrosComplete) {\n    tm.outrosComplete = true;\n\n    if (tm.parent && !tm.parent.outrosComplete) {\n      tm.parent.decrementOutros(tm);\n    } else {\n      tm.detachNodes();\n    }\n  }\n\n  // Once everything is done, we can notify parent transition\n  // manager and call the callback\n  if (!tm.intros.length && !tm.totalChildren) {\n    if (isFunction(tm.callback)) {\n      tm.callback();\n    }\n\n    if (tm.parent && !tm.notifiedTotal) {\n      tm.notifiedTotal = true;\n      tm.parent.decrementTotal();\n    }\n  }\n}\n\n// check through the detach queue to see if a node is up or downstream from a\n// transition and if not, go ahead and detach it\nfunction detachImmediate(manager) {\n  const queue = manager.detachQueue;\n  const outros = collectAllOutros(manager);\n\n  if (!outros.length) {\n    manager.detachNodes();\n  } else {\n    let i = queue.length;\n    let j = 0;\n    let node, trans;\n    const nqueue = (manager.detachQueue = []);\n\n    start: while (i--) {\n      node = queue[i].node;\n      j = outros.length;\n      while (j--) {\n        trans = outros[j].element.node;\n        // check to see if the node is, contains, or is contained by the transitioning node\n        if (trans === node || trans.contains(node) || node.contains(trans)) {\n          nqueue.push(queue[i]);\n          continue start;\n        }\n      }\n\n      // no match, we can drop it\n      queue[i].detach();\n    }\n  }\n}\n\nfunction collectAllOutros(manager, _list) {\n  let list = _list;\n\n  // if there's no list, we're starting at the root to build one\n  if (!list) {\n    list = [];\n    let parent = manager;\n    while (parent.parent) parent = parent.parent;\n    return collectAllOutros(parent, list);\n  } else {\n    // grab all outros from child managers\n    let i = manager.children.length;\n    while (i--) {\n      list = collectAllOutros(manager.children[i], list);\n    }\n\n    // grab any from this manager if there are any\n    if (manager.outros.length) list = list.concat(manager.outros);\n\n    return list;\n  }\n}\n","import { addToArray } from 'utils/array';\nimport TransitionManager from './TransitionManager';\n\nlet batch;\n\nconst runloop = {\n  active() {\n    return !!batch;\n  },\n\n  start() {\n    let fulfilPromise;\n    const promise = new Promise(f => (fulfilPromise = f));\n\n    batch = {\n      previousBatch: batch,\n      transitionManager: new TransitionManager(fulfilPromise, batch && batch.transitionManager),\n      fragments: [],\n      tasks: [],\n      immediateObservers: [],\n      deferredObservers: [],\n      promise\n    };\n\n    return promise;\n  },\n\n  end() {\n    flushChanges();\n\n    if (!batch.previousBatch) batch.transitionManager.start();\n\n    batch = batch.previousBatch;\n  },\n\n  addFragment(fragment) {\n    addToArray(batch.fragments, fragment);\n  },\n\n  // TODO: come up with a better way to handle fragments that trigger their own update\n  addFragmentToRoot(fragment) {\n    if (!batch) return;\n\n    let b = batch;\n    while (b.previousBatch) {\n      b = b.previousBatch;\n    }\n\n    addToArray(b.fragments, fragment);\n  },\n\n  addObserver(observer, defer) {\n    if (!batch) {\n      observer.dispatch();\n    } else {\n      addToArray(defer ? batch.deferredObservers : batch.immediateObservers, observer);\n    }\n  },\n\n  registerTransition(transition) {\n    transition._manager = batch.transitionManager;\n    batch.transitionManager.add(transition);\n  },\n\n  // synchronise node detachments with transition ends\n  detachWhenReady(thing) {\n    batch.transitionManager.detachQueue.push(thing);\n  },\n\n  scheduleTask(task, postRender) {\n    let _batch;\n\n    if (!batch) {\n      task();\n    } else {\n      _batch = batch;\n      while (postRender && _batch.previousBatch) {\n        // this can't happen until the DOM has been fully updated\n        // otherwise in some situations (with components inside elements)\n        // transitions and decorators will initialise prematurely\n        _batch = _batch.previousBatch;\n      }\n\n      _batch.tasks.push(task);\n    }\n  },\n\n  promise() {\n    if (!batch) return Promise.resolve();\n\n    let target = batch;\n    while (target.previousBatch) {\n      target = target.previousBatch;\n    }\n\n    return target.promise || Promise.resolve();\n  }\n};\n\nexport default runloop;\n\nfunction dispatch(observer) {\n  observer.dispatch();\n}\n\nfunction flushChanges() {\n  let which = batch.immediateObservers;\n  batch.immediateObservers = [];\n  which.forEach(dispatch);\n\n  // Now that changes have been fully propagated, we can update the DOM\n  // and complete other tasks\n  let i = batch.fragments.length;\n  let fragment;\n\n  which = batch.fragments;\n  batch.fragments = [];\n\n  while (i--) {\n    fragment = which[i];\n    fragment.update();\n  }\n\n  batch.transitionManager.ready();\n\n  which = batch.deferredObservers;\n  batch.deferredObservers = [];\n  which.forEach(dispatch);\n\n  const tasks = batch.tasks;\n  batch.tasks = [];\n\n  for (i = 0; i < tasks.length; i += 1) {\n    tasks[i]();\n  }\n\n  // If updating the view caused some model blowback - e.g. a triple\n  // containing <option> elements caused the binding on the <select>\n  // to update - then we start over\n  if (\n    batch.fragments.length ||\n    batch.immediateObservers.length ||\n    batch.deferredObservers.length ||\n    batch.tasks.length\n  )\n    return flushChanges();\n}\n","import runloop from 'src/global/runloop';\n\n// TODO what happens if a transition is aborted?\n\nconst tickers = [];\nlet running = false;\n\nfunction tick() {\n  runloop.start();\n\n  const now = performance.now();\n\n  let i;\n  let ticker;\n\n  for (i = 0; i < tickers.length; i += 1) {\n    ticker = tickers[i];\n\n    if (!ticker.tick(now)) {\n      // ticker is complete, remove it from the stack, and decrement i so we don't miss one\n      tickers.splice(i--, 1);\n    }\n  }\n\n  runloop.end();\n\n  if (tickers.length) {\n    requestAnimationFrame(tick);\n  } else {\n    running = false;\n  }\n}\n\nexport default class Ticker {\n  constructor(options) {\n    this.duration = options.duration;\n    this.step = options.step;\n    this.complete = options.complete;\n    this.easing = options.easing;\n\n    this.start = performance.now();\n    this.end = this.start + this.duration;\n\n    this.running = true;\n\n    tickers.push(this);\n    if (!running) requestAnimationFrame(tick);\n  }\n\n  tick(now) {\n    if (!this.running) return false;\n\n    if (now > this.end) {\n      if (this.step) this.step(1);\n      if (this.complete) this.complete(1);\n\n      return false;\n    }\n\n    const elapsed = now - this.start;\n    const eased = this.easing(elapsed / this.duration);\n\n    if (this.step) this.step(eased);\n\n    return true;\n  }\n\n  stop() {\n    if (this.abort) this.abort();\n    this.running = false;\n  }\n}\n","import { hasOwn } from 'utils/object';\nimport { isString, isObjectType } from 'utils/is';\n\nconst prefixers = {};\n\n// TODO this is legacy. sooner we can replace the old adaptor API the better\n/* istanbul ignore next */\nfunction prefixKeypath(obj, prefix) {\n  const prefixed = {};\n\n  if (!prefix) {\n    return obj;\n  }\n\n  prefix += '.';\n\n  for (const key in obj) {\n    if (hasOwn(obj, key)) {\n      prefixed[prefix + key] = obj[key];\n    }\n  }\n\n  return prefixed;\n}\n\nexport default function getPrefixer(rootKeypath) {\n  let rootDot;\n\n  if (!prefixers[rootKeypath]) {\n    rootDot = rootKeypath ? rootKeypath + '.' : '';\n\n    /* istanbul ignore next */\n    prefixers[rootKeypath] = function(relativeKeypath, value) {\n      let obj;\n\n      if (isString(relativeKeypath)) {\n        obj = {};\n        obj[rootDot + relativeKeypath] = value;\n        return obj;\n      }\n\n      if (isObjectType(relativeKeypath)) {\n        // 'relativeKeypath' is in fact a hash, not a keypath\n        return rootDot ? prefixKeypath(relativeKeypath, rootKeypath) : relativeKeypath;\n      }\n    };\n  }\n\n  return prefixers[rootKeypath];\n}\n","import ModelBase, { maybeBind, shuffle } from './ModelBase';\nimport LinkModel from './LinkModel'; // eslint-disable-line no-unused-vars\nimport getComputationSignature from 'src/Ractive/helpers/getComputationSignature';\nimport { capture } from 'src/global/capture';\nimport { isArray, isEqual, isNumeric, isObjectLike } from 'utils/is';\nimport { handleChange, mark, markForce, marked, teardown } from 'shared/methodCallers';\nimport Ticker from 'shared/Ticker';\nimport getPrefixer from './helpers/getPrefixer';\nimport { unescapeKey } from 'shared/keypaths';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn, keys } from 'utils/object';\nimport { buildNewIndices } from 'utils/array';\n\nexport const shared = {};\n\nexport default class Model extends ModelBase {\n  constructor(parent, key) {\n    super(parent);\n\n    this.ticker = null;\n\n    if (parent) {\n      this.key = unescapeKey(key);\n      this.isReadonly = parent.isReadonly;\n\n      if (parent.value) {\n        this.value = parent.value[this.key];\n        if (isArray(this.value)) this.length = this.value.length;\n        this.adapt();\n      }\n    }\n  }\n\n  adapt() {\n    const adaptors = this.root.adaptors;\n    const len = adaptors.length;\n\n    this.rewrap = false;\n\n    // Exit early if no adaptors\n    if (len === 0) return;\n\n    const value = this.wrapper\n      ? 'newWrapperValue' in this\n        ? this.newWrapperValue\n        : this.wrapperValue\n      : this.value;\n\n    // TODO remove this legacy nonsense\n    const ractive = this.root.ractive;\n    const keypath = this.getKeypath();\n\n    // tear previous adaptor down if present\n    if (this.wrapper) {\n      const shouldTeardown =\n        this.wrapperValue === value\n          ? false\n          : !this.wrapper.reset || this.wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        this.wrapper.teardown();\n        delete this.wrapper;\n        delete this.wrapperValue;\n\n        // don't branch for undefined values\n        if (this.value !== undefined) {\n          const parentValue = this.parent.value || this.parent.createBranch(this.key);\n          if (parentValue[this.key] !== value) parentValue[this.key] = value;\n          this.value = value;\n        }\n      } else {\n        delete this.newWrapperValue;\n        this.value = this.wrapper.get();\n        return;\n      }\n    }\n\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const adaptor = adaptors[i];\n      if (adaptor.filter(value, keypath, ractive)) {\n        this.wrapper = adaptor.wrap(ractive, value, keypath, getPrefixer(keypath));\n        this.wrapperValue = value;\n        this.wrapper.__model = this; // massive temporary hack to enable array adaptor\n\n        this.value = this.wrapper.get();\n\n        break;\n      }\n    }\n  }\n\n  animate(from, to, options, interpolator) {\n    if (this.ticker) this.ticker.stop();\n\n    let fulfilPromise;\n    const promise = new Promise(fulfil => (fulfilPromise = fulfil));\n\n    this.ticker = new Ticker({\n      duration: options.duration,\n      easing: options.easing,\n      step: t => {\n        const value = interpolator(t);\n        this.applyValue(value);\n        if (options.step) options.step(t, value);\n      },\n      complete: () => {\n        this.applyValue(to);\n        if (options.complete) options.complete(to);\n\n        this.ticker = null;\n        fulfilPromise(to);\n      }\n    });\n\n    promise.stop = this.ticker.stop;\n    return promise;\n  }\n\n  applyValue(value, notify = true) {\n    if (isEqual(value, this.value)) return;\n    if (this.boundValue) this.boundValue = null;\n\n    if (this.parent.wrapper && this.parent.wrapper.set) {\n      this.parent.wrapper.set(this.key, value);\n      this.parent.value = this.parent.wrapper.get();\n\n      this.value = this.parent.value[this.key];\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    } else if (this.wrapper) {\n      this.newWrapperValue = value;\n      this.adapt();\n    } else {\n      const parentValue = this.parent.value || this.parent.createBranch(this.key);\n      if (isObjectLike(parentValue)) {\n        parentValue[this.key] = value;\n      } else {\n        warnIfDebug(`Attempted to set a property of a non-object '${this.getKeypath()}'`);\n        return;\n      }\n\n      this.value = value;\n      this.adapt();\n    }\n\n    // keep track of array stuff\n    if (isArray(value)) {\n      this.length = value.length;\n      this.isArray = true;\n    } else {\n      this.isArray = false;\n    }\n\n    // notify dependants\n    this.links.forEach(handleChange);\n    this.children.forEach(mark);\n    this.deps.forEach(handleChange);\n\n    if (notify) this.notifyUpstream();\n\n    if (this.parent.isArray) {\n      if (this.key === 'length') this.parent.length = value;\n      else this.parent.joinKey('length').mark();\n    }\n  }\n\n  compute(key, computed) {\n    const registry = this.computed || (this.computed = {});\n\n    if (registry[key]) {\n      registry[key].signature = getComputationSignature(this.root.ractive, key, computed);\n      registry[key].mark();\n    } else {\n      registry[key] = new shared.Computation(\n        this,\n        getComputationSignature(this.root.ractive, key, computed),\n        key\n      );\n    }\n\n    return registry[key];\n  }\n\n  createBranch(key) {\n    const branch = isNumeric(key) ? [] : {};\n    this.applyValue(branch, false);\n\n    return branch;\n  }\n\n  get(shouldCapture, opts) {\n    if (this._link) return this._link.get(shouldCapture, opts);\n    if (shouldCapture) capture(this);\n    // if capturing, this value needs to be unwrapped because it's for external use\n    if (opts && opts.virtual) return this.getVirtual(false);\n    return maybeBind(\n      this,\n      (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  joinKey(key, opts) {\n    if (this._link) {\n      if (opts && opts.lastLink !== false && (key === undefined || key === '')) return this;\n      return this._link.joinKey(key);\n    }\n\n    if (key === undefined || key === '') return this;\n\n    let child;\n    if (hasOwn(this.childByKey, key)) child = this.childByKey[key];\n    else child = this.computed && this.computed[key];\n\n    if (!child) {\n      let computed;\n      if (this.isRoot && this.ractive && (computed = this.ractive.computed[key])) {\n        child = this.compute(key, computed);\n      } else if (!this.isRoot && this.root.ractive) {\n        const registry = this.root.ractive.computed;\n        for (const k in registry) {\n          computed = registry[k];\n          if (computed.pattern && computed.pattern.test(this.getKeypath() + '.' + key)) {\n            child = this.compute(key, computed);\n          }\n        }\n      }\n    }\n\n    if (!child) {\n      child = new Model(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    if (child._link && (!opts || opts.lastLink !== false)) return child._link;\n\n    return child;\n  }\n\n  mark(force) {\n    if (this._link) return this._link.mark(force);\n\n    const old = this.value;\n    const value = this.retrieve();\n\n    if (force || !isEqual(value, old)) {\n      this.value = value;\n      if (this.boundValue) this.boundValue = null;\n\n      // make sure the wrapper stays in sync\n      if (old !== value || this.rewrap) {\n        if (this.wrapper) this.newWrapperValue = value;\n        this.adapt();\n      }\n\n      // keep track of array stuff\n      if (isArray(value)) {\n        this.length = value.length;\n        this.isArray = true;\n      } else {\n        this.isArray = false;\n      }\n\n      this.children.forEach(force ? markForce : mark);\n      this.links.forEach(marked);\n\n      this.deps.forEach(handleChange);\n    }\n  }\n\n  merge(array, comparator) {\n    const newIndices = buildNewIndices(\n      this.value === array ? recreateArray(this) : this.value,\n      array,\n      comparator\n    );\n    this.parent.value[this.key] = array;\n    this.shuffle(newIndices, true);\n  }\n\n  retrieve() {\n    return this.parent.value ? this.parent.value[this.key] : undefined;\n  }\n\n  set(value) {\n    if (this.ticker) this.ticker.stop();\n    this.applyValue(value);\n  }\n\n  shuffle(newIndices, unsafe) {\n    shuffle(this, newIndices, false, unsafe);\n  }\n\n  source() {\n    return this;\n  }\n\n  teardown() {\n    if (this._link) {\n      this._link.teardown();\n      this._link = null;\n    }\n    this.children.forEach(teardown);\n    if (this.wrapper) this.wrapper.teardown();\n    if (this.computed) keys(this.computed).forEach(k => this.computed[k].teardown());\n  }\n}\n\nfunction recreateArray(model) {\n  const array = [];\n\n  for (let i = 0; i < model.length; i++) {\n    array[i] = (model.childByKey[i] || {}).value;\n  }\n\n  return array;\n}\n","/* global global */\nimport Model from '../Model';\n\nexport const data = {};\n\nexport class SharedModel extends Model {\n  constructor(value, name) {\n    super(null, `@${name}`);\n    this.key = `@${name}`;\n    this.value = value;\n    this.isRoot = true;\n    this.root = this;\n    this.adaptors = [];\n  }\n\n  getKeypath() {\n    return this.key;\n  }\n\n  retrieve() {\n    return this.value;\n  }\n}\n\nexport default new SharedModel(data, 'shared');\n\nexport const GlobalModel = new SharedModel(\n  typeof global !== 'undefined' ? global : window,\n  'global'\n);\n","import { splitKeypath } from 'shared/keypaths';\nimport SharedModel, { GlobalModel } from 'src/model/specials/SharedModel';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nfunction findContext(fragment) {\n  let frag = fragment;\n  while (frag && !frag.context && !frag.aliases) frag = frag.parent;\n  return frag;\n}\n\nexport default function resolveReference(fragment, ref) {\n  const initialFragment = fragment;\n  // current context ref\n  if (ref === '.') return fragment.findContext();\n\n  // ancestor references\n  if (ref[0] === '~') return fragment.ractive.viewmodel.joinAll(splitKeypath(ref.slice(2)));\n\n  // scoped references\n  if (ref[0] === '.' || ref[0] === '^') {\n    let frag = fragment;\n    const parts = ref.split('/');\n    const explicitContext = parts[0] === '^^';\n\n    // find nearest context node\n    while (frag && !frag.context) {\n      frag = up(frag);\n    }\n    let context = frag && frag.context;\n\n    // walk up the context chain\n    while (frag && parts[0] === '^^') {\n      parts.shift();\n\n      // the current fragment should always be a context,\n      // and if it happens to be an iteration, jump above the each block\n      if (frag.isIteration) {\n        frag = frag.parent.parent;\n      } else {\n        // otherwise jump above the current fragment\n        frag = up(frag);\n      }\n\n      // walk to the next contexted fragment\n      while (frag && !frag.context) {\n        frag = up(frag);\n      }\n      context = frag && frag.context;\n    }\n\n    if (!context && explicitContext) {\n      throw new Error(\n        `Invalid context parent reference ('${ref}'). There is not context at that level.`\n      );\n    }\n\n    // walk up the context path\n    while (parts[0] === '.' || parts[0] === '..') {\n      const part = parts.shift();\n\n      if (part === '..') {\n        context = context.parent;\n      }\n    }\n\n    ref = parts.join('/');\n\n    // special case - `{{.foo}}` means the same as `{{./foo}}`\n    if (ref[0] === '.') ref = ref.slice(1);\n    return context.joinAll(splitKeypath(ref));\n  }\n\n  const keys = splitKeypath(ref);\n  if (!keys.length) return;\n  const base = keys.shift();\n\n  // special refs\n  if (base[0] === '@') {\n    // shorthand from outside the template\n    // @this referring to local ractive instance\n    if (base === '@this' || base === '@') {\n      return fragment.ractive.viewmodel.getRactiveModel().joinAll(keys);\n    } else if (base === '@index' || base === '@key') {\n      // @index or @key referring to the nearest repeating index or key\n      if (keys.length) badReference(base);\n      const repeater = findIter(fragment);\n      return repeater && repeater[`get${base[1] === 'i' ? 'Index' : 'Key'}`]();\n    } else if (base === '@last') {\n      const repeater = findIter(fragment);\n      return repeater && repeater.parent.getLast();\n    } else if (base === '@global') {\n      // @global referring to window or global\n      return GlobalModel.joinAll(keys);\n    } else if (base === '@shared') {\n      // @global referring to window or global\n      return SharedModel.joinAll(keys);\n    } else if (base === '@keypath' || base === '@rootpath') {\n      // @keypath or @rootpath, the current keypath string\n      const root = ref[1] === 'r' ? fragment.ractive.root : null;\n      let f = fragment;\n\n      while (\n        f &&\n        (!f.context || (f.isRoot && f.ractive.component && (root || !f.ractive.isolated)))\n      ) {\n        f = f.isRoot ? f.componentParent : f.parent;\n      }\n\n      return f.getKeypath(root);\n    } else if (base === '@context') {\n      return new ContextModel(fragment.getContext());\n    } else if (base === '@local') {\n      // @context-local data\n      return fragment.getContext()._data.joinAll(keys);\n    } else if (base === '@style') {\n      // @style shared model\n      return fragment.ractive.constructor._cssModel.joinAll(keys);\n    } else if (base === '@helpers') {\n      // @helpers instance model\n      return fragment.ractive.viewmodel.getHelpers().joinAll(keys);\n    } else {\n      // nope\n      throw new Error(`Invalid special reference '${base}'`);\n    }\n  }\n\n  // helpers\n  if (base && !keys.length) {\n    const helpers = fragment.ractive.viewmodel.getHelpers();\n    if (helpers.has(base)) return helpers.joinKey(base);\n  }\n\n  let context = findContext(fragment);\n\n  // check immediate context for a match\n  if (context) {\n    if (context.context) {\n      context = context.context;\n      if (context.has(base)) return context.joinKey(base).joinAll(keys);\n    } else {\n      // alias block, so get next full context for later\n      context = fragment.findContext();\n    }\n  } else {\n    context = fragment.findContext();\n  }\n\n  // walk up the fragment hierarchy looking for a matching ref, alias, or key in a context\n  let createMapping = false;\n  const shouldWarn = fragment.ractive.warnAboutAmbiguity;\n  let crossed = 0;\n  let model;\n\n  while (fragment) {\n    // repeated fragments\n    if (fragment.isIteration) {\n      if (base === fragment.parent.keyRef) {\n        model = fragment.getKey();\n      } else if (base === fragment.parent.indexRef) {\n        model = fragment.getIndex();\n      }\n\n      if (model && keys.length) badReference(base);\n    }\n\n    // alias node or iteration\n    if (!model && fragment.aliases && hasOwn(fragment.aliases, base)) {\n      model = fragment.aliases[base];\n    }\n\n    // check fragment context to see if it has the key we need\n    if (!model && fragment.context && fragment.context.has(base)) {\n      model = fragment.context.joinKey(base);\n\n      // this is an implicit mapping\n      if (createMapping) {\n        if (shouldWarn)\n          warnIfDebug(\n            `'${ref}' resolved but is ambiguous and will create a mapping to a parent component.`\n          );\n      } else if (shouldWarn && crossed) warnIfDebug(`'${ref}' resolved but is ambiguous.`);\n    }\n\n    if (model) {\n      if (createMapping) {\n        model = initialFragment.ractive.viewmodel.createLink(base, model, base, { implicit: true });\n      }\n\n      if (keys.length > 0 && isFunction(model.joinAll)) {\n        model = model.joinAll(keys);\n      }\n\n      return model;\n    }\n\n    // don't consider alias blocks when checking for ambiguity\n    if (fragment.context && !fragment.aliases) crossed = 1;\n\n    if (\n      (fragment.componentParent || (!fragment.parent && fragment.ractive.component)) &&\n      !fragment.ractive.isolated\n    ) {\n      // ascend through component boundary\n      fragment = fragment.componentParent || fragment.ractive.component.up;\n      createMapping = true;\n    } else {\n      fragment = fragment.parent;\n    }\n  }\n\n  // if enabled, check the instance for a match\n  const instance = initialFragment.ractive;\n  if (instance.resolveInstanceMembers && base !== 'data' && base in instance) {\n    return instance.viewmodel\n      .getRactiveModel()\n      .joinKey(base)\n      .joinAll(keys);\n  }\n\n  if (shouldWarn) {\n    warnIfDebug(`'${ref}' is ambiguous and did not resolve.`);\n  }\n\n  // didn't find anything, so go ahead and create the key on the local model\n  return context.joinKey(base).joinAll(keys);\n}\n\nfunction up(fragment) {\n  return fragment && ((!fragment.ractive.isolated && fragment.componentParent) || fragment.parent);\n}\n\nfunction findIter(start) {\n  let fragment = start;\n  let next;\n  while (!fragment.isIteration && (next = up(fragment))) {\n    fragment = next;\n  }\n\n  return fragment.isIteration && fragment;\n}\n\nfunction badReference(key) {\n  throw new Error(`An index or key reference (${key}) cannot have child properties`);\n}\n\nclass ContextModel {\n  constructor(context) {\n    this.context = context;\n  }\n\n  get() {\n    return this.context;\n  }\n\n  getKeypath() {\n    return '@context';\n  }\n}\n","import noop from 'utils/noop';\nimport { assign, create } from 'utils/object';\n\nexport const extern = {};\n\nexport default function getRactiveContext(ractive, ...assigns) {\n  const fragment =\n    ractive.fragment ||\n    ractive._fakeFragment ||\n    (ractive._fakeFragment = new FakeFragment(ractive));\n  return fragment.getContext.apply(fragment, assigns);\n}\n\nexport function getContext(...assigns) {\n  if (!this.ctx) this.ctx = new extern.Context(this);\n  assigns.unshift(create(this.ctx));\n  return assign.apply(null, assigns);\n}\n\nexport class FakeFragment {\n  constructor(ractive) {\n    this.ractive = ractive;\n  }\n\n  findContext() {\n    return this.ractive.viewmodel;\n  }\n}\nconst proto = FakeFragment.prototype;\nproto.getContext = getContext;\nproto.find = proto.findComponent = proto.findAll = proto.findAllComponents = noop;\n\nexport function findParentWithContext(fragment) {\n  let frag = fragment;\n  while (frag && !frag.context) frag = frag.parent;\n  if (!frag) return fragment && fragment.ractive.fragment;\n  else return frag;\n}\n","import { isArray, isObject, isObjectType, isFunction, isString } from 'utils/is';\nimport { warnIfDebug } from 'utils/log';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from '../global/runloop';\nimport { splitKeypath } from './keypaths';\nimport { FakeFragment } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\n\nexport let keep = false;\n\nexport function set(pairs, options) {\n  const k = keep;\n\n  const deep = options && options.deep;\n  const shuffle = options && options.shuffle;\n  const promise = runloop.start();\n  if (options && 'keep' in options) keep = options.keep;\n\n  let i = pairs.length;\n  while (i--) {\n    const model = pairs[i][0];\n    const value = pairs[i][1];\n    const keypath = pairs[i][2];\n\n    if (!model) {\n      runloop.end();\n      throw new Error(`Failed to set invalid keypath '${keypath}'`);\n    }\n\n    if (deep) deepSet(model, value);\n    else if (shuffle) {\n      let array = value;\n      const target = model.get();\n      // shuffle target array with itself\n      if (!array) array = target;\n\n      // if there's not an array there yet, go ahead and set\n      if (target === undefined) {\n        model.set(array);\n      } else {\n        if (!isArray(target) || !isArray(array)) {\n          runloop.end();\n          throw new Error('You cannot merge an array with a non-array');\n        }\n\n        const comparator = getComparator(shuffle);\n        model.merge(array, comparator);\n      }\n    } else model.set(value);\n  }\n\n  runloop.end();\n\n  keep = k;\n\n  return promise;\n}\n\nconst star = /\\*/;\nexport function gather(ractive, keypath, base, isolated) {\n  if (!base && (keypath[0] === '.' || keypath[1] === '^')) {\n    warnIfDebug(\n      `Attempted to set a relative keypath from a non-relative context. You can use a context object to set relative keypaths.`\n    );\n    return [];\n  }\n\n  const keys = splitKeypath(keypath);\n  const model = base || ractive.viewmodel;\n\n  if (star.test(keypath)) {\n    return model.findMatches(keys);\n  } else {\n    if (model === ractive.viewmodel) {\n      // allow implicit mappings\n      if (\n        ractive.component &&\n        !ractive.isolated &&\n        !model.has(keys[0]) &&\n        keypath[0] !== '@' &&\n        keypath[0] &&\n        !isolated\n      ) {\n        return [resolveReference(ractive.fragment || new FakeFragment(ractive), keypath)];\n      } else {\n        return [model.joinAll(keys)];\n      }\n    } else {\n      return [model.joinAll(keys)];\n    }\n  }\n}\n\nexport function build(ractive, keypath, value, isolated) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push.apply(sets, gather(ractive, k, null, isolated).map(m => [m, keypath[k], k]));\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push.apply(sets, gather(ractive, keypath, null, isolated).map(m => [m, value, keypath]));\n  }\n\n  return sets;\n}\n\nconst deepOpts = { virtual: false };\nfunction deepSet(model, value) {\n  const dest = model.get(false, deepOpts);\n\n  // if dest doesn't exist, just set it\n  if (dest == null || !isObjectType(value)) return model.set(value);\n  if (!isObjectType(dest)) return model.set(value);\n\n  for (const k in value) {\n    if (hasOwn(value, k)) {\n      deepSet(model.joinKey(k), value[k]);\n    }\n  }\n}\n\nconst comparators = {};\nfunction getComparator(option) {\n  if (option === true) return null; // use existing arrays\n  if (isFunction(option)) return option;\n\n  if (isString(option)) {\n    return comparators[option] || (comparators[option] = thing => thing[option]);\n  }\n\n  throw new Error('If supplied, options.compare must be a string, function, or true'); // TODO link to docs\n}\n","import { isNumeric, isString } from 'utils/is';\nimport { build, set } from 'shared/set';\n\nconst errorMessage = 'Cannot add to a non-numeric value';\n\nexport default function add(ractive, keypath, d, options) {\n  if (!isString(keypath) || !isNumeric(d)) {\n    throw new Error('Bad arguments');\n  }\n\n  const sets = build(ractive, keypath, d, options && options.isolated);\n\n  return set(\n    sets.map(pair => {\n      const [model, add] = pair;\n      const value = model.get();\n      if (!isNumeric(add) || !isNumeric(value)) throw new Error(errorMessage);\n      return [model, value + add];\n    })\n  );\n}\n","import runloop from 'src/global/runloop';\nimport easing from 'src/Ractive/static/easing';\nimport interpolate from 'shared/interpolate';\nimport { isEqual, isFunction, isObjectType } from 'utils/is';\nimport noop from 'utils/noop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { defineProperty, keys as objectKeys } from 'utils/object';\n\nfunction immediate(value) {\n  const result = Promise.resolve(value);\n  defineProperty(result, 'stop', { value: noop });\n  return result;\n}\n\nconst linear = easing.linear;\n\nfunction getOptions(options, instance) {\n  options = options || {};\n\n  let easing;\n  if (options.easing) {\n    easing = isFunction(options.easing) ? options.easing : instance.easing[options.easing];\n  }\n\n  return {\n    easing: easing || linear,\n    duration: 'duration' in options ? options.duration : 400,\n    complete: options.complete || noop,\n    step: options.step || noop,\n    interpolator: options.interpolator\n  };\n}\n\nexport function animate(ractive, model, to, options) {\n  options = getOptions(options, ractive);\n  const from = model.get();\n\n  // don't bother animating values that stay the same\n  if (isEqual(from, to)) {\n    options.complete(options.to);\n    return immediate(to);\n  }\n\n  const interpolator = interpolate(from, to, ractive, options.interpolator);\n\n  // if we can't interpolate the value, set it immediately\n  if (!interpolator) {\n    runloop.start();\n    model.set(to);\n    runloop.end();\n\n    return immediate(to);\n  }\n\n  return model.animate(from, to, options, interpolator);\n}\n\nexport default function Ractive$animate(keypath, to, options) {\n  if (isObjectType(keypath)) {\n    const keys = objectKeys(keypath);\n\n    throw new Error(`ractive.animate(...) no longer supports objects. Instead of ractive.animate({\n  ${keys.map(key => `'${key}': ${keypath[key]}`).join('\\n  ')}\n}, {...}), do\n\n${keys.map(key => `ractive.animate('${key}', ${keypath[key]}, {...});`).join('\\n')}\n`);\n  }\n\n  return animate(this, this.viewmodel.joinAll(splitKeypath(keypath)), to, options);\n}\n","import { enqueue, dequeue } from './eventStack';\n\nconst initStars = {};\nconst bubbleStars = {};\n\n// cartesian product of name parts and stars\n// adjusted appropriately for special cases\nfunction variants(name, initial) {\n  const map = initial ? initStars : bubbleStars;\n  if (map[name]) return map[name];\n\n  const parts = name.split('.');\n  const result = [];\n  let base = false;\n\n  // initial events the implicit namespace of 'this'\n  if (initial) {\n    parts.unshift('this');\n    base = true;\n  }\n\n  // use max - 1 bits as a bitmap to pick a part or a *\n  // need to skip the full star case if the namespace is synthetic\n  const max = Math.pow(2, parts.length) - (initial ? 1 : 0);\n  for (let i = 0; i < max; i++) {\n    const join = [];\n    for (let j = 0; j < parts.length; j++) {\n      join.push(1 & (i >> j) ? '*' : parts[j]);\n    }\n    result.unshift(join.join('.'));\n  }\n\n  if (base) {\n    // include non-this-namespaced versions\n    if (parts.length > 2) {\n      result.push.apply(result, variants(name, false));\n    } else {\n      result.push('*');\n      result.push(name);\n    }\n  }\n\n  map[name] = result;\n  return result;\n}\n\nexport default function fireEvent(ractive, eventName, context, args = []) {\n  if (!eventName) {\n    return;\n  }\n\n  context.name = eventName;\n  args.unshift(context);\n\n  const eventNames = ractive._nsSubs ? variants(eventName, true) : ['*', eventName];\n\n  return fireEventAs(ractive, eventNames, context, args, true);\n}\n\nfunction fireEventAs(ractive, eventNames, context, args, initialFire = false) {\n  let bubble = true;\n\n  if (initialFire || ractive._nsSubs) {\n    enqueue(ractive, context);\n\n    let i = eventNames.length;\n    while (i--) {\n      if (eventNames[i] in ractive._subs) {\n        bubble = notifySubscribers(ractive, ractive._subs[eventNames[i]], context, args) && bubble;\n      }\n    }\n\n    dequeue(ractive);\n  }\n\n  if (ractive.parent && bubble) {\n    if (initialFire && ractive.component) {\n      const fullName = ractive.component.name + '.' + eventNames[eventNames.length - 1];\n      eventNames = variants(fullName, false);\n\n      if (context && !context.component) {\n        context.component = ractive;\n      }\n    }\n\n    bubble = fireEventAs(ractive.parent, eventNames, context, args);\n  }\n\n  return bubble;\n}\n\nfunction notifySubscribers(ractive, subscribers, context, args) {\n  let originalEvent = null;\n  let stopEvent = false;\n\n  // subscribers can be modified inflight, e.g. \"once\" functionality\n  // so we need to copy to make sure everyone gets called\n  subscribers = subscribers.slice();\n\n  for (let i = 0, len = subscribers.length; i < len; i += 1) {\n    if (!subscribers[i].off && subscribers[i].handler.apply(ractive, args) === false) {\n      stopEvent = true;\n    }\n  }\n\n  if (context && stopEvent && (originalEvent = context.event)) {\n    originalEvent.preventDefault && originalEvent.preventDefault();\n    originalEvent.stopPropagation && originalEvent.stopPropagation();\n  }\n\n  return !stopEvent;\n}\n","import fireEvent from './fireEvent';\nimport getRactiveContext from '../shared/getRactiveContext';\n\nexport class Hook {\n  constructor(event) {\n    this.event = event;\n    this.method = 'on' + event;\n  }\n\n  fire(ractive, arg) {\n    const context = getRactiveContext(ractive);\n    const method = this.method;\n\n    if (ractive[method]) {\n      arg ? ractive[method](context, arg) : ractive[method](context);\n    }\n\n    fireEvent(ractive, this.event, context, arg ? [arg, ractive] : [ractive]);\n  }\n}\n\nfunction getChildQueue(queue, ractive) {\n  return queue[ractive._guid] || (queue[ractive._guid] = []);\n}\n\nfunction fire(hookQueue, ractive) {\n  const childQueue = getChildQueue(hookQueue.queue, ractive);\n\n  hookQueue.hook.fire(ractive);\n\n  // queue is \"live\" because components can end up being\n  // added while hooks fire on parents that modify data values.\n  while (childQueue.length) {\n    fire(hookQueue, childQueue.shift());\n  }\n\n  delete hookQueue.queue[ractive._guid];\n}\n\nexport class HookQueue {\n  constructor(event) {\n    this.hook = new Hook(event);\n    this.inProcess = {};\n    this.queue = {};\n  }\n\n  begin(ractive) {\n    this.inProcess[ractive._guid] = true;\n  }\n\n  end(ractive) {\n    const parent = ractive.parent;\n\n    // If this is *isn't* a child of a component that's in process,\n    // it should call methods or fire at this point\n    if (!parent || !this.inProcess[parent._guid]) {\n      fire(this, ractive);\n    } else {\n      // elsewise, handoff to parent to fire when ready\n      getChildQueue(this.queue, parent).push(ractive);\n    }\n\n    delete this.inProcess[ractive._guid];\n  }\n}\n\nconst hooks = {};\n[\n  'construct',\n  'config',\n  'attachchild',\n  'detach',\n  'detachchild',\n  'insert',\n  'complete',\n  'reset',\n  'render',\n  'unrendering',\n  'unrender',\n  'teardown',\n  'destruct',\n  'update'\n].forEach(hook => {\n  hooks[hook] = new Hook(hook);\n});\nhooks.init = new HookQueue('init');\n\nexport default hooks;\n","export const TEXT = 1;\nexport const INTERPOLATOR = 2;\nexport const TRIPLE = 3;\nexport const SECTION = 4;\nexport const INVERTED = 5;\nexport const CLOSING = 6;\nexport const ELEMENT = 7;\nexport const PARTIAL = 8;\nexport const COMMENT = 9;\nexport const DELIMCHANGE = 10;\nexport const ANCHOR = 11;\nexport const ATTRIBUTE = 13;\nexport const CLOSING_TAG = 14;\nexport const COMPONENT = 15;\nexport const YIELDER = 16;\nexport const INLINE_PARTIAL = 17;\nexport const DOCTYPE = 18;\nexport const ALIAS = 19;\n\nexport const AWAIT = 55;\n\nexport const NUMBER_LITERAL = 20;\nexport const STRING_LITERAL = 21;\nexport const ARRAY_LITERAL = 22;\nexport const OBJECT_LITERAL = 23;\nexport const BOOLEAN_LITERAL = 24;\nexport const REGEXP_LITERAL = 25;\n\nexport const GLOBAL = 26;\nexport const KEY_VALUE_PAIR = 27;\n\nexport const REFERENCE = 30;\nexport const REFINEMENT = 31;\nexport const MEMBER = 32;\nexport const PREFIX_OPERATOR = 33;\nexport const BRACKETED = 34;\nexport const CONDITIONAL = 35;\nexport const INFIX_OPERATOR = 36;\n\nexport const INVOCATION = 40;\n\nexport const SECTION_IF = 50;\nexport const SECTION_UNLESS = 51;\nexport const SECTION_EACH = 52;\nexport const SECTION_WITH = 53;\nexport const SECTION_IF_WITH = 54;\n\nexport const ELSE = 60;\nexport const ELSEIF = 61;\nexport const THEN = 62;\nexport const CATCH = 63;\n\nexport const EVENT = 70;\nexport const DECORATOR = 71;\nexport const TRANSITION = 72;\nexport const BINDING_FLAG = 73;\nexport const DELEGATE_FLAG = 74;\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\nimport getNewIndices from 'shared/getNewIndices';\nimport { isArray } from 'utils/is';\n\nconst arrayProto = Array.prototype;\n\nexport default function(methodName) {\n  function path(keypath, ...args) {\n    return model(this.viewmodel.joinAll(splitKeypath(keypath)), args);\n  }\n\n  function model(mdl, args) {\n    let array = mdl.get();\n\n    if (!isArray(array)) {\n      if (array === undefined) {\n        array = [];\n        const result = arrayProto[methodName].apply(array, args);\n        const promise = runloop.start().then(() => result);\n        mdl.set(array);\n        runloop.end();\n        return promise;\n      } else {\n        throw new Error(\n          `shuffle array method ${methodName} called on non-array at ${mdl.getKeypath()}`\n        );\n      }\n    }\n\n    const newIndices = getNewIndices(array.length, methodName, args);\n    const result = arrayProto[methodName].apply(array, args);\n\n    const promise = runloop.start().then(() => result);\n    promise.result = result;\n\n    if (newIndices) {\n      if (mdl.shuffle) {\n        mdl.shuffle(newIndices);\n      } else {\n        // it's a computation, which don't have a shuffle, so just invalidate\n        mdl.mark();\n      }\n    } else {\n      mdl.set(result);\n    }\n\n    runloop.end();\n\n    return promise;\n  }\n\n  return { path, model };\n}\n","import resolveReference from 'src/view/resolvers/resolveReference';\nimport Model from 'src/model/Model';\nimport { isNumeric, isObject, isNumber, isObjectType, isString } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport findElement from 'src/view/items/shared/findElement';\nimport { set as sharedSet } from './set';\nimport makeArrayMethod from '../Ractive/prototype/shared/makeArrayMethod';\nimport { animate as protoAnimate } from '../Ractive/prototype/animate';\nimport { update as protoUpdate } from '../Ractive/prototype/update';\nimport getRactiveContext, { extern, findParentWithContext } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\nimport { ELEMENT } from 'config/types';\n\nconst modelPush = makeArrayMethod('push').model;\nconst modelPop = makeArrayMethod('pop').model;\nconst modelShift = makeArrayMethod('shift').model;\nconst modelUnshift = makeArrayMethod('unshift').model;\nconst modelSort = makeArrayMethod('sort').model;\nconst modelSplice = makeArrayMethod('splice').model;\nconst modelReverse = makeArrayMethod('reverse').model;\n\nclass ContextData extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.value = {};\n    this.ractive = options.ractive;\n    this.adaptors = [];\n    this.context = options.context;\n  }\n\n  getKeypath() {\n    return '@context.data';\n  }\n\n  rebound() {}\n}\n\nexport default class Context {\n  constructor(fragment, element) {\n    this.fragment = fragment;\n    this.element = element || findElement(fragment);\n    this.node = this.element && this.element.node;\n    this.ractive = fragment.ractive;\n    this.root = this;\n  }\n\n  get decorators() {\n    const items = {};\n    if (!this.element) return items;\n    this.element.decorators.forEach(d => (items[d.name] = d.handle));\n    return items;\n  }\n\n  get _data() {\n    return (\n      this.model ||\n      (this.root.model = new ContextData({\n        ractive: this.ractive,\n        context: this.root\n      }))\n    );\n  }\n\n  // the usual mutation suspects\n  add(keypath, d, options) {\n    const num = isNumber(d) ? +d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value + val];\n      }),\n      opts\n    );\n  }\n\n  animate(keypath, value, options) {\n    const model = findModel(this, keypath).model;\n    return protoAnimate(this.ractive, model, value, options);\n  }\n\n  // get relative keypaths and values\n  get(keypath) {\n    if (!keypath) return this.fragment.findContext().get(true);\n\n    const { model } = findModel(this, keypath);\n\n    return model ? model.get(true) : undefined;\n  }\n\n  getParent(component) {\n    let fragment = this.fragment;\n\n    if (fragment.context)\n      fragment = findParentWithContext(fragment.parent || (component && fragment.componentParent));\n    else {\n      fragment = findParentWithContext(fragment.parent || (component && fragment.componentParent));\n      if (fragment)\n        fragment = findParentWithContext(\n          fragment.parent || (component && fragment.componentParent)\n        );\n    }\n\n    if (!fragment || fragment === this.fragment) return;\n    else return fragment.getContext();\n  }\n\n  hasListener(name, bubble) {\n    // if the owner is a component, start there because the nearest element\n    // may exist outside of the immediate context (yield)\n    let el = this.fragment.owner.component\n      ? this.fragment.owner\n      : this.element || this.fragment.owner;\n    let base;\n\n    do {\n      base = el.component || el;\n      if (base.template.t === ELEMENT) {\n        if (findEvent(base, name)) return true;\n      }\n      el = el.up && el.up.owner;\n      if (el && el.component) el = el.component;\n    } while (el && bubble);\n  }\n\n  link(source, dest) {\n    const there = findModel(this, source).model;\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    here.link(there, source);\n    runloop.end();\n    return promise;\n  }\n\n  listen(event, handler) {\n    const el = this.element;\n    el.on(event, handler);\n    return {\n      cancel() {\n        el.off(event, handler);\n      }\n    };\n  }\n\n  observe(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observe(keypath, callback, options);\n  }\n\n  observeOnce(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observeOnce(keypath, callback, options);\n  }\n\n  pop(keypath) {\n    return modelPop(findModel(this, keypath).model, []);\n  }\n\n  push(keypath, ...values) {\n    return modelPush(findModel(this, keypath).model, values);\n  }\n\n  raise(name, event, ...args) {\n    let el = this.element;\n    let ev;\n\n    while (el) {\n      if (el.component) el = el.component;\n      ev = findEvent(el, name);\n      if (ev) {\n        return ev.fire(\n          ev.element.getContext(\n            event || {},\n            event && !('original' in event) ? { original: {} } : {}\n          ),\n          args\n        );\n      }\n\n      el = el.up && el.up.owner;\n    }\n  }\n\n  readLink(keypath, options) {\n    return this.ractive.readLink(this.resolve(keypath), options);\n  }\n\n  resolve(path, ractive) {\n    const { model, instance } = findModel(this, path);\n    return model ? model.getKeypath(ractive || instance) : path;\n  }\n\n  reverse(keypath) {\n    return modelReverse(findModel(this, keypath).model, []);\n  }\n\n  set(keypath, value, options) {\n    return sharedSet(build(this, keypath, value), options);\n  }\n\n  shift(keypath) {\n    return modelShift(findModel(this, keypath).model, []);\n  }\n\n  splice(keypath, index, drop, ...add) {\n    add.unshift(index, drop);\n    return modelSplice(findModel(this, keypath).model, add);\n  }\n\n  sort(keypath) {\n    return modelSort(findModel(this, keypath).model, []);\n  }\n\n  subtract(keypath, d, options) {\n    const num = isNumber(d) ? d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value - val];\n      }),\n      opts\n    );\n  }\n\n  toggle(keypath, options) {\n    const { model } = findModel(this, keypath);\n    return sharedSet([[model, !model.get()]], options);\n  }\n\n  unlink(dest) {\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    if (here.owner && here.owner._link) here.owner.unlink();\n    runloop.end();\n    return promise;\n  }\n\n  unlisten(event, handler) {\n    this.element.off(event, handler);\n  }\n\n  unshift(keypath, ...add) {\n    return modelUnshift(findModel(this, keypath).model, add);\n  }\n\n  update(keypath, options) {\n    return protoUpdate(this.ractive, findModel(this, keypath).model, options);\n  }\n\n  updateModel(keypath, cascade) {\n    const { model } = findModel(this, keypath);\n    const promise = runloop.start();\n    model.updateFromBindings(cascade);\n    runloop.end();\n    return promise;\n  }\n\n  // two-way binding related helpers\n  isBound() {\n    const { model } = this.getBindingModel(this);\n    return !!model;\n  }\n\n  getBindingPath(ractive) {\n    const { model, instance } = this.getBindingModel(this);\n    if (model) return model.getKeypath(ractive || instance);\n  }\n\n  getBinding() {\n    const { model } = this.getBindingModel(this);\n    if (model) return model.get(true);\n  }\n\n  getBindingModel(ctx) {\n    const el = ctx.element;\n    return { model: el.binding && el.binding.model, instance: el.up.ractive };\n  }\n\n  setBinding(value) {\n    const { model } = this.getBindingModel(this);\n    return sharedSet([[model, value]]);\n  }\n}\n\nContext.forRactive = getRactiveContext;\n// circular deps are fun\nextern.Context = Context;\n\n// TODO: at some point perhaps this could support relative * keypaths?\nfunction build(ctx, keypath, value) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push([findModel(ctx, k).model, keypath[k]]);\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push([findModel(ctx, keypath).model, value]);\n  }\n\n  return sets;\n}\n\nfunction findModel(ctx, path) {\n  const frag = ctx.fragment;\n\n  if (!isString(path)) {\n    return { model: frag.findContext(), instance: path };\n  }\n\n  return { model: resolveReference(frag, path), instance: frag.ractive };\n}\n\nfunction findEvent(el, name) {\n  return el.events && el.events.find && el.events.find(e => ~e.template.n.indexOf(name));\n}\n","import { doc } from 'config/environment';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { isString } from 'utils/is';\n\nconst query = doc && doc.querySelector;\n\nexport default function getContext(node) {\n  if (isString(node) && query) {\n    node = query.call(document, node);\n  }\n\n  let instances;\n  if (node) {\n    if (node._ractive) {\n      return node._ractive.proxy.getContext();\n    } else if ((instances = node.__ractive_instances__) && instances.length === 1) {\n      return getRactiveContext(instances[0]);\n    }\n  }\n}\n","import { isClient, svg, vendors, win, doc } from 'config/environment';\nimport { html } from 'config/namespaces';\nimport { isString, isNumber } from 'utils/is';\n\nlet createElement, matches, div, methodNames, unprefixed, prefixed, i, j, makeFunction;\n\n// Test for SVG support\nif (!svg) {\n  /* istanbul ignore next */\n  createElement = (type, ns, extend) => {\n    if (ns && ns !== html) {\n      throw \"This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you're trying to render SVG in an older browser. See http://ractive.js.org/support/#svgs for more information\";\n    }\n\n    return extend ? doc.createElement(type, extend) : doc.createElement(type);\n  };\n} else {\n  createElement = (type, ns, extend) => {\n    if (!ns || ns === html) {\n      return extend ? doc.createElement(type, extend) : doc.createElement(type);\n    }\n\n    return extend ? doc.createElementNS(ns, type, extend) : doc.createElementNS(ns, type);\n  };\n}\n\nexport function createDocumentFragment() {\n  return doc.createDocumentFragment();\n}\n\nfunction getElement(input) {\n  let output;\n\n  if (!input || typeof input === 'boolean') {\n    return;\n  }\n\n  /* istanbul ignore next */\n  if (!win || !doc || !input) {\n    return null;\n  }\n\n  // We already have a DOM node - no work to do. (Duck typing alert!)\n  if (input.nodeType) {\n    return input;\n  }\n\n  // Get node from string\n  if (isString(input)) {\n    // try ID first\n    output = doc.getElementById(input);\n\n    // then as selector, if possible\n    if (!output && doc.querySelector) {\n      try {\n        output = doc.querySelector(input);\n      } catch (e) {\n        /* this space intentionally left blank */\n      }\n    }\n\n    // did it work?\n    if (output && output.nodeType) {\n      return output;\n    }\n  }\n\n  // If we've been given a collection (jQuery, Zepto etc), extract the first item\n  if (input[0] && input[0].nodeType) {\n    return input[0];\n  }\n\n  return null;\n}\n\nif (!isClient) {\n  matches = null;\n} else {\n  div = createElement('div');\n  methodNames = ['matches', 'matchesSelector'];\n\n  makeFunction = function(methodName) {\n    return function(node, selector) {\n      return node[methodName](selector);\n    };\n  };\n\n  i = methodNames.length;\n\n  while (i-- && !matches) {\n    unprefixed = methodNames[i];\n\n    if (div[unprefixed]) {\n      matches = makeFunction(unprefixed);\n    } else {\n      j = vendors.length;\n      while (j--) {\n        prefixed = vendors[i] + unprefixed.substr(0, 1).toUpperCase() + unprefixed.substring(1);\n\n        if (div[prefixed]) {\n          matches = makeFunction(prefixed);\n          break;\n        }\n      }\n    }\n  }\n\n  // IE8... and apparently phantom some?\n  /* istanbul ignore next */\n  if (!matches) {\n    matches = function(node, selector) {\n      let parentNode, i;\n\n      parentNode = node.parentNode;\n\n      if (!parentNode) {\n        // empty dummy <div>\n        div.innerHTML = '';\n\n        parentNode = div;\n        node = node.cloneNode();\n\n        div.appendChild(node);\n      }\n\n      const nodes = parentNode.querySelectorAll(selector);\n\n      i = nodes.length;\n      while (i--) {\n        if (nodes[i] === node) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  }\n}\n\nfunction detachNode(node) {\n  // stupid ie\n  // eslint-disable-next-line valid-typeof\n  if (node && typeof node.parentNode !== 'unknown' && node.parentNode) {\n    node.parentNode.removeChild(node);\n  }\n\n  return node;\n}\n\nfunction safeToStringValue(value) {\n  return value == null || (isNumber(value) && isNaN(value)) || !value.toString ? '' : '' + value;\n}\n\nfunction safeAttributeString(string) {\n  return safeToStringValue(string)\n    .replace(/&/g, '&amp;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\nexport { createElement, detachNode, getElement, matches, safeToStringValue, safeAttributeString };\n","export const html = 'http://www.w3.org/1999/xhtml';\nexport const mathml = 'http://www.w3.org/1998/Math/MathML';\nexport const svg = 'http://www.w3.org/2000/svg';\nexport const xlink = 'http://www.w3.org/1999/xlink';\nexport const xml = 'http://www.w3.org/XML/1998/namespace';\nexport const xmlns = 'http://www.w3.org/2000/xmlns';\n\nexport default { html, mathml, svg, xlink, xml, xmlns };\n","import noop from 'utils/noop';\nimport { isFunction } from 'utils/is';\n\nexport default function wrap(parent, name, method) {\n  if (!/_super/.test(method)) return method;\n\n  function wrapper() {\n    const superMethod = getSuperMethod(wrapper._parent, name);\n    const hasSuper = '_super' in this;\n    const oldSuper = this._super;\n\n    this._super = superMethod;\n\n    const result = method.apply(this, arguments);\n\n    if (hasSuper) {\n      this._super = oldSuper;\n    } else {\n      delete this._super;\n    }\n\n    return result;\n  }\n\n  wrapper._parent = parent;\n  wrapper._method = method;\n\n  return wrapper;\n}\n\nfunction getSuperMethod(parent, name) {\n  if (name in parent) {\n    const value = parent[name];\n\n    return isFunction(value) ? value : () => value;\n  }\n\n  return noop;\n}\n","import { warnIfDebug } from 'utils/log';\nimport { isArray } from 'utils/is';\n\nfunction getMessage(deprecated, correct, isError) {\n  return (\n    `options.${deprecated} has been deprecated in favour of options.${correct}.` +\n    (isError ? ` You cannot specify both options, please use options.${correct}.` : '')\n  );\n}\n\nfunction deprecateOption(options, deprecatedOption, correct) {\n  if (deprecatedOption in options) {\n    if (!(correct in options)) {\n      warnIfDebug(getMessage(deprecatedOption, correct));\n      options[correct] = options[deprecatedOption];\n    } else {\n      throw new Error(getMessage(deprecatedOption, correct, true));\n    }\n  }\n}\n\nexport default function deprecate(options) {\n  deprecateOption(options, 'beforeInit', 'onconstruct');\n  deprecateOption(options, 'init', 'onrender');\n  deprecateOption(options, 'complete', 'oncomplete');\n  deprecateOption(options, 'eventDefinitions', 'events');\n\n  // Using extend with Component instead of options,\n  // like Human.extend( Spider ) means adaptors as a registry\n  // gets copied to options. So we have to check if actually an array\n  if (isArray(options.adaptors)) {\n    deprecateOption(options, 'adaptors', 'adapt');\n  }\n}\n","import resolveReference from './resolveReference';\nimport ExpressionProxy from './ExpressionProxy';\nimport ReferenceExpressionProxy from './ReferenceExpressionProxy';\n\nexport default function resolve(fragment, template) {\n  if (template.r) {\n    return resolveReference(fragment, template.r);\n  } else if (template.x) {\n    return new ExpressionProxy(fragment, template.x);\n  } else if (template.rx) {\n    return new ReferenceExpressionProxy(fragment, template.rx);\n  }\n}\n","export default function(camelCaseStr) {\n  return camelCaseStr.replace(/([A-Z])/g, (match, $1) => {\n    return '-' + $1.toLowerCase();\n  });\n}\n","import hooks from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\nimport { cancel } from 'shared/methodCallers';\nimport { warnIfDebug } from 'utils/log';\n\n// Teardown. This goes through the root fragment and all its children, removing observers\n// and generally cleaning up after itself\n\nexport default function Ractive$teardown() {\n  if (this.torndown) {\n    warnIfDebug('ractive.teardown() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  this.shouldDestroy = true;\n  return teardown(this, () => (this.fragment.rendered ? this.unrender() : Promise.resolve()));\n}\n\nexport function teardown(instance, getPromise) {\n  instance.torndown = true;\n  instance.fragment.unbind();\n  instance._observers.slice().forEach(cancel);\n\n  if (instance.el && instance.el.__ractive_instances__) {\n    removeFromArray(instance.el.__ractive_instances__, instance);\n  }\n\n  const promise = getPromise();\n\n  hooks.teardown.fire(instance);\n\n  promise.then(() => {\n    hooks.destruct.fire(instance);\n    instance.viewmodel.teardown();\n  });\n\n  return promise;\n}\n","import { create, toPairs } from 'utils/object';\nimport { isFunction, isObjectType } from 'utils/is';\n\nexport default function subscribe(instance, options, type) {\n  const subs = (instance.constructor[`_${type}`] || []).concat(toPairs(options[type] || []));\n  const single = type === 'on' ? 'once' : `${type}Once`;\n\n  subs.forEach(([target, config]) => {\n    if (isFunction(config)) {\n      instance[type](target, config);\n    } else if (isObjectType(config) && isFunction(config.handler)) {\n      instance[config.once ? single : type](target, config.handler, create(config));\n    }\n  });\n}\n","import getFunction from 'shared/getFunction';\nimport resolveReference from '../../resolvers/resolveReference';\n\nexport function setupArgsFn(item, template, fragment, opts = {}) {\n  if (template && template.f && template.f.s) {\n    item.fn = getFunction(template.f.s, template.f.r.length);\n    if (opts.register === true) {\n      item.models = resolveArgs(item, template, fragment, opts);\n    }\n  }\n}\n\nexport function resolveArgs(item, template, fragment, opts = {}) {\n  return template.f.r.map((ref, i) => {\n    let model;\n\n    if (opts.specialRef && (model = opts.specialRef(ref, i))) return model;\n\n    model = resolveReference(fragment, ref);\n    if (opts.register === true) {\n      model.register(item);\n    }\n\n    return model;\n  });\n}\n\nexport function teardownArgsFn(item, template) {\n  if (template && template.f && template.f.s) {\n    if (item.models)\n      item.models.forEach(m => {\n        if (m && m.unregister) m.unregister(item);\n      });\n    item.models = null;\n  }\n}\n","// This is the handler for DOM events that would lead to a change in the model\n// (i.e. change, sometimes, input, and occasionally click and keyup)\nexport default function handleDomEvent() {\n  this._ractive.binding.handleChange();\n}\n","import { toArray } from './array';\n\nexport default function getSelectedOptions(select) {\n  /* istanbul ignore next */\n  return select.selectedOptions\n    ? toArray(select.selectedOptions)\n    : select.options\n      ? toArray(select.options).filter(option => option.selected)\n      : [];\n}\n","import { INTERPOLATOR, TRIPLE } from 'config/types';\nimport { warnIfDebug } from 'utils/log';\nimport CheckboxBinding from './CheckboxBinding';\nimport CheckboxNameBinding from './CheckboxNameBinding';\nimport ContentEditableBinding from './ContentEditableBinding';\nimport FileBinding from './FileBinding';\nimport GenericBinding from './GenericBinding';\nimport MultipleSelectBinding from './MultipleSelectBinding';\nimport NumericBinding from './NumericBinding';\nimport RadioBinding from './RadioBinding';\nimport RadioNameBinding from './RadioNameBinding';\nimport SingleSelectBinding from './SingleSelectBinding';\n\nexport function isBindable(attribute) {\n  // The fragment must be a single non-string fragment\n  if (\n    !attribute ||\n    !attribute.template.f ||\n    attribute.template.f.length !== 1 ||\n    attribute.template.f[0].s\n  )\n    return false;\n\n  // A binding is an interpolator `{{ }}`, yey.\n  if (attribute.template.f[0].t === INTERPOLATOR) return true;\n\n  // The above is probably the only true case. For the rest, show an appropriate\n  // warning before returning false.\n\n  // You can't bind a triple curly. HTML values on an attribute makes no sense.\n  if (attribute.template.f[0].t === TRIPLE)\n    warnIfDebug('It is not possible create a binding using a triple mustache.');\n\n  return false;\n}\n\nexport default function selectBinding(element) {\n  const name = element.name;\n  const attributes = element.attributeByName;\n  if (name !== 'input' && name !== 'textarea' && name !== 'select' && !attributes.contenteditable)\n    return;\n  const isBindableByValue = isBindable(attributes.value);\n  const isBindableByContentEditable = isBindable(attributes.contenteditable);\n  const isContentEditable = element.getAttribute('contenteditable');\n\n  // contenteditable\n  // Bind if the contenteditable is true or a binding that may become true.\n  if ((isContentEditable || isBindableByContentEditable) && isBindableByValue)\n    return ContentEditableBinding;\n\n  // <input>\n  if (name === 'input') {\n    const type = element.getAttribute('type');\n\n    if (type === 'radio') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // For radios we can either bind the name or checked, but not both.\n      // Name binding is handed instead.\n      if (isBindableByName && isBindableByChecked) {\n        warnIfDebug(\n          'A radio input can have two-way binding on its name attribute, or its checked attribute - not both',\n          { ractive: element.root }\n        );\n        return RadioNameBinding;\n      }\n\n      if (isBindableByName) return RadioNameBinding;\n\n      if (isBindableByChecked) return RadioBinding;\n\n      // Dead end. Unknown binding on radio input.\n      return null;\n    }\n\n    if (type === 'checkbox') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // A checkbox with bindings for both name and checked. Checked treated as\n      // the checkbox value, name is treated as a regular binding.\n      //\n      // See https://github.com/ractivejs/ractive/issues/1749\n      if (isBindableByName && isBindableByChecked) return CheckboxBinding;\n\n      if (isBindableByName) return CheckboxNameBinding;\n\n      if (isBindableByChecked) return CheckboxBinding;\n\n      // Dead end. Unknown binding on checkbox input.\n      return null;\n    }\n\n    if (type === 'file' && isBindableByValue) return FileBinding;\n\n    if (type === 'number' && isBindableByValue) return NumericBinding;\n\n    if (type === 'range' && isBindableByValue) return NumericBinding;\n\n    // Some input of unknown type (browser usually falls back to text).\n    if (isBindableByValue) return GenericBinding;\n\n    // Dead end. Some unknown input and an unbindable.\n    return null;\n  }\n\n  // <select>\n  if (name === 'select' && isBindableByValue) {\n    return element.getAttribute('multiple') ? MultipleSelectBinding : SingleSelectBinding;\n  }\n\n  // <textarea>\n  if (name === 'textarea' && isBindableByValue) return GenericBinding;\n\n  // Dead end. Some unbindable element.\n  return null;\n}\n","import { doc } from 'config/environment';\n\nexport default function progressiveText(item, target, occupants, text) {\n  if (occupants) {\n    let n = occupants[0];\n    if (n && n.nodeType === 3) {\n      const idx = n.nodeValue.indexOf(text);\n      occupants.shift();\n\n      if (idx === 0) {\n        if (n.nodeValue.length !== text.length) {\n          occupants.unshift(n.splitText(text.length));\n        }\n      } else {\n        n.nodeValue = text;\n      }\n    } else {\n      n = item.node = doc.createTextNode(text);\n      if (occupants[0]) {\n        target.insertBefore(n, occupants[0]);\n      } else {\n        target.appendChild(n);\n      }\n    }\n\n    item.node = n;\n  } else {\n    if (!item.node) item.node = doc.createTextNode(text);\n    target.appendChild(item.node);\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { fillGaps, hasOwn } from 'utils/object';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { findInstance } from 'shared/registry';\nimport { isArray, isFunction } from 'utils/is';\n\nexport default function getPartialTemplate(ractive, name, up) {\n  // If the partial in instance or view heirarchy instances, great\n  let partial = getPartialFromRegistry(ractive, name, up || {});\n  if (partial) return partial;\n\n  // Does it exist on the page as a script tag?\n  partial = parser.fromId(name, { noThrow: true });\n  if (partial) {\n    // parse and register to this ractive instance\n    const parsed = parser.parseFor(partial, ractive);\n\n    // register extra partials on the ractive instance if they don't already exist\n    if (parsed.p) fillGaps(ractive.partials, parsed.p);\n\n    // register (and return main partial if there are others in the template)\n    return (ractive.partials[name] = parsed.t);\n  }\n}\n\nfunction getPartialFromRegistry(ractive, name, up) {\n  // if there was an instance up-hierarchy, cool\n  let partial = findParentPartial(name, up.owner);\n  if (partial) return partial;\n\n  // find first instance in the ractive or view hierarchy that has this partial\n  const instance = findInstance('partials', ractive, name);\n\n  if (!instance) {\n    return;\n  }\n\n  partial = instance.partials[name];\n\n  // partial is a function?\n  let fn;\n  if (isFunction(partial)) {\n    fn = partial;\n    // super partial\n    if (fn.styleSet) return fn;\n\n    fn = partial.bind(instance);\n    fn.isOwner = hasOwn(instance.partials, name);\n    partial = fn.call(ractive, parser);\n  }\n\n  if (!partial && partial !== '') {\n    warnIfDebug(noRegistryFunctionReturn, name, 'partial', 'partial', {\n      ractive\n    });\n    return;\n  }\n\n  // If this was added manually to the registry,\n  // but hasn't been parsed, parse it now\n  if (!parser.isParsed(partial)) {\n    // use the parseOptions of the ractive instance on which it was found\n    const parsed = parser.parseFor(partial, instance);\n\n    // Partials cannot contain nested partials!\n    // TODO add a test for this\n    if (parsed.p) {\n      warnIfDebug('Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive });\n    }\n\n    // if fn, use instance to store result, otherwise needs to go\n    // in the correct point in prototype chain on instance or constructor\n    const target = fn ? instance : findOwner(instance, name);\n\n    // may be a template with partials, which need to be registered and main template extracted\n    target.partials[name] = partial = parsed.t;\n  }\n\n  // store for reset\n  if (fn) partial._fn = fn;\n\n  return partial.v ? partial.t : partial;\n}\n\nfunction findOwner(ractive, key) {\n  return hasOwn(ractive.partials, key) ? ractive : findConstructor(ractive.constructor, key);\n}\n\nfunction findConstructor(constructor, key) {\n  if (!constructor) {\n    return;\n  }\n  return hasOwn(constructor.partials, key) ? constructor : findConstructor(constructor.Parent, key);\n}\n\nfunction findParentPartial(name, parent) {\n  if (parent) {\n    if (\n      parent.template &&\n      parent.template.p &&\n      !isArray(parent.template.p) &&\n      hasOwn(parent.template.p, name)\n    ) {\n      return parent.template.p[name];\n    } else if (parent.up && parent.up.owner) {\n      return findParentPartial(name, parent.up.owner);\n    }\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { findInstance } from 'shared/registry';\nimport { hasOwn } from 'utils/object';\nimport { isString } from 'utils/is';\n\n// finds the component constructor in the registry or view hierarchy registries\nexport default function getComponentConstructor(ractive, name) {\n  const instance = findInstance('components', ractive, name);\n  let Component;\n\n  if (instance) {\n    Component = instance.components[name];\n\n    // if not from Ractive.extend or a Promise, it's a function that shold return a constructor\n    if (Component && !Component.isInstance && !Component.then) {\n      // function option, execute and store for reset\n      const fn = Component.bind(instance);\n      fn.isOwner = hasOwn(instance.components, name);\n      Component = fn();\n\n      if (!Component) {\n        warnIfDebug(noRegistryFunctionReturn, name, 'component', 'component', {\n          ractive\n        });\n        return;\n      }\n\n      if (isString(Component)) {\n        // allow string lookup\n        Component = getComponentConstructor(ractive, Component);\n      }\n\n      Component._fn = fn;\n      instance.components[name] = Component;\n    }\n  }\n\n  return Component;\n}\n","import Partial from './Partial';\nimport { ELEMENT } from 'config/types';\nimport { assign } from 'utils/object';\n\nexport default function asyncProxy(promise, options) {\n  const partials = options.template.p || {};\n  const name = options.template.e;\n\n  const opts = assign({}, options, {\n    template: { t: ELEMENT, e: name },\n    macro(handle) {\n      handle.setTemplate(partials['async-loading'] || []);\n      promise.then(\n        cmp => {\n          options.up.ractive.components[name] = cmp;\n          if (partials['async-loaded']) {\n            handle.partials.component = [options.template];\n            handle.setTemplate(partials['async-loaded']);\n          } else {\n            handle.setTemplate([options.template]);\n          }\n        },\n        err => {\n          if (partials['async-failed']) {\n            handle.aliasLocal('error', 'error');\n            handle.set('@local.error', err);\n            handle.setTemplate(partials['async-failed']);\n          } else {\n            handle.setTemplate([]);\n          }\n        }\n      );\n    }\n  });\n  return new Partial(opts);\n}\n","import { ATTRIBUTE, CATCH, ELEMENT, ELSE, INTERPOLATOR, SECTION, THEN } from 'src/config/types';\nimport Partial from './Partial';\nimport { assign } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nfunction extract(tpl, type, name) {\n  const p = tpl.f.find(s => s.t === type);\n  if (p) {\n    if (p.n)\n      return [\n        {\n          t: 19,\n          n: 54,\n          f: p.f || [],\n          z: [{ n: p.n, x: { r: `__await.${name}` } }]\n        }\n      ];\n    else return p.f || [];\n  } else return [];\n}\n\nexport default function Await(options) {\n  const tpl = options.template;\n\n  const success = extract(tpl, THEN, 'value');\n  const error = extract(tpl, CATCH, 'error');\n  const pending = extract(tpl, SECTION);\n  const undef = extract(tpl, ELSE);\n\n  const opts = assign({}, options, {\n    template: {\n      t: ELEMENT,\n      m: [\n        {\n          t: ATTRIBUTE,\n          n: 'for',\n          f: [{ t: INTERPOLATOR, r: tpl.r, rx: tpl.rx, x: tpl.x }]\n        }\n      ]\n    },\n    macro(handle, attrs) {\n      handle.aliasLocal('__await');\n\n      function update(attrs) {\n        if (attrs.for && isFunction(attrs.for.then)) {\n          handle.setTemplate(pending);\n\n          attrs.for.then(\n            v => {\n              handle.set('@local.value', v);\n              handle.setTemplate(success);\n            },\n            e => {\n              handle.set('@local.error', e);\n              handle.setTemplate(error);\n            }\n          );\n        } else if (attrs.for === undefined) {\n          handle.setTemplate(undef);\n        } else {\n          handle.set('@local.value', attrs.for);\n          handle.setTemplate(success);\n        }\n      }\n\n      update(attrs);\n\n      return {\n        update\n      };\n    }\n  });\n\n  opts.macro.attributes = ['for'];\n\n  return new Partial(opts);\n}\n","import { TEXT } from 'config/types';\n\n// TODO all this code needs to die\nexport default function processItems(items, values, guid, counter = 0) {\n  return items\n    .map(item => {\n      if (item.type === TEXT) {\n        return item.template;\n      }\n\n      if (item.fragment) {\n        if (item.fragment.iterations) {\n          return item.fragment.iterations\n            .map(fragment => {\n              return processItems(fragment.items, values, guid, counter);\n            })\n            .join('');\n        } else {\n          return processItems(item.fragment.items, values, guid, counter);\n        }\n      }\n\n      const placeholderId = `${guid}-${counter++}`;\n      const model = item.model || item.newModel;\n\n      values[placeholderId] = model\n        ? model.wrapper\n          ? model.wrapperValue\n          : model.get()\n        : undefined;\n\n      return '${' + placeholderId + '}';\n    })\n    .join('');\n}\n","import { logIfDebug, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport { isArray } from 'utils/is';\nimport config from './config/config';\nimport Fragment from 'src/view/Fragment';\nimport hooks from 'src/events/Hook';\nimport Ractive from '../Ractive';\nimport subscribe from './helpers/subscribe';\n\nexport default function initialise(ractive, userOptions, options) {\n  // initialize settable computeds\n  const computed = ractive.viewmodel.computed;\n  if (computed) {\n    for (const k in computed) {\n      if (k in ractive.viewmodel.value && computed[k] && !computed[k].isReadonly) {\n        computed[k].set(ractive.viewmodel.value[k]);\n      }\n    }\n  }\n\n  // init config from Parent and options\n  config.init(ractive.constructor, ractive, userOptions);\n\n  hooks.config.fire(ractive);\n\n  hooks.init.begin(ractive);\n\n  const fragment = (ractive.fragment = createFragment(ractive, options));\n  if (fragment) fragment.bind(ractive.viewmodel);\n\n  hooks.init.end(ractive);\n\n  // general config done, set up observers\n  subscribe(ractive, userOptions, 'observe');\n\n  // call any passed in plugins\n  if (isArray(userOptions.use))\n    ractive.use.apply(ractive, userOptions.use.filter(p => !p.construct));\n\n  if (fragment) {\n    // render automatically ( if `el` is specified )\n    const el = (ractive.el = ractive.target = getElement(ractive.el || ractive.target));\n    if (el && !ractive.component) {\n      const promise = ractive.render(el, ractive.append);\n\n      if (Ractive.DEBUG_PROMISES) {\n        promise.catch(err => {\n          warnOnceIfDebug(\n            'Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;'\n          );\n          warnIfDebug('An error happened during rendering', { ractive });\n          logIfDebug(err);\n\n          throw err;\n        });\n      }\n    }\n  }\n}\n\nexport function createFragment(ractive, options = {}) {\n  if (ractive.template) {\n    const cssIds = [].concat(ractive.constructor._cssIds || [], options.cssIds || []);\n\n    return new Fragment({\n      owner: ractive,\n      template: ractive.template,\n      cssIds\n    });\n  }\n}\n","import { doc } from 'config/environment';\nimport { applyCSS } from 'src/global/css';\nimport hooks from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport { createFragment } from './initialise';\n\nexport default function render(ractive, target, anchor, occupants) {\n  // set a flag to let any transitions know that this instance is currently rendering\n  ractive.rendering = true;\n\n  const promise = runloop.start();\n  runloop.scheduleTask(() => hooks.render.fire(ractive), true);\n\n  if (ractive.fragment.rendered) {\n    throw new Error(\n      'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first'\n    );\n  }\n\n  if (ractive.destroyed) {\n    ractive.destroyed = false;\n    ractive.fragment = createFragment(ractive).bind(ractive.viewmodel);\n  }\n\n  anchor = getElement(anchor) || ractive.anchor;\n\n  ractive.el = ractive.target = target;\n  ractive.anchor = anchor;\n\n  // ensure encapsulated CSS is up-to-date\n  if (ractive.cssId) applyCSS();\n\n  if (target) {\n    (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(ractive);\n\n    if (anchor) {\n      const docFrag = doc.createDocumentFragment();\n      ractive.fragment.render(docFrag);\n      target.insertBefore(docFrag, anchor);\n    } else {\n      ractive.fragment.render(target, occupants);\n    }\n  }\n\n  runloop.end();\n  ractive.rendering = false;\n\n  return promise.then(() => {\n    if (ractive.torndown) return;\n\n    hooks.complete.fire(ractive);\n  });\n}\n","import { getElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport { warnIfDebug } from 'utils/log';\nimport render from '../render';\nimport { teardown } from 'shared/methodCallers';\n\nexport default function Ractive$render(target, anchor) {\n  if (this.torndown) {\n    warnIfDebug('ractive.render() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  target = getElement(target) || this.el;\n\n  if (!this.append && target) {\n    // Teardown any existing instances *before* trying to set up the new one -\n    // avoids certain weird bugs\n    const others = target.__ractive_instances__;\n    if (others) others.forEach(teardown);\n\n    // make sure we are the only occupants\n    if (!this.enhance) {\n      target.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n    }\n  }\n\n  const occupants = this.enhance ? toArray(target.childNodes) : null;\n  const promise = render(this, target, anchor, occupants);\n\n  if (occupants) {\n    while (occupants.length) target.removeChild(occupants.pop());\n  }\n\n  return promise;\n}\n","import runloop from 'src/global/runloop';\nimport { PARTIAL, COMPONENT, ELEMENT } from 'config/types';\nimport { isArray } from 'utils/is';\nimport { handleChange } from 'shared/methodCallers';\n\nfunction collect(source, name, attr, dest) {\n  source.forEach(item => {\n    // queue to rerender if the item is a partial and the current name matches\n    if (item.type === PARTIAL && (item.refName === name || item.name === name)) {\n      item.inAttribute = attr;\n      dest.push(item);\n      return; // go no further\n    }\n\n    // if it has a fragment, process its items\n    if (item.fragment) {\n      collect(item.fragment.iterations || item.fragment.items, name, attr, dest);\n    } else if (isArray(item.items)) {\n      // or if it is itself a fragment, process its items\n      collect(item.items, name, attr, dest);\n    } else if (item.type === COMPONENT && item.instance) {\n      // or if it is a component, step in and process its items\n      // ...unless the partial is shadowed\n      if (item.instance.partials[name]) return;\n      collect(item.instance.fragment.items, name, attr, dest);\n    }\n\n    // if the item is an element, process its attributes too\n    if (item.type === ELEMENT) {\n      if (isArray(item.attributes)) {\n        collect(item.attributes, name, true, dest);\n      }\n    }\n  });\n}\n\nexport default function(name, partial) {\n  const collection = [];\n  collect(this.fragment.items, name, false, collection);\n\n  const promise = runloop.start();\n\n  this.partials[name] = partial;\n  collection.forEach(handleChange);\n\n  runloop.end();\n\n  return promise;\n}\n","import { createDocumentFragment } from 'utils/dom';\nimport Fragment from 'src/view/Fragment';\nimport runloop from 'src/global/runloop';\nimport { default as templateConfigurator } from '../config/custom/template';\n\n// TODO should resetTemplate be asynchronous? i.e. should it be a case\n// of outro, update template, intro? I reckon probably not, since that\n// could be achieved with unrender-resetTemplate-render. Also, it should\n// conceptually be similar to resetPartial, which couldn't be async\n\nexport default function Ractive$resetTemplate(template) {\n  templateConfigurator.init(null, this, { template });\n\n  const transitionsEnabled = this.transitionsEnabled;\n  this.transitionsEnabled = false;\n\n  // Is this is a component, we need to set the `shouldDestroy`\n  // flag, otherwise it will assume by default that a parent node\n  // will be detached, and therefore it doesn't need to bother\n  // detaching its own nodes\n  const component = this.component;\n  if (component) component.shouldDestroy = true;\n  this.unrender();\n  if (component) component.shouldDestroy = false;\n\n  const promise = runloop.start();\n\n  // remove existing fragment and create new one\n  this.fragment.unbind().unrender(true);\n\n  this.fragment = new Fragment({\n    template: this.template,\n    root: this,\n    owner: this\n  });\n\n  const docFrag = createDocumentFragment();\n  this.fragment.bind(this.viewmodel).render(docFrag);\n\n  // if this is a component, its el may not be valid, so find a\n  // target based on the component container\n  if (component && !component.external) {\n    this.fragment.findParentNode().insertBefore(docFrag, component.findNextNode());\n  } else {\n    this.el.insertBefore(docFrag, this.anchor);\n  }\n\n  runloop.end();\n\n  this.transitionsEnabled = transitionsEnabled;\n\n  return promise;\n}\n","import { build, set } from 'shared/set';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$set(keypath, value, options) {\n  const ractive = this;\n\n  const opts = isObjectType(keypath) ? value : options;\n\n  return set(build(ractive, keypath, value, opts && opts.isolated), opts);\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$subtract(keypath, d, options) {\n  const num = isNumber(d) ? -d : -1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","import { badArguments } from 'config/errors';\nimport { gather, set } from 'shared/set';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$toggle(keypath, options) {\n  if (!isString(keypath)) {\n    throw new TypeError(badArguments);\n  }\n\n  return set(\n    gather(this, keypath, null, options && options.isolated).map(m => [m, !m.get()]),\n    options\n  );\n}\n","import { getCSS } from 'src/global/css';\nimport { keys } from 'utils/object';\n\nexport default function Ractive$toCSS() {\n  const cssIds = [this.cssId, ...this.findAllComponents().map(c => c.cssId)];\n  const uniqueCssIds = keys(cssIds.reduce((ids, id) => ((ids[id] = true), ids), {}));\n  return getCSS(uniqueCssIds);\n}\n","export default function Ractive$toHTML() {\n  return this.fragment.toString(true);\n}\n","export default function toText() {\n  return this.fragment.toString(false);\n}\n","import runloop from 'src/global/runloop';\nimport Transition from '../../view/items/element/Transition';\nimport { fatal } from 'utils/log';\nimport { isObject } from 'utils/is';\n\nexport default function Ractive$transition(name, node, params) {\n  if (node instanceof HTMLElement) {\n    // good to go\n  } else if (isObject(node)) {\n    // omitted, use event node\n    params = node;\n  }\n\n  // if we allow query selector, then it won't work\n  // simple params like \"fast\"\n\n  // else if ( typeof node === 'string' ) {\n  // \t// query selector\n  // \tnode = this.find( node )\n  // }\n\n  node = node || this.event.node;\n\n  if (!node || !node._ractive) {\n    fatal(`No node was supplied for transition ${name}`);\n  }\n\n  params = params || {};\n  const owner = node._ractive.proxy;\n  const transition = new Transition({ owner, up: owner.up, name, params });\n  transition.bind();\n\n  const promise = runloop.start();\n  runloop.registerTransition(transition);\n  runloop.end();\n\n  promise.then(() => transition.unbind());\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function unlink(here) {\n  const promise = runloop.start();\n  this.viewmodel.joinAll(splitKeypath(here), { lastLink: false }).unlink();\n  runloop.end();\n  return promise;\n}\n","import hooks from 'src/events/Hook';\nimport { warnIfDebug } from 'utils/log';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\n\nexport default function Ractive$unrender() {\n  if (!this.fragment.rendered) {\n    warnIfDebug('ractive.unrender() was called on a Ractive instance that was not rendered');\n    return Promise.resolve();\n  }\n\n  this.unrendering = true;\n  const promise = runloop.start();\n\n  hooks.unrendering.fire(this);\n\n  // If this is a component, and the component isn't marked for destruction,\n  // don't detach nodes from the DOM unnecessarily\n  const shouldDestroy =\n    !this.component ||\n    (this.component.anchor || {}).shouldDestroy ||\n    this.component.shouldDestroy ||\n    this.shouldDestroy;\n  this.fragment.unrender(shouldDestroy);\n  if (shouldDestroy) this.destroyed = true;\n\n  removeFromArray(this.el.__ractive_instances__, this);\n\n  hooks.unrender.fire(this);\n\n  runloop.end();\n  this.unrendering = false;\n\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function Ractive$updateModel(keypath, cascade) {\n  const promise = runloop.start();\n\n  if (!keypath) {\n    this.viewmodel.updateFromBindings(true);\n  } else {\n    this.viewmodel.joinAll(splitKeypath(keypath)).updateFromBindings(cascade !== false);\n  }\n\n  runloop.end();\n\n  return promise;\n}\n","export default function use(...plugins) {\n  plugins.forEach(p => {\n    p({\n      proto: this,\n      Ractive: this.constructor.Ractive,\n      instance: this\n    });\n  });\n  return this;\n}\n","export default function isInstance(object) {\n  return object && object instanceof this;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function styleGet(keypath) {\n  return this._cssModel.joinAll(splitKeypath(keypath)).get();\n}\n","export default function() {}\n","export function findInViewHierarchy(registryName, ractive, name) {\n  const instance = findInstance(registryName, ractive, name);\n  return instance ? instance[registryName][name] : null;\n}\n\nexport function findInstance(registryName, ractive, name) {\n  while (ractive) {\n    if (name in ractive[registryName]) {\n      return ractive;\n    }\n\n    if (ractive.isolated) {\n      return null;\n    }\n\n    ractive = ractive.parent;\n  }\n}\n","import { fatal } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport interpolators from '../Ractive/static/interpolators';\nimport { findInViewHierarchy } from './registry';\n\nexport default function interpolate(from, to, ractive, type) {\n  if (from === to) return null;\n\n  if (type) {\n    const interpol = findInViewHierarchy('interpolators', ractive, type);\n    if (interpol) return interpol(from, to) || null;\n\n    fatal(missingPlugin(type, 'interpolator'));\n  }\n\n  return (\n    interpolators.number(from, to) ||\n    interpolators.array(from, to) ||\n    interpolators.object(from, to) ||\n    null\n  );\n}\n","import { isArray, isString } from './is';\n\nexport function addToArray(array, value) {\n  const index = array.indexOf(value);\n\n  if (index === -1) {\n    array.push(value);\n  }\n}\n\nexport function arrayContains(array, value) {\n  for (let i = 0, c = array.length; i < c; i++) {\n    if (array[i] == value) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function arrayContentsMatch(a, b) {\n  let i;\n\n  if (!isArray(a) || !isArray(b)) {\n    return false;\n  }\n\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  i = a.length;\n  while (i--) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function ensureArray(x) {\n  if (isString(x)) {\n    return [x];\n  }\n\n  if (x === undefined) {\n    return [];\n  }\n\n  return x;\n}\n\nexport function lastItem(array) {\n  return array[array.length - 1];\n}\n\nexport function removeFromArray(array, member) {\n  if (!array) {\n    return;\n  }\n\n  const index = array.indexOf(member);\n\n  if (index !== -1) {\n    array.splice(index, 1);\n  }\n}\n\nexport function combine(...arrays) {\n  const res = arrays.concat.apply([], arrays);\n  let i = res.length;\n  while (i--) {\n    const idx = res.indexOf(res[i]);\n    if (~idx && idx < i) res.splice(i, 1);\n  }\n\n  return res;\n}\n\nexport function toArray(arrayLike) {\n  const array = [];\n  let i = arrayLike.length;\n  while (i--) {\n    array[i] = arrayLike[i];\n  }\n\n  return array;\n}\n\nexport function findMap(array, fn) {\n  const len = array.length;\n  for (let i = 0; i < len; i++) {\n    const result = fn(array[i]);\n    if (result) return result;\n  }\n}\n\nexport function buildNewIndices(one, two, comparator) {\n  let oldArray = one;\n  let newArray = two;\n  if (comparator) {\n    oldArray = oldArray.map(comparator);\n    newArray = newArray.map(comparator);\n  }\n\n  const oldLength = oldArray.length;\n\n  const usedIndices = {};\n  let firstUnusedIndex = 0;\n\n  return oldArray.map(item => {\n    let index;\n    let start = firstUnusedIndex;\n\n    do {\n      index = newArray.indexOf(item, start);\n\n      if (index === -1) {\n        return -1;\n      }\n\n      start = index + 1;\n    } while (usedIndices[index] === true && start < oldLength);\n\n    // keep track of the first unused index, so we don't search\n    // the whole of newArray for each item in oldArray unnecessarily\n    if (index === firstUnusedIndex) {\n      firstUnusedIndex += 1;\n    }\n    // allow next instance of next \"equal\" to be found item\n    usedIndices[index] = true;\n    return index;\n  });\n}\n","export function bind(x) {\n  x.bind();\n}\nexport function cancel(x) {\n  x.cancel();\n}\nexport function destroyed(x) {\n  x.destroyed();\n}\nexport function handleChange(x) {\n  x.handleChange();\n}\nexport function mark(x) {\n  x.mark();\n}\nexport function markForce(x) {\n  x.mark(true);\n}\nexport function marked(x) {\n  x.marked();\n}\nexport function markedAll(x) {\n  x.markedAll();\n}\nexport function render(x) {\n  x.render();\n}\nexport function shuffled(x) {\n  x.shuffled();\n}\nexport function teardown(x) {\n  x.teardown();\n}\nexport function unbind(x) {\n  x.unbind();\n}\nexport function unrender(x) {\n  x.unrender();\n}\nexport function unrenderAndDestroy(x) {\n  x.unrender(true);\n}\nexport function update(x) {\n  x.update();\n}\nexport function toString(x) {\n  return x.toString();\n}\nexport function toEscapedString(x) {\n  return x.toString(true);\n}\n","import { splitKeypath } from './keypaths';\nimport { isString } from 'utils/is';\n\n// this is the dry method of checking to see if a rebind applies to\n// a particular keypath because in some cases, a dep may be bound\n// directly to a particular keypath e.g. foo.bars.0.baz and need\n// to avoid getting kicked to foo.bars.1.baz if foo.bars is unshifted\nexport function rebindMatch(template, next, previous, fragment) {\n  const keypath = template.r || template;\n\n  // no valid keypath, go with next\n  if (!keypath || !isString(keypath)) return next;\n\n  // completely contextual ref, go with next\n  if (\n    keypath === '.' ||\n    keypath[0] === '@' ||\n    (next || previous).isKey ||\n    (next || previous).isKeypath\n  )\n    return next;\n\n  const parts = keypath.split('/');\n  let keys = splitKeypath(parts[parts.length - 1]);\n  const last = keys[keys.length - 1];\n\n  // check the keypath against the model keypath to see if it matches\n  let model = next || previous;\n\n  // check to see if this was an alias\n  if (model && keys.length === 1 && last !== model.key && fragment) {\n    keys = findAlias(last, fragment) || keys;\n  }\n\n  let i = keys.length;\n  let match = true;\n  let shuffling = false;\n\n  while (model && i--) {\n    if (model.shuffling) shuffling = true;\n    // non-strict comparison to account for indices in keypaths\n    if (keys[i] != model.key) match = false;\n    model = model.parent;\n  }\n\n  // next is undefined, but keypath is shuffling and previous matches\n  if (!next && match && shuffling) return previous;\n  else if (next && !match && shuffling)\n    // next is defined, but doesn't match the keypath\n    return previous;\n  else return next;\n}\n\nfunction findAlias(name, fragment) {\n  while (fragment) {\n    const z = fragment.aliases;\n    if (z && z[name]) {\n      const aliases = (fragment.owner.iterations ? fragment.owner : fragment).owner.template.z;\n      for (let i = 0; i < aliases.length; i++) {\n        if (aliases[i].n === name) {\n          const alias = aliases[i].x;\n          if (!alias.r) return false;\n          const parts = alias.r.split('/');\n          return splitKeypath(parts[parts.length - 1]);\n        }\n      }\n      return;\n    }\n\n    fragment = fragment.componentParent || fragment.parent;\n  }\n}\n","export function fromExpression(body, length = 0) {\n  const args = new Array(length);\n\n  while (length--) {\n    args[length] = `_${length}`;\n  }\n\n  // Functions created directly with new Function() look like this:\n  //     function anonymous (_0 /**/) { return _0*2 }\n  //\n  // With this workaround, we get a little more compact:\n  //     function (_0){return _0*2}\n  return new Function([], `return function (${args.join(',')}){return(${body});};`)();\n}\n","import { fatal } from 'utils/log';\nimport bind from 'utils/bind';\nimport { createFunctionFromString } from '../config/runtime-parser';\nimport { isFunction, isString, isObjectType } from 'utils/is';\n\nexport default function getComputationSignature(ractive, key, signature) {\n  let getter;\n  let setter;\n\n  // useful for debugging\n  let getterString;\n  let getterUseStack;\n  let setterString;\n\n  if (isFunction(signature)) {\n    getter = bind(signature, ractive);\n    getterString = signature.toString();\n    getterUseStack = true;\n  }\n\n  if (isString(signature)) {\n    getter = createFunctionFromString(signature, ractive);\n    getterString = signature;\n  }\n\n  if (isObjectType(signature)) {\n    if (isString(signature.get)) {\n      getter = createFunctionFromString(signature.get, ractive);\n      getterString = signature.get;\n    } else if (isFunction(signature.get)) {\n      getter = bind(signature.get, ractive);\n      getterString = signature.get.toString();\n      getterUseStack = true;\n    } else {\n      fatal('`%s` computation must have a `get()` method', key);\n    }\n\n    if (isFunction(signature.set)) {\n      setter = bind(signature.set, ractive);\n      setterString = signature.set.toString();\n    }\n  }\n\n  return {\n    getter,\n    setter,\n    getterString,\n    setterString,\n    getterUseStack\n  };\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$add(keypath, d, options) {\n  const num = isNumber(d) ? d : 1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","export function enqueue(ractive, event) {\n  if (ractive.event) {\n    ractive._eventQueue.push(ractive.event);\n  }\n\n  ractive.event = event;\n}\n\nexport function dequeue(ractive) {\n  if (ractive._eventQueue.length) {\n    ractive.event = ractive._eventQueue.pop();\n  } else {\n    ractive.event = null;\n  }\n}\n","export function findAnchors(fragment, name = null) {\n  const res = [];\n\n  findAnchorsIn(fragment, name, res);\n\n  return res;\n}\n\nfunction findAnchorsIn(item, name, result) {\n  if (item.isAnchor) {\n    if (!name || item.name === name) {\n      result.push(item);\n    }\n  } else if (item.items) {\n    item.items.forEach(i => findAnchorsIn(i, name, result));\n  } else if (item.iterations) {\n    item.iterations.forEach(i => findAnchorsIn(i, name, result));\n  } else if (item.fragment && !item.component) {\n    findAnchorsIn(item.fragment, name, result);\n  }\n}\n\nexport function updateAnchors(instance, name = null) {\n  const anchors = findAnchors(instance.fragment, name);\n  const idxs = {};\n  const children = instance._children.byName;\n\n  anchors.forEach(a => {\n    const name = a.name;\n    if (!(name in idxs)) idxs[name] = 0;\n    const idx = idxs[name];\n    const child = (children[name] || [])[idx];\n\n    if (child && child.lastBound !== a) {\n      if (child.lastBound) child.lastBound.removeChild(child);\n      a.addChild(child);\n    }\n\n    idxs[name]++;\n  });\n}\n\nexport function unrenderChild(meta) {\n  if (meta.instance.fragment.rendered) {\n    meta.shouldDestroy = true;\n    meta.instance.unrender();\n  }\n  meta.instance.el = null;\n}\n","import hooks from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { unrenderChild, updateAnchors } from 'shared/anchors';\n\nexport default function attachChild(child, options = {}) {\n  const children = this._children;\n  let idx;\n\n  if (child.parent && child.parent !== this)\n    throw new Error(\n      `Instance ${child._guid} is already attached to a different instance ${\n        child.parent._guid\n      }. Please detach it from the other instance using detachChild first.`\n    );\n  else if (child.parent)\n    throw new Error(`Instance ${child._guid} is already attached to this instance.`);\n\n  const meta = {\n    instance: child,\n    ractive: this,\n    name: options.name || child.constructor.name || 'Ractive',\n    target: options.target || false,\n    bubble,\n    findNextNode\n  };\n  meta.nameOption = options.name;\n\n  // child is managing itself\n  if (!meta.target) {\n    meta.up = this.fragment;\n    meta.external = true;\n  } else {\n    let list;\n    if (!(list = children.byName[meta.target])) {\n      list = [];\n      this.set(`@this.children.byName.${meta.target}`, list);\n    }\n    idx = options.prepend ? 0 : options.insertAt !== undefined ? options.insertAt : list.length;\n  }\n\n  child.parent = this;\n  child.root = this.root;\n  child.component = meta;\n  children.push(meta);\n\n  const promise = runloop.start();\n\n  const rm = child.viewmodel.getRactiveModel();\n  rm.joinKey('parent', { lastLink: false }).link(this.viewmodel.getRactiveModel());\n  rm.joinKey('root', { lastLink: false }).link(this.root.viewmodel.getRactiveModel());\n\n  hooks.attachchild.fire(child);\n\n  if (meta.target) {\n    unrenderChild(meta);\n    this.splice(`@this.children.byName.${meta.target}`, idx, 0, meta);\n    updateAnchors(this, meta.target);\n  } else {\n    if (!child.isolated) child.viewmodel.attached(this.fragment);\n  }\n\n  runloop.end();\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n\nfunction bubble() {\n  runloop.addFragment(this.instance.fragment);\n}\n\nfunction findNextNode() {\n  if (this.anchor) return this.anchor.findNextNode();\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport { isString, isFunction } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport { fireShuffleTasks } from 'src/model/ModelBase';\n\nexport function compute(path, computed) {\n  this.computed[path] = computed;\n  if (isString(computed) || isFunction(computed))\n    computed = this.computed[path] = { get: computed };\n\n  const keys = splitKeypath(path);\n  if (!~path.indexOf('*')) {\n    const last = keys.pop();\n    return this.viewmodel.joinAll(keys).compute(last, computed);\n  } else {\n    computed.pattern = new RegExp(\n      '^' +\n        keys\n          .map(k => k.replace(/\\*\\*/g, '(.+)').replace(/\\*/g, '((?:\\\\\\\\.|[^\\\\.])+)'))\n          .join('\\\\.') +\n        '$'\n    );\n  }\n}\n\nexport default function Ractive$compute(path, computed) {\n  const promise = runloop.start();\n  const comp = compute.call(this, path, computed);\n\n  if (comp) {\n    const keys = splitKeypath(path);\n    if (keys.length === 1 && !comp.isReadonly) {\n      comp.set(this.viewmodel.value[keys[0]]);\n    }\n\n    const first = keys.reduce((a, c) => a && a.childByKey[c], this.viewmodel);\n    if (first) {\n      first.rebind(comp, first, false);\n      if (first.parent) delete first.parent.childByKey[first.key];\n      fireShuffleTasks();\n    }\n  }\n\n  runloop.end();\n\n  return promise;\n}\n","import hooks from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\n\nexport default function Ractive$detach() {\n  if (this.isDetached) {\n    return this.el;\n  }\n\n  if (this.el) {\n    removeFromArray(this.el.__ractive_instances__, this);\n  }\n\n  this.el = this.fragment.detach();\n  this.isDetached = true;\n\n  hooks.detach.fire(this);\n  return this.el;\n}\n","import hooks from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\n\nexport default function detachChild(child) {\n  const children = this._children;\n  let meta, index;\n\n  let i = children.length;\n  while (i--) {\n    if (children[i].instance === child) {\n      index = i;\n      meta = children[i];\n      break;\n    }\n  }\n\n  if (!meta || child.parent !== this)\n    throw new Error(`Instance ${child._guid} is not attached to this instance.`);\n\n  const promise = runloop.start();\n\n  if (meta.anchor) meta.anchor.removeChild(meta);\n  if (!child.isolated) child.viewmodel.detached();\n\n  children.splice(index, 1);\n  if (meta.target) {\n    this.splice(\n      `@this.children.byName.${meta.target}`,\n      children.byName[meta.target].indexOf(meta),\n      1\n    );\n    updateAnchors(this, meta.target);\n  }\n  const rm = child.viewmodel.getRactiveModel();\n  rm.joinKey('parent', { lastLink: false }).unlink();\n  rm.joinKey('root', { lastLink: false }).link(rm);\n  child.root = child;\n  child.parent = null;\n  child.component = null;\n\n  hooks.detachchild.fire(child);\n\n  runloop.end();\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n","export default function Ractive$find(selector, options = {}) {\n  if (!this.rendered)\n    throw new Error(\n      `Cannot call ractive.find('${selector}') unless instance is rendered to the DOM`\n    );\n\n  let node = this.fragment.find(selector, options);\n  if (node) return node;\n\n  if (options.remote) {\n    for (let i = 0; i < this._children.length; i++) {\n      if (!this._children[i].instance.fragment.rendered) continue;\n      node = this._children[i].instance.find(selector, options);\n      if (node) return node;\n    }\n  }\n}\n","import { isArray } from 'utils/is';\n\nexport default function Ractive$findAll(selector, options = {}) {\n  if (!this.rendered)\n    throw new Error(\n      `Cannot call ractive.findAll('${selector}', ...) unless instance is rendered to the DOM`\n    );\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAll(selector, options);\n\n  if (options.remote) {\n    // seach non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        c.instance.findAll(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isArray, isObjectType } from 'utils/is';\n\nexport default function Ractive$findAllComponents(selector, options) {\n  if (!options && isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  options = options || {};\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAllComponents(selector, options);\n\n  if (options.remote) {\n    // search non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        if (!selector || c.name === selector) {\n          options.result.push(c.instance);\n        }\n\n        c.instance.findAllComponents(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isObjectType } from 'utils/is';\n\nexport default function Ractive$findComponent(selector, options = {}) {\n  if (isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  let child = this.fragment.findComponent(selector, options);\n  if (child) return child;\n\n  if (options.remote) {\n    if (!selector && this._children.length) return this._children[0].instance;\n    for (let i = 0; i < this._children.length; i++) {\n      // skip children that are or should be in an anchor\n      if (this._children[i].target) continue;\n      if (this._children[i].name === selector) return this._children[i].instance;\n      child = this._children[i].instance.findComponent(selector, options);\n      if (child) return child;\n    }\n  }\n}\n","export default function Ractive$findContainer(selector) {\n  if (this.container) {\n    if (this.container.component && this.container.component.name === selector) {\n      return this.container;\n    } else {\n      return this.container.findContainer(selector);\n    }\n  }\n\n  return null;\n}\n","export default function Ractive$findParent(selector) {\n  if (this.parent) {\n    if (this.parent.component && this.parent.component.name === selector) {\n      return this.parent;\n    } else {\n      return this.parent.findParent(selector);\n    }\n  }\n\n  return null;\n}\n","import { ANCHOR, COMPONENT, ELEMENT } from 'config/types';\n\nexport default function findElement(start, orComponent = true, name) {\n  while (\n    start &&\n    (start.type !== ELEMENT || (name && start.name !== name)) &&\n    (!orComponent || (start.type !== COMPONENT && start.type !== ANCHOR))\n  ) {\n    // start is a fragment - look at the owner\n    if (start.owner) start = start.owner;\n    else if (start.component)\n      // start is a component or yielder - look at the container\n      start = start.containerFragment || start.component.up;\n    else if (start.parent)\n      // start is an item - look at the parent\n      start = start.parent;\n    else if (start.up)\n      // start is an item without a parent - look at the parent fragment\n      start = start.up;\n    else start = undefined;\n  }\n\n  return start;\n}\n","import { isNumber } from 'utils/is';\n\n// This function takes an array, the name of a mutator method, and the\n// arguments to call that mutator method with, and returns an array that\n// maps the old indices to their new indices.\n\n// So if you had something like this...\n//\n//     array = [ 'a', 'b', 'c', 'd' ];\n//     array.push( 'e' );\n//\n// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n// have changed. If you then did this...\n//\n//     array.unshift( 'z' );\n//\n// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n// one higher to make room for the 'z'. If you removed an item, the new index\n// would be -1...\n//\n//     array.splice( 2, 2 );\n//\n// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n//\n// This information is used to enable fast, non-destructive shuffling of list\n// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\nexport default function getNewIndices(length, methodName, args) {\n  const newIndices = [];\n\n  const spliceArguments = getSpliceEquivalent(length, methodName, args);\n\n  if (!spliceArguments) {\n    return null; // TODO support reverse and sort?\n  }\n\n  const balance = spliceArguments.length - 2 - spliceArguments[1];\n\n  const removeStart = Math.min(length, spliceArguments[0]);\n  const removeEnd = removeStart + spliceArguments[1];\n  newIndices.startIndex = removeStart;\n\n  let i;\n  for (i = 0; i < removeStart; i += 1) {\n    newIndices.push(i);\n  }\n\n  for (; i < removeEnd; i += 1) {\n    newIndices.push(-1);\n  }\n\n  for (; i < length; i += 1) {\n    newIndices.push(i + balance);\n  }\n\n  // there is a net shift for the rest of the array starting with index + balance\n  if (balance !== 0) {\n    newIndices.touchedFrom = spliceArguments[0];\n  } else {\n    newIndices.touchedFrom = length;\n  }\n\n  return newIndices;\n}\n\n// The pop, push, shift an unshift methods can all be represented\n// as an equivalent splice\nfunction getSpliceEquivalent(length, methodName, args) {\n  switch (methodName) {\n    case 'splice':\n      if (args[0] !== undefined && args[0] < 0) {\n        args[0] = length + Math.max(args[0], -length);\n      }\n\n      if (args[0] === undefined) args[0] = 0;\n\n      while (args.length < 2) {\n        args.push(length - args[0]);\n      }\n\n      if (!isNumber(args[1])) {\n        args[1] = length - args[0];\n      }\n\n      // ensure we only remove elements that exist\n      args[1] = Math.min(args[1], length - args[0]);\n\n      return args;\n\n    case 'sort':\n    case 'reverse':\n      return null;\n\n    case 'pop':\n      if (length) {\n        return [length - 1, 1];\n      }\n      return [0, 0];\n\n    case 'push':\n      return [length, 0].concat(args);\n\n    case 'shift':\n      return [0, length ? 1 : 0];\n\n    case 'unshift':\n      return [0, 0].concat(args);\n  }\n}\n","import hooks from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isString } from 'utils/is';\n\nexport function update(ractive, model, options) {\n  // if the parent is wrapped, the adaptor will need to be updated before\n  // updating on this keypath\n  if (model.parent && model.parent.wrapper) {\n    model.parent.adapt();\n  }\n\n  const promise = runloop.start();\n\n  model.mark(options && options.force);\n\n  // notify upstream of changes\n  model.notifyUpstream();\n\n  runloop.end();\n\n  hooks.update.fire(ractive, model);\n\n  return promise;\n}\n\nexport default function Ractive$update(keypath, options) {\n  let opts, path;\n\n  if (isString(keypath)) {\n    path = splitKeypath(keypath);\n    opts = options;\n  } else {\n    opts = keypath;\n  }\n\n  return update(this, path ? this.viewmodel.joinAll(path) : this.viewmodel, opts);\n}\n","import fireEvent from 'src/events/fireEvent';\nimport Context from 'shared/Context';\nimport { assign, create } from 'utils/object';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$fire(eventName, ...args) {\n  let ctx;\n\n  // watch for reproxy\n  if (args[0] instanceof Context) {\n    const proto = args.shift();\n    ctx = create(proto);\n    assign(ctx, proto);\n  } else if (isObjectType(args[0]) && (args[0] === null || args[0].constructor === Object)) {\n    ctx = Context.forRactive(this, args.shift());\n  } else {\n    ctx = Context.forRactive(this);\n  }\n\n  return fireEvent(this, eventName, ctx, args);\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport { FakeFragment } from 'shared/getRactiveContext';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$get(keypath, opts) {\n  if (!isString(keypath)) return this.viewmodel.get(true, keypath);\n\n  const keys = splitKeypath(keypath);\n  const key = keys[0];\n\n  let model;\n\n  if (!this.viewmodel.has(key)) {\n    // if this is an inline component, we may need to create\n    // an implicit mapping\n    if (this.component && !this.isolated) {\n      model = resolveReference(this.fragment || new FakeFragment(this), key);\n    }\n  }\n\n  model = this.viewmodel.joinAll(keys);\n  return model.get(true, opts);\n}\n","import staticContext from '../static/getContext';\nimport getRactiveContext from 'src/shared/getRactiveContext';\nimport { isString } from 'utils/is';\n\nexport default function getContext(node, options) {\n  if (!node) return getRactiveContext(this);\n\n  if (isString(node)) {\n    node = this.find(node, options);\n  }\n\n  return staticContext(node);\n}\n","import hooks from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\n\nexport default function Ractive$insert(target, anchor) {\n  if (!this.fragment.rendered) {\n    // TODO create, and link to, documentation explaining this\n    throw new Error(\n      'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.'\n    );\n  }\n\n  target = getElement(target);\n  anchor = getElement(anchor) || null;\n\n  if (!target) {\n    throw new Error('You must specify a valid target to insert into');\n  }\n\n  target.insertBefore(this.detach(), anchor);\n  this.el = target;\n\n  (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(this);\n  this.isDetached = false;\n\n  fireInsertHook(this);\n}\n\nfunction fireInsertHook(ractive) {\n  hooks.insert.fire(ractive);\n\n  ractive.findAllComponents('*').forEach(child => {\n    fireInsertHook(child.instance);\n  });\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from 'src/global/runloop';\n\nexport default function link(there, here, options) {\n  let model;\n  const target = (options && (options.ractive || options.instance)) || this;\n\n  // may need to allow a mapping to resolve implicitly\n  const sourcePath = splitKeypath(there);\n  if (!target.viewmodel.has(sourcePath[0]) && target.component) {\n    model = resolveReference(target.component.up, sourcePath[0]);\n    model = model.joinAll(sourcePath.slice(1));\n  }\n\n  const src = model || target.viewmodel.joinAll(sourcePath);\n  const dest = this.viewmodel.joinAll(splitKeypath(here), { lastLink: false });\n\n  if (isUpstream(src, dest) || isUpstream(dest, src)) {\n    throw new Error('A keypath cannot be linked to itself.');\n  }\n\n  const promise = runloop.start();\n\n  dest.link(src, (options && options.keypath) || there);\n\n  runloop.end();\n\n  return promise;\n}\n\nfunction isUpstream(check, start) {\n  let model = start;\n  while (model) {\n    if (model === check || model.owner === check) return true;\n    model = model.target || model.parent;\n  }\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport Observer from './observe/Observer';\nimport PatternObserver from './observe/Pattern';\nimport ArrayObserver from './observe/Array';\nimport { keys } from 'utils/object';\n\nexport default function observe(keypath, callback, options) {\n  const observers = [];\n  let map;\n  let opts;\n\n  if (isObject(keypath)) {\n    map = keypath;\n    opts = callback || {};\n  } else {\n    if (isFunction(keypath)) {\n      map = { '': keypath };\n      opts = callback || {};\n    } else {\n      map = {};\n      map[keypath] = callback;\n      opts = options || {};\n    }\n  }\n\n  let silent = false;\n  keys(map).forEach(keypath => {\n    const callback = map[keypath];\n    const caller = function(...args) {\n      if (silent) return;\n      return callback.apply(this, args);\n    };\n\n    let keypaths = keypath.split(' ');\n    if (keypaths.length > 1) keypaths = keypaths.filter(k => k);\n\n    keypaths.forEach(keypath => {\n      opts.keypath = keypath;\n      const observer = createObserver(this, keypath, caller, opts);\n      if (observer) observers.push(observer);\n    });\n  });\n\n  // add observers to the Ractive instance, so they can be\n  // cancelled on ractive.teardown()\n  this._observers.push.apply(this._observers, observers);\n\n  return {\n    cancel: () => observers.forEach(o => o.cancel()),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n\nfunction createObserver(ractive, keypath, callback, options) {\n  const keys = splitKeypath(keypath);\n  let wildcardIndex = keys.indexOf('*');\n  if (!~wildcardIndex) wildcardIndex = keys.indexOf('**');\n\n  options.fragment = options.fragment || ractive.fragment;\n\n  let model;\n  if (!options.fragment) {\n    model = ractive.viewmodel.joinKey(keys[0]);\n  } else {\n    // .*.whatever relative wildcard is a special case because splitkeypath doesn't handle the leading .\n    if (~keys[0].indexOf('.*')) {\n      model = options.fragment.findContext();\n      wildcardIndex = 0;\n      keys[0] = keys[0].slice(1);\n    } else {\n      model =\n        wildcardIndex === 0\n          ? options.fragment.findContext()\n          : resolveReference(options.fragment, keys[0]);\n    }\n  }\n\n  // the model may not exist key\n  if (!model) model = ractive.viewmodel.joinKey(keys[0]);\n\n  if (!~wildcardIndex) {\n    model = model.joinAll(keys.slice(1));\n    if (options.array) {\n      return new ArrayObserver(ractive, model, callback, options);\n    } else {\n      return new Observer(ractive, model, callback, options);\n    }\n  } else {\n    const double = keys.indexOf('**');\n    if (~double) {\n      if (double + 1 !== keys.length || ~keys.indexOf('*')) {\n        warnOnceIfDebug(\n          `Recursive observers may only specify a single '**' at the end of the path.`\n        );\n        return;\n      }\n    }\n\n    model = model.joinAll(keys.slice(1, wildcardIndex));\n\n    return new PatternObserver(ractive, model, keys.slice(wildcardIndex), callback, options);\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\n\nexport default function Ractive$off(eventName, callback) {\n  // if no event is specified, remove _all_ event listeners\n  if (!eventName) {\n    this._subs = {};\n  } else {\n    // Handle multiple space-separated event names\n    const eventNames = eventName\n      .split(' ')\n      .map(trim)\n      .filter(notEmptyString);\n\n    eventNames.forEach(event => {\n      const subs = this._subs[event];\n      // if given a specific callback to remove, remove only it\n      if (subs && callback) {\n        const entry = subs.find(s => s.callback === callback);\n        if (entry) {\n          removeFromArray(subs, entry);\n          entry.off = true;\n\n          if (event.indexOf('.')) this._nsSubs--;\n        }\n      } else if (subs) {\n        // otherwise, remove all listeners for this event\n        if (event.indexOf('.')) this._nsSubs -= subs.length;\n        subs.length = 0;\n      }\n    });\n  }\n\n  return this;\n}\n","import trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\nimport { hasOwn } from 'utils/object';\nimport { isObjectType, isString } from 'utils/is';\n\nexport default function Ractive$on(eventName, callback) {\n  // eventName may already be a map\n  const map = isObjectType(eventName) ? eventName : {};\n  // or it may be a string along with a callback\n  if (isString(eventName)) map[eventName] = callback;\n\n  let silent = false;\n  const events = [];\n\n  for (const k in map) {\n    const callback = map[k];\n    const caller = function(...args) {\n      if (!silent) return callback.apply(this, args);\n    };\n    const entry = {\n      callback,\n      handler: caller\n    };\n\n    if (hasOwn(map, k)) {\n      const names = k\n        .split(' ')\n        .map(trim)\n        .filter(notEmptyString);\n      names.forEach(n => {\n        (this._subs[n] || (this._subs[n] = [])).push(entry);\n        if (n.indexOf('.')) this._nsSubs++;\n        events.push([n, entry]);\n      });\n    }\n  }\n\n  return {\n    cancel: () => events.forEach(e => this.off(e[0], e[1].callback)),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n","export default function Ractive$once(eventName, handler) {\n  const listener = this.on(eventName, function() {\n    handler.apply(this, arguments);\n    listener.cancel();\n  });\n\n  // so we can still do listener.cancel() manually\n  return listener;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function readLink(keypath, options = {}) {\n  const path = splitKeypath(keypath);\n\n  if (this.viewmodel.has(path[0])) {\n    let model = this.viewmodel.joinAll(path);\n\n    if (!model.isLink) return;\n\n    while ((model = model.target) && options.canonical !== false) {\n      if (!model.isLink) break;\n    }\n\n    if (model) return { ractive: model.root.ractive, keypath: model.getKeypath() };\n  }\n}\n","function s4() {\n  return Math.floor((1 + Math.random()) * 0x10000)\n    .toString(16)\n    .substring(1);\n}\n\nexport function uuid() {\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\n","import { applyCSS } from '../../global/css';\nimport transformCSS from '../config/custom/css/transform';\nimport { evalCSS } from '../config/custom/css/css';\nimport { build, set } from '../../shared/set';\nimport runloop from '../../global/runloop';\nimport { isObjectType, isFunction } from 'utils/is';\n\nexport default function setCSSData(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = this._cssModel;\n\n  model.locked = true;\n  const promise = set(build({ viewmodel: model }, keypath, value, true), opts);\n  model.locked = false;\n\n  const cascade = runloop.start();\n  this.extensions.forEach(e => {\n    const model = e._cssModel;\n    model.mark();\n    model.downstreamChanged('', 1);\n  });\n  runloop.end();\n\n  applyChanges(this, !opts || opts.apply !== false);\n\n  return promise.then(() => cascade);\n}\n\nexport function applyChanges(component, apply) {\n  const local = recomputeCSS(component);\n  const child = component.extensions\n    .map(e => applyChanges(e, false))\n    .reduce((a, c) => c || a, false);\n\n  if (apply && (local || child)) {\n    const def = component._cssDef;\n    if (!def || (def && def.applied)) applyCSS(true);\n  }\n\n  return local || child;\n}\n\nexport function recomputeCSS(component) {\n  const css = component.css;\n\n  if (!isFunction(css)) return;\n\n  const def = component._cssDef;\n  const result = evalCSS(component, css);\n  const styles = def.transform ? transformCSS(result, def.id) : result;\n\n  if (def.styles === styles) return;\n\n  def.styles = styles;\n\n  return true;\n}\n"],"names":["this","pathModel","applyValue","context","getKeypath","Fragment__proto__","render","target","occupants","rendered","Error","let","xs","items","len","length","i","resetTemplate","template","wasBound","bound","wasRendered","unrender","unbind","createItems","bind","parentNode","findParentNode","anchor","findNextNode","docFrag","createDocumentFragment","insertBefore","shuffled","forEach","rootModel","ractive","root","toString","escape","map","toEscapedString","join","shouldDestroy","update","dirty","updating","isRoot","runloop","addFragmentToRoot","valueOf","dirtyValue","values","source","processItems","_guid","parsed","parseJSON","value","Fragment","prototype","getContext","const","shouldRerender","reverse","makeArrayMethod","path","shift","sort","splice","unshift","proto","add","animate","attachChild","compute","detach","detachChild","find","findAll","findAllComponents","findComponent","findContainer","findParent","fire","get","insert","link","observe","observeOnce","off","on","once","pop","push","readLink","reset","resetPartial","set","subtract","teardown","toggle","toCSS","toCss","toHTML","toHtml","toText","transition","unlink","updateModel","use","styles","callsSuper","defineProperties","Ractive","sharedGet","sharedSet","styleGet","configurable","styleSet","addCSS","addStyle","hasCSS","hasStyle","win","opts","script","document","currentScript","querySelector","getAttribute","indexOf","warn","assign","defaults","constructor","DEBUG","writable","DEBUG_PROMISES","extend","extendWith","escapeKey","evalObjectString","findPlugin","getCSS","isInstance","joinKeys","macro","normaliseKeypath","normalise","parse","splitKeypath","unescapeKey","enhance","svg","VERSION","adaptors","components","decorators","easing","events","extensions","helpers","interpolators","partials","transitions","cssData","sharedData","Context","extern","defineProperty","CSSModel","fragment","parser","matchString","result","sp","v","valueToken","read","Mapping","Item","options","super","name","n","owner","up","element","findElement","attributeByName","f","Mapping__proto__","viewmodel","instance","joinKey","isString","isArray","createMapping","rebound","boundFragment","model","resolve","joinAll","mapping","unregister","Option","Element","a","undefined","select","parent","Option__proto__","selectedAttribute","selected","index","attributes","bubble","node","_ractive","attribute","getValue","isSelected","optionValue","selectValue","compare","removeFromArray","Partial","create","MustacheContainer","yielder","container","component","containerFragment","r","x","tx","refName","fn","partialFromValue","partial","call","warnOnceIfDebug","createFragment","initMacro","handleChange","dirtyTemplate","externalChange","aliases","k","unreference","z","resolveAliases","_attrs","keys","refreshAttrs","handle","proxy","fnTemplate","isFunction","getPartialTemplate","unbindAttrs","scheduleTask","_cssDef","applied","applyCSS","dirtyAttrs","invalidate","extras","KeyModel","key","isReadonly","isKey","deps","links","children","KeyModel__proto__","c","destroyed","upstream","unregisterChild","shouldCapture","capture","has","rebind","next","previous","relinking","register","dependant","registerChild","child","addToArray","registerLink","unregisterLink","reference","noop","keypathString","RepeatedFragment","delegate","findDelegate","cssIds","iterations","indexRef","keyRef","pendingNewIndices","previousIterations","RepeatedFragment__proto__","slice","shuffler","s","test","shuffleValues","isComputed","max","this$1","createIteration","isObject","refs","split","ks","bubbled","rebounding","isIteration","swizzleFragment","appendChild","selector","findMap","findContext","iteration","firstNode","skipParent","getLast","lastModel","contextFor","shuffle","newIndices","merge","newIndex","oldIndex","shouldRebind","updatePostShuffle","buildNewIndices","idxModel","toRemove","oldKeys","wasArray","lastValue","i$1","newLength","updateLast","fragment$1","nextNode","indices","idx","dest","pos","prev","iters","stash","Array","e","nextRendered","isObjectType","plen","Section","sectionType","templateSectionType","subordinate","l","Section__proto__","sibling","nextSibling","SECTION_UNLESS","isTruthy","frag","detached","SECTION_IF_WITH","isEmpty","safe","SECTION_IF","SECTION_WITH","SECTION_EACH","siblingFalsey","lastType","getType","newFragment","fragmentShouldExist","attach","keep","promise","then","Select","Select__proto__","foundNode","binding","selectedOptions","getSelectedOptions","sync","defaultSelected","selectNode","toArray","o","setFromNode","isMultiple","array","optionWasSelected","shouldSelect","valueContains","forceUpdate","comparator","Textarea","Input","deferContent","isBindable","createItem","t","ATTRIBUTE","Textarea__proto__","Text","type","TEXT","Text__proto__","detachNode","inAttributes","progressiveText","escapeHtml","visible","hidden","doc","prefix","vendors","vendor","addEventListener","onChange","onHide","onShow","isClient","prefixCache","testStyle","createElement","style","prop","hyphenateCamel","createTransitions","prefix$1","vendorPattern","RegExp","TRANSITION","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","linear","canUseCssTransitions","cannotUseCssTransitions","webkitTransition","to","changedProperties","setTimeout","transitionDone","clearTimeout","cssTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","unregisterCompleteHandler","isIntro","transitionEndHandler","event","propertyName","cssTransitionsDone","property","duration","timing","removeEventListener","hashPrefix","namespaceURI","tagName","delay","registerCompleteHandler","easingName","hyphenate","cssTiming","hash","suffix","interpolator","originalValue","propertiesToTransitionInJs","initial","getStyle","warnIfDebug","exec","interpolate","parseFloat","missingPlugin","Ticker","step","complete","createTransitions$1","getComputedStyle","resolved","Promise","names","t0","t1","t2","Transition","onComplete","Transition__proto__","animateStyle","arguments","setStyle","fulfil","propertyNames","computedStyle","current","init","originals","targets","intro","outro","eventName","params","_fn","findInViewHierarchy","setupArgsFn","getParams","resolveArgs","apply","props","processParams","isNumber","hasOwn","shouldFire","transitionsEnabled","rendering","nearestProp","unrendering","nested","el","starting","start","completed","args","noReset","_manager","remove","concat","unbinding","ieBug","ieBlacklist","elementCache","innerHTML","err","TABLE","THEAD","TBODY","TR","SELECT","Triple","Mustache","Triple__proto__","nodes","nodeType","matches","queryResult","queryAllResult","querySelectorAll","html","insertHtml","outerHTML","nodeValue","removeChild","inAttribute","decodeCharacterReferences","detachWhenReady","constructors","ALIAS","Alias","ANCHOR","Component","AWAIT","Await","DOCTYPE","Doctype","INTERPOLATOR","Interpolator","PARTIAL","SECTION","TRIPLE","YIELDER","Attribute","BINDING_FLAG","BindingFlag","DECORATOR","Decorator","EVENT","EventDirective","COMMENT","Comment","specialElements","doctype","form","Form","input","option","textarea","componentParent","addFragment","base","findParentWithContext","item","it","ELEMENT","getKey","keyModel","getIndex","Component__proto__","assigns","getRactiveContext","isAnchor","checking","checkAnchors","callRender","eventHandlers","isolated","unrenderItem","missingDecorator","Decorator__proto__","models","rebindMatch","addShuffleRegister","teardownArgsFn","warnOnce","Doctype__proto__","Binding","twowayBinding","setRoot","keypath","replace","isTwoway","wasUndefined","getInitialValue","lastVal","parentForm","resetValue","formBindings","Binding__proto__","registerTwowayBinding","locked","end","setting","unregisterTwowayBinding","CheckboxBinding","CheckboxBinding__proto__","handleDomEvent","attachEvent","checked","BindingGroup","bindings","BindingGroup__proto__","CheckboxNameBinding","checkboxName","group","getBindingGroup","noInitialValue","existingValue","bindingValue","arrayContains","CheckboxNameBinding__proto__","isChecked","valueSoFar","ContentEditableBinding","ContentEditableBinding__proto__","lazy","GenericBinding","GenericBinding__proto__","timeout","isNumeric","handler","handleDelay","handleBlur","FileBinding","FileBinding__proto__","files","MultipleSelectBinding","MultipleSelectBinding__proto__","filter","selectedValues","previousValue","arrayContentsMatch","NumericBinding","NumericBinding__proto__","isNaN","siblings","RadioBinding","getSiblings","RadioBinding__proto__","RadioNameBinding","pathChanged","updateName","RadioNameBinding__proto__","SingleSelectBinding","SingleSelectBinding__proto__","disabled","endsWithSemi","ContainerItem","toLowerCase","attrs","attr","val","cls","leftovers","m","g","statics","DELEGATE_FLAG","ConditionalAttribute","Element__proto__","recreateTwowayBinding","createTwowayBinding","twoway","selectBinding","ref","ctx","callback","listeners","delegateHandler","rem","namespace","getNamespace","existing","nodeName","toUpperCase","setAttribute","isOutro","registerTransition","childNodes","removeAttribute","ls","stringifyAttribute","inputIsCheckedRadio","safeAttributeString","getString","inlineClass","str","voidElements","UIEvent","Form__proto__","handleReset","whitelist","animationend","animationiteration","animationstart","transitioncancel","transitionend","transitionstart","transitionrun","DOMEvent","fatal","DOMEvent__proto__","directive","original","CustomEvent","eventPlugin","CustomEvent__proto__","RactiveEvent","RactiveEvent__proto__","cancel","specialPattern","dollarArgsPattern","EventDirective__proto__","COMPONENT","rs","resolveReference","getFunction","message","action","refire","specialRef","specialMatch","special","substr","dollarMatch","obj","which","wrapper","wrapperValue","oldEvent","returned","preventDefault","stopPropagation","fireEvent","isStatic","Mustache__proto__","y","Object","Interpolator__proto__","safeToStringValue","string","data","Input__proto__","defaultValue","attrValue","leadingWhitespace","ParseError","stack","Parser","lineStart","lines","lineEnds","line","lineEnd","leftover","remaining","postProcess","converters","getContextMessage","getLinePos","lineNum","columnNum","contextLines","contextUp","contextDown","numTabs","annotation","match","char","error","msg","character","shortMessage","matchPattern","pattern","substring","nextChar","charAt","Parent","Child","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","singleMatcher","makeQuotedStringMatcher","doubleMatcher","numberPattern","identifier","specials","true","false","null","specialsPattern","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","JsonParser","placeholder","number","stringLiteral","readStringLiteral","$1","pair","getKeyValuePair","_observers","Observer__proto__","dispatch","cancelled","newValue","oldValue","updateOld","isEqual","strict","addObserver","defer","addShuffleTask","star","PatternObserver","baseModel","baseKeypath","recursive","old","oldContext","oldFn","oldValues","newValues","changed","findMatches","registerPatternObserver","PatternObserver__proto__","unregisterPatternObserver","wildcards","notify","touchedFrom","count","isLink","ok","check","ArrayObserver","pending","sliced","ArrayObserver__proto__","negativeOne","inserted","deleted","hadIndex","onceOptions","trim","notEmptyString","PREFIX","styleDefinitions","isDirty","styleElement","useCssText","adaptConfigurator","adapt","combine","ensureArray","selectorsPattern","keyframesDeclarationPattern","selectorUnitPattern","excludePattern","dataRvcGuidPattern","SharedModel","CSSModel__proto__","downstreamChanged","depth","_cssModel","mark","applyChanges","hasCurly","cssConfigurator","_cssIds","gatherIds","css","initCSS","dataConfigurator","_r_unbound","TEMPLATE_VERSION","templateConfigurator","parseTemplate","getDynamicTemplate","_config","p","extendPartials","registryNames","registriesOnDefaults","Registry","useDefaults","Registry__proto__","configure","registry","isOwner","registries","putInDefaults","config","order","custom","computed","defaultKeys","isStandardKey","makeObj","isBlacklisted","_super","Item__proto__","ContainerItem__proto__","ComputationChild","Model","syncComputedChildren","prototypeAccessors$1","ComputationChild__proto__","dependencies","parentValue","newWrapperValue","unwrap","boundValue","marked","childByKey","Computation","signature","setter","prototypeAccessors$2","Computation__proto__","active","notifyUpstream","maybeBind","shouldBind","noVirtual","startCapturing","getter","hasConsole","console","groupCollapsed","sig","getterUseStack","groupEnd","stopCapturing","setDependencies","shared","ExpressionProxy","allowExpressions","ExpressionProxy__proto__","actuallyChanged","d","retrieve","collect","dep","computation","ReferenceExpressionProxy","LinkModel","rootLink","ReferenceExpressionProxy__proto__","members","Missing","tpl","REFERENCE","reduce","list","String","fireShuffleTasks","refreshPathDeps","eproto","Alias__proto__","booleanAttributes","allowfullscreen","async","autofocus","autoplay","compact","controls","declare","default","defaultchecked","defaultmuted","defaultselected","enabled","formnovalidate","indeterminate","inert","ismap","itemscope","loop","multiple","muted","nohref","noresize","noshade","novalidate","nowrap","open","pauseonexit","readonly","required","reversed","scoped","seamless","sortable","translate","truespeed","typemustmatch","area","br","col","command","embed","hr","img","keygen","meta","param","track","wbr","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","codePointSupport","fromCodePoint","codeToChar","fromCharCode","lessThan","greaterThan","invalid","space","textTypes","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","maxlength","pubdate","rowspan","tabindex","usemap","div","ConditionalAttribute__proto__","isSvg","parseAttributes","notIn","updateDelegate","Attribute__proto__","namespaces","useProperty","isBoolean","lookupNamespace","getUpdateDelegate","flag","bubbler","BindingFlag__proto__","createComment","RactiveModel","RactiveModel__proto__","initLink","specialModels","@this","getRactiveModel","@global","GlobalModel","@shared","@style","@helpers","getHelpers","RootModel","RootModel__proto__","attached","attachImplicits","createLink","targetPath","detachImplicits","virtual","getVirtual","SharedBase","ractiveModel","getValueChildren","_link","unescapedKey","shouldTeardown","protoRegistries","uid","ComponentConstructor","content","_partials","addChild","construct","mappings","_inlinePartials","initialise","recomputeCSS","buildCSS","id","build","plugins","extendOne","Class","Target","_on","toPairs","_observe","optional","splitKeypathI","TypeError","sourcesLength","sources","nextSource","nextKey","hasOwnProperty","thisArg","arrayLength","window","Node","contains","performance","now","nowOffset","Date","PENDING","FULFILLED","REJECTED","dispatchHandlers","fulfilledHandlers","rejectedHandlers","state","makeResolver","newState","makeDispatcher","wait","fulfill","reject","onFulfilled","onRejected","promise2","processResolutionHandler","handlers","forward","p1result","catch","all","promises","processPromise","reason","called","resolvePromise","rejectPromise","requestAnimationFrame","cancelAnimationFrame","lastTime","currentTime","timeToNextCall","Math","log","printWarning","welcome","append","delimiters","tripleDelimiters","staticDelimiters","staticTripleDelimiters","csp","preserveWhitespace","sanitize","stripComments","resolveInstanceMembers","warnAboutAmbiguity","noIntro","noOutro","nestedTransitions","noCssTransform","easeIn","pow","easeOut","easeInOut","implementation","hasFeature","alreadyWarned","welcomeIntro","welcomeMessage","WELCOME_MESSAGE","hasGroup","badArguments","noRegistryFunctionReturn","from","intermediate","min","object","properties","refPattern","splitPattern","escapeKeyPattern","unescapeKeyPattern","fnBind","Function","shuffleTasks","early","registerQueue","ModelBase","ModelBase__proto__","task","stage","existingMatches","objectKeys","lastLink","startPath","patterns","notifiedUpstream","observer","updateFromBindings","cascade","oneway","findBoundValue","captureGroup","shufle","sourcePath","LinkModel__proto__","isDetached","force","markedAll","relinked","shuffling","lnk","implicit","ln","functions","parseOptions","TEMPLATE_INSTRUCTIONS","COMPUTATION_INSTRUCTIONS","fromId","noThrow","getElementById","textContent","isParsed","getParseOptions","throwNoParse","addFunctions","parseFor","TransitionManager","intros","outros","totalChildren","outroChildren","detachQueue","outrosComplete","TransitionManager__proto__","decrementOutros","decrementTotal","detachNodes","ready","detachImmediate","batch","fulfilPromise","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","flushChanges","b","thing","postRender","_batch","tickers","running","tick","Ticker__proto__","elapsed","eased","stop","abort","prefixers","ticker","Model__proto__","rewrap","createBranch","adaptor","wrap","getPrefixer","__model","isObjectLike","getComputationSignature","branch","markForce","recreateArray","unsafe","SharedModel__proto__","SharedModel$1","global","ContextModel","ContextModel__proto__","FakeFragment","deepOpts","comparators","errorMessage","initStars","bubbleStars","Hook","method","arg","HookQueue","hook","inProcess","queue","HookQueue__proto__","begin","getChildQueue","hooks","NUMBER_LITERAL","STRING_LITERAL","ELSE","THEN","CATCH","arrayProto","modelPush","modelPop","modelShift","modelUnshift","modelSort","modelSplice","modelReverse","ContextData","ContextData__proto__","prototypeAccessors","_data","Context__proto__","num","findModel","protoAnimate","getParent","hasListener","findEvent","there","here","listen","raise","ev","drop","unlisten","protoUpdate","isBound","getBindingModel","getBindingPath","getBinding","setBinding","forRactive","methodNames","unprefixed","prefixed","j","makeFunction","query","mathml","xlink","xml","xmlns","ns","createElementNS","methodName","cloneNode","Observer","resolver","getMessage","deprecated","correct","isError","deprecateOption","deprecatedOption","deprecate","extendOtherMethods","member","RactiveProto","wrapPrototype","rx","entity","code","parseInt","validateCode","camelCaseStr","readStyle","cleanCss","reconstruct","rule","rules","readClass","updateMultipleSelectValue","updateSelectValue","updateStringValue","updateContentEditableValue","updateRadioValue","updateValue","updateRadioName","updateCheckboxName","updateStyleAttribute","updateInlineStyle","updateClassName","updateInlineClass","updateBoolean","updateNamespacedAttribute","updateAttribute","wasSelected","selectedIndex","wasChecked","valueAttribute","setProperty","getPropertyValue","last","className","baseVal","getAttributeNS","removeAttributeNS","setAttributeNS","haystack","needle","qualified","hasAttribute","Ractive$teardown","torndown","getPromise","__ractive_instances__","destruct","_marking","mdl","subscribe","subs","single","initialiseProperties","handleAttributes","_attributePartial","getAdaptors","protoAdapt","lookup","srcs","_subs","_nsSubs","_eventQueue","_children","byName","mapAll","nameOption","renderItem","lastBound","updateAnchors","res","isBindableByValue","isBindableByContentEditable","isContentEditable","isBindableByName","isBindableByChecked","nameAttr","currentTarget","endEl","correspondingUseElement","text","splitText","createTextNode","okQuote","literal","done","charCodeAt","JSON","quote","readNumberLiteral","readKey","token","namePattern","childData","getPartialFromRegistry","fillGaps","findParentPartial","findInstance","findOwner","findConstructor","self","contextifyTemplate","okToParse","parsePartial","setTemplate","initing","aliasLocal","findFirstNode","out","frags","section","hasIndexRef","selectedOption","firstChild","getComponentConstructor","asyncProxy","cmp","extract","success","undef","ctor","guid","counter","placeholderId","newModel","userOptions","getElement","logIfDebug","cssId","Ractive$render","others","Ractive$reset","rerender","changes","collection","Ractive$resetTemplate","external","Ractive$set","Ractive$subtract","Ractive$toggle","gather","Ractive$toCSS","uniqueCssIds","ids","Ractive$toHTML","Ractive$transition","HTMLElement","Ractive$unrender","Ractive$updateModel","transform","pairs","isFinite","format","registryName","interpol","arrays","arrayLike","one","two","oldArray","newArray","oldLength","usedIndices","firstUnusedIndex","isKeypath","parts","findAlias","alias","fromExpression","body","createFunction","exp","instructions","createFunctionFromString","bindTo","expression","getterString","setterString","tm","notifiedTotal","manager","collectAllOutros","trans","nqueue","_list","prefixKeypath","rootKeypath","rootDot","relativeKeypath","initialFragment","explicitContext","badReference","repeater","findIter","shouldWarn","crossed","_fakeFragment","deep","deepSet","getComparator","sets","Ractive$add","immediate","getOptions","Ractive$animate","enqueue","dequeue","variants","eventNames","fireEventAs","initialFire","notifySubscribers","fullName","subscribers","originalEvent","stopEvent","hookQueue","childQueue","findAnchors","findAnchorsIn","anchors","idxs","unrenderChild","prepend","insertAt","rm","attachchild","Ractive$compute","comp","first","Ractive$detach","detachchild","Ractive$find","remote","Ractive$findAll","Ractive$findAllComponents","Ractive$findComponent","Ractive$findContainer","Ractive$findParent","orComponent","getNewIndices","spliceArguments","getSpliceEquivalent","balance","removeStart","removeEnd","startIndex","Ractive$update","Ractive$fire","Ractive$get","instances","staticContext","output","Ractive$insert","fireInsertHook","src","isUpstream","fresh","vals","olds","observers","silent","caller","keypaths","createObserver","isSilenced","silence","resume","wildcardIndex","double","Ractive$off","entry","Ractive$on","Ractive$once","listener","canonical","styleDefinition","styleSheet","cssText","filteredStyleDefinitions","getElementsByTagName","additionalReplaceRules","extractString","unit","transformSelector","selectorUnits","modifiers","transformed","appended","prepended","transformCss","dataAttr","selectors","s4","floor","random","uuid","setCSSData","local","def","evalCSS","transformCSS","__proto__","cssProp","validate","emptyData","childValue","parentIsFn","childIsFn","callDataFunction","fromProperties","primary","secondary","parseAsString","existingPartials","newPartials","overwrite","superMethod","getSuperMethod","_parent","hasSuper","oldSuper","_method"],"mappings":"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"}