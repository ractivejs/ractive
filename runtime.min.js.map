{"version":3,"file":"runtime.min.js","sources":["../src/view/RepeatedFragment.js","../src/view/items/Section.js","../src/view/items/element/specials/Select.js","../src/view/items/element/specials/Textarea.js","../src/view/items/Text.js","../src/view/items/element/transitions/prefix.js","../src/config/visibility.js","../src/view/items/element/transitions/hyphenate.js","../src/view/items/element/transitions/createTransitions.js","../src/view/items/element/Transition.js","../src/view/items/triple/insertHtml.js","../src/view/items/Triple.js","../src/view/items/createItem.js","../src/view/Fragment.js","../src/events/HookQueue.js","../src/Ractive/initialise.js","../src/Ractive/render.js","../src/Ractive/prototype/reset.js","../src/Ractive/prototype/resetPartial.js","../src/Ractive/prototype/reverse.js","../src/Ractive/prototype/shift.js","../src/Ractive/prototype/sort.js","../src/Ractive/prototype/splice.js","../src/Ractive/prototype/unrender.js","../src/Ractive/prototype/unshift.js","../src/Ractive/prototype.js","../src/extend/_extend.js","../src/Ractive.js","../src/view/items/element/binding/GenericBinding.js","../src/view/items/element/binding/FileBinding.js","../src/view/items/element/binding/MultipleSelectBinding.js","../src/view/items/element/binding/NumericBinding.js","../src/view/items/element/binding/RadioBinding.js","../src/view/items/element/binding/RadioNameBinding.js","../src/view/items/element/binding/SingleSelectBinding.js","../src/view/items/Element.js","../src/view/items/element/specials/Form.js","../src/view/items/element/ElementEvents.js","../src/view/items/component/RactiveEvent.js","../src/view/items/shared/EventDirective.js","../src/view/items/shared/Mustache.js","../src/view/items/Interpolator.js","../src/view/items/element/specials/Input.js","../src/parse/Parser.js","../src/parse/converters/expressions/primary/literal/stringLiteral/makeQuotedStringMatcher.js","../src/parse/converters/expressions/primary/literal/readStringLiteral.js","../src/parse/converters/expressions/primary/literal/readNumberLiteral.js","../src/parse/converters/expressions/shared/patterns.js","../src/parse/converters/expressions/shared/readKey.js","../src/utils/parseJSON.js","../src/view/items/component/Mapping.js","../src/view/items/element/specials/Option.js","../src/view/items/Partial.js","../src/model/Computation.js","../src/view/resolvers/ExpressionProxy.js","../src/view/resolvers/ReferenceExpressionProxy.js","../src/view/items/Alias.js","../src/view/helpers/specialAttrs.js","../src/utils/hyphenateCamel.js","../src/view/items/element/attribute/getUpdateDelegate.js","../src/view/items/element/attribute/propertyNames.js","../src/utils/html.js","../src/view/items/element/ConditionalAttribute.js","../src/view/items/element/Attribute.js","../src/view/items/element/BindingFlag.js","../src/model/specials/RactiveModel.js","../src/model/RootModel.js","../src/Ractive/construct.js","../src/Ractive/prototype/teardown.js","../src/view/items/Component.js","../src/view/items/element/Decorator.js","../src/view/items/Doctype.js","../src/view/items/element/binding/Binding.js","../src/view/items/element/binding/CheckboxBinding.js","../src/view/items/element/binding/getBindingGroup.js","../src/view/items/element/binding/CheckboxNameBinding.js","../src/view/items/element/binding/ContentEditableBinding.js","../src/model/ModelBase.js","../src/model/LinkModel.js","../src/shared/Ticker.js","../src/model/helpers/getPrefixer.js","../src/model/Model.js","../src/model/specials/SharedModel.js","../src/view/resolvers/resolveReference.js","../src/shared/getRactiveContext.js","../src/shared/set.js","../src/Ractive/prototype/shared/add.js","../src/Ractive/prototype/animate.js","../src/events/fireEvent.js","../src/events/Hook.js","../src/Ractive/prototype/attachChild.js","../src/Ractive/prototype/detach.js","../src/Ractive/prototype/detachChild.js","../src/Ractive/prototype/shared/makeArrayMethod.js","../src/Ractive/prototype/update.js","../src/config/types.js","../src/shared/Context.js","../src/Ractive/static/getContext.js","../src/utils/dom.js","../src/config/namespaces.js","../src/Ractive/prototype/insert.js","../src/Ractive/prototype/observe/Observer.js","../src/Ractive/prototype/observe/Pattern.js","../src/Ractive/prototype/observe/Array.js","../src/Ractive/prototype/observeOnce.js","../src/Ractive/prototype/shared/trim.js","../src/Ractive/prototype/shared/notEmptyString.js","../src/Ractive/prototype/pop.js","../src/Ractive/prototype/push.js","../src/global/css.js","../src/Ractive/config/custom/adapt.js","../src/utils/cleanCss.js","../src/Ractive/config/custom/css/transform.js","../src/Ractive/config/custom/css/css.js","../src/Ractive/config/custom/data.js","../src/config/template.js","../src/parse/utils/createFunction.js","../src/shared/getFunction.js","../src/parse/_parse.js","../src/Ractive/config/runtime-parser.js","../src/Ractive/config/custom/template.js","../src/Ractive/config/registries.js","../src/Ractive/config/config.js","../src/view/items/shared/Item.js","../src/model/ComputationChild.js","../src/Ractive/helpers/getComputationSignature.js","../src/view/items/shared/directiveArgs.js","../src/view/items/element/binding/handleDomEvent.js","../src/utils/getSelectedOptions.js","../src/view/items/element/binding/selectBinding.js","../src/view/items/shared/progressiveText.js","../src/view/items/partial/getPartialTemplate.js","../src/view/items/component/getComponentConstructor.js","../src/view/helpers/processItems.js","../src/Ractive/prototype/render.js","../src/Ractive/prototype/resetTemplate.js","../src/Ractive/prototype/set.js","../src/Ractive/prototype/subtract.js","../src/Ractive/prototype/toggle.js","../src/Ractive/prototype/toCSS.js","../src/Ractive/prototype/toHTML.js","../src/Ractive/prototype/toText.js","../src/Ractive/prototype/transition.js","../src/Ractive/prototype/unlink.js","../src/Ractive/prototype/updateModel.js","../src/Ractive/static/isInstance.js","../src/Ractive/static/keypaths.js","../src/Ractive/static/findPlugin.js","../src/Ractive/config/defaults.js","../src/utils/log.js","../src/Ractive/static/easing.js","../src/utils/is.js","../src/config/environment.js","../src/utils/noop.js","../src/config/errors.js","../src/Ractive/static/interpolators.js","../src/global/TransitionManager.js","../src/global/runloop.js","../src/global/capture.js","../src/shared/keypaths.js","../src/model/specials/KeyModel.js","../src/model/specials/KeypathModel.js","../src/utils/bind.js","../src/shared/registry.js","../src/shared/interpolate.js","../src/utils/array.js","../src/shared/methodCallers.js","../src/shared/rebind.js","../src/Ractive/prototype/add.js","../src/events/eventStack.js","../src/shared/anchors.js","../src/Ractive/prototype/find.js","../src/Ractive/prototype/findAll.js","../src/Ractive/prototype/findAllComponents.js","../src/Ractive/prototype/findComponent.js","../src/Ractive/prototype/findContainer.js","../src/Ractive/prototype/findParent.js","../src/shared/getNewIndices.js","../src/view/items/shared/findElement.js","../src/Ractive/prototype/fire.js","../src/Ractive/prototype/get.js","../src/Ractive/prototype/getContext.js","../src/Ractive/prototype/link.js","../src/Ractive/prototype/observe.js","../src/Ractive/prototype/off.js","../src/Ractive/prototype/on.js","../src/Ractive/prototype/once.js","../src/Ractive/prototype/readLink.js","../src/utils/object.js","../src/utils/id.js","../src/Ractive/config/wrapPrototypeMethod.js","../src/Ractive/config/deprecate.js","../src/view/resolvers/resolve.js"],"sourcesContent":["import Fragment from './Fragment';\nimport { createDocumentFragment } from '../utils/dom';\nimport { isObject } from '../utils/is';\nimport { findMap } from '../utils/array';\nimport { toEscapedString, toString, destroyed, shuffled, unbind, unrender, unrenderAndDestroy, update } from '../shared/methodCallers';\nimport findElement from './items/shared/findElement';\n\nexport default class RepeatedFragment {\n\tconstructor ( options ) {\n\t\tthis.parent = options.owner.parentFragment;\n\n\t\t// bit of a hack, so reference resolution works without another\n\t\t// layer of indirection\n\t\tthis.parentFragment = this;\n\t\tthis.owner = options.owner;\n\t\tthis.ractive = this.parent.ractive;\n\t\tthis.delegate = this.parent.delegate || findElement( options.owner );\n\t\t// delegation disabled by directive\n\t\tif ( this.delegate && this.delegate.delegate === false ) this.delegate = false;\n\n\t\t// encapsulated styles should be inherited until they get applied by an element\n\t\tthis.cssIds = 'cssIds' in options ? options.cssIds : ( this.parent ? this.parent.cssIds : null );\n\n\t\tthis.context = null;\n\t\tthis.rendered = false;\n\t\tthis.iterations = [];\n\n\t\tthis.template = options.template;\n\n\t\tthis.indexRef = options.indexRef;\n\t\tthis.keyRef = options.keyRef;\n\n\t\tthis.pendingNewIndices = null;\n\t\tthis.previousIterations = null;\n\n\t\t// track array versus object so updates of type rest\n\t\tthis.isArray = false;\n\t}\n\n\tbind ( context ) {\n\t\tthis.context = context;\n\t\tconst value = context.get();\n\n\t\t// {{#each array}}...\n\t\tif ( this.isArray = Array.isArray( value ) ) {\n\t\t\t// we can't use map, because of sparse arrays\n\t\t\tthis.iterations = [];\n\t\t\tconst max = value.length;\n\t\t\tfor ( let i = 0; i < max; i += 1 ) {\n\t\t\t\tthis.iterations[i] = this.createIteration( i, i );\n\t\t\t}\n\t\t}\n\n\t\t// {{#each object}}...\n\t\telse if ( isObject( value ) ) {\n\t\t\tthis.isArray = false;\n\n\t\t\t// TODO this is a dreadful hack. There must be a neater way\n\t\t\tif ( this.indexRef ) {\n\t\t\t\tconst refs = this.indexRef.split( ',' );\n\t\t\t\tthis.keyRef = refs[0];\n\t\t\t\tthis.indexRef = refs[1];\n\t\t\t}\n\n\t\t\tthis.iterations = Object.keys( value ).map( ( key, index ) => {\n\t\t\t\treturn this.createIteration( key, index );\n\t\t\t});\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tbubble ( index ) {\n\t\tif  ( !this.bubbled ) this.bubbled = [];\n\t\tthis.bubbled.push( index );\n\n\t\tthis.owner.bubble();\n\t}\n\n\tcreateIteration ( key, index ) {\n\t\tconst fragment = new Fragment({\n\t\t\towner: this,\n\t\t\ttemplate: this.template\n\t\t});\n\n\t\tfragment.key = key;\n\t\tfragment.index = index;\n\t\tfragment.isIteration = true;\n\t\tfragment.delegate = this.delegate;\n\n\t\tconst model = this.context.joinKey( key );\n\n\t\t// set up an iteration alias if there is one\n\t\tif ( this.owner.template.z ) {\n\t\t\tfragment.aliases = {};\n\t\t\tfragment.aliases[ this.owner.template.z[0].n ] = model;\n\t\t}\n\n\t\treturn fragment.bind( model );\n\t}\n\n\tdestroyed () {\n\t\tthis.iterations.forEach( destroyed );\n\t}\n\n\tdetach () {\n\t\tconst docFrag = createDocumentFragment();\n\t\tthis.iterations.forEach( fragment => docFrag.appendChild( fragment.detach() ) );\n\t\treturn docFrag;\n\t}\n\n\tfind ( selector, options ) {\n\t\treturn findMap( this.iterations, i => i.find( selector, options ) );\n\t}\n\n\tfindAll ( selector, options ) {\n\t\treturn this.iterations.forEach( i => i.findAll( selector, options ) );\n\t}\n\n\tfindComponent ( name, options ) {\n\t\treturn findMap( this.iterations, i => i.findComponent( name, options ) );\n\t}\n\n\tfindAllComponents ( name, options ) {\n\t\treturn this.iterations.forEach( i => i.findAllComponents( name, options ) );\n\t}\n\n\tfindNextNode ( iteration ) {\n\t\tif ( iteration.index < this.iterations.length - 1 ) {\n\t\t\tfor ( let i = iteration.index + 1; i < this.iterations.length; i++ ) {\n\t\t\t\tconst node = this.iterations[ i ].firstNode( true );\n\t\t\t\tif ( node ) return node;\n\t\t\t}\n\t\t}\n\n\t\treturn this.owner.findNextNode();\n\t}\n\n\tfirstNode ( skipParent ) {\n\t\treturn this.iterations[0] ? this.iterations[0].firstNode( skipParent ) : null;\n\t}\n\n\trebind ( next ) {\n\t\tthis.context = next;\n\t\tthis.iterations.forEach( fragment => {\n\t\t\tconst model = next ? next.joinKey( fragment.key ) : undefined;\n\t\t\tfragment.context = model;\n\t\t\tif ( this.owner.template.z ) {\n\t\t\t\tfragment.aliases = {};\n\t\t\t\tfragment.aliases[ this.owner.template.z[0].n ] = model;\n\t\t\t}\n\t\t});\n\t}\n\n\trender ( target, occupants ) {\n\t\t// TODO use docFrag.cloneNode...\n\n\t\tconst xs = this.iterations;\n\t\tif ( xs ) {\n\t\t\tconst len = xs.length;\n\t\t\tfor ( let i = 0; i < len; i++ ) {\n\t\t\t\txs[i].render( target, occupants );\n\t\t\t}\n\t\t}\n\n\t\tthis.rendered = true;\n\t}\n\n\tshuffle ( newIndices ) {\n\t\tif ( !this.pendingNewIndices ) this.previousIterations = this.iterations.slice();\n\n\t\tif ( !this.pendingNewIndices ) this.pendingNewIndices = [];\n\n\t\tthis.pendingNewIndices.push( newIndices );\n\n\t\tconst iterations = [];\n\n\t\tnewIndices.forEach( ( newIndex, oldIndex ) => {\n\t\t\tif ( newIndex === -1 ) return;\n\n\t\t\tconst fragment = this.iterations[ oldIndex ];\n\t\t\titerations[ newIndex ] = fragment;\n\n\t\t\tif ( newIndex !== oldIndex && fragment ) fragment.dirty = true;\n\t\t});\n\n\t\tthis.iterations = iterations;\n\n\t\tthis.bubble();\n\t}\n\n\tshuffled () {\n\t\tthis.iterations.forEach( shuffled );\n\t}\n\n\ttoString ( escape ) {\n\t\treturn this.iterations ?\n\t\t\tthis.iterations.map( escape ? toEscapedString : toString ).join( '' ) :\n\t\t\t'';\n\t}\n\n\tunbind () {\n\t\tthis.iterations.forEach( unbind );\n\t\treturn this;\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tthis.iterations.forEach( shouldDestroy ? unrenderAndDestroy : unrender );\n\t\tif ( this.pendingNewIndices && this.previousIterations ) {\n\t\t\tthis.previousIterations.forEach( fragment => {\n\t\t\t\tif ( fragment.rendered ) shouldDestroy ? unrenderAndDestroy( fragment ) : unrender( fragment );\n\t\t\t});\n\t\t}\n\t\tthis.rendered = false;\n\t}\n\n\t// TODO smart update\n\tupdate () {\n\t\t// skip dirty check, since this is basically just a facade\n\n\t\tif ( this.pendingNewIndices ) {\n\t\t\tthis.bubbled.length = 0;\n\t\t\tthis.updatePostShuffle();\n\t\t\treturn;\n\t\t}\n\n\t\tif ( this.updating ) return;\n\t\tthis.updating = true;\n\n\t\tconst value = this.context.get();\n\t\tconst wasArray = this.isArray;\n\n\t\tlet toRemove;\n\t\tlet oldKeys;\n\t\tlet reset = true;\n\t\tlet i;\n\n\t\tif ( this.isArray = Array.isArray( value ) ) {\n\t\t\tif ( wasArray ) {\n\t\t\t\treset = false;\n\t\t\t\tif ( this.iterations.length > value.length ) {\n\t\t\t\t\ttoRemove = this.iterations.splice( value.length );\n\t\t\t\t}\n\t\t\t}\n\t\t} else if ( isObject( value ) && !wasArray ) {\n\t\t\treset = false;\n\t\t\ttoRemove = [];\n\t\t\toldKeys = {};\n\t\t\ti = this.iterations.length;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tconst fragment = this.iterations[i];\n\t\t\t\tif ( fragment.key in value ) {\n\t\t\t\t\toldKeys[ fragment.key ] = true;\n\t\t\t\t} else {\n\t\t\t\t\tthis.iterations.splice( i, 1 );\n\t\t\t\t\ttoRemove.push( fragment );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( reset ) {\n\t\t\ttoRemove = this.iterations;\n\t\t\tthis.iterations = [];\n\t\t}\n\n\t\tif ( toRemove ) {\n\t\t\ttoRemove.forEach( fragment => {\n\t\t\t\tfragment.unbind();\n\t\t\t\tfragment.unrender( true );\n\t\t\t});\n\t\t}\n\n\t\t// update the remaining ones\n\t\tif ( !reset && this.isArray && this.bubbled && this.bubbled.length ) {\n\t\t\tthis.bubbled.forEach( i => this.iterations[i] && this.iterations[i].update() );\n\t\t} else {\n\t\t\tthis.iterations.forEach( update );\n\t\t}\n\n\t\tif ( this.bubbled ) this.bubbled.length = 0;\n\n\t\t// add new iterations\n\t\tconst newLength = Array.isArray( value ) ?\n\t\t\tvalue.length :\n\t\t\tisObject( value ) ?\n\t\t\t\tObject.keys( value ).length :\n\t\t\t\t0;\n\n\t\tlet docFrag;\n\t\tlet fragment;\n\n\t\tif ( newLength > this.iterations.length ) {\n\t\t\tdocFrag = this.rendered ? createDocumentFragment() : null;\n\t\t\ti = this.iterations.length;\n\n\t\t\tif ( Array.isArray( value ) ) {\n\t\t\t\twhile ( i < value.length ) {\n\t\t\t\t\tfragment = this.createIteration( i, i );\n\n\t\t\t\t\tthis.iterations.push( fragment );\n\t\t\t\t\tif ( this.rendered ) fragment.render( docFrag );\n\n\t\t\t\t\ti += 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\telse if ( isObject( value ) ) {\n\t\t\t\t// TODO this is a dreadful hack. There must be a neater way\n\t\t\t\tif ( this.indexRef && !this.keyRef ) {\n\t\t\t\t\tconst refs = this.indexRef.split( ',' );\n\t\t\t\t\tthis.keyRef = refs[0];\n\t\t\t\t\tthis.indexRef = refs[1];\n\t\t\t\t}\n\n\t\t\t\tObject.keys( value ).forEach( key => {\n\t\t\t\t\tif ( !oldKeys || !( key in oldKeys ) ) {\n\t\t\t\t\t\tfragment = this.createIteration( key, i );\n\n\t\t\t\t\t\tthis.iterations.push( fragment );\n\t\t\t\t\t\tif ( this.rendered ) fragment.render( docFrag );\n\n\t\t\t\t\t\ti += 1;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif ( this.rendered ) {\n\t\t\t\tconst parentNode = this.parent.findParentNode();\n\t\t\t\tconst anchor = this.parent.findNextNode( this.owner );\n\n\t\t\t\tparentNode.insertBefore( docFrag, anchor );\n\t\t\t}\n\t\t}\n\n\t\tthis.updating = false;\n\t}\n\n\tupdatePostShuffle () {\n\t\tconst newIndices = this.pendingNewIndices[ 0 ];\n\n\t\t// map first shuffle through\n\t\tthis.pendingNewIndices.slice( 1 ).forEach( indices => {\n\t\t\tnewIndices.forEach( ( newIndex, oldIndex ) => {\n\t\t\t\tnewIndices[ oldIndex ] = indices[ newIndex ];\n\t\t\t});\n\t\t});\n\n\t\t// This algorithm (for detaching incorrectly-ordered fragments from the DOM and\n\t\t// storing them in a document fragment for later reinsertion) seems a bit hokey,\n\t\t// but it seems to work for now\n\t\tconst len = this.context.get().length;\n\t\tconst oldLen = this.previousIterations.length;\n\t\tconst removed = {};\n\t\tlet i;\n\n\t\tnewIndices.forEach( ( newIndex, oldIndex ) => {\n\t\t\tconst fragment = this.previousIterations[ oldIndex ];\n\t\t\tthis.previousIterations[ oldIndex ] = null;\n\n\t\t\tif ( newIndex === -1 ) {\n\t\t\t\tremoved[ oldIndex ] = fragment;\n\t\t\t} else if ( fragment.index !== newIndex ) {\n\t\t\t\tconst model = this.context.joinKey( newIndex );\n\t\t\t\tfragment.index = fragment.key = newIndex;\n\t\t\t\tfragment.context = model;\n\t\t\t\tif ( this.owner.template.z ) {\n\t\t\t\t\tfragment.aliases = {};\n\t\t\t\t\tfragment.aliases[ this.owner.template.z[0].n ] = model;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// if the array was spliced outside of ractive, sometimes there are leftover fragments not in the newIndices\n\t\tthis.previousIterations.forEach( ( frag, i ) => {\n\t\t\tif ( frag ) removed[ i ] = frag;\n\t\t});\n\n\t\t// create new/move existing iterations\n\t\tconst docFrag = this.rendered ? createDocumentFragment() : null;\n\t\tconst parentNode = this.rendered ? this.parent.findParentNode() : null;\n\n\t\tconst contiguous = 'startIndex' in newIndices;\n\t\ti = contiguous ? newIndices.startIndex : 0;\n\n\t\tfor ( i; i < len; i++ ) {\n\t\t\tconst frag = this.iterations[i];\n\n\t\t\tif ( frag && contiguous ) {\n\t\t\t\t// attach any built-up iterations\n\t\t\t\tif ( this.rendered ) {\n\t\t\t\t\tif ( removed[i] ) docFrag.appendChild( removed[i].detach() );\n\t\t\t\t\tif ( docFrag.childNodes.length  ) parentNode.insertBefore( docFrag, frag.firstNode() );\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif ( !frag ) this.iterations[i] = this.createIteration( i, i );\n\n\t\t\tif ( this.rendered ) {\n\t\t\t\tif ( removed[i] ) docFrag.appendChild( removed[i].detach() );\n\n\t\t\t\tif ( frag ) docFrag.appendChild( frag.detach() );\n\t\t\t\telse {\n\t\t\t\t\tthis.iterations[i].render( docFrag );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// append any leftovers\n\t\tif ( this.rendered ) {\n\t\t\tfor ( i = len; i < oldLen; i++ ) {\n\t\t\t\tif ( removed[i] ) docFrag.appendChild( removed[i].detach() );\n\t\t\t}\n\n\t\t\tif ( docFrag.childNodes.length ) {\n\t\t\t\tparentNode.insertBefore( docFrag, this.owner.findNextNode() );\n\t\t\t}\n\t\t}\n\n\t\t// trigger removal on old nodes\n\t\tObject.keys( removed ).forEach( k => removed[k].unbind().unrender( true ) );\n\n\t\tthis.iterations.forEach( update );\n\n\t\tthis.pendingNewIndices = null;\n\n\t\tthis.shuffled();\n\t}\n}\n","import { createDocumentFragment } from '../../utils/dom';\nimport { SECTION_EACH, SECTION_IF, SECTION_IF_WITH, SECTION_UNLESS, SECTION_WITH } from '../../config/types';\nimport { isObject } from '../../utils/is';\nimport Fragment from '../Fragment';\nimport RepeatedFragment from '../RepeatedFragment';\nimport { MustacheContainer } from './shared/Mustache';\nimport { keep } from '../../shared/set';\nimport runloop from '../../global/runloop';\n\nfunction isEmpty ( value ) {\n\treturn !value ||\n\t       ( Array.isArray( value ) && value.length === 0 ) ||\n\t\t   ( isObject( value ) && Object.keys( value ).length === 0 );\n}\n\nfunction getType ( value, hasIndexRef ) {\n\tif ( hasIndexRef || Array.isArray( value ) ) return SECTION_EACH;\n\tif ( isObject( value ) || typeof value === 'function' ) return SECTION_IF_WITH;\n\tif ( value === undefined ) return null;\n\treturn SECTION_IF;\n}\n\nexport default class Section extends MustacheContainer {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.sectionType = options.template.n || null;\n\t\tthis.templateSectionType = this.sectionType;\n\t\tthis.subordinate = options.template.l === 1;\n\t\tthis.fragment = null;\n\t}\n\n\tbind () {\n\t\tsuper.bind();\n\n\t\tif ( this.subordinate ) {\n\t\t\tthis.sibling = this.parentFragment.items[ this.parentFragment.items.indexOf( this ) - 1 ];\n\t\t\tthis.sibling.nextSibling = this;\n\t\t}\n\n\t\t// if we managed to bind, we need to create children\n\t\tif ( this.model ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.update();\n\t\t} else if ( this.sectionType && this.sectionType === SECTION_UNLESS && ( !this.sibling || !this.sibling.isTruthy() ) ) {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\towner: this,\n\t\t\t\ttemplate: this.template.f\n\t\t\t}).bind();\n\t\t}\n\t}\n\n\tdetach () {\n\t\tconst frag = this.fragment || this.detached;\n\t\treturn frag ? frag.detach() : super.detach();\n\t}\n\n\tisTruthy () {\n\t\tif ( this.subordinate && this.sibling.isTruthy() ) return true;\n\t\tconst value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n\t\treturn !!value && ( this.templateSectionType === SECTION_IF_WITH || !isEmpty( value ) );\n\t}\n\n\trebind ( next, previous, safe ) {\n\t\tif ( super.rebind( next, previous, safe ) ) {\n\t\t\tif ( this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ) {\n\t\t\t\tthis.fragment.rebind( next );\n\t\t\t}\n\t\t}\n\t}\n\n\trender ( target, occupants ) {\n\t\tthis.rendered = true;\n\t\tif ( this.fragment ) this.fragment.render( target, occupants );\n\t}\n\n\tshuffle ( newIndices ) {\n\t\tif ( this.fragment && this.sectionType === SECTION_EACH ) {\n\t\t\tthis.fragment.shuffle( newIndices );\n\t\t}\n\t}\n\n\tunbind () {\n\t\tsuper.unbind();\n\t\tif ( this.fragment ) this.fragment.unbind();\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tif ( this.rendered && this.fragment ) this.fragment.unrender( shouldDestroy );\n\t\tthis.rendered = false;\n\t}\n\n\tupdate () {\n\t\tif ( !this.dirty ) return;\n\n\t\tif ( this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ) {\n\t\t\tthis.fragment.context = this.model;\n\t\t}\n\n\t\tif ( !this.model && this.sectionType !== SECTION_UNLESS ) return;\n\n\t\tthis.dirty = false;\n\n\t\tconst value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n\t\tconst siblingFalsey = !this.subordinate || !this.sibling.isTruthy();\n\t\tconst lastType = this.sectionType;\n\n\t\t// watch for switching section types\n\t\tif ( this.sectionType === null || this.templateSectionType === null ) this.sectionType = getType( value, this.template.i );\n\t\tif ( lastType && lastType !== this.sectionType && this.fragment ) {\n\t\t\tif ( this.rendered ) {\n\t\t\t\tthis.fragment.unbind().unrender( true );\n\t\t\t}\n\n\t\t\tthis.fragment = null;\n\t\t}\n\n\t\tlet newFragment;\n\n\t\tconst fragmentShouldExist = this.sectionType === SECTION_EACH || // each always gets a fragment, which may have no iterations\n\t\t                            this.sectionType === SECTION_WITH || // with (partial context) always gets a fragment\n\t\t                            ( siblingFalsey && ( this.sectionType === SECTION_UNLESS ? !this.isTruthy() : this.isTruthy() ) ); // if, unless, and if-with depend on siblings and the condition\n\n\t\tif ( fragmentShouldExist ) {\n\t\t\tif ( !this.fragment ) this.fragment = this.detached;\n\n\t\t\tif ( this.fragment ) {\n\t\t\t\t// check for detached fragment\n\t\t\t\tif ( this.detached ) {\n\t\t\t\t\tattach( this, this.fragment );\n\t\t\t\t\tthis.detached = false;\n\t\t\t\t\tthis.rendered = true;\n\t\t\t\t}\n\n\t\t\t\tthis.fragment.update();\n\t\t\t} else {\n\t\t\t\tif ( this.sectionType === SECTION_EACH ) {\n\t\t\t\t\tnewFragment = new RepeatedFragment({\n\t\t\t\t\t\towner: this,\n\t\t\t\t\t\ttemplate: this.template.f,\n\t\t\t\t\t\tindexRef: this.template.i\n\t\t\t\t\t}).bind( this.model );\n\t\t\t\t} else {\n\t\t\t\t\t// only with and if-with provide context - if and unless do not\n\t\t\t\t\tconst context = this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ? this.model : null;\n\t\t\t\t\tnewFragment = new Fragment({\n\t\t\t\t\t\towner: this,\n\t\t\t\t\t\ttemplate: this.template.f\n\t\t\t\t\t}).bind( context );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif ( this.fragment && this.rendered ) {\n\t\t\t\tif ( keep !== true ) {\n\t\t\t\t\tthis.fragment.unbind().unrender( true );\n\t\t\t\t} else {\n\t\t\t\t\tthis.unrender( false );\n\t\t\t\t\tthis.detached = this.fragment;\n\t\t\t\t\trunloop.scheduleTask( () => this.detach() );\n\t\t\t\t}\n\t\t\t} else if ( this.fragment ) {\n\t\t\t\tthis.fragment.unbind();\n\t\t\t}\n\n\t\t\tthis.fragment = null;\n\t\t}\n\n\t\tif ( newFragment ) {\n\t\t\tif ( this.rendered ) {\n\t\t\t\tattach( this, newFragment );\n\t\t\t}\n\n\t\t\tthis.fragment = newFragment;\n\t\t}\n\n\t\tif ( this.nextSibling ) {\n\t\t\tthis.nextSibling.dirty = true;\n\t\t\tthis.nextSibling.update();\n\t\t}\n\t}\n}\n\nfunction attach ( section, fragment ) {\n\tconst anchor = section.parentFragment.findNextNode( section );\n\n\tif ( anchor ) {\n\t\tconst docFrag = createDocumentFragment();\n\t\tfragment.render( docFrag );\n\n\t\tanchor.parentNode.insertBefore( docFrag, anchor );\n\t} else {\n\t\tfragment.render( section.parentFragment.findParentNode() );\n\t}\n}\n","import Element from '../../Element';\nimport { toArray } from '../../../../utils/array';\nimport getSelectedOptions from '../../../../utils/getSelectedOptions';\n\nexport default class Select extends Element {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\t\tthis.options = [];\n\t}\n\n\tfoundNode ( node ) {\n\t\tif ( this.binding ) {\n\t\t\tconst selectedOptions = getSelectedOptions( node );\n\n\t\t\tif ( selectedOptions.length > 0 ) {\n\t\t\t\tthis.selectedOptions = selectedOptions;\n\t\t\t}\n\t\t}\n\t}\n\n\trender ( target, occupants ) {\n\t\tsuper.render( target, occupants );\n\t\tthis.sync();\n\n\t\tconst node = this.node;\n\n\t\tlet i = node.options.length;\n\t\twhile ( i-- ) {\n\t\t\tnode.options[i].defaultSelected = node.options[i].selected;\n\t\t}\n\n\t\tthis.rendered = true;\n\t}\n\n\tsync () {\n\t\tconst selectNode = this.node;\n\n\t\tif ( !selectNode ) return;\n\n\t\tconst options = toArray( selectNode.options );\n\n\t\tif ( this.selectedOptions ) {\n\t\t\toptions.forEach( o => {\n\t\t\t\tif ( this.selectedOptions.indexOf( o ) >= 0 ) o.selected = true;\n\t\t\t\telse o.selected = false;\n\t\t\t});\n\t\t\tthis.binding.setFromNode( selectNode );\n\t\t\tdelete this.selectedOptions;\n\t\t\treturn;\n\t\t}\n\n\t\tconst selectValue = this.getAttribute( 'value' );\n\t\tconst isMultiple = this.getAttribute( 'multiple' );\n\t\tconst array = isMultiple && Array.isArray( selectValue );\n\n\t\t// If the <select> has a specified value, that should override\n\t\t// these options\n\t\tif ( selectValue !== undefined ) {\n\t\t\tlet optionWasSelected;\n\n\t\t\toptions.forEach( o => {\n\t\t\t\tconst optionValue = o._ractive ? o._ractive.value : o.value;\n\t\t\t\tconst shouldSelect = isMultiple ?\n\t\t\t\t\tarray && this.valueContains( selectValue, optionValue ) :\n\t\t\t\t\tthis.compare( selectValue, optionValue );\n\n\t\t\t\tif ( shouldSelect ) {\n\t\t\t\t\toptionWasSelected = true;\n\t\t\t\t}\n\n\t\t\t\to.selected = shouldSelect;\n\t\t\t});\n\n\t\t\tif ( !optionWasSelected && !isMultiple ) {\n\t\t\t\tif ( this.binding ) {\n\t\t\t\t\tthis.binding.forceUpdate();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Otherwise the value should be initialised according to which\n\t\t// <option> element is selected, if twoway binding is in effect\n\t\telse if ( this.binding ) {\n\t\t\tthis.binding.forceUpdate();\n\t\t}\n\t}\n\tvalueContains ( selectValue, optionValue ) {\n\t\tlet i = selectValue.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( this.compare( optionValue, selectValue[i] ) ) return true;\n\t\t}\n\t}\n\tcompare (optionValue, selectValue) {\n\t\tconst comparator = this.getAttribute( 'value-comparator' );\n\t\tif ( comparator ) {\n\t\t\tif (typeof comparator === 'function') {\n\t\t\t\treturn comparator( selectValue, optionValue );\n\t\t\t}\n\t\t\tif ( selectValue && optionValue ) {\n\t\t\t\treturn selectValue[comparator] == optionValue[comparator];\n\t\t\t}\n\t\t}\n\t\treturn selectValue == optionValue;\n\t}\n\tupdate () {\n\t\tconst dirty = this.dirty;\n\t\tsuper.update();\n\t\tif ( dirty ) {\n\t\t\tthis.sync();\n\t\t}\n\t}\n}\n","import { ATTRIBUTE } from '../../../../config/types';\nimport Input from './Input';\nimport { isBindable } from '../binding/selectBinding';\nimport runloop from '../../../../global/runloop';\nimport createItem from '../../createItem';\nimport Fragment from '../../../Fragment';\n\nexport default class Textarea extends Input {\n\tconstructor( options ) {\n\t\tconst template = options.template;\n\n\t\toptions.deferContent = true;\n\n\t\tsuper( options );\n\n\t\t// check for single interpolator binding\n\t\tif ( !this.attributeByName.value ) {\n\t\t\tif ( template.f && isBindable( { template } ) ) {\n\t\t\t\tthis.attributes.push( createItem( {\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: { t: ATTRIBUTE, f: template.f, n: 'value' },\n\t\t\t\t\tparentFragment: this.parentFragment\n\t\t\t\t} ) );\n\t\t\t} else {\n\t\t\t\tthis.fragment = new Fragment({ owner: this, cssIds: null, template: template.f });\n\t\t\t}\n\t\t}\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\n\t\t\tif ( this.rendered && !this.binding && this.fragment ) {\n\t\t\t\trunloop.scheduleTask( () => {\n\t\t\t\t\tthis.dirty = false;\n\t\t\t\t\tthis.node.value = this.fragment.toString();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.parentFragment.bubble(); // default behaviour\n\t\t}\n\t}\n}\n","import progressiveText from './shared/progressiveText';\nimport { TEXT } from '../../config/types';\nimport { escapeHtml } from '../../utils/html';\nimport Item from './shared/Item';\nimport { detachNode } from '../../utils/dom';\nimport { inAttributes } from './element/ConditionalAttribute';\nimport noop from '../../utils/noop';\n\nexport default class Text extends Item {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\t\tthis.type = TEXT;\n\t}\n\n\tdetach () {\n\t\treturn detachNode( this.node );\n\t}\n\n\tfirstNode () {\n\t\treturn this.node;\n\t}\n\n\trender ( target, occupants ) {\n\t\tif ( inAttributes() ) return;\n\t\tthis.rendered = true;\n\n\t\tprogressiveText( this, target, occupants, this.template );\n\t}\n\n\ttoString ( escape ) {\n\t\treturn escape ? escapeHtml( this.template ) : this.template;\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tif ( this.rendered && shouldDestroy ) this.detach();\n\t\tthis.rendered = false;\n\t}\n\n\tvalueOf () {\n\t\treturn this.template;\n\t}\n}\n\nconst proto = Text.prototype;\nproto.bind = proto.unbind = proto.update = noop;\n","import { isClient, vendors } from '../../../../config/environment';\nimport { createElement } from '../../../../utils/dom';\nimport hyphenateCamel from '../../../../utils/hyphenateCamel';\n\nlet prefix;\n\nif ( !isClient ) {\n\tprefix = null;\n} else {\n\tconst prefixCache = {};\n\tconst testStyle = createElement( 'div' ).style;\n\n\t// technically this also normalizes on hyphenated styles as well\n\tprefix = function ( prop ) {\n\t\tif ( !prefixCache[ prop ] ) {\n\t\t\tconst name = hyphenateCamel( prop );\n\n\t\t\tif ( testStyle[ prop ] !== undefined ) {\n\t\t\t\tprefixCache[ prop ] = name;\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\t// test vendors...\n\t\t\t\tlet i = vendors.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tconst vendor = `-${vendors[i]}-${name}`;\n\t\t\t\t\tif ( testStyle[ vendor ] !== undefined ) {\n\t\t\t\t\t\tprefixCache[ prop ] = vendor;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn prefixCache[ prop ];\n\t};\n}\n\nexport default prefix;\n","import { win, doc, vendors } from './environment';\n\nexport let visible;\nlet hidden = 'hidden';\n\nif ( doc ) {\n\tlet prefix;\n\n\tif ( hidden in doc ) {\n\t\tprefix = '';\n\t} else {\n\t\tlet i = vendors.length;\n\t\twhile ( i-- ) {\n\t\t\tconst vendor = vendors[i];\n\t\t\thidden = vendor + 'Hidden';\n\n\t\t\tif ( hidden in doc ) {\n\t\t\t\tprefix = vendor;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( prefix !== undefined ) {\n\t\tdoc.addEventListener( prefix + 'visibilitychange', onChange );\n\t\tonChange();\n\t} else {\n\t\t// gah, we're in an old browser\n\t\tif ( 'onfocusout' in doc ) {\n\t\t\tdoc.addEventListener( 'focusout', onHide );\n\t\t\tdoc.addEventListener( 'focusin', onShow );\n\t\t}\n\n\t\telse {\n\t\t\twin.addEventListener( 'pagehide', onHide );\n\t\t\twin.addEventListener( 'blur', onHide );\n\n\t\t\twin.addEventListener( 'pageshow', onShow );\n\t\t\twin.addEventListener( 'focus', onShow );\n\t\t}\n\n\t\tvisible = true; // until proven otherwise. Not ideal but hey\n\t}\n}\n\nfunction onChange () {\n\tvisible = !doc[ hidden ];\n}\n\nfunction onHide () {\n\tvisible = false;\n}\n\nfunction onShow () {\n\tvisible = true;\n}\n","import { vendors } from '../../../../config/environment';\n\nconst vendorPattern = new RegExp( '^(?:' + vendors.join( '|' ) + ')([A-Z])' );\n\nexport default function ( str ) {\n\tif ( !str ) return ''; // edge case\n\n\tif ( vendorPattern.test( str ) ) str = '-' + str;\n\n\treturn str.replace( /[A-Z]/g, match => '-' + match.toLowerCase() );\n}\n","import { missingPlugin } from '../../../../config/errors';\nimport { isClient } from '../../../../config/environment';\nimport { warnIfDebug, warnOnceIfDebug } from '../../../../utils/log';\nimport { createElement } from '../../../../utils/dom';\nimport interpolate from '../../../../shared/interpolate';\nimport Ticker from '../../../../shared/Ticker';\nimport hyphenate from './hyphenate';\n\nlet createTransitions;\n\nif ( !isClient ) {\n\tcreateTransitions = null;\n} else {\n\tconst testStyle = createElement( 'div' ).style;\n\tconst linear = x => x;\n\n\tconst canUseCssTransitions = {};\n\tconst cannotUseCssTransitions = {};\n\n\t// determine some facts about our environment\n\tlet TRANSITION;\n\tlet TRANSITIONEND;\n\tlet CSS_TRANSITIONS_ENABLED;\n\tlet TRANSITION_DURATION;\n\tlet TRANSITION_PROPERTY;\n\tlet TRANSITION_TIMING_FUNCTION;\n\n\tif ( testStyle.transition !== undefined ) {\n\t\tTRANSITION = 'transition';\n\t\tTRANSITIONEND = 'transitionend';\n\t\tCSS_TRANSITIONS_ENABLED = true;\n\t} else if ( testStyle.webkitTransition !== undefined ) {\n\t\tTRANSITION = 'webkitTransition';\n\t\tTRANSITIONEND = 'webkitTransitionEnd';\n\t\tCSS_TRANSITIONS_ENABLED = true;\n\t} else {\n\t\tCSS_TRANSITIONS_ENABLED = false;\n\t}\n\n\tif ( TRANSITION ) {\n\t\tTRANSITION_DURATION = TRANSITION + 'Duration';\n\t\tTRANSITION_PROPERTY = TRANSITION + 'Property';\n\t\tTRANSITION_TIMING_FUNCTION = TRANSITION + 'TimingFunction';\n\t}\n\n\tcreateTransitions = function ( t, to, options, changedProperties, resolve ) {\n\n\t\t// Wait a beat (otherwise the target styles will be applied immediately)\n\t\t// TODO use a fastdom-style mechanism?\n\t\tsetTimeout( () => {\n\t\t\tlet jsTransitionsComplete;\n\t\t\tlet cssTransitionsComplete;\n\t\t\tlet cssTimeout; // eslint-disable-line prefer-const\n\n\t\t\tfunction transitionDone () { clearTimeout( cssTimeout ); }\n\n\t\t\tfunction checkComplete () {\n\t\t\t\tif ( jsTransitionsComplete && cssTransitionsComplete ) {\n\t\t\t\t\tt.unregisterCompleteHandler( transitionDone );\n\t\t\t\t\t// will changes to events and fire have an unexpected consequence here?\n\t\t\t\t\tt.ractive.fire( t.name + ':end', t.node, t.isIntro );\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// this is used to keep track of which elements can use CSS to animate\n\t\t\t// which properties\n\t\t\tconst hashPrefix = ( t.node.namespaceURI || '' ) + t.node.tagName;\n\n\t\t\t// need to reset transition properties\n\t\t\tconst style = t.node.style;\n\t\t\tconst previous = {\n\t\t\t\tproperty: style[ TRANSITION_PROPERTY ],\n\t\t\t\ttiming: style[ TRANSITION_TIMING_FUNCTION ],\n\t\t\t\tduration: style[ TRANSITION_DURATION ]\n\t\t\t};\n\n\t\t\tfunction transitionEndHandler ( event ) {\n\t\t\t\tconst index = changedProperties.indexOf( event.propertyName );\n\n\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\tchangedProperties.splice( index, 1 );\n\t\t\t\t}\n\n\t\t\t\tif ( changedProperties.length ) {\n\t\t\t\t\t// still transitioning...\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tclearTimeout( cssTimeout );\n\t\t\t\tcssTransitionsDone();\n\t\t\t}\n\n\t\t\tfunction cssTransitionsDone () {\n\t\t\t\tstyle[ TRANSITION_PROPERTY ] = previous.property;\n\t\t\t\tstyle[ TRANSITION_TIMING_FUNCTION ] = previous.duration;\n\t\t\t\tstyle[ TRANSITION_DURATION ] = previous.timing;\n\n\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\n\n\t\t\t\tcssTransitionsComplete = true;\n\t\t\t\tcheckComplete();\n\t\t\t}\n\n\t\t\tt.node.addEventListener( TRANSITIONEND, transitionEndHandler, false );\n\n\t\t\t// safety net in case transitionend never fires\n\t\t\tcssTimeout = setTimeout( () => {\n\t\t\t\tchangedProperties = [];\n\t\t\t\tcssTransitionsDone();\n\t\t\t}, options.duration + ( options.delay || 0 ) + 50 );\n\t\t\tt.registerCompleteHandler( transitionDone );\n\n\t\t\tstyle[ TRANSITION_PROPERTY ] = changedProperties.join( ',' );\n\t\t\tconst easingName = hyphenate( options.easing || 'linear' );\n\t\t\tstyle[ TRANSITION_TIMING_FUNCTION ] = easingName;\n\t\t\tconst cssTiming = style[ TRANSITION_TIMING_FUNCTION ] === easingName;\n\t\t\tstyle[ TRANSITION_DURATION ] = ( options.duration / 1000 ) + 's';\n\n\t\t\tsetTimeout( () => {\n\t\t\t\tlet i = changedProperties.length;\n\t\t\t\tlet hash;\n\t\t\t\tlet originalValue = null;\n\t\t\t\tlet index;\n\t\t\t\tconst propertiesToTransitionInJs = [];\n\t\t\t\tlet prop;\n\t\t\t\tlet suffix;\n\t\t\t\tlet interpolator;\n\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tprop = changedProperties[i];\n\t\t\t\t\thash = hashPrefix + prop;\n\n\t\t\t\t\tif ( cssTiming && CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\tconst initial = style[ prop ];\n\t\t\t\t\t\tstyle[ prop ] = to[ prop ];\n\n\t\t\t\t\t\t// If we're not sure if CSS transitions are supported for\n\t\t\t\t\t\t// this tag/property combo, find out now\n\t\t\t\t\t\tif ( !( hash in canUseCssTransitions ) ) {\n\t\t\t\t\t\t\toriginalValue = t.getStyle( prop );\n\n\t\t\t\t\t\t\t// if this property is transitionable in this browser,\n\t\t\t\t\t\t\t// the current style will be different from the target style\n\t\t\t\t\t\t\tcanUseCssTransitions[ hash ] = ( t.getStyle( prop ) != to[ prop ] );\n\t\t\t\t\t\t\tcannotUseCssTransitions[ hash ] = !canUseCssTransitions[ hash ];\n\n\t\t\t\t\t\t\t// Reset, if we're going to use timers after all\n\t\t\t\t\t\t\tif ( cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t\t\tstyle[ prop ] = initial;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !cssTiming || !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t// we need to fall back to timer-based stuff\n\t\t\t\t\t\tif ( originalValue === null ) originalValue = t.getStyle( prop );\n\n\t\t\t\t\t\t// need to remove this from changedProperties, otherwise transitionEndHandler\n\t\t\t\t\t\t// will get confused\n\t\t\t\t\t\tindex = changedProperties.indexOf( prop );\n\t\t\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\t\t\twarnIfDebug( 'Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!', { node: t.node });\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tchangedProperties.splice( index, 1 );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// TODO Determine whether this property is animatable at all\n\n\t\t\t\t\t\tsuffix = /[^\\d]*$/.exec( originalValue )[0];\n\t\t\t\t\t\tinterpolator = interpolate( parseFloat( originalValue ), parseFloat( to[ prop ] ) );\n\n\t\t\t\t\t\t// ...then kick off a timer-based transition\n\t\t\t\t\t\tif ( interpolator ) {\n\t\t\t\t\t\t\tpropertiesToTransitionInJs.push({\n\t\t\t\t\t\t\t\tname: prop,\n\t\t\t\t\t\t\t\tinterpolator,\n\t\t\t\t\t\t\t\tsuffix\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstyle[ prop ] = to[ prop ];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\toriginalValue = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// javascript transitions\n\t\t\t\tif ( propertiesToTransitionInJs.length ) {\n\t\t\t\t\tlet easing;\n\n\t\t\t\t\tif ( typeof options.easing === 'string' ) {\n\t\t\t\t\t\teasing = t.ractive.easing[ options.easing ];\n\n\t\t\t\t\t\tif ( !easing ) {\n\t\t\t\t\t\t\twarnOnceIfDebug( missingPlugin( options.easing, 'easing' ) );\n\t\t\t\t\t\t\teasing = linear;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if ( typeof options.easing === 'function' ) {\n\t\t\t\t\t\teasing = options.easing;\n\t\t\t\t\t} else {\n\t\t\t\t\t\teasing = linear;\n\t\t\t\t\t}\n\n\t\t\t\t\tnew Ticker({\n\t\t\t\t\t\tduration: options.duration,\n\t\t\t\t\t\teasing,\n\t\t\t\t\t\tstep ( pos ) {\n\t\t\t\t\t\t\tlet i = propertiesToTransitionInJs.length;\n\t\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\t\tconst prop = propertiesToTransitionInJs[i];\n\t\t\t\t\t\t\t\tstyle[ prop.name ] = prop.interpolator( pos ) + prop.suffix;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete () {\n\t\t\t\t\t\t\tjsTransitionsComplete = true;\n\t\t\t\t\t\t\tcheckComplete();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tjsTransitionsComplete = true;\n\t\t\t\t}\n\n\t\t\t\tif ( changedProperties.length ) {\n\t\t\t\t\tstyle[ TRANSITION_PROPERTY ] = changedProperties.join( ',' );\n\t\t\t\t} else {\n\t\t\t\t\tstyle[ TRANSITION_PROPERTY ] = 'none';\n\n\t\t\t\t\t// We need to cancel the transitionEndHandler, and deal with\n\t\t\t\t\t// the fact that it will never fire\n\t\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\n\t\t\t\t\tcssTransitionsComplete = true;\n\t\t\t\t\tcheckComplete();\n\t\t\t\t}\n\t\t\t}, 0 );\n\t\t}, options.delay || 0 );\n\t};\n}\n\nexport default createTransitions;\n","import { win } from '../../../config/environment';\nimport { addToArray, removeFromArray } from '../../../utils/array';\nimport findElement from '../shared/findElement';\nimport prefix from './transitions/prefix';\nimport { warnOnceIfDebug } from '../../../utils/log';\nimport { missingPlugin } from '../../../config/errors';\nimport { findInViewHierarchy } from '../../../shared/registry';\nimport { visible } from '../../../config/visibility';\nimport createTransitions from './transitions/createTransitions';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport noop from '../../../utils/noop';\n\nconst getComputedStyle = win && win.getComputedStyle;\nconst resolved = Promise.resolve();\n\nconst names = {\n\tt0: 'intro-outro',\n\tt1: 'intro',\n\tt2: 'outro'\n};\n\nexport default class Transition {\n\tconstructor ( options ) {\n\t\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\t\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\n\t\tthis.ractive = this.owner.ractive;\n\t\tthis.template = options.template;\n\t\tthis.parentFragment = options.parentFragment;\n\t\tthis.options = options;\n\t\tthis.onComplete = [];\n\t}\n\n\tanimateStyle ( style, value, options ) {\n\t\tif ( arguments.length === 4 ) {\n\t\t\tthrow new Error( 't.animateStyle() returns a promise - use .then() instead of passing a callback' );\n\t\t}\n\n\t\t// Special case - page isn't visible. Don't animate anything, because\n\t\t// that way you'll never get CSS transitionend events\n\t\tif ( !visible ) {\n\t\t\tthis.setStyle( style, value );\n\t\t\treturn resolved;\n\t\t}\n\n\t\tlet to;\n\n\t\tif ( typeof style === 'string' ) {\n\t\t\tto = {};\n\t\t\tto[ style ] = value;\n\t\t} else {\n\t\t\tto = style;\n\n\t\t\t// shuffle arguments\n\t\t\toptions = value;\n\t\t}\n\n\t\treturn new Promise( fulfil => {\n\t\t\t// Edge case - if duration is zero, set style synchronously and complete\n\t\t\tif ( !options.duration ) {\n\t\t\t\tthis.setStyle( to );\n\t\t\t\tfulfil();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Get a list of the properties we're animating\n\t\t\tconst propertyNames = Object.keys( to );\n\t\t\tconst changedProperties = [];\n\n\t\t\t// Store the current styles\n\t\t\tconst computedStyle = getComputedStyle( this.node );\n\n\t\t\tlet i = propertyNames.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tconst prop = propertyNames[i];\n\t\t\t\tconst name = prefix( prop );\n\n\t\t\t\tconst current = computedStyle[ prefix( prop ) ];\n\n\t\t\t\t// record the starting points\n\t\t\t\tconst init = this.node.style[name];\n\t\t\t\tif ( !( name in this.originals ) ) this.originals[ name ] = this.node.style[ name ];\n\t\t\t\tthis.node.style[ name ] = to[ prop ];\n\t\t\t\tthis.targets[ name ] = this.node.style[ name ];\n\t\t\t\tthis.node.style[ name ] = init;\n\n\t\t\t\t// we need to know if we're actually changing anything\n\t\t\t\tif ( current != to[ prop ] ) { // use != instead of !==, so we can compare strings with numbers\n\t\t\t\t\tchangedProperties.push( name );\n\n\t\t\t\t\t// if we happened to prefix, make sure there is a properly prefixed value\n\t\t\t\t\tto[ name ] = to[ prop ];\n\n\t\t\t\t\t// make the computed style explicit, so we can animate where\n\t\t\t\t\t// e.g. height='auto'\n\t\t\t\t\tthis.node.style[ name ] = current;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If we're not actually changing anything, the transitionend event\n\t\t\t// will never fire! So we complete early\n\t\t\tif ( !changedProperties.length ) {\n\t\t\t\tfulfil();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcreateTransitions( this, to, options, changedProperties, fulfil );\n\t\t});\n\t}\n\n\tbind () {\n\t\tconst options = this.options;\n\t\tconst type = options.template && options.template.v;\n\t\tif ( type ) {\n\t\t\tif ( type === 't0' || type === 't1' ) this.element.intro = this;\n\t\t\tif ( type === 't0' || type === 't2' ) this.element.outro = this;\n\t\t\tthis.eventName = names[ type ];\n\t\t}\n\n\t\tconst ractive = this.owner.ractive;\n\n\t\tthis.name = options.name || options.template.n;\n\n\t\tif ( options.params ) {\n\t\t\tthis.params = options.params;\n\t\t}\n\n\t\tif ( typeof this.name === 'function' ) {\n\t\t\tthis._fn = this.name;\n\t\t\tthis.name = this._fn.name;\n\t\t} else {\n\t\t\tthis._fn = findInViewHierarchy( 'transitions', ractive, this.name );\n\t\t}\n\n\t\tif ( !this._fn ) {\n\t\t\twarnOnceIfDebug( missingPlugin( this.name, 'transition' ), { ractive });\n\t\t}\n\n\t\tsetupArgsFn( this, options.template );\n\t}\n\n\tgetParams () {\n\t\tif ( this.params ) return this.params;\n\n\t\t// get expression args if supplied\n\t\tif ( this.fn ) {\n\t\t\tconst values = resolveArgs( this, this.template, this.parentFragment ).map( model => {\n\t\t\t\tif ( !model ) return undefined;\n\n\t\t\t\treturn model.get();\n\t\t\t});\n\t\t\treturn this.fn.apply( this.ractive, values );\n\t\t}\n\t}\n\n\tgetStyle ( props ) {\n\t\tconst computedStyle = getComputedStyle( this.node );\n\n\t\tif ( typeof props === 'string' ) {\n\t\t\treturn computedStyle[ prefix( props ) ];\n\t\t}\n\n\t\tif ( !Array.isArray( props ) ) {\n\t\t\tthrow new Error( 'Transition$getStyle must be passed a string, or an array of strings representing CSS properties' );\n\t\t}\n\n\t\tconst styles = {};\n\n\t\tlet i = props.length;\n\t\twhile ( i-- ) {\n\t\t\tconst prop = props[i];\n\t\t\tlet value = computedStyle[ prefix( prop ) ];\n\n\t\t\tif ( value === '0px' ) value = 0;\n\t\t\tstyles[ prop ] = value;\n\t\t}\n\n\t\treturn styles;\n\t}\n\n\tprocessParams ( params, defaults ) {\n\t\tif ( typeof params === 'number' ) {\n\t\t\tparams = { duration: params };\n\t\t}\n\n\t\telse if ( typeof params === 'string' ) {\n\t\t\tif ( params === 'slow' ) {\n\t\t\t\tparams = { duration: 600 };\n\t\t\t} else if ( params === 'fast' ) {\n\t\t\t\tparams = { duration: 200 };\n\t\t\t} else {\n\t\t\t\tparams = { duration: 400 };\n\t\t\t}\n\t\t} else if ( !params ) {\n\t\t\tparams = {};\n\t\t}\n\n\t\treturn Object.assign( {}, defaults, params );\n\t}\n\n\tregisterCompleteHandler ( fn ) {\n\t\taddToArray( this.onComplete, fn );\n\t}\n\n\tsetStyle ( style, value ) {\n\t\tif ( typeof style === 'string' ) {\n\t\t\tconst name = prefix(  style );\n\t\t\tif ( !this.originals.hasOwnProperty( name ) ) this.originals[ name ] = this.node.style[ name ];\n\t\t\tthis.node.style[ name ] = value;\n\t\t\tthis.targets[ name ] = this.node.style[ name ];\n\t\t}\n\n\t\telse {\n\t\t\tlet prop;\n\t\t\tfor ( prop in style ) {\n\t\t\t\tif ( style.hasOwnProperty( prop ) ) {\n\t\t\t\t\tthis.setStyle( prop, style[ prop ] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tshouldFire ( type ) {\n\t\tif ( !this.ractive.transitionsEnabled ) return false;\n\n\t\t// check for noIntro and noOutro cases, which only apply when the owner ractive is rendering and unrendering, respectively\n\t\tif ( type === 'intro' && this.ractive.rendering && nearestProp( 'noIntro', this.ractive, true ) ) return false;\n\t\tif ( type === 'outro' && this.ractive.unrendering && nearestProp( 'noOutro', this.ractive, false ) ) return false;\n\n\t\tconst params = this.getParams(); // this is an array, the params object should be the first member\n\t\t// if there's not a parent element, this can't be nested, so roll on\n\t\tif ( !this.element.parent ) return true;\n\n\t\t// if there is a local param, it takes precedent\n\t\tif ( params && params[0] && 'nested' in params[0] ) {\n\t\t\tif ( params[0].nested !== false ) return true;\n\t\t} else { // use the nearest instance setting\n\t\t\t// find the nearest instance that actually has a nested setting\n\t\t\tif ( nearestProp( 'nestedTransitions', this.ractive ) !== false ) return true;\n\t\t}\n\n\t\t// check to see if this is actually a nested transition\n\t\tlet el = this.element.parent;\n\t\twhile ( el ) {\n\t\t\tif ( el[type] && el[type].starting ) return false;\n\t\t\tel = el.parent;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tstart () {\n\t\tconst node = this.node = this.element.node;\n\t\tconst originals = this.originals = {};  //= node.getAttribute( 'style' );\n\t\tconst targets = this.targets = {};\n\n\t\tlet completed;\n\t\tconst args = this.getParams();\n\n\t\t// create t.complete() - we don't want this on the prototype,\n\t\t// because we don't want `this` silliness when passing it as\n\t\t// an argument\n\t\tthis.complete = noReset => {\n\t\t\tthis.starting = false;\n\t\t\tif ( completed ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.onComplete.forEach( fn => fn() );\n\t\t\tif ( !noReset && this.isIntro ) {\n\t\t\t\tfor ( const k in targets ) {\n\t\t\t\t\tif ( node.style[ k ] === targets[ k ] ) node.style[ k ] = originals[ k ];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._manager.remove( this );\n\n\t\t\tcompleted = true;\n\t\t};\n\n\t\t// If the transition function doesn't exist, abort\n\t\tif ( !this._fn ) {\n\t\t\tthis.complete();\n\t\t\treturn;\n\t\t}\n\n\t\tconst promise = this._fn.apply( this.ractive, [ this ].concat( args ) );\n\t\tif ( promise ) promise.then( this.complete );\n\t}\n\n\ttoString () { return ''; }\n\n\tunbind () {\n\t\tif ( !this.element.attributes.unbinding ) {\n\t\t\tconst type = this.options && this.options.template && this.options.template.v;\n\t\t\tif ( type === 't0' || type === 't1' ) this.element.intro = null;\n\t\t\tif ( type === 't0' || type === 't2' ) this.element.outro = null;\n\t\t}\n\t}\n\n\tunregisterCompleteHandler ( fn ) {\n\t\tremoveFromArray( this.onComplete, fn );\n\t}\n}\n\nconst proto = Transition.prototype;\nproto.destroyed = proto.render = proto.unrender = proto.update = noop;\n\nfunction nearestProp ( prop, ractive, rendering ) {\n\tlet instance = ractive;\n\twhile ( instance ) {\n\t\tif ( instance.hasOwnProperty( prop ) && ( rendering === undefined || rendering ? instance.rendering : instance.unrendering ) ) return instance[ prop ];\n\t\tinstance = instance.component && instance.component.ractive;\n\t}\n\n\treturn ractive[ prop ];\n}\n","import { svg } from '../../../config/namespaces';\nimport { createElement } from '../../../utils/dom';\n\nconst elementCache = {};\n\nlet ieBug;\nlet ieBlacklist;\n\ntry {\n\tcreateElement( 'table' ).innerHTML = 'foo';\n} catch ( err ) {\n\tieBug = true;\n\n\tieBlacklist = {\n\t\tTABLE:  [ '<table class=\"x\">', '</table>' ],\n\t\tTHEAD:  [ '<table><thead class=\"x\">', '</thead></table>' ],\n\t\tTBODY:  [ '<table><tbody class=\"x\">', '</tbody></table>' ],\n\t\tTR:     [ '<table><tr class=\"x\">', '</tr></table>' ],\n\t\tSELECT: [ '<select class=\"x\">', '</select>' ]\n\t};\n}\n\nexport default function ( html, node ) {\n\tconst nodes = [];\n\n\t// render 0 and false\n\tif ( html == null || html === '' ) return nodes;\n\n\tlet container;\n\tlet wrapper;\n\tlet selectedOption;\n\n\tif ( ieBug && ( wrapper = ieBlacklist[ node.tagName ] ) ) {\n\t\tcontainer = element( 'DIV' );\n\t\tcontainer.innerHTML = wrapper[0] + html + wrapper[1];\n\t\tcontainer = container.querySelector( '.x' );\n\n\t\tif ( container.tagName === 'SELECT' ) {\n\t\t\tselectedOption = container.options[ container.selectedIndex ];\n\t\t}\n\t}\n\n\telse if ( node.namespaceURI === svg ) {\n\t\tcontainer = element( 'DIV' );\n\t\tcontainer.innerHTML = '<svg class=\"x\">' + html + '</svg>';\n\t\tcontainer = container.querySelector( '.x' );\n\t}\n\n\telse if ( node.tagName === 'TEXTAREA' ) {\n\t\tcontainer = createElement( 'div' );\n\n\t\tif ( typeof container.textContent !== 'undefined' ) {\n\t\t\tcontainer.textContent = html;\n\t\t} else {\n\t\t\tcontainer.innerHTML = html;\n\t\t}\n\t}\n\n\telse {\n\t\tcontainer = element( node.tagName );\n\t\tcontainer.innerHTML = html;\n\n\t\tif ( container.tagName === 'SELECT' ) {\n\t\t\tselectedOption = container.options[ container.selectedIndex ];\n\t\t}\n\t}\n\n\tlet child;\n\twhile ( child = container.firstChild ) {\n\t\tnodes.push( child );\n\t\tcontainer.removeChild( child );\n\t}\n\n\t// This is really annoying. Extracting <option> nodes from the\n\t// temporary container <select> causes the remaining ones to\n\t// become selected. So now we have to deselect them. IE8, you\n\t// amaze me. You really do\n\t// ...and now Chrome too\n\tlet i;\n\tif ( node.tagName === 'SELECT' ) {\n\t\ti = nodes.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( nodes[i] !== selectedOption ) {\n\t\t\t\tnodes[i].selected = false;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn nodes;\n}\n\nfunction element ( tagName ) {\n\treturn elementCache[ tagName ] || ( elementCache[ tagName ] = createElement( tagName ) );\n}\n","import { createDocumentFragment, matches } from '../../utils/dom';\nimport Mustache from './shared/Mustache';\nimport insertHtml from './triple/insertHtml';\nimport { decodeCharacterReferences } from '../../utils/html';\nimport { detachNode } from '../../utils/dom';\nimport { inAttribute } from './element/Attribute';\n\nexport default class Triple extends Mustache {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\t}\n\n\tdetach () {\n\t\tconst docFrag = createDocumentFragment();\n\t\tif ( this.nodes ) this.nodes.forEach( node => docFrag.appendChild( node ) );\n\t\treturn docFrag;\n\t}\n\n\tfind ( selector ) {\n\t\tconst len = this.nodes.length;\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tconst node = this.nodes[i];\n\n\t\t\tif ( node.nodeType !== 1 ) continue;\n\n\t\t\tif ( matches( node, selector ) ) return node;\n\n\t\t\tconst queryResult = node.querySelector( selector );\n\t\t\tif ( queryResult ) return queryResult;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindAll ( selector, options ) {\n\t\tconst { result } = options;\n\t\tconst len = this.nodes.length;\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tconst node = this.nodes[i];\n\n\t\t\tif ( node.nodeType !== 1 ) continue;\n\n\t\t\tif ( matches( node, selector ) ) result.push( node );\n\n\t\t\tconst queryAllResult = node.querySelectorAll( selector );\n\t\t\tif ( queryAllResult ) {\n\t\t\t\tresult.push.apply( result, queryAllResult );\n\t\t\t}\n\t\t}\n\t}\n\n\tfindComponent () {\n\t\treturn null;\n\t}\n\n\tfirstNode () {\n\t\treturn this.rendered && this.nodes[0];\n\t}\n\n\trender ( target, occupants ) {\n\t\tconst parentNode = this.parentFragment.findParentNode();\n\n\t\tif ( !this.nodes ) {\n\t\t\tconst html = this.model ? this.model.get() : '';\n\t\t\tthis.nodes = insertHtml( html, this.parentFragment.findParentNode(), target );\n\t\t}\n\n\t\tlet nodes = this.nodes;\n\t\tlet anchor = this.parentFragment.findNextNode( this );\n\n\t\t// progressive enhancement\n\t\tif ( occupants ) {\n\t\t\tlet i = -1;\n\t\t\tlet next;\n\n\t\t\t// start with the first node that should be rendered\n\t\t\twhile ( occupants.length && ( next = this.nodes[ i + 1 ] ) ) {\n\t\t\t\tlet n;\n\t\t\t\t// look through the occupants until a matching node is found\n\t\t\t\twhile ( n = occupants.shift() ) {\n\t\t\t\t\tconst t = n.nodeType;\n\n\t\t\t\t\tif ( t === next.nodeType && ( ( t === 1 && n.outerHTML === next.outerHTML ) || ( ( t === 3 || t === 8 ) && n.nodeValue === next.nodeValue ) ) ) {\n\t\t\t\t\t\tthis.nodes.splice( ++i, 1, n ); // replace the generated node with the existing one\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttarget.removeChild( n ); // remove the non-matching existing node\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( i >= 0 ) {\n\t\t\t\t// update the list of remaining nodes to attach, excluding any that were replaced by existing nodes\n\t\t\t\tnodes = this.nodes.slice( i );\n\t\t\t}\n\n\t\t\t// update the anchor to be the next occupant\n\t\t\tif ( occupants.length ) anchor = occupants[0];\n\t\t}\n\n\t\t// attach any remainging nodes to the parent\n\t\tif ( nodes.length ) {\n\t\t\tconst frag = createDocumentFragment();\n\t\t\tnodes.forEach( n => frag.appendChild( n ) );\n\n\t\t\tif ( anchor ) {\n\t\t\t\tanchor.parentNode.insertBefore( frag, anchor );\n\t\t\t} else {\n\t\t\t\tparentNode.appendChild( frag );\n\t\t\t}\n\t\t}\n\n\t\tthis.rendered = true;\n\t}\n\n\ttoString () {\n\t\tlet value = this.model && this.model.get();\n\t\tvalue = value != null ? '' + value : '';\n\n\t\treturn inAttribute() ? decodeCharacterReferences( value ) : value;\n\t}\n\n\tunrender () {\n\t\tif ( this.nodes ) this.nodes.forEach( node => detachNode( node ) );\n\t\tthis.rendered = false;\n\t\tthis.nodes = null;\n\t}\n\n\tupdate () {\n\t\tif ( this.rendered && this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tthis.unrender();\n\t\t\tthis.render();\n\t\t} else {\n\t\t\t// make sure to reset the dirty flag even if not rendered\n\t\t\tthis.dirty = false;\n\t\t}\n\t}\n}\n","import { ALIAS, ANCHOR, COMPONENT, DOCTYPE, ELEMENT, INTERPOLATOR, PARTIAL, SECTION, TRIPLE, YIELDER } from '../../config/types';\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, EVENT, TRANSITION } from '../../config/types';\nimport Alias from './Alias';\nimport Attribute from './element/Attribute';\nimport BindingFlag from './element/BindingFlag';\nimport Component from './Component';\nimport Decorator from './element/Decorator';\nimport Doctype from './Doctype';\nimport Form from './element/specials/Form';\nimport Element from './Element';\nimport EventDirective from './shared/EventDirective';\nimport Interpolator from './Interpolator';\nimport Input from './element/specials/Input';\nimport Mapping from './component/Mapping';\nimport Option from './element/specials/Option';\nimport Partial from './Partial';\nimport Section from './Section';\nimport Select from './element/specials/Select';\nimport Textarea from './element/specials/Textarea';\nimport Text from './Text';\nimport Transition from './element/Transition';\nimport Triple from './Triple';\n//import Yielder from './Yielder';\nimport getComponentConstructor from './component/getComponentConstructor';\nimport findElement from './shared/findElement';\n\nconst constructors = {};\nconstructors[ ALIAS ] = Alias;\nconstructors[ ANCHOR ] = Component;\nconstructors[ DOCTYPE ] = Doctype;\nconstructors[ INTERPOLATOR ] = Interpolator;\nconstructors[ PARTIAL ] = Partial;\nconstructors[ SECTION ] = Section;\nconstructors[ TRIPLE ] = Triple;\nconstructors[ YIELDER ] = Partial;\n\nconstructors[ ATTRIBUTE ] = Attribute;\nconstructors[ BINDING_FLAG ] = BindingFlag;\nconstructors[ DECORATOR ] = Decorator;\nconstructors[ EVENT ] = EventDirective;\nconstructors[ TRANSITION ] = Transition;\n\nconst specialElements = {\n\tdoctype: Doctype,\n\tform: Form,\n\tinput: Input,\n\toption: Option,\n\tselect: Select,\n\ttextarea: Textarea\n};\n\nexport default function createItem ( options ) {\n\tif ( typeof options.template === 'string' ) {\n\t\treturn new Text( options );\n\t}\n\n\tif ( options.template.t === ELEMENT ) {\n\t\t// could be component or element\n\t\tconst ComponentConstructor = getComponentConstructor( options.parentFragment.ractive, options.template.e );\n\t\tif ( ComponentConstructor ) {\n\t\t\treturn new Component( options, ComponentConstructor );\n\t\t}\n\n\t\tconst tagName = options.template.e.toLowerCase();\n\n\t\tconst ElementConstructor = specialElements[ tagName ] || Element;\n\t\treturn new ElementConstructor( options );\n\t}\n\n\tlet Item;\n\n\t// component mappings are a special case of attribute\n\tif ( options.template.t === ATTRIBUTE ) {\n\t\tlet el = options.owner;\n\t\tif ( !el || ( el.type !== ANCHOR && el.type !== COMPONENT && el.type !== ELEMENT ) ) {\n\t\t\tel = findElement( options.parentFragment );\n\t\t}\n\t\toptions.element = el;\n\n\t\tItem = el.type === COMPONENT || el.type === ANCHOR ? Mapping : Attribute;\n\t} else {\n\t\tItem = constructors[ options.template.t ];\n\t}\n\n\tif ( !Item ) throw new Error( `Unrecognised item type ${options.template.t}` );\n\n\treturn new Item( options );\n}\n","import { ELEMENT, YIELDER } from '../config/types';\nimport runloop from '../global/runloop';\nimport createItem from './items/createItem';\nimport { bind, destroyed, shuffled, toEscapedString, toString, unbind, unrender, update } from '../shared/methodCallers';\nimport processItems from './helpers/processItems';\nimport parseJSON from '../utils/parseJSON';\nimport { createDocumentFragment } from '../utils/dom';\nimport { findMap } from '../utils/array';\nimport { getContext } from '../shared/getRactiveContext';\n\nfunction unrenderAndDestroy ( item ) {\n\titem.unrender( true );\n}\n\nexport default class Fragment {\n\tconstructor ( options ) {\n\t\tthis.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n\t\tthis.isRoot = !options.owner.parentFragment;\n\t\tthis.parent = this.isRoot ? null : this.owner.parentFragment;\n\t\tthis.ractive = options.ractive || ( this.isRoot ? options.owner : this.parent.ractive );\n\n\t\tthis.componentParent = ( this.isRoot && this.ractive.component ) ? this.ractive.component.parentFragment : null;\n\t\tthis.delegate = ( this.parent ? this.parent.delegate : ( this.componentParent && this.componentParent.delegate ) ) ||\n\t\t\t( this.owner.containerFragment && this.owner.containerFragment.delegate );\n\n\t\tthis.context = null;\n\t\tthis.rendered = false;\n\n\t\t// encapsulated styles should be inherited until they get applied by an element\n\t\tthis.cssIds = 'cssIds' in options ? options.cssIds : ( this.parent ? this.parent.cssIds : null );\n\n\t\tthis.dirty = false;\n\t\tthis.dirtyValue = true; // used for attribute values\n\n\t\tthis.template = options.template || [];\n\t\tthis.createItems();\n\t}\n\n\tbind ( context ) {\n\t\tthis.context = context;\n\t\tthis.items.forEach( bind );\n\t\tthis.bound = true;\n\n\t\t// in rare cases, a forced resolution (or similar) will cause the\n\t\t// fragment to be dirty before it's even finished binding. In those\n\t\t// cases we update immediately\n\t\tif ( this.dirty ) this.update();\n\n\t\treturn this;\n\t}\n\n\tbubble () {\n\t\tthis.dirtyValue = true;\n\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\n\t\t\tif ( this.isRoot ) { // TODO encapsulate 'is component root, but not overall root' check?\n\t\t\t\tif ( this.ractive.component ) {\n\t\t\t\t\tthis.ractive.component.bubble();\n\t\t\t\t} else if ( this.bound ) {\n\t\t\t\t\trunloop.addFragment( this );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.owner.bubble( this.index );\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateItems () {\n\t\t// this is a hot code path\n\t\tconst max = this.template.length;\n\t\tthis.items = [];\n\t\tfor ( let i = 0; i < max; i++ ) {\n\t\t\tthis.items[i] = createItem({ parentFragment: this, template: this.template[i], index: i });\n\t\t}\n\t}\n\n\tdestroyed () {\n\t\tthis.items.forEach( destroyed );\n\t}\n\n\tdetach () {\n\t\tconst docFrag = createDocumentFragment();\n\t\tconst xs = this.items;\n\t\tconst len = xs.length;\n\t\tfor ( let i = 0; i < len; i++ ) {\n\t\t\tdocFrag.appendChild( xs[i].detach() );\n\t\t}\n\t\treturn docFrag;\n\t}\n\n\tfind ( selector, options ) {\n\t\treturn findMap( this.items, i => i.find( selector, options ) );\n\t}\n\n\tfindAll ( selector, options ) {\n\t\tif ( this.items ) {\n\t\t\tthis.items.forEach( i => i.findAll && i.findAll( selector, options ) );\n\t\t}\n\t}\n\n\tfindComponent ( name, options ) {\n\t\treturn findMap( this.items, i => i.findComponent( name, options ) );\n\t}\n\n\tfindAllComponents ( name, options ) {\n\t\tif ( this.items ) {\n\t\t\tthis.items.forEach( i => i.findAllComponents && i.findAllComponents( name, options ) );\n\t\t}\n\t}\n\n\tfindContext () {\n\t\tlet fragment = this;\n\t\twhile ( fragment && !fragment.context ) fragment = fragment.parent;\n\t\tif ( !fragment ) return this.ractive.viewmodel;\n\t\telse return fragment.context;\n\t}\n\n\tfindNextNode ( item ) {\n\t\t// search for the next node going forward\n\t\tif ( item ) {\n\t\t\tfor ( let i = item.index + 1; i < this.items.length; i++ ) {\n\t\t\t\tif ( !this.items[ i ] ) continue;\n\n\t\t\t\tconst node = this.items[ i ].firstNode( true );\n\t\t\t\tif ( node ) return node;\n\t\t\t}\n\t\t}\n\n\t\t// if this is the root fragment, and there are no more items,\n\t\t// it means we're at the end...\n\t\tif ( this.isRoot ) {\n\t\t\tif ( this.ractive.component ) {\n\t\t\t\treturn this.ractive.component.parentFragment.findNextNode( this.ractive.component );\n\t\t\t}\n\n\t\t\t// TODO possible edge case with other content\n\t\t\t// appended to this.ractive.el?\n\t\t\treturn null;\n\t\t}\n\n\t\tif ( this.parent ) return this.owner.findNextNode( this ); // the argument is in case the parent is a RepeatedFragment\n\t}\n\n\tfindParentNode () {\n\t\tlet fragment = this;\n\n\t\tdo {\n\t\t\tif ( fragment.owner.type === ELEMENT ) {\n\t\t\t\treturn fragment.owner.node;\n\t\t\t}\n\n\t\t\tif ( fragment.isRoot && !fragment.ractive.component ) { // TODO encapsulate check\n\t\t\t\treturn fragment.ractive.el;\n\t\t\t}\n\n\t\t\tif ( fragment.owner.type === YIELDER ) {\n\t\t\t\tfragment = fragment.owner.containerFragment;\n\t\t\t} else {\n\t\t\t\tfragment = fragment.componentParent || fragment.parent; // TODO ugh\n\t\t\t}\n\t\t} while ( fragment );\n\n\t\tthrow new Error( 'Could not find parent node' ); // TODO link to issue tracker\n\t}\n\n\tfindRepeatingFragment () {\n\t\tlet fragment = this;\n\t\t// TODO better check than fragment.parent.iterations\n\t\twhile ( ( fragment.parent || fragment.componentParent ) && !fragment.isIteration ) {\n\t\t\tfragment = fragment.parent || fragment.componentParent;\n\t\t}\n\n\t\treturn fragment;\n\t}\n\n\tfirstNode ( skipParent ) {\n\t\tconst node = findMap( this.items, i => i.firstNode( true ) );\n\t\tif ( node ) return node;\n\t\tif ( skipParent ) return null;\n\n\t\treturn this.parent.findNextNode( this.owner );\n\t}\n\n\trebind ( next ) {\n\t\tthis.context = next;\n\t}\n\n\trender ( target, occupants ) {\n\t\tif ( this.rendered ) throw new Error( 'Fragment is already rendered!' );\n\t\tthis.rendered = true;\n\n\t\tconst xs = this.items;\n\t\tconst len = xs.length;\n\t\tfor ( let i = 0; i < len; i++ ) {\n\t\t\txs[i].render( target, occupants );\n\t\t}\n\t}\n\n\tresetTemplate ( template ) {\n\t\tconst wasBound = this.bound;\n\t\tconst wasRendered = this.rendered;\n\n\t\t// TODO ensure transitions are disabled globally during reset\n\n\t\tif ( wasBound ) {\n\t\t\tif ( wasRendered ) this.unrender( true );\n\t\t\tthis.unbind();\n\t\t}\n\n\t\tthis.template = template;\n\t\tthis.createItems();\n\n\t\tif ( wasBound ) {\n\t\t\tthis.bind( this.context );\n\n\t\t\tif ( wasRendered ) {\n\t\t\t\tconst parentNode = this.findParentNode();\n\t\t\t\tconst anchor = this.findNextNode();\n\n\t\t\t\tif ( anchor ) {\n\t\t\t\t\tconst docFrag = createDocumentFragment();\n\t\t\t\t\tthis.render( docFrag );\n\t\t\t\t\tparentNode.insertBefore( docFrag, anchor );\n\t\t\t\t} else {\n\t\t\t\t\tthis.render( parentNode );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tshuffled () {\n\t\tthis.items.forEach( shuffled );\n\t}\n\n\ttoString ( escape ) {\n\t\treturn this.items.map( escape ? toEscapedString : toString ).join( '' );\n\t}\n\n\tunbind () {\n\t\tthis.context = null;\n\t\tthis.items.forEach( unbind );\n\t\tthis.bound = false;\n\n\t\treturn this;\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tthis.items.forEach( shouldDestroy ? unrenderAndDestroy : unrender );\n\t\tthis.rendered = false;\n\t}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tif ( !this.updating ) {\n\t\t\t\tthis.dirty = false;\n\t\t\t\tthis.updating = true;\n\t\t\t\tthis.items.forEach( update );\n\t\t\t\tthis.updating = false;\n\t\t\t} else if ( this.isRoot ) {\n\t\t\t\trunloop.addFragmentToRoot( this );\n\t\t\t}\n\t\t}\n\t}\n\n\tvalueOf () {\n\t\tif ( this.items.length === 1 ) {\n\t\t\treturn this.items[0].valueOf();\n\t\t}\n\n\t\tif ( this.dirtyValue ) {\n\t\t\tconst values = {};\n\t\t\tconst source = processItems( this.items, values, this.ractive._guid );\n\t\t\tconst parsed = parseJSON( source, values );\n\n\t\t\tthis.value = parsed ?\n\t\t\t\tparsed.value :\n\t\t\t\tthis.toString();\n\n\t\t\tthis.dirtyValue = false;\n\t\t}\n\n\t\treturn this.value;\n\t}\n}\nFragment.prototype.getContext = getContext;\n","import Hook from './Hook';\n\nfunction getChildQueue ( queue, ractive ) {\n\treturn queue[ ractive._guid ] || ( queue[ ractive._guid ] = [] );\n}\n\nfunction fire ( hookQueue, ractive ) {\n\tconst childQueue = getChildQueue( hookQueue.queue, ractive );\n\n\thookQueue.hook.fire( ractive );\n\n\t// queue is \"live\" because components can end up being\n\t// added while hooks fire on parents that modify data values.\n\twhile ( childQueue.length ) {\n\t\tfire( hookQueue, childQueue.shift() );\n\t}\n\n\tdelete hookQueue.queue[ ractive._guid ];\n}\n\nexport default class HookQueue {\n\tconstructor ( event ) {\n\t\tthis.hook = new Hook( event );\n\t\tthis.inProcess = {};\n\t\tthis.queue = {};\n\t}\n\n\tbegin ( ractive ) {\n\t\tthis.inProcess[ ractive._guid ] = true;\n\t}\n\n\tend ( ractive ) {\n\t\tconst parent = ractive.parent;\n\n\t\t// If this is *isn't* a child of a component that's in process,\n\t\t// it should call methods or fire at this point\n\t\tif ( !parent || !this.inProcess[ parent._guid ] ) {\n\t\t\tfire( this, ractive );\n\t\t}\n\t\t// elsewise, handoff to parent to fire when ready\n\t\telse {\n\t\t\tgetChildQueue( this.queue, parent ).push( ractive );\n\t\t}\n\n\t\tdelete this.inProcess[ ractive._guid ];\n\t}\n}\n","import { logIfDebug, warnIfDebug, warnOnceIfDebug } from '../utils/log';\nimport { getElement } from '../utils/dom';\nimport { toPairs } from '../utils/object';\nimport config from './config/config';\nimport Fragment from '../view/Fragment';\nimport Hook from '../events/Hook';\nimport HookQueue from '../events/HookQueue';\nimport Ractive from '../Ractive';\n\nconst configHook = new Hook( 'config' );\nconst initHook = new HookQueue( 'init' );\n\nexport default function initialise ( ractive, userOptions, options ) {\n\tObject.keys( ractive.viewmodel.computations ).forEach( key => {\n\t\tconst computation = ractive.viewmodel.computations[ key ];\n\n\t\tif ( ractive.viewmodel.value.hasOwnProperty( key ) ) {\n\t\t\tcomputation.set( ractive.viewmodel.value[ key ] );\n\t\t}\n\t});\n\n\t// set up event subscribers\n\tsubscribe( ractive, userOptions, 'on' );\n\n\t// init config from Parent and options\n\tconfig.init( ractive.constructor, ractive, userOptions );\n\n\tconfigHook.fire( ractive );\n\n\t// general config done, set up observers\n\tsubscribe( ractive, userOptions, 'observe' );\n\n\tinitHook.begin( ractive );\n\n\tconst fragment = ractive.fragment = createFragment( ractive, options );\n\tif ( fragment ) fragment.bind( ractive.viewmodel );\n\n\tinitHook.end( ractive );\n\n\tif ( fragment ) {\n\t\t// render automatically ( if `el` is specified )\n\t\tconst el = getElement( ractive.el || ractive.target );\n\t\tif ( el ) {\n\t\t\tconst promise = ractive.render( el, ractive.append );\n\n\t\t\tif ( Ractive.DEBUG_PROMISES ) {\n\t\t\t\tpromise.catch( err => {\n\t\t\t\t\twarnOnceIfDebug( 'Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;' );\n\t\t\t\t\twarnIfDebug( 'An error happened during rendering', { ractive });\n\t\t\t\t\tlogIfDebug( err );\n\n\t\t\t\t\tthrow err;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function createFragment ( ractive, options = {} ) {\n\tif ( ractive.template ) {\n\t\tlet cssIds;\n\n\t\tif ( options.cssIds || ractive.cssId ) {\n\t\t\tcssIds = options.cssIds ? options.cssIds.slice() : [];\n\n\t\t\tif ( ractive.cssId ) {\n\t\t\t\tcssIds.push( ractive.cssId );\n\t\t\t}\n\t\t}\n\n\t\treturn new Fragment({\n\t\t\towner: ractive,\n\t\t\ttemplate: ractive.template,\n\t\t\tcssIds\n\t\t});\n\t}\n}\n\nfunction subscribe ( instance, options, type ) {\n\tconst subs = ( instance.constructor[ `_${type}` ] || [] ).concat( toPairs( options[ type ] || [] ) );\n\tconst single = type === 'on' ? 'once' : `${type}Once`;\n\n\tsubs.forEach( ([ target, config ]) => {\n\t\tif ( typeof config === 'function' ) {\n\t\t\tinstance[type]( target, config );\n\t\t} else if ( typeof config === 'object' && typeof config.handler === 'function' ) {\n\t\t\tinstance[ config.once ? single : type ]( target, config.handler, config );\n\t\t}\n\t});\n}\n","import { doc } from '../config/environment';\nimport { applyCSS } from '../global/css';\nimport Hook from '../events/Hook';\nimport { getElement } from '../utils/dom';\nimport runloop from '../global/runloop';\nimport { createFragment } from './initialise';\n\nconst renderHook = new Hook( 'render' );\nconst completeHook = new Hook( 'complete' );\n\nexport default function render ( ractive, target, anchor, occupants ) {\n\t// set a flag to let any transitions know that this instance is currently rendering\n\tractive.rendering = true;\n\n\tconst promise = runloop.start( ractive, true );\n\trunloop.scheduleTask( () => renderHook.fire( ractive ), true );\n\n\tif ( ractive.fragment.rendered ) {\n\t\tthrow new Error( 'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first' );\n\t}\n\n\tif ( ractive.destroyed ) {\n\t\tractive.destroyed = false;\n\t\tractive.fragment = createFragment( ractive ).bind( ractive.viewmodel );\n\t}\n\n\tanchor = getElement( anchor ) || ractive.anchor;\n\n\tractive.el = ractive.target = target;\n\tractive.anchor = anchor;\n\n\t// ensure encapsulated CSS is up-to-date\n\tif ( ractive.cssId ) applyCSS();\n\n\tif ( target ) {\n\t\t( target.__ractive_instances__ || ( target.__ractive_instances__ = [] ) ).push( ractive );\n\n\t\tif ( anchor ) {\n\t\t\tconst docFrag = doc.createDocumentFragment();\n\t\t\tractive.fragment.render( docFrag );\n\t\t\ttarget.insertBefore( docFrag, anchor );\n\t\t} else {\n\t\t\tractive.fragment.render( target, occupants );\n\t\t}\n\t}\n\n\trunloop.end();\n\tractive.rendering = false;\n\n\treturn promise.then( () => {\n\t\tif (ractive.torndown) return;\n\n\t\tcompleteHook.fire( ractive );\n\t});\n}\n","import config from '../config/config';\nimport Hook from '../../events/Hook';\nimport runloop from '../../global/runloop';\nimport dataConfigurator from '../config/custom/data';\n\nconst shouldRerender = [ 'template', 'partials', 'components', 'decorators', 'events' ];\n\nconst completeHook = new Hook( 'complete' );\nconst resetHook = new Hook( 'reset' );\nconst renderHook = new Hook( 'render' );\nconst unrenderHook = new Hook( 'unrender' );\n\nexport default function Ractive$reset ( data ) {\n\tdata = data || {};\n\n\tif ( typeof data !== 'object' ) {\n\t\tthrow new Error( 'The reset method takes either no arguments, or an object containing new data' );\n\t}\n\n\t// TEMP need to tidy this up\n\tdata = dataConfigurator.init( this.constructor, this, { data });\n\n\tconst promise = runloop.start( this, true );\n\n\t// If the root object is wrapped, try and use the wrapper's reset value\n\tconst wrapper = this.viewmodel.wrapper;\n\tif ( wrapper && wrapper.reset ) {\n\t\tif ( wrapper.reset( data ) === false ) {\n\t\t\t// reset was rejected, we need to replace the object\n\t\t\tthis.viewmodel.set( data );\n\t\t}\n\t} else {\n\t\tthis.viewmodel.set( data );\n\t}\n\n\t// reset config items and track if need to rerender\n\tconst changes = config.reset( this );\n\tlet rerender;\n\n\tlet i = changes.length;\n\twhile ( i-- ) {\n\t\tif ( shouldRerender.indexOf( changes[i] ) > -1 ) {\n\t\t\trerender = true;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif ( rerender ) {\n\t\tunrenderHook.fire( this );\n\t\tthis.fragment.resetTemplate( this.template );\n\t\trenderHook.fire( this );\n\t\tcompleteHook.fire( this );\n\t}\n\n\trunloop.end();\n\n\tresetHook.fire( this, data );\n\n\treturn promise;\n}\n","import runloop from '../../global/runloop';\nimport { PARTIAL, COMPONENT, ELEMENT } from '../../config/types';\n\nfunction collect( source, name, attr, dest ) {\n\tsource.forEach( item => {\n\t\t// queue to rerender if the item is a partial and the current name matches\n\t\tif ( item.type === PARTIAL && ( item.refName ===  name || item.name === name ) ) {\n\t\t\titem.inAttribute = attr;\n\t\t\tdest.push( item );\n\t\t\treturn; // go no further\n\t\t}\n\n\t\t// if it has a fragment, process its items\n\t\tif ( item.fragment ) {\n\t\t\tcollect( item.fragment.iterations || item.fragment.items, name, attr, dest );\n\t\t}\n\n\t\t// or if it is itself a fragment, process its items\n\t\telse if ( Array.isArray( item.items ) ) {\n\t\t\tcollect( item.items, name, attr, dest );\n\t\t}\n\n\t\t// or if it is a component, step in and process its items\n\t\telse if ( item.type === COMPONENT && item.instance ) {\n\t\t\t// ...unless the partial is shadowed\n\t\t\tif ( item.instance.partials[ name ] ) return;\n\t\t\tcollect( item.instance.fragment.items, name, attr, dest );\n\t\t}\n\n\t\t// if the item is an element, process its attributes too\n\t\tif ( item.type === ELEMENT ) {\n\t\t\tif ( Array.isArray( item.attributes ) ) {\n\t\t\t\tcollect( item.attributes, name, true, dest );\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction forceResetTemplate ( partial ) {\n\tpartial.forceResetTemplate();\n}\n\nexport default function ( name, partial ) {\n\tconst collection = [];\n\tcollect( this.fragment.items, name, false, collection );\n\n\tconst promise = runloop.start( this, true );\n\n\tthis.partials[ name ] = partial;\n\tcollection.forEach( forceResetTemplate );\n\n\trunloop.end();\n\n\treturn promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'reverse' ).path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'shift' ).path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'sort' ).path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'splice' ).path;\n","import Hook from '../../events/Hook';\nimport { warnIfDebug } from '../../utils/log';\nimport { removeFromArray } from '../../utils/array';\nimport runloop from '../../global/runloop';\n\nconst unrenderHook = new Hook( 'unrender' );\n\nexport default function Ractive$unrender () {\n\tif ( !this.fragment.rendered ) {\n\t\twarnIfDebug( 'ractive.unrender() was called on a Ractive instance that was not rendered' );\n\t\treturn Promise.resolve();\n\t}\n\n\tthis.unrendering = true;\n\tconst promise = runloop.start( this, true );\n\n\t// If this is a component, and the component isn't marked for destruction,\n\t// don't detach nodes from the DOM unnecessarily\n\tconst shouldDestroy = !this.component || ( this.component.anchor || {} ).shouldDestroy || this.component.shouldDestroy || this.shouldDestroy;\n\tthis.fragment.unrender( shouldDestroy );\n\tif ( shouldDestroy ) this.destroyed = true;\n\n\tremoveFromArray( this.el.__ractive_instances__, this );\n\n\tunrenderHook.fire( this );\n\n\trunloop.end();\n\tthis.unrendering = false;\n\n\treturn promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'unshift' ).path;\n","import add from './prototype/add';\nimport animate from './prototype/animate';\nimport attachChild from './prototype/attachChild';\nimport detach from './prototype/detach';\nimport detachChild from './prototype/detachChild';\nimport find from './prototype/find';\nimport findAll from './prototype/findAll';\nimport findAllComponents from './prototype/findAllComponents';\nimport findComponent from './prototype/findComponent';\nimport findContainer from './prototype/findContainer';\nimport findParent from './prototype/findParent';\nimport fire from './prototype/fire';\nimport get from './prototype/get';\nimport getContext, { getNodeInfo } from './prototype/getContext';\nimport insert from './prototype/insert';\nimport link from './prototype/link';\nimport observe from './prototype/observe';\nimport observeOnce from './prototype/observeOnce';\nimport off from './prototype/off';\nimport on from './prototype/on';\nimport once from './prototype/once';\nimport pop from './prototype/pop';\nimport push from './prototype/push';\nimport readLink from './prototype/readLink';\nimport render from './prototype/render';\nimport reset from './prototype/reset';\nimport resetPartial from './prototype/resetPartial';\nimport resetTemplate from './prototype/resetTemplate';\nimport reverse from './prototype/reverse';\nimport set from './prototype/set';\nimport shift from './prototype/shift';\nimport sort from './prototype/sort';\nimport splice from './prototype/splice';\nimport subtract from './prototype/subtract';\nimport teardown from './prototype/teardown';\nimport toggle from './prototype/toggle';\nimport toCSS from './prototype/toCSS';\nimport toHTML from './prototype/toHTML';\nimport toText from './prototype/toText';\nimport transition from './prototype/transition';\nimport unlink from './prototype/unlink';\nimport unrender from './prototype/unrender';\nimport unshift from './prototype/unshift';\nimport update from './prototype/update';\nimport updateModel from './prototype/updateModel';\n\nconst proto = {\n\tadd,\n\tanimate,\n\tattachChild,\n\tdetach,\n\tdetachChild,\n\tfind,\n\tfindAll,\n\tfindAllComponents,\n\tfindComponent,\n\tfindContainer,\n\tfindParent,\n\tfire,\n\tget,\n\tgetContext,\n\tgetNodeInfo,\n\tinsert,\n\tlink,\n\tobserve,\n\tobserveOnce,\n\toff,\n\ton,\n\tonce,\n\tpop,\n\tpush,\n\treadLink,\n\trender,\n\treset,\n\tresetPartial,\n\tresetTemplate,\n\treverse,\n\tset,\n\tshift,\n\tsort,\n\tsplice,\n\tsubtract,\n\tteardown,\n\ttoggle,\n\ttoCSS,\n\ttoCss: toCSS,\n\ttoHTML,\n\ttoHtml: toHTML,\n\ttoText,\n\ttransition,\n\tunlink,\n\tunrender,\n\tunshift,\n\tupdate,\n\tupdateModel\n};\n\nObject.defineProperty( proto, 'target', {\n\tget() { return this.el; }\n});\n\nexport default proto;\n","import { toPairs } from '../utils/object';\nimport config from '../Ractive/config/config';\nimport dataConfigurator from '../Ractive/config/custom/data';\nimport construct from '../Ractive/construct';\nimport initialise from '../Ractive/initialise';\nimport Ractive from '../Ractive';\nimport isInstance from '../Ractive/static/isInstance';\n\nconst callsSuper = /super\\s*\\(|\\.call\\s*\\(\\s*this/;\n\nexport function extend ( ...options ) {\n\tif( !options.length ) {\n\t\treturn extendOne( this );\n\t} else {\n\t\treturn options.reduce( extendOne, this );\n\t}\n}\n\nexport function extendWith ( Class, options = {} ) {\n\treturn extendOne( this, options, Class );\n}\n\nfunction extendOne ( Parent, options = {}, Target ) {\n\tlet proto;\n\tlet Child = typeof Target === 'function' && Target;\n\n\tif ( options.prototype instanceof Ractive ) {\n\t\tthrow new Error( `Ractive no longer supports multiple inheritance.` );\n\t}\n\n\tif ( Child ) {\n\t\tif ( !( Child.prototype instanceof Parent ) ) {\n\t\t\tthrow new Error( `Only classes that inherit the appropriate prototype may be used with extend` );\n\t\t}\n\t\tif ( !callsSuper.test( Child.toString() ) ) {\n\t\t\tthrow new Error( `Only classes that call super in their constructor may be used with extend` );\n\t\t}\n\n\t\tproto = Child.prototype;\n\t} else {\n\t\tChild = function ( options ) {\n\t\t\tif ( !( this instanceof Child ) ) return new Child( options );\n\n\t\t\tconstruct( this, options || {} );\n\t\t\tinitialise( this, options || {}, {} );\n\t\t};\n\n\t\tproto = Object.create( Parent.prototype );\n\t\tproto.constructor = Child;\n\n\t\tChild.prototype = proto;\n\t}\n\n\t// Static properties\n\tObject.defineProperties( Child, {\n\t\t// alias prototype as defaults\n\t\tdefaults: { value: proto },\n\n\t\t// extendable\n\t\textend: { value: extend, writable: true, configurable: true },\n\t\textendClass: { value: extendWith, writable: true, configurable: true },\n\n\t\tParent: { value: Parent },\n\t\tRactive: { value: Ractive },\n\n\t\tisInstance: { value: isInstance }\n\t});\n\n\t// extend configuration\n\tconfig.extend( Parent, proto, options );\n\n\t// store event and observer registries on the constructor when extending\n\tChild._on = ( Parent._on || [] ).concat( toPairs( options.on ) );\n\tChild._observe = ( Parent._observe || [] ).concat( toPairs( options.observe ) );\n\n\t// attribute defs are not inherited, but they need to be stored\n\tif ( options.attributes ) {\n\t\tlet attrs;\n\n\t\t// allow an array of optional props or an object with arrays for optional and required props\n\t\tif ( Array.isArray( options.attributes ) ) {\n\t\t\tattrs = { optional: options.attributes, required: [] };\n\t\t} else {\n\t\t\tattrs = options.attributes;\n\t\t}\n\n\t\t// make sure the requisite keys actually store arrays\n\t\tif ( !Array.isArray( attrs.required ) ) attrs.required = [];\n\t\tif ( !Array.isArray( attrs.optional ) ) attrs.optional = [];\n\n\t\tChild.attributes = attrs;\n\t}\n\n\tdataConfigurator.extend( Parent, proto, options );\n\n\tif ( options.computed ) {\n\t\tproto.computed = Object.assign( Object.create( Parent.prototype.computed ), options.computed );\n\t}\n\n\treturn Child;\n}\n","import defaults from './Ractive/config/defaults';\nimport easing from './Ractive/static/easing';\nimport interpolators from './Ractive/static/interpolators';\nimport { svg, win } from './config/environment';\nimport proto from './Ractive/prototype';\nimport { extend, extendWith } from './extend/_extend';\nimport parse from './parse/_parse';\nimport getContext, { getNodeInfo } from './Ractive/static/getContext';\nimport isInstance from './Ractive/static/isInstance';\nimport construct from './Ractive/construct';\nimport initialise from './Ractive/initialise';\nimport { getCSS } from './global/css';\nimport { escapeKey, unescapeKey, normalise } from './shared/keypaths';\nimport { joinKeys, splitKeypath } from './Ractive/static/keypaths';\nimport shared from './Ractive/shared';\nimport { findPlugin } from './Ractive/static/findPlugin';\nimport parseJSON from './utils/parseJSON';\n\nexport default function Ractive ( options ) {\n\tif ( !( this instanceof Ractive ) ) return new Ractive( options );\n\n\tconstruct( this, options || {} );\n\tinitialise( this, options || {}, {} );\n}\n\n// check to see if we're being asked to force Ractive as a global for some weird environments\nif ( win && !win.Ractive ) {\n\tlet opts = '';\n\tconst script = document.currentScript || document.querySelector( 'script[data-ractive-options]' );\n\n\tif ( script ) opts = script.getAttribute( 'data-ractive-options' ) || '';\n\n\tif ( ~opts.indexOf( 'ForceGlobal' ) ) win.Ractive = Ractive;\n}\n\nObject.assign( Ractive.prototype, proto, defaults );\nRactive.prototype.constructor = Ractive;\n\n// alias prototype as `defaults`\nRactive.defaults = Ractive.prototype;\n\n// share defaults with the parser\nshared.defaults = Ractive.defaults;\nshared.Ractive = Ractive;\n\n// static properties\nObject.defineProperties( Ractive, {\n\n\t// debug flag\n\tDEBUG:            { writable: true, value: true },\n\tDEBUG_PROMISES:   { writable: true, value: true },\n\n\t// static methods:\n\textend:           { value: extend },\n\textendWith:       { value: extendWith },\n\tescapeKey:        { value: escapeKey },\n\tgetContext:       { value: getContext },\n\tgetNodeInfo:      { value: getNodeInfo },\n\tisInstance:       { value: isInstance },\n\tjoinKeys:         { value: joinKeys },\n\tparse:            { value: parse },\n\tsplitKeypath:     { value: splitKeypath },\n\tunescapeKey:      { value: unescapeKey },\n\tgetCSS:           { value: getCSS },\n\tnormaliseKeypath: { value: normalise },\n\tfindPlugin:       { value: findPlugin },\n\tevalObjectString: { value: parseJSON },\n\n\t// support\n\tenhance:          { writable: true, value: false },\n\tsvg:              { value: svg },\n\n\t// version\n\tVERSION:          { value: 'BUILD_PLACEHOLDER_VERSION' },\n\n\t// plugins\n\tadaptors:         { writable: true, value: {} },\n\tcomponents:       { writable: true, value: {} },\n\tdecorators:       { writable: true, value: {} },\n\teasing:           { writable: true, value: easing },\n\tevents:           { writable: true, value: {} },\n\tinterpolators:    { writable: true, value: interpolators },\n\tpartials:         { writable: true, value: {} },\n\ttransitions:      { writable: true, value: {} },\n\n\t// for getting the source Ractive lib from a constructor\n\tRactive:          { value: Ractive }\n});\n","import Binding from './Binding';\nimport { isNumeric } from '../../../../utils/is';\nimport handleDomEvent from './handleDomEvent';\n\nfunction handleBlur () {\n\thandleDomEvent.call( this );\n\n\tconst value = this._ractive.binding.model.get();\n\tthis.value = value == undefined ? '' : value;\n}\n\nfunction handleDelay ( delay ) {\n\tlet timeout;\n\n\treturn function () {\n\t\tif ( timeout ) clearTimeout( timeout );\n\n\t\ttimeout = setTimeout( () => {\n\t\t\tconst binding = this._ractive.binding;\n\t\t\tif ( binding.rendered ) handleDomEvent.call( this );\n\t\t\ttimeout = null;\n\t\t}, delay );\n\t};\n}\n\nexport default class GenericBinding extends Binding {\n\tgetInitialValue () {\n\t\treturn '';\n\t}\n\n\tgetValue () {\n\t\treturn this.node.value;\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\t// any lazy setting for this element overrides the root\n\t\t// if the value is a number, it's a timeout\n\t\tlet lazy = this.ractive.lazy;\n\t\tlet timeout = false;\n\t\tconst el = this.element;\n\n\t\tif ( 'lazy' in this.element ) {\n\t\t\tlazy = this.element.lazy;\n\t\t}\n\n\t\tif ( isNumeric( lazy ) ) {\n\t\t\ttimeout = +lazy;\n\t\t\tlazy = false;\n\t\t}\n\n\t\tthis.handler = timeout ? handleDelay( timeout ) : handleDomEvent;\n\n\t\tconst node = this.node;\n\n\t\tel.on( 'change', handleDomEvent );\n\n\t\tif ( node.type !== 'file' ) {\n\t\t\tif ( !lazy ) {\n\t\t\t\tel.on( 'input', this.handler );\n\n\t\t\t\t// IE is a special snowflake\n\t\t\t\tif ( node.attachEvent ) {\n\t\t\t\t\tel.on( 'keyup', this.handler );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tel.on( 'blur', handleBlur );\n\t\t}\n\t}\n\n\tunrender () {\n\t\tconst el = this.element;\n\t\tthis.rendered = false;\n\n\t\tel.off( 'change', handleDomEvent );\n\t\tel.off( 'input', this.handler );\n\t\tel.off( 'keyup', this.handler );\n\t\tel.off( 'blur', handleBlur );\n\t}\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class FileBinding extends GenericBinding {\n\tgetInitialValue () {\n\t\treturn undefined;\n\t}\n\n\tgetValue () {\n\t\treturn this.node.files;\n\t}\n\n\trender () {\n\t\tthis.element.lazy = false;\n\t\tsuper.render();\n\t}\n\n\tsetFromNode( node ) {\n\t\tthis.model.set( node.files );\n\t}\n}\n\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\nimport { arrayContentsMatch } from '../../../../utils/array';\nimport getSelectedOptions from '../../../../utils/getSelectedOptions';\n\nexport default class MultipleSelectBinding extends Binding {\n\tgetInitialValue () {\n\t\treturn this.element.options\n\t\t\t.filter( option => option.getAttribute( 'selected' ) )\n\t\t\t.map( option => option.getAttribute( 'value' ) );\n\t}\n\n\tgetValue () {\n\t\tconst options = this.element.node.options;\n\t\tconst len = options.length;\n\n\t\tconst selectedValues = [];\n\n\t\tfor ( let i = 0; i < len; i += 1 ) {\n\t\t\tconst option = options[i];\n\n\t\t\tif ( option.selected ) {\n\t\t\t\tconst optionValue = option._ractive ? option._ractive.value : option.value;\n\t\t\t\tselectedValues.push( optionValue );\n\t\t\t}\n\t\t}\n\n\t\treturn selectedValues;\n\t}\n\n\thandleChange () {\n\t\tconst attribute = this.attribute;\n\t\tconst previousValue = attribute.getValue();\n\n\t\tconst value = this.getValue();\n\n\t\tif ( previousValue === undefined || !arrayContentsMatch( value, previousValue ) ) {\n\t\t\tsuper.handleChange();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\tthis.element.on( 'change', handleDomEvent );\n\n\t\tif ( this.model.get() === undefined ) {\n\t\t\t// get value from DOM, if possible\n\t\t\tthis.handleChange();\n\t\t}\n\t}\n\n\tsetFromNode ( node ) {\n\t\tconst selectedOptions = getSelectedOptions( node );\n\t\tlet i = selectedOptions.length;\n\t\tconst result = new Array( i );\n\n\t\twhile ( i-- ) {\n\t\t\tconst option = selectedOptions[i];\n\t\t\tresult[i] = option._ractive ? option._ractive.value : option.value;\n\t\t}\n\n\t\tthis.model.set( result );\n\t}\n\n\tunrender () {\n\t\tthis.element.off( 'change', handleDomEvent );\n\t}\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class NumericBinding extends GenericBinding {\n\tgetInitialValue () {\n\t\treturn undefined;\n\t}\n\n\tgetValue () {\n\t\tconst value = parseFloat( this.node.value );\n\t\treturn isNaN( value ) ? undefined : value;\n\t}\n\n\tsetFromNode( node ) {\n\t\tconst value = parseFloat( node.value );\n\t\tif ( !isNaN( value ) ) this.model.set( value );\n\t}\n}\n","import runloop from '../../../../global/runloop';\nimport { removeFromArray } from '../../../../utils/array';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nconst siblings = {};\n\nfunction getSiblings ( hash ) {\n\treturn siblings[ hash ] || ( siblings[ hash ] = [] );\n}\n\nexport default class RadioBinding extends Binding {\n\tconstructor ( element ) {\n\t\tsuper( element, 'checked' );\n\n\t\tthis.siblings = getSiblings( this.ractive._guid + this.element.getAttribute( 'name' ) );\n\t\tthis.siblings.push( this );\n\t}\n\n\tgetValue () {\n\t\treturn this.node.checked;\n\t}\n\n\thandleChange () {\n\t\trunloop.start( this.root );\n\n\t\tthis.siblings.forEach( binding => {\n\t\t\tbinding.model.set( binding.getValue() );\n\t\t});\n\n\t\trunloop.end();\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\tthis.element.on( 'change', handleDomEvent );\n\n\t\tif ( this.node.attachEvent ) {\n\t\t\tthis.element.on( 'click', handleDomEvent );\n\t\t}\n\t}\n\n\tsetFromNode ( node ) {\n\t\tthis.model.set( node.checked );\n\t}\n\n\tunbind () {\n\t\tremoveFromArray( this.siblings, this );\n\t}\n\n\tunrender () {\n\t\tthis.element.off( 'change', handleDomEvent );\n\t\tthis.element.off( 'click', handleDomEvent );\n\t}\n}\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\nimport noop from '../../../../utils/noop';\n\nfunction getValue() {\n\tconst checked = this.bindings.filter( b => b.node.checked );\n\tif ( checked.length > 0 ) {\n\t\treturn checked[0].element.getAttribute( 'value' );\n\t}\n}\n\nexport default class RadioNameBinding extends Binding {\n\tconstructor ( element ) {\n\t\tsuper( element, 'name' );\n\n\t\tthis.group = getBindingGroup( 'radioname', this.model, getValue );\n\t\tthis.group.add( this );\n\n\t\tif ( element.checked ) {\n\t\t\tthis.group.value = this.getValue();\n\t\t}\n\t}\n\n\tbind () {\n\t\tif ( !this.group.bound ) {\n\t\t\tthis.group.bind();\n\t\t}\n\n\t\t// update name keypath when necessary\n\t\tthis.nameAttributeBinding = {\n\t\t\thandleChange: () => this.node.name = `{{${this.model.getKeypath()}}}`,\n\t\t\trebind: noop\n\t\t};\n\n\t\tthis.model.getKeypathModel().register( this.nameAttributeBinding );\n\t}\n\n\tgetInitialValue () {\n\t\tif ( this.element.getAttribute( 'checked' ) ) {\n\t\t\treturn this.element.getAttribute( 'value' );\n\t\t}\n\t}\n\n\tgetValue () {\n\t\treturn this.element.getAttribute( 'value' );\n\t}\n\n\thandleChange () {\n\t\t// If this <input> is the one that's checked, then the value of its\n\t\t// `name` model gets set to its value\n\t\tif ( this.node.checked ) {\n\t\t\tthis.group.value = this.getValue();\n\t\t\tsuper.handleChange();\n\t\t}\n\t}\n\n\tlastVal ( setting, value ) {\n\t\tif ( !this.group ) return;\n\t\tif ( setting ) this.group.lastValue = value;\n\t\telse return this.group.lastValue;\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\tconst node = this.node;\n\n\t\tnode.name = `{{${this.model.getKeypath()}}}`;\n\t\tnode.checked = this.element.compare ( this.model.get(), this.element.getAttribute( 'value' ) );\n\n\t\tthis.element.on( 'change', handleDomEvent );\n\n\t\tif ( node.attachEvent ) {\n\t\t\tthis.element.on( 'click', handleDomEvent );\n\t\t}\n\t}\n\n\tsetFromNode ( node ) {\n\t\tif ( node.checked ) {\n\t\t\tthis.group.model.set( this.element.getAttribute( 'value' ) );\n\t\t}\n\t}\n\n\tunbind () {\n\t\tthis.group.remove( this );\n\n\t\tthis.model.getKeypathModel().unregister( this.nameAttributeBinding );\n\t}\n\n\tunrender () {\n\t\tconst el = this.element;\n\n\t\tel.off( 'change', handleDomEvent );\n\t\tel.off( 'click', handleDomEvent );\n\t}\n}\n","import runloop from '../../../../global/runloop';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\nimport getSelectedOptions from '../../../../utils/getSelectedOptions';\n\nexport default class SingleSelectBinding extends Binding {\n\tforceUpdate () {\n\t\tconst value = this.getValue();\n\n\t\tif ( value !== undefined ) {\n\t\t\tthis.attribute.locked = true;\n\t\t\trunloop.scheduleTask( () => this.attribute.locked = false );\n\t\t\tthis.model.set( value );\n\t\t}\n\t}\n\n\tgetInitialValue () {\n\t\tif ( this.element.getAttribute( 'value' ) !== undefined ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst options = this.element.options;\n\t\tconst len = options.length;\n\n\t\tif ( !len ) return;\n\n\t\tlet value;\n\t\tlet optionWasSelected;\n\t\tlet i = len;\n\n\t\t// take the final selected option...\n\t\twhile ( i-- ) {\n\t\t\tconst option = options[i];\n\n\t\t\tif ( option.getAttribute( 'selected' ) ) {\n\t\t\t\tif ( !option.getAttribute( 'disabled' ) ) {\n\t\t\t\t\tvalue = option.getAttribute( 'value' );\n\t\t\t\t}\n\n\t\t\t\toptionWasSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// or the first non-disabled option, if none are selected\n\t\tif ( !optionWasSelected ) {\n\t\t\twhile ( ++i < len ) {\n\t\t\t\tif ( !options[i].getAttribute( 'disabled' ) ) {\n\t\t\t\t\tvalue = options[i].getAttribute( 'value' );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// This is an optimisation (aka hack) that allows us to forgo some\n\t\t// other more expensive work\n\t\t// TODO does it still work? seems at odds with new architecture\n\t\tif ( value !== undefined ) {\n\t\t\tthis.element.attributeByName.value.value = value;\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tgetValue () {\n\t\tconst options = this.node.options;\n\t\tconst len = options.length;\n\n\t\tlet i;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tconst option = options[i];\n\n\t\t\tif ( options[i].selected && !options[i].disabled ) {\n\t\t\t\treturn option._ractive ? option._ractive.value : option.value;\n\t\t\t}\n\t\t}\n\t}\n\n\trender () {\n\t\tsuper.render();\n\t\tthis.element.on( 'change', handleDomEvent );\n\t}\n\n\tsetFromNode ( node ) {\n\t\tconst option = getSelectedOptions( node )[0];\n\t\tthis.model.set( option._ractive ? option._ractive.value : option.value );\n\t}\n\n\tunrender () {\n\t\tthis.element.off( 'change', handleDomEvent );\n\t}\n}\n","import { ATTRIBUTE, BINDING_FLAG, DECORATOR, DELEGATE_FLAG, EVENT, TRANSITION } from '../../config/types';\nimport runloop from '../../global/runloop';\nimport { ContainerItem } from './shared/Item';\nimport Fragment from '../Fragment';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport { toArray, addToArray, removeFromArray } from '../../utils/array';\nimport { escapeHtml, voidElementNames } from '../../utils/html';\nimport { bind, destroyed, render, unbind, update } from '../../shared/methodCallers';\nimport { createElement, detachNode, matches, safeAttributeString } from '../../utils/dom';\nimport createItem from './createItem';\nimport { html, svg } from '../../config/namespaces';\nimport findElement from './shared/findElement';\nimport selectBinding from './element/binding/selectBinding';\nimport Context from '../../shared/Context';\n\nconst endsWithSemi = /;\\s*$/;\n\nexport default class Element extends ContainerItem {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.name = options.template.e.toLowerCase();\n\t\tthis.isVoid = voidElementNames.test( this.name );\n\n\t\t// find parent element\n\t\tthis.parent = findElement( this.parentFragment, false );\n\n\t\tif ( this.parent && this.parent.name === 'option' ) {\n\t\t\tthrow new Error( `An <option> element cannot contain other elements (encountered <${this.name}>)` );\n\t\t}\n\n\t\tthis.decorators = [];\n\t\tthis.listeners = {};\n\t\tthis.events = [];\n\n\t\t// create attributes\n\t\tthis.attributeByName = {};\n\n\t\tthis.attributes = [];\n\t\tconst leftovers = [];\n\t\t( this.template.m || [] ).forEach( template => {\n\t\t\tswitch ( template.t ) {\n\t\t\t\tcase ATTRIBUTE:\n\t\t\t\tcase BINDING_FLAG:\n\t\t\t\tcase DECORATOR:\n\t\t\t\tcase EVENT:\n\t\t\t\tcase TRANSITION:\n\t\t\t\t\tthis.attributes.push( createItem({\n\t\t\t\t\t\towner: this,\n\t\t\t\t\t\tparentFragment: this.parentFragment,\n\t\t\t\t\t\ttemplate\n\t\t\t\t\t}) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase DELEGATE_FLAG:\n\t\t\t\t  this.delegate = false;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tleftovers.push( template );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tif ( leftovers.length ) {\n\t\t\tthis.attributes.push( new ConditionalAttribute({\n\t\t\t\towner: this,\n\t\t\t\tparentFragment: this.parentFragment,\n\t\t\t\ttemplate: leftovers\n\t\t\t}) );\n\t\t}\n\n\t\tthis.attributes.sort( sortAttributes );\n\n\t\t// create children\n\t\tif ( options.template.f && !options.deferContent ) {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\ttemplate: options.template.f,\n\t\t\t\towner: this,\n\t\t\t\tcssIds: null\n\t\t\t});\n\t\t}\n\n\t\tthis.binding = null; // filled in later\n\t}\n\n\tbind () {\n\t\tthis.attributes.binding = true;\n\t\tthis.attributes.forEach( bind );\n\t\tthis.attributes.binding = false;\n\n\t\tif ( this.fragment ) this.fragment.bind();\n\n\t\t// create two-way binding if necessary\n\t\tif ( !this.binding ) this.recreateTwowayBinding();\n\t\telse this.binding.bind();\n\t}\n\n\tcreateTwowayBinding () {\n\t\tif ( 'twoway' in this ? this.twoway : this.ractive.twoway ) {\n\t\t\tconst Binding = selectBinding( this );\n\t\t\tif ( Binding ) {\n\t\t\t\tconst binding = new Binding( this );\n\t\t\t\tif ( binding && binding.model ) return binding;\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroyed () {\n\t\tthis.attributes.forEach( destroyed );\n\n\t\tif ( !this.parentFragment.delegate ) {\n\t\t\tconst ls = this.listeners;\n\t\t\tfor ( const k in ls ) {\n\t\t\t\tif ( ls[k] && ls[k].length ) this.node.removeEventListener( k, handler );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.fragment ) this.fragment.destroyed();\n\t}\n\n\tdetach () {\n\t\t// if this element is no longer rendered, the transitions are complete and the attributes can be torn down\n\t\tif ( !this.rendered ) this.destroyed();\n\n\t\treturn detachNode( this.node );\n\t}\n\n\tfind ( selector, options ) {\n\t\tif ( this.node && matches( this.node, selector ) ) return this.node;\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.find( selector, options );\n\t\t}\n\t}\n\n\tfindAll ( selector, options ) {\n\t\tconst { result } = options;\n\n\t\tif ( matches( this.node, selector ) ) {\n\t\t\tresult.push( this.node );\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAll( selector, options );\n\t\t}\n\t}\n\n\tfindNextNode () {\n\t\treturn null;\n\t}\n\n\tfirstNode () {\n\t\treturn this.node;\n\t}\n\n\tgetAttribute ( name ) {\n\t\tconst attribute = this.attributeByName[ name ];\n\t\treturn attribute ? attribute.getValue() : undefined;\n\t}\n\n\tgetContext ( ...assigns ) {\n\t\tif ( this.fragment ) return this.fragment.getContext( ...assigns );\n\n\t\tif ( !this.ctx ) this.ctx = new Context( this.parentFragment, this );\n\t\tassigns.unshift( Object.create( this.ctx ) );\n\t\treturn Object.assign.apply( null, assigns );\n\t}\n\n\toff ( event, callback, capture = false ) {\n\t\tconst delegate = this.parentFragment.delegate;\n\t\tconst ref = this.listeners[event];\n\n\t\tif ( !ref ) return;\n\t\tremoveFromArray( ref, callback );\n\n\t\tif ( delegate ) {\n\t\t\tconst listeners = delegate.listeners[event] || ( delegate.listeners[event] = [] );\n\t\t\tif ( listeners.refs && !--listeners.refs ) delegate.off( event, delegateHandler, true );\n\t\t} else if ( this.rendered ) {\n\t\t\tconst n = this.node;\n\t\t\tconst add = n.addEventListener;\n\t\t\tconst rem = n.removeEventListener;\n\n\t\t\tif ( !ref.length ) {\n\t\t\t\trem.call( n, event, handler, capture );\n\t\t\t} else if ( ref.length && !ref.refs && capture ) {\n\t\t\t\trem.call( n, event, handler, true );\n\t\t\t\tadd.call( n, event, handler, false );\n\t\t\t}\n\t\t}\n\t}\n\n\ton ( event, callback, capture = false ) {\n\t\tconst delegate = this.parentFragment.delegate;\n\t\tconst ref = this.listeners[event] || ( this.listeners[event] = [] );\n\n\t\tif ( delegate ) {\n\t\t\tconst listeners = delegate.listeners[event] || ( delegate.listeners[event] = [] );\n\t\t\tif ( !listeners.refs ) {\n\t\t\t\tlisteners.refs = 0;\n\t\t\t\tdelegate.on( event, delegateHandler, true );\n\t\t\t\tlisteners.refs++;\n\t\t\t} else {\n\t\t\t\tlisteners.refs++;\n\t\t\t}\n\t\t} else if ( this.rendered ) {\n\t\t\tconst n = this.node;\n\t\t\tconst add = n.addEventListener;\n\t\t\tconst rem = n.removeEventListener;\n\n\t\t\tif ( !ref.length ) {\n\t\t\t\tadd.call( n, event, handler, capture );\n\t\t\t} else if ( ref.length && !ref.refs && capture ) {\n\t\t\t\trem.call( n, event, handler, false );\n\t\t\t\tadd.call( n, event, handler, true );\n\t\t\t}\n\t\t}\n\n\t\taddToArray( this.listeners[event], callback );\n\t}\n\n\trecreateTwowayBinding () {\n\t\tif ( this.binding ) {\n\t\t\tthis.binding.unbind();\n\t\t\tthis.binding.unrender();\n\t\t}\n\n\t\tif ( this.binding = this.createTwowayBinding() ) {\n\t\t\tthis.binding.bind();\n\t\t\tif ( this.rendered ) this.binding.render();\n\t\t}\n\t}\n\n\trender ( target, occupants ) {\n\t\t// TODO determine correct namespace\n\t\tthis.namespace = getNamespace( this );\n\n\t\tlet node;\n\t\tlet existing = false;\n\n\t\tif ( occupants ) {\n\t\t\tlet n;\n\t\t\twhile ( ( n = occupants.shift() ) ) {\n\t\t\t\tif ( n.nodeName.toUpperCase() === this.template.e.toUpperCase() && n.namespaceURI === this.namespace ) {\n\t\t\t\t\tthis.node = node = n;\n\t\t\t\t\texisting = true;\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tdetachNode( n );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( !node ) {\n\t\t\tconst name = this.template.e;\n\t\t\tnode = createElement( this.namespace === html ? name.toLowerCase() : name, this.namespace, this.getAttribute( 'is' ) );\n\t\t\tthis.node = node;\n\t\t}\n\n\t\t// tie the node to this vdom element\n\t\tObject.defineProperty( node, '_ractive', {\n\t\t\tvalue: {\n\t\t\t\tproxy: this\n\t\t\t}\n\t\t});\n\n\t\t// Is this a top-level node of a component? If so, we may need to add\n\t\t// a data-ractive-css attribute, for CSS encapsulation\n\t\tif ( this.parentFragment.cssIds ) {\n\t\t\tnode.setAttribute( 'data-ractive-css', this.parentFragment.cssIds.map( x => `{${x}}` ).join( ' ' ) );\n\t\t}\n\n\t\tif ( existing && this.foundNode ) this.foundNode( node );\n\n\t\t// register intro before rendering content so children can find the intro\n\t\tconst intro = this.intro;\n\t\tif ( intro && intro.shouldFire( 'intro' ) ) {\n\t\t\tintro.isIntro = true;\n\t\t\tintro.isOutro = false;\n\t\t\trunloop.registerTransition( intro );\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tconst children = existing ? toArray( node.childNodes ) : undefined;\n\n\t\t\tthis.fragment.render( node, children );\n\n\t\t\t// clean up leftover children\n\t\t\tif ( children ) {\n\t\t\t\tchildren.forEach( detachNode );\n\t\t\t}\n\t\t}\n\n\t\tif ( existing ) {\n\t\t\t// store initial values for two-way binding\n\t\t\tif ( this.binding && this.binding.wasUndefined ) this.binding.setFromNode( node );\n\t\t\t// remove unused attributes\n\t\t\tlet i = node.attributes.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tconst name = node.attributes[i].name;\n\t\t\t\tif ( !( name in this.attributeByName ) )node.removeAttribute( name );\n\t\t\t}\n\t\t}\n\n\t\tthis.attributes.forEach( render );\n\t\tif ( this.binding ) this.binding.render();\n\n\t\tif ( !this.parentFragment.delegate ) {\n\t\t\tconst ls = this.listeners;\n\t\t\tfor ( const k in ls ) {\n\t\t\t\tif ( ls[k] && ls[k].length ) this.node.addEventListener( k, handler, !!ls[k].refs );\n\t\t\t}\n\t\t}\n\n\t\tif ( !existing ) {\n\t\t\ttarget.appendChild( node );\n\t\t}\n\n\t\tthis.rendered = true;\n\t}\n\n\ttoString () {\n\t\tconst tagName = this.template.e;\n\n\t\tlet attrs = this.attributes.map( stringifyAttribute ).join( '' );\n\n\t\t// Special case - selected options\n\t\tif ( this.name === 'option' && this.isSelected() ) {\n\t\t\tattrs += ' selected';\n\t\t}\n\n\t\t// Special case - two-way radio name bindings\n\t\tif ( this.name === 'input' && inputIsCheckedRadio( this ) ) {\n\t\t\tattrs += ' checked';\n\t\t}\n\n\t\t// Special case style and class attributes and directives\n\t\tlet style, cls;\n\t\tthis.attributes.forEach( attr => {\n\t\t\tif ( attr.name === 'class' ) {\n\t\t\t\tcls = ( cls || '' ) + ( cls ? ' ' : '' ) + safeAttributeString( attr.getString() );\n\t\t\t} else if ( attr.name === 'style' ) {\n\t\t\t\tstyle = ( style || '' ) + ( style ? ' ' : '' ) + safeAttributeString( attr.getString() );\n\t\t\t\tif ( style && !endsWithSemi.test( style ) ) style += ';';\n\t\t\t} else if ( attr.style ) {\n\t\t\t\tstyle = ( style || '' ) + ( style ? ' ' : '' ) +  `${attr.style}: ${safeAttributeString( attr.getString() )};`;\n\t\t\t} else if ( attr.inlineClass && attr.getValue() ) {\n\t\t\t\tcls = ( cls || '' ) + ( cls ? ' ' : '' ) + attr.inlineClass;\n\t\t\t}\n\t\t});\n\t\t// put classes first, then inline style\n\t\tif ( style !== undefined ) attrs = ' style' + ( style ? `=\"${style}\"` : '' ) + attrs;\n\t\tif ( cls !== undefined ) attrs = ' class' + (cls ? `=\"${cls}\"` : '') + attrs;\n\n\t\tif ( this.parentFragment.cssIds ) {\n\t\t\tattrs += ` data-ractive-css=\"${this.parentFragment.cssIds.map( x => `{${x}}` ).join( ' ' )}\"`;\n\t\t}\n\n\t\tlet str = `<${tagName}${attrs}>`;\n\n\t\tif ( this.isVoid ) return str;\n\n\t\t// Special case - textarea\n\t\tif ( this.name === 'textarea' && this.getAttribute( 'value' ) !== undefined ) {\n\t\t\tstr += escapeHtml( this.getAttribute( 'value' ) );\n\t\t}\n\n\t\t// Special case - contenteditable\n\t\telse if ( this.getAttribute( 'contenteditable' ) !== undefined ) {\n\t\t\tstr += ( this.getAttribute( 'value' ) || '' );\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tstr += this.fragment.toString( !/^(?:script|style)$/i.test( this.template.e ) ); // escape text unless script/style\n\t\t}\n\n\t\tstr += `</${tagName}>`;\n\t\treturn str;\n\t}\n\n\tunbind () {\n\t\tthis.attributes.unbinding = true;\n\t\tthis.attributes.forEach( unbind );\n\t\tthis.attributes.unbinding = false;\n\n\t\tif ( this.binding ) this.binding.unbind();\n\t\tif ( this.fragment ) this.fragment.unbind();\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tif ( !this.rendered ) return;\n\t\tthis.rendered = false;\n\n\t\t// unrendering before intro completed? complete it now\n\t\t// TODO should be an API for aborting transitions\n\t\tconst transition = this.intro;\n\t\tif ( transition && transition.complete ) transition.complete();\n\n\t\t// Detach as soon as we can\n\t\tif ( this.name === 'option' ) {\n\t\t\t// <option> elements detach immediately, so that\n\t\t\t// their parent <select> element syncs correctly, and\n\t\t\t// since option elements can't have transitions anyway\n\t\t\tthis.detach();\n\t\t} else if ( shouldDestroy ) {\n\t\t\trunloop.detachWhenReady( this );\n\t\t}\n\n\t\t// outro transition\n\t\tconst outro = this.outro;\n\t\tif ( outro && outro.shouldFire( 'outro' ) ) {\n\t\t\toutro.isIntro = false;\n\t\t\toutro.isOutro = true;\n\t\t\trunloop.registerTransition( outro );\n\t\t}\n\n\t\tif ( this.fragment ) this.fragment.unrender();\n\n\t\tif ( this.binding ) this.binding.unrender();\n\t}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tthis.attributes.forEach( update );\n\n\t\t\tif ( this.fragment ) this.fragment.update();\n\t\t}\n\t}\n}\n\nconst toFront = [ 'min', 'max', 'class', 'type' ];\nfunction sortAttributes ( left, right ) {\n\tleft = left.name;\n\tright = right.name;\n\tconst l = left === 'value' ? 1 : ~toFront.indexOf( left );\n\tconst r = right === 'value' ? 1 : ~toFront.indexOf( right );\n\treturn l < r ? -1 : l > r ? 1 : 0;\n}\n\nfunction inputIsCheckedRadio ( element ) {\n\tconst nameAttr = element.attributeByName.name;\n\treturn element.getAttribute( 'type' ) === 'radio' &&\n\t\t( nameAttr || {} ).interpolator &&\n\t\telement.getAttribute( 'value' ) === nameAttr.interpolator.model.get();\n}\n\nfunction stringifyAttribute ( attribute ) {\n\tconst str = attribute.toString();\n\treturn str ? ' ' + str : '';\n}\n\nfunction getNamespace ( element ) {\n\t// Use specified namespace...\n\tconst xmlns = element.getAttribute( 'xmlns' );\n\tif ( xmlns ) return xmlns;\n\n\t// ...or SVG namespace, if this is an <svg> element\n\tif ( element.name === 'svg' ) return svg;\n\n\tconst parent = element.parent;\n\n\tif ( parent ) {\n\t\t// ...or HTML, if the parent is a <foreignObject>\n\t\tif ( parent.name === 'foreignobject' ) return html;\n\n\t\t// ...or inherit from the parent node\n\t\treturn parent.node.namespaceURI;\n\t}\n\n\treturn element.ractive.el.namespaceURI;\n}\n\nfunction delegateHandler ( ev ) {\n\tconst name = ev.type;\n\tconst end = ev.currentTarget;\n\tlet node = ev.target;\n\tlet bubble = true;\n\tlet listeners;\n\n\t// starting with the origin node, walk up the DOM looking for ractive nodes with a matching event listener\n\twhile ( bubble && node && node !== end ) {\n\t\tconst proxy = node._ractive && node._ractive.proxy;\n\t\tif ( proxy && proxy.parentFragment.delegate ) {\n\t\t\tlisteners = proxy.listeners[name];\n\n\t\t\tif ( listeners ) {\n\t\t\t\tlisteners.forEach( l => {\n\t\t\t\t\tbubble = l.call( node, ev ) !== false && bubble;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tnode = node.parentNode;\n\t}\n\n\treturn bubble;\n}\n\nfunction handler ( ev ) {\n\tconst el = this._ractive.proxy;\n\tif ( !el.listeners[ ev.type ] ) return;\n\tel.listeners[ ev.type ].forEach( l => l.call( this, ev ) );\n}\n","import runloop from '../../../../global/runloop';\nimport Element from '../../Element';\n\nexport default class Form extends Element {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\t\tthis.formBindings = [];\n\t}\n\n\trender ( target, occupants ) {\n\t\tsuper.render( target, occupants );\n\t\tthis.on( 'reset', handleReset );\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tthis.off( 'reset', handleReset );\n\t\tsuper.unrender( shouldDestroy );\n\t}\n}\n\nfunction handleReset () {\n\tconst element = this._ractive.proxy;\n\n\trunloop.start();\n\telement.formBindings.forEach( updateModel );\n\trunloop.end();\n}\n\nfunction updateModel ( binding ) {\n\tbinding.model.set( binding.resetValue );\n}\n","import { fatal } from '../../../utils/log';\n\nclass DOMEvent {\n\tconstructor ( name, owner ) {\n\t\tif ( name.indexOf( '*' ) !== -1 ) {\n\t\t\tfatal( `Only component proxy-events may contain \"*\" wildcards, <${owner.name} on-${name}=\"...\"/> is not valid` );\n\t\t}\n\n\t\tthis.name = name;\n\t\tthis.owner = owner;\n\t\tthis.handler = null;\n\t}\n\n\tlisten ( directive ) {\n\t\tconst node = this.owner.node;\n\t\tconst name = this.name;\n\n\t\t// this is probably a custom event fired from a decorator or manually\n\t\tif ( !( `on${name}` in node ) ) return;\n\n\t\tthis.owner.on( name, this.handler = ( event ) => {\n\t\t\treturn directive.fire({\n\t\t\t\tnode,\n\t\t\t\toriginal: event,\n\t\t\t\tevent,\n\t\t\t\tname\n\t\t\t});\n\t\t});\n\t}\n\n\tunlisten () {\n\t\tif ( this.handler ) this.owner.off( this.name, this.handler );\n\t}\n}\n\nclass CustomEvent {\n\tconstructor ( eventPlugin, owner, name ) {\n\t\tthis.eventPlugin = eventPlugin;\n\t\tthis.owner = owner;\n\t\tthis.name = name;\n\t\tthis.handler = null;\n\t}\n\n\tlisten ( directive ) {\n\t\tconst node = this.owner.node;\n\n\t\tthis.handler = this.eventPlugin( node, ( event = {} ) => {\n\t\t\tif ( event.original ) event.event = event.original;\n\t\t\telse event.original = event.event;\n\n\t\t\tevent.name = this.name;\n\t\t\tevent.node = event.node || node;\n\t\t\treturn directive.fire( event );\n\t\t});\n\t}\n\n\tunlisten () {\n\t\tthis.handler.teardown();\n\t}\n}\n\nexport { DOMEvent, CustomEvent };\n","import Context from '../../../shared/Context';\n\nexport default class RactiveEvent {\n\tconstructor ( component, name ) {\n\t\tthis.component = component;\n\t\tthis.name = name;\n\t\tthis.handler = null;\n\t}\n\n\tlisten ( directive ) {\n\t\tconst ractive = this.component.instance;\n\n\t\tthis.handler = ractive.on( this.name, ( ...args ) => {\n\t\t\t// watch for reproxy\n\t\t\tif ( args[0] instanceof Context ) {\n\t\t\t\tconst ctx = args.shift();\n\t\t\t\tctx.component = ractive;\n\t\t\t\tdirective.fire( ctx, args );\n\t\t\t} else {\n\t\t\t\tdirective.fire( {}, args );\n\t\t\t}\n\n\t\t\t// cancel bubbling\n\t\t\treturn false;\n\t\t});\n\t}\n\n\tunlisten () {\n\t\tthis.handler.cancel();\n\t}\n}\n","import { ANCHOR, COMPONENT } from '../../../config/types';\nimport fireEvent from '../../../events/fireEvent';\nimport { splitKeypath } from '../../../shared/keypaths';\nimport findElement from './findElement';\nimport { findInViewHierarchy } from '../../../shared/registry';\nimport { DOMEvent, CustomEvent } from '../element/ElementEvents';\nimport RactiveEvent from '../component/RactiveEvent';\nimport runloop from '../../../global/runloop';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport { warnOnceIfDebug } from '../../../utils/log';\nimport { addToArray, removeFromArray } from '../../../utils/array';\nimport noop from '../../../utils/noop';\n\nconst specialPattern = /^(event|arguments|@node|@event|@context)(\\..+)?$/;\nconst dollarArgsPattern = /^\\$(\\d+)(\\..+)?$/;\n\nexport default class EventDirective {\n\tconstructor ( options ) {\n\t\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\t\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment, true );\n\t\tthis.template = options.template;\n\t\tthis.parentFragment = options.parentFragment;\n\t\tthis.ractive = options.parentFragment.ractive;\n\t\t//const delegate = this.delegate = this.ractive.delegate && options.parentFragment.delegate;\n\t\tthis.events = [];\n\n\t\tif ( this.element.type === COMPONENT || this.element.type === ANCHOR ) {\n\t\t\tthis.template.n.forEach( n => {\n\t\t\t\tthis.events.push( new RactiveEvent( this.element, n ) );\n\t\t\t});\n\t\t} else {\n\t\t\t// make sure the delegate element has a storag object\n\t\t\t//if ( delegate && !delegate.delegates ) delegate.delegates = {};\n\n\t\t\tthis.template.n.forEach( n => {\n\t\t\t\tconst fn = findInViewHierarchy( 'events', this.ractive, n );\n\t\t\t\tif ( fn ) {\n\t\t\t\t\tthis.events.push( new CustomEvent( fn, this.element, n ) );\n\t\t\t\t} else {\n\t\t\t\t\t/*if ( delegate ) {\n\t\t\t\t\t\tif ( !delegate.delegates[n] ) {\n\t\t\t\t\t\t\tconst ev = new DOMEvent( n, delegate, true );\n\t\t\t\t\t\t\tdelegate.delegates[n] = ev;\n\t\t\t\t\t\t\t// if the element is already rendered, render the event too\n\t\t\t\t\t\t\tif ( delegate.rendered ) ev.listen( DelegateProxy );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.events.push( new DOMEvent( n, this.element ) );\n\t\t\t\t\t}*/\n\t\t\t\t\tthis.events.push( new DOMEvent( n, this.element ) );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// method calls\n\t\tthis.models = null;\n\t}\n\n\tbind () {\n\t\taddToArray( this.element.events, this );\n\n\t\tsetupArgsFn( this, this.template );\n\t\tif ( !this.fn ) this.action = this.template.f;\n\t}\n\n\tdestroyed () {\n\t\tthis.events.forEach( e => e.unlisten() );\n\t}\n\n\tfire ( event, args = [] ) {\n\t\tconst context = this.element.getContext( event );\n\n\t\tif ( this.fn ) {\n\t\t\tconst values = [];\n\n\t\t\tconst models = resolveArgs( this, this.template, this.parentFragment, {\n\t\t\t\tspecialRef ( ref ) {\n\t\t\t\t\tconst specialMatch = specialPattern.exec( ref );\n\t\t\t\t\tif ( specialMatch ) {\n\t\t\t\t\t\t// on-click=\"foo(event.node)\"\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tspecial: specialMatch[1],\n\t\t\t\t\t\t\tkeys: specialMatch[2] ? splitKeypath( specialMatch[2].substr(1) ) : []\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\tconst dollarMatch = dollarArgsPattern.exec( ref );\n\t\t\t\t\tif ( dollarMatch ) {\n\t\t\t\t\t\t// on-click=\"foo($1)\"\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tspecial: 'arguments',\n\t\t\t\t\t\t\tkeys: [ dollarMatch[1] - 1 ].concat( dollarMatch[2] ? splitKeypath( dollarMatch[2].substr( 1 ) ) : [] )\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif ( models ) {\n\t\t\t\tmodels.forEach( model => {\n\t\t\t\t\tif ( !model ) return values.push( undefined );\n\n\t\t\t\t\tif ( model.special ) {\n\t\t\t\t\t\tconst which = model.special;\n\t\t\t\t\t\tlet obj;\n\n\t\t\t\t\t\tif ( which === '@node' ) {\n\t\t\t\t\t\t\tobj = this.element.node;\n\t\t\t\t\t\t} else if ( which === '@event' ) {\n\t\t\t\t\t\t\tobj = event && event.event;\n\t\t\t\t\t\t} else if ( which === 'event' ) {\n\t\t\t\t\t\t\twarnOnceIfDebug( `The event reference available to event directives is deprecated and should be replaced with @context and @event` );\n\t\t\t\t\t\t\tobj = context;\n\t\t\t\t\t\t} else if ( which === '@context' ) {\n\t\t\t\t\t\t\tobj = context;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tobj = args;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst keys = model.keys.slice();\n\n\t\t\t\t\t\twhile ( obj && keys.length ) obj = obj[ keys.shift() ];\n\t\t\t\t\t\treturn values.push( obj );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( model.wrapper ) {\n\t\t\t\t\t\treturn values.push( model.wrapperValue );\n\t\t\t\t\t}\n\n\t\t\t\t\tvalues.push( model.get() );\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// make event available as `this.event`\n\t\t\tconst ractive = this.ractive;\n\t\t\tconst oldEvent = ractive.event;\n\n\t\t\tractive.event = context;\n\t\t\tconst returned = this.fn.apply( ractive, values );\n\t\t\tlet result = returned.pop();\n\n\t\t\t// Auto prevent and stop if return is explicitly false\n\t\t\tif ( result === false ) {\n\t\t\t\tconst original = event ? event.original : undefined;\n\t\t\t\tif ( original ) {\n\t\t\t\t\toriginal.preventDefault && original.preventDefault();\n\t\t\t\t\toriginal.stopPropagation && original.stopPropagation();\n\t\t\t\t} else {\n\t\t\t\t\twarnOnceIfDebug( `handler '${this.template.n.join( ' ' )}' returned false, but there is no event available to cancel` );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// watch for proxy events\n\t\t\telse if ( !returned.length && Array.isArray( result ) && typeof result[0] === 'string' ) {\n\t\t\t\tresult = fireEvent( this.ractive, result.shift(), context, result );\n\t\t\t}\n\n\t\t\tractive.event = oldEvent;\n\n\t\t\treturn result;\n\t\t}\n\n\t\telse {\n\t\t\treturn fireEvent( this.ractive, this.action, context, args);\n\t\t}\n\t}\n\n\thandleChange () {}\n\n\trender () {\n\t\t// render events after everything else, so they fire after bindings\n\t\trunloop.scheduleTask( () => this.events.forEach( e => e.listen( this ), true ) );\n\t}\n\n\ttoString() { return ''; }\n\n\tunbind () {\n\t\tremoveFromArray( this.element.events, this );\n\t}\n\n\tunrender () {\n\t\tthis.events.forEach( e => e.unlisten() );\n\t}\n}\n\nEventDirective.prototype.update = noop;\n","import Item, { ContainerItem } from './Item';\nimport resolve from '../../resolvers/resolve';\nimport { rebindMatch } from '../../../shared/rebind';\n\nexport default class Mustache extends Item {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.parentFragment = options.parentFragment;\n\t\tthis.template = options.template;\n\t\tthis.index = options.index;\n\t\tif ( options.owner ) this.parent = options.owner;\n\n\t\tthis.isStatic = !!options.template.s;\n\n\t\tthis.model = null;\n\t\tthis.dirty = false;\n\t}\n\n\tbind () {\n\t\t// yield mustaches should resolve in container context\n\t\tconst start = this.containerFragment || this.parentFragment;\n\t\t// try to find a model for this view\n\t\tconst model = resolve( start, this.template );\n\n\t\tif ( model ) {\n\t\t\tconst value = model.get();\n\n\t\t\tif ( this.isStatic ) {\n\t\t\t\tthis.model = { get: () => value };\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmodel.register( this );\n\t\t\tthis.model = model;\n\t\t}\n\t}\n\n\thandleChange () {\n\t\tthis.bubble();\n\t}\n\n\trebind ( next, previous, safe ) {\n\t\tnext = rebindMatch( this.template, next, previous, this.parentFragment );\n\t\tif ( next === this.model ) return false;\n\n\t\tif ( this.model ) {\n\t\t\tthis.model.unregister( this );\n\t\t}\n\t\tif ( next ) next.addShuffleRegister( this, 'mark' );\n\t\tthis.model = next;\n\t\tif ( !safe ) this.handleChange();\n\t\treturn true;\n\t}\n\n\tunbind () {\n\t\tif ( !this.isStatic ) {\n\t\t\tthis.model && this.model.unregister( this );\n\t\t\tthis.model = undefined;\n\t\t}\n\t}\n}\n\nexport class MustacheContainer extends ContainerItem {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\t}\n}\nconst proto = MustacheContainer.prototype;\nconst mustache = Mustache.prototype;\nproto.bind = mustache.bind;\nproto.handleChange = mustache.handleChange;\nproto.rebind = mustache.rebind;\nproto.unbind = mustache.unbind;\n","import progressiveText from './shared/progressiveText';\nimport { escapeHtml } from '../../utils/html';\nimport { safeToStringValue } from '../../utils/dom';\nimport Mustache from './shared/Mustache';\nimport { detachNode } from '../../utils/dom';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Interpolator extends Mustache {\n\tbubble () {\n\t\tif ( this.owner ) this.owner.bubble();\n\t\tsuper.bubble();\n\t}\n\n\tdetach () {\n\t\treturn detachNode( this.node );\n\t}\n\n\tfirstNode () {\n\t\treturn this.node;\n\t}\n\n\tgetString () {\n\t\treturn this.model ? safeToStringValue( this.model.get() ) : '';\n\t}\n\n\trender ( target, occupants ) {\n\t\tif ( inAttributes() ) return;\n\t\tconst value = this.getString();\n\n\t\tthis.rendered = true;\n\n\t\tprogressiveText( this, target, occupants, value );\n\t}\n\n\ttoString ( escape ) {\n\t\tconst string = this.getString();\n\t\treturn escape ? escapeHtml( string ) : string;\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tif ( shouldDestroy ) this.detach();\n\t\tthis.rendered = false;\n\t}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tif ( this.rendered ) {\n\t\t\t\tthis.node.data = this.getString();\n\t\t\t}\n\t\t}\n\t}\n\n\tvalueOf () {\n\t\treturn this.model ? this.model.get() : undefined;\n\t}\n}\n","import Element from '../../Element';\n\nexport default class Input extends Element {\n\trender ( target, occupants ) {\n\t\tsuper.render( target, occupants );\n\t\tthis.node.defaultValue = this.node.value;\n\t}\n\tcompare ( value, attrValue ) {\n\t\tconst comparator = this.getAttribute( 'value-comparator' );\n\t\tif ( comparator ) {\n\t\t\tif ( typeof comparator === 'function' ) {\n\t\t\t\treturn comparator( value, attrValue );\n\t\t\t}\n\t\t\tif (value && attrValue) {\n\t\t\t\treturn value[comparator] == attrValue[comparator];\n\t\t\t}\n\t\t}\n\t\treturn value == attrValue;\n\t}\n}\n","import { warnIfDebug } from '../utils/log';\n\nconst leadingWhitespace = /^\\s+/;\n\nconst ParseError = function ( message ) {\n\tthis.name = 'ParseError';\n\tthis.message = message;\n\ttry {\n\t\tthrow new Error(message);\n\t} catch (e) {\n\t\tthis.stack = e.stack;\n\t}\n};\n\nParseError.prototype = Error.prototype;\n\nconst Parser = function ( str, options ) {\n\tlet item;\n\tlet lineStart = 0;\n\n\tthis.str = str;\n\tthis.options = options || {};\n\tthis.pos = 0;\n\n\tthis.lines = this.str.split( '\\n' );\n\tthis.lineEnds = this.lines.map( line => {\n\t\tconst lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n\t\tlineStart = lineEnd;\n\t\treturn lineEnd;\n\t}, 0 );\n\n\t// Custom init logic\n\tif ( this.init ) this.init( str, options );\n\n\tconst items = [];\n\n\twhile ( ( this.pos < this.str.length ) && ( item = this.read() ) ) {\n\t\titems.push( item );\n\t}\n\n\tthis.leftover = this.remaining();\n\tthis.result = this.postProcess ? this.postProcess( items, options ) : items;\n};\n\nParser.prototype = {\n\tread ( converters ) {\n\t\tlet i, item;\n\n\t\tif ( !converters ) converters = this.converters;\n\n\t\tconst pos = this.pos;\n\n\t\tconst len = converters.length;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tthis.pos = pos; // reset for each attempt\n\n\t\t\tif ( item = converters[i]( this ) ) {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t},\n\n\tgetContextMessage ( pos, message ) {\n\t\tconst [ lineNum, columnNum ] = this.getLinePos( pos );\n\t\tif ( this.options.contextLines === -1 ) {\n\t\t\treturn [ lineNum, columnNum, `${message} at line ${lineNum} character ${columnNum}` ];\n\t\t}\n\n\t\tconst line = this.lines[ lineNum - 1 ];\n\n\t\tlet contextUp = '';\n\t\tlet contextDown = '';\n\t\tif ( this.options.contextLines ) {\n\t\t\tconst start = lineNum - 1 - this.options.contextLines < 0 ? 0 : lineNum - 1 - this.options.contextLines;\n\t\t\tcontextUp = this.lines.slice( start, lineNum - 1 - start ).join( '\\n' ).replace( /\\t/g, '  ' );\n\t\t\tcontextDown = this.lines.slice( lineNum, lineNum + this.options.contextLines ).join( '\\n' ).replace( /\\t/g, '  ' );\n\t\t\tif ( contextUp ) {\n\t\t\t\tcontextUp += '\\n';\n\t\t\t}\n\t\t\tif ( contextDown ) {\n\t\t\t\tcontextDown = '\\n' + contextDown;\n\t\t\t}\n\t\t}\n\n\t\tlet numTabs = 0;\n\t\tconst annotation = contextUp + line.replace( /\\t/g, ( match, char ) => {\n\t\t\tif ( char < columnNum ) {\n\t\t\t\tnumTabs += 1;\n\t\t\t}\n\n\t\t\treturn '  ';\n\t\t}) + '\\n' + new Array( columnNum + numTabs ).join( ' ' ) + '^----' + contextDown;\n\n\t\treturn [ lineNum, columnNum, `${message} at line ${lineNum} character ${columnNum}:\\n${annotation}` ];\n\t},\n\n\tgetLinePos ( char ) {\n\t\tlet lineNum = 0;\n\t\tlet lineStart = 0;\n\n\t\twhile ( char >= this.lineEnds[ lineNum ] ) {\n\t\t\tlineStart = this.lineEnds[ lineNum ];\n\t\t\tlineNum += 1;\n\t\t}\n\n\t\tconst columnNum = char - lineStart;\n\t\treturn [ lineNum + 1, columnNum + 1, char ]; // line/col should be one-based, not zero-based!\n\t},\n\n\terror ( message ) {\n\t\tconst [ lineNum, columnNum, msg ] = this.getContextMessage( this.pos, message );\n\n\t\tconst error = new ParseError( msg );\n\n\t\terror.line = lineNum;\n\t\terror.character = columnNum;\n\t\terror.shortMessage = message;\n\n\t\tthrow error;\n\t},\n\n\tmatchString ( string ) {\n\t\tif ( this.str.substr( this.pos, string.length ) === string ) {\n\t\t\tthis.pos += string.length;\n\t\t\treturn string;\n\t\t}\n\t},\n\n\tmatchPattern ( pattern ) {\n\t\tlet match;\n\n\t\tif ( match = pattern.exec( this.remaining() ) ) {\n\t\t\tthis.pos += match[0].length;\n\t\t\treturn match[1] || match[0];\n\t\t}\n\t},\n\n\tallowWhitespace () {\n\t\tthis.matchPattern( leadingWhitespace );\n\t},\n\n\tremaining () {\n\t\treturn this.str.substring( this.pos );\n\t},\n\n\tnextChar () {\n\t\treturn this.str.charAt( this.pos );\n\t},\n\n\twarn ( message ) {\n\t\tconst msg = this.getContextMessage( this.pos, message )[2];\n\n\t\twarnIfDebug( msg );\n\t}\n};\n\nParser.extend = function ( proto ) {\n\tconst Parent = this;\n\tconst Child = function ( str, options ) {\n\t\tParser.call( this, str, options );\n\t};\n\n\tChild.prototype = Object.create( Parent.prototype );\n\n\tfor ( const key in proto ) {\n\t\tif ( proto.hasOwnProperty( key ) ) {\n\t\t\tChild.prototype[ key ] = proto[ key ];\n\t\t}\n\t}\n\n\tChild.extend = Parser.extend;\n\treturn Child;\n};\n\nexport default Parser;\n","// Match one or more characters until: \", ', \\, or EOL/EOF.\n// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\nconst stringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n// Match one escape sequence, including the backslash.\nexport const escapeSequencePattern = /^\\\\(?:[`'\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n// Match one ES5 line continuation (backslash + line terminator).\nexport const lineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n// Helper for defining getDoubleQuotedString and getSingleQuotedString.\nexport default function ( okQuote ) {\n\treturn function ( parser ) {\n\t\tlet literal = '\"';\n\t\tlet done = false;\n\t\tlet next;\n\n\t\twhile ( !done ) {\n\t\t\tnext = ( parser.matchPattern( stringMiddlePattern ) || parser.matchPattern( escapeSequencePattern ) ||\n\t\t\t\tparser.matchString( okQuote ) );\n\t\t\tif ( next ) {\n\t\t\t\tif ( next === `\"` ) {\n\t\t\t\t\tliteral += `\\\\\"`;\n\t\t\t\t} else if ( next === `\\\\'` ) {\n\t\t\t\t\tliteral += `'`;\n\t\t\t\t} else {\n\t\t\t\t\tliteral += next;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnext = parser.matchPattern( lineContinuationPattern );\n\t\t\t\tif ( next ) {\n\t\t\t\t\t// convert \\(newline-like) into a \\u escape, which is allowed in JSON\n\t\t\t\t\tliteral += '\\\\u' + ( '000' + next.charCodeAt(1).toString(16) ).slice( -4 );\n\t\t\t\t} else {\n\t\t\t\t\tdone = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tliteral += '\"';\n\n\t\t// use JSON.parse to interpret escapes\n\t\treturn JSON.parse( literal );\n\t};\n}\n","import { STRING_LITERAL } from '../../../../../config/types';\nimport makeQuotedStringMatcher from './stringLiteral/makeQuotedStringMatcher';\n\nconst singleMatcher = makeQuotedStringMatcher( `\"` );\nconst doubleMatcher = makeQuotedStringMatcher( `'` );\n\nexport default function ( parser ) {\n\tconst start = parser.pos;\n\tconst quote = parser.matchString( `'` ) || parser.matchString( `\"` );\n\n\tif ( quote ) {\n\t\tconst string = ( quote === `'` ? singleMatcher : doubleMatcher )( parser );\n\n\t\tif ( !parser.matchString( quote ) ) {\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tt: STRING_LITERAL,\n\t\t\tv: string\n\t\t};\n\t}\n\n\treturn null;\n}\n","import { NUMBER_LITERAL } from '../../../../../config/types';\n\n// bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\nconst numberPattern = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\nexport default function readNumberLiteral ( parser ) {\n\tlet result;\n\n\tif ( result = parser.matchPattern( numberPattern ) ) {\n\t\treturn {\n\t\t\tt: NUMBER_LITERAL,\n\t\t\tv: result\n\t\t};\n\t}\n\n\treturn null;\n}\n","export const name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\nexport const spreadPattern = /^\\s*\\.{3}/;\nexport const legalReference = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:\\.(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nexport const relaxedName = /^[a-zA-Z_$][-\\/a-zA-Z_$0-9]*(?:\\.(?:[a-zA-Z_$][-\\/a-zA-Z_$0-9]*))*/;\n","import readStringLiteral from '../primary/literal/readStringLiteral';\nimport readNumberLiteral from '../primary/literal/readNumberLiteral';\nimport { name as namePattern } from './patterns';\n\nconst identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n// http://mathiasbynens.be/notes/javascript-properties\n// can be any name, string literal, or number literal\nexport default function readKey ( parser ) {\n\tlet token;\n\n\tif ( token = readStringLiteral( parser ) ) {\n\t\treturn identifier.test( token.v ) ? token.v : '\"' + token.v.replace( /\"/g, '\\\\\"' ) + '\"';\n\t}\n\n\tif ( token = readNumberLiteral( parser ) ) {\n\t\treturn token.v;\n\t}\n\n\tif ( token = parser.matchPattern( namePattern ) ) {\n\t\treturn token;\n\t}\n\n\treturn null;\n}\n","import Parser from '../parse/Parser';\nimport readStringLiteral from '../parse/converters/expressions/primary/literal/readStringLiteral';\nimport readKey from '../parse/converters/expressions/shared/readKey';\n\n// simple JSON parser, without the restrictions of JSON parse\n// (i.e. having to double-quote keys).\n//\n// If passed a hash of values as the second argument, ${placeholders}\n// will be replaced with those values\n\nconst specials = {\n\ttrue: true,\n\tfalse: false,\n\tnull: null,\n\tundefined\n};\n\nconst specialsPattern = new RegExp( '^(?:' + Object.keys( specials ).join( '|' ) + ')' );\nconst numberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\nconst placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\nconst placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\nconst onlyWhitespace = /^\\s*$/;\n\nconst JsonParser = Parser.extend({\n\tinit ( str, options ) {\n\t\tthis.values = options.values;\n\t\tthis.allowWhitespace();\n\t},\n\n\tpostProcess ( result ) {\n\t\tif ( result.length !== 1 || !onlyWhitespace.test( this.leftover ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn { value: result[0].v };\n\t},\n\n\tconverters: [\n\t\tfunction getPlaceholder ( parser ) {\n\t\t\tif ( !parser.values ) return null;\n\n\t\t\tconst placeholder = parser.matchPattern( placeholderAtStartPattern );\n\n\t\t\tif ( placeholder && ( parser.values.hasOwnProperty( placeholder ) ) ) {\n\t\t\t\treturn { v: parser.values[ placeholder ] };\n\t\t\t}\n\t\t},\n\n\t\tfunction getSpecial ( parser ) {\n\t\t\tconst special = parser.matchPattern( specialsPattern );\n\t\t\tif ( special ) return { v: specials[ special ] };\n\t\t},\n\n\t\tfunction getNumber ( parser ) {\n\t\t\tconst number = parser.matchPattern( numberPattern );\n\t\t\tif ( number ) return { v: +number };\n\t\t},\n\n\t\tfunction getString ( parser ) {\n\t\t\tconst stringLiteral = readStringLiteral( parser );\n\t\t\tconst values = parser.values;\n\n\t\t\tif ( stringLiteral && values ) {\n\t\t\t\treturn {\n\t\t\t\t\tv: stringLiteral.v.replace( placeholderPattern, ( match, $1 ) => ( $1 in values ? values[ $1 ] : $1 ) )\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn stringLiteral;\n\t\t},\n\n\t\tfunction getObject ( parser ) {\n\t\t\tif ( !parser.matchString( '{' ) ) return null;\n\n\t\t\tconst result = {};\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( parser.matchString( '}' ) ) {\n\t\t\t\treturn { v: result };\n\t\t\t}\n\n\t\t\tlet pair;\n\t\t\twhile ( pair = getKeyValuePair( parser ) ) {\n\t\t\t\tresult[ pair.key ] = pair.value;\n\n\t\t\t\tparser.allowWhitespace();\n\n\t\t\t\tif ( parser.matchString( '}' ) ) {\n\t\t\t\t\treturn { v: result };\n\t\t\t\t}\n\n\t\t\t\tif ( !parser.matchString( ',' ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tfunction getArray ( parser ) {\n\t\t\tif ( !parser.matchString( '[' ) ) return null;\n\n\t\t\tconst result = [];\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( parser.matchString( ']' ) ) {\n\t\t\t\treturn { v: result };\n\t\t\t}\n\n\t\t\tlet valueToken;\n\t\t\twhile ( valueToken = parser.read() ) {\n\t\t\t\tresult.push( valueToken.v );\n\n\t\t\t\tparser.allowWhitespace();\n\n\t\t\t\tif ( parser.matchString( ']' ) ) {\n\t\t\t\t\treturn { v: result };\n\t\t\t\t}\n\n\t\t\t\tif ( !parser.matchString( ',' ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tparser.allowWhitespace();\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\t]\n});\n\nfunction getKeyValuePair ( parser ) {\n\tparser.allowWhitespace();\n\n\tconst key = readKey( parser );\n\n\tif ( !key ) return null;\n\n\tconst pair = { key };\n\n\tparser.allowWhitespace();\n\tif ( !parser.matchString( ':' ) ) {\n\t\treturn null;\n\t}\n\tparser.allowWhitespace();\n\n\tconst valueToken = parser.read();\n\n\tif ( !valueToken ) return null;\n\n\tpair.value = valueToken.v;\n\treturn pair;\n}\n\nexport default function ( str, values ) {\n\tconst parser = new JsonParser( str, { values });\n\treturn parser.result;\n}\n","import { INTERPOLATOR } from '../../../config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport parseJSON from '../../../utils/parseJSON';\nimport resolve from '../../resolvers/resolve';\nimport runloop from '../../../global/runloop';\nimport { warnIfDebug } from '../../../utils/log';\nimport { splitKeypath } from '../../../shared/keypaths';\n\nexport default class Mapping extends Item {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.name = options.template.n;\n\n\t\tthis.owner = options.owner || options.parentFragment.owner || options.element || findElement( options.parentFragment );\n\t\tthis.element = options.element || (this.owner.attributeByName ? this.owner : findElement( options.parentFragment ) );\n\t\tthis.parentFragment = this.element.parentFragment; // shared\n\t\tthis.ractive = this.parentFragment.ractive;\n\n\t\tthis.element.attributeByName[ this.name ] = this;\n\n\t\tthis.value = options.template.f;\n\t}\n\n\tbind () {\n\t\tconst template = this.template.f;\n\t\tconst viewmodel = this.element.instance.viewmodel;\n\n\t\tif ( template === 0 ) {\n\t\t\t// empty attributes are `true`\n\t\t\tviewmodel.joinKey( this.name ).set( true );\n\t\t}\n\n\t\telse if ( typeof template === 'string' ) {\n\t\t\tconst parsed = parseJSON( template );\n\t\t\tviewmodel.joinKey( this.name ).set( parsed ? parsed.value : template );\n\t\t}\n\n\t\telse if ( Array.isArray( template ) ) {\n\t\t\tcreateMapping( this, true );\n\t\t}\n\t}\n\n\trender () {}\n\n\tunbind () {\n\t\tif ( this.model ) this.model.unregister( this );\n\t\tif ( this.boundFragment ) this.boundFragment.unbind();\n\n\t\tif ( this.element.bound ) {\n\t\t\tif ( this.link.target === this.model ) this.link.owner.unlink();\n\t\t}\n\t}\n\n\tunrender () {}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tif ( this.boundFragment ) this.boundFragment.update();\n\t\t}\n\t}\n}\n\nfunction createMapping ( item ) {\n\tconst template = item.template.f;\n\tconst viewmodel = item.element.instance.viewmodel;\n\tconst childData = viewmodel.value;\n\n\tif ( template.length === 1 && template[0].t === INTERPOLATOR ) {\n\t\tconst model = resolve( item.parentFragment, template[0] );\n\t\tconst val = model.get( false );\n\n\t\t// if the interpolator is not static\n\t\tif ( !template[0].s ) {\n\t\t\titem.model = model;\n\t\t\titem.link = viewmodel.createLink( item.name, model, template[0].r );\n\n\t\t\t// initialize parent side of the mapping from child data\n\t\t\tif ( val === undefined && !model.isReadonly && item.name in childData ) {\n\t\t\t\tmodel.set( childData[ item.name ] );\n\t\t\t}\n\t\t}\n\n\t\t// copy non-object, non-computed vals through\n\t\telse if ( typeof val !== 'object' || template[0].x ) {\n\t\t\tviewmodel.joinKey( splitKeypath( item.name ) ).set( val );\n\t\t}\n\n\t\t// warn about trying to copy an object\n\t\telse {\n\t\t\twarnIfDebug( `Cannot copy non-computed object value from static mapping '${item.name}'` );\n\t\t}\n\t}\n\n\telse {\n\t\titem.boundFragment = new Fragment({\n\t\t\towner: item,\n\t\t\ttemplate\n\t\t}).bind();\n\n\t\titem.model = viewmodel.joinKey( splitKeypath( item.name ) );\n\t\titem.model.set( item.boundFragment.valueOf() );\n\n\t\t// item is a *bit* of a hack\n\t\titem.boundFragment.bubble = () => {\n\t\t\tFragment.prototype.bubble.call( item.boundFragment );\n\t\t\t// defer this to avoid mucking around model deps if there happens to be an expression involved\n\t\t\trunloop.scheduleTask(() => {\n\t\t\t\titem.boundFragment.update();\n\t\t\t\titem.model.set( item.boundFragment.valueOf() );\n\t\t\t});\n\t\t};\n\t}\n}\n","import Element from '../../Element';\nimport { removeFromArray } from '../../../../utils/array';\nimport findElement from '../../shared/findElement';\n\nexport default class Option extends Element {\n\tconstructor ( options ) {\n\t\tconst template = options.template;\n\t\tif ( !template.a ) template.a = {};\n\n\t\t// If the value attribute is missing, use the element's content,\n\t\t// as long as it isn't disabled\n\t\tif ( template.a.value === undefined && !( 'disabled' in template.a ) ) {\n\t\t\ttemplate.a.value = template.f || '';\n\t\t}\n\n\t\tsuper( options );\n\n\t\tthis.select = findElement( this.parent || this.parentFragment, false, 'select' );\n\t}\n\n\tbind () {\n\t\tif ( !this.select ) {\n\t\t\tsuper.bind();\n\t\t\treturn;\n\t\t}\n\n\t\t// If the select has a value, it overrides the `selected` attribute on\n\t\t// this option - so we delete the attribute\n\t\tconst selectedAttribute = this.attributeByName.selected;\n\t\tif ( selectedAttribute && this.select.getAttribute( 'value' ) !== undefined ) {\n\t\t\tconst index = this.attributes.indexOf( selectedAttribute );\n\t\t\tthis.attributes.splice( index, 1 );\n\t\t\tdelete this.attributeByName.selected;\n\t\t}\n\n\t\tsuper.bind();\n\t\tthis.select.options.push( this );\n\t}\n\n\tbubble () {\n\t\t// if we're using content as value, may need to update here\n\t\tconst value = this.getAttribute( 'value' );\n\t\tif ( this.node && this.node.value !== value ) {\n\t\t\tthis.node._ractive.value = value;\n\t\t}\n\t\tsuper.bubble();\n\t}\n\n\tgetAttribute ( name ) {\n\t\tconst attribute = this.attributeByName[ name ];\n\t\treturn attribute ? attribute.getValue() : name === 'value' && this.fragment ? this.fragment.valueOf() : undefined;\n\t}\n\n\tisSelected () {\n\t\tconst optionValue = this.getAttribute( 'value' );\n\n\t\tif ( optionValue === undefined || !this.select ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst selectValue = this.select.getAttribute( 'value' );\n\n\t\tif ( this.select.compare( selectValue, optionValue ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( this.select.getAttribute( 'multiple' ) && Array.isArray( selectValue ) ) {\n\t\t\tlet i = selectValue.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( this.select.compare( selectValue[i], optionValue ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trender ( target, occupants ) {\n\t\tsuper.render( target, occupants );\n\n\t\tif ( !this.attributeByName.value ) {\n\t\t\tthis.node._ractive.value = this.getAttribute( 'value' );\n\t\t}\n\t}\n\n\tunbind () {\n\t\tsuper.unbind();\n\n\t\tif ( this.select ) {\n\t\t\tremoveFromArray( this.select.options, this );\n\t\t}\n\t}\n}\n","import { SECTION, SECTION_WITH, YIELDER } from '../../config/types';\nimport { warnOnceIfDebug, warnIfDebug } from '../../utils/log';\nimport { MustacheContainer } from './shared/Mustache';\nimport Fragment from '../Fragment';\nimport getPartialTemplate from './partial/getPartialTemplate';\nimport parser from '../../Ractive/config/runtime-parser';\nimport { doInAttributes } from './element/ConditionalAttribute';\nimport { resolveAliases } from './Alias';\n\nexport default class Partial extends MustacheContainer {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.yielder = options.template.t === YIELDER;\n\n\t\tif ( this.yielder ) {\n\t\t\tthis.container = options.parentFragment.ractive;\n\t\t\tthis.component = this.container.component;\n\n\t\t\tthis.containerFragment = options.parentFragment;\n\t\t\tthis.parentFragment = this.component.parentFragment;\n\n\t\t\t// {{yield}} is equivalent to {{yield content}}\n\t\t\tif ( !options.template.r && !options.template.rx && !options.template.x ) options.template.r = 'content';\n\t\t}\n\t}\n\n\tbind () {\n\t\t// keep track of the reference name for future resets\n\t\tthis.refName = this.template.r;\n\n\t\t// name matches take priority over expressions\n\t\tconst template = this.refName ? getPartialTemplate( this.ractive, this.refName, this.parentFragment ) || null : null;\n\t\tlet templateObj;\n\n\t\tif ( template ) {\n\t\t\tthis.named = true;\n\t\t\tthis.setTemplate( this.template.r, template );\n\t\t}\n\n\t\tif ( !template ) {\n\t\t\tsuper.bind();\n\t\t\tif ( ( templateObj = this.model.get() ) && typeof templateObj === 'object' && ( typeof templateObj.template === 'string' || Array.isArray( templateObj.t ) ) ) {\n\t\t\t\tif ( templateObj.template ) {\n\t\t\t\t\tthis.source = templateObj.template;\n\t\t\t\t\ttemplateObj = parsePartial( this.template.r, templateObj.template, this.ractive );\n\t\t\t\t} else {\n\t\t\t\t\tthis.source = templateObj.t;\n\t\t\t\t}\n\t\t\t\tthis.setTemplate( this.template.r, templateObj.t );\n\t\t\t} else if ( typeof this.model.get() !== 'string' && this.refName ) {\n\t\t\t\tthis.setTemplate( this.refName, template );\n\t\t\t} else {\n\t\t\t\tthis.setTemplate( this.model.get() );\n\t\t\t}\n\t\t}\n\n\t\tconst options = {\n\t\t\towner: this,\n\t\t\ttemplate: this.partialTemplate\n\t\t};\n\n\t\tif ( this.template.c ) {\n\t\t\toptions.template = [{ t: SECTION, n: SECTION_WITH, f: options.template }];\n\t\t\tfor ( const k in this.template.c ) {\n\t\t\t\toptions.template[0][k] = this.template.c[k];\n\t\t\t}\n\t\t}\n\n\t\tif ( this.yielder ) {\n\t\t\toptions.ractive = this.container.parent;\n\t\t}\n\n\t\tthis.fragment = new Fragment(options);\n\t\tif ( this.template.z ) {\n\t\t\tthis.fragment.aliases = resolveAliases( this.template.z, this.yielder ? this.containerFragment : this.parentFragment );\n\t\t}\n\t\tthis.fragment.bind();\n\t}\n\n\tbubble () {\n\t\tif ( this.yielder && !this.dirty ) {\n\t\t\tthis.containerFragment.bubble();\n\t\t\tthis.dirty = true;\n\t\t} else {\n\t\t\tsuper.bubble();\n\t\t}\n\t}\n\n\tfindNextNode() {\n\t\treturn this.yielder ? this.containerFragment.findNextNode( this ) : super.findNextNode();\n\t}\n\n\tforceResetTemplate () {\n\t\tthis.partialTemplate = undefined;\n\n\t\t// on reset, check for the reference name first\n\t\tif ( this.refName ) {\n\t\t\tthis.partialTemplate = getPartialTemplate( this.ractive, this.refName, this.parentFragment );\n\t\t}\n\n\t\t// then look for the resolved name\n\t\tif ( !this.partialTemplate ) {\n\t\t\tthis.partialTemplate = getPartialTemplate( this.ractive, this.name, this.parentFragment );\n\t\t}\n\n\t\tif ( !this.partialTemplate ) {\n\t\t\twarnOnceIfDebug( `Could not find template for partial '${this.name}'` );\n\t\t\tthis.partialTemplate = [];\n\t\t}\n\n\t\tif ( this.inAttribute ) {\n\t\t\tdoInAttributes( () => this.fragment.resetTemplate( this.partialTemplate ) );\n\t\t} else {\n\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\t}\n\n\t\tthis.bubble();\n\t}\n\n\trender ( target, occupants ) {\n\t\treturn this.fragment.render( target, occupants );\n\t}\n\n\tsetTemplate ( name, template ) {\n\t\tthis.name = name;\n\n\t\tif ( !template && template !== null ) template = getPartialTemplate( this.ractive, name, this.parentFragment );\n\n\t\tif ( !template ) {\n\t\t\twarnOnceIfDebug( `Could not find template for partial '${name}'` );\n\t\t}\n\n\t\tthis.partialTemplate = template || [];\n\t}\n\n\tunbind () {\n\t\tsuper.unbind();\n\t\tthis.fragment.aliases = {};\n\t\tthis.fragment.unbind();\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tthis.fragment.unrender( shouldDestroy );\n\t}\n\n\tupdate () {\n\t\tlet template;\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tif ( !this.named ) {\n\t\t\t\tif ( this.model ) {\n\t\t\t\t\ttemplate = this.model.get();\n\t\t\t\t}\n\n\t\t\t\tif ( template && typeof template === 'string' && template !== this.name ) {\n\t\t\t\t\tthis.setTemplate( template );\n\t\t\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\t\t\t} else if ( template && typeof template === 'object' && ( typeof template.template === 'string' || Array.isArray( template.t ) ) ) {\n\t\t\t\t\tif ( template.t !== this.source && template.template !== this.source ) {\n\t\t\t\t\t\tif ( template.template ) {\n\t\t\t\t\t\t\tthis.source = template.template;\n\t\t\t\t\t\t\ttemplate = parsePartial( this.name, template.template, this.ractive );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.source = template.t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setTemplate( this.name, template.t );\n\t\t\t\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.fragment.update();\n\t\t}\n\t}\n}\n\nfunction parsePartial( name, partial, ractive ) {\n\tlet parsed;\n\n\ttry {\n\t\tparsed = parser.parse( partial, parser.getParseOptions( ractive ) );\n\t} catch (e) {\n\t\twarnIfDebug( `Could not parse partial from expression '${name}'\\n${e.message}` );\n\t}\n\n\treturn parsed || { t: [] };\n}\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { capture, startCapturing, stopCapturing } from '../global/capture';\nimport { warnIfDebug } from '../utils/log';\nimport Model from './Model';\nimport { maybeBind } from './ModelBase';\nimport ComputationChild from './ComputationChild';\nimport { hasConsole } from '../config/environment';\nimport { isEqual } from '../utils/is';\n\nexport default class Computation extends Model {\n\tconstructor ( viewmodel, signature, key ) {\n\t\tsuper( null, null );\n\n\t\tthis.root = this.parent = viewmodel;\n\t\tthis.signature = signature;\n\n\t\tthis.key = key; // not actually used, but helps with debugging\n\t\tthis.isExpression = key && key[0] === '@';\n\n\t\tthis.isReadonly = !this.signature.setter;\n\n\t\tthis.context = viewmodel.computationContext;\n\n\t\tthis.dependencies = [];\n\n\t\tthis.children = [];\n\t\tthis.childByKey = {};\n\n\t\tthis.deps = [];\n\n\t\tthis.dirty = true;\n\n\t\t// TODO: is there a less hackish way to do this?\n\t\tthis.shuffle = undefined;\n\t}\n\n\tget setRoot () {\n\t\tif ( this.signature.setter ) return this;\n\t}\n\n\tget ( shouldCapture ) {\n\t\tif ( shouldCapture ) capture( this );\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tconst old = this.value;\n\t\t\tthis.value = this.getValue();\n\t\t\tif ( !isEqual( old, this.value ) ) this.notifyUpstream();\n\t\t\tif ( this.wrapper ) this.newWrapperValue = this.value;\n\t\t\tthis.adapt();\n\t\t}\n\n\t\t// if capturing, this value needs to be unwrapped because it's for external use\n\t\treturn maybeBind( this, shouldCapture && this.wrapper ? this.wrapperValue : this.value );\n\t}\n\n\tgetValue () {\n\t\tstartCapturing();\n\t\tlet result;\n\n\t\ttry {\n\t\t\tresult = this.signature.getter.call( this.context );\n\t\t} catch ( err ) {\n\t\t\twarnIfDebug( `Failed to compute ${this.getKeypath()}: ${err.message || err}` );\n\n\t\t\t// TODO this is all well and good in Chrome, but...\n\t\t\t// ...also, should encapsulate this stuff better, and only\n\t\t\t// show it if Ractive.DEBUG\n\t\t\tif ( hasConsole ) {\n\t\t\t\tif ( console.groupCollapsed ) console.groupCollapsed( '%cshow details', 'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;' );\n\t\t\t\tconst sig = this.signature;\n\t\t\t\tconsole.error( `${err.name}: ${err.message}\\n\\n${sig.getterString}${sig.getterUseStack ? '\\n\\n' + err.stack : ''}` );\n\t\t\t\tif ( console.groupCollapsed ) console.groupEnd();\n\t\t\t}\n\t\t}\n\n\t\tconst dependencies = stopCapturing();\n\t\tthis.setDependencies( dependencies );\n\n\t\treturn result;\n\t}\n\n\tmark () {\n\t\tthis.handleChange();\n\t}\n\n\trebind ( next, previous ) {\n\t\t// computations will grab all of their deps again automagically\n\t\tif ( next !== previous ) this.handleChange();\n\t}\n\n\tset ( value ) {\n\t\tif ( this.isReadonly ) {\n\t\t\tthrow new Error( `Cannot set read-only computed value '${this.key}'` );\n\t\t}\n\n\t\tthis.signature.setter( value );\n\t\tthis.mark();\n\t}\n\n\tsetDependencies ( dependencies ) {\n\t\t// unregister any soft dependencies we no longer have\n\t\tlet i = this.dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tconst model = this.dependencies[i];\n\t\t\tif ( !~dependencies.indexOf( model ) ) model.unregister( this );\n\t\t}\n\n\t\t// and add any new ones\n\t\ti = dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tconst model = dependencies[i];\n\t\t\tif ( !~this.dependencies.indexOf( model ) ) model.register( this );\n\t\t}\n\n\t\tthis.dependencies = dependencies;\n\t}\n\n\tteardown () {\n\t\tlet i = this.dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( this.dependencies[i] ) this.dependencies[i].unregister( this );\n\t\t}\n\t\tif ( this.root.computations[this.key] === this ) delete this.root.computations[this.key];\n\t\tsuper.teardown();\n\t}\n}\n\nconst prototype = Computation.prototype;\nconst child = ComputationChild.prototype;\nprototype.handleChange = child.handleChange;\nprototype.joinKey = child.joinKey;\n","import Model from '../../model/Model';\nimport Computation from '../../model/Computation';\nimport getFunction from '../../shared/getFunction';\nimport resolveReference from './resolveReference';\nimport { removeFromArray } from '../../utils/array';\nimport { startCapturing, stopCapturing } from '../../global/capture';\nimport { warnIfDebug } from '../../utils/log';\nimport { rebindMatch } from '../../shared/rebind';\nimport noop from '../../utils/noop';\n\nexport default class ExpressionProxy extends Model {\n\tconstructor ( fragment, template ) {\n\t\tsuper( fragment.ractive.viewmodel, null );\n\n\t\tthis.fragment = fragment;\n\t\tthis.template = template;\n\n\t\tthis.isReadonly = true;\n\t\tthis.dirty = true;\n\n\t\tthis.fn = getFunction( template.s, template.r.length );\n\n\t\tthis.models = this.template.r.map( ref => {\n\t\t\treturn resolveReference( this.fragment, ref );\n\t\t});\n\t\tthis.dependencies = [];\n\n\t\tthis.shuffle = undefined;\n\n\t\tthis.bubble();\n\t}\n\n\tbubble ( actuallyChanged = true ) {\n\t\t// refresh the keypath\n\t\tthis.keypath = undefined;\n\n\t\tif ( actuallyChanged ) {\n\t\t\tthis.handleChange();\n\t\t}\n\t}\n\n\tgetKeypath () {\n\t\tif ( !this.template ) return '@undefined';\n\t\tif ( !this.keypath ) {\n\t\t\tthis.keypath = '@' + this.template.s.replace( /_(\\d+)/g, ( match, i ) => {\n\t\t\t\tif ( i >= this.models.length ) return match;\n\n\t\t\t\tconst model = this.models[i];\n\t\t\t\treturn model ? model.getKeypath() : '@undefined';\n\t\t\t});\n\t\t}\n\n\t\treturn this.keypath;\n\t}\n\n\tgetValue () {\n\t\tstartCapturing();\n\t\tlet result;\n\n\t\ttry {\n\t\t\tconst params = this.models.map( m => m ? m.get( true ) : undefined );\n\t\t\tresult = this.fn.apply( this.fragment.ractive, params );\n\t\t} catch ( err ) {\n\t\t\twarnIfDebug( `Failed to compute ${this.getKeypath()}: ${err.message || err}` );\n\t\t}\n\n\t\tconst dependencies = stopCapturing();\n\t\t// remove missing deps\n\t\tthis.dependencies.filter( d => !~dependencies.indexOf( d ) ).forEach( d => {\n\t\t\td.unregister( this );\n\t\t\tremoveFromArray( this.dependencies, d );\n\t\t});\n\t\t// register new deps\n\t\tdependencies.filter( d => !~this.dependencies.indexOf( d ) ).forEach( d => {\n\t\t\td.register( this );\n\t\t\tthis.dependencies.push( d );\n\t\t});\n\n\t\treturn result;\n\t}\n\n\trebind ( next, previous, safe ) {\n\t\tconst idx = this.models.indexOf( previous );\n\n\t\tif ( ~idx ) {\n\t\t\tnext = rebindMatch( this.template.r[idx], next, previous );\n\t\t\tif ( next !== previous ) {\n\t\t\t\tprevious.unregister( this );\n\t\t\t\tthis.models.splice( idx, 1, next );\n\t\t\t\tif ( next ) next.addShuffleRegister( this, 'mark' );\n\t\t\t}\n\t\t}\n\t\tthis.bubble( !safe );\n\t}\n\n\tretrieve () {\n\t\treturn this.get();\n\t}\n\n\tteardown () {\n\t\tthis.unbind();\n\t\tthis.fragment = undefined;\n\t\tif ( this.dependencies ) this.dependencies.forEach( d => d.unregister( this ) );\n\t\tsuper.teardown();\n\t}\n\n\tunreference () {\n\t\tsuper.unreference();\n\t\tif ( !this.deps.length && !this.refs ) this.teardown();\n\t}\n\n\tunregister( dep ) {\n\t\tsuper.unregister( dep );\n\t\tif ( !this.deps.length && !this.refs ) this.teardown();\n\t}\n}\n\nconst prototype = ExpressionProxy.prototype;\nconst computation = Computation.prototype;\nprototype.get = computation.get;\nprototype.handleChange = computation.handleChange;\nprototype.joinKey = computation.joinKey;\nprototype.mark = computation.mark;\nprototype.unbind = noop;\n","import Model from '../../model/Model';\nimport { findBoundValue } from '../../model/ModelBase';\nimport { REFERENCE } from '../../config/types';\nimport ExpressionProxy from './ExpressionProxy';\nimport resolveReference from './resolveReference';\nimport resolve from './resolve';\nimport { rebindMatch } from '../../shared/rebind';\nimport { handleChange, mark, marked } from '../../shared/methodCallers';\nimport { isEqual } from '../../utils/is';\nimport { escapeKey } from '../../shared/keypaths';\nimport noop from '../../utils/noop';\n\nclass ReferenceExpressionChild extends Model {\n\tconstructor ( parent, key ) {\n\t\tsuper ( parent, key );\n\t}\n\n\tapplyValue ( value ) {\n\t\tif ( isEqual( value, this.value ) ) return;\n\n\t\tlet parent = this.parent;\n\t\tconst keys = [ this.key ];\n\t\twhile ( parent ) {\n\t\t\tif ( parent.base ) {\n\t\t\t\tconst target = parent.model.joinAll( keys );\n\t\t\t\ttarget.applyValue( value );\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tkeys.unshift( parent.key );\n\n\t\t\tparent = parent.parent;\n\t\t}\n\t}\n\n\tget ( shouldCapture, opts ) {\n\t\tthis.value = this.retrieve();\n\t\treturn super.get( shouldCapture, opts );\n\t}\n\n\tjoinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) return this;\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tconst child = new ReferenceExpressionChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t}\n\n\tretrieve () {\n\t\tconst parent = this.parent.get();\n\t\treturn parent && parent[ this.key ];\n\t}\n}\n\nexport default class ReferenceExpressionProxy extends Model {\n\tconstructor ( fragment, template ) {\n\t\tsuper( null, null );\n\t\tthis.dirty = true;\n\t\tthis.root = fragment.ractive.viewmodel;\n\t\tthis.template = template;\n\n\t\tthis.base = resolve( fragment, template );\n\n\t\tconst intermediary = this.intermediary = {\n\t\t\thandleChange: () => this.handleChange(),\n\t\t\trebind: ( next, previous ) => {\n\t\t\t\tif ( previous === this.base ) {\n\t\t\t\t\tnext = rebindMatch( template, next, previous );\n\t\t\t\t\tif ( next !== this.base ) {\n\t\t\t\t\t\tthis.base.unregister( intermediary );\n\t\t\t\t\t\tthis.base = next;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst idx = this.members.indexOf( previous );\n\t\t\t\t\tif ( ~idx ) {\n\t\t\t\t\t\t// only direct references will rebind... expressions handle themselves\n\t\t\t\t\t\tnext = rebindMatch( template.m[idx].n, next, previous );\n\t\t\t\t\t\tif ( next !== this.members[idx] ) {\n\t\t\t\t\t\t\tthis.members.splice( idx, 1, next );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( next !== previous ) previous.unregister( intermediary );\n\t\t\t\tif ( next ) next.addShuffleTask( () => next.register( intermediary ) );\n\n\t\t\t\tthis.bubble();\n\t\t\t}\n\t\t};\n\n\t\tthis.members = template.m.map( ( template ) => {\n\t\t\tif ( typeof template === 'string' ) {\n\t\t\t\treturn { get: () => template };\n\t\t\t}\n\n\t\t\tlet model;\n\n\t\t\tif ( template.t === REFERENCE ) {\n\t\t\t\tmodel = resolveReference( fragment, template.n );\n\t\t\t\tmodel.register( intermediary );\n\n\t\t\t\treturn model;\n\t\t\t}\n\n\t\t\tmodel = new ExpressionProxy( fragment, template );\n\t\t\tmodel.register( intermediary );\n\t\t\treturn model;\n\t\t});\n\n\t\tthis.bubble();\n\t}\n\n\tbubble () {\n\t\tif ( !this.base ) return;\n\t\tif ( !this.dirty ) this.handleChange();\n\t}\n\n\tget ( shouldCapture ) {\n\t\tif ( this.dirty ) {\n\t\t\tthis.bubble();\n\n\t\t\tconst keys = this.members.map( m => escapeKey( String( m.get() ) ) );\n\t\t\tconst model = this.base.joinAll( keys );\n\n\t\t\tif ( model !== this.model ) {\n\t\t\t\tif ( this.model ) {\n\t\t\t\t\tthis.model.unregister( this );\n\t\t\t\t\tthis.model.unregisterTwowayBinding( this );\n\t\t\t\t}\n\n\t\t\t\tthis.model = model;\n\t\t\t\tthis.parent = model.parent;\n\t\t\t\tthis.model.register( this );\n\t\t\t\tthis.model.registerTwowayBinding( this );\n\n\t\t\t\tif ( this.keypathModel ) this.keypathModel.handleChange();\n\t\t\t}\n\n\t\t\tthis.value = this.model.get( shouldCapture );\n\t\t\tthis.dirty = false;\n\t\t\tthis.mark();\n\t\t\treturn this.value;\n\t\t} else {\n\t\t\treturn this.model ? this.model.get( shouldCapture ) : undefined;\n\t\t}\n\t}\n\n\t// indirect two-way bindings\n\tgetValue () {\n\t\tthis.value = this.model ? this.model.get() : undefined;\n\n\t\tlet i = this.bindings.length;\n\t\twhile ( i-- ) {\n\t\t\tconst value = this.bindings[i].getValue();\n\t\t\tif ( value !== this.value ) return value;\n\t\t}\n\n\t\t// check one-way bindings\n\t\tconst oneway = findBoundValue( this.deps );\n\t\tif ( oneway ) return oneway.value;\n\n\t\treturn this.value;\n\t}\n\n\tgetKeypath () {\n\t\treturn this.model ? this.model.getKeypath() : '@undefined';\n\t}\n\n\thandleChange () {\n\t\tthis.dirty = true;\n\t\tthis.mark();\n\t}\n\n\tjoinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) return this;\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tconst child = new ReferenceExpressionChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t}\n\n\tmark () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.deps.forEach( handleChange );\n\t\t}\n\n\t\tthis.links.forEach( marked );\n\t\tthis.children.forEach( mark );\n\t}\n\n\tretrieve () {\n\t\treturn this.value;\n\t}\n\n\tset ( value ) {\n\t\tthis.model.set( value );\n\t}\n\n\tteardown () {\n\t\tif ( this.model ) {\n\t\t\tthis.model.unregister( this );\n\t\t\tthis.model.unregisterTwowayBinding( this );\n\t\t}\n\t\tif ( this.members ) {\n\t\t\tthis.members.forEach( m => m && m.unregister && m.unregister( this ) );\n\t\t}\n\t}\n\n\tunreference () {\n\t\tsuper.unreference();\n\t\tif ( !this.deps.length && !this.refs ) this.teardown();\n\t}\n\n\tunregister( dep ) {\n\t\tsuper.unregister( dep );\n\t\tif ( !this.deps.length && !this.refs ) this.teardown();\n\t}\n}\n\nReferenceExpressionProxy.prototype.rebind = noop;\n","import Fragment from '../Fragment';\nimport { ContainerItem } from './shared/Item';\nimport resolve from '../resolvers/resolve';\n\nexport function resolveAliases( aliases, fragment ) {\n\tconst resolved = {};\n\n\tfor ( let i = 0; i < aliases.length; i++ ) {\n\t\tresolved[ aliases[i].n ] = resolve( fragment, aliases[i].x );\n\t}\n\n\tfor ( const k in resolved ) {\n\t\tresolved[k].reference();\n\t}\n\n\treturn resolved;\n}\n\nexport default class Alias extends ContainerItem {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.fragment = null;\n\t}\n\n\tbind () {\n\t\tthis.fragment = new Fragment({\n\t\t\towner: this,\n\t\t\ttemplate: this.template.f\n\t\t});\n\n\t\tthis.fragment.aliases = resolveAliases( this.template.z, this.parentFragment );\n\t\tthis.fragment.bind();\n\t}\n\n\trender ( target ) {\n\t\tthis.rendered = true;\n\t\tif ( this.fragment ) this.fragment.render( target );\n\t}\n\n\tunbind () {\n\t\tfor ( const k in this.fragment.aliases ) {\n\t\t\tthis.fragment.aliases[k].unreference();\n\t\t}\n\n\t\tthis.fragment.aliases = {};\n\t\tif ( this.fragment ) this.fragment.unbind();\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tif ( this.rendered && this.fragment ) this.fragment.unrender( shouldDestroy );\n\t\tthis.rendered = false;\n\t}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tthis.fragment.update();\n\t\t}\n\t}\n}\n","import cleanCss from '../../utils/cleanCss';\n\nconst space = /\\s+/;\n\nexport function readStyle ( css ) {\n\tif ( typeof css !== 'string' ) return {};\n\n\treturn cleanCss( css, ( css, reconstruct ) => {\n\t\treturn css.split( ';' )\n\t\t\t.filter( rule => !!rule.trim() )\n\t\t\t.map( reconstruct )\n\t\t\t.reduce(( rules, rule ) => {\n\t\t\t\tconst i = rule.indexOf(':');\n\t\t\t\tconst name = rule.substr( 0, i ).trim();\n\t\t\t\trules[ name ] = rule.substr( i + 1 ).trim();\n\t\t\t\treturn rules;\n\t\t\t}, {});\n\t});\n}\n\nexport function readClass ( str ) {\n\tconst list = str.split( space );\n\n  // remove any empty entries\n\tlet i = list.length;\n\twhile ( i-- ) {\n\t\tif ( !list[i] ) list.splice( i, 1 );\n\t}\n\n\treturn list;\n}\n","export default function ( camelCaseStr ) {\n\treturn camelCaseStr.replace( /([A-Z])/g, ( match, $1 ) => {\n\t\treturn '-' + $1.toLowerCase();\n\t});\n}\n","import { html } from '../../../../config/namespaces';\nimport { safeToStringValue} from '../../../../utils/dom';\nimport { arrayContains } from '../../../../utils/array';\nimport noop from '../../../../utils/noop';\nimport { readStyle, readClass } from '../../../helpers/specialAttrs';\nimport hyphenateCamel from '../../../../utils/hyphenateCamel';\n\nconst textTypes = [ undefined, 'text', 'search', 'url', 'email', 'hidden', 'password', 'search', 'reset', 'submit' ];\n\nexport default function getUpdateDelegate ( attribute ) {\n\tconst { element, name } = attribute;\n\n\tif ( name === 'value' ) {\n\t\tif ( attribute.interpolator ) attribute.interpolator.bound = true;\n\n\t\t// special case - selects\n\t\tif ( element.name === 'select' && name === 'value' ) {\n\t\t\treturn element.getAttribute( 'multiple' ) ? updateMultipleSelectValue : updateSelectValue;\n\t\t}\n\n\t\tif ( element.name === 'textarea' ) return updateStringValue;\n\n\t\t// special case - contenteditable\n\t\tif ( element.getAttribute( 'contenteditable' ) != null ) return updateContentEditableValue;\n\n\t\t// special case - <input>\n\t\tif ( element.name === 'input' ) {\n\t\t\tconst type = element.getAttribute( 'type' );\n\n\t\t\t// type='file' value='{{fileList}}'>\n\t\t\tif ( type === 'file' ) return noop; // read-only\n\n\t\t\t// type='radio' name='{{twoway}}'\n\t\t\tif ( type === 'radio' && element.binding && element.binding.attribute.name === 'name' ) return updateRadioValue;\n\n\t\t\tif ( ~textTypes.indexOf( type ) ) return updateStringValue;\n\t\t}\n\n\t\treturn updateValue;\n\t}\n\n\tconst node = element.node;\n\n\t// special case - <input type='radio' name='{{twoway}}' value='foo'>\n\tif ( attribute.isTwoway && name === 'name' ) {\n\t\tif ( node.type === 'radio' ) return updateRadioName;\n\t\tif ( node.type === 'checkbox' ) return updateCheckboxName;\n\t}\n\n\tif ( name === 'style' ) return updateStyleAttribute;\n\n\tif ( name.indexOf( 'style-' ) === 0 ) return updateInlineStyle;\n\n\t// special case - class names. IE fucks things up, again\n\tif ( name === 'class' && ( !node.namespaceURI || node.namespaceURI === html ) ) return updateClassName;\n\n\tif ( name.indexOf( 'class-' ) === 0 ) return updateInlineClass;\n\n\tif ( attribute.isBoolean ) {\n\t\tconst type = element.getAttribute( 'type' );\n\t\tif ( attribute.interpolator && name === 'checked' && ( type === 'checkbox' || type === 'radio' ) ) attribute.interpolator.bound = true;\n\t\treturn updateBoolean;\n\t}\n\n\tif ( attribute.namespace && attribute.namespace !== attribute.node.namespaceURI ) return updateNamespacedAttribute;\n\n\treturn updateAttribute;\n}\n\nfunction updateMultipleSelectValue ( reset ) {\n\tlet value = this.getValue();\n\n\tif ( !Array.isArray( value ) ) value = [ value ];\n\n\tconst options = this.node.options;\n\tlet i = options.length;\n\n\tif ( reset ) {\n\t\twhile ( i-- ) options[i].selected = false;\n\t} else {\n\t\twhile ( i-- ) {\n\t\t\tconst option = options[i];\n\t\t\tconst optionValue = option._ractive ?\n\t\t\t\toption._ractive.value :\n\t\t\t\toption.value; // options inserted via a triple don't have _ractive\n\n\t\t\toption.selected = arrayContains( value, optionValue );\n\t\t}\n\t}\n}\n\nfunction updateSelectValue ( reset ) {\n\tconst value = this.getValue();\n\n\tif ( !this.locked ) { // TODO is locked still a thing?\n\t\tthis.node._ractive.value = value;\n\n\t\tconst options = this.node.options;\n\t\tlet i = options.length;\n\t\tlet wasSelected = false;\n\n\t\tif ( reset ) {\n\t\t\twhile ( i-- ) options[i].selected = false;\n\t\t} else {\n\t\t\twhile ( i-- ) {\n\t\t\t\tconst option = options[i];\n\t\t\t\tconst optionValue = option._ractive ?\n\t\t\t\t\toption._ractive.value :\n\t\t\t\t\toption.value; // options inserted via a triple don't have _ractive\n\t\t\t\tif ( option.disabled && option.selected ) wasSelected = true;\n\n\t\t\t\tif ( optionValue == value ) { // double equals as we may be comparing numbers with strings\n\t\t\t\t\toption.selected = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( !wasSelected ) this.node.selectedIndex = -1;\n\t}\n}\n\n\nfunction updateContentEditableValue ( reset ) {\n\tconst value = this.getValue();\n\n\tif ( !this.locked ) {\n\t\tif ( reset ) this.node.innerHTML = '';\n\t\telse this.node.innerHTML = value === undefined ? '' : value;\n\t}\n}\n\nfunction updateRadioValue ( reset ) {\n\tconst node = this.node;\n\tconst wasChecked = node.checked;\n\n\tconst value = this.getValue();\n\n\tif ( reset ) return node.checked = false;\n\n\t//node.value = this.element.getAttribute( 'value' );\n\tnode.value = this.node._ractive.value = value;\n\tnode.checked = this.element.compare( value, this.element.getAttribute( 'name' ) );\n\n\t// This is a special case - if the input was checked, and the value\n\t// changed so that it's no longer checked, the twoway binding is\n\t// most likely out of date. To fix it we have to jump through some\n\t// hoops... this is a little kludgy but it works\n\tif ( wasChecked && !node.checked && this.element.binding && this.element.binding.rendered ) {\n\t\tthis.element.binding.group.model.set( this.element.binding.group.getValue() );\n\t}\n}\n\nfunction updateValue ( reset ) {\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tthis.node.removeAttribute( 'value' );\n\t\t\tthis.node.value = this.node._ractive.value = null;\n\t\t} else {\n\t\t\tconst value = this.getValue();\n\n\t\t\tthis.node.value = this.node._ractive.value = value;\n\t\t\tthis.node.setAttribute( 'value', safeToStringValue( value ) );\n\t\t}\n\t}\n}\n\nfunction updateStringValue ( reset ) {\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tthis.node._ractive.value = '';\n\t\t\tthis.node.removeAttribute( 'value' );\n\t\t} else {\n\t\t\tconst value = this.getValue();\n\n\t\t\tthis.node._ractive.value = value;\n\n\t\t\tthis.node.value = safeToStringValue( value );\n\t\t\tthis.node.setAttribute( 'value', safeToStringValue( value ) );\n\t\t}\n\t}\n}\n\nfunction updateRadioName ( reset ) {\n\tif ( reset ) this.node.checked = false;\n\telse this.node.checked = this.element.compare( this.getValue(), this.element.binding.getValue() );\n}\n\nfunction updateCheckboxName ( reset ) {\n\tconst { element, node } = this;\n\tconst binding = element.binding;\n\n\tconst value = this.getValue();\n\tconst valueAttribute = element.getAttribute( 'value' );\n\n\tif ( reset ) {\n\t\t// TODO: WAT?\n\t}\n\n\tif ( !Array.isArray( value ) ) {\n\t\tbinding.isChecked = node.checked = element.compare( value, valueAttribute );\n\t} else {\n\t\tlet i = value.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( element.compare ( valueAttribute, value[i] ) ) {\n\t\t\t\tbinding.isChecked = node.checked = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tbinding.isChecked = node.checked = false;\n\t}\n}\n\nfunction updateStyleAttribute ( reset ) {\n\tconst props = reset ? {} : readStyle( this.getValue() || '' );\n\tconst style = this.node.style;\n\tconst keys = Object.keys( props );\n\tconst prev = this.previous || [];\n\n\tlet i = 0;\n\twhile ( i < keys.length ) {\n\t\tif ( keys[i] in style ) {\n\t\t\tconst safe = props[ keys[i] ].replace( '!important', '' );\n\t\t\tstyle.setProperty( keys[i], safe, safe.length !== props[ keys[i] ].length ? 'important' : '' );\n\t\t}\n\t\ti++;\n\t}\n\n\t// remove now-missing attrs\n\ti = prev.length;\n\twhile ( i-- ) {\n\t\tif ( !~keys.indexOf( prev[i] ) && prev[i] in style ) style.setProperty( prev[i], '', '' );\n\t}\n\n\tthis.previous = keys;\n}\n\nfunction updateInlineStyle ( reset ) {\n\tif ( !this.style ) {\n\t\tthis.style = hyphenateCamel( this.name.substr( 6 ) );\n\t}\n\n\tconst value = reset ? '' : safeToStringValue( this.getValue() );\n\tconst safe = value.replace( '!important', '' );\n\tthis.node.style.setProperty( this.style, safe, safe.length !== value.length ? 'important' : '' );\n}\n\nfunction updateClassName ( reset ) {\n\tconst value = reset ? [] : readClass( safeToStringValue( this.getValue() ) );\n\n\t// watch out for werdo svg elements\n\tlet cls = this.node.className;\n\tcls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n\tconst attr = readClass( cls );\n\tconst prev = this.previous || attr.slice( 0 );\n\n\tconst className = value.concat( attr.filter( c => !~prev.indexOf( c ) ) ).join( ' ' );\n\n\tif ( className !== cls ) {\n\t\tif ( typeof this.node.className !== 'string' ) {\n\t\t\tthis.node.className.baseVal = className;\n\t\t} else {\n\t\t\tthis.node.className = className;\n\t\t}\n\t}\n\n\tthis.previous = value;\n}\n\nfunction updateInlineClass ( reset ) {\n\tconst name = this.name.substr( 6 );\n\n\t// watch out for werdo svg elements\n\tlet cls = this.node.className;\n\tcls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n\tconst attr = readClass( cls );\n\tconst value = reset ? false : this.getValue();\n\n\tif ( !this.inlineClass ) this.inlineClass = name;\n\n\tif ( value && !~attr.indexOf( name ) ) attr.push( name );\n\telse if ( !value && ~attr.indexOf( name ) ) attr.splice( attr.indexOf( name ), 1 );\n\n\tif ( typeof this.node.className !== 'string' ) {\n\t\tthis.node.className.baseVal = attr.join( ' ' );\n\t} else {\n\t\tthis.node.className = attr.join( ' ' );\n\t}\n}\n\nfunction updateBoolean ( reset ) {\n\t// with two-way binding, only update if the change wasn't initiated by the user\n\t// otherwise the cursor will often be sent to the wrong place\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tif ( this.useProperty ) this.node[ this.propertyName ] = false;\n\t\t\tthis.node.removeAttribute( this.propertyName );\n\t\t} else {\n\t\t\tif ( this.useProperty ) {\n\t\t\t\tthis.node[ this.propertyName ] = this.getValue();\n\t\t\t} else {\n\t\t\t\tif ( this.getValue() ) {\n\t\t\t\t\tthis.node.setAttribute( this.propertyName, '' );\n\t\t\t\t} else {\n\t\t\t\t\tthis.node.removeAttribute( this.propertyName );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction updateAttribute ( reset ) {\n\tif ( reset ) this.node.removeAttribute( this.name );\n\telse this.node.setAttribute( this.name, safeToStringValue( this.getString() ) );\n}\n\nfunction updateNamespacedAttribute ( reset ) {\n\tif ( reset ) this.node.removeAttributeNS( this.namespace, this.name.slice( this.name.indexOf( ':' ) + 1 ) );\n\telse this.node.setAttributeNS( this.namespace, this.name.slice( this.name.indexOf( ':' ) + 1 ), safeToStringValue( this.getString() ) );\n}\n","export default {\n\t'accept-charset': 'acceptCharset',\n\taccesskey: 'accessKey',\n\tbgcolor: 'bgColor',\n\tclass: 'className',\n\tcodebase: 'codeBase',\n\tcolspan: 'colSpan',\n\tcontenteditable: 'contentEditable',\n\tdatetime: 'dateTime',\n\tdirname: 'dirName',\n\tfor: 'htmlFor',\n\t'http-equiv': 'httpEquiv',\n\tismap: 'isMap',\n\tmaxlength: 'maxLength',\n\tnovalidate: 'noValidate',\n\tpubdate: 'pubDate',\n\treadonly: 'readOnly',\n\trowspan: 'rowSpan',\n\ttabindex: 'tabIndex',\n\tusemap: 'useMap'\n};\n","// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\nexport const booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\nexport const voidElementNames = /^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;\n\nconst htmlEntities = { quot: 34, amp: 38, apos: 39, lt: 60, gt: 62, nbsp: 160, iexcl: 161, cent: 162, pound: 163, curren: 164, yen: 165, brvbar: 166, sect: 167, uml: 168, copy: 169, ordf: 170, laquo: 171, not: 172, shy: 173, reg: 174, macr: 175, deg: 176, plusmn: 177, sup2: 178, sup3: 179, acute: 180, micro: 181, para: 182, middot: 183, cedil: 184, sup1: 185, ordm: 186, raquo: 187, frac14: 188, frac12: 189, frac34: 190, iquest: 191, Agrave: 192, Aacute: 193, Acirc: 194, Atilde: 195, Auml: 196, Aring: 197, AElig: 198, Ccedil: 199, Egrave: 200, Eacute: 201, Ecirc: 202, Euml: 203, Igrave: 204, Iacute: 205, Icirc: 206, Iuml: 207, ETH: 208, Ntilde: 209, Ograve: 210, Oacute: 211, Ocirc: 212, Otilde: 213, Ouml: 214, times: 215, Oslash: 216, Ugrave: 217, Uacute: 218, Ucirc: 219, Uuml: 220, Yacute: 221, THORN: 222, szlig: 223, agrave: 224, aacute: 225, acirc: 226, atilde: 227, auml: 228, aring: 229, aelig: 230, ccedil: 231, egrave: 232, eacute: 233, ecirc: 234, euml: 235, igrave: 236, iacute: 237, icirc: 238, iuml: 239, eth: 240, ntilde: 241, ograve: 242, oacute: 243, ocirc: 244, otilde: 245, ouml: 246, divide: 247, oslash: 248, ugrave: 249, uacute: 250, ucirc: 251, uuml: 252, yacute: 253, thorn: 254, yuml: 255, OElig: 338, oelig: 339, Scaron: 352, scaron: 353, Yuml: 376, fnof: 402, circ: 710, tilde: 732, Alpha: 913, Beta: 914, Gamma: 915, Delta: 916, Epsilon: 917, Zeta: 918, Eta: 919, Theta: 920, Iota: 921, Kappa: 922, Lambda: 923, Mu: 924, Nu: 925, Xi: 926, Omicron: 927, Pi: 928, Rho: 929, Sigma: 931, Tau: 932, Upsilon: 933, Phi: 934, Chi: 935, Psi: 936, Omega: 937, alpha: 945, beta: 946, gamma: 947, delta: 948, epsilon: 949, zeta: 950, eta: 951, theta: 952, iota: 953, kappa: 954, lambda: 955, mu: 956, nu: 957, xi: 958, omicron: 959, pi: 960, rho: 961, sigmaf: 962, sigma: 963, tau: 964, upsilon: 965, phi: 966, chi: 967, psi: 968, omega: 969, thetasym: 977, upsih: 978, piv: 982, ensp: 8194, emsp: 8195, thinsp: 8201, zwnj: 8204, zwj: 8205, lrm: 8206, rlm: 8207, ndash: 8211, mdash: 8212, lsquo: 8216, rsquo: 8217, sbquo: 8218, ldquo: 8220, rdquo: 8221, bdquo: 8222, dagger: 8224, Dagger: 8225, bull: 8226, hellip: 8230, permil: 8240, prime: 8242, Prime: 8243, lsaquo: 8249, rsaquo: 8250, oline: 8254, frasl: 8260, euro: 8364, image: 8465, weierp: 8472, real: 8476, trade: 8482, alefsym: 8501, larr: 8592, uarr: 8593, rarr: 8594, darr: 8595, harr: 8596, crarr: 8629, lArr: 8656, uArr: 8657, rArr: 8658, dArr: 8659, hArr: 8660, forall: 8704, part: 8706, exist: 8707, empty: 8709, nabla: 8711, isin: 8712, notin: 8713, ni: 8715, prod: 8719, sum: 8721, minus: 8722, lowast: 8727, radic: 8730, prop: 8733, infin: 8734, ang: 8736, and: 8743, or: 8744, cap: 8745, cup: 8746, int: 8747, there4: 8756, sim: 8764, cong: 8773, asymp: 8776, ne: 8800, equiv: 8801, le: 8804, ge: 8805, sub: 8834, sup: 8835, nsub: 8836, sube: 8838, supe: 8839, oplus: 8853, otimes: 8855, perp: 8869, sdot: 8901, lceil: 8968, rceil: 8969, lfloor: 8970, rfloor: 8971, lang: 9001, rang: 9002, loz: 9674, spades: 9824, clubs: 9827, hearts: 9829, diams: 9830\t};\nconst controlCharacters = [ 8364, 129, 8218, 402, 8222, 8230, 8224, 8225, 710, 8240, 352, 8249, 338, 141, 381, 143, 144, 8216, 8217, 8220, 8221, 8226, 8211, 8212, 732, 8482, 353, 8250, 339, 157, 382, 376 ];\nconst entityPattern = new RegExp( '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + Object.keys( htmlEntities ).join( '|' ) + '));?', 'g' );\nconst codePointSupport = typeof String.fromCodePoint === 'function';\nconst codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\n\nexport function decodeCharacterReferences ( html ) {\n\treturn html.replace( entityPattern, ( match, entity ) => {\n\t\tlet code;\n\n\t\t// Handle named entities\n\t\tif ( entity[0] !== '#' ) {\n\t\t\tcode = htmlEntities[ entity ];\n\t\t} else if ( entity[1] === 'x' ) {\n\t\t\tcode = parseInt( entity.substring( 2 ), 16 );\n\t\t} else {\n\t\t\tcode = parseInt( entity.substring( 1 ), 10 );\n\t\t}\n\n\t\tif ( !code ) {\n\t\t\treturn match;\n\t\t}\n\n\t\treturn codeToChar( validateCode( code ) );\n\t});\n}\n\nconst lessThan = /</g;\nconst greaterThan = />/g;\nconst amp = /&/g;\nconst invalid = 65533;\n\nexport function escapeHtml ( str ) {\n\treturn str\n\t\t.replace( amp, '&amp;' )\n\t\t.replace( lessThan, '&lt;' )\n\t\t.replace( greaterThan, '&gt;' );\n}\n\n// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n// to replace them ourselves\n//\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\nfunction validateCode ( code ) {\n\tif ( !code ) {\n\t\treturn invalid;\n\t}\n\n\t// line feed becomes generic whitespace\n\tif ( code === 10 ) {\n\t\treturn 32;\n\t}\n\n\t// ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n\tif ( code < 128 ) {\n\t\treturn code;\n\t}\n\n\t// code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n\t// to correct the mistake or we'll end up with missing  signs and so on\n\tif ( code <= 159 ) {\n\t\treturn controlCharacters[ code - 128 ];\n\t}\n\n\t// basic multilingual plane\n\tif ( code < 55296 ) {\n\t\treturn code;\n\t}\n\n\t// UTF-16 surrogate halves\n\tif ( code <= 57343 ) {\n\t\treturn invalid;\n\t}\n\n\t// rest of the basic multilingual plane\n\tif ( code <= 65535 ) {\n\t\treturn code;\n\t} else if ( !codePointSupport ) {\n\t\treturn invalid;\n\t}\n\n\t// supplementary multilingual plane 0x10000 - 0x1ffff\n\tif ( code >= 65536 && code <= 131071 ) {\n\t\treturn code;\n\t}\n\n\t// supplementary ideographic plane 0x20000 - 0x2ffff\n\tif ( code >= 131072 && code <= 196607 ) {\n\t\treturn code;\n\t}\n\n\treturn invalid;\n}\n","import { doc } from '../../../config/environment';\nimport { svg } from '../../../config/namespaces';\nimport { createElement } from '../../../utils/dom';\nimport { toArray } from '../../../utils/array';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\nimport noop from '../../../utils/noop';\n\nconst div = doc ? createElement( 'div' ) : null;\n\nlet attributes = false;\nexport function inAttributes() { return attributes; }\nexport function doInAttributes( fn ) {\n\tattributes = true;\n\tfn();\n\tattributes = false;\n}\n\nexport default class ConditionalAttribute extends Item {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.attributes = [];\n\n\t\tthis.owner = options.owner;\n\n\t\tthis.fragment = new Fragment({\n\t\t\tractive: this.ractive,\n\t\t\towner: this,\n\t\t\ttemplate: this.template\n\t\t});\n\t\t// this fragment can't participate in node-y things\n\t\tthis.fragment.findNextNode = noop;\n\n\t\tthis.dirty = false;\n\t}\n\n\tbind () {\n\t\tthis.fragment.bind();\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.owner.bubble();\n\t\t}\n\t}\n\n\trender () {\n\t\tthis.node = this.owner.node;\n\t\tif ( this.node ) {\n\t\t\tthis.isSvg = this.node.namespaceURI === svg;\n\t\t}\n\n\t\tattributes = true;\n\t\tif ( !this.rendered ) this.fragment.render();\n\n\t\tthis.rendered = true;\n\t\tthis.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n\t\tthis.update();\n\t\tattributes = false;\n\t}\n\n\ttoString () {\n\t\treturn this.fragment.toString();\n\t}\n\n\tunbind () {\n\t\tthis.fragment.unbind();\n\t}\n\n\tunrender () {\n\t\tthis.rendered = false;\n\t\tthis.fragment.unrender();\n\t}\n\n\tupdate () {\n\t\tlet str;\n\t\tlet attrs;\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tconst current = attributes;\n\t\t\tattributes = true;\n\t\t\tthis.fragment.update();\n\t\t\tattributes = current || false;\n\n\t\t\tif ( this.rendered && this.node ) {\n\t\t\t\tstr = this.fragment.toString();\n\t\t\t\tattrs = parseAttributes( str, this.isSvg );\n\n\t\t\t\t// any attributes that previously existed but no longer do\n\t\t\t\t// must be removed\n\t\t\t\tthis.attributes.filter( a => notIn( attrs, a ) ).forEach( a => {\n\t\t\t\t\tthis.node.removeAttribute( a.name );\n\t\t\t\t});\n\n\t\t\t\tattrs.forEach( a => {\n\t\t\t\t\tthis.node.setAttribute( a.name, a.value );\n\t\t\t\t});\n\n\t\t\t\tthis.attributes = attrs;\n\t\t\t}\n\t\t}\n\t}\n}\n\n\nfunction parseAttributes ( str, isSvg ) {\n\tconst tagName = isSvg ? 'svg' : 'div';\n\treturn str\n\t\t? (div.innerHTML = `<${tagName} ${str}></${tagName}>`) &&\n\t\t\ttoArray(div.childNodes[0].attributes)\n\t\t: [];\n}\n\nfunction notIn ( haystack, needle ) {\n\tlet i = haystack.length;\n\n\twhile ( i-- ) {\n\t\tif ( haystack[i].name === needle.name ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n","import { INTERPOLATOR } from '../../../config/types';\nimport namespaces from '../../../config/namespaces';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\nimport findElement from '../shared/findElement';\nimport getUpdateDelegate from './attribute/getUpdateDelegate';\nimport propertyNames from './attribute/propertyNames';\nimport { safeAttributeString } from '../../../utils/dom';\nimport { booleanAttributes } from '../../../utils/html';\nimport hyphenateCamel from '../../../utils/hyphenateCamel';\nimport { inAttributes } from './ConditionalAttribute';\n\nfunction lookupNamespace ( node, prefix ) {\n\tconst qualified = `xmlns:${prefix}`;\n\n\twhile ( node ) {\n\t\tif ( node.hasAttribute && node.hasAttribute( qualified ) ) return node.getAttribute( qualified );\n\t\tnode = node.parentNode;\n\t}\n\n\treturn namespaces[ prefix ];\n}\n\nlet attribute = false;\nexport function inAttribute () { return attribute; }\n\nexport default class Attribute extends Item {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.name = options.template.n;\n\t\tthis.namespace = null;\n\n\t\tthis.owner = options.owner || options.parentFragment.owner || options.element || findElement( options.parentFragment );\n\t\tthis.element = options.element || (this.owner.attributeByName ? this.owner : findElement( options.parentFragment ) );\n\t\tthis.parentFragment = options.parentFragment; // shared\n\t\tthis.ractive = this.parentFragment.ractive;\n\n\t\tthis.rendered = false;\n\t\tthis.updateDelegate = null;\n\t\tthis.fragment = null;\n\n\t\tthis.element.attributeByName[ this.name ] = this;\n\n\t\tif ( !Array.isArray( options.template.f ) ) {\n\t\t\tthis.value = options.template.f;\n\t\t\tif ( this.value === 0 ) {\n\t\t\t\tthis.value = '';\n\t\t\t} else if ( this.value === undefined ) {\n\t\t\t\tthis.value = true;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\towner: this,\n\t\t\t\ttemplate: options.template.f\n\t\t\t});\n\t\t}\n\n\t\tthis.interpolator = this.fragment &&\n\t\t\tthis.fragment.items.length === 1 &&\n\t\t\tthis.fragment.items[0].type === INTERPOLATOR &&\n\t\t\tthis.fragment.items[0];\n\n\t\tif ( this.interpolator ) this.interpolator.owner = this;\n\t}\n\n\tbind () {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.bind();\n\t\t}\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.parentFragment.bubble();\n\t\t\tthis.element.bubble();\n\t\t\tthis.dirty = true;\n\t\t}\n\t}\n\n\tgetString () {\n\t\tattribute = true;\n\t\tconst value = this.fragment ?\n\t\t\tthis.fragment.toString() :\n\t\t\tthis.value != null ? '' + this.value : '';\n\t\tattribute = false;\n\t\treturn value;\n\t}\n\n\t// TODO could getValue ever be called for a static attribute,\n\t// or can we assume that this.fragment exists?\n\tgetValue () {\n\t\tattribute = true;\n\t\tconst value = this.fragment ? this.fragment.valueOf() : booleanAttributes.test( this.name ) ? true : this.value;\n\t\tattribute = false;\n\t\treturn value;\n\t}\n\n\trender () {\n\t\tconst node = this.element.node;\n\t\tthis.node = node;\n\n\t\t// should we use direct property access, or setAttribute?\n\t\tif ( !node.namespaceURI || node.namespaceURI === namespaces.html ) {\n\t\t\tthis.propertyName = propertyNames[ this.name ] || this.name;\n\n\t\t\tif ( node[ this.propertyName ] !== undefined ) {\n\t\t\t\tthis.useProperty = true;\n\t\t\t}\n\n\t\t\t// is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n\t\t\t// node.selected = true rather than node.setAttribute( 'selected', '' )\n\t\t\tif ( booleanAttributes.test( this.name ) || this.isTwoway ) {\n\t\t\t\tthis.isBoolean = true;\n\t\t\t}\n\n\t\t\tif ( this.propertyName === 'value' ) {\n\t\t\t\tnode._ractive.value = this.value;\n\t\t\t}\n\t\t}\n\n\t\tif ( node.namespaceURI ) {\n\t\t\tconst index = this.name.indexOf( ':' );\n\t\t\tif ( index !== -1 ) {\n\t\t\t\tthis.namespace = lookupNamespace( node, this.name.slice( 0, index ) );\n\t\t\t} else {\n\t\t\t\tthis.namespace = node.namespaceURI;\n\t\t\t}\n\t\t}\n\n\t\tthis.rendered = true;\n\t\tthis.updateDelegate = getUpdateDelegate( this );\n\t\tthis.updateDelegate();\n\t}\n\n\ttoString () {\n\t\tif ( inAttributes() ) return '';\n\t\tattribute = true;\n\n\t\tconst value = this.getValue();\n\n\t\t// Special case - select and textarea values (should not be stringified)\n\t\tif ( this.name === 'value' && ( this.element.getAttribute( 'contenteditable' ) !== undefined || ( this.element.name === 'select' || this.element.name === 'textarea' ) ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Special case  bound radio `name` attributes\n\t\tif ( this.name === 'name' && this.element.name === 'input' && this.interpolator && this.element.getAttribute( 'type' ) === 'radio' ) {\n\t\t\treturn `name=\"{{${this.interpolator.model.getKeypath()}}}\"`;\n\t\t}\n\n\t\t// Special case - style and class attributes and directives\n\t\tif ( this.owner === this.element && ( this.name === 'style' || this.name === 'class' || this.style || this.inlineClass ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this.rendered && this.owner === this.element && ( !this.name.indexOf( 'style-' ) || !this.name.indexOf( 'class-' ) ) ) {\n\t\t\tif ( !this.name.indexOf( 'style-' ) ) {\n\t\t\t\tthis.style = hyphenateCamel( this.name.substr( 6 ) );\n\t\t\t} else {\n\t\t\t\tthis.inlineClass = this.name.substr( 6 );\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif ( booleanAttributes.test( this.name ) ) return value ? this.name : '';\n\t\tif ( value == null ) return '';\n\n\t\tconst str = safeAttributeString( this.getString() );\n\t\tattribute = false;\n\n\t\treturn str ?\n\t\t\t`${this.name}=\"${str}\"` :\n\t\t\tthis.name;\n\t}\n\n\tunbind () {\n\t\tif ( this.fragment ) this.fragment.unbind();\n\t}\n\n\tunrender () {\n\t\tthis.updateDelegate( true );\n\n\t\tthis.rendered = false;\n\t}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tif ( this.fragment ) this.fragment.update();\n\t\t\tif ( this.rendered ) this.updateDelegate();\n\t\t\tif ( this.isTwoway && !this.locked ) {\n\t\t\t\tthis.interpolator.twowayBinding.lastVal( true, this.interpolator.model.get() );\n\t\t\t}\n\t\t}\n\t}\n}\n","import Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport { INTERPOLATOR, ELEMENT } from '../../../config/types';\n\nexport default class BindingFlag extends Item {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\t\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\n\t\tthis.flag = options.template.v === 'l' ? 'lazy' : 'twoway';\n\n\t\tif ( this.element.type === ELEMENT ) {\n\t\t\tif ( Array.isArray( options.template.f ) ) {\n\t\t\t\tthis.fragment = new Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: options.template.f\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.interpolator = this.fragment &&\n\t\t\t\t\t\t\t\tthis.fragment.items.length === 1 &&\n\t\t\t\t\t\t\t\tthis.fragment.items[0].type === INTERPOLATOR &&\n\t\t\t\t\t\t\t\tthis.fragment.items[0];\n\t\t}\n\t}\n\n\tbind () {\n\t\tif ( this.fragment ) this.fragment.bind();\n\t\tset( this, this.getValue(), true );\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.element.bubble();\n\t\t\tthis.dirty = true;\n\t\t}\n\t}\n\n\tgetValue () {\n\t\tif ( this.fragment ) return this.fragment.valueOf();\n\t\telse if ( 'value' in this ) return this.value;\n\t\telse if ( 'f' in this.template ) return this.template.f;\n\t\telse return true;\n\t}\n\n\trender () {\n\t\tset( this, this.getValue(), true );\n\t}\n\n\ttoString () { return ''; }\n\n\tunbind () {\n\t\tif ( this.fragment ) this.fragment.unbind();\n\n\t\tdelete this.element[ this.flag ];\n\t}\n\n\tunrender () {\n\t\tif ( this.element.rendered ) this.element.recreateTwowayBinding();\n\t}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tif ( this.fragment ) this.fragment.update();\n\t\t\tset( this, this.getValue(), true );\n\t\t}\n\t}\n}\n\nfunction set ( flag, value, update ) {\n\tif ( value === 0 ) {\n\t\tflag.value = true;\n\t} else if ( value === 'true' ) {\n\t\tflag.value = true;\n\t} else if ( value === 'false' || value === '0' ) {\n\t\tflag.value = false;\n\t} else {\n\t\tflag.value = value;\n\t}\n\n\tconst current = flag.element[ flag.flag ];\n\tflag.element[ flag.flag ] = flag.value;\n\tif ( update && !flag.element.attributes.binding && current !== flag.value ) {\n\t\tflag.element.recreateTwowayBinding();\n\t}\n\n\treturn flag.value;\n}\n","import Model from '../Model';\nimport { Missing } from '../LinkModel';\n\nexport default class RactiveModel extends Model {\n\tconstructor ( ractive ) {\n\t\tsuper( null, '' );\n\t\tthis.value = ractive;\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.adaptors = [];\n\t\tthis.ractive = ractive;\n\t}\n\n\tjoinKey ( key ) {\n\t\tconst model = super.joinKey( key );\n\n\t\tif ( ( key === 'root' || key === 'parent' ) && !model.isLink ) return initLink( model, key );\n\t\telse if ( key === 'data' ) return this.ractive.viewmodel;\n\n\t\treturn model;\n\t}\n\n\tgetKeypath() {\n\t\treturn '@this';\n\t}\n\n\tretrieve () {\n\t\treturn this.ractive;\n\t}\n}\n\nfunction initLink ( model, key ) {\n\tmodel.applyValue = function ( value ) {\n\t\tthis.parent.value[ key ] = value;\n\t\tif ( value && value.viewmodel ) {\n\t\t\tthis.link( value.viewmodel.getRactiveModel(), key );\n\t\t\tthis._link.markedAll();\n\t\t} else {\n\t\t\tthis.link( Object.create( Missing ), key );\n\t\t\tthis._link.markedAll();\n\t\t}\n\t};\n\n\tmodel.applyValue( model.parent.ractive[ key ], key );\n\tmodel._link.set = v => model.applyValue( v );\n\tmodel._link.applyValue = v => model.applyValue( v );\n\treturn model._link;\n}\n","import { capture } from '../global/capture';\nimport Computation from './Computation';\nimport Model from './Model';\nimport { handleChange, mark } from '../shared/methodCallers';\nimport RactiveModel from './specials/RactiveModel';\nimport SharedModel, { GlobalModel } from './specials/SharedModel';\nimport { splitKeypath, escapeKey, unescapeKey } from '../shared/keypaths';\nimport resolveReference from '../view/resolvers/resolveReference';\nimport noop from '../utils/noop';\n\nconst hasProp = Object.prototype.hasOwnProperty;\n\nexport default class RootModel extends Model {\n\tconstructor ( options ) {\n\t\tsuper( null, null );\n\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.ractive = options.ractive; // TODO sever this link\n\n\t\tthis.value = options.data;\n\t\tthis.adaptors = options.adapt;\n\t\tthis.adapt();\n\n\t\tthis.computationContext = options.ractive;\n\t\tthis.computations = {};\n\t}\n\n\tattached ( fragment ) {\n\t\tattachImplicits( this, fragment );\n\t}\n\n\tcompute ( key, signature ) {\n\t\tconst computation = new Computation( this, signature, key );\n\t\tthis.computations[ escapeKey( key ) ] = computation;\n\n\t\treturn computation;\n\t}\n\n\tcreateLink ( keypath, target, targetPath, options ) {\n\t\tconst keys = splitKeypath( keypath );\n\n\t\tlet model = this;\n\t\twhile ( keys.length ) {\n\t\t\tconst key = keys.shift();\n\t\t\tmodel = model.childByKey[ key ] || model.joinKey( key );\n\t\t}\n\n\t\treturn model.link( target, targetPath, options );\n\t}\n\n\tdetached () {\n\t\tdetachImplicits( this );\n\t}\n\n\tget ( shouldCapture, options ) {\n\t\tif ( shouldCapture ) capture( this );\n\n\t\tif ( !options || options.virtual !== false ) {\n\t\t\tconst result = this.getVirtual();\n\t\t\tconst keys = Object.keys( this.computations );\n\t\t\tlet i = keys.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tresult[ keys[i] ] = this.computations[ keys[i] ].get();\n\t\t\t}\n\n\t\t\treturn result;\n\t\t} else {\n\t\t\treturn this.value;\n\t\t}\n\t}\n\n\tgetKeypath () {\n\t\treturn '';\n\t}\n\n\tgetRactiveModel() {\n\t\treturn this.ractiveModel || ( this.ractiveModel = new RactiveModel( this.ractive ) );\n\t}\n\n\tgetValueChildren () {\n\t\tconst children = super.getValueChildren( this.value );\n\n\t\tthis.children.forEach( child => {\n\t\t\tif ( child._link ) {\n\t\t\t\tconst idx = children.indexOf( child );\n\t\t\t\tif ( ~idx ) children.splice( idx, 1, child._link );\n\t\t\t\telse children.push( child._link );\n\t\t\t}\n\t\t});\n\n\t\tfor ( const k in this.computations ) {\n\t\t\tchildren.push( this.computations[k] );\n\t\t}\n\n\t\treturn children;\n\t}\n\n\thas ( key ) {\n\t\tconst value = this.value;\n\t\tlet unescapedKey = unescapeKey( key );\n\n\t\tif ( unescapedKey === '@this' || unescapedKey === '@global' || unescapedKey === '@shared' ) return true;\n\t\tif ( unescapedKey[0] === '~' && unescapedKey[1] === '/' ) unescapedKey = unescapedKey.slice( 2 );\n\t\tif ( hasProp.call( value, unescapedKey ) ) return true;\n\n\t\t// mappings/links and computations\n\t\tif ( key in this.computations || this.childByKey[unescapedKey] && this.childByKey[unescapedKey]._link ) return true;\n\n\t\t// We climb up the constructor chain to find if one of them contains the unescapedKey\n\t\tlet constructor = value.constructor;\n\t\twhile ( constructor !== Function && constructor !== Array && constructor !== Object ) {\n\t\t\tif ( hasProp.call( constructor.prototype, unescapedKey ) ) return true;\n\t\t\tconstructor = constructor.constructor;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tjoinKey ( key, opts ) {\n\t\tif ( key[0] === '@' ) {\n\t\t\tif ( key === '@this' || key === '@' ) return this.getRactiveModel();\n\t\t\tif ( key === '@global' ) return GlobalModel;\n\t\t\tif ( key === '@shared' ) return SharedModel;\n\t\t\treturn;\n\t\t}\n\n\t\tif ( key[0] === '~' && key[1] === '/' ) key = key.slice( 2 );\n\n\t\treturn this.computations.hasOwnProperty( key ) ? this.computations[ key ] :\n\t\t       super.joinKey( key, opts );\n\t}\n\n\tset ( value ) {\n\t\t// TODO wrapping root node is a baaaad idea. We should prevent this\n\t\tconst wrapper = this.wrapper;\n\t\tif ( wrapper ) {\n\t\t\tconst shouldTeardown = !wrapper.reset || wrapper.reset( value ) === false;\n\n\t\t\tif ( shouldTeardown ) {\n\t\t\t\twrapper.teardown();\n\t\t\t\tthis.wrapper = null;\n\t\t\t\tthis.value = value;\n\t\t\t\tthis.adapt();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.value = value;\n\t\t\tthis.adapt();\n\t\t}\n\n\t\tthis.deps.forEach( handleChange );\n\t\tthis.children.forEach( mark );\n\t}\n\n\tretrieve () {\n\t\treturn this.wrapper ? this.wrapper.get() : this.value;\n\t}\n\n\tteardown () {\n\t\tsuper.teardown();\n\t\tfor ( const k in this.computations ) {\n\t\t\tthis.computations[ k ].teardown();\n\t\t}\n\t}\n}\nRootModel.prototype.update = noop;\n\nfunction attachImplicits ( model, fragment ) {\n\tif ( model._link && model._link.implicit && model._link.isDetached() ) {\n\t\tmodel.attach( fragment );\n\t}\n\n\t// look for virtual children to relink and cascade\n\tfor ( const k in model.childByKey ) {\n\t\tif ( k in model.value ) {\n\t\t\tattachImplicits( model.childByKey[k], fragment );\n\t\t} else if ( !model.childByKey[k]._link || model.childByKey[k]._link.isDetached() ) {\n\t\t\tconst mdl = resolveReference( fragment, k );\n\t\t\tif ( mdl ) {\n\t\t\t\tmodel.childByKey[k].link( mdl, k, { implicit: true } );\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction detachImplicits ( model ) {\n\tif ( model._link && model._link.implicit ) {\n\t\tmodel.unlink();\n\t}\n\n\tfor ( const k in model.childByKey ) {\n\t\tdetachImplicits( model.childByKey[k] );\n\t}\n}\n","import { fatal, warnIfDebug, welcome } from '../utils/log';\nimport { missingPlugin } from '../config/errors';\nimport { ensureArray, combine } from '../utils/array';\nimport { findInViewHierarchy } from '../shared/registry';\nimport dataConfigurator from './config/custom/data';\nimport RootModel from '../model/RootModel';\nimport Hook from '../events/Hook';\nimport getComputationSignature from './helpers/getComputationSignature';\nimport Ractive from '../Ractive';\nimport { ATTRIBUTE, INTERPOLATOR } from '../config/types';\n\nconst constructHook = new Hook( 'construct' );\n\nconst registryNames = [\n\t'adaptors',\n\t'components',\n\t'decorators',\n\t'easing',\n\t'events',\n\t'interpolators',\n\t'partials',\n\t'transitions'\n];\n\nlet uid = 0;\n\nexport default function construct ( ractive, options ) {\n\tif ( Ractive.DEBUG ) welcome();\n\n\tinitialiseProperties( ractive );\n\thandleAttributes( ractive );\n\n\t// if there's not a delegation setting, inherit from parent if it's not default\n\tif ( !options.hasOwnProperty( 'delegate' ) && ractive.parent && ractive.parent.delegate !== ractive.delegate ) {\n\t\tractive.delegate = false;\n\t}\n\n\t// TODO don't allow `onconstruct` with `new Ractive()`, there's no need for it\n\tconstructHook.fire( ractive, options );\n\n\t// Add registries\n\tlet i = registryNames.length;\n\twhile ( i-- ) {\n\t\tconst name = registryNames[ i ];\n\t\tractive[ name ] = Object.assign( Object.create( ractive.constructor[ name ] || null ), options[ name ] );\n\t}\n\n\tif ( ractive._attributePartial ) {\n\t\tractive.partials['extra-attributes'] = ractive._attributePartial;\n\t\tdelete ractive._attributePartial;\n\t}\n\n\t// Create a viewmodel\n\tconst viewmodel = new RootModel({\n\t\tadapt: getAdaptors( ractive, ractive.adapt, options ),\n\t\tdata: dataConfigurator.init( ractive.constructor, ractive, options ),\n\t\tractive\n\t});\n\n\tractive.viewmodel = viewmodel;\n\n\t// Add computed properties\n\tconst computed = Object.assign( Object.create( ractive.constructor.prototype.computed ), options.computed );\n\n\tfor ( const key in computed ) {\n\t\tif ( key === '__proto__' ) continue;\n\t\tconst signature = getComputationSignature( ractive, key, computed[ key ] );\n\t\tviewmodel.compute( key, signature );\n\t}\n}\n\nfunction getAdaptors ( ractive, protoAdapt, options ) {\n\tprotoAdapt = protoAdapt.map( lookup );\n\tconst adapt = ensureArray( options.adapt ).map( lookup );\n\n\tconst srcs = [ protoAdapt, adapt ];\n\tif ( ractive.parent && !ractive.isolated ) {\n\t\tsrcs.push( ractive.parent.viewmodel.adaptors );\n\t}\n\n\treturn combine.apply( null, srcs );\n\n\tfunction lookup ( adaptor ) {\n\t\tif ( typeof adaptor === 'string' ) {\n\t\t\tadaptor = findInViewHierarchy( 'adaptors', ractive, adaptor );\n\n\t\t\tif ( !adaptor ) {\n\t\t\t\tfatal( missingPlugin( adaptor, 'adaptor' ) );\n\t\t\t}\n\t\t}\n\n\t\treturn adaptor;\n\t}\n}\n\nfunction initialiseProperties ( ractive ) {\n\t// Generate a unique identifier, for places where you'd use a weak map if it\n\t// existed\n\tractive._guid = 'r-' + uid++;\n\n\t// events\n\tractive._subs = Object.create( null );\n\tractive._nsSubs = 0;\n\n\t// storage for item configuration from instantiation to reset,\n\t// like dynamic functions or original values\n\tractive._config = {};\n\n\t// events\n\tractive.event = null;\n\tractive._eventQueue = [];\n\n\t// observers\n\tractive._observers = [];\n\n\t// external children\n\tractive._children = [];\n\tractive._children.byName = {};\n\tractive.children = ractive._children;\n\n\tif ( !ractive.component ) {\n\t\tractive.root = ractive;\n\t\tractive.parent = ractive.container = null; // TODO container still applicable?\n\t}\n}\n\nfunction handleAttributes ( ractive ) {\n\tconst component = ractive.component;\n\tconst attributes = ractive.constructor.attributes;\n\n\tif ( attributes && component ) {\n\t\tconst tpl = component.template;\n\t\tconst attrs = tpl.m ? tpl.m.slice() : [];\n\n\t\t// grab all of the passed attribute names\n\t\tconst props = attrs.filter( a => a.t === ATTRIBUTE ).map( a => a.n );\n\n\t\t// warn about missing requireds\n\t\tattributes.required.forEach( p => {\n\t\t\tif ( !~props.indexOf( p ) ) {\n\t\t\t\twarnIfDebug( `Component '${component.name}' requires attribute '${p}' to be provided` );\n\t\t\t}\n\t\t});\n\n\t\t// set up a partial containing non-property attributes\n\t\tconst all = attributes.optional.concat( attributes.required );\n\t\tconst partial = [];\n\t\tlet i = attrs.length;\n\t\twhile ( i-- ) {\n\t\t\tconst a = attrs[i];\n\t\t\tif ( a.t === ATTRIBUTE && !~all.indexOf( a.n ) ) {\n\t\t\t\tif ( attributes.mapAll ) {\n\t\t\t\t\t// map the attribute if requested and make the extra attribute in the partial refer to the mapping\n\t\t\t\t\tpartial.unshift({ t: ATTRIBUTE, n: a.n, f: [{ t: INTERPOLATOR, r: `~/${a.n}` }] });\n\t\t\t\t} else {\n\t\t\t\t\t// transfer the attribute to the extra attributes partal\n\t\t\t\t\tpartial.unshift( attrs.splice( i, 1 )[0] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( partial.length ) component.template = { t: tpl.t, e: tpl.e, f: tpl.f, m: attrs, p: tpl.p };\n\t\tractive._attributePartial = partial;\n\t}\n}\n","import Hook from '../../events/Hook';\nimport { removeFromArray } from '../../utils/array';\nimport { cancel } from '../../shared/methodCallers';\nimport { warnIfDebug } from '../../utils/log';\n\nconst teardownHook = new Hook( 'teardown' );\nconst destructHook = new Hook( 'destruct' );\n\n// Teardown. This goes through the root fragment and all its children, removing observers\n// and generally cleaning up after itself\n\nexport default function Ractive$teardown () {\n\tif ( this.torndown ) {\n\t\twarnIfDebug( 'ractive.teardown() was called on a Ractive instance that was already torn down' );\n\t\treturn Promise.resolve();\n\t}\n\n\tthis.shouldDestroy = true;\n\treturn teardown( this, () => this.fragment.rendered ? this.unrender() : Promise.resolve() );\n}\n\nexport function teardown ( instance, getPromise ) {\n\tinstance.torndown = true;\n\tinstance.viewmodel.teardown();\n\tinstance.fragment.unbind();\n\tinstance._observers.slice().forEach( cancel );\n\n\tif ( instance.el && instance.el.__ractive_instances__ ) {\n\t\tremoveFromArray( instance.el.__ractive_instances__, instance );\n\t}\n\n\tconst promise = getPromise();\n\n\tteardownHook.fire( instance );\n\tpromise.then( () => destructHook.fire( instance ) );\n\n\treturn promise;\n}\n","import runloop from '../../global/runloop';\nimport { warnIfDebug } from '../../utils/log';\nimport { ANCHOR, ATTRIBUTE, BINDING_FLAG, COMPONENT, DECORATOR, EVENT, TRANSITION, YIELDER } from '../../config/types';\nimport Item from './shared/Item';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport construct from '../../Ractive/construct';\nimport initialise from '../../Ractive/initialise';\nimport render from '../../Ractive/render';\nimport { createDocumentFragment } from '../../utils/dom';\nimport createItem from './createItem';\nimport { bind, render as callRender, unbind, unrender, update } from '../../shared/methodCallers';\nimport { updateAnchors } from '../../shared/anchors';\nimport { teardown } from '../../Ractive/prototype/teardown';\nimport getRactiveContext from '../../shared/getRactiveContext';\n\nexport default class Component extends Item {\n\tconstructor ( options, ComponentConstructor ) {\n\t\tsuper( options );\n\t\tthis.isAnchor = this.template.t === ANCHOR;\n\t\tthis.type = this.isAnchor ? ANCHOR : COMPONENT; // override ELEMENT from super\n\n\t\tconst partials = options.template.p || {};\n\t\tif ( !( 'content' in partials ) ) partials.content = options.template.f || [];\n\t\tthis._partials = partials; // TEMP\n\n\t\tif ( this.isAnchor ) {\n\t\t\tthis.name = options.template.n;\n\n\t\t\tthis.addChild = addChild;\n\t\t\tthis.removeChild = removeChild;\n\t\t} else {\n\t\t\tconst instance = Object.create( ComponentConstructor.prototype );\n\n\t\t\tthis.instance = instance;\n\t\t\tthis.name = options.template.e;\n\n\t\t\tif ( instance.el ) {\n\t\t\t\twarnIfDebug( `The <${this.name}> component has a default 'el' property; it has been disregarded` );\n\t\t\t}\n\n\t\t\t// find container\n\t\t\tlet fragment = options.parentFragment;\n\t\t\tlet container;\n\t\t\twhile ( fragment ) {\n\t\t\t\tif ( fragment.owner.type === YIELDER ) {\n\t\t\t\t\tcontainer = fragment.owner.container;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tfragment = fragment.parent;\n\t\t\t}\n\n\t\t\t// add component-instance-specific properties\n\t\t\tinstance.parent = this.parentFragment.ractive;\n\t\t\tinstance.container = container || null;\n\t\t\tinstance.root = instance.parent.root;\n\t\t\tinstance.component = this;\n\n\t\t\tconstruct( this.instance, { partials });\n\n\t\t\t// for hackability, this could be an open option\n\t\t\t// for any ractive instance, but for now, just\n\t\t\t// for components and just for ractive...\n\t\t\tinstance._inlinePartials = partials;\n\t\t}\n\n\t\tthis.attributeByName = {};\n\n\t\tthis.events = [];\n\t\tthis.attributes = [];\n\t\tconst leftovers = [];\n\t\t( this.template.m || [] ).forEach( template => {\n\t\t\tswitch ( template.t ) {\n\t\t\t\tcase ATTRIBUTE:\n\t\t\t\tcase EVENT:\n\t\t\t\t\tthis.attributes.push( createItem({\n\t\t\t\t\t\towner: this,\n\t\t\t\t\t\tparentFragment: this.parentFragment,\n\t\t\t\t\t\ttemplate\n\t\t\t\t\t}) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase TRANSITION:\n\t\t\t\tcase BINDING_FLAG:\n\t\t\t\tcase DECORATOR:\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tleftovers.push( template );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tif ( leftovers.length ) {\n\t\t\tthis.attributes.push( new ConditionalAttribute({\n\t\t\t\towner: this,\n\t\t\t\tparentFragment: this.parentFragment,\n\t\t\t\ttemplate: leftovers\n\t\t\t}) );\n\t\t}\n\n\t\tthis.eventHandlers = [];\n\t}\n\n\tbind () {\n\t\tif ( !this.isAnchor ) {\n\t\t\tthis.attributes.forEach( bind );\n\n\t\t\tinitialise( this.instance, {\n\t\t\t\tpartials: this._partials\n\t\t\t}, {\n\t\t\t\tcssIds: this.parentFragment.cssIds\n\t\t\t});\n\n\t\t\tthis.eventHandlers.forEach( bind );\n\n\t\t\tthis.bound = true;\n\t\t}\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.parentFragment.bubble();\n\t\t}\n\t}\n\n\tdestroyed () {\n\t\tif ( !this.isAnchor && this.instance.fragment ) this.instance.fragment.destroyed();\n\t}\n\n\tdetach () {\n\t\tif ( this.isAnchor ) {\n\t\t\tif ( this.instance ) return this.instance.fragment.detach();\n\t\t\treturn createDocumentFragment();\n\t\t}\n\n\t\treturn this.instance.fragment.detach();\n\t}\n\n\tfind ( selector, options ) {\n\t\tif ( this.instance ) return this.instance.fragment.find( selector, options );\n\t}\n\n\tfindAll ( selector, options ) {\n\t\tif ( this.instance ) this.instance.fragment.findAll( selector, options );\n\t}\n\n\tfindComponent ( name, options ) {\n\t\tif ( !name || this.name === name ) return this.instance;\n\n\t\tif ( this.instance.fragment ) {\n\t\t\treturn this.instance.fragment.findComponent( name, options );\n\t\t}\n\t}\n\n\tfindAllComponents ( name, options ) {\n\t\tconst { result } = options;\n\n\t\tif ( this.instance && ( !name || this.name === name ) ) {\n\t\t\tresult.push( this.instance );\n\t\t}\n\n\t\tif ( this.instance ) this.instance.findAllComponents( name, options );\n\t}\n\n\tfirstNode ( skipParent ) {\n\t\tif ( this.instance ) return this.instance.fragment.firstNode( skipParent );\n\t}\n\n\tgetContext ( ...assigns ) {\n\t\tassigns.unshift( this );\n\t\treturn getRactiveContext.apply( null, assigns );\n\t}\n\n\trender ( target, occupants ) {\n\t\tif ( this.isAnchor ) {\n\t\t\tthis.rendered = true;\n\t\t\tthis.target = target;\n\n\t\t\tif ( !checking.length ) {\n\t\t\t\tchecking.push( this.ractive );\n\t\t\t\tif ( occupants ) {\n\t\t\t\t\tthis.occupants = occupants;\n\t\t\t\t\tcheckAnchors();\n\t\t\t\t\tthis.occupants = null;\n\t\t\t\t} else {\n\t\t\t\t\trunloop.scheduleTask( checkAnchors, true );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\trender( this.instance, target, null, occupants );\n\n\t\t\tthis.attributes.forEach( callRender );\n\t\t\tthis.eventHandlers.forEach( callRender );\n\n\t\t\tthis.rendered = true;\n\t\t}\n\t}\n\n\ttoString () {\n\t\tif ( this.instance ) return this.instance.toHTML();\n\t}\n\n\tunbind () {\n\t\tif ( !this.isAnchor ) {\n\t\t\tthis.bound = false;\n\n\t\t\tthis.attributes.forEach( unbind );\n\n\t\t\tteardown( this.instance, () => runloop.promise() );\n\t\t}\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tthis.shouldDestroy = shouldDestroy;\n\n\t\tif ( this.isAnchor ) {\n\t\t\tif ( this.item ) unrenderItem( this, this.item );\n\t\t\tthis.target = null;\n\t\t\tif ( !checking.length ) {\n\t\t\t\tchecking.push( this.ractive );\n\t\t\t\trunloop.scheduleTask( checkAnchors, true );\n\t\t\t}\n\t\t} else {\n\t\t\tthis.instance.unrender();\n\t\t\tthis.instance.el = this.instance.target = null;\n\t\t\tthis.attributes.forEach( unrender );\n\t\t\tthis.eventHandlers.forEach( unrender );\n\t\t}\n\n\t\tthis.rendered = false;\n\t}\n\n\tupdate () {\n\t\tthis.dirty = false;\n\t\tif ( this.instance ) {\n\t\t\tthis.instance.fragment.update();\n\t\t\tthis.attributes.forEach( update );\n\t\t\tthis.eventHandlers.forEach( update );\n\t\t}\n\t}\n}\n\nfunction addChild ( meta ) {\n\tif ( this.item ) this.removeChild( this.item );\n\n\tconst child = meta.instance;\n\tmeta.anchor = this;\n\n\tmeta.parentFragment = this.parentFragment;\n\tmeta.name = meta.nameOption || this.name;\n\tthis.name = meta.name;\n\n\n\tif ( !child.isolated ) child.viewmodel.attached( this.parentFragment );\n\n\t// render as necessary\n\tif ( this.rendered ) {\n\t\trenderItem( this, meta );\n\t}\n}\n\nfunction removeChild ( meta ) {\n\t// unrender as necessary\n\tif ( this.item === meta ) {\n\t\tunrenderItem( this, meta );\n\t\tthis.name = this.template.n;\n\t}\n}\n\nfunction renderItem ( anchor, meta ) {\n\tif ( !anchor.rendered ) return;\n\n\tmeta.shouldDestroy = false;\n\tmeta.parentFragment = anchor.parentFragment;\n\n\tanchor.item = meta;\n\tanchor.instance = meta.instance;\n\tconst nextNode = anchor.parentFragment.findNextNode( anchor );\n\n\tif ( meta.instance.fragment.rendered ) {\n\t\tmeta.instance.unrender();\n\t}\n\n\tmeta.partials = meta.instance.partials;\n\tmeta.instance.partials = Object.assign( {}, meta.partials, anchor._partials );\n\n\tmeta.instance.fragment.unbind();\n\tmeta.instance.fragment.bind( meta.instance.viewmodel );\n\n\tanchor.attributes.forEach( bind );\n\tanchor.eventHandlers.forEach( bind );\n\tanchor.attributes.forEach( callRender );\n\tanchor.eventHandlers.forEach( callRender );\n\n\tconst target = anchor.parentFragment.findParentNode();\n\trender( meta.instance, target, target.contains( nextNode ) ? nextNode : null, anchor.occupants );\n\n\tif ( meta.lastBound !== anchor ) {\n\t\tmeta.lastBound = anchor;\n\t}\n}\n\nfunction unrenderItem ( anchor, meta ) {\n\tif ( !anchor.rendered ) return;\n\n\tmeta.shouldDestroy = true;\n\tmeta.instance.unrender();\n\n\tanchor.eventHandlers.forEach( unrender );\n\tanchor.attributes.forEach( unrender );\n\tanchor.eventHandlers.forEach( unbind );\n\tanchor.attributes.forEach( unbind );\n\n\tmeta.instance.el = meta.instance.anchor = null;\n\tmeta.parentFragment = null;\n\tmeta.anchor = null;\n\tanchor.item = null;\n\tanchor.instance = null;\n}\n\nlet checking = [];\nexport function checkAnchors () {\n\tconst list = checking;\n\tchecking = [];\n\n\tlist.forEach( updateAnchors );\n}\n","import { findInViewHierarchy } from '../../../shared/registry';\nimport findElement from '../shared/findElement';\nimport { warnOnce } from '../../../utils/log';\nimport { missingPlugin } from '../../../config/errors';\nimport noop from '../../../utils/noop';\nimport runloop from '../../../global/runloop';\nimport { rebindMatch } from '../../../shared/rebind';\nimport { setupArgsFn, teardownArgsFn } from '../shared/directiveArgs';\n\nconst missingDecorator = {\n\tupdate: noop,\n\tteardown: noop\n};\n\nexport default class Decorator {\n\tconstructor ( options ) {\n\t\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\t\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\n\t\tthis.parentFragment = this.owner.parentFragment;\n\t\tthis.ractive = this.owner.ractive;\n\t\tconst template = this.template = options.template;\n\n\t\tthis.name = template.n;\n\n\t\tthis.node = null;\n\t\tthis.intermediary = null;\n\n\t\tthis.element.decorators.push( this );\n\t}\n\n\tbind () {\n\t\tsetupArgsFn( this, this.template, this.parentFragment, { register: true } );\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.owner.bubble();\n\t\t}\n\t}\n\n\tdestroyed () {\n\t\tif ( this.intermediary ) this.intermediary.teardown();\n\t\tthis.shouldDestroy = true;\n\t}\n\n\thandleChange () { this.bubble(); }\n\n\trebind ( next, previous, safe ) {\n\t\tconst idx = this.models.indexOf( previous );\n\t\tif ( !~idx ) return;\n\n\t\tnext = rebindMatch( this.template.f.r[ idx ], next, previous );\n\t\tif ( next === previous ) return;\n\n\t\tprevious.unregister( this );\n\t\tthis.models.splice( idx, 1, next );\n\t\tif ( next ) next.addShuffleRegister( this, 'mark' );\n\n\t\tif ( !safe ) this.bubble();\n\t}\n\n\trender () {\n\t\trunloop.scheduleTask( () => {\n\t\t\tconst fn = findInViewHierarchy( 'decorators', this.ractive, this.name );\n\n\t\t\tif ( !fn ) {\n\t\t\t\twarnOnce( missingPlugin( this.name, 'decorator' ) );\n\t\t\t\tthis.intermediary = missingDecorator;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.node = this.element.node;\n\n\t\t\tlet args;\n\t\t\tif ( this.fn ) {\n\t\t\t\targs = this.models.map( model => {\n\t\t\t\t\tif ( !model ) return undefined;\n\n\t\t\t\t\treturn model.get();\n\t\t\t\t});\n\t\t\t\targs = this.fn.apply( this.ractive, args );\n\t\t\t}\n\n\t\t\tthis.intermediary = fn.apply( this.ractive, [ this.node ].concat( args ) );\n\n\t\t\tif ( !this.intermediary || !this.intermediary.teardown ) {\n\t\t\t\tthrow new Error( `The '${this.name}' decorator must return an object with a teardown method` );\n\t\t\t}\n\n\t\t\t// watch out for decorators that cause their host element to be unrendered\n\t\t\tif ( this.shouldDestroy ) this.destroyed();\n\t\t}, true );\n\t\tthis.rendered = true;\n\t}\n\n\ttoString () { return ''; }\n\n\tunbind () {\n\t\tteardownArgsFn( this, this.template );\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tif ( ( !shouldDestroy || this.element.rendered ) && this.intermediary ) this.intermediary.teardown();\n\t\tthis.rendered = false;\n\t}\n\n\tupdate () {\n\t\tif ( !this.dirty ) return;\n\n\t\tthis.dirty = false;\n\n\t\tif ( this.intermediary ) {\n\t\t\tif ( !this.intermediary.update ) {\n\t\t\t\tthis.unrender();\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconst args = this.models.map( model => model && model.get() );\n\t\t\t\tthis.intermediary.update.apply( this.ractive, this.fn.apply( this.ractive, args ) );\n\t\t\t}\n\t\t}\n\t}\n}\n","import Item from './shared/Item';\nimport noop from '../../utils/noop';\n\nexport default class Doctype extends Item {\n\ttoString () {\n\t\treturn '<!DOCTYPE' + this.template.a + '>';\n\t}\n}\n\nconst proto = Doctype.prototype;\nproto.bind = proto.render = proto.teardown = proto.unbind = proto.unrender = proto.update = noop;\n","import runloop from '../../../../global/runloop';\nimport { warnOnceIfDebug } from '../../../../utils/log';\nimport findElement from '../../shared/findElement';\nimport noop from '../../../../utils/noop';\n\nexport default class Binding {\n\tconstructor ( element, name = 'value' ) {\n\t\tthis.element = element;\n\t\tthis.ractive = element.ractive;\n\t\tthis.attribute = element.attributeByName[ name ];\n\n\t\tconst interpolator = this.attribute.interpolator;\n\t\tinterpolator.twowayBinding = this;\n\n\t\tconst model = interpolator.model;\n\n\t\tif ( model.isReadonly && !model.setRoot ) {\n\t\t\tconst keypath = model.getKeypath().replace( /^@/, '' );\n\t\t\twarnOnceIfDebug( `Cannot use two-way binding on <${element.name}> element: ${keypath} is read-only. To suppress this warning use <${element.name} twoway='false'...>`, { ractive: this.ractive });\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.attribute.isTwoway = true;\n\t\tthis.model = model;\n\n\t\t// initialise value, if it's undefined\n\t\tlet value = model.get();\n\t\tthis.wasUndefined = value === undefined;\n\n\t\tif ( value === undefined && this.getInitialValue ) {\n\t\t\tvalue = this.getInitialValue();\n\t\t\tmodel.set( value );\n\t\t}\n\t\tthis.lastVal( true, value );\n\n\t\tconst parentForm = findElement( this.element, false, 'form' );\n\t\tif ( parentForm ) {\n\t\t\tthis.resetValue = value;\n\t\t\tparentForm.formBindings.push( this );\n\t\t}\n\t}\n\n\tbind () {\n\t\tthis.model.registerTwowayBinding( this );\n\t}\n\n\thandleChange () {\n\t\tconst value = this.getValue();\n\t\tif ( this.lastVal() === value ) return;\n\n\t\trunloop.start( this.root );\n\t\tthis.attribute.locked = true;\n\t\tthis.model.set( value );\n\t\tthis.lastVal( true, value );\n\n\t\t// if the value changes before observers fire, unlock to be updatable cause something weird and potentially freezy is up\n\t\tif ( this.model.get() !== value ) this.attribute.locked = false;\n\t\telse runloop.scheduleTask( () => this.attribute.locked = false );\n\n\t\trunloop.end();\n\t}\n\n\tlastVal ( setting, value ) {\n\t\tif ( setting ) this.lastValue = value;\n\t\telse return this.lastValue;\n\t}\n\n\trebind ( next, previous ) {\n\t\tif ( this.model && this.model === previous ) previous.unregisterTwowayBinding( this );\n\t\tif ( next ) {\n\t\t\tthis.model = next;\n\t\t\trunloop.scheduleTask( () => next.registerTwowayBinding( this ) );\n\t\t}\n\t}\n\n\trender () {\n\t\tthis.node = this.element.node;\n\t\tthis.node._ractive.binding = this;\n\t\tthis.rendered = true; // TODO is this used anywhere?\n\t}\n\n\tsetFromNode ( node ) {\n\t\tthis.model.set( node.value );\n\t}\n\n\tunbind () {\n\t\tthis.model.unregisterTwowayBinding( this );\n\t}\n}\n\nBinding.prototype.unrender = noop;\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class CheckboxBinding extends Binding {\n\tconstructor ( element ) {\n\t\tsuper( element, 'checked' );\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\tthis.element.on( 'change', handleDomEvent );\n\n\t\tif ( this.node.attachEvent ) {\n\t\t\tthis.element.on( 'click', handleDomEvent );\n\t\t}\n\t}\n\n\tunrender () {\n\t\tthis.element.off( 'change', handleDomEvent );\n\t\tthis.element.off( 'click', handleDomEvent );\n\t}\n\n\tgetInitialValue () {\n\t\treturn !!this.element.getAttribute( 'checked' );\n\t}\n\n\tgetValue () {\n\t\treturn this.node.checked;\n\t}\n\n\tsetFromNode ( node ) {\n\t\tthis.model.set( node.checked );\n\t}\n}\n","import { removeFromArray } from '../../../../utils/array';\nimport Binding from './Binding';\n\nexport default function getBindingGroup ( group, model, getValue ) {\n\tconst hash = `${group}-bindingGroup`;\n\treturn model[hash] || ( model[ hash ] = new BindingGroup( hash, model, getValue ) );\n}\n\nclass BindingGroup {\n\tconstructor ( hash, model, getValue ) {\n\t\tthis.model = model;\n\t\tthis.hash = hash;\n\t\tthis.getValue = () => {\n\t\t\tthis.value = getValue.call(this);\n\t\t\treturn this.value;\n\t\t};\n\n\t\tthis.bindings = [];\n\t}\n\n\tadd ( binding ) {\n\t\tthis.bindings.push( binding );\n\t}\n\n\tbind () {\n\t\tthis.value = this.model.get();\n\t\tthis.model.registerTwowayBinding( this );\n\t\tthis.bound = true;\n\t}\n\n\tremove ( binding ) {\n\t\tremoveFromArray( this.bindings, binding );\n\t\tif ( !this.bindings.length ) {\n\t\t\tthis.unbind();\n\t\t}\n\t}\n\n\tunbind () {\n\t\tthis.model.unregisterTwowayBinding( this );\n\t\tthis.bound = false;\n\t\tdelete this.model[this.hash];\n\t}\n}\n\nBindingGroup.prototype.rebind = Binding.prototype.rebind;\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\n\nconst push = [].push;\n\nfunction getValue() {\n\tconst all = this.bindings.filter(b => b.node && b.node.checked).map(b => b.element.getAttribute( 'value' ));\n\tconst res = [];\n\tall.forEach(v => { if ( !this.bindings[0].arrayContains( res, v ) ) res.push( v ); });\n\treturn res;\n}\n\nexport default class CheckboxNameBinding extends Binding {\n\tconstructor ( element ) {\n\t\tsuper( element, 'name' );\n\n\t\tthis.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n\t\t// Each input has a reference to an array containing it and its\n\t\t// group, as two-way binding depends on being able to ascertain\n\t\t// the status of all inputs within the group\n\t\tthis.group = getBindingGroup( 'checkboxes', this.model, getValue );\n\t\tthis.group.add( this );\n\n\t\tif ( this.noInitialValue ) {\n\t\t\tthis.group.noInitialValue = true;\n\t\t}\n\n\t\t// If no initial value was set, and this input is checked, we\n\t\t// update the model\n\t\tif ( this.group.noInitialValue && this.element.getAttribute( 'checked' ) ) {\n\t\t\tconst existingValue = this.model.get();\n\t\t\tconst bindingValue = this.element.getAttribute( 'value' );\n\n\t\t\tif ( !this.arrayContains( existingValue, bindingValue ) ) {\n\t\t\t\tpush.call( existingValue, bindingValue ); // to avoid triggering runloop with array adaptor\n\t\t\t}\n\t\t}\n\t}\n\n\tbind () {\n\t\tif ( !this.group.bound ) {\n\t\t\tthis.group.bind();\n\t\t}\n\t}\n\n\tgetInitialValue () {\n\t\t// This only gets called once per group (of inputs that\n\t\t// share a name), because it only gets called if there\n\t\t// isn't an initial value. By the same token, we can make\n\t\t// a note of that fact that there was no initial value,\n\t\t// and populate it using any `checked` attributes that\n\t\t// exist (which users should avoid, but which we should\n\t\t// support anyway to avoid breaking expectations)\n\t\tthis.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\n\t\treturn [];\n\t}\n\n\tgetValue () {\n\t\treturn this.group.value;\n\t}\n\n\thandleChange () {\n\t\tthis.isChecked = this.element.node.checked;\n\t\tthis.group.value = this.model.get();\n\t\tconst value = this.element.getAttribute( 'value' );\n\t\tif ( this.isChecked && !this.arrayContains( this.group.value, value ) ) {\n\t\t\tthis.group.value.push( value );\n\t\t} else if ( !this.isChecked && this.arrayContains( this.group.value, value ) ) {\n\t\t\tthis.removeFromArray( this.group.value, value );\n\t\t}\n\t\t// make sure super knows there's a change\n\t\tthis.lastValue = null;\n\t\tsuper.handleChange();\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\tconst node = this.node;\n\n\t\tconst existingValue = this.model.get();\n\t\tconst bindingValue = this.element.getAttribute( 'value' );\n\n\t\tif ( Array.isArray( existingValue ) ) {\n\t\t\tthis.isChecked = this.arrayContains( existingValue, bindingValue );\n\t\t} else {\n\t\t\tthis.isChecked = this.element.compare( existingValue, bindingValue );\n\t\t}\n\t\tnode.name = '{{' + this.model.getKeypath() + '}}';\n\t\tnode.checked = this.isChecked;\n\n\t\tthis.element.on( 'change', handleDomEvent );\n\n\t\t// in case of IE emergency, bind to click event as well\n\t\tif ( this.node.attachEvent ) {\n\t\t\tthis.element.on( 'click', handleDomEvent );\n\t\t}\n\t}\n\n\tsetFromNode ( node ) {\n\t\tthis.group.bindings.forEach( binding => binding.wasUndefined = true );\n\n\t\tif ( node.checked ) {\n\t\t\tconst valueSoFar = this.group.getValue();\n\t\t\tvalueSoFar.push( this.element.getAttribute( 'value' ) );\n\n\t\t\tthis.group.model.set( valueSoFar );\n\t\t}\n\t}\n\n\tunbind () {\n\t\tthis.group.remove( this );\n\t}\n\n\tunrender () {\n\t\tconst el = this.element;\n\n\t\tel.off( 'change', handleDomEvent );\n\t\tel.off( 'click', handleDomEvent );\n\t}\n\n\tarrayContains ( selectValue, optionValue ) {\n\t\tlet i = selectValue.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( this.element.compare( optionValue, selectValue[i] ) ) return true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tremoveFromArray ( array, item ) {\n\t\tif (!array) return;\n\t\tlet i = array.length;\n\t\twhile( i-- ) {\n\t\t\tif ( this.element.compare( item, array[i] ) ) {\n\t\t\t\tarray.splice( i, 1 );\n\t\t\t}\n\t\t}\n\t}\n}\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class ContentEditableBinding extends Binding {\n\tgetInitialValue () {\n\t\treturn this.element.fragment ? this.element.fragment.toString() : '';\n\t}\n\n\tgetValue () {\n\t\treturn this.element.node.innerHTML;\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\tconst el = this.element;\n\n\t\tel.on( 'change', handleDomEvent );\n\t\tel.on( 'blur', handleDomEvent );\n\n\t\tif ( !this.ractive.lazy ) {\n\t\t\tel.on( 'input', handleDomEvent );\n\n\t\t\tif ( this.node.attachEvent ) {\n\t\t\t\tel.on( 'keyup', handleDomEvent );\n\t\t\t}\n\t\t}\n\t}\n\n\tsetFromNode ( node ) {\n\t\tthis.model.set( node.innerHTML );\n\t}\n\n\tunrender () {\n\t\tconst el = this.element;\n\n\t\tel.off( 'blur', handleDomEvent );\n\t\tel.off( 'change', handleDomEvent );\n\t\tel.off( 'input', handleDomEvent );\n\t\tel.off( 'keyup', handleDomEvent );\n\t}\n}\n","import KeyModel from './specials/KeyModel';\nimport KeypathModel from './specials/KeypathModel';\nimport { escapeKey, unescapeKey } from '../shared/keypaths';\nimport { handleChange } from '../shared/methodCallers';\nimport { addToArray, removeFromArray } from '../utils/array';\nimport { isObject } from '../utils/is';\nimport bind from '../utils/bind';\n\nconst hasProp = Object.prototype.hasOwnProperty;\n\nconst shuffleTasks = { early: [], mark: [] };\nconst registerQueue = { early: [], mark: [] };\n\nexport default class ModelBase {\n\tconstructor ( parent ) {\n\t\tthis.deps = [];\n\n\t\tthis.children = [];\n\t\tthis.childByKey = {};\n\t\tthis.links = [];\n\n\t\tthis.keyModels = {};\n\n\t\tthis.bindings = [];\n\t\tthis.patternObservers = [];\n\n\t\tif ( parent ) {\n\t\t\tthis.parent = parent;\n\t\t\tthis.root = parent.root;\n\t\t}\n\t}\n\n\taddShuffleTask ( task, stage = 'early' ) { shuffleTasks[stage].push( task ); }\n\taddShuffleRegister ( item, stage = 'early' ) { registerQueue[stage].push({ model: this, item }); }\n\n\tfindMatches ( keys ) {\n\t\tconst len = keys.length;\n\n\t\tlet existingMatches = [ this ];\n\t\tlet matches;\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tconst key = keys[i];\n\n\t\t\tif ( key === '*' ) {\n\t\t\t\tmatches = [];\n\t\t\t\texistingMatches.forEach( model => {\n\t\t\t\t\tmatches.push.apply( matches, model.getValueChildren( model.get() ) );\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tmatches = existingMatches.map( model => model.joinKey( key ) );\n\t\t\t}\n\n\t\t\texistingMatches = matches;\n\t\t}\n\n\t\treturn matches;\n\t}\n\n\tgetKeyModel ( key, skip ) {\n\t\tif ( key !== undefined && !skip ) return this.parent.getKeyModel( key, true );\n\n\t\tif ( !( key in this.keyModels ) ) this.keyModels[ key ] = new KeyModel( escapeKey( key ), this );\n\n\t\treturn this.keyModels[ key ];\n\t}\n\n\tgetKeypath ( ractive ) {\n\t\tif ( ractive !== this.ractive && this._link ) return this._link.target.getKeypath( ractive );\n\n\t\tif ( !this.keypath ) {\n\t\t\tconst parent = this.parent && this.parent.getKeypath( ractive );\n\t\t\tthis.keypath = parent ? `${this.parent.getKeypath( ractive )}.${escapeKey( this.key )}` : escapeKey( this.key );\n\t\t}\n\n\t\treturn this.keypath;\n\t}\n\n\tgetValueChildren ( value ) {\n\t\tlet children;\n\t\tif ( Array.isArray( value ) ) {\n\t\t\tchildren = [];\n\t\t\tif ( 'length' in this && this.length !== value.length ) {\n\t\t\t\tchildren.push( this.joinKey( 'length' ) );\n\t\t\t}\n\t\t\tvalue.forEach( ( m, i ) => {\n\t\t\t\tchildren.push( this.joinKey( i ) );\n\t\t\t});\n\t\t}\n\n\t\telse if ( isObject( value ) || typeof value === 'function' ) {\n\t\t\tchildren = Object.keys( value ).map( key => this.joinKey( key ) );\n\t\t}\n\n\t\telse if ( value != null ) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tgetVirtual ( shouldCapture ) {\n\t\tconst value = this.get( shouldCapture, { virtual: false } );\n\t\tif ( isObject( value ) ) {\n\t\t\tconst result = Array.isArray( value ) ? [] : {};\n\n\t\t\tconst keys = Object.keys( value );\n\t\t\tlet i = keys.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tconst child = this.childByKey[ keys[i] ];\n\t\t\t\tif ( !child ) result[ keys[i] ] = value[ keys[i] ];\n\t\t\t\telse if ( child._link ) result[ keys[i] ] = child._link.getVirtual();\n\t\t\t\telse result[ keys[i] ] = child.getVirtual();\n\t\t\t}\n\n\t\t\ti = this.children.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tconst child = this.children[i];\n\t\t\t\tif ( !( child.key in result ) && child._link ) {\n\t\t\t\t\tresult[ child.key ] = child._link.getVirtual();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t} else return value;\n\t}\n\n\thas ( key ) {\n\t\tif ( this._link ) return this._link.has( key );\n\n\t\tconst value = this.get();\n\t\tif ( !value ) return false;\n\n\t\tkey = unescapeKey( key );\n\t\tif ( hasProp.call( value, key ) ) return true;\n\n\t\t// We climb up the constructor chain to find if one of them contains the key\n\t\tlet constructor = value.constructor;\n\t\twhile ( constructor !== Function && constructor !== Array && constructor !== Object ) {\n\t\t\tif ( hasProp.call( constructor.prototype, key ) ) return true;\n\t\t\tconstructor = constructor.constructor;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tjoinAll ( keys, opts ) {\n\t\tlet model = this;\n\t\tfor ( let i = 0; i < keys.length; i += 1 ) {\n\t\t\tif ( opts && opts.lastLink === false && i + 1 === keys.length && model.childByKey[keys[i]] && model.childByKey[keys[i]]._link ) return model.childByKey[keys[i]];\n\t\t\tmodel = model.joinKey( keys[i], opts );\n\t\t}\n\n\t\treturn model;\n\t}\n\n\tnotifyUpstream ( startPath ) {\n\t\tlet parent = this.parent;\n\t\tconst path = startPath || [ this.key ];\n\t\twhile ( parent ) {\n\t\t\tif ( parent.patternObservers.length ) parent.patternObservers.forEach( o => o.notify( path.slice() ) );\n\t\t\tpath.unshift( parent.key );\n\t\t\tparent.links.forEach( l => l.notifiedUpstream( path, this.root ) );\n\t\t\tparent.deps.forEach( handleChange );\n\t\t\tparent = parent.parent;\n\t\t}\n\t}\n\n\trebind ( next, previous, safe ) {\n\t\t// tell the deps to move to the new target\n\t\tlet i = this.deps.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( this.deps[i].rebind ) this.deps[i].rebind( next, previous, safe );\n\t\t}\n\n\t\ti = this.links.length;\n\t\twhile ( i-- ) {\n\t\t\tconst link = this.links[i];\n\t\t\t// only relink the root of the link tree\n\t\t\tif ( link.owner._link ) link.relinking( next, safe );\n\t\t}\n\n\t\ti = this.children.length;\n\t\twhile ( i-- ) {\n\t\t\tconst child = this.children[i];\n\t\t\tchild.rebind( next ? next.joinKey( child.key ) : undefined, child, safe );\n\t\t}\n\n\t\tif ( this.keypathModel ) this.keypathModel.rebind( next, previous, false );\n\n\t\ti = this.bindings.length;\n\t\twhile ( i-- ) {\n\t\t\tthis.bindings[i].rebind( next, previous, safe );\n\t\t}\n\t}\n\n\treference () {\n\t\t'refs' in this ? this.refs++ : this.refs = 1;\n\t}\n\n\tregister ( dep ) {\n\t\tthis.deps.push( dep );\n\t}\n\n\tregisterLink ( link ) {\n\t\taddToArray( this.links, link );\n\t}\n\n\tregisterPatternObserver ( observer ) {\n\t\tthis.patternObservers.push( observer );\n\t\tthis.register( observer );\n\t}\n\n\tregisterTwowayBinding ( binding ) {\n\t\tthis.bindings.push( binding );\n\t}\n\n\tunreference () {\n\t\tif ( 'refs' in this ) this.refs--;\n\t}\n\n\tunregister ( dep ) {\n\t\tremoveFromArray( this.deps, dep );\n\t}\n\n\tunregisterLink ( link ) {\n\t\tremoveFromArray( this.links, link );\n\t}\n\n\tunregisterPatternObserver ( observer ) {\n\t\tremoveFromArray( this.patternObservers, observer );\n\t\tthis.unregister( observer );\n\t}\n\n\tunregisterTwowayBinding ( binding ) {\n\t\tremoveFromArray( this.bindings, binding );\n\t}\n\n\tupdateFromBindings ( cascade ) {\n\t\tlet i = this.bindings.length;\n\t\twhile ( i-- ) {\n\t\t\tconst value = this.bindings[i].getValue();\n\t\t\tif ( value !== this.value ) this.set( value );\n\t\t}\n\n\t\t// check for one-way bindings if there are no two-ways\n\t\tif ( !this.bindings.length ) {\n\t\t\tconst oneway = findBoundValue( this.deps );\n\t\t\tif ( oneway && oneway.value !== this.value ) this.set( oneway.value );\n\t\t}\n\n\t\tif ( cascade ) {\n\t\t\tthis.children.forEach( updateFromBindings );\n\t\t\tthis.links.forEach( updateFromBindings );\n\t\t\tif ( this._link ) this._link.updateFromBindings( cascade );\n\t\t}\n\t}\n}\n\n// TODO: this may be better handled by overreiding `get` on models with a parent that isRoot\nexport function maybeBind ( model, value, shouldBind ) {\n\tif ( shouldBind && typeof value === 'function' && model.parent && model.parent.isRoot ) {\n\t\tif ( !model.boundValue ) {\n\t\t\tmodel.boundValue = bind( value._r_unbound || value, model.parent.ractive );\n\t\t}\n\n\t\treturn model.boundValue;\n\t}\n\n\treturn value;\n}\n\nfunction updateFromBindings ( model ) {\n\tmodel.updateFromBindings( true );\n}\n\nexport function findBoundValue( list ) {\n\tlet i = list.length;\n\twhile ( i-- ) {\n\t\tif ( list[i].bound ) {\n\t\t\tconst owner = list[i].owner;\n\t\t\tif ( owner ) {\n\t\t\t\tconst value = owner.name === 'checked' ?\n\t\t\t\t\towner.node.checked :\n\t\t\t\t\towner.node.value;\n\t\t\t\treturn { value };\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function fireShuffleTasks ( stage ) {\n\tif ( !stage ) {\n\t\tfireShuffleTasks( 'early' );\n\t\tfireShuffleTasks( 'mark' );\n\t} else {\n\t\tconst tasks = shuffleTasks[stage];\n\t\tshuffleTasks[stage] = [];\n\t\tlet i = tasks.length;\n\t\twhile ( i-- ) tasks[i]();\n\n\t\tconst register = registerQueue[stage];\n\t\tregisterQueue[stage] = [];\n\t\ti = register.length;\n\t\twhile ( i-- ) register[i].model.register( register[i].item );\n\t}\n}\n\nexport function shuffle ( model, newIndices, link, unsafe ) {\n\tmodel.shuffling = true;\n\n\tlet i = newIndices.length;\n\twhile ( i-- ) {\n\t\tconst idx = newIndices[ i ];\n\t\t// nothing is actually changing, so move in the index and roll on\n\t\tif ( i === idx ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// rebind the children on i to idx\n\t\tif ( i in model.childByKey ) model.childByKey[ i ].rebind( !~idx ? undefined : model.joinKey( idx ), model.childByKey[ i ], !unsafe );\n\n\t\tif ( !~idx && model.keyModels[ i ] ) {\n\t\t\tmodel.keyModels[i].rebind( undefined, model.keyModels[i], false );\n\t\t} else if ( ~idx && model.keyModels[ i ] ) {\n\t\t\tif ( !model.keyModels[ idx ] ) model.childByKey[ idx ].getKeyModel( idx );\n\t\t\tmodel.keyModels[i].rebind( model.keyModels[ idx ], model.keyModels[i], false );\n\t\t}\n\t}\n\n\tconst upstream = model.source().length !== model.source().value.length;\n\n\tmodel.links.forEach( l => l.shuffle( newIndices ) );\n\tif ( !link ) fireShuffleTasks( 'early' );\n\n\ti = model.deps.length;\n\twhile ( i-- ) {\n\t\tif ( model.deps[i].shuffle ) model.deps[i].shuffle( newIndices );\n\t}\n\n\tmodel[ link ? 'marked' : 'mark' ]();\n\tif ( !link ) fireShuffleTasks( 'mark' );\n\n\tif ( upstream ) model.notifyUpstream();\n\n\tmodel.shuffling = false;\n}\n\nKeyModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\nKeyModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\nKeypathModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\nKeypathModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\n","import ModelBase, { fireShuffleTasks, maybeBind, shuffle } from './ModelBase';\nimport KeypathModel from './specials/KeypathModel';\nimport { capture } from '../global/capture';\nimport { handleChange, marked, markedAll, teardown } from '../shared/methodCallers';\nimport { rebindMatch } from '../shared/rebind';\nimport resolveReference from '../view/resolvers/resolveReference';\nimport noop from '../utils/noop';\n\n// temporary placeholder target for detached implicit links\nexport const Missing = {\n\tkey: '@missing',\n\tanimate: noop,\n\tapplyValue: noop,\n\tget: noop,\n\tgetKeypath () { return this.key; },\n\tjoinAll () { return this; },\n\tjoinKey () { return this; },\n\tmark: noop,\n\tregisterLink: noop,\n\tshufle: noop,\n\tset: noop,\n\tunregisterLink: noop\n};\nMissing.parent = Missing;\n\nexport default class LinkModel extends ModelBase {\n\tconstructor ( parent, owner, target, key ) {\n\t\tsuper( parent );\n\n\t\tthis.owner = owner;\n\t\tthis.target = target;\n\t\tthis.key = key === undefined ? owner.key : key;\n\t\tif ( owner.isLink ) this.sourcePath = `${owner.sourcePath}.${this.key}`;\n\n\t\ttarget.registerLink( this );\n\n\t\tif ( parent ) this.isReadonly = parent.isReadonly;\n\n\t\tthis.isLink = true;\n\t}\n\n\tanimate ( from, to, options, interpolator ) {\n\t\treturn this.target.animate( from, to, options, interpolator );\n\t}\n\n\tapplyValue ( value ) {\n\t\tif ( this.boundValue ) this.boundValue = null;\n\t\tthis.target.applyValue( value );\n\t}\n\n\tattach ( fragment ) {\n\t\tconst model = resolveReference( fragment, this.key );\n\t\tif ( model ) {\n\t\t\tthis.relinking( model, false );\n\t\t} else { // if there is no link available, move everything here to real models\n\t\t\tthis.owner.unlink();\n\t\t}\n\t}\n\n\tdetach () {\n\t\tthis.relinking( Missing, false );\n\t}\n\n\tget ( shouldCapture, opts = {} ) {\n\t\tif ( shouldCapture ) {\n\t\t\tcapture( this );\n\n\t\t\t// may need to tell the target to unwrap\n\t\t\topts.unwrap = true;\n\t\t}\n\n\t\tconst bind = 'shouldBind' in opts ? opts.shouldBind : true;\n\t\topts.shouldBind = false;\n\n\t\treturn maybeBind( this, this.target.get( false, opts ), bind );\n\t}\n\n\tgetKeypath ( ractive ) {\n\t\tif ( ractive && ractive !== this.root.ractive ) return this.target.getKeypath( ractive );\n\n\t\treturn super.getKeypath( ractive );\n\t}\n\n\tgetKeypathModel ( ractive ) {\n\t\tif ( !this.keypathModel ) this.keypathModel = new KeypathModel( this );\n\t\tif ( ractive && ractive !== this.root.ractive ) return this.keypathModel.getChild( ractive );\n\t\treturn this.keypathModel;\n\t}\n\n\thandleChange () {\n\t\tthis.deps.forEach( handleChange );\n\t\tthis.links.forEach( handleChange );\n\t\tthis.notifyUpstream();\n\t}\n\n\tisDetached () { return this.virtual && this.target === Missing; }\n\n\tjoinKey ( key ) {\n\t\t// TODO: handle nested links\n\t\tif ( key === undefined || key === '' ) return this;\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tconst child = new LinkModel( this, this, this.target.joinKey( key ), key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t}\n\n\tmark ( force ) {\n\t\tthis.target.mark( force );\n\t}\n\n\tmarked () {\n\t\tif ( this.boundValue ) this.boundValue = null;\n\n\t\tthis.links.forEach( marked );\n\n\t\tthis.deps.forEach( handleChange );\n\t}\n\n\tmarkedAll () {\n\t\tthis.children.forEach( markedAll );\n\t\tthis.marked();\n\t}\n\n\tnotifiedUpstream ( startPath, root ) {\n\t\tthis.links.forEach( l => l.notifiedUpstream( startPath, this.root ) );\n\t\tthis.deps.forEach( handleChange );\n\t\tif ( startPath && this.rootLink && this.root !== root ) {\n\t\t\tconst path = startPath.slice( 1 );\n\t\t\tpath.unshift( this.key );\n\t\t\tthis.notifyUpstream( path );\n\t\t}\n\t}\n\n\trelinked () {\n\t\tthis.target.registerLink( this );\n\t\tthis.children.forEach( c => c.relinked() );\n\t}\n\n\trelinking ( target, safe ) {\n\t\tif ( this.rootLink && this.sourcePath ) target = rebindMatch( this.sourcePath, target, this.target );\n\t\tif ( !target || this.target === target ) return;\n\n\t\tthis.target.unregisterLink( this );\n\t\tif ( this.keypathModel ) this.keypathModel.rebindChildren( target );\n\n\t\tthis.target = target;\n\t\tthis.children.forEach( c => {\n\t\t\tc.relinking( target.joinKey( c.key ), safe );\n\t\t});\n\n\t\tif ( this.rootLink ) this.addShuffleTask( () => {\n\t\t\tthis.relinked();\n\t\t\tif ( !safe ) {\n\t\t\t\tthis.markedAll();\n\t\t\t\tthis.notifyUpstream();\n\t\t\t}\n\t\t});\n\t}\n\n\tset ( value ) {\n\t\tif ( this.boundValue ) this.boundValue = null;\n\t\tthis.target.set( value );\n\t}\n\n\tshuffle ( newIndices ) {\n\t\t// watch for extra shuffles caused by a shuffle in a downstream link\n\t\tif ( this.shuffling ) return;\n\n\t\t// let the real model handle firing off shuffles\n\t\tif ( !this.target.shuffling ) {\n\t\t\tthis.target.shuffle( newIndices );\n\t\t} else {\n\t\t\tshuffle( this, newIndices, true );\n\t\t}\n\n\t}\n\n\tsource () {\n\t\tif ( this.target.source ) return this.target.source();\n\t\telse return this.target;\n\t}\n\n\tteardown () {\n\t\tif ( this._link ) this._link.teardown();\n\t\tthis.target.unregisterLink( this );\n\t\tthis.children.forEach( teardown );\n\t}\n}\n\nModelBase.prototype.link = function link ( model, keypath, options ) {\n\tconst lnk = this._link || new LinkModel( this.parent, this, model, this.key );\n\tlnk.implicit = options && options.implicit;\n\tlnk.sourcePath = keypath;\n\tlnk.rootLink = true;\n\tif ( this._link ) this._link.relinking( model, false );\n\tthis.rebind( lnk, this, false );\n\tfireShuffleTasks();\n\n\tthis._link = lnk;\n\tlnk.markedAll();\n\n\tthis.notifyUpstream();\n\treturn lnk;\n};\n\nModelBase.prototype.unlink = function unlink () {\n\tif ( this._link ) {\n\t\tconst ln = this._link;\n\t\tthis._link = undefined;\n\t\tln.rebind( this, ln, false );\n\t\tfireShuffleTasks();\n\t\tln.teardown();\n\t\tthis.notifyUpstream();\n\t}\n};\n","import runloop from '../global/runloop';\n\n// TODO what happens if a transition is aborted?\n\nconst tickers = [];\nlet running = false;\n\nfunction tick () {\n\trunloop.start();\n\n\tconst now = performance.now();\n\n\tlet i;\n\tlet ticker;\n\n\tfor ( i = 0; i < tickers.length; i += 1 ) {\n\t\tticker = tickers[i];\n\n\t\tif ( !ticker.tick( now ) ) {\n\t\t\t// ticker is complete, remove it from the stack, and decrement i so we don't miss one\n\t\t\ttickers.splice( i--, 1 );\n\t\t}\n\t}\n\n\trunloop.end();\n\n\tif ( tickers.length ) {\n\t\trequestAnimationFrame( tick );\n\t} else {\n\t\trunning = false;\n\t}\n}\n\nexport default class Ticker {\n\tconstructor ( options ) {\n\t\tthis.duration = options.duration;\n\t\tthis.step = options.step;\n\t\tthis.complete = options.complete;\n\t\tthis.easing = options.easing;\n\n\t\tthis.start = performance.now();\n\t\tthis.end = this.start + this.duration;\n\n\t\tthis.running = true;\n\n\t\ttickers.push( this );\n\t\tif ( !running ) requestAnimationFrame( tick );\n\t}\n\n\ttick ( now ) {\n\t\tif ( !this.running ) return false;\n\n\t\tif ( now > this.end ) {\n\t\t\tif ( this.step ) this.step( 1 );\n\t\t\tif ( this.complete ) this.complete( 1 );\n\n\t\t\treturn false;\n\t\t}\n\n\t\tconst elapsed = now - this.start;\n\t\tconst eased = this.easing( elapsed / this.duration );\n\n\t\tif ( this.step ) this.step( eased );\n\n\t\treturn true;\n\t}\n\n\tstop () {\n\t\tif ( this.abort ) this.abort();\n\t\tthis.running = false;\n\t}\n}\n","const prefixers = {};\n\n// TODO this is legacy. sooner we can replace the old adaptor API the better\nfunction prefixKeypath ( obj, prefix ) {\n\tconst prefixed = {};\n\n\tif ( !prefix ) {\n\t\treturn obj;\n\t}\n\n\tprefix += '.';\n\n\tfor ( const key in obj ) {\n\t\tif ( obj.hasOwnProperty( key ) ) {\n\t\t\tprefixed[ prefix + key ] = obj[ key ];\n\t\t}\n\t}\n\n\treturn prefixed;\n}\n\nexport default function getPrefixer ( rootKeypath ) {\n\tlet rootDot;\n\n\tif ( !prefixers[ rootKeypath ] ) {\n\t\trootDot = rootKeypath ? rootKeypath + '.' : '';\n\n\t\tprefixers[ rootKeypath ] = function ( relativeKeypath, value ) {\n\t\t\tlet obj;\n\n\t\t\tif ( typeof relativeKeypath === 'string' ) {\n\t\t\t\tobj = {};\n\t\t\t\tobj[ rootDot + relativeKeypath ] = value;\n\t\t\t\treturn obj;\n\t\t\t}\n\n\t\t\tif ( typeof relativeKeypath === 'object' ) {\n\t\t\t\t// 'relativeKeypath' is in fact a hash, not a keypath\n\t\t\t\treturn rootDot ? prefixKeypath( relativeKeypath, rootKeypath ) : relativeKeypath;\n\t\t\t}\n\t\t};\n\t}\n\n\treturn prefixers[ rootKeypath ];\n}\n","import ModelBase, { maybeBind, shuffle } from './ModelBase';\nimport LinkModel from './LinkModel'; // eslint-disable-line no-unused-vars\nimport KeypathModel from './specials/KeypathModel';\nimport { capture } from '../global/capture';\nimport { isEqual, isNumeric, isObjectLike } from '../utils/is';\nimport { handleChange, mark, markForce, marked, teardown } from '../shared/methodCallers';\nimport Ticker from '../shared/Ticker';\nimport getPrefixer from './helpers/getPrefixer';\nimport { unescapeKey } from '../shared/keypaths';\nimport { warnIfDebug } from '../utils/log';\n\nexport default class Model extends ModelBase {\n\tconstructor ( parent, key ) {\n\t\tsuper( parent );\n\n\t\tthis.ticker = null;\n\n\t\tif ( parent ) {\n\t\t\tthis.key = unescapeKey( key );\n\t\t\tthis.isReadonly = parent.isReadonly;\n\n\t\t\tif ( parent.value ) {\n\t\t\t\tthis.value = parent.value[ this.key ];\n\t\t\t\tif ( Array.isArray( this.value ) ) this.length = this.value.length;\n\t\t\t\tthis.adapt();\n\t\t\t}\n\t\t}\n\t}\n\n\tadapt () {\n\t\tconst adaptors = this.root.adaptors;\n\t\tconst len = adaptors.length;\n\n\t\tthis.rewrap = false;\n\n\t\t// Exit early if no adaptors\n\t\tif ( len === 0 ) return;\n\n\t\tconst value = this.wrapper ? ( 'newWrapperValue' in this ? this.newWrapperValue : this.wrapperValue ) : this.value;\n\n\t\t// TODO remove this legacy nonsense\n\t\tconst ractive = this.root.ractive;\n\t\tconst keypath = this.getKeypath();\n\n\t\t// tear previous adaptor down if present\n\t\tif ( this.wrapper ) {\n\t\t\tconst shouldTeardown = this.wrapperValue === value ? false : !this.wrapper.reset || this.wrapper.reset( value ) === false;\n\n\t\t\tif ( shouldTeardown ) {\n\t\t\t\tthis.wrapper.teardown();\n\t\t\t\tthis.wrapper = null;\n\n\t\t\t\t// don't branch for undefined values\n\t\t\t\tif ( this.value !== undefined ) {\n\t\t\t\t\tconst parentValue = this.parent.value || this.parent.createBranch( this.key );\n\t\t\t\t\tif ( parentValue[ this.key ] !== value ) parentValue[ this.key ] = value;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdelete this.newWrapperValue;\n\t\t\t\tthis.wrapperValue = value;\n\t\t\t\tthis.value = this.wrapper.get();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tconst adaptor = adaptors[i];\n\t\t\tif ( adaptor.filter( value, keypath, ractive ) ) {\n\t\t\t\tthis.wrapper = adaptor.wrap( ractive, value, keypath, getPrefixer( keypath ) );\n\t\t\t\tthis.wrapperValue = value;\n\t\t\t\tthis.wrapper.__model = this; // massive temporary hack to enable array adaptor\n\n\t\t\t\tthis.value = this.wrapper.get();\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tanimate ( from, to, options, interpolator ) {\n\t\tif ( this.ticker ) this.ticker.stop();\n\n\t\tlet fulfilPromise;\n\t\tconst promise = new Promise( fulfil => fulfilPromise = fulfil );\n\n\t\tthis.ticker = new Ticker({\n\t\t\tduration: options.duration,\n\t\t\teasing: options.easing,\n\t\t\tstep: t => {\n\t\t\t\tconst value = interpolator( t );\n\t\t\t\tthis.applyValue( value );\n\t\t\t\tif ( options.step ) options.step( t, value );\n\t\t\t},\n\t\t\tcomplete: () => {\n\t\t\t\tthis.applyValue( to );\n\t\t\t\tif ( options.complete ) options.complete( to );\n\n\t\t\t\tthis.ticker = null;\n\t\t\t\tfulfilPromise();\n\t\t\t}\n\t\t});\n\n\t\tpromise.stop = this.ticker.stop;\n\t\treturn promise;\n\t}\n\n\tapplyValue ( value, notify = true ) {\n\t\tif ( isEqual( value, this.value ) ) return;\n\t\tif ( this.boundValue ) this.boundValue = null;\n\n\t\tif ( this.parent.wrapper && this.parent.wrapper.set ) {\n\t\t\tthis.parent.wrapper.set( this.key, value );\n\t\t\tthis.parent.value = this.parent.wrapper.get();\n\n\t\t\tthis.value = this.parent.value[ this.key ];\n\t\t\tif ( this.wrapper ) this.newWrapperValue = this.value;\n\t\t\tthis.adapt();\n\t\t} else if ( this.wrapper ) {\n\t\t\tthis.newWrapperValue = value;\n\t\t\tthis.adapt();\n\t\t} else {\n\t\t\tconst parentValue = this.parent.value || this.parent.createBranch( this.key );\n\t\t\tif ( isObjectLike( parentValue ) ) {\n\t\t\t\tparentValue[ this.key ] = value;\n\t\t\t} else {\n\t\t\t\twarnIfDebug( `Attempted to set a property of a non-object '${this.getKeypath()}'` );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.value = value;\n\t\t\tthis.adapt();\n\t\t}\n\n\t\t// keep track of array stuff\n\t\tif ( Array.isArray( value ) ) {\n\t\t\tthis.length = value.length;\n\t\t\tthis.isArray = true;\n\t\t} else {\n\t\t\tthis.isArray = false;\n\t\t}\n\n\t\t// notify dependants\n\t\tthis.links.forEach( handleChange );\n\t\tthis.children.forEach( mark );\n\t\tthis.deps.forEach( handleChange );\n\n\t\tif ( notify ) this.notifyUpstream();\n\n\t\tif ( this.parent.isArray ) {\n\t\t\tif ( this.key === 'length' ) this.parent.length = value;\n\t\t\telse this.parent.joinKey( 'length' ).mark();\n\t\t}\n\t}\n\n\tcreateBranch ( key ) {\n\t\tconst branch = isNumeric( key ) ? [] : {};\n\t\tthis.applyValue( branch, false );\n\n\t\treturn branch;\n\t}\n\n\tget ( shouldCapture, opts ) {\n\t\tif ( this._link ) return this._link.get( shouldCapture, opts );\n\t\tif ( shouldCapture ) capture( this );\n\t\t// if capturing, this value needs to be unwrapped because it's for external use\n\t\tif ( opts && opts.virtual ) return this.getVirtual( false );\n\t\treturn maybeBind( this, ( ( opts && 'unwrap' in opts ) ? opts.unwrap !== false : shouldCapture ) && this.wrapper ? this.wrapperValue : this.value, !opts || opts.shouldBind !== false );\n\t}\n\n\tgetKeypathModel () {\n\t\tif ( !this.keypathModel ) this.keypathModel = new KeypathModel( this );\n\t\treturn this.keypathModel;\n\t}\n\n\tjoinKey ( key, opts ) {\n\t\tif ( this._link ) {\n\t\t\tif ( opts && opts.lastLink !== false && ( key === undefined || key === '' ) ) return this;\n\t\t\treturn this._link.joinKey( key );\n\t\t}\n\n\t\tif ( key === undefined || key === '' ) return this;\n\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tconst child = new Model( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\tif ( this.childByKey[ key ]._link && ( !opts || opts.lastLink !== false ) ) return this.childByKey[ key ]._link;\n\t\treturn this.childByKey[ key ];\n\t}\n\n\tmark ( force ) {\n\t\tif ( this._link ) return this._link.mark( force );\n\n\t\tconst value = this.retrieve();\n\n\t\tif ( force || !isEqual( value, this.value ) ) {\n\t\t\tconst old = this.value;\n\t\t\tthis.value = value;\n\t\t\tif ( this.boundValue ) this.boundValue = null;\n\n\t\t\t// make sure the wrapper stays in sync\n\t\t\tif ( old !== value || this.rewrap ) {\n\t\t\t\tif ( this.wrapper ) this.newWrapperValue = value;\n\t\t\t\tthis.adapt();\n\t\t\t}\n\n\t\t\t// keep track of array stuff\n\t\t\tif ( Array.isArray( value ) ) {\n\t\t\t\tthis.length = value.length;\n\t\t\t\tthis.isArray = true;\n\t\t\t} else {\n\t\t\t\tthis.isArray = false;\n\t\t\t}\n\n\t\t\tthis.children.forEach( force ? markForce : mark );\n\t\t\tthis.links.forEach( marked );\n\n\t\t\tthis.deps.forEach( handleChange );\n\t\t}\n\t}\n\n\tmerge ( array, comparator ) {\n\t\tlet oldArray = this.value;\n\t\tlet newArray = array;\n\t\tif ( oldArray === newArray ) oldArray = recreateArray( this );\n\t\tif ( comparator ) {\n\t\t\toldArray = oldArray.map( comparator );\n\t\t\tnewArray = newArray.map( comparator );\n\t\t}\n\n\t\tconst oldLength = oldArray.length;\n\n\t\tconst usedIndices = {};\n\t\tlet firstUnusedIndex = 0;\n\n\t\tconst newIndices = oldArray.map( item => {\n\t\t\tlet index;\n\t\t\tlet start = firstUnusedIndex;\n\n\t\t\tdo {\n\t\t\t\tindex = newArray.indexOf( item, start );\n\n\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tstart = index + 1;\n\t\t\t} while ( ( usedIndices[ index ] === true ) && start < oldLength );\n\n\t\t\t// keep track of the first unused index, so we don't search\n\t\t\t// the whole of newArray for each item in oldArray unnecessarily\n\t\t\tif ( index === firstUnusedIndex ) {\n\t\t\t\tfirstUnusedIndex += 1;\n\t\t\t}\n\t\t\t// allow next instance of next \"equal\" to be found item\n\t\t\tusedIndices[ index ] = true;\n\t\t\treturn index;\n\t\t});\n\n\t\tthis.parent.value[ this.key ] = array;\n\t\tthis.shuffle( newIndices, true );\n\t}\n\n\tretrieve () {\n\t\treturn this.parent.value ? this.parent.value[ this.key ] : undefined;\n\t}\n\n\tset ( value ) {\n\t\tif ( this.ticker ) this.ticker.stop();\n\t\tthis.applyValue( value );\n\t}\n\n\tshuffle ( newIndices, unsafe ) {\n\t\tshuffle( this, newIndices, false, unsafe );\n\t}\n\n\tsource () { return this; }\n\n\tteardown () {\n\t\tif ( this._link ) this._link.teardown();\n\t\tthis.children.forEach( teardown );\n\t\tif ( this.wrapper ) this.wrapper.teardown();\n\t\tif ( this.keypathModel ) this.keypathModel.teardown();\n\t}\n}\n\nfunction recreateArray( model ) {\n\tconst array = [];\n\n\tfor ( let i = 0; i < model.length; i++ ) {\n\t\tarray[ i ] = (model.childByKey[i] || {}).value;\n\t}\n\n\treturn array;\n}\n","/* global global */\nimport Model from '../Model';\n\nconst data = {};\n\nexport class SharedModel extends Model {\n\tconstructor ( value, name ) {\n\t\tsuper( null, `@${name}` );\n\t\tthis.key = `@${name}`;\n\t\tthis.value = value;\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.adaptors = [];\n\t}\n\n\tgetKeypath() {\n\t\treturn this.key;\n\t}\n}\n\nexport default new SharedModel( data, 'shared' );\n\nexport const GlobalModel = new SharedModel( typeof global !== 'undefined' ? global : window, 'global' );\n","import { splitKeypath } from '../../shared/keypaths';\nimport SharedModel, { GlobalModel } from '../../model/specials/SharedModel';\nimport { warnIfDebug } from '../../utils/log';\n\nexport default function resolveReference ( fragment, ref ) {\n\tconst initialFragment = fragment;\n\t// current context ref\n\tif ( ref === '.' ) return fragment.findContext();\n\n\t// ancestor references\n\tif ( ref[0] === '~' ) return fragment.ractive.viewmodel.joinAll( splitKeypath( ref.slice( 2 ) ) );\n\n\t// scoped references\n\tif ( ref[0] === '.' || ref[0] === '^' ) {\n\t\tlet frag = fragment;\n\t\tconst parts = ref.split( '/' );\n\t\tconst explicitContext = parts[0] === '^^';\n\t\tlet context = explicitContext ? null : fragment.findContext();\n\n\t\t// account for the first context hop\n\t\tif ( explicitContext ) parts.unshift( '^^' );\n\n\t\t// walk up the context chain\n\t\twhile ( parts[0] === '^^' ) {\n\t\t\tparts.shift();\n\t\t\tcontext = null;\n\t\t\twhile ( frag && !context ) {\n\t\t\t\tcontext = frag.context;\n\t\t\t\tfrag = frag.parent.component ? frag.parent.component.parentFragment : frag.parent;\n\t\t\t}\n\t\t}\n\n\t\tif ( !context && explicitContext ) {\n\t\t\tthrow new Error( `Invalid context parent reference ('${ref}'). There is not context at that level.` );\n\t\t}\n\n\t\t// walk up the context path\n\t\twhile ( parts[0] === '.' || parts[0] === '..' ) {\n\t\t\tconst part = parts.shift();\n\n\t\t\tif ( part === '..' ) {\n\t\t\t\tcontext = context.parent;\n\t\t\t}\n\t\t}\n\n\t\tref = parts.join( '/' );\n\n\t\t// special case - `{{.foo}}` means the same as `{{./foo}}`\n\t\tif ( ref[0] === '.' ) ref = ref.slice( 1 );\n\t\treturn context.joinAll( splitKeypath( ref ) );\n\t}\n\n\tconst keys = splitKeypath( ref );\n\tif ( !keys.length ) return;\n\tconst base = keys.shift();\n\n\t// special refs\n\tif ( base[0] === '@' ) {\n\t\t// shorthand from outside the template\n\t\t// @this referring to local ractive instance\n\t\tif ( base === '@this' || base === '@' ) {\n\t\t\treturn fragment.ractive.viewmodel.getRactiveModel().joinAll( keys );\n\t\t}\n\n\t\t// @index or @key referring to the nearest repeating index or key\n\t\telse if ( base === '@index' || base === '@key' ) {\n\t\t\tif ( keys.length ) badReference( base );\n\t\t\tconst repeater = fragment.findRepeatingFragment();\n\t\t\t// make sure the found fragment is actually an iteration\n\t\t\tif ( !repeater.isIteration ) return;\n\t\t\treturn repeater.context && repeater.context.getKeyModel( repeater[ ref[1] === 'i' ? 'index' : 'key' ] );\n\t\t}\n\n\t\t// @global referring to window or global\n\t\telse if ( base === '@global' ) {\n\t\t\treturn GlobalModel.joinAll( keys );\n\t\t}\n\n\t\t// @global referring to window or global\n\t\telse if ( base === '@shared' ) {\n\t\t\treturn SharedModel.joinAll( keys );\n\t\t}\n\n\t\t// @keypath or @rootpath, the current keypath string\n\t\telse if ( base === '@keypath' || base === '@rootpath' ) {\n\t\t\tconst root = ref[1] === 'r' ? fragment.ractive.root : null;\n\t\t\tlet context = fragment.findContext();\n\n\t\t\t// skip over component roots, which provide no context\n\t\t\twhile ( root && context.isRoot && context.ractive.component ) {\n\t\t\t\tcontext = context.ractive.component.parentFragment.findContext();\n\t\t\t}\n\n\t\t\treturn context.getKeypathModel( root );\n\t\t}\n\n\t\telse if ( base === '@context' ) {\n\t\t\treturn new ContextModel( fragment.getContext() );\n\t\t}\n\n\t\t// @context-local data\n\t\telse if ( base === '@local' ) {\n\t\t\treturn fragment.getContext()._data.joinAll( keys );\n\t\t}\n\n\t\t// nope\n\t\telse {\n\t\t\tthrow new Error( `Invalid special reference '${base}'` );\n\t\t}\n\t}\n\n\tconst context = fragment.findContext();\n\n\t// check immediate context for a match\n\tif ( context.has( base ) ) {\n\t\treturn context.joinKey( base ).joinAll( keys );\n\t}\n\n\t// walk up the fragment hierarchy looking for a matching ref, alias, or key in a context\n\tlet createMapping = false;\n\tconst shouldWarn = fragment.ractive.warnAboutAmbiguity;\n\n\twhile ( fragment ) {\n\t\t// repeated fragments\n\t\tif ( fragment.isIteration ) {\n\t\t\tif ( base === fragment.parent.keyRef ) {\n\t\t\t\tif ( keys.length ) badReference( base );\n\t\t\t\treturn fragment.context.getKeyModel( fragment.key );\n\t\t\t}\n\n\t\t\tif ( base === fragment.parent.indexRef ) {\n\t\t\t\tif ( keys.length ) badReference( base );\n\t\t\t\treturn fragment.context.getKeyModel( fragment.index );\n\t\t\t}\n\t\t}\n\n\t\t// alias node or iteration\n\t\tif ( fragment.aliases  && fragment.aliases.hasOwnProperty( base ) ) {\n\t\t\tconst model = fragment.aliases[ base ];\n\n\t\t\tif ( keys.length === 0 ) return model;\n\t\t\telse if ( typeof model.joinAll === 'function' ) {\n\t\t\t\treturn model.joinAll( keys );\n\t\t\t}\n\t\t}\n\n\t\t// check fragment context to see if it has the key we need\n\t\tif ( fragment.context && fragment.context.has( base ) ) {\n\t\t\t// this is an implicit mapping\n\t\t\tif ( createMapping ) {\n\t\t\t\tif ( shouldWarn ) warnIfDebug( `'${ref}' resolved but is ambiguous and will create a mapping to a parent component.` );\n\t\t\t\treturn context.root.createLink( base, fragment.context.joinKey( base ), base, { implicit: true }).joinAll( keys );\n\t\t\t}\n\n\t\t\tif ( shouldWarn ) warnIfDebug( `'${ref}' resolved but is ambiguous.` );\n\t\t\treturn fragment.context.joinKey( base ).joinAll( keys );\n\t\t}\n\n\t\tif ( ( fragment.componentParent || ( !fragment.parent && fragment.ractive.component ) ) && !fragment.ractive.isolated ) {\n\t\t\t// ascend through component boundary\n\t\t\tfragment = fragment.componentParent || fragment.ractive.component.parentFragment;\n\t\t\tcreateMapping = true;\n\t\t} else {\n\t\t\tfragment = fragment.parent;\n\t\t}\n\t}\n\n\t// if enabled, check the instance for a match\n\tif ( initialFragment.ractive.resolveInstanceMembers ) {\n\t\tconst model = initialFragment.ractive.viewmodel.getRactiveModel();\n\t\tif ( model.has( base ) ) {\n\t\t\treturn model.joinKey( base ).joinAll( keys );\n\t\t}\n\t}\n\n\tif ( shouldWarn ) {\n\t\twarnIfDebug( `'${ref}' is ambiguous and did not resolve.` );\n\t}\n\n\t// didn't find anything, so go ahead and create the key on the local model\n\treturn context.joinKey( base ).joinAll( keys );\n}\n\nfunction badReference ( key ) {\n\tthrow new Error( `An index or key reference (${key}) cannot have child properties` );\n}\n\nclass ContextModel {\n\tconstructor ( context ) {\n\t\tthis.context = context;\n\t}\n\n\tget () { return this.context; }\n}\n","import noop from '../utils/noop';\n\nexport const extern = {};\n\nexport default function getRactiveContext ( ractive, ...assigns ) {\n\tconst fragment = ractive.fragment || ractive._fakeFragment || ( ractive._fakeFragment = new FakeFragment( ractive ) );\n\treturn fragment.getContext.apply( fragment, assigns );\n}\n\nexport function getContext ( ...assigns ) {\n\tif ( !this.ctx ) this.ctx = new extern.Context( this );\n\tassigns.unshift( Object.create( this.ctx ) );\n\treturn Object.assign.apply( null, assigns );\n}\n\nexport class FakeFragment {\n\tconstructor ( ractive ) {\n\t\tthis.ractive = ractive;\n\t}\n\n\tfindContext () { return this.ractive.viewmodel; }\n}\nconst proto = FakeFragment.prototype;\nproto.getContext = getContext;\nproto.find = proto.findComponent = proto.findAll = proto.findAllComponents = noop;\n","import runloop from '../global/runloop';\nimport { splitKeypath } from './keypaths';\nimport { isObject } from '../utils/is';\nimport { warnIfDebug } from '../utils/log';\nimport resolveReference from '../view/resolvers/resolveReference';\nimport { FakeFragment } from './getRactiveContext';\n\nexport let keep = false;\n\nexport function set ( ractive, pairs, options ) {\n\tconst k = keep;\n\n\tconst deep = options && options.deep;\n\tconst shuffle = options && options.shuffle;\n\tconst promise = runloop.start( ractive, true );\n\tif ( options && 'keep' in options ) keep = options.keep;\n\n\tlet i = pairs.length;\n\twhile ( i-- ) {\n\t\tconst model = pairs[i][0];\n\t\tconst value = pairs[i][1];\n\t\tconst keypath = pairs[i][2];\n\n\t\tif ( !model ) {\n\t\t\trunloop.end();\n\t\t\tthrow new Error( `Failed to set invalid keypath '${ keypath }'` );\n\t\t}\n\n\t\tif ( deep ) deepSet( model, value );\n\t\telse if ( shuffle ) {\n\t\t\tlet array = value;\n\t\t\tconst target = model.get();\n\t\t\t// shuffle target array with itself\n\t\t\tif ( !array ) array = target;\n\n\t\t\tif ( !Array.isArray( target ) || !Array.isArray( array ) ) {\n\t\t\t\tthrow new Error( 'You cannot merge an array with a non-array' );\n\t\t\t}\n\n\t\t\tconst comparator = getComparator( shuffle );\n\t\t\tmodel.merge( array, comparator );\n\t\t} else model.set( value );\n\t}\n\n\trunloop.end();\n\n\tkeep = k;\n\n\treturn promise;\n}\n\nconst star = /\\*/;\nexport function gather ( ractive, keypath, base, isolated ) {\n\tif ( !base && ( keypath[0] === '.' || keypath[1] === '^' ) ) {\n\t\twarnIfDebug( `Attempted to set a relative keypath from a non-relative context. You can use a context object to set relative keypaths.` );\n\t\treturn [];\n\t}\n\n\tconst keys = splitKeypath( keypath );\n\tconst model = base || ractive.viewmodel;\n\n\tif ( star.test( keypath ) ) {\n\t\treturn model.findMatches( keys );\n\t} else {\n\t\tif ( model === ractive.viewmodel ) {\n\t\t\t// allow implicit mappings\n\t\t\tif ( ractive.component && !ractive.isolated && !model.has( keys[0] ) && keypath[0] !== '@' && keypath[0] && !isolated ) {\n\t\t\t\treturn [ resolveReference( ractive.fragment || new FakeFragment( ractive ), keypath ) ];\n\t\t\t} else {\n\t\t\t\treturn [ model.joinAll( keys ) ];\n\t\t\t}\n\t\t} else {\n\t\t\treturn [ model.joinAll( keys ) ];\n\t\t}\n\t}\n}\n\nexport function build ( ractive, keypath, value, isolated ) {\n\tconst sets = [];\n\n\t// set multiple keypaths in one go\n\tif ( isObject( keypath ) ) {\n\t\tfor ( const k in keypath ) {\n\t\t\tif ( keypath.hasOwnProperty( k ) ) {\n\t\t\t\tsets.push.apply( sets, gather( ractive, k, null, isolated ).map( m => [ m, keypath[k], k ] ) );\n\t\t\t}\n\t\t}\n\n\t}\n\t// set a single keypath\n\telse {\n\t\tsets.push.apply( sets, gather( ractive, keypath, null, isolated ).map( m => [ m, value, keypath ] ) );\n\t}\n\n\treturn sets;\n}\n\nconst deepOpts = { virtual: false };\nfunction deepSet( model, value ) {\n\tconst dest = model.get( false, deepOpts );\n\n\t// if dest doesn't exist, just set it\n\tif ( dest == null || typeof value !== 'object' ) return model.set( value );\n\tif ( typeof dest !== 'object' ) return model.set( value );\n\n\tfor ( const k in value ) {\n\t\tif ( value.hasOwnProperty( k ) ) {\n\t\t\tdeepSet( model.joinKey( k ), value[k] );\n\t\t}\n\t}\n}\n\nconst comparators = {};\nfunction getComparator ( option ) {\n\tif ( option === true ) return null; // use existing arrays\n\tif ( typeof option === 'function' ) return option;\n\n\tif ( typeof option === 'string' ) {\n\t\treturn comparators[ option ] || ( comparators[ option ] = thing => thing[ option ] );\n\t}\n\n\tthrow new Error( 'If supplied, options.compare must be a string, function, or true' ); // TODO link to docs\n}\n","import { isNumeric } from '../../../utils/is';\nimport { build, set } from '../../../shared/set';\n\nconst errorMessage = 'Cannot add to a non-numeric value';\n\nexport default function add ( ractive, keypath, d, options ) {\n\tif ( typeof keypath !== 'string' || !isNumeric( d ) ) {\n\t\tthrow new Error( 'Bad arguments' );\n\t}\n\n\tconst sets = build( ractive, keypath, d, options && options.isolated );\n\n\treturn set( ractive, sets.map( pair => {\n\t\tconst [ model, add ] = pair;\n\t\tconst value = model.get();\n\t\tif ( !isNumeric( add ) || !isNumeric( value ) ) throw new Error( errorMessage );\n\t\treturn [ model, value + add ];\n\t}));\n}\n","import runloop from '../../global/runloop';\nimport interpolate from '../../shared/interpolate';\nimport { isEqual } from '../../utils/is';\nimport { splitKeypath } from '../../shared/keypaths';\nimport easing from '../../Ractive/static/easing';\nimport noop from '../../utils/noop';\n\nconst noAnimation = Promise.resolve();\nObject.defineProperty( noAnimation, 'stop', { value: noop });\n\nconst linear = easing.linear;\n\nfunction getOptions ( options, instance ) {\n\toptions = options || {};\n\n\tlet easing;\n\tif ( options.easing ) {\n\t\teasing = typeof options.easing === 'function' ?\n\t\t\toptions.easing :\n\t\t\tinstance.easing[ options.easing ];\n\t}\n\n\treturn {\n\t\teasing: easing || linear,\n\t\tduration: 'duration' in options ? options.duration : 400,\n\t\tcomplete: options.complete || noop,\n\t\tstep: options.step || noop\n\t};\n}\n\nexport function animate ( ractive, model, to, options ) {\n\toptions = getOptions( options, ractive );\n\tconst from = model.get();\n\n\t// don't bother animating values that stay the same\n\tif ( isEqual( from, to ) ) {\n\t\toptions.complete( options.to );\n\t\treturn noAnimation; // TODO should this have .then and .catch methods?\n\t}\n\n\tconst interpolator = interpolate( from, to, ractive, options.interpolator );\n\n\t// if we can't interpolate the value, set it immediately\n\tif ( !interpolator ) {\n\t\trunloop.start();\n\t\tmodel.set( to );\n\t\trunloop.end();\n\n\t\treturn noAnimation;\n\t}\n\n\treturn model.animate( from, to, options, interpolator );\n}\n\nexport default function Ractive$animate ( keypath, to, options ) {\n\tif ( typeof keypath === 'object' ) {\n\t\tconst keys = Object.keys( keypath );\n\n\t\tthrow new Error( `ractive.animate(...) no longer supports objects. Instead of ractive.animate({\n  ${keys.map( key => `'${key}': ${keypath[ key ]}` ).join( '\\n  ' )}\n}, {...}), do\n\n${keys.map( key => `ractive.animate('${key}', ${keypath[ key ]}, {...});` ).join( '\\n' )}\n` );\n\t}\n\n\n\treturn animate( this, this.viewmodel.joinAll( splitKeypath( keypath ) ), to, options );\n}\n","import { enqueue, dequeue } from './eventStack';\n\nconst initStars = {};\nconst bubbleStars = {};\n\n// cartesian product of name parts and stars\n// adjusted appropriately for special cases\nfunction variants ( name, initial ) {\n\tconst map = initial ? initStars : bubbleStars;\n\tif ( map[ name ] ) return map[ name ];\n\n\tconst parts = name.split( '.' );\n\tconst result = [];\n\tlet base = false;\n\n\t// initial events the implicit namespace of 'this'\n\tif ( initial ) {\n\t\tparts.unshift( 'this' );\n\t\tbase = true;\n\t}\n\n\t// use max - 1 bits as a bitmap to pick a part or a *\n\t// need to skip the full star case if the namespace is synthetic\n\tconst max = Math.pow( 2, parts.length ) - ( initial ? 1 : 0 );\n\tfor ( let i = 0; i < max; i++ ) {\n\t\tconst join = [];\n\t\tfor ( let j = 0; j < parts.length; j++ ) {\n\t\t\tjoin.push( 1 & ( i >> j ) ? '*' : parts[j] );\n\t\t}\n\t\tresult.unshift( join.join( '.' ) );\n\t}\n\n\tif ( base ) {\n\t\t// include non-this-namespaced versions\n\t\tif ( parts.length > 2 ) {\n\t\t\tresult.push.apply( result, variants( name, false ) );\n\t\t} else {\n\t\t\tresult.push( '*' );\n\t\t\tresult.push( name );\n\t\t}\n\t}\n\n\tmap[ name ] = result;\n\treturn result;\n}\n\nexport default function fireEvent ( ractive, eventName, context, args = [] ) {\n\tif ( !eventName ) { return; }\n\n\tcontext.name = eventName;\n\targs.unshift( context );\n\n\tconst eventNames = ractive._nsSubs ? variants( eventName, true ) : [ '*', eventName ];\n\n\treturn fireEventAs( ractive, eventNames, context, args, true );\n}\n\nfunction fireEventAs  ( ractive, eventNames, context, args, initialFire = false ) {\n\tlet bubble = true;\n\n\tif ( initialFire || ractive._nsSubs ) {\n\t\tenqueue( ractive, context );\n\n\t\tlet i = eventNames.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( eventNames[ i ] in ractive._subs ) {\n\t\t\t\tbubble = notifySubscribers( ractive, ractive._subs[ eventNames[ i ] ], context, args ) && bubble;\n\t\t\t}\n\t\t}\n\n\t\tdequeue( ractive );\n\t}\n\n\tif ( ractive.parent && bubble ) {\n\t\tif ( initialFire && ractive.component ) {\n\t\t\tconst fullName = ractive.component.name + '.' + eventNames[ eventNames.length - 1 ];\n\t\t\teventNames = variants( fullName, false );\n\n\t\t\tif ( context && !context.component ) {\n\t\t\t\tcontext.component = ractive;\n\t\t\t}\n\t\t}\n\n\t\tbubble = fireEventAs( ractive.parent, eventNames, context, args );\n\t}\n\n\treturn bubble;\n}\n\nfunction notifySubscribers ( ractive, subscribers, context, args ) {\n\tlet originalEvent = null;\n\tlet stopEvent = false;\n\n\t// subscribers can be modified inflight, e.g. \"once\" functionality\n\t// so we need to copy to make sure everyone gets called\n\tsubscribers = subscribers.slice();\n\n\tfor ( let i = 0, len = subscribers.length; i < len; i += 1 ) {\n\t\tif ( !subscribers[ i ].off && subscribers[ i ].handler.apply( ractive, args ) === false ) {\n\t\t\tstopEvent = true;\n\t\t}\n\t}\n\n\tif ( context && stopEvent && ( originalEvent = context.event ) ) {\n\t\toriginalEvent.preventDefault && originalEvent.preventDefault();\n\t\toriginalEvent.stopPropagation && originalEvent.stopPropagation();\n\t}\n\n\treturn !stopEvent;\n}\n","import fireEvent from './fireEvent';\nimport getRactiveContext from '../shared/getRactiveContext';\n\nexport default class Hook {\n\tconstructor ( event ) {\n\t\tthis.event = event;\n\t\tthis.method = 'on' + event;\n\t}\n\n\tfire ( ractive, arg ) {\n\t\tconst context = getRactiveContext( ractive );\n\n\t\tif ( ractive[ this.method ] ) {\n\t\t\targ ? ractive[ this.method ]( context, arg ) : ractive[ this.method ]( context );\n\t\t}\n\n\t\tfireEvent( ractive, this.event, context, arg ? [ arg, ractive ] : [ ractive ] );\n\t}\n}\n","import Hook from '../../events/Hook';\nimport runloop from '../../global/runloop';\nimport { unrenderChild, updateAnchors } from '../../shared/anchors';\n\nconst attachHook = new Hook( 'attachchild' );\n\nexport default function attachChild ( child, options = {} ) {\n\tconst children = this._children;\n\n\tif ( child.parent && child.parent !== this ) throw new Error( `Instance ${child._guid} is already attached to a different instance ${child.parent._guid}. Please detach it from the other instance using detachChild first.` );\n\telse if ( child.parent ) throw new Error( `Instance ${child._guid} is already attached to this instance.` );\n\n\tconst meta = {\n\t\tinstance: child,\n\t\tractive: this,\n\t\tname: options.name || child.constructor.name || 'Ractive',\n\t\ttarget: options.target || false,\n\t\tbubble,\n\t\tfindNextNode\n\t};\n\tmeta.nameOption = options.name;\n\n\t// child is managing itself\n\tif ( !meta.target ) {\n\t\tmeta.parentFragment = this.fragment;\n\t\tmeta.external = true;\n\t} else {\n\t\tlet list;\n\t\tif ( !( list = children.byName[ meta.target ] ) ) {\n\t\t\tlist = [];\n\t\t\tthis.set( `@this.children.byName.${meta.target}`, list );\n\t\t}\n\t\tconst idx = options.prepend ? 0 : options.insertAt !== undefined ? options.insertAt : list.length;\n\t\tlist.splice( idx, 0, meta );\n\t}\n\n\tchild.set({\n\t\t'@this.parent': this,\n\t\t'@this.root': this.root\n\t});\n\tchild.component = meta;\n\tchildren.push( meta );\n\n\tattachHook.fire( child );\n\n\tconst promise = runloop.start( child, true );\n\n\tif ( meta.target ) {\n\t\tunrenderChild( meta );\n\t\tthis.set( `@this.children.byName.${meta.target}`, null, { shuffle: true } );\n\t\tupdateAnchors( this, meta.target );\n\t} else {\n\t\tif ( !child.isolated ) child.viewmodel.attached( this.fragment );\n\t}\n\n\trunloop.end();\n\n\tpromise.ractive = child;\n\treturn promise.then( () => child );\n}\n\nfunction bubble () { runloop.addFragment( this.instance.fragment ); }\n\nfunction findNextNode () {\n\tif ( this.anchor ) return this.anchor.findNextNode();\n}\n","import Hook from '../../events/Hook';\nimport { removeFromArray } from '../../utils/array';\n\nconst detachHook = new Hook( 'detach' );\n\nexport default function Ractive$detach () {\n\tif ( this.isDetached ) {\n\t\treturn this.el;\n\t}\n\n\tif ( this.el ) {\n\t\tremoveFromArray( this.el.__ractive_instances__, this );\n\t}\n\n\tthis.el = this.fragment.detach();\n\tthis.isDetached = true;\n\n\tdetachHook.fire( this );\n\treturn this.el;\n}\n","import Hook from '../../events/Hook';\nimport runloop from '../../global/runloop';\nimport { updateAnchors } from '../../shared/anchors';\n\nconst detachHook = new Hook( 'detachchild' );\n\nexport default function detachChild ( child ) {\n\tconst children = this._children;\n\tlet meta, index;\n\n\tlet i = children.length;\n\twhile ( i-- ) {\n\t\tif ( children[i].instance === child ) {\n\t\t\tindex = i;\n\t\t\tmeta = children[i];\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif ( !meta || child.parent !== this ) throw new Error( `Instance ${child._guid} is not attached to this instance.` );\n\n\tconst promise = runloop.start( child, true );\n\n\tif ( meta.anchor ) meta.anchor.removeChild( meta );\n\tif ( !child.isolated ) child.viewmodel.detached();\n\n\trunloop.end();\n\n\tchildren.splice( index, 1 );\n\tif ( meta.target ) {\n\t\tconst list = children.byName[ meta.target ];\n\t\tlist.splice( list.indexOf( meta ), 1 );\n\t\tthis.set( `@this.children.byName.${meta.target}`, null, { shuffle: true } );\n\t\tupdateAnchors( this, meta.target );\n\t}\n\tchild.set({\n\t\t'@this.parent': undefined,\n\t\t'@this.root': child\n\t});\n\tchild.component = null;\n\n\tdetachHook.fire( child );\n\n\tpromise.ractive = child;\n\treturn promise.then( () => child );\n}\n","import { splitKeypath } from '../../../shared/keypaths';\nimport runloop from '../../../global/runloop';\nimport getNewIndices from '../../../shared/getNewIndices';\n\nconst arrayProto = Array.prototype;\n\nexport default function ( methodName ) {\n\tfunction path ( keypath, ...args ) {\n\t\treturn model( this.viewmodel.joinAll( splitKeypath( keypath ) ), args );\n\t}\n\n\tfunction model ( mdl, args ) {\n\t\tlet array = mdl.get();\n\n\t\tif ( !Array.isArray( array ) ) {\n\t\t\tif ( array === undefined ) {\n\t\t\t\tarray = [];\n\t\t\t\tconst result = arrayProto[ methodName ].apply( array, args );\n\t\t\t\tconst promise = runloop.start( this, true ).then( () => result );\n\t\t\t\tmdl.set( array );\n\t\t\t\trunloop.end();\n\t\t\t\treturn promise;\n\t\t\t} else {\n\t\t\t\tthrow new Error( `shuffle array method ${methodName} called on non-array at ${mdl.getKeypath()}` );\n\t\t\t}\n\t\t}\n\n\t\tconst newIndices = getNewIndices( array.length, methodName, args );\n\t\tconst result = arrayProto[ methodName ].apply( array, args );\n\n\t\tconst promise = runloop.start( this, true ).then( () => result );\n\t\tpromise.result = result;\n\n\t\tif ( newIndices ) {\n\t\t\tmdl.shuffle( newIndices );\n\t\t} else {\n\t\t\tmdl.set( result );\n\t\t}\n\n\t\trunloop.end();\n\n\t\treturn promise;\n\t}\n\n\treturn { path, model };\n}\n","import Hook from '../../events/Hook';\nimport runloop from '../../global/runloop';\nimport { splitKeypath } from '../../shared/keypaths';\n\nconst updateHook = new Hook( 'update' );\n\nexport function update ( ractive, model, options ) {\n\t// if the parent is wrapped, the adaptor will need to be updated before\n\t// updating on this keypath\n\tif ( model.parent && model.parent.wrapper ) {\n\t\tmodel.parent.adapt();\n\t}\n\n\tconst promise = runloop.start( ractive, true );\n\n\tmodel.mark( options && options.force );\n\n\t// notify upstream of changes\n\tmodel.notifyUpstream();\n\n\trunloop.end();\n\n\tupdateHook.fire( ractive, model );\n\n\treturn promise;\n}\n\nexport default function Ractive$update ( keypath, options ) {\n\tlet opts, path;\n\n\tif ( typeof keypath === 'string' ) {\n\t\tpath = splitKeypath( keypath );\n\t\topts = options;\n\t} else {\n\t\topts = keypath;\n\t}\n\n\treturn update( this, path ? this.viewmodel.joinAll( path ) : this.viewmodel, opts );\n}\n","export const TEXT              = 1;\nexport const INTERPOLATOR      = 2;\nexport const TRIPLE            = 3;\nexport const SECTION           = 4;\nexport const INVERTED          = 5;\nexport const CLOSING           = 6;\nexport const ELEMENT           = 7;\nexport const PARTIAL           = 8;\nexport const COMMENT           = 9;\nexport const DELIMCHANGE       = 10;\nexport const ANCHOR            = 11;\nexport const ATTRIBUTE         = 13;\nexport const CLOSING_TAG       = 14;\nexport const COMPONENT         = 15;\nexport const YIELDER           = 16;\nexport const INLINE_PARTIAL    = 17;\nexport const DOCTYPE           = 18;\nexport const ALIAS             = 19;\n\nexport const NUMBER_LITERAL    = 20;\nexport const STRING_LITERAL    = 21;\nexport const ARRAY_LITERAL     = 22;\nexport const OBJECT_LITERAL    = 23;\nexport const BOOLEAN_LITERAL   = 24;\nexport const REGEXP_LITERAL    = 25;\n\nexport const GLOBAL            = 26;\nexport const KEY_VALUE_PAIR    = 27;\n\n\nexport const REFERENCE         = 30;\nexport const REFINEMENT        = 31;\nexport const MEMBER            = 32;\nexport const PREFIX_OPERATOR   = 33;\nexport const BRACKETED         = 34;\nexport const CONDITIONAL       = 35;\nexport const INFIX_OPERATOR    = 36;\n\nexport const INVOCATION        = 40;\n\nexport const SECTION_IF        = 50;\nexport const SECTION_UNLESS    = 51;\nexport const SECTION_EACH      = 52;\nexport const SECTION_WITH      = 53;\nexport const SECTION_IF_WITH   = 54;\n\nexport const ELSE              = 60;\nexport const ELSEIF            = 61;\n\nexport const EVENT             = 70;\nexport const DECORATOR         = 71;\nexport const TRANSITION        = 72;\nexport const BINDING_FLAG      = 73;\nexport const DELEGATE_FLAG     = 74;\n","import resolveReference from '../view/resolvers/resolveReference';\nimport { set as sharedSet } from './set';\nimport { isNumeric, isObject } from '../utils/is';\nimport makeArrayMethod from '../Ractive/prototype/shared/makeArrayMethod';\nimport { animate as protoAnimate } from '../Ractive/prototype/animate';\nimport { update as protoUpdate } from '../Ractive/prototype/update';\nimport runloop from '../global/runloop';\nimport findElement from '../view/items/shared/findElement';\nimport getRactiveContext, { extern } from './getRactiveContext';\nimport Model from '../model/Model';\n\nconst modelPush = makeArrayMethod( 'push' ).model;\nconst modelPop = makeArrayMethod( 'pop' ).model;\nconst modelShift = makeArrayMethod( 'shift' ).model;\nconst modelUnshift = makeArrayMethod( 'unshift' ).model;\nconst modelSort = makeArrayMethod( 'sort' ).model;\nconst modelSplice = makeArrayMethod( 'splice' ).model;\nconst modelReverse = makeArrayMethod( 'reverse' ).model;\n\nclass ContextData extends Model {\n\tconstructor ( options ) {\n\t\tsuper( null, null );\n\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.value = {};\n\t\tthis.ractive = options.ractive;\n\t\tthis.adaptors = [];\n\t\tthis.context = options.context;\n\t}\n\n\tgetKeypath () {\n\t\treturn '@context.data';\n\t}\n}\n\nexport default class Context {\n\tconstructor ( fragment, element ) {\n\t\tthis.fragment = fragment;\n\t\tthis.element = element || findElement( fragment );\n\t\tthis.node = this.element && this.element.node;\n\t\tthis.ractive = fragment.ractive;\n\t\tthis.root = this;\n\t}\n\n\tget decorators () {\n\t\tconst items = {};\n\t\tif ( !this.element ) return items;\n\t\tthis.element.decorators.forEach( d => items[ d.name ] = d.intermediary );\n\t\treturn items;\n\t}\n\n\tget _data () {\n\t\treturn this.model || ( this.root.model = new ContextData({ ractive: this.ractive, context: this.root }) );\n\t}\n\n\t// the usual mutation suspects\n\tadd ( keypath, d, options ) {\n\t\tconst num = typeof d === 'number' ? +d : 1;\n\t\tconst opts = typeof d === 'object' ? d : options;\n\t\treturn sharedSet( this.ractive, build( this, keypath, num ).map( pair => {\n\t\t\tconst [ model, val ] = pair;\n\t\t\tconst value = model.get();\n\t\t\tif ( !isNumeric( val ) || !isNumeric( value ) ) throw new Error( 'Cannot add non-numeric value' );\n\t\t\treturn [ model, value + val ];\n\t\t}), opts );\n\t}\n\n\tanimate ( keypath, value, options ) {\n\t\tconst model = findModel( this, keypath ).model;\n\t\treturn protoAnimate( this.ractive, model, value, options );\n\t}\n\n\t// get relative keypaths and values\n\tget ( keypath ) {\n\t\tif ( !keypath ) return this.fragment.findContext().get( true );\n\n\t\tconst { model } = findModel( this, keypath );\n\n\t\treturn model ? model.get( true ) : undefined;\n\t}\n\n\tlink ( source, dest ) {\n\t\tconst there = findModel( this, source ).model;\n\t\tconst here = findModel( this, dest ).model;\n\t\tconst promise = runloop.start( this.ractive, true );\n\t\there.link( there, source );\n\t\trunloop.end();\n\t\treturn promise;\n\t}\n\n\tlisten ( event, handler ) {\n\t\tconst el = this.element;\n\t\tel.on( event, handler );\n\t\treturn {\n\t\t\tcancel () { el.off( event, handler ); }\n\t\t};\n\t}\n\n\tobserve ( keypath, callback, options = {} ) {\n\t\tif ( isObject( keypath ) ) options = callback || {};\n\t\toptions.fragment = this.fragment;\n\t\treturn this.ractive.observe( keypath, callback, options );\n\t}\n\n\tobserveOnce ( keypath, callback, options = {} ) {\n\t\tif ( isObject( keypath ) ) options = callback || {};\n\t\toptions.fragment = this.fragment;\n\t\treturn this.ractive.observeOnce( keypath, callback, options );\n\t}\n\n\tpop ( keypath ) {\n\t\treturn modelPop( findModel( this, keypath ).model, [] );\n\t}\n\n\tpush ( keypath, ...values ) {\n\t\treturn modelPush( findModel( this, keypath ).model, values );\n\t}\n\n\traise ( name, event, ...args ) {\n\t\tlet element = this.element;\n\n\t\twhile ( element ) {\n\t\t\tconst events = element.events;\n\t\t\tfor ( let i = 0; i < events.length; i++ ) {\n\t\t\t\tconst ev = events[i];\n\t\t\t\tif ( ~ev.template.n.indexOf( name ) ) {\n\t\t\t\t\tconst ctx = !event || !( 'original' in event ) ?\n\t\t\t\t\t\tev.element.getContext( event || {}, { original: {} } ) :\n\t\t\t\t\t\tev.element.getContext( event || {} );\n\t\t\t\t\treturn ev.fire( ctx, args );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\telement = element.parent;\n\t\t}\n\t}\n\n\treadLink ( keypath, options ) {\n\t\treturn this.ractive.readLink( this.resolve( keypath ), options );\n\t}\n\n\tresolve ( path, ractive ) {\n\t\tconst { model, instance } = findModel( this, path );\n\t\treturn model ? model.getKeypath( ractive || instance ) : path;\n\t}\n\n\treverse ( keypath ) {\n\t\treturn modelReverse( findModel( this, keypath ).model, [] );\n\t}\n\n\tset ( keypath, value, options ) {\n\t\treturn sharedSet( this.ractive, build( this, keypath, value ), options );\n\t}\n\n\tshift ( keypath ) {\n\t\treturn modelShift( findModel( this, keypath ).model, [] );\n\t}\n\n\tsplice ( keypath, index, drop, ...add ) {\n\t\tadd.unshift( index, drop );\n\t\treturn modelSplice( findModel( this, keypath ).model, add );\n\t}\n\n\tsort ( keypath ) {\n\t\treturn modelSort( findModel( this, keypath ).model, [] );\n\t}\n\n\tsubtract ( keypath, d, options ) {\n\t\tconst num = typeof d === 'number' ? d : 1;\n\t\tconst opts = typeof d === 'object' ? d : options;\n\t\treturn sharedSet( this.ractive, build( this, keypath, num ).map( pair => {\n\t\t\tconst [ model, val ] = pair;\n\t\t\tconst value = model.get();\n\t\t\tif ( !isNumeric( val ) || !isNumeric( value ) ) throw new Error( 'Cannot add non-numeric value' );\n\t\t\treturn [ model, value - val ];\n\t\t}), opts );\n\t}\n\n\ttoggle ( keypath, options ) {\n\t\tconst { model } = findModel( this, keypath );\n\t\treturn sharedSet( this.ractive, [ [ model, !model.get() ] ], options );\n\t}\n\n\tunlink ( dest ) {\n\t\tconst here = findModel( this, dest ).model;\n\t\tconst promise = runloop.start( this.ractive, true );\n\t\tif ( here.owner && here.owner._link ) here.owner.unlink();\n\t\trunloop.end();\n\t\treturn promise;\n\t}\n\n\tunlisten ( event, handler ) {\n\t\tthis.element.off( event, handler );\n\t}\n\n\tunshift ( keypath, ...add ) {\n\t\treturn modelUnshift( findModel( this, keypath ).model, add );\n\t}\n\n\tupdate ( keypath, options ) {\n\t\treturn protoUpdate( this.ractive, findModel( this, keypath ).model, options );\n\t}\n\n\tupdateModel ( keypath, cascade ) {\n\t\tconst { model } = findModel( this, keypath );\n\t\tconst promise = runloop.start( this.ractive, true );\n\t\tmodel.updateFromBindings( cascade );\n\t\trunloop.end();\n\t\treturn promise;\n\t}\n\n\t// two-way binding related helpers\n\tisBound () {\n\t\tconst { model } = this.getBindingModel( this );\n\t\treturn !!model;\n\t}\n\n\tgetBindingPath ( ractive ) {\n\t\tconst { model, instance } = this.getBindingModel( this );\n\t\tif ( model ) return model.getKeypath( ractive || instance );\n\t}\n\n\tgetBinding () {\n\t\tconst { model } = this.getBindingModel( this );\n\t\tif ( model ) return model.get( true );\n\t}\n\n\tgetBindingModel ( ctx ) {\n\t\tconst el = ctx.element;\n\t\treturn { model: el.binding && el.binding.model, instance: el.parentFragment.ractive };\n\t}\n\n\tsetBinding ( value ) {\n\t\tconst { model } = this.getBindingModel( this );\n\t\treturn sharedSet( this.ractive, [ [ model, value ] ] );\n\t}\n}\n\nContext.forRactive = getRactiveContext;\n// circular deps are fun\nextern.Context = Context;\n\n// TODO: at some point perhaps this could support relative * keypaths?\nfunction build ( ctx, keypath, value ) {\n\tconst sets = [];\n\n\t// set multiple keypaths in one go\n\tif ( isObject( keypath ) ) {\n\t\tfor ( const k in keypath ) {\n\t\t\tif ( keypath.hasOwnProperty( k ) ) {\n\t\t\t\tsets.push( [ findModel( ctx, k ).model, keypath[k] ] );\n\t\t\t}\n\t\t}\n\n\t}\n\t// set a single keypath\n\telse {\n\t\tsets.push( [ findModel( ctx, keypath ).model, value ] );\n\t}\n\n\treturn sets;\n}\n\nfunction findModel ( ctx, path ) {\n\tconst frag = ctx.fragment;\n\n\tif ( typeof path !== 'string' ) {\n\t\treturn { model: frag.findContext(), instance: path };\n\t}\n\n\treturn { model: resolveReference( frag, path ), instance: frag.ractive };\n}\n","import { doc } from '../../config/environment';\nimport getRactiveContext from '../../shared/getRactiveContext';\nimport { warnOnceIfDebug } from '../../utils/log';\n\nconst query = doc && doc.querySelector;\n\nexport default function getContext ( node ) {\n\tif ( typeof node === 'string' && query ) {\n\t\tnode = query.call( document, node );\n\t}\n\n\tlet instances;\n\tif ( node ) {\n\t\tif ( node._ractive ) {\n\t\t\treturn node._ractive.proxy.getContext();\n\t\t} else if ( ( instances = node.__ractive_instances__ ) && instances.length === 1 ) {\n\t\t\treturn getRactiveContext( instances[0] );\n\t\t}\n\t}\n}\n\nexport function getNodeInfo ( node ) {\n\twarnOnceIfDebug( `getNodeInfo has been renamed to getContext, and the getNodeInfo alias will be removed in a future release.` );\n\treturn getContext ( node );\n}\n","import { isClient, svg, vendors, win, doc } from '../config/environment';\nimport { html } from '../config/namespaces';\n\nlet createElement, matches, div, methodNames, unprefixed, prefixed, i, j, makeFunction;\n\n// Test for SVG support\nif ( !svg ) {\n\tcreateElement = ( type, ns, extend ) => {\n\t\tif ( ns && ns !== html ) {\n\t\t\tthrow 'This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you\\'re trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information';\n\t\t}\n\n\t\treturn extend ?\n\t\t\tdoc.createElement( type, extend ) :\n\t\t\tdoc.createElement( type );\n\t};\n} else {\n\tcreateElement = ( type, ns, extend ) => {\n\t\tif ( !ns || ns === html ) {\n\t\t\treturn extend ?\n\t\t\t\tdoc.createElement( type, extend ) :\n\t\t\t\tdoc.createElement( type );\n\t\t}\n\n\t\treturn extend ?\n\t\t\tdoc.createElementNS( ns, type, extend ) :\n\t\t\tdoc.createElementNS( ns, type );\n\t};\n}\n\nexport function createDocumentFragment () {\n\treturn doc.createDocumentFragment();\n}\n\nfunction getElement ( input ) {\n\tlet output;\n\n\tif ( !input || typeof input === 'boolean' ) { return; }\n\n\tif ( !win || !doc || !input ) {\n\t\treturn null;\n\t}\n\n\t// We already have a DOM node - no work to do. (Duck typing alert!)\n\tif ( input.nodeType ) {\n\t\treturn input;\n\t}\n\n\t// Get node from string\n\tif ( typeof input === 'string' ) {\n\t\t// try ID first\n\t\toutput = doc.getElementById( input );\n\n\t\t// then as selector, if possible\n\t\tif ( !output && doc.querySelector ) {\n\t\t\ttry {\n\t\t\t\toutput = doc.querySelector( input );\n\t\t\t} catch (e) { /* this space intentionally left blank */ }\n\t\t}\n\n\t\t// did it work?\n\t\tif ( output && output.nodeType ) {\n\t\t\treturn output;\n\t\t}\n\t}\n\n\t// If we've been given a collection (jQuery, Zepto etc), extract the first item\n\tif ( input[0] && input[0].nodeType ) {\n\t\treturn input[0];\n\t}\n\n\treturn null;\n}\n\nif ( !isClient ) {\n\tmatches = null;\n} else {\n\tdiv = createElement( 'div' );\n\tmethodNames = [ 'matches', 'matchesSelector' ];\n\n\tmakeFunction = function ( methodName ) {\n\t\treturn function ( node, selector ) {\n\t\t\treturn node[ methodName ]( selector );\n\t\t};\n\t};\n\n\ti = methodNames.length;\n\n\twhile ( i-- && !matches ) {\n\t\tunprefixed = methodNames[i];\n\n\t\tif ( div[ unprefixed ] ) {\n\t\t\tmatches = makeFunction( unprefixed );\n\t\t} else {\n\t\t\tj = vendors.length;\n\t\t\twhile ( j-- ) {\n\t\t\t\tprefixed = vendors[i] + unprefixed.substr( 0, 1 ).toUpperCase() + unprefixed.substring( 1 );\n\n\t\t\t\tif ( div[ prefixed ] ) {\n\t\t\t\t\tmatches = makeFunction( prefixed );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// IE8...\n\tif ( !matches ) {\n\t\tmatches = function ( node, selector ) {\n\t\t\tlet parentNode, i;\n\n\t\t\tparentNode = node.parentNode;\n\n\t\t\tif ( !parentNode ) {\n\t\t\t\t// empty dummy <div>\n\t\t\t\tdiv.innerHTML = '';\n\n\t\t\t\tparentNode = div;\n\t\t\t\tnode = node.cloneNode();\n\n\t\t\t\tdiv.appendChild( node );\n\t\t\t}\n\n\t\t\tconst nodes = parentNode.querySelectorAll( selector );\n\n\t\t\ti = nodes.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( nodes[i] === node ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\t}\n}\n\nfunction detachNode ( node ) {\n\t// stupid ie\n\tif ( node && typeof node.parentNode !== 'unknown' && node.parentNode ) { // eslint-disable-line valid-typeof\n\t\tnode.parentNode.removeChild( node );\n\t}\n\n\treturn node;\n}\n\nfunction safeToStringValue ( value ) {\n\treturn ( value == null || !value.toString ) ? '' : '' + value;\n}\n\nfunction safeAttributeString ( string ) {\n\treturn safeToStringValue( string )\n\t\t.replace( /&/g, '&amp;' )\n\t\t.replace( /\"/g, '&quot;' )\n\t\t.replace( /'/g, '&#39;' );\n}\n\nexport { createElement, detachNode, getElement, matches, safeToStringValue, safeAttributeString };\n","export const html   = 'http://www.w3.org/1999/xhtml';\nexport const mathml = 'http://www.w3.org/1998/Math/MathML';\nexport const svg    = 'http://www.w3.org/2000/svg';\nexport const xlink  = 'http://www.w3.org/1999/xlink';\nexport const xml    = 'http://www.w3.org/XML/1998/namespace';\nexport const xmlns  = 'http://www.w3.org/2000/xmlns';\n\nexport default { html, mathml, svg, xlink, xml, xmlns };\n","import Hook from '../../events/Hook';\nimport { getElement } from '../../utils/dom';\n\nconst insertHook = new Hook( 'insert' );\n\nexport default function Ractive$insert ( target, anchor ) {\n\tif ( !this.fragment.rendered ) {\n\t\t// TODO create, and link to, documentation explaining this\n\t\tthrow new Error( 'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.' );\n\t}\n\n\ttarget = getElement( target );\n\tanchor = getElement( anchor ) || null;\n\n\tif ( !target ) {\n\t\tthrow new Error( 'You must specify a valid target to insert into' );\n\t}\n\n\ttarget.insertBefore( this.detach(), anchor );\n\tthis.el = target;\n\n\t( target.__ractive_instances__ || ( target.__ractive_instances__ = [] ) ).push( this );\n\tthis.isDetached = false;\n\n\tfireInsertHook( this );\n}\n\nfunction fireInsertHook( ractive ) {\n\tinsertHook.fire( ractive );\n\n\tractive.findAllComponents('*').forEach( child => {\n\t\tfireInsertHook( child.instance );\n\t});\n}\n","import { isEqual } from '../../../utils/is';\nimport { removeFromArray } from '../../../utils/array';\nimport runloop from '../../../global/runloop';\nimport { rebindMatch } from '../../../shared/rebind';\n\nexport default class Observer {\n\tconstructor ( ractive, model, callback, options ) {\n\t\tthis.context = options.context || ractive;\n\t\tthis.callback = callback;\n\t\tthis.ractive = ractive;\n\t\tthis.keypath = options.keypath;\n\t\tthis.options = options;\n\n\t\tif ( model ) this.resolved( model );\n\n\t\tif ( typeof options.old === 'function' ) {\n\t\t\tthis.oldContext = Object.create( ractive );\n\t\t\tthis.old = options.old;\n\t\t} else {\n\t\t\tthis.old = old;\n\t\t}\n\n\t\tif ( options.init !== false ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.dispatch();\n\t\t} else {\n\t\t\tthis.oldValue = this.old.call( this.oldContext, undefined, this.newValue );\n\t\t}\n\n\t\tthis.dirty = false;\n\t}\n\n\tcancel () {\n\t\tthis.cancelled = true;\n\t\tif ( this.model ) {\n\t\t\tthis.model.unregister( this );\n\t\t} else {\n\t\t\tthis.resolver.unbind();\n\t\t}\n\t\tremoveFromArray( this.ractive._observers, this );\n\t}\n\n\tdispatch () {\n\t\tif ( !this.cancelled ) {\n\t\t\tthis.callback.call( this.context, this.newValue, this.oldValue, this.keypath );\n\t\t\tthis.oldValue = this.old.call( this.oldContext, this.oldValue, this.model ? this.model.get() : this.newValue );\n\t\t\tthis.dirty = false;\n\t\t}\n\t}\n\n\thandleChange () {\n\t\tif ( !this.dirty ) {\n\t\t\tconst newValue = this.model.get();\n\t\t\tif ( isEqual( newValue, this.oldValue ) ) return;\n\n\t\t\tthis.newValue = newValue;\n\n\t\t\tif ( this.options.strict && this.newValue === this.oldValue ) return;\n\n\t\t\trunloop.addObserver( this, this.options.defer );\n\t\t\tthis.dirty = true;\n\n\t\t\tif ( this.options.once ) runloop.scheduleTask( () => this.cancel() );\n\t\t}\n\t}\n\n\trebind ( next, previous ) {\n\t\tnext = rebindMatch( this.keypath, next, previous );\n\t\t// TODO: set up a resolver if next is undefined?\n\t\tif ( next === this.model ) return false;\n\n\t\tif ( this.model ) this.model.unregister( this );\n\t\tif ( next ) next.addShuffleTask( () => this.resolved( next ) );\n\t}\n\n\tresolved ( model ) {\n\t\tthis.model = model;\n\n\t\tthis.oldValue = undefined;\n\t\tthis.newValue = model.get();\n\n\t\tmodel.register( this );\n\t}\n}\n\nfunction old ( previous, next ) {\n\treturn next;\n}\n","import { escapeKey } from '../../../shared/keypaths';\nimport { removeFromArray } from '../../../utils/array';\nimport { isEqual } from '../../../utils/is';\nimport runloop from '../../../global/runloop';\n\nconst star = /\\*+/g;\n\nexport default class PatternObserver {\n\tconstructor ( ractive, baseModel, keys, callback, options ) {\n\t\tthis.context = options.context || ractive;\n\t\tthis.ractive = ractive;\n\t\tthis.baseModel = baseModel;\n\t\tthis.keys = keys;\n\t\tthis.callback = callback;\n\n\t\tconst pattern = keys.join( '\\\\.' ).replace( star, '(.+)' );\n\t\tconst baseKeypath = this.baseKeypath = baseModel.getKeypath( ractive );\n\t\tthis.pattern = new RegExp( `^${baseKeypath ? baseKeypath + '\\\\.' : ''}${pattern}$` );\n\t\tthis.recursive = keys.length === 1 && keys[0] === '**';\n\t\tif ( this.recursive ) this.keys = [ '*' ];\n\n\t\tthis.oldValues = {};\n\t\tthis.newValues = {};\n\n\t\tthis.defer = options.defer;\n\t\tthis.once = options.once;\n\t\tthis.strict = options.strict;\n\n\t\tthis.dirty = false;\n\t\tthis.changed = [];\n\t\tthis.partial = false;\n\t\tthis.links = options.links;\n\n\t\tconst models = baseModel.findMatches( this.keys );\n\n\t\tmodels.forEach( model => {\n\t\t\tthis.newValues[ model.getKeypath( this.ractive ) ] = model.get();\n\t\t});\n\n\t\tif ( options.init !== false ) {\n\t\t\tthis.dispatch();\n\t\t} else {\n\t\t\tthis.oldValues = this.newValues;\n\t\t}\n\n\t\tbaseModel.registerPatternObserver( this );\n\t}\n\n\tcancel () {\n\t\tthis.baseModel.unregisterPatternObserver( this );\n\t\tremoveFromArray( this.ractive._observers, this );\n\t}\n\n\tdispatch () {\n\t\tconst newValues = this.newValues;\n\t\tthis.newValues = {};\n\t\tObject.keys( newValues ).forEach( keypath => {\n\t\t\tconst newValue = newValues[ keypath ];\n\t\t\tconst oldValue = this.oldValues[ keypath ];\n\n\t\t\tif ( this.strict && newValue === oldValue ) return;\n\t\t\tif ( isEqual( newValue, oldValue ) ) return;\n\n\t\t\tlet args = [ newValue, oldValue, keypath ];\n\t\t\tif ( keypath ) {\n\t\t\t\tconst wildcards = this.pattern.exec( keypath );\n\t\t\t\tif ( wildcards ) {\n\t\t\t\t\targs = args.concat( wildcards.slice( 1 ) );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.callback.apply( this.context, args );\n\t\t});\n\n\t\tif ( this.partial ) {\n\t\t\tfor ( const k in newValues ) {\n\t\t\t\tthis.oldValues[k] = newValues[k];\n\t\t\t}\n\t\t} else {\n\t\t\tthis.oldValues = newValues;\n\t\t}\n\n\t\tthis.dirty = false;\n\t}\n\n\tnotify ( key ) {\n\t\tthis.changed.push( key );\n\t}\n\n\tshuffle ( newIndices ) {\n\t\tif ( !Array.isArray( this.baseModel.value ) ) return;\n\n\t\tconst max = this.baseModel.value.length;\n\n\t\tfor ( let i = 0; i < newIndices.length; i++ ) {\n\t\t\tif ( newIndices[ i ] === -1 || newIndices[ i ] === i ) continue;\n\t\t\tthis.changed.push([ i ]);\n\t\t}\n\n\t\tfor ( let i = newIndices.touchedFrom; i < max; i++ ) {\n\t\t\tthis.changed.push([ i ]);\n\t\t}\n\t}\n\n\thandleChange () {\n\t\tif ( !this.dirty || this.changed.length ) {\n\t\t\tif ( !this.dirty ) this.newValues = {};\n\n\t\t\tif ( !this.changed.length ) {\n\t\t\t\tthis.baseModel.findMatches( this.keys ).forEach( model => {\n\t\t\t\t\tconst keypath = model.getKeypath( this.ractive );\n\t\t\t\t\tthis.newValues[ keypath ] = model.get();\n\t\t\t\t});\n\t\t\t\tthis.partial = false;\n\t\t\t} else {\n\t\t\t\tlet count = 0;\n\n\t\t\t\tif ( this.recursive ) {\n\t\t\t\t\tthis.changed.forEach( keys => {\n\t\t\t\t\t\tconst model = this.baseModel.joinAll( keys );\n\t\t\t\t\t\tif ( model.isLink && !this.links ) return;\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t\tthis.newValues[ model.getKeypath( this.ractive ) ] = model.get();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconst ok = this.baseModel.isRoot ?\n\t\t\t\t\t\tthis.changed.map( keys => keys.map( escapeKey ).join( '.' ) ) :\n\t\t\t\t\t\tthis.changed.map( keys => this.baseKeypath + '.' + keys.map( escapeKey ).join( '.' ) );\n\n\t\t\t\t\tthis.baseModel.findMatches( this.keys ).forEach( model => {\n\t\t\t\t\t\tconst keypath = model.getKeypath( this.ractive );\n\t\t\t\t\t\tconst check = k => {\n\t\t\t\t\t\t\treturn ( k.indexOf( keypath ) === 0 && ( k.length === keypath.length || k[ keypath.length ] === '.' ) ) ||\n\t\t\t\t\t\t\t\t( keypath.indexOf( k ) === 0 && ( k.length === keypath.length || keypath[ k.length ] === '.' ) );\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// is this model on a changed keypath?\n\t\t\t\t\t\tif ( ok.filter( check ).length ) {\n\t\t\t\t\t\t\tcount++;\n\t\t\t\t\t\t\tthis.newValues[ keypath ] = model.get();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// no valid change triggered, so bail to avoid breakage\n\t\t\t\tif ( !count ) return;\n\n\t\t\t\tthis.partial = true;\n\t\t\t}\n\n\t\t\trunloop.addObserver( this, this.defer );\n\t\t\tthis.dirty = true;\n\t\t\tthis.changed.length = 0;\n\n\t\t\tif ( this.once ) this.cancel();\n\t\t}\n\t}\n}\n","import { removeFromArray } from '../../../utils/array';\nimport runloop from '../../../global/runloop';\n\nfunction negativeOne () {\n\treturn -1;\n}\n\nexport default class ArrayObserver {\n\tconstructor ( ractive, model, callback, options ) {\n\t\tthis.ractive = ractive;\n\t\tthis.model = model;\n\t\tthis.keypath = model.getKeypath();\n\t\tthis.callback = callback;\n\t\tthis.options = options;\n\n\t\tthis.pending = null;\n\n\t\tmodel.register( this );\n\n\t\tif ( options.init !== false ) {\n\t\t\tthis.sliced = [];\n\t\t\tthis.shuffle([]);\n\t\t\tthis.dispatch();\n\t\t} else {\n\t\t\tthis.sliced = this.slice();\n\t\t}\n\t}\n\n\tcancel () {\n\t\tthis.model.unregister( this );\n\t\tremoveFromArray( this.ractive._observers, this );\n\t}\n\n\tdispatch () {\n\t\tthis.callback( this.pending );\n\t\tthis.pending = null;\n\t\tif ( this.options.once ) this.cancel();\n\t}\n\n\thandleChange () {\n\t\tif ( this.pending ) {\n\t\t\t// post-shuffle\n\t\t\trunloop.addObserver( this, this.options.defer );\n\t\t} else {\n\t\t\t// entire array changed\n\t\t\tthis.shuffle( this.sliced.map( negativeOne ) );\n\t\t\tthis.handleChange();\n\t\t}\n\t}\n\n\tshuffle ( newIndices ) {\n\t\tconst newValue = this.slice();\n\n\t\tconst inserted = [];\n\t\tconst deleted = [];\n\t\tlet start;\n\n\t\tconst hadIndex = {};\n\n\t\tnewIndices.forEach( ( newIndex, oldIndex ) => {\n\t\t\thadIndex[ newIndex ] = true;\n\n\t\t\tif ( newIndex !== oldIndex && start === undefined ) {\n\t\t\t\tstart = oldIndex;\n\t\t\t}\n\n\t\t\tif ( newIndex === -1 ) {\n\t\t\t\tdeleted.push( this.sliced[ oldIndex ] );\n\t\t\t}\n\t\t});\n\n\t\tif ( start === undefined ) start = newIndices.length;\n\n\t\tconst len = newValue.length;\n\t\tfor ( let i = 0; i < len; i += 1 ) {\n\t\t\tif ( !hadIndex[i] ) inserted.push( newValue[i] );\n\t\t}\n\n\t\tthis.pending = { inserted, deleted, start };\n\t\tthis.sliced = newValue;\n\t}\n\n\tslice () {\n\t\tconst value = this.model.get();\n\t\treturn Array.isArray( value ) ? value.slice() : [];\n\t}\n}\n\n","import { isObject } from '../../utils/is';\n\nconst onceOptions = { init: false, once: true };\n\nexport default function observeOnce ( keypath, callback, options ) {\n\tif ( isObject( keypath ) || typeof keypath === 'function' ) {\n\t\toptions = Object.assign( callback || {}, onceOptions );\n\t\treturn this.observe( keypath, options );\n\t}\n\n\toptions = Object.assign( options || {}, onceOptions );\n\treturn this.observe( keypath, callback, options );\n}\n","export default str => str.trim();\n","export default str => str !== '';\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'pop' ).path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'push' ).path;\n","import { doc } from '../config/environment';\n\nconst PREFIX = '/* Ractive.js component styles */';\n\n// Holds current definitions of styles.\nconst styleDefinitions = [];\n\n// Flag to tell if we need to update the CSS\nlet isDirty = false;\n\n// These only make sense on the browser. See additional setup below.\nlet styleElement = null;\nlet useCssText = null;\n\nexport function addCSS( styleDefinition ) {\n\tstyleDefinitions.push( styleDefinition );\n\tisDirty = true;\n}\n\nexport function applyCSS() {\n\n\t// Apply only seems to make sense when we're in the DOM. Server-side renders\n\t// can call toCSS to get the updated CSS.\n\tif ( !doc || !isDirty ) return;\n\n\tif ( useCssText ) {\n\t\tstyleElement.styleSheet.cssText = getCSS( null );\n\t} else {\n\t\tstyleElement.innerHTML = getCSS( null );\n\t}\n\n\tisDirty = false;\n}\n\nexport function getCSS( cssIds ) {\n\n\tconst filteredStyleDefinitions = cssIds ? styleDefinitions.filter( style => ~cssIds.indexOf( style.id ) ) : styleDefinitions;\n\n\treturn filteredStyleDefinitions.reduce( ( styles, style ) => `${styles}\\n\\n/* {${style.id}} */\\n${style.styles}`, PREFIX );\n\n}\n\n// If we're on the browser, additional setup needed.\nif ( doc && ( !styleElement || !styleElement.parentNode ) ) {\n\n\tstyleElement = doc.createElement( 'style' );\n\tstyleElement.type = 'text/css';\n\n\tdoc.getElementsByTagName( 'head' )[ 0 ].appendChild( styleElement );\n\n\tuseCssText = !!styleElement.styleSheet;\n}\n","import { ensureArray, combine } from '../../../utils/array';\n\nexport default {\n\textend: ( Parent, proto, options ) => {\n\t\tproto.adapt = combine( proto.adapt, ensureArray( options.adapt ) );\n\t},\n\n\tinit () {}\n};\n","const remove = /\\/\\*(?:[\\s\\S]*?)\\*\\//g;\nconst escape = /url\\(\\s*(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\1\\s*\\)|url\\((?:\\\\[\\s\\S]|[^)])*\\)|(['\"])(?:\\\\[\\s\\S]|(?!\\2).)*\\2/gi;\nconst value = /\\0(\\d+)/g;\n\n// Removes comments and strings from the given CSS to make it easier to parse.\n// Callback receives the cleaned CSS and a function which can be used to put\n// the removed strings back in place after parsing is done.\nexport default function ( css, callback, additionalReplaceRules = [] ) {\n\tconst values = [];\n\tconst reconstruct = css => css.replace( value, ( match, n ) => values[ n ] );\n\tcss = css.replace( escape, match => `\\0${values.push( match ) - 1}`).replace( remove, '' );\n\n\tadditionalReplaceRules.forEach( ( pattern ) => {\n\t\tcss = css.replace( pattern, match => `\\0${values.push( match ) - 1}` );\n\t});\n\n\treturn callback( css, reconstruct );\n}\n","import cleanCss from '../../../../utils/cleanCss';\n\nconst selectorsPattern = /(?:^|\\}|\\{)\\s*([^\\{\\}\\0]+)\\s*(?=\\{)/g;\nconst keyframesDeclarationPattern = /@keyframes\\s+[^\\{\\}]+\\s*\\{(?:[^{}]+|\\{[^{}]+})*}/gi;\nconst selectorUnitPattern = /((?:(?:\\[[^\\]]+\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\nconst excludePattern = /^(?:@|\\d+%)/;\nconst dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\nfunction trim ( str ) {\n\treturn str.trim();\n}\n\nfunction extractString ( unit ) {\n\treturn unit.str;\n}\n\nfunction transformSelector ( selector, parent ) {\n\tconst selectorUnits = [];\n\tlet match;\n\n\twhile ( match = selectorUnitPattern.exec( selector ) ) {\n\t\tselectorUnits.push({\n\t\t\tstr: match[0],\n\t\t\tbase: match[1],\n\t\t\tmodifiers: match[2]\n\t\t});\n\t}\n\n\t// For each simple selector within the selector, we need to create a version\n\t// that a) combines with the id, and b) is inside the id\n\tconst base = selectorUnits.map( extractString );\n\n\tconst transformed = [];\n\tlet i = selectorUnits.length;\n\n\twhile ( i-- ) {\n\t\tconst appended = base.slice();\n\n\t\t// Pseudo-selectors should go after the attribute selector\n\t\tconst unit = selectorUnits[i];\n\t\tappended[i] = unit.base + parent + unit.modifiers || '';\n\n\t\tconst prepended = base.slice();\n\t\tprepended[i] = parent + ' ' + prepended[i];\n\n\t\ttransformed.push( appended.join( ' ' ), prepended.join( ' ' ) );\n\t}\n\n\treturn transformed.join( ', ' );\n}\n\nexport default function transformCss ( css, id ) {\n\tconst dataAttr = `[data-ractive-css~=\"{${id}}\"]`;\n\n\tlet transformed;\n\n\tif ( dataRvcGuidPattern.test( css ) ) {\n\t\ttransformed = css.replace( dataRvcGuidPattern, dataAttr );\n\t} else {\n\t\ttransformed = cleanCss( css, ( css, reconstruct ) => {\n\t\t\tcss = css.replace( selectorsPattern, ( match, $1 ) => {\n\t\t\t\t// don't transform at-rules and keyframe declarations\n\t\t\t\tif ( excludePattern.test( $1 ) ) return match;\n\n\t\t\t\tconst selectors = $1.split( ',' ).map( trim );\n\t\t\t\tconst transformed = selectors\n\t\t\t\t\t.map( selector => transformSelector( selector, dataAttr ) )\n\t\t\t\t\t.join( ', ' ) + ' ';\n\n\t\t\t\treturn match.replace( $1, transformed );\n\t\t\t});\n\n\t\t\treturn reconstruct( css );\n\t\t}, [ keyframesDeclarationPattern ]);\n\t}\n\n\treturn transformed;\n}\n","import { addCSS } from '../../../../global/css';\nimport transformCss from './transform';\nimport { uuid } from '../../../../utils/id';\nimport { warnIfDebug } from '../../../../utils/log';\nimport { getElement } from '../../../../utils/dom';\n\nconst hasCurly = /\\{/;\nexport default {\n\tname: 'css',\n\n\t// Called when creating a new component definition\n\textend: ( Parent, proto, options ) => {\n\t\tif ( !options.css ) return;\n\t\tlet css = typeof options.css === 'string' && !hasCurly.test( options.css ) ?\n\t\t\t( getElement( options.css ) || options.css ) :\n\t\t\toptions.css;\n\n\t\tconst id = options.cssId || uuid();\n\n\t\tif ( typeof css === 'object' ) {\n\t\t\tcss = 'textContent' in css ? css.textContent : css.innerHTML;\n\t\t}\n\n\t\tif ( !css ) return;\n\n\t\tconst styles = options.noCssTransform ? css : transformCss( css, id );\n\n\t\tproto.cssId = id;\n\n\t\taddCSS( { id, styles } );\n\t},\n\n\t// Called when creating a new component instance\n\tinit: ( Parent, target, options ) => {\n\t\tif ( !options.css ) return;\n\n\t\twarnIfDebug( `\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\n\nconst Component = Ractive.extend({\n\t...\n\tcss: '/* your css */',\n\t...\n});\n\nconst componentInstance = new Component({ ... })\n\t\t` );\n\t}\n\n};\n","import { fatal, warnIfDebug, warnOnceIfDebug } from '../../../utils/log';\nimport { isObject } from '../../../utils/is';\nimport bind from '../../../utils/bind';\n\nfunction validate ( data ) {\n\t// Warn if userOptions.data is a non-POJO\n\tif ( data && data.constructor !== Object ) {\n\t\tif ( typeof data === 'function' ) {\n\t\t\t// TODO do we need to support this in the new Ractive() case?\n\t\t} else if ( typeof data !== 'object' ) {\n\t\t\tfatal( `data option must be an object or a function, \\`${data}\\` is not valid` );\n\t\t} else {\n\t\t\twarnIfDebug( 'If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged' );\n\t\t}\n\t}\n}\n\nexport default {\n\tname: 'data',\n\n\textend: ( Parent, proto, options ) => {\n\t\tlet key;\n\t\tlet value;\n\n\t\t// check for non-primitives, which could cause mutation-related bugs\n\t\tif ( options.data && isObject( options.data ) ) {\n\t\t\tfor ( key in options.data ) {\n\t\t\t\tvalue = options.data[ key ];\n\n\t\t\t\tif ( value && typeof value === 'object' ) {\n\t\t\t\t\tif ( isObject( value ) || Array.isArray( value ) ) {\n\t\t\t\t\t\twarnIfDebug( `Passing a \\`data\\` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }` );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tproto.data = combine( proto.data, options.data );\n\t},\n\n\tinit: ( Parent, ractive, options ) => {\n\t\tlet result = combine( Parent.prototype.data, options.data );\n\n\t\tif ( typeof result === 'function' ) result = result.call( ractive );\n\n\t\t// bind functions to the ractive instance at the top level,\n\t\t// unless it's a non-POJO (in which case alarm bells should ring)\n\t\tif ( result && result.constructor === Object ) {\n\t\t\tfor ( const prop in result ) {\n\t\t\t\tif ( typeof result[ prop ] === 'function' ) {\n\t\t\t\t\tconst value = result[ prop ];\n\t\t\t\t\tresult[ prop ] = bind( value, ractive );\n\t\t\t\t\tresult[ prop ]._r_unbound = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result || {};\n\t},\n\n\treset ( ractive ) {\n\t\tconst result = this.init( ractive.constructor, ractive, ractive.viewmodel );\n\t\tractive.viewmodel.root.set( result );\n\t\treturn true;\n\t}\n};\n\nfunction combine ( parentValue, childValue ) {\n\tvalidate( childValue );\n\n\tconst parentIsFn = typeof parentValue === 'function';\n\tconst childIsFn = typeof childValue === 'function';\n\n\t// Very important, otherwise child instance can become\n\t// the default data object on Ractive or a component.\n\t// then ractive.set() ends up setting on the prototype!\n\tif ( !childValue && !parentIsFn ) {\n\t\tchildValue = {};\n\t}\n\n\t// Fast path, where we just need to copy properties from\n\t// parent to child\n\tif ( !parentIsFn && !childIsFn ) {\n\t\treturn fromProperties( childValue, parentValue );\n\t}\n\n\treturn function () {\n\t\tconst child = childIsFn ? callDataFunction( childValue, this ) : childValue;\n\t\tconst parent = parentIsFn ? callDataFunction( parentValue, this ) : parentValue;\n\n\t\treturn fromProperties( child, parent );\n\t};\n}\n\nfunction callDataFunction ( fn, context ) {\n\tconst data = fn.call( context );\n\n\tif ( !data ) return;\n\n\tif ( typeof data !== 'object' ) {\n\t\tfatal( 'Data function must return an object' );\n\t}\n\n\tif ( data.constructor !== Object ) {\n\t\twarnOnceIfDebug( 'Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged' );\n\t}\n\n\treturn data;\n}\n\nfunction fromProperties ( primary, secondary ) {\n\tif ( primary && secondary ) {\n\t\tfor ( const key in secondary ) {\n\t\t\tif ( !( key in primary ) ) {\n\t\t\t\tprimary[ key ] = secondary[ key ];\n\t\t\t}\n\t\t}\n\n\t\treturn primary;\n\t}\n\n\treturn primary || secondary;\n}\n","export const TEMPLATE_VERSION = 4;\n","const pattern = /\\$\\{([^\\}]+)\\}/g;\n\nexport function fromExpression ( body, length = 0 ) {\n\tconst args = new Array( length );\n\n\twhile ( length-- ) {\n\t\targs[length] = `_${length}`;\n\t}\n\n\t// Functions created directly with new Function() look like this:\n\t//     function anonymous (_0 /**/) { return _0*2 }\n\t//\n\t// With this workaround, we get a little more compact:\n\t//     function (_0){return _0*2}\n\treturn new Function( [], `return function (${args.join(',')}){return(${body});};` )();\n}\n\nexport function fromComputationString ( str, bindTo ) {\n\tlet hasThis;\n\n\tlet functionBody = 'return (' + str.replace( pattern, ( match, keypath ) => {\n\t\thasThis = true;\n\t\treturn `__ractive.get(\"${keypath}\")`;\n\t}) + ');';\n\n\tif ( hasThis ) functionBody = `var __ractive = this; ${functionBody}`;\n\tconst fn = new Function( functionBody );\n\treturn hasThis ? fn.bind( bindTo ) : fn;\n}\n","import { createFunction } from '../Ractive/config/runtime-parser';\n\nconst functions = Object.create( null );\n\nexport default function getFunction ( str, i ) {\n\tif ( functions[ str ] ) return functions[ str ];\n\treturn functions[ str ] = createFunction( str, i );\n}\n\nexport function addFunctions( template ) {\n\tif ( !template ) return;\n\n\tconst exp = template.e;\n\n\tif ( !exp ) return;\n\n\tObject.keys( exp ).forEach( ( str ) => {\n\t\tif ( functions[ str ] ) return;\n\t\tfunctions[ str ] = exp[ str ];\n\t});\n}\n\n\n","import { TEMPLATE_VERSION } from '../config/template';\nimport { ELEMENT } from '../config/types';\nimport Parser from './Parser';\nimport readMustache from './converters/readMustache';\nimport readTriple from './converters/mustache/readTriple';\nimport readUnescaped from './converters/mustache/readUnescaped';\nimport readPartial from './converters/mustache/readPartial';\nimport readMustacheComment from './converters/mustache/readMustacheComment';\nimport readInterpolator from './converters/mustache/readInterpolator';\nimport readSection from './converters/mustache/readSection';\nimport readHtmlComment from './converters/readHtmlComment';\nimport readElement from './converters/readElement';\nimport readText from './converters/readText';\nimport readPartialDefinitionSection from './converters/readPartialDefinitionSection';\nimport readTemplate from './converters/readTemplate';\nimport cleanup from './utils/cleanup';\nimport insertExpressions from './utils/insertExpressions';\nimport shared from '../Ractive/shared';\n\n// See https://github.com/ractivejs/template-spec for information\n// about the Ractive template specification\n\nconst STANDARD_READERS = [ readPartial, readUnescaped, readSection, readInterpolator, readMustacheComment ];\nconst TRIPLE_READERS = [ readTriple ];\nconst STATIC_READERS = [ readUnescaped, readSection, readInterpolator ]; // TODO does it make sense to have a static section?\n\nexport const READERS = [ readMustache, readHtmlComment, readElement, readText ];\nexport const PARTIAL_READERS = [ readPartialDefinitionSection ];\n\nconst defaultInterpolate = [ 'script', 'style', 'template' ];\n\nconst StandardParser = Parser.extend({\n\tinit ( str, options ) {\n\t\tconst tripleDelimiters = options.tripleDelimiters || shared.defaults.tripleDelimiters;\n\t\tconst staticDelimiters = options.staticDelimiters || shared.defaults.staticDelimiters;\n\t\tconst staticTripleDelimiters = options.staticTripleDelimiters || shared.defaults.staticTripleDelimiters;\n\n\t\tthis.standardDelimiters = options.delimiters || shared.defaults.delimiters;\n\n\t\tthis.tags = [\n\t\t\t{ isStatic: false, isTriple: false, open: this.standardDelimiters[0], close: this.standardDelimiters[1], readers: STANDARD_READERS },\n\t\t\t{ isStatic: false, isTriple: true,  open: tripleDelimiters[0],        close: tripleDelimiters[1],        readers: TRIPLE_READERS },\n\t\t\t{ isStatic: true,  isTriple: false, open: staticDelimiters[0],        close: staticDelimiters[1],        readers: STATIC_READERS },\n\t\t\t{ isStatic: true,  isTriple: true,  open: staticTripleDelimiters[0],  close: staticTripleDelimiters[1],  readers: TRIPLE_READERS }\n\t\t];\n\n\t\tthis.contextLines = options.contextLines || shared.defaults.contextLines;\n\n\t\tthis.sortMustacheTags();\n\n\t\tthis.sectionDepth = 0;\n\t\tthis.elementStack = [];\n\n\t\tthis.interpolate = Object.create( options.interpolate || shared.defaults.interpolate || {} );\n\t\tthis.interpolate.textarea = true;\n\t\tdefaultInterpolate.forEach( t => this.interpolate[ t ] = !options.interpolate || options.interpolate[ t ] !== false );\n\n\t\tif ( options.sanitize === true ) {\n\t\t\toptions.sanitize = {\n\t\t\t\t// blacklist from https://code.google.com/p/google-caja/source/browse/trunk/src/com/google/caja/lang/html/html4-elements-whitelist.json\n\t\t\t\telements: 'applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title'.split( ' ' ),\n\t\t\t\teventAttributes: true\n\t\t\t};\n\t\t}\n\n\t\tthis.stripComments = options.stripComments !== false;\n\t\tthis.preserveWhitespace = options.preserveWhitespace;\n\t\tthis.sanitizeElements = options.sanitize && options.sanitize.elements;\n\t\tthis.sanitizeEventAttributes = options.sanitize && options.sanitize.eventAttributes;\n\t\tthis.includeLinePositions = options.includeLinePositions;\n\t\tthis.textOnlyMode = options.textOnlyMode;\n\t\tthis.csp = options.csp;\n\n\t\tthis.transforms = options.transforms || options.parserTransforms;\n\t\tif ( this.transforms ) {\n\t\t\tthis.transforms = this.transforms.concat( shared.defaults.parserTransforms );\n\t\t} else {\n\t\t\tthis.transforms = shared.defaults.parserTransforms;\n\t\t}\n\t},\n\n\tpostProcess ( result ) {\n\t\t// special case - empty string\n\t\tif ( !result.length ) {\n\t\t\treturn { t: [], v: TEMPLATE_VERSION };\n\t\t}\n\n\t\tif ( this.sectionDepth > 0 ) {\n\t\t\tthis.error( 'A section was left open' );\n\t\t}\n\n\t\tcleanup( result[0].t, this.stripComments, this.preserveWhitespace, !this.preserveWhitespace, !this.preserveWhitespace );\n\n\t\tconst transforms = this.transforms;\n\t\tif ( transforms.length ) {\n\t\t\tconst tlen = transforms.length;\n\t\t\tconst walk = function ( fragment ) {\n\t\t\t\tlet len = fragment.length;\n\n\t\t\t\tfor ( let i = 0; i < len; i++ ) {\n\t\t\t\t\tlet node = fragment[i];\n\n\t\t\t\t\tif ( node.t === ELEMENT ) {\n\t\t\t\t\t\tfor ( let j = 0; j < tlen; j++ ) {\n\t\t\t\t\t\t\tconst res = transforms[j].call( shared.Ractive, node );\n\t\t\t\t\t\t\tif ( !res ) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t} else if ( res.remove ) {\n\t\t\t\t\t\t\t\tfragment.splice( i--, 1 );\n\t\t\t\t\t\t\t\tlen--;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else if ( res.replace ) {\n\t\t\t\t\t\t\t\tif ( Array.isArray( res.replace ) ) {\n\t\t\t\t\t\t\t\t\tfragment.splice( i--, 1, ...res.replace );\n\t\t\t\t\t\t\t\t\tlen += res.replace.length - 1;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tfragment[i--] = node = res.replace;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// watch for partials\n\t\t\t\t\t\tif ( node.p ) {\n\t\t\t\t\t\t\tfor ( const k in node.p ) walk( node.p[k] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( node.f ) walk( node.f );\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// process the root fragment\n\t\t\twalk( result[0].t );\n\n\t\t\t// watch for root partials\n\t\t\tif ( result[0].p ) {\n\t\t\t\tfor ( const k in result[0].p ) walk( result[0].p[k] );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.csp !== false ) {\n\t\t\tconst expr = {};\n\t\t\tinsertExpressions( result[0].t, expr );\n\t\t\tif ( Object.keys( expr ).length ) result[0].e = expr;\n\t\t}\n\n\t\treturn result[0];\n\t},\n\n\tconverters: [\n\t\treadTemplate\n\t],\n\n\tsortMustacheTags () {\n\t\t// Sort in order of descending opening delimiter length (longer first),\n\t\t// to protect against opening delimiters being substrings of each other\n\t\tthis.tags.sort( ( a, b ) => {\n\t\t\treturn b.open.length - a.open.length;\n\t\t});\n\t}\n});\n\nexport default function parse ( template, options ) {\n\treturn new StandardParser( template, options || {} ).result;\n}\n","import { fromExpression, fromComputationString } from '../../parse/utils/createFunction';\nimport { doc } from '../../config/environment';\nimport { fatal } from '../../utils/log';\nimport { addFunctions } from '../../shared/getFunction';\nimport parse from '../../parse/_parse';\n\nconst parseOptions = [\n\t'delimiters',\n\t'tripleDelimiters',\n\t'staticDelimiters',\n\t'staticTripleDelimiters',\n\t'csp',\n\t'interpolate',\n\t'preserveWhitespace',\n\t'sanitize',\n\t'stripComments',\n\t'contextLines'\n];\n\nconst TEMPLATE_INSTRUCTIONS = `Either preparse or use a ractive runtime source that includes the parser. `;\n\nconst COMPUTATION_INSTRUCTIONS = `Either include a version of Ractive that can parse or convert your computation strings to functions.`;\n\n\nfunction throwNoParse ( method, error, instructions ) {\n\tif ( !method ) {\n\t\tfatal( `Missing Ractive.parse - cannot parse ${error}. ${instructions}` );\n\t}\n}\n\nexport function createFunction ( body, length ) {\n\tthrowNoParse( fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS );\n\treturn fromExpression( body, length );\n}\n\nexport function createFunctionFromString ( str, bindTo ) {\n\tthrowNoParse( fromComputationString, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS );\n\treturn fromComputationString( str, bindTo );\n}\n\nconst parser = {\n\n\tfromId ( id, options ) {\n\t\tif ( !doc ) {\n\t\t\tif ( options && options.noThrow ) { return; }\n\t\t\tthrow new Error( `Cannot retrieve template #${id} as Ractive is not running in a browser.` );\n\t\t}\n\n\t\tif ( id ) id = id.replace( /^#/, '' );\n\n\t\tlet template;\n\n\t\tif ( !( template = doc.getElementById( id ) )) {\n\t\t\tif ( options && options.noThrow ) { return; }\n\t\t\tthrow new Error( `Could not find template element with id #${id}` );\n\t\t}\n\n\t\tif ( template.tagName.toUpperCase() !== 'SCRIPT' ) {\n\t\t\tif ( options && options.noThrow ) { return; }\n\t\t\tthrow new Error( `Template element with id #${id}, must be a <script> element` );\n\t\t}\n\n\t\treturn ( 'textContent' in template ? template.textContent : template.innerHTML );\n\n\t},\n\n\tisParsed ( template) {\n\t\treturn !( typeof template === 'string' );\n\t},\n\n\tgetParseOptions ( ractive ) {\n\t\t// Could be Ractive or a Component\n\t\tif ( ractive.defaults ) { ractive = ractive.defaults; }\n\n\t\treturn parseOptions.reduce( ( val, key ) => {\n\t\t\tval[ key ] = ractive[ key ];\n\t\t\treturn val;\n\t\t}, {});\n\t},\n\n\tparse ( template, options ) {\n\t\tthrowNoParse( parse, 'template', TEMPLATE_INSTRUCTIONS );\n\t\tconst parsed = parse( template, options );\n\t\taddFunctions( parsed );\n\t\treturn parsed;\n\t},\n\n\tparseFor( template, ractive ) {\n\t\treturn this.parse( template, this.getParseOptions( ractive ) );\n\t}\n};\n\nexport default parser;\n","import { TEMPLATE_VERSION } from '../../../config/template';\nimport parser from '../runtime-parser';\nimport { addFunctions } from '../../../shared/getFunction';\n\nexport default {\n\tname: 'template',\n\n\textend ( Parent, proto, options ) {\n\t\t// only assign if exists\n\t\tif ( 'template' in options ) {\n\t\t\tconst template = options.template;\n\n\t\t\tif ( typeof template === 'function' ) {\n\t\t\t\tproto.template = template;\n\t\t\t} else {\n\t\t\t\tproto.template = parseTemplate( template, proto );\n\t\t\t}\n\t\t}\n\t},\n\n\tinit ( Parent, ractive, options ) {\n\t\t// TODO because of prototypal inheritance, we might just be able to use\n\t\t// ractive.template, and not bother passing through the Parent object.\n\t\t// At present that breaks the test mocks' expectations\n\t\tlet template = 'template' in options ? options.template : Parent.prototype.template;\n\t\ttemplate = template || { v: TEMPLATE_VERSION, t: [] };\n\n\t\tif ( typeof template === 'function' ) {\n\t\t\tconst fn = template;\n\t\t\ttemplate = getDynamicTemplate( ractive, fn );\n\n\t\t\tractive._config.template = {\n\t\t\t\tfn,\n\t\t\t\tresult: template\n\t\t\t};\n\t\t}\n\n\t\ttemplate = parseTemplate( template, ractive );\n\n\t\t// TODO the naming of this is confusing - ractive.template refers to [...],\n\t\t// but Component.prototype.template refers to {v:1,t:[],p:[]}...\n\t\t// it's unnecessary, because the developer never needs to access\n\t\t// ractive.template\n\t\tractive.template = template.t;\n\n\t\tif ( template.p ) {\n\t\t\textendPartials( ractive.partials, template.p );\n\t\t}\n\t},\n\n\treset ( ractive ) {\n\t\tconst result = resetValue( ractive );\n\n\t\tif ( result ) {\n\t\t\tconst parsed = parseTemplate( result, ractive );\n\n\t\t\tractive.template = parsed.t;\n\t\t\textendPartials( ractive.partials, parsed.p, true );\n\n\t\t\treturn true;\n\t\t}\n\t}\n};\n\nfunction resetValue ( ractive ) {\n\tconst initial = ractive._config.template;\n\n\t// If this isn't a dynamic template, there's nothing to do\n\tif ( !initial || !initial.fn ) {\n\t\treturn;\n\t}\n\n\tconst result = getDynamicTemplate( ractive, initial.fn );\n\n\t// TODO deep equality check to prevent unnecessary re-rendering\n\t// in the case of already-parsed templates\n\tif ( result !== initial.result ) {\n\t\tinitial.result = result;\n\t\treturn result;\n\t}\n}\n\nfunction getDynamicTemplate ( ractive, fn ) {\n\treturn fn.call( ractive, {\n\t\tfromId: parser.fromId,\n\t\tisParsed: parser.isParsed,\n\t\tparse ( template, options = parser.getParseOptions( ractive ) ) {\n\t\t\treturn parser.parse( template, options );\n\t\t}\n\t});\n}\n\nfunction parseTemplate ( template, ractive ) {\n\tif ( typeof template === 'string' ) {\n\t\t// parse will validate and add expression functions\n\t\ttemplate = parseAsString( template, ractive );\n\t}\n\telse {\n\t\t// need to validate and add exp for already parsed template\n\t\tvalidate( template );\n\t\taddFunctions( template );\n\t}\n\n\treturn template;\n}\n\nfunction parseAsString ( template, ractive ) {\n\t// ID of an element containing the template?\n\tif ( template[0] === '#' ) {\n\t\ttemplate = parser.fromId( template );\n\t}\n\n\treturn parser.parseFor( template, ractive );\n}\n\nfunction validate( template ) {\n\n\t// Check that the template even exists\n\tif ( template == undefined ) {\n\t\tthrow new Error( `The template cannot be ${template}.` );\n\t}\n\n\t// Check the parsed template has a version at all\n\telse if ( typeof template.v !== 'number' ) {\n\t\tthrow new Error( 'The template parser was passed a non-string template, but the template doesn\\'t have a version.  Make sure you\\'re passing in the template you think you are.' );\n\t}\n\n\t// Check we're using the correct version\n\telse if ( template.v !== TEMPLATE_VERSION ) {\n\t\tthrow new Error( `Mismatched template version (expected ${TEMPLATE_VERSION}, got ${template.v}) Please ensure you are using the latest version of Ractive.js in your build process as well as in your app` );\n\t}\n}\n\nfunction extendPartials ( existingPartials, newPartials, overwrite ) {\n\tif ( !newPartials ) return;\n\n\t// TODO there's an ambiguity here - we need to overwrite in the `reset()`\n\t// case, but not initially...\n\n\tfor ( const key in newPartials ) {\n\t\tif ( overwrite || !existingPartials.hasOwnProperty( key ) ) {\n\t\t\texistingPartials[ key ] = newPartials[ key ];\n\t\t}\n\t}\n}\n","const registryNames = [\n\t'adaptors',\n\t'components',\n\t'computed',\n\t'decorators',\n\t'easing',\n\t'events',\n\t'interpolators',\n\t'partials',\n\t'transitions'\n];\n\nconst registriesOnDefaults = [\n\t'computed'\n];\n\nclass Registry {\n\tconstructor ( name, useDefaults ) {\n\t\tthis.name = name;\n\t\tthis.useDefaults = useDefaults;\n\t}\n\n\textend ( Parent, proto, options ) {\n\t\tconst parent = this.useDefaults ? Parent.defaults : Parent;\n\t\tconst target = this.useDefaults ? proto : proto.constructor;\n\t\tthis.configure( parent, target, options );\n\t}\n\n\tinit () {\n\t\t// noop\n\t}\n\n\tconfigure ( Parent, target, options ) {\n\t\tconst name = this.name;\n\t\tconst option = options[ name ];\n\n\t\tconst registry = Object.create( Parent[name] );\n\n\t\tfor ( const key in option ) {\n\t\t\tregistry[ key ] = option[ key ];\n\t\t}\n\n\t\ttarget[ name ] = registry;\n\t}\n\n\treset ( ractive ) {\n\t\tconst registry = ractive[ this.name ];\n\t\tlet changed = false;\n\n\t\tObject.keys( registry ).forEach( key => {\n\t\t\tconst item = registry[ key ];\n\n\t\t\tif ( item._fn ) {\n\t\t\t\tif ( item._fn.isOwner ) {\n\t\t\t\t\tregistry[key] = item._fn;\n\t\t\t\t} else {\n\t\t\t\t\tdelete registry[key];\n\t\t\t\t}\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t});\n\n\t\treturn changed;\n\t}\n}\n\nconst registries = registryNames.map( name => {\n\tconst putInDefaults = registriesOnDefaults.indexOf(name) > -1;\n\treturn new Registry( name, putInDefaults );\n});\n\nexport default registries;\n","import { warnIfDebug } from '../../utils/log';\nimport adaptConfigurator from './custom/adapt';\nimport cssConfigurator from './custom/css/css';\nimport dataConfigurator from './custom/data';\nimport templateConfigurator from './custom/template';\nimport defaults from './defaults';\nimport registries from './registries';\nimport wrapPrototype from './wrapPrototypeMethod';\nimport deprecate from './deprecate';\nimport RactiveProto from '../prototype';\n\nconst custom = {\n\tadapt: adaptConfigurator,\n\tcss: cssConfigurator,\n\tdata: dataConfigurator,\n\ttemplate: templateConfigurator\n};\n\nconst defaultKeys = Object.keys( defaults );\n\nconst isStandardKey = makeObj( defaultKeys.filter( key => !custom[ key ] ) );\n\n// blacklisted keys that we don't double extend\nconst isBlacklisted = makeObj( defaultKeys.concat( registries.map( r => r.name ), [ 'on', 'observe', 'attributes' ] ) );\n\nconst order = [].concat(\n\tdefaultKeys.filter( key => !registries[ key ] && !custom[ key ] ),\n\tregistries,\n\t//custom.data,\n\tcustom.template,\n\tcustom.css\n);\n\nconst config = {\n\textend: ( Parent, proto, options ) => configure( 'extend', Parent, proto, options ),\n\tinit: ( Parent, ractive, options ) => configure( 'init', Parent, ractive, options ),\n\treset: ractive => order.filter( c => c.reset && c.reset( ractive ) ).map( c => c.name )\n};\n\nfunction configure ( method, Parent, target, options ) {\n\tdeprecate( options );\n\n\tfor ( const key in options ) {\n\t\tif ( isStandardKey.hasOwnProperty( key ) ) {\n\t\t\tconst value = options[ key ];\n\n\t\t\t// warn the developer if they passed a function and ignore its value\n\n\t\t\t// NOTE: we allow some functions on \"el\" because we duck type element lists\n\t\t\t// and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n\t\t\t// function object as the result of querySelector methods\n\t\t\tif ( key !== 'el' && typeof value === 'function' ) {\n\t\t\t\twarnIfDebug( `${ key } is a Ractive option that does not expect a function and will be ignored`,\n\t\t\t\t\tmethod === 'init' ? target : null );\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttarget[ key ] = value;\n\t\t\t}\n\t\t}\n\t}\n\n\t// disallow combination of `append` and `enhance`\n\tif ( options.append && options.enhance ) {\n\t\tthrow new Error( 'Cannot use append and enhance at the same time' );\n\t}\n\n\tregistries.forEach( registry => {\n\t\tregistry[ method ]( Parent, target, options );\n\t});\n\n\tadaptConfigurator[ method ]( Parent, target, options );\n\ttemplateConfigurator[ method ]( Parent, target, options );\n\tcssConfigurator[ method ]( Parent, target, options );\n\n\textendOtherMethods( Parent.prototype, target, options );\n}\n\nconst _super = /\\b_super\\b/;\nfunction extendOtherMethods ( parent, target, options ) {\n\tfor ( const key in options ) {\n\t\tif ( !isBlacklisted[ key ] && options.hasOwnProperty( key ) ) {\n\t\t\tlet member = options[ key ];\n\n\t\t\t// if this is a method that overwrites a method, wrap it:\n\t\t\tif ( typeof member === 'function' ) {\n\t\t\t\tif ( key in RactiveProto && !_super.test( member.toString() ) ) {\n\t\t\t\t\twarnIfDebug( `Overriding Ractive prototype function '${key}' without calling the '${_super}' method can be very dangerous.` );\n\t\t\t\t}\n\t\t\t\tmember = wrapPrototype( parent, key, member );\n\t\t\t}\n\n\t\t\ttarget[ key ] = member;\n\t\t}\n\t}\n}\n\nfunction makeObj ( array ) {\n\tconst obj = {};\n\tarray.forEach( x => obj[x] = true );\n\treturn obj;\n}\n\nexport default config;\n","import { createDocumentFragment } from '../../../utils/dom';\nimport noop from '../../../utils/noop';\n\nexport default class Item {\n\tconstructor ( options ) {\n\t\tthis.parentFragment = options.parentFragment;\n\t\tthis.ractive = options.parentFragment.ractive;\n\n\t\tthis.template = options.template;\n\t\tthis.index = options.index;\n\t\tthis.type = options.template.t;\n\n\t\tthis.dirty = false;\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.parentFragment.bubble();\n\t\t}\n\t}\n\n\tdestroyed () {\n\t\tif ( this.fragment ) this.fragment.destroyed();\n\t}\n\n\tfind () {\n\t\treturn null;\n\t}\n\n\tfindComponent () {\n\t\treturn null;\n\t}\n\n\tfindNextNode () {\n\t\treturn this.parentFragment.findNextNode( this );\n\t}\n\n\tshuffled () {\n\t\tif ( this.fragment ) this.fragment.shuffled();\n\t}\n\n\tvalueOf () {\n\t\treturn this.toString();\n\t}\n}\n\nItem.prototype.findAll = noop;\nItem.prototype.findAllComponents = noop;\n\nexport class ContainerItem extends Item {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\t}\n\n\tdetach () {\n\t\treturn this.fragment ? this.fragment.detach() : createDocumentFragment();\n\t}\n\n\tfind ( selector ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.find( selector );\n\t\t}\n\t}\n\n\tfindAll ( selector, options ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAll( selector, options );\n\t\t}\n\t}\n\n\tfindComponent ( name ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.findComponent( name );\n\t\t}\n\t}\n\n\tfindAllComponents ( name, options ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAllComponents( name, options );\n\t\t}\n\t}\n\n\tfirstNode ( skipParent ) {\n\t\treturn this.fragment && this.fragment.firstNode( skipParent );\n\t}\n\n\ttoString ( escape ) {\n\t\treturn this.fragment ? this.fragment.toString( escape ) : '';\n\t}\n}\n","import { capture } from '../global/capture';\nimport Model from './Model';\nimport { handleChange, mark, marked } from '../shared/methodCallers';\n\nexport default class ComputationChild extends Model {\n\tconstructor ( parent, key ) {\n\t\tsuper( parent, key );\n\n\t\tthis.isReadonly = !this.root.ractive.syncComputedChildren;\n\t\tthis.dirty = true;\n\t}\n\n\tget setRoot () { return this.parent.setRoot; }\n\n\tapplyValue ( value ) {\n\t\tsuper.applyValue( value );\n\n\t\tif ( !this.isReadonly ) {\n\t\t\tlet source = this.parent;\n\t\t\t// computed models don't have a shuffle method\n\t\t\twhile ( source && source.shuffle ) {\n\t\t\t\tsource = source.parent;\n\t\t\t}\n\n\t\t\tif ( source ) {\n\t\t\t\tsource.dependencies.forEach( mark );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.setRoot ) {\n\t\t\tthis.setRoot.set( this.setRoot.value );\n\t\t}\n\t}\n\n\tget ( shouldCapture ) {\n\t\tif ( shouldCapture ) capture( this );\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tconst parentValue = this.parent.get();\n\t\t\tthis.value = parentValue ? parentValue[ this.key ] : undefined;\n\t\t}\n\n\t\treturn this.value;\n\t}\n\n\thandleChange () {\n\t\tthis.dirty = true;\n\n\t\tif ( this.boundValue ) this.boundValue = null;\n\n\t\tthis.links.forEach( marked );\n\t\tthis.deps.forEach( handleChange );\n\t\tthis.children.forEach( handleChange );\n\t}\n\n\tjoinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) return this;\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tconst child = new ComputationChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t}\n}\n","import { fatal } from '../../utils/log';\nimport bind from '../../utils/bind';\nimport { createFunctionFromString } from '../config/runtime-parser';\n\nexport default function getComputationSignature ( ractive, key, signature ) {\n\tlet getter;\n\tlet setter;\n\n\t// useful for debugging\n\tlet getterString;\n\tlet getterUseStack;\n\tlet setterString;\n\n\tif ( typeof signature === 'function' ) {\n\t\tgetter = bind( signature, ractive );\n\t\tgetterString = signature.toString();\n\t\tgetterUseStack = true;\n\t}\n\n\tif ( typeof signature === 'string' ) {\n\t\tgetter = createFunctionFromString( signature, ractive );\n\t\tgetterString = signature;\n\t}\n\n\tif ( typeof signature === 'object' ) {\n\t\tif ( typeof signature.get === 'string' ) {\n\t\t\tgetter = createFunctionFromString( signature.get, ractive );\n\t\t\tgetterString = signature.get;\n\t\t} else if ( typeof signature.get === 'function' ) {\n\t\t\tgetter = bind( signature.get, ractive );\n\t\t\tgetterString = signature.get.toString();\n\t\t\tgetterUseStack = true;\n\t\t} else {\n\t\t\tfatal( '`%s` computation must have a `get()` method', key );\n\t\t}\n\n\t\tif ( typeof signature.set === 'function' ) {\n\t\t\tsetter = bind( signature.set, ractive );\n\t\t\tsetterString = signature.set.toString();\n\t\t}\n\t}\n\n\treturn {\n\t\tgetter,\n\t\tsetter,\n\t\tgetterString,\n\t\tsetterString,\n\t\tgetterUseStack\n\t};\n}\n","import getFunction from '../../../shared/getFunction';\nimport resolveReference from '../../resolvers/resolveReference';\n\nexport function setupArgsFn ( item, template, fragment, opts = {} ) {\n\tif ( template && template.f && template.f.s ) {\n\t\titem.fn = getFunction( template.f.s, template.f.r.length );\n\t\tif ( opts.register === true ) {\n\t\t\titem.models = resolveArgs( item, template, fragment, opts );\n\t\t}\n\t}\n}\n\nexport function resolveArgs ( item, template, fragment, opts = {} ) {\n\treturn template.f.r.map( ( ref, i ) => {\n\t\tlet model;\n\n\t\tif ( opts.specialRef && ( model = opts.specialRef( ref, i ) ) ) return model;\n\n\t\tmodel = resolveReference( fragment, ref );\n\t\tif ( opts.register === true ) {\n\t\t\tmodel.register( item );\n\t\t}\n\n\t\treturn model;\n\t});\n}\n\nexport function teardownArgsFn ( item, template ) {\n\tif ( template && template.f && template.f.s ) {\n\t\tif ( item.models ) item.models.forEach( m => {\n\t\t\tif ( m && m.unregister ) m.unregister( item );\n\t\t});\n\t\titem.models = null;\n\t}\n}\n","// This is the handler for DOM events that would lead to a change in the model\n// (i.e. change, sometimes, input, and occasionally click and keyup)\nexport default function handleDomEvent () {\n\tthis._ractive.binding.handleChange();\n}\n","import { toArray } from './array';\n\nexport default function getSelectedOptions ( select ) {\n\treturn select.selectedOptions\n\t\t? toArray( select.selectedOptions )\n\t\t: select.options\n\t\t\t? toArray( select.options ).filter( option => option.selected )\n\t\t\t: [];\n}\n","import { INTERPOLATOR, TRIPLE } from '../../../../config/types';\nimport { warnIfDebug } from '../../../../utils/log';\nimport CheckboxBinding from './CheckboxBinding';\nimport CheckboxNameBinding from './CheckboxNameBinding';\nimport ContentEditableBinding from './ContentEditableBinding';\nimport FileBinding from './FileBinding';\nimport GenericBinding from './GenericBinding';\nimport MultipleSelectBinding from './MultipleSelectBinding';\nimport NumericBinding from './NumericBinding';\nimport RadioBinding from './RadioBinding';\nimport RadioNameBinding from './RadioNameBinding';\nimport SingleSelectBinding from './SingleSelectBinding';\n\nexport function isBindable ( attribute ) {\n\n\t// The fragment must be a single non-string fragment\n\tif ( !attribute || !attribute.template.f || !attribute.template.f.length === 1 || attribute.template.f[0].s ) return false;\n\n\t// A binding is an interpolator `{{ }}`, yey.\n\tif ( attribute.template.f[0].t === INTERPOLATOR ) return true;\n\n\t// The above is probably the only true case. For the rest, show an appropriate\n\t// warning before returning false.\n\n\t// You can't bind a triple curly. HTML values on an attribute makes no sense.\n\tif ( attribute.template.f[0].t === TRIPLE ) warnIfDebug( 'It is not possible create a binding using a triple mustache.' );\n\n\treturn false;\n}\n\nexport default function selectBinding ( element ) {\n\tconst name = element.name;\n\tconst attributes = element.attributeByName;\n\tconst isBindableByValue = isBindable( attributes.value );\n\tconst isBindableByContentEditable = isBindable( attributes.contenteditable );\n\tconst isContentEditable =  element.getAttribute( 'contenteditable' );\n\n\t// contenteditable\n\t// Bind if the contenteditable is true or a binding that may become true.\n\tif ( ( isContentEditable || isBindableByContentEditable ) && isBindableByValue ) return ContentEditableBinding;\n\n\t// <input>\n\tif ( name === 'input' ) {\n\t\tconst type = element.getAttribute( 'type' );\n\n\t\tif ( type === 'radio' ) {\n\t\t\tconst isBindableByName = isBindable( attributes.name );\n\t\t\tconst isBindableByChecked = isBindable( attributes.checked );\n\n\t\t\t// For radios we can either bind the name or checked, but not both.\n\t\t\t// Name binding is handed instead.\n\t\t\tif ( isBindableByName && isBindableByChecked ) {\n\t\t\t\twarnIfDebug( 'A radio input can have two-way binding on its name attribute, or its checked attribute - not both', { ractive: element.root });\n\t\t\t\treturn RadioNameBinding;\n\t\t\t}\n\n\t\t\tif ( isBindableByName ) return RadioNameBinding;\n\n\t\t\tif ( isBindableByChecked ) return RadioBinding;\n\n\t\t\t// Dead end. Unknown binding on radio input.\n\t\t\treturn null;\n\t\t}\n\n\t\tif ( type === 'checkbox' ) {\n\t\t\tconst isBindableByName = isBindable( attributes.name );\n\t\t\tconst isBindableByChecked = isBindable( attributes.checked );\n\n\t\t\t// A checkbox with bindings for both name and checked. Checked treated as\n\t\t\t// the checkbox value, name is treated as a regular binding.\n\t\t\t//\n\t\t\t// See https://github.com/ractivejs/ractive/issues/1749\n\t\t\tif ( isBindableByName && isBindableByChecked ) return CheckboxBinding;\n\n\t\t\tif ( isBindableByName ) return CheckboxNameBinding;\n\n\t\t\tif ( isBindableByChecked ) return CheckboxBinding;\n\n\t\t\t// Dead end. Unknown binding on checkbox input.\n\t\t\treturn null;\n\t\t}\n\n\t\tif ( type === 'file' && isBindableByValue ) return FileBinding;\n\n\t\tif ( type === 'number' && isBindableByValue ) return NumericBinding;\n\n\t\tif ( type === 'range' && isBindableByValue ) return NumericBinding;\n\n\t\t// Some input of unknown type (browser usually falls back to text).\n\t\tif ( isBindableByValue ) return GenericBinding;\n\n\t\t// Dead end. Some unknown input and an unbindable.\n\t\treturn null;\n\t}\n\n\t// <select>\n\tif ( name === 'select' && isBindableByValue ){\n\t\treturn element.getAttribute( 'multiple' ) ? MultipleSelectBinding : SingleSelectBinding;\n\t}\n\n\t// <textarea>\n\tif ( name === 'textarea' && isBindableByValue ) return GenericBinding;\n\n\t// Dead end. Some unbindable element.\n\treturn null;\n}\n","import { doc } from '../../../config/environment';\n\nexport default function progressiveText ( item, target, occupants, text ) {\n\tif ( occupants ) {\n\t\tlet n = occupants[0];\n\t\tif ( n && n.nodeType === 3 ) {\n\t\t\tconst idx = n.nodeValue.indexOf( text );\n\t\t\toccupants.shift();\n\n\t\t\tif ( idx === 0 ) {\n\t\t\t\tif ( n.nodeValue.length !== text.length ) {\n\t\t\t\t\toccupants.unshift( n.splitText( text.length ) );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tn.nodeValue = text;\n\t\t\t}\n\t\t} else {\n\t\t\tn = item.node = doc.createTextNode( text );\n\t\t\tif ( occupants[0] ) {\n\t\t\t\ttarget.insertBefore( n, occupants[0] );\n\t\t\t} else {\n\t\t\t\ttarget.appendChild( n );\n\t\t\t}\n\t\t}\n\n\t\titem.node = n;\n\t} else {\n\t\tif ( !item.node ) item.node = doc.createTextNode( text );\n\t\ttarget.appendChild( item.node );\n\t}\n}\n","import { noRegistryFunctionReturn } from '../../../config/errors';\nimport { warnIfDebug } from '../../../utils/log';\nimport parser from '../../../Ractive/config/runtime-parser';\nimport { findInstance } from '../../../shared/registry';\nimport { fillGaps } from '../../../utils/object';\n\nexport default function getPartialTemplate ( ractive, name, parentFragment ) {\n\t// If the partial in instance or view heirarchy instances, great\n\tlet partial = getPartialFromRegistry( ractive, name, parentFragment || {} );\n\tif ( partial ) return partial;\n\n\t// Does it exist on the page as a script tag?\n\tpartial = parser.fromId( name, { noThrow: true } );\n\tif ( partial ) {\n\t\t// parse and register to this ractive instance\n\t\tconst parsed = parser.parseFor( partial, ractive );\n\n\t\t// register extra partials on the ractive instance if they don't already exist\n\t\tif ( parsed.p ) fillGaps( ractive.partials, parsed.p );\n\n\t\t// register (and return main partial if there are others in the template)\n\t\treturn ractive.partials[ name ] = parsed.t;\n\t}\n}\n\nfunction getPartialFromRegistry ( ractive, name, parentFragment ) {\n\t// if there was an instance up-hierarchy, cool\n\tlet partial = findParentPartial( name, parentFragment.owner );\n\tif ( partial ) return partial;\n\n\t// find first instance in the ractive or view hierarchy that has this partial\n\tconst instance = findInstance( 'partials', ractive, name );\n\n\tif ( !instance ) { return; }\n\n\tpartial = instance.partials[ name ];\n\n\t// partial is a function?\n\tlet fn;\n\tif ( typeof partial === 'function' ) {\n\t\tfn = partial.bind( instance );\n\t\tfn.isOwner = instance.partials.hasOwnProperty(name);\n\t\tpartial = fn.call( ractive, parser );\n\t}\n\n\tif ( !partial && partial !== '' ) {\n\t\twarnIfDebug( noRegistryFunctionReturn, name, 'partial', 'partial', { ractive });\n\t\treturn;\n\t}\n\n\t// If this was added manually to the registry,\n\t// but hasn't been parsed, parse it now\n\tif ( !parser.isParsed( partial ) ) {\n\t\t// use the parseOptions of the ractive instance on which it was found\n\t\tconst parsed = parser.parseFor( partial, instance );\n\n\t\t// Partials cannot contain nested partials!\n\t\t// TODO add a test for this\n\t\tif ( parsed.p ) {\n\t\t\twarnIfDebug( 'Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive });\n\t\t}\n\n\t\t// if fn, use instance to store result, otherwise needs to go\n\t\t// in the correct point in prototype chain on instance or constructor\n\t\tconst target = fn ? instance : findOwner( instance, name );\n\n\t\t// may be a template with partials, which need to be registered and main template extracted\n\t\ttarget.partials[ name ] = partial = parsed.t;\n\t}\n\n\t// store for reset\n\tif ( fn ) partial._fn = fn;\n\n\treturn partial.v ? partial.t : partial;\n}\n\nfunction findOwner ( ractive, key ) {\n\treturn ractive.partials.hasOwnProperty( key )\n\t\t? ractive\n\t\t: findConstructor( ractive.constructor, key);\n}\n\nfunction findConstructor ( constructor, key ) {\n\tif ( !constructor ) { return; }\n\treturn constructor.partials.hasOwnProperty( key )\n\t\t? constructor\n\t\t: findConstructor( constructor.Parent, key );\n}\n\nfunction findParentPartial( name, parent ) {\n\tif ( parent ) {\n\t\tif ( parent.template && parent.template.p && parent.template.p[name] ) {\n\t\t\treturn parent.template.p[name];\n\t\t} else if ( parent.parentFragment && parent.parentFragment.owner ) {\n\t\t\treturn findParentPartial( name, parent.parentFragment.owner );\n\t\t}\n\t}\n}\n","import { noRegistryFunctionReturn } from '../../../config/errors';\nimport { warnIfDebug } from '../../../utils/log';\nimport { findInstance } from '../../../shared/registry';\n\n// finds the component constructor in the registry or view hierarchy registries\nexport default function getComponentConstructor ( ractive, name ) {\n\tconst instance = findInstance( 'components', ractive, name );\n\tlet Component;\n\n\tif ( instance ) {\n\t\tComponent = instance.components[ name ];\n\n\t\t// best test we have for not Ractive.extend\n\t\tif ( Component && !Component.Parent ) {\n\t\t\t// function option, execute and store for reset\n\t\t\tconst fn = Component.bind( instance );\n\t\t\tfn.isOwner = instance.components.hasOwnProperty( name );\n\t\t\tComponent = fn();\n\n\t\t\tif ( !Component ) {\n\t\t\t\twarnIfDebug( noRegistryFunctionReturn, name, 'component', 'component', { ractive });\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( typeof Component === 'string' ) {\n\t\t\t\t// allow string lookup\n\t\t\t\tComponent = getComponentConstructor( ractive, Component );\n\t\t\t}\n\n\t\t\tComponent._fn = fn;\n\t\t\tinstance.components[ name ] = Component;\n\t\t}\n\t}\n\n\treturn Component;\n}\n","import { TEXT } from '../../config/types';\n\n// TODO all this code needs to die\nexport default function processItems ( items, values, guid, counter = 0 ) {\n\treturn items.map( item => {\n\t\tif ( item.type === TEXT ) {\n\t\t\treturn item.template;\n\t\t}\n\n\t\tif ( item.fragment ) {\n\t\t\tif ( item.fragment.iterations ) {\n\t\t\t\treturn item.fragment.iterations.map( fragment => {\n\t\t\t\t\treturn processItems( fragment.items, values, guid, counter );\n\t\t\t\t}).join( '' );\n\t\t\t} else {\n\t\t\t\treturn processItems( item.fragment.items, values, guid, counter );\n\t\t\t}\n\t\t}\n\n\t\tconst placeholderId = `${guid}-${counter++}`;\n\t\tconst model = item.model || item.newModel;\n\n\t\tvalues[ placeholderId ] = model ?\n\t\t\tmodel.wrapper ?\n\t\t\t\tmodel.wrapperValue :\n\t\t\t\tmodel.get() :\n\t\t\tundefined;\n\n\t\treturn '${' + placeholderId + '}';\n\t}).join( '' );\n}\n","import { getElement } from '../../utils/dom';\nimport { toArray } from '../../utils/array';\nimport render from '../render';\nimport { teardown } from '../../shared/methodCallers';\nimport { warnIfDebug } from '../../utils/log';\n\nexport default function Ractive$render ( target, anchor ) {\n\tif ( this.torndown ) {\n\t\twarnIfDebug( 'ractive.render() was called on a Ractive instance that was already torn down' );\n\t\treturn Promise.resolve();\n\t}\n\n\ttarget = getElement( target ) || this.el;\n\n\tif ( !this.append && target ) {\n\t\t// Teardown any existing instances *before* trying to set up the new one -\n\t\t// avoids certain weird bugs\n\t\tconst others = target.__ractive_instances__;\n\t\tif ( others ) others.forEach( teardown );\n\n\t\t// make sure we are the only occupants\n\t\tif ( !this.enhance ) {\n\t\t\ttarget.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n\t\t}\n\t}\n\n\tconst occupants = this.enhance ? toArray( target.childNodes ) : null;\n\tconst promise = render( this, target, anchor, occupants );\n\n\tif ( occupants ) {\n\t\twhile ( occupants.length ) target.removeChild( occupants.pop() );\n\t}\n\n\treturn promise;\n}\n","import { default as templateConfigurator } from '../config/custom/template';\nimport { createDocumentFragment } from '../../utils/dom';\nimport Fragment from '../../view/Fragment';\nimport runloop from '../../global/runloop';\n\n// TODO should resetTemplate be asynchronous? i.e. should it be a case\n// of outro, update template, intro? I reckon probably not, since that\n// could be achieved with unrender-resetTemplate-render. Also, it should\n// conceptually be similar to resetPartial, which couldn't be async\n\nexport default function Ractive$resetTemplate ( template ) {\n\ttemplateConfigurator.init( null, this, { template });\n\n\tconst transitionsEnabled = this.transitionsEnabled;\n\tthis.transitionsEnabled = false;\n\n\t// Is this is a component, we need to set the `shouldDestroy`\n\t// flag, otherwise it will assume by default that a parent node\n\t// will be detached, and therefore it doesn't need to bother\n\t// detaching its own nodes\n\tconst component = this.component;\n\tif ( component ) component.shouldDestroy = true;\n\tthis.unrender();\n\tif ( component ) component.shouldDestroy = false;\n\n\tconst promise = runloop.start();\n\n\t// remove existing fragment and create new one\n\tthis.fragment.unbind().unrender( true );\n\n\tthis.fragment = new Fragment({\n\t\ttemplate: this.template,\n\t\troot: this,\n\t\towner: this\n\t});\n\n\tconst docFrag = createDocumentFragment();\n\tthis.fragment.bind( this.viewmodel ).render( docFrag );\n\n\t// if this is a component, its el may not be valid, so find a\n\t// target based on the component container\n\tif ( component && !component.external ) {\n\t\tthis.fragment.findParentNode().insertBefore( docFrag, component.findNextNode() );\n\t} else {\n\t\tthis.el.insertBefore( docFrag, this.anchor );\n\t}\n\n\trunloop.end();\n\n\tthis.transitionsEnabled = transitionsEnabled;\n\n\treturn promise;\n}\n","import { build, set } from '../../shared/set';\n\nexport default function Ractive$set ( keypath, value, options ) {\n\tconst ractive = this;\n\n\tconst opts = typeof keypath === 'object' ? value : options;\n\n\treturn set( ractive, build( ractive, keypath, value, opts && opts.isolated ), opts );\n}\n\n","import add from './shared/add';\n\nexport default function Ractive$subtract ( keypath, d, options ) {\n\tconst num = typeof d === 'number' ? -d : -1;\n\tconst opts = typeof d === 'object' ? d : options;\n\treturn add( this, keypath, num, opts );\n}\n","import { badArguments } from '../../config/errors';\nimport { gather, set } from '../../shared/set';\n\nexport default function Ractive$toggle ( keypath, options ) {\n\tif ( typeof keypath !== 'string' ) {\n\t\tthrow new TypeError( badArguments );\n\t}\n\n\treturn set( this, gather( this, keypath, null, options && options.isolated ).map( m => [ m, !m.get() ] ), options );\n}\n","import { getCSS } from '../../global/css';\n\nexport default function Ractive$toCSS() {\n\tconst cssIds = [ this.cssId, ...this.findAllComponents().map( c => c.cssId ) ];\n\tconst uniqueCssIds = Object.keys(cssIds.reduce( ( ids, id ) => (ids[id] = true, ids), {}));\n\treturn getCSS( uniqueCssIds );\n}\n","export default function Ractive$toHTML () {\n\treturn this.fragment.toString( true );\n}\n","export default function toText () {\n\treturn this.fragment.toString( false );\n}\n","import runloop from '../../global/runloop';\nimport Transition from '../../view/items/element/Transition';\nimport { fatal } from '../../utils/log';\nimport { isObject } from '../../utils/is';\n\nexport default function Ractive$transition ( name, node, params ) {\n\n\tif ( node instanceof HTMLElement ) {\n\t\t// good to go\n\t}\n\telse if ( isObject( node ) ) {\n\t\t// omitted, use event node\n\t\tparams = node;\n\t}\n\n\t// if we allow query selector, then it won't work\n\t// simple params like \"fast\"\n\n\t// else if ( typeof node === 'string' ) {\n\t// \t// query selector\n\t// \tnode = this.find( node )\n\t// }\n\n\tnode = node || this.event.node;\n\n\tif ( !node || !node._ractive ) {\n\t\tfatal( `No node was supplied for transition ${name}` );\n\t}\n\n\tparams = params || {};\n\tconst owner = node._ractive.proxy;\n\tconst transition = new Transition({ owner, parentFragment: owner.parentFragment, name, params });\n\ttransition.bind();\n\n\tconst promise = runloop.start( this, true );\n\trunloop.registerTransition( transition );\n\trunloop.end();\n\n\tpromise.then( () => transition.unbind() );\n\treturn promise;\n}\n","import { splitKeypath } from '../../shared/keypaths';\nimport runloop from '../../global/runloop';\n\nexport default function unlink( here ) {\n\tconst promise = runloop.start();\n\tthis.viewmodel.joinAll( splitKeypath( here ), { lastLink: false } ).unlink();\n\trunloop.end();\n\treturn promise;\n}\n","import { splitKeypath } from '../../shared/keypaths';\nimport runloop from '../../global/runloop';\n\nexport default function Ractive$updateModel ( keypath, cascade ) {\n\tconst promise = runloop.start( this, true );\n\n\tif ( !keypath ) {\n\t\tthis.viewmodel.updateFromBindings( true );\n\t} else {\n\t\tthis.viewmodel.joinAll( splitKeypath( keypath ) ).updateFromBindings( cascade !== false );\n\t}\n\n\trunloop.end();\n\n\treturn promise;\n}\n","export default function isInstance ( object ) {\n\treturn object && object instanceof this;\n}\n","import { escapeKey, splitKeypath as splitKeypathI, unescapeKey } from '../../shared/keypaths';\n\nexport function joinKeys ( ...keys ) {\n\treturn keys.map( escapeKey ).join( '.' );\n}\n\nexport function splitKeypath ( keypath ) {\n\treturn splitKeypathI( keypath ).map( unescapeKey );\n}\n","import { findInViewHierarchy } from '../../shared/registry';\n\nexport function findPlugin(name, type, instance) {\n\treturn findInViewHierarchy(type, instance, name);\n}\n","export default {\n\t// render placement:\n\tel:                     void 0,\n\tappend:                 false,\n\tdelegate:               true,\n\n\t// template:\n\ttemplate:               null,\n\n\t// parse:\n\tdelimiters:             [ '{{', '}}' ],\n\ttripleDelimiters:       [ '{{{', '}}}' ],\n\tstaticDelimiters:       [ '[[', ']]' ],\n\tstaticTripleDelimiters: [ '[[[', ']]]' ],\n\tcsp:                    true,\n\tinterpolate:            false,\n\tpreserveWhitespace:     false,\n\tsanitize:               false,\n\tstripComments:          true,\n\tcontextLines:           0,\n\tparserTransforms:       [],\n\n\t// data & binding:\n\tdata:                   {},\n\tcomputed:               {},\n\tsyncComputedChildren:   false,\n\tresolveInstanceMembers: true,\n\twarnAboutAmbiguity:     false,\n\tadapt:                  [],\n\tisolated:               true,\n\ttwoway:                 true,\n\tlazy:                   false,\n\n\t// transitions:\n\tnoIntro:                false,\n\tnoOutro:                false,\n\ttransitionsEnabled:     true,\n\tcomplete:               void 0,\n\tnestedTransitions:      true,\n\n\t// css:\n\tcss:                    null,\n\tnoCssTransform:         false\n};\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { hasConsole } from '../config/environment';\nimport Ractive from '../Ractive';\nimport noop from './noop';\n\nconst alreadyWarned = {};\nlet log, printWarning, welcome;\n\nif ( hasConsole ) {\n\tconst welcomeIntro = [\n\t\t`%cRactive.js %cBUILD_PLACEHOLDER_VERSION %cin debug mode, %cmore...`,\n\t\t'color: rgb(114, 157, 52); font-weight: normal;',\n\t\t'color: rgb(85, 85, 85); font-weight: normal;',\n\t\t'color: rgb(85, 85, 85); font-weight: normal;',\n\t\t'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n\t];\n\tconst welcomeMessage = `You're running Ractive BUILD_PLACEHOLDER_VERSION in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://docs.ractivejs.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n`;\n\n\twelcome = () => {\n\t\tif ( Ractive.WELCOME_MESSAGE === false ) {\n\t\t\twelcome = noop;\n\t\t\treturn;\n\t\t}\n\t\tconst message = 'WELCOME_MESSAGE' in Ractive ? Ractive.WELCOME_MESSAGE : welcomeMessage;\n\t\tconst hasGroup = !!console.groupCollapsed;\n\t\tif ( hasGroup ) console.groupCollapsed.apply( console, welcomeIntro );\n\t\tconsole.log( message );\n\t\tif ( hasGroup ) {\n\t\t\tconsole.groupEnd( welcomeIntro );\n\t\t}\n\n\t\twelcome = noop;\n\t};\n\n\tprintWarning = ( message, args ) => {\n\t\twelcome();\n\n\t\t// extract information about the instance this message pertains to, if applicable\n\t\tif ( typeof args[ args.length - 1 ] === 'object' ) {\n\t\t\tconst options = args.pop();\n\t\t\tconst ractive = options ? options.ractive : null;\n\n\t\t\tif ( ractive ) {\n\t\t\t\t// if this is an instance of a component that we know the name of, add\n\t\t\t\t// it to the message\n\t\t\t\tlet name;\n\t\t\t\tif ( ractive.component && ( name = ractive.component.name ) ) {\n\t\t\t\t\tmessage = `<${name}> ${message}`;\n\t\t\t\t}\n\n\t\t\t\tlet node;\n\t\t\t\tif ( node = ( options.node || ( ractive.fragment && ractive.fragment.rendered && ractive.find( '*' ) ) ) ) {\n\t\t\t\t\targs.push( node );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconsole.warn.apply( console, [ '%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);' ].concat( args ) );\n\t};\n\n\tlog = function () {\n\t\tconsole.log.apply( console, arguments );\n\t};\n} else {\n\tprintWarning = log = welcome = noop;\n}\n\nfunction format ( message, args ) {\n\treturn message.replace( /%s/g, () => args.shift() );\n}\n\nfunction fatal ( message, ...args ) {\n\tmessage = format( message, args );\n\tthrow new Error( message );\n}\n\nfunction logIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\tlog.apply( null, arguments );\n\t}\n}\n\nfunction warn ( message, ...args ) {\n\tmessage = format( message, args );\n\tprintWarning( message, args );\n}\n\nfunction warnOnce ( message, ...args ) {\n\tmessage = format( message, args );\n\n\tif ( alreadyWarned[ message ] ) {\n\t\treturn;\n\t}\n\n\talreadyWarned[ message ] = true;\n\tprintWarning( message, args );\n}\n\nfunction warnIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\twarn.apply( null, arguments );\n\t}\n}\n\nfunction warnOnceIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\twarnOnce.apply( null, arguments );\n\t}\n}\n\nexport { fatal, log, logIfDebug, warn, warnOnce, warnIfDebug, warnOnceIfDebug, welcome };\n","// These are a subset of the easing equations found at\n// https://raw.github.com/danro/easing-js - license info\n// follows:\n\n// --------------------------------------------------\n// easing.js v0.5.4\n// Generic set of easing functions with AMD support\n// https://github.com/danro/easing-js\n// This code may be freely distributed under the MIT license\n// http://danro.mit-license.org/\n// --------------------------------------------------\n// All functions adapted from Thomas Fuchs & Jeremy Kahn\n// Easing Equations (c) 2003 Robert Penner, BSD license\n// https://raw.github.com/danro/easing-js/master/LICENSE\n// --------------------------------------------------\n\n// In that library, the functions named easeIn, easeOut, and\n// easeInOut below are named easeInCubic, easeOutCubic, and\n// (you guessed it) easeInOutCubic.\n//\n// You can add additional easing functions to this list, and they\n// will be globally available.\n\n\nexport default {\n\tlinear ( pos ) { return pos; },\n\teaseIn ( pos ) { return Math.pow( pos, 3 ); },\n\teaseOut ( pos ) { return ( Math.pow( ( pos - 1 ), 3 ) + 1 ); },\n\teaseInOut ( pos ) {\n\t\tif ( ( pos /= 0.5 ) < 1 ) { return ( 0.5 * Math.pow( pos, 3 ) ); }\n\t\treturn ( 0.5 * ( Math.pow( ( pos - 2 ), 3 ) + 2 ) );\n\t}\n};\n","const toString = Object.prototype.toString;\nconst arrayLikePattern = /^\\[object (?:Array|FileList)\\]$/;\n\nexport function isArrayLike ( obj ) {\n\treturn arrayLikePattern.test( toString.call( obj ) );\n}\n\nexport function isEqual ( a, b ) {\n\tif ( a === null && b === null ) {\n\t\treturn true;\n\t}\n\n\tif ( typeof a === 'object' || typeof b === 'object' ) {\n\t\treturn false;\n\t}\n\n\treturn a === b;\n}\n\n// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\nexport function isNumeric ( thing ) {\n\treturn !isNaN( parseFloat( thing ) ) && isFinite( thing );\n}\n\nexport function isObject ( thing ) {\n\treturn ( thing && toString.call( thing ) === '[object Object]' );\n}\n\nexport function isObjectLike ( thing ) {\n\tif ( !thing ) return false;\n\tconst type = typeof thing;\n\tif ( type === 'object' || type === 'function' ) return true;\n}\n","/* eslint no-console:\"off\" */\nconst win = typeof window !== 'undefined' ? window : null;\nconst doc = win ? document : null;\nconst isClient = !!doc;\nconst hasConsole = ( typeof console !== 'undefined' && typeof console.warn === 'function' && typeof console.warn.apply === 'function' );\n\nconst svg = doc ?\n\tdoc.implementation.hasFeature( 'http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1' ) :\n\tfalse;\n\nconst vendors = [ 'o', 'ms', 'moz', 'webkit' ];\n\nexport { win, doc, isClient, hasConsole, svg, vendors };\n","export default function () {}\n","// Error messages that are used (or could be) in multiple places\nexport const badArguments = 'Bad arguments';\nexport const noRegistryFunctionReturn = 'A function was specified for \"%s\" %s, but no %s was returned';\nexport const missingPlugin = ( name, type ) => `Missing \"${name}\" ${type} plugin. You may need to download a plugin via http://docs.ractivejs.org/latest/plugins#${type}s`;\n","import { isObject, isNumeric } from '../../utils/is';\nimport interpolate from '../../shared/interpolate';\n\nfunction snap ( to ) {\n\treturn () => to;\n}\n\nconst interpolators = {\n\tnumber ( from, to ) {\n\t\tif ( !isNumeric( from ) || !isNumeric( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tfrom = +from;\n\t\tto = +to;\n\n\t\tconst delta = to - from;\n\n\t\tif ( !delta ) {\n\t\t\treturn function () { return from; };\n\t\t}\n\n\t\treturn function ( t ) {\n\t\t\treturn from + ( t * delta );\n\t\t};\n\t},\n\n\tarray ( from, to ) {\n\t\tlet len, i;\n\n\t\tif ( !Array.isArray( from ) || !Array.isArray( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst intermediate = [];\n\t\tconst interpolators = [];\n\n\t\ti = len = Math.min( from.length, to.length );\n\t\twhile ( i-- ) {\n\t\t\tinterpolators[i] = interpolate( from[i], to[i] );\n\t\t}\n\n\t\t// surplus values - don't interpolate, but don't exclude them either\n\t\tfor ( i=len; i<from.length; i+=1 ) {\n\t\t\tintermediate[i] = from[i];\n\t\t}\n\n\t\tfor ( i=len; i<to.length; i+=1 ) {\n\t\t\tintermediate[i] = to[i];\n\t\t}\n\n\t\treturn function ( t ) {\n\t\t\tlet i = len;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tintermediate[i] = interpolators[i]( t );\n\t\t\t}\n\n\t\t\treturn intermediate;\n\t\t};\n\t},\n\n\tobject ( from, to ) {\n\t\tif ( !isObject( from ) || !isObject( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst properties = [];\n\t\tconst intermediate = {};\n\t\tconst interpolators = {};\n\n\t\tfor ( const prop in from ) {\n\t\t\tif ( from.hasOwnProperty( prop ) ) {\n\t\t\t\tif ( to.hasOwnProperty( prop ) ) {\n\t\t\t\t\tproperties.push( prop );\n\t\t\t\t\tinterpolators[ prop ] = interpolate( from[ prop ], to[ prop ] ) || snap( to[ prop ] );\n\t\t\t\t}\n\n\t\t\t\telse {\n\t\t\t\t\tintermediate[ prop ] = from[ prop ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor ( const prop in to ) {\n\t\t\tif ( to.hasOwnProperty( prop ) && !from.hasOwnProperty( prop ) ) {\n\t\t\t\tintermediate[ prop ] = to[ prop ];\n\t\t\t}\n\t\t}\n\n\t\tconst len = properties.length;\n\n\t\treturn function ( t ) {\n\t\t\tlet i = len;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tconst prop = properties[i];\n\n\t\t\t\tintermediate[ prop ] = interpolators[ prop ]( t );\n\t\t\t}\n\n\t\t\treturn intermediate;\n\t\t};\n\t}\n};\n\nexport default interpolators;\n","import { removeFromArray } from '../utils/array';\n\nexport default class TransitionManager {\n\tconstructor ( callback, parent ) {\n\t\tthis.callback = callback;\n\t\tthis.parent = parent;\n\n\t\tthis.intros = [];\n\t\tthis.outros = [];\n\n\t\tthis.children = [];\n\t\tthis.totalChildren = this.outroChildren = 0;\n\n\t\tthis.detachQueue = [];\n\t\tthis.outrosComplete = false;\n\n\t\tif ( parent ) {\n\t\t\tparent.addChild( this );\n\t\t}\n\t}\n\n\tadd ( transition ) {\n\t\tconst list = transition.isIntro ? this.intros : this.outros;\n\t\ttransition.starting = true;\n\t\tlist.push( transition );\n\t}\n\n\taddChild ( child ) {\n\t\tthis.children.push( child );\n\n\t\tthis.totalChildren += 1;\n\t\tthis.outroChildren += 1;\n\t}\n\n\tdecrementOutros () {\n\t\tthis.outroChildren -= 1;\n\t\tcheck( this );\n\t}\n\n\tdecrementTotal () {\n\t\tthis.totalChildren -= 1;\n\t\tcheck( this );\n\t}\n\n\tdetachNodes () {\n\t\tthis.detachQueue.forEach( detach );\n\t\tthis.children.forEach( _detachNodes );\n\t\tthis.detachQueue = [];\n\t}\n\n\tready () {\n\t\tif ( this.detachQueue.length ) detachImmediate( this );\n\t}\n\n\tremove ( transition ) {\n\t\tconst list = transition.isIntro ? this.intros : this.outros;\n\t\tremoveFromArray( list, transition );\n\t\tcheck( this );\n\t}\n\n\tstart () {\n\t\tthis.children.forEach( c => c.start() );\n\t\tthis.intros.concat( this.outros ).forEach( t => t.start() );\n\t\tthis.ready = true;\n\t\tcheck( this );\n\t}\n}\n\nfunction detach ( element ) {\n\telement.detach();\n}\n\nfunction _detachNodes ( tm ) { // _ to avoid transpiler quirk\n\ttm.detachNodes();\n}\n\nfunction check ( tm ) {\n\tif ( !tm.ready || tm.outros.length || tm.outroChildren ) return;\n\n\t// If all outros are complete, and we haven't already done this,\n\t// we notify the parent if there is one, otherwise\n\t// start detaching nodes\n\tif ( !tm.outrosComplete ) {\n\t\ttm.outrosComplete = true;\n\n\t\tif ( tm.parent && !tm.parent.outrosComplete ) {\n\t\t\ttm.parent.decrementOutros( tm );\n\t\t} else {\n\t\t\ttm.detachNodes();\n\t\t}\n\t}\n\n\t// Once everything is done, we can notify parent transition\n\t// manager and call the callback\n\tif ( !tm.intros.length && !tm.totalChildren ) {\n\t\tif ( typeof tm.callback === 'function' ) {\n\t\t\ttm.callback();\n\t\t}\n\n\t\tif ( tm.parent && !tm.notifiedTotal ) {\n\t\t\ttm.notifiedTotal = true;\n\t\t\ttm.parent.decrementTotal();\n\t\t}\n\t}\n}\n\n// check through the detach queue to see if a node is up or downstream from a\n// transition and if not, go ahead and detach it\nfunction detachImmediate ( manager ) {\n\tconst queue = manager.detachQueue;\n\tconst outros = collectAllOutros( manager );\n\n\tlet i = queue.length;\n\tlet j = 0;\n\tlet node, trans;\n\tstart: while ( i-- ) {\n\t\tnode = queue[i].node;\n\t\tj = outros.length;\n\t\twhile ( j-- ) {\n\t\t\ttrans = outros[j].element.node;\n\t\t\t// check to see if the node is, contains, or is contained by the transitioning node\n\t\t\tif ( trans === node || trans.contains( node ) || node.contains( trans ) ) continue start;\n\t\t}\n\n\t\t// no match, we can drop it\n\t\tqueue[i].detach();\n\t\tqueue.splice( i, 1 );\n\t}\n}\n\nfunction collectAllOutros ( manager, _list ) {\n\tlet list = _list;\n\n\t// if there's no list, we're starting at the root to build one\n\tif ( !list ) {\n\t\tlist = [];\n\t\tlet parent = manager;\n\t\twhile ( parent.parent ) parent = parent.parent;\n\t\treturn collectAllOutros( parent, list );\n\t} else {\n\t\t// grab all outros from child managers\n\t\tlet i = manager.children.length;\n\t\twhile ( i-- ) {\n\t\t\tlist = collectAllOutros( manager.children[i], list );\n\t\t}\n\n\t\t// grab any from this manager if there are any\n\t\tif ( manager.outros.length ) list = list.concat( manager.outros );\n\n\t\treturn list;\n\t}\n}\n","import { addToArray } from '../utils/array';\nimport TransitionManager from './TransitionManager';\n\nlet batch;\n\nconst runloop = {\n\tstart ( instance ) {\n\t\tlet fulfilPromise;\n\t\tconst promise = new Promise( f => ( fulfilPromise = f ) );\n\n\t\tbatch = {\n\t\t\tpreviousBatch: batch,\n\t\t\ttransitionManager: new TransitionManager( fulfilPromise, batch && batch.transitionManager ),\n\t\t\tfragments: [],\n\t\t\ttasks: [],\n\t\t\timmediateObservers: [],\n\t\t\tdeferredObservers: [],\n\t\t\tinstance,\n\t\t\tpromise\n\t\t};\n\n\t\treturn promise;\n\t},\n\n\tend () {\n\t\tflushChanges();\n\n\t\tif ( !batch.previousBatch ) batch.transitionManager.start();\n\n\t\tbatch = batch.previousBatch;\n\t},\n\n\taddFragment ( fragment ) {\n\t\taddToArray( batch.fragments, fragment );\n\t},\n\n\t// TODO: come up with a better way to handle fragments that trigger their own update\n\taddFragmentToRoot ( fragment ) {\n\t\tif ( !batch ) return;\n\n\t\tlet b = batch;\n\t\twhile ( b.previousBatch ) {\n\t\t\tb = b.previousBatch;\n\t\t}\n\n\t\taddToArray( b.fragments, fragment );\n\t},\n\n\taddObserver ( observer, defer ) {\n\t\tif ( !batch ) {\n\t\t\tobserver.dispatch();\n\t\t} else {\n\t\t\taddToArray( defer ? batch.deferredObservers : batch.immediateObservers, observer );\n\t\t}\n\t},\n\n\tregisterTransition ( transition ) {\n\t\ttransition._manager = batch.transitionManager;\n\t\tbatch.transitionManager.add( transition );\n\t},\n\n\t// synchronise node detachments with transition ends\n\tdetachWhenReady ( thing ) {\n\t\tbatch.transitionManager.detachQueue.push( thing );\n\t},\n\n\tscheduleTask ( task, postRender ) {\n\t\tlet _batch;\n\n\t\tif ( !batch ) {\n\t\t\ttask();\n\t\t} else {\n\t\t\t_batch = batch;\n\t\t\twhile ( postRender && _batch.previousBatch ) {\n\t\t\t\t// this can't happen until the DOM has been fully updated\n\t\t\t\t// otherwise in some situations (with components inside elements)\n\t\t\t\t// transitions and decorators will initialise prematurely\n\t\t\t\t_batch = _batch.previousBatch;\n\t\t\t}\n\n\t\t\t_batch.tasks.push( task );\n\t\t}\n\t},\n\n\tpromise () {\n\t\tif ( !batch ) return Promise.resolve();\n\n\t\tlet target = batch;\n\t\twhile ( target.previousBatch ) {\n\t\t\ttarget = target.previousBatch;\n\t\t}\n\n\t\treturn target.promise || Promise.resolve();\n\t}\n};\n\nexport default runloop;\n\nfunction dispatch ( observer ) {\n\tobserver.dispatch();\n}\n\nfunction flushChanges () {\n\tlet which = batch.immediateObservers;\n\tbatch.immediateObservers = [];\n\twhich.forEach( dispatch );\n\n\t// Now that changes have been fully propagated, we can update the DOM\n\t// and complete other tasks\n\tlet i = batch.fragments.length;\n\tlet fragment;\n\n\twhich = batch.fragments;\n\tbatch.fragments = [];\n\n\twhile ( i-- ) {\n\t\tfragment = which[i];\n\t\tfragment.update();\n\t}\n\n\tbatch.transitionManager.ready();\n\n\twhich = batch.deferredObservers;\n\tbatch.deferredObservers = [];\n\twhich.forEach( dispatch );\n\n\tconst tasks = batch.tasks;\n\tbatch.tasks = [];\n\n\tfor ( i = 0; i < tasks.length; i += 1 ) {\n\t\ttasks[i]();\n\t}\n\n\t// If updating the view caused some model blowback - e.g. a triple\n\t// containing <option> elements caused the binding on the <select>\n\t// to update - then we start over\n\tif ( batch.fragments.length || batch.immediateObservers.length || batch.deferredObservers.length || batch.tasks.length ) return flushChanges();\n}\n","const stack = [];\nlet captureGroup;\n\nexport function startCapturing () {\n\tstack.push( captureGroup = [] );\n}\n\nexport function stopCapturing () {\n\tconst dependencies = stack.pop();\n\tcaptureGroup = stack[ stack.length - 1 ];\n\treturn dependencies;\n}\n\nexport function capture ( model ) {\n\tif ( captureGroup ) {\n\t\tcaptureGroup.push( model );\n\t}\n}\n","const refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\nconst splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\nconst escapeKeyPattern = /\\\\|\\./g;\nconst unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\n\nexport function escapeKey ( key ) {\n\tif ( typeof key === 'string' ) {\n\t\treturn key.replace( escapeKeyPattern, '\\\\$&' );\n\t}\n\n\treturn key;\n}\n\nexport function normalise ( ref ) {\n\treturn ref ? ref.replace( refPattern, '.$1' ) : '';\n}\n\nexport function splitKeypath ( keypath ) {\n\tconst result = [];\n\tlet match;\n\n\tkeypath = normalise( keypath );\n\n\twhile ( match = splitPattern.exec( keypath ) ) {\n\t\tconst index = match.index + match[1].length;\n\t\tresult.push( keypath.substr( 0, index ) );\n\t\tkeypath = keypath.substr( index + 1 );\n\t}\n\n\tresult.push( keypath );\n\n\treturn result;\n}\n\nexport function unescapeKey ( key ) {\n\tif ( typeof key === 'string' ) {\n\t\treturn key.replace( unescapeKeyPattern, '$1$2' );\n\t}\n\n\treturn key;\n}\n","import { addToArray, removeFromArray } from '../../utils/array';\nimport { unescapeKey } from '../../shared/keypaths';\nimport { capture } from '../../global/capture';\nimport noop from '../../utils/noop';\n\nexport default class KeyModel {\n\tconstructor ( key, parent ) {\n\t\tthis.value = key;\n\t\tthis.isReadonly = this.isKey = true;\n\t\tthis.deps = [];\n\t\tthis.links = [];\n\t\tthis.parent = parent;\n\t}\n\n\tget ( shouldCapture ) {\n\t\tif ( shouldCapture ) capture( this );\n\t\treturn unescapeKey( this.value );\n\t}\n\n\tgetKeypath () {\n\t\treturn unescapeKey( this.value );\n\t}\n\n\trebind ( next, previous ) {\n\t\tlet i = this.deps.length;\n\t\twhile ( i-- ) this.deps[i].rebind( next, previous, false );\n\n\t\ti = this.links.length;\n\t\twhile ( i-- ) this.links[i].rebind( next, previous, false );\n\t}\n\n\tregister ( dependant ) {\n\t\tthis.deps.push( dependant );\n\t}\n\n\tregisterLink ( link ) {\n\t\taddToArray( this.links, link );\n\t}\n\n\tunregister ( dependant ) {\n\t\tremoveFromArray( this.deps, dependant );\n\t}\n\n\tunregisterLink ( link ) {\n\t\tremoveFromArray( this.links, link );\n\t}\n}\n\nKeyModel.prototype.reference = noop;\nKeyModel.prototype.unreference = noop;\n","import { removeFromArray } from '../../utils/array';\nimport { handleChange } from '../../shared/methodCallers';\nimport { capture } from '../../global/capture';\nimport noop from '../../utils/noop';\n\nexport default class KeypathModel {\n\tconstructor ( parent, ractive ) {\n\t\tthis.parent = parent;\n\t\tthis.ractive = ractive;\n\t\tthis.value = ractive ? parent.getKeypath( ractive ) : parent.getKeypath();\n\t\tthis.deps = [];\n\t\tthis.children = {};\n\t\tthis.isReadonly = this.isKeypath = true;\n\t}\n\n\tget ( shouldCapture ) {\n\t\tif ( shouldCapture ) capture( this );\n\t\treturn this.value;\n\t}\n\n\tgetChild ( ractive ) {\n\t\tif ( !( ractive._guid in this.children ) ) {\n\t\t\tconst model = new KeypathModel( this.parent, ractive );\n\t\t\tthis.children[ ractive._guid ] = model;\n\t\t\tmodel.owner = this;\n\t\t}\n\t\treturn this.children[ ractive._guid ];\n\t}\n\n\tgetKeypath () {\n\t\treturn this.value;\n\t}\n\n\thandleChange () {\n\t\tconst keys = Object.keys( this.children );\n\t\tlet i = keys.length;\n\t\twhile ( i-- ) {\n\t\t\tthis.children[ keys[i] ].handleChange();\n\t\t}\n\n\t\tthis.deps.forEach( handleChange );\n\t}\n\n\trebindChildren ( next ) {\n\t\tconst keys = Object.keys( this.children );\n\t\tlet i = keys.length;\n\t\twhile ( i-- ) {\n\t\t\tconst child = this.children[keys[i]];\n\t\t\tchild.value = next.getKeypath( child.ractive );\n\t\t\tchild.handleChange();\n\t\t}\n\t}\n\n\trebind ( next, previous ) {\n\t\tconst model = next ? next.getKeypathModel( this.ractive ) : undefined;\n\n\t\tconst keys = Object.keys( this.children );\n\t\tlet i = keys.length;\n\t\twhile ( i-- ) {\n\t\t\tthis.children[ keys[i] ].rebind( next, previous, false );\n\t\t}\n\n\t\ti = this.deps.length;\n\t\twhile ( i-- ) {\n\t\t\tthis.deps[i].rebind( model, this, false );\n\t\t}\n\t}\n\n\tregister ( dep ) {\n\t\tthis.deps.push( dep );\n\t}\n\n\tremoveChild( model ) {\n\t\tif ( model.ractive ) delete this.children[ model.ractive._guid ];\n\t}\n\n\tteardown () {\n\t\tif ( this.owner ) this.owner.removeChild( this );\n\n\t\tconst keys = Object.keys( this.children );\n\t\tlet i = keys.length;\n\t\twhile ( i-- ) {\n\t\t\tthis.children[ keys[i] ].teardown();\n\t\t}\n\t}\n\n\tunregister ( dep ) {\n\t\tremoveFromArray( this.deps, dep );\n\t\tif ( !this.deps.length ) this.teardown();\n\t}\n}\n\nKeypathModel.prototype.reference = noop;\nKeypathModel.prototype.unreference = noop;\n","const fnBind = Function.prototype.bind;\n\nexport default function bind ( fn, context ) {\n\tif ( !/this/.test( fn.toString() ) ) return fn;\n\n\tconst bound = fnBind.call( fn, context );\n\tfor ( const prop in fn ) bound[ prop ] = fn[ prop ];\n\n\treturn bound;\n}\n","export function findInViewHierarchy ( registryName, ractive, name ) {\n\tconst instance = findInstance( registryName, ractive, name );\n\treturn instance ? instance[ registryName ][ name ] : null;\n}\n\nexport function findInstance ( registryName, ractive, name ) {\n\twhile ( ractive ) {\n\t\tif ( name in ractive[ registryName ] ) {\n\t\t\treturn ractive;\n\t\t}\n\n\t\tif ( ractive.isolated ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tractive = ractive.parent;\n\t}\n}","import { fatal } from '../utils/log';\nimport { missingPlugin } from '../config/errors';\nimport interpolators from '../Ractive/static/interpolators';\nimport { findInViewHierarchy } from './registry';\n\nexport default function interpolate ( from, to, ractive, type ) {\n\tif ( from === to ) return null;\n\n\tif ( type ) {\n\t\tconst interpol = findInViewHierarchy( 'interpolators', ractive, type );\n\t\tif ( interpol ) return interpol( from, to ) || null;\n\n\t\tfatal( missingPlugin( type, 'interpolator' ) );\n\t}\n\n\treturn interpolators.number( from, to ) ||\n\t       interpolators.array( from, to ) ||\n\t       interpolators.object( from, to ) ||\n\t       null;\n}\n","export function addToArray ( array, value ) {\n\tconst index = array.indexOf( value );\n\n\tif ( index === -1 ) {\n\t\tarray.push( value );\n\t}\n}\n\nexport function arrayContains ( array, value ) {\n\tfor ( let i = 0, c = array.length; i < c; i++ ) {\n\t\tif ( array[i] == value ) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nexport function arrayContentsMatch ( a, b ) {\n\tlet i;\n\n\tif ( !Array.isArray( a ) || !Array.isArray( b ) ) {\n\t\treturn false;\n\t}\n\n\tif ( a.length !== b.length ) {\n\t\treturn false;\n\t}\n\n\ti = a.length;\n\twhile ( i-- ) {\n\t\tif ( a[i] !== b[i] ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nexport function ensureArray ( x ) {\n\tif ( typeof x === 'string' ) {\n\t\treturn [ x ];\n\t}\n\n\tif ( x === undefined ) {\n\t\treturn [];\n\t}\n\n\treturn x;\n}\n\nexport function lastItem ( array ) {\n\treturn array[ array.length - 1 ];\n}\n\nexport function removeFromArray ( array, member ) {\n\tif ( !array ) {\n\t\treturn;\n\t}\n\n\tconst index = array.indexOf( member );\n\n\tif ( index !== -1 ) {\n\t\tarray.splice( index, 1 );\n\t}\n}\n\nexport function combine ( ...arrays ) {\n\tconst res = arrays.concat.apply( [], arrays );\n\tlet i = res.length;\n\twhile ( i-- ) {\n\t\tconst idx = res.indexOf( res[i] );\n\t\tif ( ~idx && idx < i ) res.splice( i, 1 );\n\t}\n\n\treturn res;\n}\n\nexport function toArray ( arrayLike ) {\n\tconst array = [];\n\tlet i = arrayLike.length;\n\twhile ( i-- ) {\n\t\tarray[i] = arrayLike[i];\n\t}\n\n\treturn array;\n}\n\nexport function findMap ( array, fn ) {\n\tconst len = array.length;\n\tfor ( let i = 0; i < len; i++ ) {\n\t\tconst result = fn( array[i] );\n\t\tif ( result ) return result;\n\t}\n}\n","export function bind               ( x ) { x.bind(); }\nexport function cancel             ( x ) { x.cancel(); }\nexport function destroyed          ( x ) { x.destroyed(); }\nexport function handleChange       ( x ) { x.handleChange(); }\nexport function mark               ( x ) { x.mark(); }\nexport function markForce          ( x ) { x.mark( true ); }\nexport function marked             ( x ) { x.marked(); }\nexport function markedAll          ( x ) { x.markedAll(); }\nexport function render             ( x ) { x.render(); }\nexport function shuffled           ( x ) { x.shuffled(); }\nexport function teardown           ( x ) { x.teardown(); }\nexport function unbind             ( x ) { x.unbind(); }\nexport function unrender           ( x ) { x.unrender(); }\nexport function unrenderAndDestroy ( x ) { x.unrender( true ); }\nexport function update             ( x ) { x.update(); }\nexport function toString           ( x ) { return x.toString(); }\nexport function toEscapedString    ( x ) { return x.toString( true ); }\n","import { splitKeypath } from './keypaths';\n\n// this is the dry method of checking to see if a rebind applies to\n// a particular keypath because in some cases, a dep may be bound\n// directly to a particular keypath e.g. foo.bars.0.baz and need\n// to avoid getting kicked to foo.bars.1.baz if foo.bars is unshifted\nexport function rebindMatch ( template, next, previous, fragment ) {\n\tconst keypath = template.r || template;\n\n\t// no valid keypath, go with next\n\tif ( !keypath || typeof keypath !== 'string' ) return next;\n\n\t// completely contextual ref, go with next\n\tif ( keypath === '.' || keypath[0] === '@' || ( next || previous ).isKey || ( next || previous ).isKeypath ) return next;\n\n\tconst parts = keypath.split( '/' );\n\tlet keys = splitKeypath( parts[ parts.length - 1 ] );\n\tconst last = keys[ keys.length - 1 ];\n\n\t// check the keypath against the model keypath to see if it matches\n\tlet model = next || previous;\n\n\t// check to see if this was an alias\n\tif ( model && keys.length === 1 && last !== model.key && fragment ) {\n\t\tkeys = findAlias( last, fragment ) || keys;\n\t}\n\n\tlet i = keys.length;\n\tlet match = true;\n\tlet shuffling = false;\n\n\twhile ( model && i-- ) {\n\t\tif ( model.shuffling ) shuffling = true;\n\t\t// non-strict comparison to account for indices in keypaths\n\t\tif ( keys[i] != model.key ) match = false;\n\t\tmodel = model.parent;\n\t}\n\n\t// next is undefined, but keypath is shuffling and previous matches\n\tif ( !next && match && shuffling ) return previous;\n\t// next is defined, but doesn't match the keypath\n\telse if ( next && !match && shuffling ) return previous;\n\telse return next;\n}\n\nfunction findAlias ( name, fragment ) {\n\twhile ( fragment ) {\n\t\tconst z = fragment.aliases;\n\t\tif ( z && z[ name ] ) {\n\t\t\tconst aliases = ( fragment.owner.iterations ? fragment.owner : fragment ).owner.template.z;\n\t\t\tfor ( let i = 0; i < aliases.length; i++ ) {\n\t\t\t\tif ( aliases[i].n === name ) {\n\t\t\t\t\tconst alias = aliases[i].x;\n\t\t\t\t\tif ( !alias.r ) return false;\n\t\t\t\t\tconst parts = alias.r.split( '/' );\n\t\t\t\t\treturn splitKeypath( parts[ parts.length - 1 ] );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tfragment = fragment.componentParent || fragment.parent;\n\t}\n}\n","import add from './shared/add';\n\nexport default function Ractive$add ( keypath, d, options ) {\n\tconst num = typeof d === 'number' ? d : 1;\n\tconst opts = typeof d === 'object' ? d : options;\n\treturn add( this, keypath, num, opts );\n}\n","export function enqueue ( ractive, event ) {\n\tif ( ractive.event ) {\n\t\tractive._eventQueue.push( ractive.event );\n\t}\n\n\tractive.event = event;\n}\n\nexport function dequeue ( ractive ) {\n\tif ( ractive._eventQueue.length ) {\n\t\tractive.event = ractive._eventQueue.pop();\n\t} else {\n\t\tractive.event = null;\n\t}\n}\n","export function findAnchors ( fragment, name = null ) {\n\tconst res = [];\n\n\tfindAnchorsIn( fragment, name, res );\n\n\treturn res;\n}\n\nfunction findAnchorsIn ( item, name, result ) {\n\tif ( item.isAnchor ) {\n\t\tif ( !name || item.name === name ) {\n\t\t\tresult.push( item );\n\t\t}\n\t} else if ( item.items ) {\n\t\titem.items.forEach( i => findAnchorsIn( i, name, result ) );\n\t} else if ( item.iterations ) {\n\t\titem.iterations.forEach( i => findAnchorsIn( i, name, result ) );\n\t} else if ( item.fragment && !item.component ) {\n\t\tfindAnchorsIn( item.fragment, name, result );\n\t}\n}\n\nexport function updateAnchors ( instance, name = null ) {\n\tconst anchors = findAnchors( instance.fragment, name );\n\tconst idxs = {};\n\tconst children = instance._children.byName;\n\n\tanchors.forEach( a => {\n\t\tconst name = a.name;\n\t\tif ( !( name in idxs ) ) idxs[name] = 0;\n\t\tconst idx = idxs[name];\n\t\tconst child = ( children[name] || [] )[idx];\n\n\t\tif ( child && child.lastBound !== a ) {\n\t\t\tif ( child.lastBound ) child.lastBound.removeChild( child );\n\t\t\ta.addChild( child );\n\t\t}\n\n\t\tidxs[name]++;\n\t});\n}\n\nexport function unrenderChild ( meta ) {\n\tif ( meta.instance.fragment.rendered ) {\n\t\tmeta.shouldDestroy = true;\n\t\tmeta.instance.unrender();\n\t}\n\tmeta.instance.el = null;\n}\n","export default function Ractive$find ( selector, options = {} ) {\n\tif ( !this.el ) throw new Error( `Cannot call ractive.find('${selector}') unless instance is rendered to the DOM` );\n\n\tlet node = this.fragment.find( selector, options );\n\tif ( node ) return node;\n\n\tif ( options.remote ) {\n\t\tfor ( let i = 0; i < this._children.length; i++ ) {\n\t\t\tif ( !this._children[i].instance.fragment.rendered ) continue;\n\t\t\tnode = this._children[i].instance.find( selector, options );\n\t\t\tif ( node ) return node;\n\t\t}\n\t}\n}\n","export default function Ractive$findAll ( selector, options = {} ) {\n\tif ( !this.el ) throw new Error( `Cannot call ractive.findAll('${selector}', ...) unless instance is rendered to the DOM` );\n\n\tif ( !Array.isArray( options.result ) ) options.result = [];\n\n\tthis.fragment.findAll( selector, options );\n\n\tif ( options.remote ) {\n\t\t// seach non-fragment children\n\t\tthis._children.forEach( c => {\n\t\t\tif ( !c.target && c.instance.fragment && c.instance.fragment.rendered ) {\n\t\t\t\tc.instance.findAll( selector, options );\n\t\t\t}\n\t\t});\n\t}\n\n\treturn options.result;\n}\n","export default function Ractive$findAllComponents ( selector, options ) {\n\tif ( !options && typeof selector === 'object' ) {\n\t\toptions = selector;\n\t\tselector = '';\n\t}\n\n\toptions = options || {};\n\n\tif ( !Array.isArray( options.result ) ) options.result = [];\n\n\tthis.fragment.findAllComponents( selector, options );\n\n\tif ( options.remote ) {\n\t\t// search non-fragment children\n\t\tthis._children.forEach( c => {\n\t\t\tif ( !c.target && c.instance.fragment && c.instance.fragment.rendered ) {\n\t\t\t\tif ( !selector || c.name === selector ) {\n\t\t\t\t\toptions.result.push( c.instance );\n\t\t\t\t}\n\n\t\t\t\tc.instance.findAllComponents( selector, options );\n\t\t\t}\n\t\t});\n\t}\n\n\treturn options.result;\n}\n\n","export default function Ractive$findComponent ( selector, options = {} ) {\n\tif ( typeof selector === 'object' ) {\n\t\toptions = selector;\n\t\tselector = '';\n\t}\n\n\tlet child = this.fragment.findComponent( selector, options );\n\tif ( child ) return child;\n\n\tif ( options.remote ) {\n\t\tif ( !selector && this._children.length ) return this._children[0].instance;\n\t\tfor ( let i = 0; i < this._children.length; i++ ) {\n\t\t\t// skip children that are or should be in an anchor\n\t\t\tif ( this._children[i].target ) continue;\n\t\t\tif ( this._children[i].name === selector ) return this._children[i].instance;\n\t\t\tchild = this._children[i].instance.findComponent( selector, options );\n\t\t\tif ( child ) return child;\n\t\t}\n\t}\n}\n\n","export default function Ractive$findContainer ( selector ) {\n\tif ( this.container ) {\n\t\tif ( this.container.component && this.container.component.name === selector ) {\n\t\t\treturn this.container;\n\t\t} else {\n\t\t\treturn this.container.findContainer( selector );\n\t\t}\n\t}\n\n\treturn null;\n}","export default function Ractive$findParent ( selector ) {\n\n\tif ( this.parent ) {\n\t\tif ( this.parent.component && this.parent.component.name === selector ) {\n\t\t\treturn this.parent;\n\t\t} else {\n\t\t\treturn this.parent.findParent ( selector );\n\t\t}\n\t}\n\n\treturn null;\n}\n","// This function takes an array, the name of a mutator method, and the\n// arguments to call that mutator method with, and returns an array that\n// maps the old indices to their new indices.\n\n// So if you had something like this...\n//\n//     array = [ 'a', 'b', 'c', 'd' ];\n//     array.push( 'e' );\n//\n// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n// have changed. If you then did this...\n//\n//     array.unshift( 'z' );\n//\n// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n// one higher to make room for the 'z'. If you removed an item, the new index\n// would be -1...\n//\n//     array.splice( 2, 2 );\n//\n// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n//\n// This information is used to enable fast, non-destructive shuffling of list\n// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\nexport default function getNewIndices ( length, methodName, args ) {\n\tconst newIndices = [];\n\n\tconst spliceArguments = getSpliceEquivalent( length, methodName, args );\n\n\tif ( !spliceArguments ) {\n\t\treturn null; // TODO support reverse and sort?\n\t}\n\n\tconst balance = ( spliceArguments.length - 2 ) - spliceArguments[1];\n\n\tconst removeStart = Math.min( length, spliceArguments[0] );\n\tconst removeEnd = removeStart + spliceArguments[1];\n\tnewIndices.startIndex = removeStart;\n\n\tlet i;\n\tfor ( i = 0; i < removeStart; i += 1 ) {\n\t\tnewIndices.push( i );\n\t}\n\n\tfor ( ; i < removeEnd; i += 1 ) {\n\t\tnewIndices.push( -1 );\n\t}\n\n\tfor ( ; i < length; i += 1 ) {\n\t\tnewIndices.push( i + balance );\n\t}\n\n\t// there is a net shift for the rest of the array starting with index + balance\n\tif ( balance !== 0 ) {\n\t\tnewIndices.touchedFrom = spliceArguments[0];\n\t} else {\n\t\tnewIndices.touchedFrom = length;\n\t}\n\n\treturn newIndices;\n}\n\n\n// The pop, push, shift an unshift methods can all be represented\n// as an equivalent splice\nfunction getSpliceEquivalent ( length, methodName, args ) {\n\tswitch ( methodName ) {\n\t\tcase 'splice':\n\t\t\tif ( args[0] !== undefined && args[0] < 0 ) {\n\t\t\t\targs[0] = length + Math.max( args[0], -length );\n\t\t\t}\n\n\t\t\tif ( args[0] === undefined ) args[0] = 0;\n\n\t\t\twhile ( args.length < 2 ) {\n\t\t\t\targs.push( length - args[0] );\n\t\t\t}\n\n\t\t\tif ( typeof args[1] !== 'number' ) {\n\t\t\t\targs[1] = length - args[0];\n\t\t\t}\n\n\t\t\t// ensure we only remove elements that exist\n\t\t\targs[1] = Math.min( args[1], length - args[0] );\n\n\t\t\treturn args;\n\n\t\tcase 'sort':\n\t\tcase 'reverse':\n\t\t\treturn null;\n\n\t\tcase 'pop':\n\t\t\tif ( length ) {\n\t\t\t\treturn [ length - 1, 1 ];\n\t\t\t}\n\t\t\treturn [ 0, 0 ];\n\n\t\tcase 'push':\n\t\t\treturn [ length, 0 ].concat( args );\n\n\t\tcase 'shift':\n\t\t\treturn [ 0, length ? 1 : 0 ];\n\n\t\tcase 'unshift':\n\t\t\treturn [ 0, 0 ].concat( args );\n\t}\n}\n","import { ANCHOR, COMPONENT, ELEMENT } from '../../../config/types';\n\nexport default function findElement( start, orComponent = true, name ) {\n\twhile ( start && ( start.type !== ELEMENT || ( name && start.name !== name ) ) && ( !orComponent || ( start.type !== COMPONENT && start.type !== ANCHOR ) ) ) {\n\t\t// start is a fragment - look at the owner\n\t\tif ( start.owner ) start = start.owner;\n\t\t// start is a component or yielder - look at the container\n\t\telse if ( start.component ) start = start.containerFragment || start.component.parentFragment;\n\t\t// start is an item - look at the parent\n\t\telse if ( start.parent ) start = start.parent;\n\t\t// start is an item without a parent - look at the parent fragment\n\t\telse if ( start.parentFragment ) start = start.parentFragment;\n\n\t\telse start = undefined;\n\t}\n\n\treturn start;\n}\n","import fireEvent from '../../events/fireEvent';\nimport Context from '../../shared/Context';\n\nexport default function Ractive$fire ( eventName, ...args ) {\n\t// watch for reproxy\n\tif ( args[0] instanceof Context ) {\n\t\tconst proto = args.shift();\n\t\tconst ctx = Object.create( proto );\n\t\tObject.assign( ctx, proto );\n\t\treturn fireEvent( this, eventName, ctx, args );\n\t} else {\n\t\treturn fireEvent( this, eventName, Context.forRactive( this ), args );\n\t}\n}\n","import { splitKeypath } from '../../shared/keypaths';\nimport resolveReference from '../../view/resolvers/resolveReference';\nimport { FakeFragment } from '../../shared/getRactiveContext';\n\nexport default function Ractive$get ( keypath, opts ) {\n\tif ( typeof keypath !== 'string' ) return this.viewmodel.get( true, keypath );\n\n\tconst keys = splitKeypath( keypath );\n\tconst key = keys[0];\n\n\tlet model;\n\n\tif ( !this.viewmodel.has( key ) ) {\n\t\t// if this is an inline component, we may need to create\n\t\t// an implicit mapping\n\t\tif ( this.component && !this.isolated ) {\n\t\t\tmodel = resolveReference( this.fragment || new FakeFragment( this ), key );\n\t\t}\n\t}\n\n\tmodel = this.viewmodel.joinAll( keys );\n\treturn model.get( true, opts );\n}\n","import staticContext, { getNodeInfo as staticInfo } from '../static/getContext';\n\nexport default function getContext ( node, options ) {\n\tif ( typeof node === 'string' ) {\n\t\tnode = this.find( node, options );\n\t}\n\n\treturn staticContext( node );\n}\n\nexport function getNodeInfo ( node, options ) {\n\tif ( typeof node === 'string' ) {\n\t\tnode = this.find( node, options );\n\t}\n\n\treturn staticInfo( node );\n}\n","import { splitKeypath } from '../../shared/keypaths';\nimport resolveReference from '../../view/resolvers/resolveReference';\nimport runloop from '../../global/runloop';\n\nexport default function link( there, here, options ) {\n\tlet model;\n\tconst target = ( options && ( options.ractive || options.instance ) ) || this;\n\n\t// may need to allow a mapping to resolve implicitly\n\tconst sourcePath = splitKeypath( there );\n\tif ( !target.viewmodel.has( sourcePath[0] ) && target.component ) {\n\t\tmodel = resolveReference( target.component.parentFragment, sourcePath[0] );\n\t\tmodel = model.joinAll( sourcePath.slice( 1 ) );\n\t}\n\n\tconst src = model || target.viewmodel.joinAll( sourcePath );\n\tconst dest = this.viewmodel.joinAll( splitKeypath( here ), { lastLink: false });\n\n\tif ( isUpstream( src, dest ) || isUpstream( dest, src ) ) {\n\t\tthrow new Error( 'A keypath cannot be linked to itself.' );\n\t}\n\n\tconst promise = runloop.start();\n\n\tdest.link( src, there );\n\n\trunloop.end();\n\n\treturn promise;\n}\n\nfunction isUpstream ( check, start ) {\n\tlet model = start;\n\twhile ( model ) {\n\t\tif ( model === check ) return true;\n\t\tmodel = model.target || model.parent;\n\t}\n}\n","import { isObject } from '../../utils/is';\nimport { warnOnceIfDebug } from '../../utils/log';\nimport { splitKeypath } from '../../shared/keypaths';\nimport resolveReference from '../../view/resolvers/resolveReference';\nimport Observer from './observe/Observer';\nimport PatternObserver from './observe/Pattern';\nimport ArrayObserver from './observe/Array';\n\nexport default function observe ( keypath, callback, options ) {\n\tconst observers = [];\n\tlet map;\n\tlet opts;\n\n\tif ( isObject( keypath ) ) {\n\t\tmap = keypath;\n\t\topts = callback || {};\n\t} else {\n\t\tif ( typeof keypath === 'function' ) {\n\t\t\tmap = { '': keypath };\n\t\t\topts = callback || {};\n\t\t} else {\n\t\t\tmap = {};\n\t\t\tmap[ keypath ] = callback;\n\t\t\topts = options || {};\n\t\t}\n\t}\n\n\tlet silent = false;\n\tObject.keys( map ).forEach( keypath => {\n\t\tconst callback = map[ keypath ];\n\t\tconst caller = function ( ...args ) {\n\t\t\tif ( silent ) return;\n\t\t\treturn callback.apply( this, args );\n\t\t};\n\n\t\tlet keypaths = keypath.split( ' ' );\n\t\tif ( keypaths.length > 1 ) keypaths = keypaths.filter( k => k );\n\n\t\tkeypaths.forEach( keypath => {\n\t\t\topts.keypath = keypath;\n\t\t\tconst observer = createObserver( this, keypath, caller, opts );\n\t\t\tif ( observer ) observers.push( observer );\n\t\t});\n\t});\n\n\t// add observers to the Ractive instance, so they can be\n\t// cancelled on ractive.teardown()\n\tthis._observers.push.apply( this._observers, observers );\n\n\treturn {\n\t\tcancel: () => observers.forEach( o => o.cancel() ),\n\t\tisSilenced: () => silent,\n\t\tsilence: () => silent = true,\n\t\tresume: () => silent = false\n\t};\n}\n\nfunction createObserver ( ractive, keypath, callback, options ) {\n\tconst keys = splitKeypath( keypath );\n\tlet wildcardIndex = keys.indexOf( '*' );\n\tif ( !~wildcardIndex ) wildcardIndex = keys.indexOf( '**' );\n\n\toptions.fragment = options.fragment || ractive.fragment;\n\n\tlet model;\n\tif ( !options.fragment ) {\n\t\tmodel = ractive.viewmodel.joinKey( keys[0] );\n\t} else {\n\t\t// .*.whatever relative wildcard is a special case because splitkeypath doesn't handle the leading .\n\t\tif ( ~keys[0].indexOf( '.*' ) ) {\n\t\t\tmodel = options.fragment.findContext();\n\t\t\twildcardIndex = 0;\n\t\t\tkeys[0] = keys[0].slice( 1 );\n\t\t} else {\n\t\t\tmodel = wildcardIndex === 0 ? options.fragment.findContext() : resolveReference( options.fragment, keys[0] );\n\t\t}\n\t}\n\n\t// the model may not exist key\n\tif ( !model ) model = ractive.viewmodel.joinKey( keys[0] );\n\n\tif ( !~wildcardIndex ) {\n\t\tmodel = model.joinAll( keys.slice( 1 ) );\n\t\tif ( options.array ) {\n\t\t\treturn new ArrayObserver( ractive, model, callback, options );\n\t\t} else {\n\t\t\treturn new Observer( ractive, model, callback, options );\n\t\t}\n\t} else {\n\t\tconst double = keys.indexOf( '**' );\n\t\tif ( ~double ) {\n\t\t\tif ( double + 1 !== keys.length || ~keys.indexOf( '*' ) ) {\n\t\t\t\twarnOnceIfDebug( `Recursive observers may only specify a single '**' at the end of the path.` );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tmodel = model.joinAll( keys.slice( 1, wildcardIndex ) );\n\n\t\treturn new PatternObserver( ractive, model, keys.slice( wildcardIndex ), callback, options );\n\t}\n}\n","import trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\nimport { removeFromArray } from '../../utils/array';\n\nexport default function Ractive$off ( eventName, callback ) {\n\t// if no event is specified, remove _all_ event listeners\n\tif ( !eventName ) {\n\t\tthis._subs = {};\n\t} else {\n\t\t// Handle multiple space-separated event names\n\t\tconst eventNames = eventName.split( ' ' ).map( trim ).filter( notEmptyString );\n\n\t\teventNames.forEach( event => {\n\t\t\tconst subs = this._subs[ event ];\n\t\t\t// if given a specific callback to remove, remove only it\n\t\t\tif ( subs && callback ) {\n\t\t\t\tconst entry = subs.find( s => s.callback === callback );\n\t\t\t\tif ( entry ) {\n\t\t\t\t\tremoveFromArray( subs, entry );\n\t\t\t\t\tentry.off = true;\n\n\t\t\t\t\tif ( event.indexOf( '.' ) ) this._nsSubs--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// otherwise, remove all listeners for this event\n\t\t\telse if ( subs ) {\n\t\t\t\tif ( event.indexOf( '.' ) ) this._nsSubs -= subs.length;\n\t\t\t\tsubs.length = 0;\n\t\t\t}\n\t\t});\n\t}\n\n\treturn this;\n}\n","import trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\n\nexport default function Ractive$on ( eventName, callback ) {\n\t// eventName may already be a map\n\tconst map = typeof eventName === 'object' ? eventName : {};\n\t// or it may be a string along with a callback\n\tif ( typeof eventName === 'string' ) map[ eventName ] = callback;\n\n\tlet silent = false;\n\tconst events = [];\n\n\tfor ( const k in map ) {\n\t\tconst callback = map[k];\n\t\tconst caller = function ( ...args ) {\n\t\t\tif ( !silent ) return callback.apply( this, args );\n\t\t};\n\t\tconst entry = {\n\t\t\tcallback,\n\t\t\thandler: caller\n\t\t};\n\n\t\tif ( map.hasOwnProperty( k ) ) {\n\t\t\tconst names = k.split( ' ' ).map( trim ).filter( notEmptyString );\n\t\t\tnames.forEach( n => {\n\t\t\t\t( this._subs[ n ] || ( this._subs[ n ] = [] ) ).push( entry );\n\t\t\t\tif ( n.indexOf( '.' ) ) this._nsSubs++;\n\t\t\t\tevents.push( [ n, entry ] );\n\t\t\t});\n\t\t}\n\t}\n\n\treturn {\n\t\tcancel: () => events.forEach( e => this.off( e[0], e[1].callback ) ),\n\t\tisSilenced: () => silent,\n\t\tsilence: () => silent = true,\n\t\tresume: () => silent = false\n\t};\n}\n","export default function Ractive$once ( eventName, handler ) {\n\tconst listener = this.on( eventName, function () {\n\t\thandler.apply( this, arguments );\n\t\tlistener.cancel();\n\t});\n\n\t// so we can still do listener.cancel() manually\n\treturn listener;\n}\n","import { splitKeypath } from '../../shared/keypaths';\n\nexport default function readLink ( keypath, options = {} ) {\n\tconst path = splitKeypath( keypath );\n\n\tif ( this.viewmodel.has( path[0] ) ) {\n\t\tlet model = this.viewmodel.joinAll( path );\n\n\t\tif ( !model.isLink ) return;\n\n\t\twhile ( ( model = model.target ) && options.canonical !== false ) {\n\t\t\tif ( !model.isLink ) break;\n\t\t}\n\n\t\tif ( model ) return { ractive: model.root.ractive, keypath: model.getKeypath() };\n\t}\n}\n","export function fillGaps ( target, ...sources ) {\n\n\tfor (let i = 0; i < sources.length; i++){\n\t\tconst source = sources[i];\n\t\tfor ( const key in source ) {\n\t\t\t// Source can be a prototype-less object.\n\t\t\tif ( key in target || !Object.prototype.hasOwnProperty.call( source, key ) ) continue;\n\t\t\ttarget[ key ] = source[ key ];\n\t\t}\n\t}\n\n\treturn target;\n}\n\nexport function toPairs ( obj = {} ) {\n\tconst pairs = [];\n\tfor ( const key in obj ) {\n\t\t// Source can be a prototype-less object.\n\t\tif ( !Object.prototype.hasOwnProperty.call( obj, key ) ) continue;\n\t\tpairs.push( [ key, obj[ key ] ] );\n\t}\n\treturn pairs;\n}\n","function s4() {\n\treturn Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n}\n\nexport function uuid() {\n\treturn s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\n","import noop from '../../utils/noop';\n\nexport default function wrap ( parent, name, method ) {\n\tif ( !/_super/.test( method ) ) return method;\n\n\tfunction wrapper () {\n\t\tconst superMethod = getSuperMethod( wrapper._parent, name );\n\t\tconst hasSuper = '_super' in this;\n\t\tconst oldSuper = this._super;\n\n\t\tthis._super = superMethod;\n\n\t\tconst result = method.apply( this, arguments );\n\n\t\tif ( hasSuper ) {\n\t\t\tthis._super = oldSuper;\n\t\t} else {\n\t\t\tdelete this._super;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\twrapper._parent = parent;\n\twrapper._method = method;\n\n\treturn wrapper;\n}\n\nfunction getSuperMethod ( parent, name ) {\n\tif ( name in parent ) {\n\t\tconst value = parent[ name ];\n\n\t\treturn typeof value === 'function' ?\n\t\t\tvalue :\n\t\t\t() => value;\n\t}\n\n\treturn noop;\n}\n","import { warnIfDebug } from '../../utils/log';\n\nfunction getMessage( deprecated, correct, isError ) {\n\treturn `options.${deprecated} has been deprecated in favour of options.${correct}.`\n\t\t+ ( isError ? ` You cannot specify both options, please use options.${correct}.` : '' );\n}\n\nfunction deprecateOption ( options, deprecatedOption, correct ) {\n\tif ( deprecatedOption in options ) {\n\t\tif( !( correct in options ) ) {\n\t\t\twarnIfDebug( getMessage( deprecatedOption, correct ) );\n\t\t\toptions[ correct ] = options[ deprecatedOption ];\n\t\t} else {\n\t\t\tthrow new Error( getMessage( deprecatedOption, correct, true ) );\n\t\t}\n\t}\n}\n\nexport default function deprecate ( options ) {\n\tdeprecateOption( options, 'beforeInit', 'onconstruct' );\n\tdeprecateOption( options, 'init', 'onrender' );\n\tdeprecateOption( options, 'complete', 'oncomplete' );\n\tdeprecateOption( options, 'eventDefinitions', 'events' );\n\n\t// Using extend with Component instead of options,\n\t// like Human.extend( Spider ) means adaptors as a registry\n\t// gets copied to options. So we have to check if actually an array\n\tif ( Array.isArray( options.adaptors ) ) {\n\t\tdeprecateOption( options, 'adaptors', 'adapt' );\n\t}\n}\n","import resolveReference from './resolveReference';\nimport ExpressionProxy from './ExpressionProxy';\nimport ReferenceExpressionProxy from './ReferenceExpressionProxy';\n\nexport default function resolve ( fragment, template ) {\n\tif ( template.r ) {\n\t\treturn resolveReference( fragment, template.r );\n\t}\n\n\telse if ( template.x ) {\n\t\treturn new ExpressionProxy( fragment, template.x );\n\t}\n\n\telse if ( template.rx ) {\n\t\treturn new ReferenceExpressionProxy( fragment, template.rx );\n\t}\n}\n"],"names":["this","iterations","toRemove","forEach","fragment","unbind","unrender","reset","isArray","bubbled","length","i","update","docFrag","newLength","Array","value","isObject","Object","keys","rendered","createDocumentFragment","createIteration","this$1","push","render","indexRef","keyRef","refs","split","key","oldKeys","parentNode","parent","findParentNode","anchor","findNextNode","owner","insertBefore","updating","RepeatedFragment","prototype","updatePostShuffle","newIndices","pendingNewIndices","slice","indices","newIndex","oldIndex","len","context","get","oldLen","previousIterations","removed","index","model","joinKey","template","z","aliases","n","frag","contiguous","startIndex","appendChild","detach","childNodes","firstNode","k","shuffled","Section","MustacheContainer","options","super","sectionType","templateSectionType","subordinate","l","constructor","bind","sibling","parentFragment","items","indexOf","nextSibling","dirty","SECTION_UNLESS","isTruthy","Fragment","f","const","detached","call","isRoot","undefined","SECTION_IF_WITH","isEmpty","rebind","next","previous","safe","SECTION_IF","target","occupants","shuffle","SECTION_EACH","shouldDestroy","siblingFalsey","lastType","getType","let","newFragment","fragmentShouldExist","SECTION_WITH","attach","keep","runloop","scheduleTask","Select","Element","foundNode","node","binding","selectedOptions","getSelectedOptions","sync","defaultSelected","selected","selectNode","toArray","o","setFromNode","selectValue","getAttribute","isMultiple","array","optionWasSelected","optionValue","_ractive","shouldSelect","valueContains","compare","forceUpdate","comparator","Textarea","Input","deferContent","attributeByName","isBindable","attributes","createItem","t","ATTRIBUTE","cssIds","bubble","toString","Text","Item","type","TEXT","detachNode","inAttributes","progressiveText","escape","escapeHtml","valueOf","proto","noop","prefix","isClient","prefixCache","testStyle","createElement","style","prop","name","hyphenateCamel","vendors","vendor","visible","prefix$1","hidden","doc","addEventListener","onChange","onHide","onShow","win","createTransitions","vendorPattern","RegExp","join","hyphenate","str","test","replace","match","toLowerCase","TRANSITION","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","linear","x","canUseCssTransitions","cannotUseCssTransitions","transition","webkitTransition","to","changedProperties","resolve","setTimeout","transitionDone","clearTimeout","cssTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","unregisterCompleteHandler","ractive","fire","isIntro","transitionEndHandler","event","propertyName","splice","cssTransitionsDone","property","duration","timing","removeEventListener","hashPrefix","namespaceURI","tagName","delay","registerCompleteHandler","easingName","easing","cssTiming","hash","suffix","interpolator","originalValue","propertiesToTransitionInJs","initial","getStyle","warnIfDebug","exec","interpolate","parseFloat","warnOnceIfDebug","missingPlugin","Ticker","step","pos","complete","createTransitions$1","getComputedStyle","resolved","Promise","names","t0","t1","t2","Transition","findElement","element","onComplete","animateStyle","arguments","Error","setStyle","fulfil","propertyNames","computedStyle","current","init","originals","targets","v","intro","outro","eventName","params","_fn","findInViewHierarchy","setupArgsFn","getParams","fn","values","resolveArgs","map","apply","props","styles","processParams","defaults","assign","addToArray","hasOwnProperty","shouldFire","transitionsEnabled","rendering","nearestProp","unrendering","nested","el","starting","start","completed","args","noReset","_manager","remove","promise","concat","then","unbinding","removeFromArray","destroyed","ieBug","ieBlacklist","elementCache","innerHTML","err","TABLE","THEAD","TBODY","TR","SELECT","insertHtml","html","nodes","container","wrapper","selectedOption","querySelector","selectedIndex","svg","textContent","child","firstChild","removeChild","Triple","Mustache","find","selector","nodeType","matches","queryResult","findAll","result","queryAllResult","querySelectorAll","findComponent","shift","outerHTML","nodeValue","inAttribute","decodeCharacterReferences","constructors","ALIAS","Alias","ANCHOR","Component","DOCTYPE","Doctype","INTERPOLATOR","Interpolator","PARTIAL","Partial","SECTION","TRIPLE","YIELDER","Attribute","BINDING_FLAG","BindingFlag","DECORATOR","Decorator","EVENT","EventDirective","specialElements","doctype","form","Form","input","option","Option","select","textarea","componentParent","component","delegate","containerFragment","dirtyValue","createItems","bound","addFragment","max","xs","findMap","findAllComponents","findContext","viewmodel","item","ELEMENT","findRepeatingFragment","isIteration","skipParent","resetTemplate","wasBound","wasRendered","toEscapedString","unrenderAndDestroy","addFragmentToRoot","source","processItems","_guid","parsed","parseJSON","getContext","HookQueue","hook","Hook","inProcess","queue","begin","end","getChildQueue","configHook","initHook","renderHook","completeHook","shouldRerender","resetHook","unrenderHook","resetPartial","partial","collection","collect","partials","forceResetTemplate","reverse","makeArrayMethod","path","sort","unshift","add","animate","attachChild","detachChild","findContainer","findParent","getNodeInfo","insert","link","observe","observeOnce","off","on","once","pop","readLink","set","subtract","teardown","toggle","toCSS","toCss","toHTML","toHtml","toText","unlink","updateModel","defineProperty","callsSuper","Ractive","opts","script","document","currentScript","defineProperties","DEBUG","writable","DEBUG_PROMISES","extend","extendWith","escapeKey","isInstance","joinKeys","parse","splitKeypath","unescapeKey","getCSS","normaliseKeypath","normalise","findPlugin","evalObjectString","enhance","VERSION","adaptors","components","decorators","events","interpolators","transitions","Binding","FileBinding","GenericBinding","getInitialValue","getValue","files","lazy","MultipleSelectBinding","filter","selectedValues","handleChange","attribute","previousValue","arrayContentsMatch","handleDomEvent","NumericBinding","isNaN","siblings","RadioBinding","getSiblings","checked","root","attachEvent","RadioNameBinding","group","getBindingGroup","nameAttributeBinding","getKeypath","getKeypathModel","register","lastVal","setting","lastValue","unregister","SingleSelectBinding","locked","disabled","endsWithSemi","ContainerItem","e","isVoid","voidElementNames","listeners","leftovers","m","DELEGATE_FLAG","ConditionalAttribute","sortAttributes","recreateTwowayBinding","createTwowayBinding","twoway","selectBinding","ls","handler","ref","assigns","ctx","Context","create","callback","capture","delegateHandler","rem","namespace","getNamespace","existing","nodeName","toUpperCase","proxy","setAttribute","isOutro","registerTransition","children","wasUndefined","removeAttribute","attrs","stringifyAttribute","isSelected","inputIsCheckedRadio","cls","attr","safeAttributeString","getString","inlineClass","detachWhenReady","toFront","formBindings","handleReset","DOMEvent","fatal","listen","directive","original","unlisten","CustomEvent","eventPlugin","RactiveEvent","instance","cancel","specialPattern","dollarArgsPattern","COMPONENT","models","action","specialRef","specialMatch","special","substr","dollarMatch","obj","which","wrapperValue","oldEvent","returned","preventDefault","stopPropagation","fireEvent","isStatic","s","rebindMatch","addShuffleRegister","mustache","safeToStringValue","string","data","defaultValue","attrValue","leadingWhitespace","ParseError","message","stack","Parser","lineStart","lines","lineEnds","line","lineEnd","read","leftover","remaining","postProcess","converters","getContextMessage","getLinePos","lineNum","columnNum","contextLines","contextUp","contextDown","numTabs","annotation","char","error","msg","character","shortMessage","matchString","matchPattern","pattern","allowWhitespace","substring","nextChar","charAt","warn","Parent","Child","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","makeQuotedStringMatcher","okQuote","parser","literal","done","charCodeAt","JSON","singleMatcher","doubleMatcher","readStringLiteral","quote","STRING_LITERAL","numberPattern","identifier","specials","true","false","null","specialsPattern","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","JsonParser","placeholder","number","stringLiteral","$1","pair","getKeyValuePair","valueToken","Mapping","createMapping","boundFragment","a","selectedAttribute","yielder","r","rx","refName","templateObj","getPartialTemplate","named","setTemplate","parsePartial","partialTemplate","c","resolveAliases","doInAttributes","iteration","wasArray","hasConsole","console","groupCollapsed","sig","signature","getterUseStack","groupEnd","dependencies","stopCapturing","setDependencies","Computation","mark","isReadonly","setter","computations","Model","ComputationChild","ExpressionProxy","getFunction","resolveReference","actuallyChanged","keypath","startCapturing","d","idx","retrieve","unreference","deps","dep","computation","ReferenceExpressionChild","applyValue","isEqual","base","joinAll","shouldCapture","childByKey","ReferenceExpressionProxy","intermediary","members","addShuffleTask","REFERENCE","String","unregisterTwowayBinding","registerTwowayBinding","keypathModel","bindings","oneway","findBoundValue","links","marked","space","camelCaseStr","textTypes","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","ismap","maxlength","novalidate","pubdate","readonly","rowspan","tabindex","usemap","booleanAttributes","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","codePointSupport","fromCodePoint","codeToChar","fromCharCode","lessThan","greaterThan","invalid","div","isSvg","parseAttributes","notIn","updateDelegate","namespaces","useProperty","isTwoway","isBoolean","lookupNamespace","getUpdateDelegate","twowayBinding","flag","RactiveModel","isLink","initLink","hasProp","RootModel","adapt","computationContext","attached","attachImplicits","compute","createLink","targetPath","detachImplicits","virtual","getVirtual","getRactiveModel","ractiveModel","getValueChildren","_link","has","unescapedKey","Function","GlobalModel","SharedModel","shouldTeardown","constructHook","registryNames","uid","teardownHook","destructHook","ComponentConstructor","isAnchor","p","content","_partials","addChild","construct","_inlinePartials","eventHandlers","initialise","getRactiveContext","checking","checkAnchors","callRender","unrenderItem","missingDecorator","warnOnce","teardownArgsFn","setRoot","parentForm","resetValue","CheckboxBinding","BindingGroup","CheckboxNameBinding","checkboxName","noInitialValue","existingValue","bindingValue","arrayContains","isChecked","valueSoFar","ContentEditableBinding","timeout","isNumeric","handleDelay","handleBlur","ModelBase","lastLink","notifyUpstream","startPath","patternObservers","notify","notifiedUpstream","relinking","reference","registerLink","registerPatternObserver","observer","unregisterLink","unregisterPatternObserver","updateFromBindings","cascade","KeyModel","KeypathModel","Missing","shufle","LinkModel","sourcePath","from","boundValue","unwrap","shouldBind","maybeBind","getChild","isDetached","force","markedAll","rootLink","relinked","rebindChildren","shuffling","lnk","implicit","fireShuffleTasks","ln","tickers","running","performance","now","requestAnimationFrame","tick","elapsed","eased","stop","abort","prefixers","ticker","rewrap","newWrapperValue","parentValue","createBranch","adaptor","wrap","getPrefixer","__model","fulfilPromise","isObjectLike","branch","old","markForce","merge","oldArray","newArray","recreateArray","oldLength","usedIndices","firstUnusedIndex","unsafe","SharedModel$1","global","window","ContextModel","extern","FakeFragment","star","deepOpts","comparators","errorMessage","noAnimation","initStars","bubbleStars","method","arg","attachHook","detachHook","arrayProto","methodName","mdl","getNewIndices","updateHook","NUMBER_LITERAL","modelPush","modelPop","modelShift","modelUnshift","modelSort","modelSplice","modelReverse","ContextData","prototypeAccessors","_data","num","sharedSet","build","val","findModel","protoAnimate","dest","there","here","raise","ev","drop","protoUpdate","isBound","getBindingModel","getBindingPath","getBinding","setBinding","forRactive","methodNames","unprefixed","prefixed","j","makeFunction","query","mathml","xlink","xml","xmlns","ns","createElementNS","cloneNode","insertHook","Observer","oldContext","dispatch","oldValue","newValue","cancelled","resolver","_observers","strict","addObserver","defer","PatternObserver","baseModel","baseKeypath","recursive","oldValues","newValues","changed","findMatches","wildcards","touchedFrom","count","ok","check","ArrayObserver","pending","sliced","negativeOne","inserted","deleted","hadIndex","onceOptions","trim","notEmptyString","PREFIX","styleDefinitions","isDirty","styleElement","useCssText","getElementsByTagName","styleSheet","adaptConfigurator","combine","ensureArray","cleanCss","css","additionalReplaceRules","reconstruct","selectorsPattern","keyframesDeclarationPattern","selectorUnitPattern","excludePattern","dataRvcGuidPattern","hasCurly","cssConfigurator","getElement","id","cssId","uuid","noCssTransform","transformCss","addCSS","dataConfigurator","_r_unbound","TEMPLATE_VERSION","functions","parseOptions","TEMPLATE_INSTRUCTIONS","COMPUTATION_INSTRUCTIONS","fromId","noThrow","getElementById","isParsed","getParseOptions","reduce","throwNoParse","addFunctions","parseFor","templateConfigurator","parseTemplate","getDynamicTemplate","_config","extendPartials","registriesOnDefaults","Registry","useDefaults","configure","registry","isOwner","registries","putInDefaults","custom","defaultKeys","isStandardKey","makeObj","isBlacklisted","order","config","_super","syncComputedChildren","isExpression","getter","updateRadioName","updateCheckboxName","valueAttribute","updateStyleAttribute","readStyle","prev","setProperty","updateInlineStyle","updateClassName","readClass","className","baseVal","updateInlineClass","updateBoolean","updateAttribute","updateNamespacedAttribute","removeAttributeNS","setAttributeNS","entity","code","parseInt","validateCode","haystack","needle","qualified","hasAttribute","getComputationSignature","getterString","setterString","createFunctionFromString","welcome","initialiseProperties","handleAttributes","_attributePartial","getAdaptors","computed","protoAdapt","lookup","srcs","isolated","_subs","_nsSubs","_eventQueue","_children","byName","tpl","required","all","optional","mapAll","Ractive$teardown","torndown","getPromise","__ractive_instances__","meta","nameOption","renderItem","nextNode","contains","lastBound","list","updateAnchors","b","res","isBindableByValue","isBindableByContentEditable","isContentEditable","isBindableByName","isBindableByChecked","left","right","nameAttr","currentTarget","text","splitText","createTextNode","readNumberLiteral","readKey","token","namePattern","childData","getPartialFromRegistry","fillGaps","findParentPartial","findInstance","noRegistryFunctionReturn","findOwner","findConstructor","hasIndexRef","section","getComponentConstructor","ElementConstructor","guid","counter","placeholderId","newModel","hookQueue","childQueue","userOptions","subscribe","createFragment","append","logIfDebug","subs","toPairs","single","applyCSS","Ractive$render","others","Ractive$reset","rerender","changes","Ractive$resetTemplate","external","Ractive$set","Ractive$subtract","Ractive$toggle","TypeError","badArguments","gather","Ractive$toCSS","uniqueCssIds","ids","Ractive$toHTML","Ractive$transition","HTMLElement","Ractive$unrender","Ractive$updateModel","object","extendOne","Class","Target","configurable","extendClass","_on","_observe","splitKeypathI","log","printWarning","delimiters","tripleDelimiters","staticDelimiters","staticTripleDelimiters","csp","preserveWhitespace","sanitize","stripComments","parserTransforms","resolveInstanceMembers","warnAboutAmbiguity","noIntro","noOutro","nestedTransitions","easeIn","Math","pow","easeOut","easeInOut","implementation","hasFeature","alreadyWarned","welcomeIntro","welcomeMessage","WELCOME_MESSAGE","hasGroup","intermediate","min","properties","snap","TransitionManager","intros","outros","totalChildren","outroChildren","detachQueue","outrosComplete","decrementOutros","decrementTotal","detachNodes","_detachNodes","ready","detachImmediate","batch","captureGroup","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","flushChanges","thing","task","postRender","_batch","refPattern","splitPattern","escapeKeyPattern","unescapeKeyPattern","isKey","dependant","isKeypath","fnBind","shuffleTasks","early","registerQueue","keyModels","stage","existingMatches","loop","getKeyModel","skip","isFinite","format","registryName","interpol","member","arrays","arrayLike","tm","notifiedTotal","manager","trans","collectAllOutros","_list","upstream","parts","last","findAlias","alias","prefixKeypath","rootKeypath","rootDot","relativeKeypath","initialFragment","explicitContext","badReference","repeater","shouldWarn","_fakeFragment","pairs","deep","deepSet","getComparator","sets","Ractive$add","getOptions","Ractive$animate","enqueue","dequeue","variants","eventNames","fireEventAs","initialFire","notifySubscribers","fullName","subscribers","originalEvent","stopEvent","findAnchors","findAnchorsIn","anchors","idxs","unrenderChild","prepend","insertAt","@this.parent","@this.root","Ractive$detach","Ractive$find","remote","Ractive$findAll","Ractive$findAllComponents","Ractive$findComponent","Ractive$findContainer","Ractive$findParent","spliceArguments","getSpliceEquivalent","balance","removeStart","removeEnd","Ractive$update","orComponent","Ractive$fire","Ractive$get","instances","staticContext","staticInfo","output","Ractive$insert","fireInsertHook","src","isUpstream","observers","silent","caller","keypaths","createObserver","isSilenced","silence","resume","wildcardIndex","double","Ractive$off","entry","Ractive$on","Ractive$once","listener","canonical","styleDefinition","cssText","filteredStyleDefinitions","sources","extractString","unit","transformSelector","selectorUnits","modifiers","transformed","appended","prepended","dataAttr","selectors","s4","floor","random","validate","childValue","parentIsFn","childIsFn","callDataFunction","fromProperties","primary","secondary","fromExpression","body","fromComputationString","bindTo","hasThis","functionBody","createFunction","exp","instructions","parseAsString","existingPartials","newPartials","overwrite","superMethod","getSuperMethod","_parent","hasSuper","oldSuper","_method","getMessage","deprecated","correct","isError","deprecateOption","deprecatedOption","deprecate","extendOtherMethods","RactiveProto","wrapPrototype","rule","rules","updateMultipleSelectValue","updateSelectValue","updateStringValue","updateContentEditableValue","updateRadioValue","updateValue","wasSelected","wasChecked"],"mappings":"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AAiBC,KAAM,GAAIC,IAAK,GAAIC,KAAM,GAAIC,GAAI,GAAIC,GAAI,GAAIC,KAAM,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,IAAK,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,I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"}