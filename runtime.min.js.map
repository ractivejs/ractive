{"version":3,"file":"runtime.min.js","sources":["../src/view/RepeatedFragment.js","../src/view/items/Section.js","../src/view/items/element/specials/Select.js","../src/view/items/element/specials/Textarea.js","../src/view/items/Text.js","../src/config/visibility.js","../src/view/items/element/transitions/prefix.js","../src/view/items/element/transitions/createTransitions.js","../src/view/items/element/transitions/hyphenate.js","../src/view/items/element/Transition.js","../src/view/items/triple/insertHtml.js","../src/view/items/Triple.js","../src/view/items/createItem.js","../src/view/Fragment.js","../src/events/HookQueue.js","../src/Ractive/initialise.js","../src/Ractive/render.js","../src/Ractive/prototype/reset.js","../src/Ractive/prototype/resetPartial.js","../src/Ractive/prototype/reverse.js","../src/Ractive/prototype/shift.js","../src/Ractive/prototype/sort.js","../src/Ractive/prototype/splice.js","../src/Ractive/prototype/unrender.js","../src/Ractive/prototype/unshift.js","../src/Ractive/prototype.js","../src/extend/_extend.js","../src/Ractive.js","../src/view/items/element/binding/Binding.js","../src/view/items/element/binding/CheckboxBinding.js","../src/view/items/element/binding/getBindingGroup.js","../src/view/items/element/binding/CheckboxNameBinding.js","../src/view/items/element/binding/ContentEditableBinding.js","../src/view/items/element/binding/GenericBinding.js","../src/view/items/element/binding/FileBinding.js","../src/view/items/element/binding/MultipleSelectBinding.js","../src/view/items/element/binding/NumericBinding.js","../src/view/items/element/binding/RadioBinding.js","../src/view/items/element/binding/RadioNameBinding.js","../src/view/items/element/binding/SingleSelectBinding.js","../src/view/items/Element.js","../src/view/items/element/specials/Form.js","../src/view/items/element/ElementEvents.js","../src/view/items/component/RactiveEvent.js","../src/view/items/shared/EventDirective.js","../src/view/items/shared/Mustache.js","../src/view/items/Interpolator.js","../src/view/items/element/specials/Input.js","../src/parse/Parser.js","../src/parse/converters/expressions/primary/literal/stringLiteral/makeQuotedStringMatcher.js","../src/parse/converters/expressions/primary/literal/readStringLiteral.js","../src/parse/converters/expressions/primary/literal/readNumberLiteral.js","../src/parse/converters/expressions/shared/patterns.js","../src/parse/converters/expressions/shared/readKey.js","../src/utils/parseJSON.js","../src/view/items/component/Mapping.js","../src/view/items/element/specials/Option.js","../src/view/items/Partial.js","../src/Ractive/config/runtime-parser.js","../src/shared/getFunction.js","../src/Ractive/config/custom/template.js","../src/Ractive/config/registries.js","../src/Ractive/config/config.js","../src/view/items/shared/Item.js","../src/model/ComputationChild.js","../src/model/Computation.js","../src/view/resolvers/ExpressionProxy.js","../src/view/resolvers/ReferenceExpressionProxy.js","../src/view/items/Alias.js","../src/utils/html.js","../src/utils/hyphenateCamel.js","../src/view/helpers/specialAttrs.js","../src/view/items/element/attribute/getUpdateDelegate.js","../src/view/items/element/attribute/propertyNames.js","../src/view/items/element/ConditionalAttribute.js","../src/view/items/element/Attribute.js","../src/view/items/element/BindingFlag.js","../src/view/items/Comment.js","../src/Ractive/prototype/teardown.js","../src/model/specials/RactiveModel.js","../src/model/RootModel.js","../src/Ractive/construct.js","../src/view/items/Component.js","../src/view/items/element/Decorator.js","../src/view/items/Doctype.js","../src/config/errors.js","../src/Ractive/static/interpolators.js","../src/shared/keypaths.js","../src/global/capture.js","../src/model/specials/KeyModel.js","../src/model/specials/KeypathModel.js","../src/utils/bind.js","../src/model/ModelBase.js","../src/model/LinkModel.js","../src/global/TransitionManager.js","../src/global/runloop.js","../src/shared/Ticker.js","../src/model/helpers/getPrefixer.js","../src/model/Model.js","../src/model/specials/SharedModel.js","../src/view/resolvers/resolveReference.js","../src/shared/getRactiveContext.js","../src/shared/set.js","../src/Ractive/prototype/shared/add.js","../src/Ractive/prototype/animate.js","../src/events/fireEvent.js","../src/events/Hook.js","../src/Ractive/prototype/attachChild.js","../src/Ractive/prototype/detach.js","../src/Ractive/prototype/detachChild.js","../src/config/types.js","../src/Ractive/prototype/shared/makeArrayMethod.js","../src/Ractive/prototype/update.js","../src/shared/Context.js","../src/Ractive/static/getContext.js","../src/utils/dom.js","../src/config/namespaces.js","../src/Ractive/prototype/insert.js","../src/Ractive/prototype/observe/Observer.js","../src/Ractive/prototype/observe/Pattern.js","../src/Ractive/prototype/observe/Array.js","../src/Ractive/prototype/observeOnce.js","../src/Ractive/prototype/shared/trim.js","../src/Ractive/prototype/shared/notEmptyString.js","../src/Ractive/prototype/pop.js","../src/Ractive/prototype/push.js","../src/global/css.js","../src/Ractive/config/custom/adapt.js","../src/utils/cleanCss.js","../src/Ractive/config/custom/css/transform.js","../src/model/specials/CSSModel.js","../src/Ractive/config/custom/css/css.js","../src/Ractive/config/custom/data.js","../src/config/template.js","../src/parse/utils/createFunction.js","../src/parse/_parse.js","../src/Ractive/helpers/getComputationSignature.js","../src/Ractive/helpers/subscribe.js","../src/view/items/shared/directiveArgs.js","../src/view/items/element/binding/handleDomEvent.js","../src/utils/getSelectedOptions.js","../src/view/items/element/binding/selectBinding.js","../src/view/items/shared/progressiveText.js","../src/view/items/partial/getPartialTemplate.js","../src/view/items/component/getComponentConstructor.js","../src/view/items/asyncProxy.js","../src/view/helpers/processItems.js","../src/Ractive/prototype/render.js","../src/Ractive/prototype/resetTemplate.js","../src/Ractive/prototype/set.js","../src/Ractive/prototype/subtract.js","../src/Ractive/prototype/toggle.js","../src/Ractive/prototype/toCSS.js","../src/Ractive/prototype/toHTML.js","../src/Ractive/prototype/toText.js","../src/Ractive/prototype/transition.js","../src/Ractive/prototype/unlink.js","../src/Ractive/prototype/updateModel.js","../src/Ractive/static/isInstance.js","../src/Ractive/static/styleGet.js","../src/Ractive/static/sharedSet.js","../src/Ractive/static/sharedGet.js","../src/extend/_macro.js","../src/Ractive/static/keypaths.js","../src/Ractive/static/findPlugin.js","../src/polyfills/Object.assign.js","../src/utils/object.js","../src/utils/is.js","../src/polyfills/performance.now.js","../src/polyfills/array.find.js","../src/polyfills/node.contains.js","../src/polyfills/Promise.js","../src/polyfills/requestAnimationFrame.js","../src/Ractive/config/defaults.js","../src/utils/log.js","../src/Ractive/static/easing.js","../src/config/environment.js","../src/utils/noop.js","../src/shared/registry.js","../src/shared/interpolate.js","../src/utils/array.js","../src/shared/methodCallers.js","../src/shared/rebind.js","../src/Ractive/prototype/add.js","../src/events/eventStack.js","../src/shared/anchors.js","../src/Ractive/prototype/find.js","../src/Ractive/prototype/findAll.js","../src/Ractive/prototype/findAllComponents.js","../src/Ractive/prototype/findComponent.js","../src/Ractive/prototype/findContainer.js","../src/Ractive/prototype/findParent.js","../src/view/items/shared/findElement.js","../src/shared/getNewIndices.js","../src/Ractive/prototype/fire.js","../src/Ractive/prototype/get.js","../src/Ractive/prototype/getContext.js","../src/Ractive/prototype/link.js","../src/Ractive/prototype/observe.js","../src/Ractive/prototype/off.js","../src/Ractive/prototype/on.js","../src/Ractive/prototype/once.js","../src/Ractive/prototype/readLink.js","../src/utils/id.js","../src/Ractive/static/styleSet.js","../src/Ractive/config/wrapPrototypeMethod.js","../src/Ractive/config/deprecate.js","../src/view/resolvers/resolve.js"],"sourcesContent":["import { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject } from 'utils/is';\nimport { findMap } from 'utils/array';\nimport {\n  toEscapedString,\n  toString,\n  destroyed,\n  shuffled,\n  unbind,\n  unrender,\n  unrenderAndDestroy,\n  update\n} from 'shared/methodCallers';\nimport Fragment from './Fragment';\nimport findElement from './items/shared/findElement';\nimport { getContext } from 'shared/getRactiveContext';\nimport { keys } from 'utils/object';\n\nexport default class RepeatedFragment {\n  constructor(options) {\n    this.parent = options.owner.up;\n\n    // bit of a hack, so reference resolution works without another\n    // layer of indirection\n    this.up = this;\n    this.owner = options.owner;\n    this.ractive = this.parent.ractive;\n    this.delegate =\n      this.ractive.delegate !== false &&\n      (this.parent.delegate || findDelegate(findElement(options.owner)));\n    // delegation disabled by directive\n    if (this.delegate && this.delegate.delegate === false) this.delegate = false;\n    // let the element know it's a delegate handler\n    if (this.delegate) this.delegate.delegate = this.delegate;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    this.cssIds = 'cssIds' in options ? options.cssIds : this.parent ? this.parent.cssIds : null;\n\n    this.context = null;\n    this.rendered = false;\n    this.iterations = [];\n\n    this.template = options.template;\n\n    this.indexRef = options.indexRef;\n    this.keyRef = options.keyRef;\n\n    this.pendingNewIndices = null;\n    this.previousIterations = null;\n\n    // track array versus object so updates of type rest\n    this.isArray = false;\n  }\n\n  bind(context) {\n    this.context = context;\n    this.bound = true;\n    const value = context.get();\n\n    // {{#each array}}...\n    if ((this.isArray = isArray(value))) {\n      // we can't use map, because of sparse arrays\n      this.iterations = [];\n      const max = value.length;\n      for (let i = 0; i < max; i += 1) {\n        this.iterations[i] = this.createIteration(i, i);\n      }\n    } else if (isObject(value)) {\n      // {{#each object}}...\n      this.isArray = false;\n\n      // TODO this is a dreadful hack. There must be a neater way\n      if (this.indexRef) {\n        const refs = this.indexRef.split(',');\n        this.keyRef = refs[0];\n        this.indexRef = refs[1];\n      }\n\n      this.iterations = keys(value).map((key, index) => {\n        return this.createIteration(key, index);\n      });\n    }\n\n    return this;\n  }\n\n  bubble(index) {\n    if (!this.bubbled) this.bubbled = [];\n    this.bubbled.push(index);\n\n    this.owner.bubble();\n  }\n\n  createIteration(key, index) {\n    const fragment = new Fragment({\n      owner: this,\n      template: this.template\n    });\n\n    fragment.key = key;\n    fragment.index = index;\n    fragment.isIteration = true;\n    fragment.delegate = this.delegate;\n\n    const model = this.context.joinKey(key);\n\n    // set up an iteration alias if there is one\n    if (this.owner.template.z) {\n      fragment.aliases = {};\n      fragment.aliases[this.owner.template.z[0].n] = model;\n    }\n\n    return fragment.bind(model);\n  }\n\n  destroyed() {\n    this.iterations.forEach(destroyed);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    this.iterations.forEach(fragment => docFrag.appendChild(fragment.detach()));\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.iterations, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    return this.iterations.forEach(i => i.findAll(selector, options));\n  }\n\n  findAllComponents(name, options) {\n    return this.iterations.forEach(i => i.findAllComponents(name, options));\n  }\n\n  findComponent(name, options) {\n    return findMap(this.iterations, i => i.findComponent(name, options));\n  }\n\n  findContext() {\n    return this.context;\n  }\n\n  findNextNode(iteration) {\n    if (iteration.index < this.iterations.length - 1) {\n      for (let i = iteration.index + 1; i < this.iterations.length; i++) {\n        const node = this.iterations[i].firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    return this.owner.findNextNode();\n  }\n\n  firstNode(skipParent) {\n    return this.iterations[0] ? this.iterations[0].firstNode(skipParent) : null;\n  }\n\n  rebind(next) {\n    this.context = next;\n    this.iterations.forEach(fragment => {\n      const model = next ? next.joinKey(fragment.key) : undefined;\n      fragment.context = model;\n      if (this.owner.template.z) {\n        fragment.aliases = {};\n        fragment.aliases[this.owner.template.z[0].n] = model;\n      }\n    });\n  }\n\n  render(target, occupants) {\n    // TODO use docFrag.cloneNode...\n\n    const xs = this.iterations;\n    if (xs) {\n      const len = xs.length;\n      for (let i = 0; i < len; i++) {\n        xs[i].render(target, occupants);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  shuffle(newIndices) {\n    if (!this.pendingNewIndices) this.previousIterations = this.iterations.slice();\n\n    if (!this.pendingNewIndices) this.pendingNewIndices = [];\n\n    this.pendingNewIndices.push(newIndices);\n\n    const iterations = [];\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      if (newIndex === -1) return;\n\n      const fragment = this.iterations[oldIndex];\n      iterations[newIndex] = fragment;\n\n      if (newIndex !== oldIndex && fragment) fragment.dirty = true;\n    });\n\n    this.iterations = iterations;\n\n    this.bubble();\n  }\n\n  shuffled() {\n    this.iterations.forEach(shuffled);\n  }\n\n  toString(escape) {\n    return this.iterations ? this.iterations.map(escape ? toEscapedString : toString).join('') : '';\n  }\n\n  unbind() {\n    this.bound = false;\n    this.iterations.forEach(unbind);\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    this.iterations.forEach(shouldDestroy ? unrenderAndDestroy : unrender);\n    if (this.pendingNewIndices && this.previousIterations) {\n      this.previousIterations.forEach(fragment => {\n        if (fragment.rendered) shouldDestroy ? unrenderAndDestroy(fragment) : unrender(fragment);\n      });\n    }\n    this.rendered = false;\n  }\n\n  // TODO smart update\n  update() {\n    // skip dirty check, since this is basically just a facade\n\n    if (this.pendingNewIndices) {\n      this.bubbled.length = 0;\n      this.updatePostShuffle();\n      return;\n    }\n\n    if (this.updating) return;\n    this.updating = true;\n\n    const value = this.context.get();\n    const wasArray = this.isArray;\n\n    let toRemove;\n    let oldKeys;\n    let reset = true;\n    let i;\n\n    if ((this.isArray = isArray(value))) {\n      if (wasArray) {\n        reset = false;\n        if (this.iterations.length > value.length) {\n          toRemove = this.iterations.splice(value.length);\n        }\n      }\n    } else if (isObject(value) && !wasArray) {\n      reset = false;\n      toRemove = [];\n      oldKeys = {};\n      i = this.iterations.length;\n\n      while (i--) {\n        const fragment = this.iterations[i];\n        if (fragment.key in value) {\n          oldKeys[fragment.key] = true;\n        } else {\n          this.iterations.splice(i, 1);\n          toRemove.push(fragment);\n        }\n      }\n    }\n\n    if (reset) {\n      toRemove = this.iterations;\n      this.iterations = [];\n    }\n\n    if (toRemove) {\n      toRemove.forEach(fragment => {\n        fragment.unbind();\n        fragment.unrender(true);\n      });\n    }\n\n    // update the remaining ones\n    if (!reset && this.isArray && this.bubbled && this.bubbled.length) {\n      const bubbled = this.bubbled;\n      this.bubbled = [];\n      bubbled.forEach(i => this.iterations[i] && this.iterations[i].update());\n    } else {\n      this.iterations.forEach(update);\n    }\n\n    // add new iterations\n    const newLength = isArray(value) ? value.length : isObject(value) ? keys(value).length : 0;\n\n    let docFrag;\n    let fragment;\n\n    if (newLength > this.iterations.length) {\n      docFrag = this.rendered ? createDocumentFragment() : null;\n      i = this.iterations.length;\n\n      if (isArray(value)) {\n        while (i < value.length) {\n          fragment = this.createIteration(i, i);\n\n          this.iterations.push(fragment);\n          if (this.rendered) fragment.render(docFrag);\n\n          i += 1;\n        }\n      } else if (isObject(value)) {\n        // TODO this is a dreadful hack. There must be a neater way\n        if (this.indexRef && !this.keyRef) {\n          const refs = this.indexRef.split(',');\n          this.keyRef = refs[0];\n          this.indexRef = refs[1];\n        }\n\n        keys(value).forEach(key => {\n          if (!oldKeys || !(key in oldKeys)) {\n            fragment = this.createIteration(key, i);\n\n            this.iterations.push(fragment);\n            if (this.rendered) fragment.render(docFrag);\n\n            i += 1;\n          }\n        });\n      }\n\n      if (this.rendered) {\n        const parentNode = this.parent.findParentNode();\n        const anchor = this.parent.findNextNode(this.owner);\n\n        parentNode.insertBefore(docFrag, anchor);\n      }\n    }\n\n    this.updating = false;\n  }\n\n  updatePostShuffle() {\n    const newIndices = this.pendingNewIndices[0];\n\n    // map first shuffle through\n    this.pendingNewIndices.slice(1).forEach(indices => {\n      newIndices.forEach((newIndex, oldIndex) => {\n        newIndices[oldIndex] = indices[newIndex];\n      });\n    });\n\n    // This algorithm (for detaching incorrectly-ordered fragments from the DOM and\n    // storing them in a document fragment for later reinsertion) seems a bit hokey,\n    // but it seems to work for now\n    const len = this.context.get().length;\n    const oldLen = this.previousIterations.length;\n    const removed = {};\n    let i;\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      const fragment = this.previousIterations[oldIndex];\n      this.previousIterations[oldIndex] = null;\n\n      if (newIndex === -1) {\n        removed[oldIndex] = fragment;\n      } else if (fragment.index !== newIndex) {\n        const model = this.context.joinKey(newIndex);\n        fragment.index = fragment.key = newIndex;\n        fragment.context = model;\n        if (this.owner.template.z) {\n          fragment.aliases = {};\n          fragment.aliases[this.owner.template.z[0].n] = model;\n        }\n      }\n    });\n\n    // if the array was spliced outside of ractive, sometimes there are leftover fragments not in the newIndices\n    this.previousIterations.forEach((frag, i) => {\n      if (frag) removed[i] = frag;\n    });\n\n    // create new/move existing iterations\n    const docFrag = this.rendered ? createDocumentFragment() : null;\n    const parentNode = this.rendered ? this.parent.findParentNode() : null;\n\n    const contiguous = 'startIndex' in newIndices;\n    i = contiguous ? newIndices.startIndex : 0;\n\n    for (i; i < len; i++) {\n      const frag = this.iterations[i];\n\n      if (frag && contiguous) {\n        // attach any built-up iterations\n        if (this.rendered) {\n          if (removed[i]) docFrag.appendChild(removed[i].detach());\n          if (docFrag.childNodes.length) parentNode.insertBefore(docFrag, frag.firstNode());\n        }\n        continue;\n      }\n\n      if (!frag) this.iterations[i] = this.createIteration(i, i);\n\n      if (this.rendered) {\n        if (removed[i]) docFrag.appendChild(removed[i].detach());\n\n        if (frag) docFrag.appendChild(frag.detach());\n        else {\n          this.iterations[i].render(docFrag);\n        }\n      }\n    }\n\n    // append any leftovers\n    if (this.rendered) {\n      for (i = len; i < oldLen; i++) {\n        if (removed[i]) docFrag.appendChild(removed[i].detach());\n      }\n\n      if (docFrag.childNodes.length) {\n        parentNode.insertBefore(docFrag, this.owner.findNextNode());\n      }\n    }\n\n    // trigger removal on old nodes\n    keys(removed).forEach(k => removed[k].unbind().unrender(true));\n\n    this.iterations.forEach(update);\n\n    this.pendingNewIndices = null;\n\n    this.shuffled();\n  }\n}\n\nRepeatedFragment.prototype.getContext = getContext;\n\n// find the topmost delegate\nfunction findDelegate(start) {\n  let el = start;\n  let delegate = start;\n\n  while (el) {\n    if (el.delegate) delegate = el;\n    el = el.parent;\n  }\n\n  return delegate;\n}\n","import {\n  SECTION_EACH,\n  SECTION_IF,\n  SECTION_IF_WITH,\n  SECTION_UNLESS,\n  SECTION_WITH\n} from 'config/types';\nimport { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject, isObjectLike } from 'utils/is';\nimport { keep } from 'shared/set';\nimport runloop from 'src/global/runloop';\nimport Fragment from '../Fragment';\nimport RepeatedFragment from '../RepeatedFragment';\nimport { MustacheContainer } from './shared/Mustache';\nimport { keys } from 'utils/object';\n\nfunction isEmpty(value) {\n  return (\n    !value ||\n    (isArray(value) && value.length === 0) ||\n    (isObject(value) && keys(value).length === 0)\n  );\n}\n\nfunction getType(value, hasIndexRef) {\n  if (hasIndexRef || isArray(value)) return SECTION_EACH;\n  if (isObjectLike(value)) return SECTION_IF_WITH;\n  if (value === undefined) return null;\n  return SECTION_IF;\n}\n\nexport default class Section extends MustacheContainer {\n  constructor(options) {\n    super(options);\n\n    this.sectionType = options.template.n || null;\n    this.templateSectionType = this.sectionType;\n    this.subordinate = options.template.l === 1;\n    this.fragment = null;\n  }\n\n  bind() {\n    super.bind();\n\n    if (this.subordinate) {\n      this.sibling = this.up.items[this.up.items.indexOf(this) - 1];\n      this.sibling.nextSibling = this;\n    }\n\n    // if we managed to bind, we need to create children\n    if (this.model) {\n      this.dirty = true;\n      this.update();\n    } else if (\n      this.sectionType &&\n      this.sectionType === SECTION_UNLESS &&\n      (!this.sibling || !this.sibling.isTruthy())\n    ) {\n      this.fragment = new Fragment({\n        owner: this,\n        template: this.template.f\n      }).bind();\n    }\n  }\n\n  detach() {\n    const frag = this.fragment || this.detached;\n    return frag ? frag.detach() : super.detach();\n  }\n\n  isTruthy() {\n    if (this.subordinate && this.sibling.isTruthy()) return true;\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    return !!value && (this.templateSectionType === SECTION_IF_WITH || !isEmpty(value));\n  }\n\n  rebind(next, previous, safe) {\n    if (super.rebind(next, previous, safe)) {\n      if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n        this.fragment.rebind(next);\n      }\n    }\n  }\n\n  render(target, occupants) {\n    this.rendered = true;\n    if (this.fragment) this.fragment.render(target, occupants);\n  }\n\n  shuffle(newIndices) {\n    if (this.fragment && this.sectionType === SECTION_EACH) {\n      this.fragment.shuffle(newIndices);\n    }\n  }\n\n  unbind() {\n    super.unbind();\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (!this.dirty) return;\n\n    if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n      this.fragment.context = this.model;\n    }\n\n    if (!this.model && this.sectionType !== SECTION_UNLESS) return;\n\n    this.dirty = false;\n\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    const siblingFalsey = !this.subordinate || !this.sibling.isTruthy();\n    const lastType = this.sectionType;\n\n    // watch for switching section types\n    if (this.sectionType === null || this.templateSectionType === null)\n      this.sectionType = getType(value, this.template.i);\n    if (lastType && lastType !== this.sectionType && this.fragment) {\n      if (this.rendered) {\n        this.fragment.unbind().unrender(true);\n      }\n\n      this.fragment = null;\n    }\n\n    let newFragment;\n\n    const fragmentShouldExist =\n      this.sectionType === SECTION_EACH || // each always gets a fragment, which may have no iterations\n      this.sectionType === SECTION_WITH || // with (partial context) always gets a fragment\n      (siblingFalsey && (this.sectionType === SECTION_UNLESS ? !this.isTruthy() : this.isTruthy())); // if, unless, and if-with depend on siblings and the condition\n\n    if (fragmentShouldExist) {\n      if (!this.fragment) this.fragment = this.detached;\n\n      if (this.fragment) {\n        // check for detached fragment\n        if (this.detached) {\n          attach(this, this.fragment);\n          this.detached = false;\n          this.rendered = true;\n        }\n\n        if (!this.fragment.bound) this.fragment.bind(this.model);\n        this.fragment.update();\n      } else {\n        if (this.sectionType === SECTION_EACH) {\n          newFragment = new RepeatedFragment({\n            owner: this,\n            template: this.template.f,\n            indexRef: this.template.i\n          }).bind(this.model);\n        } else {\n          // only with and if-with provide context - if and unless do not\n          const context =\n            this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS\n              ? this.model\n              : null;\n          newFragment = new Fragment({\n            owner: this,\n            template: this.template.f\n          }).bind(context);\n        }\n      }\n    } else {\n      if (this.fragment && this.rendered) {\n        if (keep !== true) {\n          this.fragment.unbind().unrender(true);\n        } else {\n          this.unrender(false);\n          this.detached = this.fragment;\n          runloop.promise().then(() => {\n            if (this.detached) this.detach();\n          });\n        }\n      } else if (this.fragment) {\n        this.fragment.unbind();\n      }\n\n      this.fragment = null;\n    }\n\n    if (newFragment) {\n      if (this.rendered) {\n        attach(this, newFragment);\n      }\n\n      this.fragment = newFragment;\n    }\n\n    if (this.nextSibling) {\n      this.nextSibling.dirty = true;\n      this.nextSibling.update();\n    }\n  }\n}\n\nfunction attach(section, fragment) {\n  const anchor = section.up.findNextNode(section);\n\n  if (anchor) {\n    const docFrag = createDocumentFragment();\n    fragment.render(docFrag);\n\n    anchor.parentNode.insertBefore(docFrag, anchor);\n  } else {\n    fragment.render(section.up.findParentNode());\n  }\n}\n","import { toArray } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Element from '../../Element';\nimport { isArray, isFunction } from 'utils/is';\n\nexport default class Select extends Element {\n  constructor(options) {\n    super(options);\n    this.options = [];\n  }\n\n  foundNode(node) {\n    if (this.binding) {\n      const selectedOptions = getSelectedOptions(node);\n\n      if (selectedOptions.length > 0) {\n        this.selectedOptions = selectedOptions;\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.sync();\n\n    const node = this.node;\n\n    let i = node.options.length;\n    while (i--) {\n      node.options[i].defaultSelected = node.options[i].selected;\n    }\n\n    this.rendered = true;\n  }\n\n  sync() {\n    const selectNode = this.node;\n\n    if (!selectNode) return;\n\n    const options = toArray(selectNode.options);\n\n    if (this.selectedOptions) {\n      options.forEach(o => {\n        if (this.selectedOptions.indexOf(o) >= 0) o.selected = true;\n        else o.selected = false;\n      });\n      this.binding.setFromNode(selectNode);\n      delete this.selectedOptions;\n      return;\n    }\n\n    const selectValue = this.getAttribute('value');\n    const isMultiple = this.getAttribute('multiple');\n    const array = isMultiple && isArray(selectValue);\n\n    // If the <select> has a specified value, that should override\n    // these options\n    if (selectValue !== undefined) {\n      let optionWasSelected;\n\n      options.forEach(o => {\n        const optionValue = o._ractive ? o._ractive.value : o.value;\n        const shouldSelect = isMultiple\n          ? array && this.valueContains(selectValue, optionValue)\n          : this.compare(selectValue, optionValue);\n\n        if (shouldSelect) {\n          optionWasSelected = true;\n        }\n\n        o.selected = shouldSelect;\n      });\n\n      if (!optionWasSelected && !isMultiple) {\n        if (this.binding) {\n          this.binding.forceUpdate();\n        }\n      }\n    } else if (this.binding && this.binding.forceUpdate) {\n      // Otherwise the value should be initialised according to which\n      // <option> element is selected, if twoway binding is in effect\n      this.binding.forceUpdate();\n    }\n  }\n  valueContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.compare(optionValue, selectValue[i])) return true;\n    }\n  }\n  compare(optionValue, selectValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(selectValue, optionValue);\n      }\n      if (selectValue && optionValue) {\n        return selectValue[comparator] == optionValue[comparator];\n      }\n    }\n    return selectValue == optionValue;\n  }\n  update() {\n    const dirty = this.dirty;\n    super.update();\n    if (dirty) {\n      this.sync();\n    }\n  }\n}\n","import { ATTRIBUTE } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport Input from './Input';\nimport { isBindable } from '../binding/selectBinding';\nimport createItem from '../../createItem';\nimport Fragment from '../../../Fragment';\n\nexport default class Textarea extends Input {\n  constructor(options) {\n    const template = options.template;\n\n    options.deferContent = true;\n\n    super(options);\n\n    // check for single interpolator binding\n    if (!this.attributeByName.value) {\n      if (template.f && isBindable({ template })) {\n        (this.attributes || (this.attributes = [])).push(\n          createItem({\n            owner: this,\n            template: { t: ATTRIBUTE, f: template.f, n: 'value' },\n            up: this.up\n          })\n        );\n      } else {\n        this.fragment = new Fragment({\n          owner: this,\n          cssIds: null,\n          template: template.f\n        });\n      }\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.rendered && !this.binding && this.fragment) {\n        runloop.scheduleTask(() => {\n          this.dirty = false;\n          this.node.value = this.fragment.toString();\n        });\n      }\n\n      this.up.bubble(); // default behaviour\n    }\n  }\n}\n","import { TEXT } from 'config/types';\nimport { escapeHtml } from 'utils/html';\nimport { detachNode } from 'utils/dom';\nimport noop from 'utils/noop';\nimport Item from './shared/Item';\nimport progressiveText from './shared/progressiveText';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Text extends Item {\n  constructor(options) {\n    super(options);\n    this.type = TEXT;\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, this.template);\n  }\n\n  toString(escape) {\n    return escape ? escapeHtml(this.template) : this.template;\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  valueOf() {\n    return this.template;\n  }\n}\n\nconst proto = Text.prototype;\nproto.bind = proto.unbind = proto.update = noop;\n","import { win, doc, vendors } from './environment';\n\nexport let visible;\nlet hidden = 'hidden';\n\nif (doc) {\n  let prefix;\n\n  /* istanbul ignore next */\n  if (hidden in doc) {\n    prefix = '';\n  } else {\n    let i = vendors.length;\n    while (i--) {\n      const vendor = vendors[i];\n      hidden = vendor + 'Hidden';\n\n      if (hidden in doc) {\n        prefix = vendor;\n        break;\n      }\n    }\n  }\n\n  /* istanbul ignore else */\n  if (prefix !== undefined) {\n    doc.addEventListener(prefix + 'visibilitychange', onChange);\n    onChange();\n  } else {\n    // gah, we're in an old browser\n    if ('onfocusout' in doc) {\n      doc.addEventListener('focusout', onHide);\n      doc.addEventListener('focusin', onShow);\n    } else {\n      win.addEventListener('pagehide', onHide);\n      win.addEventListener('blur', onHide);\n\n      win.addEventListener('pageshow', onShow);\n      win.addEventListener('focus', onShow);\n    }\n\n    visible = true; // until proven otherwise. Not ideal but hey\n  }\n}\n\nfunction onChange() {\n  visible = !doc[hidden];\n}\n\n/* istanbul ignore next */\nfunction onHide() {\n  visible = false;\n}\n\n/* istanbul ignore next */\nfunction onShow() {\n  visible = true;\n}\n","import { isClient, vendors } from 'config/environment';\nimport { createElement } from 'utils/dom';\nimport hyphenateCamel from 'utils/hyphenateCamel';\n\nlet prefix;\n\n/* istanbul ignore next */\nif (!isClient) {\n  prefix = null;\n} else {\n  const prefixCache = {};\n  const testStyle = createElement('div').style;\n\n  // technically this also normalizes on hyphenated styles as well\n  prefix = function(prop) {\n    if (!prefixCache[prop]) {\n      const name = hyphenateCamel(prop);\n\n      if (testStyle[prop] !== undefined) {\n        prefixCache[prop] = name;\n      } else {\n        /* istanbul ignore next */\n        // test vendors...\n        let i = vendors.length;\n        while (i--) {\n          const vendor = `-${vendors[i]}-${name}`;\n          if (testStyle[vendor] !== undefined) {\n            prefixCache[prop] = vendor;\n            break;\n          }\n        }\n      }\n    }\n\n    return prefixCache[prop];\n  };\n}\n\nexport default prefix;\n","import { missingPlugin } from 'config/errors';\nimport { isClient } from 'config/environment';\nimport { warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { createElement } from 'utils/dom';\nimport interpolate from 'shared/interpolate';\nimport Ticker from 'shared/Ticker';\nimport hyphenate from './hyphenate';\nimport { isFunction, isString } from 'utils/is';\n\nlet createTransitions;\n\nif (!isClient) {\n  createTransitions = null;\n} else {\n  const testStyle = createElement('div').style;\n  const linear = x => x;\n\n  const canUseCssTransitions = {};\n  const cannotUseCssTransitions = {};\n\n  // determine some facts about our environment\n  let TRANSITION;\n  let TRANSITIONEND;\n  let CSS_TRANSITIONS_ENABLED;\n  let TRANSITION_DURATION;\n  let TRANSITION_PROPERTY;\n  let TRANSITION_TIMING_FUNCTION;\n\n  if (testStyle.transition !== undefined) {\n    TRANSITION = 'transition';\n    TRANSITIONEND = 'transitionend';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else if (testStyle.webkitTransition !== undefined) {\n    TRANSITION = 'webkitTransition';\n    TRANSITIONEND = 'webkitTransitionEnd';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else {\n    CSS_TRANSITIONS_ENABLED = false;\n  }\n\n  if (TRANSITION) {\n    TRANSITION_DURATION = TRANSITION + 'Duration';\n    TRANSITION_PROPERTY = TRANSITION + 'Property';\n    TRANSITION_TIMING_FUNCTION = TRANSITION + 'TimingFunction';\n  }\n\n  createTransitions = function(t, to, options, changedProperties, resolve) {\n    // Wait a beat (otherwise the target styles will be applied immediately)\n    // TODO use a fastdom-style mechanism?\n    setTimeout(() => {\n      let jsTransitionsComplete;\n      let cssTransitionsComplete;\n      let cssTimeout; // eslint-disable-line prefer-const\n\n      function transitionDone() {\n        clearTimeout(cssTimeout);\n      }\n\n      function checkComplete() {\n        if (jsTransitionsComplete && cssTransitionsComplete) {\n          t.unregisterCompleteHandler(transitionDone);\n          // will changes to events and fire have an unexpected consequence here?\n          t.ractive.fire(t.name + ':end', t.node, t.isIntro);\n          resolve();\n        }\n      }\n\n      // this is used to keep track of which elements can use CSS to animate\n      // which properties\n      const hashPrefix = (t.node.namespaceURI || '') + t.node.tagName;\n\n      // need to reset transition properties\n      const style = t.node.style;\n      const previous = {\n        property: style[TRANSITION_PROPERTY],\n        timing: style[TRANSITION_TIMING_FUNCTION],\n        duration: style[TRANSITION_DURATION]\n      };\n\n      function transitionEndHandler(event) {\n        const index = changedProperties.indexOf(event.propertyName);\n\n        if (index !== -1) {\n          changedProperties.splice(index, 1);\n        }\n\n        if (changedProperties.length) {\n          // still transitioning...\n          return;\n        }\n\n        clearTimeout(cssTimeout);\n        cssTransitionsDone();\n      }\n\n      function cssTransitionsDone() {\n        style[TRANSITION_PROPERTY] = previous.property;\n        style[TRANSITION_TIMING_FUNCTION] = previous.duration;\n        style[TRANSITION_DURATION] = previous.timing;\n\n        t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n        cssTransitionsComplete = true;\n        checkComplete();\n      }\n\n      t.node.addEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n      // safety net in case transitionend never fires\n      cssTimeout = setTimeout(() => {\n        changedProperties = [];\n        cssTransitionsDone();\n      }, options.duration + (options.delay || 0) + 50);\n      t.registerCompleteHandler(transitionDone);\n\n      style[TRANSITION_PROPERTY] = changedProperties.join(',');\n      const easingName = hyphenate(options.easing || 'linear');\n      style[TRANSITION_TIMING_FUNCTION] = easingName;\n      const cssTiming = style[TRANSITION_TIMING_FUNCTION] === easingName;\n      style[TRANSITION_DURATION] = options.duration / 1000 + 's';\n\n      setTimeout(() => {\n        let i = changedProperties.length;\n        let hash;\n        let originalValue = null;\n        let index;\n        const propertiesToTransitionInJs = [];\n        let prop;\n        let suffix;\n        let interpolator;\n\n        while (i--) {\n          prop = changedProperties[i];\n          hash = hashPrefix + prop;\n\n          if (cssTiming && CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[hash]) {\n            const initial = style[prop];\n            style[prop] = to[prop];\n\n            // If we're not sure if CSS transitions are supported for\n            // this tag/property combo, find out now\n            if (!(hash in canUseCssTransitions)) {\n              originalValue = t.getStyle(prop);\n\n              // if this property is transitionable in this browser,\n              // the current style will be different from the target style\n              canUseCssTransitions[hash] = t.getStyle(prop) != to[prop];\n              cannotUseCssTransitions[hash] = !canUseCssTransitions[hash];\n\n              // Reset, if we're going to use timers after all\n              if (cannotUseCssTransitions[hash]) {\n                style[prop] = initial;\n              }\n            }\n          }\n\n          if (!cssTiming || !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[hash]) {\n            // we need to fall back to timer-based stuff\n            if (originalValue === null) originalValue = t.getStyle(prop);\n\n            // need to remove this from changedProperties, otherwise transitionEndHandler\n            // will get confused\n            index = changedProperties.indexOf(prop);\n            if (index === -1) {\n              warnIfDebug(\n                'Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!',\n                { node: t.node }\n              );\n            } else {\n              changedProperties.splice(index, 1);\n            }\n\n            // TODO Determine whether this property is animatable at all\n\n            suffix = /[^\\d]*$/.exec(originalValue)[0];\n            interpolator = interpolate(parseFloat(originalValue), parseFloat(to[prop]));\n\n            // ...then kick off a timer-based transition\n            if (interpolator) {\n              propertiesToTransitionInJs.push({\n                name: prop,\n                interpolator,\n                suffix\n              });\n            } else {\n              style[prop] = to[prop];\n            }\n\n            originalValue = null;\n          }\n        }\n\n        // javascript transitions\n        if (propertiesToTransitionInJs.length) {\n          let easing;\n\n          if (isString(options.easing)) {\n            easing = t.ractive.easing[options.easing];\n\n            if (!easing) {\n              warnOnceIfDebug(missingPlugin(options.easing, 'easing'));\n              easing = linear;\n            }\n          } else if (isFunction(options.easing)) {\n            easing = options.easing;\n          } else {\n            easing = linear;\n          }\n\n          new Ticker({\n            duration: options.duration,\n            easing,\n            step(pos) {\n              let i = propertiesToTransitionInJs.length;\n              while (i--) {\n                const prop = propertiesToTransitionInJs[i];\n                style[prop.name] = prop.interpolator(pos) + prop.suffix;\n              }\n            },\n            complete() {\n              jsTransitionsComplete = true;\n              checkComplete();\n            }\n          });\n        } else {\n          jsTransitionsComplete = true;\n        }\n\n        if (changedProperties.length) {\n          style[TRANSITION_PROPERTY] = changedProperties.join(',');\n        } else {\n          style[TRANSITION_PROPERTY] = 'none';\n\n          // We need to cancel the transitionEndHandler, and deal with\n          // the fact that it will never fire\n          t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n          cssTransitionsComplete = true;\n          checkComplete();\n        }\n      }, 0);\n    }, options.delay || 0);\n  };\n}\n\nexport default createTransitions;\n","import { vendors } from 'config/environment';\n\nconst vendorPattern = new RegExp('^(?:' + vendors.join('|') + ')([A-Z])');\n\nexport default function(str) {\n  /* istanbul ignore next */\n  if (!str) return ''; // edge case\n\n  /* istanbul ignore next */\n  if (vendorPattern.test(str)) str = '-' + str;\n\n  return str.replace(/[A-Z]/g, match => '-' + match.toLowerCase());\n}\n","import { win } from 'config/environment';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isFunction, isNumber, isString } from 'utils/is';\nimport noop from 'utils/noop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { findInViewHierarchy } from 'shared/registry';\nimport { visible } from 'config/visibility';\nimport findElement from '../shared/findElement';\nimport prefix from './transitions/prefix';\nimport createTransitions from './transitions/createTransitions';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport { assign, hasOwn, keys } from 'utils/object';\n\nconst getComputedStyle = win && win.getComputedStyle;\nconst resolved = Promise.resolve();\n\nconst names = {\n  t0: 'intro-outro',\n  t1: 'intro',\n  t2: 'outro'\n};\n\nexport default class Transition {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.ractive = this.owner.ractive;\n    this.template = options.template;\n    this.up = options.up;\n    this.options = options;\n    this.onComplete = [];\n  }\n\n  animateStyle(style, value, options) {\n    if (arguments.length === 4) {\n      throw new Error(\n        't.animateStyle() returns a promise - use .then() instead of passing a callback'\n      );\n    }\n\n    // Special case - page isn't visible. Don't animate anything, because\n    // that way you'll never get CSS transitionend events\n    if (!visible) {\n      this.setStyle(style, value);\n      return resolved;\n    }\n\n    let to;\n\n    if (isString(style)) {\n      to = {};\n      to[style] = value;\n    } else {\n      to = style;\n\n      // shuffle arguments\n      options = value;\n    }\n\n    return new Promise(fulfil => {\n      // Edge case - if duration is zero, set style synchronously and complete\n      if (!options.duration) {\n        this.setStyle(to);\n        fulfil();\n        return;\n      }\n\n      // Get a list of the properties we're animating\n      const propertyNames = keys(to);\n      const changedProperties = [];\n\n      // Store the current styles\n      const computedStyle = getComputedStyle(this.node);\n\n      let i = propertyNames.length;\n      while (i--) {\n        const prop = propertyNames[i];\n        const name = prefix(prop);\n\n        const current = computedStyle[prefix(prop)];\n\n        // record the starting points\n        const init = this.node.style[name];\n        if (!(name in this.originals)) this.originals[name] = this.node.style[name];\n        this.node.style[name] = to[prop];\n        this.targets[name] = this.node.style[name];\n        this.node.style[name] = init;\n\n        // we need to know if we're actually changing anything\n        if (current != to[prop]) {\n          // use != instead of !==, so we can compare strings with numbers\n          changedProperties.push(name);\n\n          // if we happened to prefix, make sure there is a properly prefixed value\n          to[name] = to[prop];\n\n          // make the computed style explicit, so we can animate where\n          // e.g. height='auto'\n          this.node.style[name] = current;\n        }\n      }\n\n      // If we're not actually changing anything, the transitionend event\n      // will never fire! So we complete early\n      if (!changedProperties.length) {\n        fulfil();\n        return;\n      }\n\n      createTransitions(this, to, options, changedProperties, fulfil);\n    });\n  }\n\n  bind() {\n    const options = this.options;\n    const type = options.template && options.template.v;\n    if (type) {\n      if (type === 't0' || type === 't1') this.element.intro = this;\n      if (type === 't0' || type === 't2') this.element.outro = this;\n      this.eventName = names[type];\n    }\n\n    const ractive = this.owner.ractive;\n\n    this.name = options.name || options.template.n;\n\n    if (options.params) {\n      this.params = options.params;\n    }\n\n    if (isFunction(this.name)) {\n      this._fn = this.name;\n      this.name = this._fn.name;\n    } else {\n      this._fn = findInViewHierarchy('transitions', ractive, this.name);\n    }\n\n    if (!this._fn) {\n      warnOnceIfDebug(missingPlugin(this.name, 'transition'), { ractive });\n    }\n\n    setupArgsFn(this, options.template);\n  }\n\n  getParams() {\n    if (this.params) return this.params;\n\n    // get expression args if supplied\n    if (this.fn) {\n      const values = resolveArgs(this, this.template, this.up).map(model => {\n        if (!model) return undefined;\n\n        return model.get();\n      });\n      return this.fn.apply(this.ractive, values);\n    }\n  }\n\n  getStyle(props) {\n    const computedStyle = getComputedStyle(this.node);\n\n    if (isString(props)) {\n      return computedStyle[prefix(props)];\n    }\n\n    if (!isArray(props)) {\n      throw new Error(\n        'Transition$getStyle must be passed a string, or an array of strings representing CSS properties'\n      );\n    }\n\n    const styles = {};\n\n    let i = props.length;\n    while (i--) {\n      const prop = props[i];\n      let value = computedStyle[prefix(prop)];\n\n      if (value === '0px') value = 0;\n      styles[prop] = value;\n    }\n\n    return styles;\n  }\n\n  processParams(params, defaults) {\n    if (isNumber(params)) {\n      params = { duration: params };\n    } else if (isString(params)) {\n      if (params === 'slow') {\n        params = { duration: 600 };\n      } else if (params === 'fast') {\n        params = { duration: 200 };\n      } else {\n        params = { duration: 400 };\n      }\n    } else if (!params) {\n      params = {};\n    }\n\n    return assign({}, defaults, params);\n  }\n\n  registerCompleteHandler(fn) {\n    addToArray(this.onComplete, fn);\n  }\n\n  setStyle(style, value) {\n    if (isString(style)) {\n      const name = prefix(style);\n      if (!hasOwn(this.originals, name)) this.originals[name] = this.node.style[name];\n      this.node.style[name] = value;\n      this.targets[name] = this.node.style[name];\n    } else {\n      let prop;\n      for (prop in style) {\n        if (hasOwn(style, prop)) {\n          this.setStyle(prop, style[prop]);\n        }\n      }\n    }\n\n    return this;\n  }\n\n  shouldFire(type) {\n    if (!this.ractive.transitionsEnabled) return false;\n\n    // check for noIntro and noOutro cases, which only apply when the owner ractive is rendering and unrendering, respectively\n    if (type === 'intro' && this.ractive.rendering && nearestProp('noIntro', this.ractive, true))\n      return false;\n    if (type === 'outro' && this.ractive.unrendering && nearestProp('noOutro', this.ractive, false))\n      return false;\n\n    const params = this.getParams(); // this is an array, the params object should be the first member\n    // if there's not a parent element, this can't be nested, so roll on\n    if (!this.element.parent) return true;\n\n    // if there is a local param, it takes precedent\n    if (params && params[0] && isObject(params[0]) && 'nested' in params[0]) {\n      if (params[0].nested !== false) return true;\n    } else {\n      // use the nearest instance setting\n      // find the nearest instance that actually has a nested setting\n      if (nearestProp('nestedTransitions', this.ractive) !== false) return true;\n    }\n\n    // check to see if this is actually a nested transition\n    let el = this.element.parent;\n    while (el) {\n      if (el[type] && el[type].starting) return false;\n      el = el.parent;\n    }\n\n    return true;\n  }\n\n  start() {\n    const node = (this.node = this.element.node);\n    const originals = (this.originals = {}); //= node.getAttribute( 'style' );\n    const targets = (this.targets = {});\n\n    let completed;\n    const args = this.getParams();\n\n    // create t.complete() - we don't want this on the prototype,\n    // because we don't want `this` silliness when passing it as\n    // an argument\n    this.complete = noReset => {\n      this.starting = false;\n      if (completed) {\n        return;\n      }\n\n      this.onComplete.forEach(fn => fn());\n      if (!noReset && this.isIntro) {\n        for (const k in targets) {\n          if (node.style[k] === targets[k]) node.style[k] = originals[k];\n        }\n      }\n\n      this._manager.remove(this);\n\n      completed = true;\n    };\n\n    // If the transition function doesn't exist, abort\n    if (!this._fn) {\n      this.complete();\n      return;\n    }\n\n    const promise = this._fn.apply(this.ractive, [this].concat(args));\n    if (promise) promise.then(this.complete);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    if (!this.element.attributes.unbinding) {\n      const type = this.options && this.options.template && this.options.template.v;\n      if (type === 't0' || type === 't1') this.element.intro = null;\n      if (type === 't0' || type === 't2') this.element.outro = null;\n    }\n  }\n\n  unregisterCompleteHandler(fn) {\n    removeFromArray(this.onComplete, fn);\n  }\n}\n\nconst proto = Transition.prototype;\nproto.destroyed = proto.render = proto.unrender = proto.update = noop;\n\nfunction nearestProp(prop, ractive, rendering) {\n  let instance = ractive;\n  while (instance) {\n    if (\n      hasOwn(instance, prop) &&\n      (rendering === undefined || rendering ? instance.rendering : instance.unrendering)\n    )\n      return instance[prop];\n    instance = instance.component && instance.component.ractive;\n  }\n\n  return ractive[prop];\n}\n","import { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\n\nconst elementCache = {};\n\nlet ieBug;\nlet ieBlacklist;\n\ntry {\n  createElement('table').innerHTML = 'foo';\n} catch (/* istanbul ignore next */ err) {\n  ieBug = true;\n\n  ieBlacklist = {\n    TABLE: ['<table class=\"x\">', '</table>'],\n    THEAD: ['<table><thead class=\"x\">', '</thead></table>'],\n    TBODY: ['<table><tbody class=\"x\">', '</tbody></table>'],\n    TR: ['<table><tr class=\"x\">', '</tr></table>'],\n    SELECT: ['<select class=\"x\">', '</select>']\n  };\n}\n\nexport default function(html, node) {\n  const nodes = [];\n\n  // render 0 and false\n  if (html == null || html === '') return nodes;\n\n  let container;\n  let wrapper;\n  let selectedOption;\n\n  /* istanbul ignore if */\n  if (ieBug && (wrapper = ieBlacklist[node.tagName])) {\n    container = element('DIV');\n    container.innerHTML = wrapper[0] + html + wrapper[1];\n    container = container.querySelector('.x');\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  } else if (node.namespaceURI === svg) {\n    container = element('DIV');\n    container.innerHTML = '<svg class=\"x\">' + html + '</svg>';\n    container = container.querySelector('.x');\n  } else if (node.tagName === 'TEXTAREA') {\n    container = createElement('div');\n\n    if (typeof container.textContent !== 'undefined') {\n      container.textContent = html;\n    } else {\n      container.innerHTML = html;\n    }\n  } else {\n    container = element(node.tagName);\n    container.innerHTML = html;\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  }\n\n  let child;\n  while ((child = container.firstChild)) {\n    nodes.push(child);\n    container.removeChild(child);\n  }\n\n  // This is really annoying. Extracting <option> nodes from the\n  // temporary container <select> causes the remaining ones to\n  // become selected. So now we have to deselect them. IE8, you\n  // amaze me. You really do\n  // ...and now Chrome too\n  let i;\n  if (node.tagName === 'SELECT') {\n    i = nodes.length;\n    while (i--) {\n      if (nodes[i] !== selectedOption) {\n        nodes[i].selected = false;\n      }\n    }\n  }\n\n  return nodes;\n}\n\nfunction element(tagName) {\n  return elementCache[tagName] || (elementCache[tagName] = createElement(tagName));\n}\n","import { createDocumentFragment, matches } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport { decodeCharacterReferences } from 'utils/html';\nimport runloop from 'src/global/runloop';\nimport Mustache from './shared/Mustache';\nimport insertHtml from './triple/insertHtml';\nimport { inAttribute } from './element/Attribute';\n\nexport default class Triple extends Mustache {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    if (this.nodes) this.nodes.forEach(node => docFrag.appendChild(node));\n    return docFrag;\n  }\n\n  find(selector) {\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) return node;\n\n      const queryResult = node.querySelector(selector);\n      if (queryResult) return queryResult;\n    }\n\n    return null;\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) result.push(node);\n\n      const queryAllResult = node.querySelectorAll(selector);\n      if (queryAllResult) {\n        result.push.apply(result, queryAllResult);\n      }\n    }\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  firstNode() {\n    return this.rendered && this.nodes[0];\n  }\n\n  render(target, occupants, anchor) {\n    if (!this.nodes) {\n      const html = this.model ? this.model.get() : '';\n      this.nodes = insertHtml(html, target);\n    }\n\n    let nodes = this.nodes;\n\n    // progressive enhancement\n    if (occupants) {\n      let i = -1;\n      let next;\n\n      // start with the first node that should be rendered\n      while (occupants.length && (next = this.nodes[i + 1])) {\n        let n;\n        // look through the occupants until a matching node is found\n        while ((n = occupants.shift())) {\n          const t = n.nodeType;\n\n          if (\n            t === next.nodeType &&\n            ((t === 1 && n.outerHTML === next.outerHTML) ||\n              ((t === 3 || t === 8) && n.nodeValue === next.nodeValue))\n          ) {\n            this.nodes.splice(++i, 1, n); // replace the generated node with the existing one\n            break;\n          } else {\n            target.removeChild(n); // remove the non-matching existing node\n          }\n        }\n      }\n\n      if (i >= 0) {\n        // update the list of remaining nodes to attach, excluding any that were replaced by existing nodes\n        nodes = this.nodes.slice(i);\n      }\n\n      // update the anchor to be the next occupant\n      if (occupants.length) anchor = occupants[0];\n    }\n\n    // attach any remainging nodes to the parent\n    if (nodes.length) {\n      const frag = createDocumentFragment();\n      nodes.forEach(n => frag.appendChild(n));\n\n      if (anchor) {\n        target.insertBefore(frag, anchor);\n      } else {\n        target.appendChild(frag);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  toString() {\n    let value = this.model && this.model.get();\n    value = value != null ? '' + value : '';\n\n    return inAttribute() ? decodeCharacterReferences(value) : value;\n  }\n\n  unrender() {\n    if (this.nodes)\n      this.nodes.forEach(node => {\n        // defer detachment until all relevant outros are done\n        runloop.detachWhenReady({\n          node,\n          detach() {\n            detachNode(node);\n          }\n        });\n      });\n    this.rendered = false;\n    this.nodes = null;\n  }\n\n  update() {\n    if (this.rendered && this.dirty) {\n      this.dirty = false;\n\n      this.unrender();\n      this.render(this.up.findParentNode(), null, this.up.findNextNode(this));\n    } else {\n      // make sure to reset the dirty flag even if not rendered\n      this.dirty = false;\n    }\n  }\n}\n","import {\n  ALIAS,\n  ANCHOR,\n  COMMENT,\n  COMPONENT,\n  DOCTYPE,\n  ELEMENT,\n  INTERPOLATOR,\n  PARTIAL,\n  SECTION,\n  TRIPLE,\n  YIELDER\n} from 'config/types';\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, EVENT, TRANSITION } from 'config/types';\nimport Alias from './Alias';\nimport Attribute from './element/Attribute';\nimport BindingFlag from './element/BindingFlag';\nimport Comment from './Comment';\nimport Component from './Component';\nimport Decorator from './element/Decorator';\nimport Doctype from './Doctype';\nimport Form from './element/specials/Form';\nimport Element from './Element';\nimport EventDirective from './shared/EventDirective';\nimport Interpolator from './Interpolator';\nimport Input from './element/specials/Input';\nimport Mapping from './component/Mapping';\nimport Option from './element/specials/Option';\nimport Partial from './Partial';\nimport Section from './Section';\nimport Select from './element/specials/Select';\nimport Textarea from './element/specials/Textarea';\nimport Text from './Text';\nimport Transition from './element/Transition';\nimport Triple from './Triple';\nimport getComponentConstructor from './component/getComponentConstructor';\nimport findElement from './shared/findElement';\nimport { findInstance } from 'shared/registry';\nimport asyncProxy from './asyncProxy';\nimport { isString, isFunction } from 'utils/is';\n\nconst constructors = {};\nconstructors[ALIAS] = Alias;\nconstructors[ANCHOR] = Component;\nconstructors[DOCTYPE] = Doctype;\nconstructors[INTERPOLATOR] = Interpolator;\nconstructors[PARTIAL] = Partial;\nconstructors[SECTION] = Section;\nconstructors[TRIPLE] = Triple;\nconstructors[YIELDER] = Partial;\n\nconstructors[ATTRIBUTE] = Attribute;\nconstructors[BINDING_FLAG] = BindingFlag;\nconstructors[DECORATOR] = Decorator;\nconstructors[EVENT] = EventDirective;\nconstructors[TRANSITION] = Transition;\nconstructors[COMMENT] = Comment;\n\nconst specialElements = {\n  doctype: Doctype,\n  form: Form,\n  input: Input,\n  option: Option,\n  select: Select,\n  textarea: Textarea\n};\n\nexport default function createItem(options) {\n  if (isString(options.template)) {\n    return new Text(options);\n  }\n\n  let ctor;\n  let name;\n  const type = options.template.t;\n\n  if (type === ELEMENT) {\n    name = options.template.e;\n\n    // could be a macro partial\n    ctor = findInstance('partials', options.up.ractive, name);\n    if (ctor) {\n      ctor = ctor.partials[name];\n      if (ctor.styleSet) {\n        options.macro = ctor;\n        return new Partial(options);\n      }\n    }\n\n    // could be component or element\n    ctor = getComponentConstructor(options.up.ractive, name);\n    if (ctor) {\n      if (isFunction(ctor.then)) {\n        return asyncProxy(ctor, options);\n      } else {\n        return new Component(options, ctor);\n      }\n    }\n\n    ctor = specialElements[name.toLowerCase()] || Element;\n    return new ctor(options);\n  }\n\n  let Item;\n\n  // component mappings are a special case of attribute\n  if (type === ATTRIBUTE) {\n    let el = options.owner;\n    if (!el || (el.type !== ANCHOR && el.type !== COMPONENT && el.type !== ELEMENT)) {\n      el = findElement(options.up);\n    }\n    options.element = el;\n\n    Item = el.type === COMPONENT || el.type === ANCHOR ? Mapping : Attribute;\n  } else {\n    Item = constructors[type];\n  }\n\n  if (!Item) throw new Error(`Unrecognised item type ${type}`);\n\n  return new Item(options);\n}\n","import { ELEMENT, YIELDER } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport { findMap } from 'utils/array';\nimport { getContext, findParentWithContext } from 'shared/getRactiveContext';\nimport {\n  bind,\n  destroyed,\n  shuffled,\n  toEscapedString,\n  toString,\n  unbind,\n  unrender,\n  update\n} from 'shared/methodCallers';\nimport createItem from './items/createItem';\nimport processItems from './helpers/processItems';\nimport parseJSON from 'utils/parseJSON';\nimport { createDocumentFragment } from 'utils/dom';\n\nfunction unrenderAndDestroy(item) {\n  item.unrender(true);\n}\n\nexport default class Fragment {\n  constructor(options) {\n    this.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n    this.isRoot = !options.owner.up;\n    this.parent = this.isRoot ? null : this.owner.up;\n    this.ractive = options.ractive || (this.isRoot ? options.owner : this.parent.ractive);\n\n    this.componentParent = this.isRoot && this.ractive.component ? this.ractive.component.up : null;\n    this.delegate =\n      (this.parent\n        ? this.parent.delegate\n        : this.componentParent && this.componentParent.delegate) ||\n      (this.owner.containerFragment && this.owner.containerFragment.delegate);\n\n    this.context = null;\n    this.rendered = false;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    if ('cssIds' in options) {\n      this.cssIds = options.cssIds && options.cssIds.length && options.cssIds;\n    } else {\n      this.cssIds = this.parent ? this.parent.cssIds : null;\n    }\n\n    this.dirty = false;\n    this.dirtyValue = true; // used for attribute values\n\n    this.template = options.template || [];\n    this.createItems();\n  }\n\n  bind(context) {\n    this.context = context;\n    this.items.forEach(bind);\n    this.bound = true;\n\n    // in rare cases, a forced resolution (or similar) will cause the\n    // fragment to be dirty before it's even finished binding. In those\n    // cases we update immediately\n    if (this.dirty) this.update();\n\n    return this;\n  }\n\n  bubble() {\n    this.dirtyValue = true;\n\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.isRoot) {\n        // TODO encapsulate 'is component root, but not overall root' check?\n        if (this.ractive.component) {\n          this.ractive.component.bubble();\n        } else if (this.bound) {\n          runloop.addFragment(this);\n        }\n      } else {\n        this.owner.bubble(this.index);\n      }\n    }\n  }\n\n  createItems() {\n    // this is a hot code path\n    const max = this.template.length;\n    this.items = [];\n    for (let i = 0; i < max; i++) {\n      this.items[i] = createItem({\n        up: this,\n        template: this.template[i],\n        index: i\n      });\n    }\n  }\n\n  destroyed() {\n    this.items.forEach(destroyed);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      docFrag.appendChild(xs[i].detach());\n    }\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.items, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAll && i.findAll(selector, options));\n    }\n  }\n\n  findComponent(name, options) {\n    return findMap(this.items, i => i.findComponent(name, options));\n  }\n\n  findAllComponents(name, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAllComponents && i.findAllComponents(name, options));\n    }\n  }\n\n  findContext() {\n    const base = findParentWithContext(this);\n    if (!base || !base.context) return this.ractive.viewmodel;\n    else return base.context;\n  }\n\n  findNextNode(item) {\n    // search for the next node going forward\n    if (item) {\n      let it;\n      for (let i = item.index + 1; i < this.items.length; i++) {\n        it = this.items[i];\n        if (!it || !it.firstNode) continue;\n\n        const node = it.firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    // if this is the root fragment, and there are no more items,\n    // it means we're at the end...\n    if (this.isRoot) {\n      if (this.ractive.component) {\n        return this.ractive.component.up.findNextNode(this.ractive.component);\n      }\n\n      // TODO possible edge case with other content\n      // appended to this.ractive.el?\n      return null;\n    }\n\n    if (this.parent) return this.owner.findNextNode(this); // the argument is in case the parent is a RepeatedFragment\n  }\n\n  findParentNode() {\n    let fragment = this;\n\n    do {\n      if (fragment.owner.type === ELEMENT) {\n        return fragment.owner.node;\n      }\n\n      if (fragment.isRoot && !fragment.ractive.component) {\n        // TODO encapsulate check\n        return fragment.ractive.el;\n      }\n\n      if (fragment.owner.type === YIELDER) {\n        fragment = fragment.owner.containerFragment;\n      } else {\n        fragment = fragment.componentParent || fragment.parent; // TODO ugh\n      }\n    } while (fragment);\n\n    throw new Error('Could not find parent node'); // TODO link to issue tracker\n  }\n\n  findRepeatingFragment() {\n    let fragment = this;\n    // TODO better check than fragment.parent.iterations\n    while ((fragment.parent || fragment.componentParent) && !fragment.isIteration) {\n      fragment = fragment.parent || fragment.componentParent;\n    }\n\n    return fragment;\n  }\n\n  firstNode(skipParent) {\n    const node = findMap(this.items, i => i.firstNode(true));\n    if (node) return node;\n    if (skipParent) return null;\n\n    return this.parent.findNextNode(this.owner);\n  }\n\n  rebind(next) {\n    this.context = next;\n  }\n\n  render(target, occupants) {\n    if (this.rendered) throw new Error('Fragment is already rendered!');\n    this.rendered = true;\n\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      xs[i].render(target, occupants);\n    }\n  }\n\n  resetTemplate(template) {\n    const wasBound = this.bound;\n    const wasRendered = this.rendered;\n\n    // TODO ensure transitions are disabled globally during reset\n\n    if (wasBound) {\n      if (wasRendered) this.unrender(true);\n      this.unbind();\n    }\n\n    this.template = template;\n    this.createItems();\n\n    if (wasBound) {\n      this.bind(this.context);\n\n      if (wasRendered) {\n        const parentNode = this.findParentNode();\n        const anchor = this.findNextNode();\n\n        if (anchor) {\n          const docFrag = createDocumentFragment();\n          this.render(docFrag);\n          parentNode.insertBefore(docFrag, anchor);\n        } else {\n          this.render(parentNode);\n        }\n      }\n    }\n  }\n\n  shuffled() {\n    this.items.forEach(shuffled);\n  }\n\n  toString(escape) {\n    return this.items.map(escape ? toEscapedString : toString).join('');\n  }\n\n  unbind() {\n    this.context = null;\n    this.items.forEach(unbind);\n    this.bound = false;\n\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    this.items.forEach(shouldDestroy ? unrenderAndDestroy : unrender);\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      if (!this.updating) {\n        this.dirty = false;\n        this.updating = true;\n        this.items.forEach(update);\n        this.updating = false;\n      } else if (this.isRoot) {\n        runloop.addFragmentToRoot(this);\n      }\n    }\n  }\n\n  valueOf() {\n    if (this.items.length === 1) {\n      return this.items[0].valueOf();\n    }\n\n    if (this.dirtyValue) {\n      const values = {};\n      const source = processItems(this.items, values, this.ractive._guid);\n      const parsed = parseJSON(source, values);\n\n      this.value = parsed ? parsed.value : this.toString();\n\n      this.dirtyValue = false;\n    }\n\n    return this.value;\n  }\n}\nFragment.prototype.getContext = getContext;\n","import Hook from './Hook';\n\nfunction getChildQueue(queue, ractive) {\n  return queue[ractive._guid] || (queue[ractive._guid] = []);\n}\n\nfunction fire(hookQueue, ractive) {\n  const childQueue = getChildQueue(hookQueue.queue, ractive);\n\n  hookQueue.hook.fire(ractive);\n\n  // queue is \"live\" because components can end up being\n  // added while hooks fire on parents that modify data values.\n  while (childQueue.length) {\n    fire(hookQueue, childQueue.shift());\n  }\n\n  delete hookQueue.queue[ractive._guid];\n}\n\nexport default class HookQueue {\n  constructor(event) {\n    this.hook = new Hook(event);\n    this.inProcess = {};\n    this.queue = {};\n  }\n\n  begin(ractive) {\n    this.inProcess[ractive._guid] = true;\n  }\n\n  end(ractive) {\n    const parent = ractive.parent;\n\n    // If this is *isn't* a child of a component that's in process,\n    // it should call methods or fire at this point\n    if (!parent || !this.inProcess[parent._guid]) {\n      fire(this, ractive);\n    } else {\n      // elsewise, handoff to parent to fire when ready\n      getChildQueue(this.queue, parent).push(ractive);\n    }\n\n    delete this.inProcess[ractive._guid];\n  }\n}\n","import { logIfDebug, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport config from './config/config';\nimport Fragment from 'src/view/Fragment';\nimport Hook from 'src/events/Hook';\nimport HookQueue from 'src/events/HookQueue';\nimport Ractive from '../Ractive';\nimport subscribe from './helpers/subscribe';\nimport { hasOwn, keys } from 'utils/object';\n\nconst configHook = new Hook('config');\nconst initHook = new HookQueue('init');\n\nexport default function initialise(ractive, userOptions, options) {\n  keys(ractive.viewmodel.computations).forEach(key => {\n    const computation = ractive.viewmodel.computations[key];\n\n    if (hasOwn(ractive.viewmodel.value, key)) {\n      computation.set(ractive.viewmodel.value[key]);\n    }\n  });\n\n  // init config from Parent and options\n  config.init(ractive.constructor, ractive, userOptions);\n\n  configHook.fire(ractive);\n\n  initHook.begin(ractive);\n\n  const fragment = (ractive.fragment = createFragment(ractive, options));\n  if (fragment) fragment.bind(ractive.viewmodel);\n\n  initHook.end(ractive);\n\n  // general config done, set up observers\n  subscribe(ractive, userOptions, 'observe');\n\n  if (fragment) {\n    // render automatically ( if `el` is specified )\n    const el = getElement(ractive.el || ractive.target);\n    if (el) {\n      const promise = ractive.render(el, ractive.append);\n\n      if (Ractive.DEBUG_PROMISES) {\n        promise.catch(err => {\n          warnOnceIfDebug(\n            'Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;'\n          );\n          warnIfDebug('An error happened during rendering', { ractive });\n          logIfDebug(err);\n\n          throw err;\n        });\n      }\n    }\n  }\n}\n\nexport function createFragment(ractive, options = {}) {\n  if (ractive.template) {\n    const cssIds = [].concat(ractive.constructor._cssIds || [], options.cssIds || []);\n\n    return new Fragment({\n      owner: ractive,\n      template: ractive.template,\n      cssIds\n    });\n  }\n}\n","import { doc } from 'config/environment';\nimport { applyCSS } from 'src/global/css';\nimport Hook from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport { createFragment } from './initialise';\n\nconst renderHook = new Hook('render');\nconst completeHook = new Hook('complete');\n\nexport default function render(ractive, target, anchor, occupants) {\n  // set a flag to let any transitions know that this instance is currently rendering\n  ractive.rendering = true;\n\n  const promise = runloop.start();\n  runloop.scheduleTask(() => renderHook.fire(ractive), true);\n\n  if (ractive.fragment.rendered) {\n    throw new Error(\n      'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first'\n    );\n  }\n\n  if (ractive.destroyed) {\n    ractive.destroyed = false;\n    ractive.fragment = createFragment(ractive).bind(ractive.viewmodel);\n  }\n\n  anchor = getElement(anchor) || ractive.anchor;\n\n  ractive.el = ractive.target = target;\n  ractive.anchor = anchor;\n\n  // ensure encapsulated CSS is up-to-date\n  if (ractive.cssId) applyCSS();\n\n  if (target) {\n    (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(ractive);\n\n    if (anchor) {\n      const docFrag = doc.createDocumentFragment();\n      ractive.fragment.render(docFrag);\n      target.insertBefore(docFrag, anchor);\n    } else {\n      ractive.fragment.render(target, occupants);\n    }\n  }\n\n  runloop.end();\n  ractive.rendering = false;\n\n  return promise.then(() => {\n    if (ractive.torndown) return;\n\n    completeHook.fire(ractive);\n  });\n}\n","import runloop from 'src/global/runloop';\nimport config from '../config/config';\nimport Hook from '../../events/Hook';\nimport dataConfigurator from '../config/custom/data';\nimport { isObjectType } from 'utils/is';\n\nconst shouldRerender = ['template', 'partials', 'components', 'decorators', 'events'];\n\nconst completeHook = new Hook('complete');\nconst resetHook = new Hook('reset');\nconst renderHook = new Hook('render');\nconst unrenderHook = new Hook('unrender');\n\nexport default function Ractive$reset(data) {\n  data = data || {};\n\n  if (!isObjectType(data)) {\n    throw new Error('The reset method takes either no arguments, or an object containing new data');\n  }\n\n  // TEMP need to tidy this up\n  data = dataConfigurator.init(this.constructor, this, { data });\n\n  const promise = runloop.start();\n\n  // If the root object is wrapped, try and use the wrapper's reset value\n  const wrapper = this.viewmodel.wrapper;\n  if (wrapper && wrapper.reset) {\n    if (wrapper.reset(data) === false) {\n      // reset was rejected, we need to replace the object\n      this.viewmodel.set(data);\n    }\n  } else {\n    this.viewmodel.set(data);\n  }\n\n  // reset config items and track if need to rerender\n  const changes = config.reset(this);\n  let rerender;\n\n  let i = changes.length;\n  while (i--) {\n    if (shouldRerender.indexOf(changes[i]) > -1) {\n      rerender = true;\n      break;\n    }\n  }\n\n  if (rerender) {\n    unrenderHook.fire(this);\n    this.fragment.resetTemplate(this.template);\n    renderHook.fire(this);\n    completeHook.fire(this);\n  }\n\n  runloop.end();\n\n  resetHook.fire(this, data);\n\n  return promise;\n}\n","import runloop from 'src/global/runloop';\nimport { PARTIAL, COMPONENT, ELEMENT } from 'config/types';\nimport { isArray } from 'utils/is';\nimport { handleChange } from 'shared/methodCallers';\n\nfunction collect(source, name, attr, dest) {\n  source.forEach(item => {\n    // queue to rerender if the item is a partial and the current name matches\n    if (item.type === PARTIAL && (item.refName === name || item.name === name)) {\n      item.inAttribute = attr;\n      dest.push(item);\n      return; // go no further\n    }\n\n    // if it has a fragment, process its items\n    if (item.fragment) {\n      collect(item.fragment.iterations || item.fragment.items, name, attr, dest);\n    } else if (isArray(item.items)) {\n      // or if it is itself a fragment, process its items\n      collect(item.items, name, attr, dest);\n    } else if (item.type === COMPONENT && item.instance) {\n      // or if it is a component, step in and process its items\n      // ...unless the partial is shadowed\n      if (item.instance.partials[name]) return;\n      collect(item.instance.fragment.items, name, attr, dest);\n    }\n\n    // if the item is an element, process its attributes too\n    if (item.type === ELEMENT) {\n      if (isArray(item.attributes)) {\n        collect(item.attributes, name, true, dest);\n      }\n    }\n  });\n}\n\nexport default function(name, partial) {\n  const collection = [];\n  collect(this.fragment.items, name, false, collection);\n\n  const promise = runloop.start();\n\n  this.partials[name] = partial;\n  collection.forEach(handleChange);\n\n  runloop.end();\n\n  return promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('reverse').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('shift').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('sort').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('splice').path;\n","import Hook from 'src/events/Hook';\nimport { warnIfDebug } from 'utils/log';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\n\nconst unrenderHook = new Hook('unrender');\n\nexport default function Ractive$unrender() {\n  if (!this.fragment.rendered) {\n    warnIfDebug('ractive.unrender() was called on a Ractive instance that was not rendered');\n    return Promise.resolve();\n  }\n\n  this.unrendering = true;\n  const promise = runloop.start();\n\n  // If this is a component, and the component isn't marked for destruction,\n  // don't detach nodes from the DOM unnecessarily\n  const shouldDestroy =\n    !this.component ||\n    (this.component.anchor || {}).shouldDestroy ||\n    this.component.shouldDestroy ||\n    this.shouldDestroy;\n  this.fragment.unrender(shouldDestroy);\n  if (shouldDestroy) this.destroyed = true;\n\n  removeFromArray(this.el.__ractive_instances__, this);\n\n  unrenderHook.fire(this);\n\n  runloop.end();\n  this.unrendering = false;\n\n  return promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('unshift').path;\n","import add from './prototype/add';\nimport animate from './prototype/animate';\nimport attachChild from './prototype/attachChild';\nimport detach from './prototype/detach';\nimport detachChild from './prototype/detachChild';\nimport find from './prototype/find';\nimport findAll from './prototype/findAll';\nimport findAllComponents from './prototype/findAllComponents';\nimport findComponent from './prototype/findComponent';\nimport findContainer from './prototype/findContainer';\nimport findParent from './prototype/findParent';\nimport fire from './prototype/fire';\nimport get from './prototype/get';\nimport getContext, { getNodeInfo } from './prototype/getContext';\nimport insert from './prototype/insert';\nimport link from './prototype/link';\nimport observe from './prototype/observe';\nimport observeOnce from './prototype/observeOnce';\nimport off from './prototype/off';\nimport on from './prototype/on';\nimport once from './prototype/once';\nimport pop from './prototype/pop';\nimport push from './prototype/push';\nimport readLink from './prototype/readLink';\nimport render from './prototype/render';\nimport reset from './prototype/reset';\nimport resetPartial from './prototype/resetPartial';\nimport resetTemplate from './prototype/resetTemplate';\nimport reverse from './prototype/reverse';\nimport set from './prototype/set';\nimport shift from './prototype/shift';\nimport sort from './prototype/sort';\nimport splice from './prototype/splice';\nimport subtract from './prototype/subtract';\nimport teardown from './prototype/teardown';\nimport toggle from './prototype/toggle';\nimport toCSS from './prototype/toCSS';\nimport toHTML from './prototype/toHTML';\nimport toText from './prototype/toText';\nimport transition from './prototype/transition';\nimport unlink from './prototype/unlink';\nimport unrender from './prototype/unrender';\nimport unshift from './prototype/unshift';\nimport update from './prototype/update';\nimport updateModel from './prototype/updateModel';\n\nimport { defineProperty } from 'utils/object';\n\nconst proto = {\n  add,\n  animate,\n  attachChild,\n  detach,\n  detachChild,\n  find,\n  findAll,\n  findAllComponents,\n  findComponent,\n  findContainer,\n  findParent,\n  fire,\n  get,\n  getContext,\n  getNodeInfo,\n  insert,\n  link,\n  observe,\n  observeOnce,\n  off,\n  on,\n  once,\n  pop,\n  push,\n  readLink,\n  render,\n  reset,\n  resetPartial,\n  resetTemplate,\n  reverse,\n  set,\n  shift,\n  sort,\n  splice,\n  subtract,\n  teardown,\n  toggle,\n  toCSS,\n  toCss: toCSS,\n  toHTML,\n  toHtml: toHTML,\n  toText,\n  transition,\n  unlink,\n  unrender,\n  unshift,\n  update,\n  updateModel\n};\n\ndefineProperty(proto, 'target', {\n  get() {\n    return this.el;\n  }\n});\n\nexport default proto;\n","import config from '../Ractive/config/config';\nimport dataConfigurator from '../Ractive/config/custom/data';\nimport construct from '../Ractive/construct';\nimport initialise from '../Ractive/initialise';\nimport Ractive from '../Ractive';\nimport isInstance from '../Ractive/static/isInstance';\nimport styleSet from '../Ractive/static/styleSet';\nimport styleGet from '../Ractive/static/styleGet';\nimport sharedSet from '../Ractive/static/sharedSet';\nimport sharedGet from '../Ractive/static/sharedGet';\nimport { assign, create, defineProperties, toPairs } from 'utils/object';\nimport { isArray, isFunction } from 'utils/is';\n\nconst callsSuper = /super\\s*\\(|\\.call\\s*\\(\\s*this/;\n\nexport function extend(...options) {\n  if (!options.length) {\n    return extendOne(this);\n  } else {\n    return options.reduce(extendOne, this);\n  }\n}\n\nexport function extendWith(Class, options = {}) {\n  return extendOne(this, options, Class);\n}\n\nfunction extendOne(Parent, options = {}, Target) {\n  let proto;\n  let Child = isFunction(Target) && Target;\n\n  if (options.prototype instanceof Ractive) {\n    throw new Error(`Ractive no longer supports multiple inheritance.`);\n  }\n\n  if (Child) {\n    if (!(Child.prototype instanceof Parent)) {\n      throw new Error(\n        `Only classes that inherit the appropriate prototype may be used with extend`\n      );\n    }\n    if (!callsSuper.test(Child.toString())) {\n      throw new Error(`Only classes that call super in their constructor may be used with extend`);\n    }\n\n    proto = Child.prototype;\n  } else {\n    Child = function(options) {\n      if (!(this instanceof Child)) return new Child(options);\n\n      construct(this, options || {});\n      initialise(this, options || {}, {});\n    };\n\n    proto = create(Parent.prototype);\n    proto.constructor = Child;\n\n    Child.prototype = proto;\n  }\n\n  // Static properties\n  defineProperties(Child, {\n    // alias prototype as defaults\n    defaults: { value: proto },\n\n    extend: { value: extend, writable: true, configurable: true },\n    extendWith: { value: extendWith, writable: true, configurable: true },\n    extensions: { value: [] },\n\n    isInstance: { value: isInstance },\n\n    Parent: { value: Parent },\n    Ractive: { value: Ractive },\n\n    styleGet: { value: styleGet.bind(Child), configurable: true },\n    styleSet: { value: styleSet.bind(Child), configurable: true }\n  });\n\n  // extend configuration\n  config.extend(Parent, proto, options, Child);\n\n  // store event and observer registries on the constructor when extending\n  Child._on = (Parent._on || []).concat(toPairs(options.on));\n  Child._observe = (Parent._observe || []).concat(toPairs(options.observe));\n\n  Parent.extensions.push(Child);\n\n  // attribute defs are not inherited, but they need to be stored\n  if (options.attributes) {\n    let attrs;\n\n    // allow an array of optional props or an object with arrays for optional and required props\n    if (isArray(options.attributes)) {\n      attrs = { optional: options.attributes, required: [] };\n    } else {\n      attrs = options.attributes;\n    }\n\n    // make sure the requisite keys actually store arrays\n    if (!isArray(attrs.required)) attrs.required = [];\n    if (!isArray(attrs.optional)) attrs.optional = [];\n\n    Child.attributes = attrs;\n  }\n\n  dataConfigurator.extend(Parent, proto, options, Child);\n\n  if (options.computed) {\n    proto.computed = assign(create(Parent.prototype.computed), options.computed);\n  }\n\n  return Child;\n}\n\ndefineProperties(Ractive, {\n  sharedGet: { value: sharedGet },\n  sharedSet: { value: sharedSet },\n  styleGet: { configurable: true, value: styleGet.bind(Ractive) },\n  styleSet: { configurable: true, value: styleSet.bind(Ractive) }\n});\n","import './polyfills/Object.assign';\nimport './polyfills/array.find';\nimport './polyfills/node.contains';\nimport './polyfills/performance.now';\nimport './polyfills/Promise';\nimport './polyfills/requestAnimationFrame';\n\nimport defaults from './Ractive/config/defaults';\nimport easing from './Ractive/static/easing';\nimport interpolators from './Ractive/static/interpolators';\nimport { svg, win } from './config/environment';\nimport proto from './Ractive/prototype';\nimport { extend, extendWith } from './extend/_extend';\nimport macro from './extend/_macro';\nimport parse from './parse/_parse';\nimport getContext, { getNodeInfo } from './Ractive/static/getContext';\nimport isInstance from './Ractive/static/isInstance';\nimport construct from './Ractive/construct';\nimport initialise from './Ractive/initialise';\nimport { getCSS } from './global/css';\nimport { escapeKey, unescapeKey, normalise } from './shared/keypaths';\nimport { joinKeys, splitKeypath } from './Ractive/static/keypaths';\nimport shared from './Ractive/shared';\nimport { findPlugin } from './Ractive/static/findPlugin';\nimport parseJSON from './utils/parseJSON';\nimport CSSModel from './model/specials/CSSModel';\nimport { data as sharedData } from './model/specials/SharedModel';\nimport { extern } from './shared/getRactiveContext';\nimport { warn } from 'utils/log';\n\nimport { assign, defineProperty, defineProperties } from 'utils/object';\n\nexport default function Ractive(options) {\n  if (!(this instanceof Ractive)) return new Ractive(options);\n\n  construct(this, options || {});\n  initialise(this, options || {}, {});\n}\n\n// check to see if we're being asked to force Ractive as a global for some weird environments\nif (win && !win.Ractive) {\n  let opts = '';\n  const script =\n    document.currentScript ||\n    /* istanbul ignore next */ document.querySelector('script[data-ractive-options]');\n\n  if (script) opts = script.getAttribute('data-ractive-options') || '';\n\n  /* istanbul ignore next */\n  if (~opts.indexOf('ForceGlobal')) win.Ractive = Ractive;\n} else if (win) {\n  warn(`Ractive already appears to be loaded while loading BUILD_PLACEHOLDER_VERSION.`);\n}\n\nassign(Ractive.prototype, proto, defaults);\nRactive.prototype.constructor = Ractive;\n\n// alias prototype as `defaults`\nRactive.defaults = Ractive.prototype;\n\n// share defaults with the parser\nshared.defaults = Ractive.defaults;\nshared.Ractive = Ractive;\n\n// static properties\ndefineProperties(Ractive, {\n  // debug flag\n  DEBUG: { writable: true, value: true },\n  DEBUG_PROMISES: { writable: true, value: true },\n\n  // static methods:\n  extend: { value: extend },\n  extendWith: { value: extendWith },\n  escapeKey: { value: escapeKey },\n  evalObjectString: { value: parseJSON },\n  findPlugin: { value: findPlugin },\n  getContext: { value: getContext },\n  getCSS: { value: getCSS },\n  getNodeInfo: { value: getNodeInfo },\n  isInstance: { value: isInstance },\n  joinKeys: { value: joinKeys },\n  macro: { value: macro },\n  normaliseKeypath: { value: normalise },\n  parse: { value: parse },\n  splitKeypath: { value: splitKeypath },\n  // sharedSet and styleSet are in _extend because circular refs\n  unescapeKey: { value: unescapeKey },\n\n  // support\n  enhance: { writable: true, value: false },\n  svg: { value: svg },\n\n  // version\n  VERSION: { value: 'BUILD_PLACEHOLDER_VERSION' },\n\n  // plugins\n  adaptors: { writable: true, value: {} },\n  components: { writable: true, value: {} },\n  decorators: { writable: true, value: {} },\n  easing: { writable: true, value: easing },\n  events: { writable: true, value: {} },\n  extensions: { value: [] },\n  interpolators: { writable: true, value: interpolators },\n  partials: { writable: true, value: {} },\n  transitions: { writable: true, value: {} },\n\n  // CSS variables\n  cssData: { configurable: true, value: {} },\n\n  // access to @shared without an instance\n  sharedData: { value: sharedData },\n\n  // for getting the source Ractive lib from a constructor\n  Ractive: { value: Ractive },\n\n  // to allow extending contexts\n  Context: { value: extern.Context.prototype }\n});\n\ndefineProperty(Ractive, '_cssModel', {\n  configurable: true,\n  value: new CSSModel(Ractive)\n});\n","import runloop from 'src/global/runloop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport noop from 'utils/noop';\nimport findElement from '../../shared/findElement';\n\nexport default class Binding {\n  constructor(element, name = 'value') {\n    this.element = element;\n    this.ractive = element.ractive;\n    this.attribute = element.attributeByName[name];\n\n    const interpolator = this.attribute.interpolator;\n    interpolator.twowayBinding = this;\n\n    const model = interpolator.model;\n\n    if (model.isReadonly && !model.setRoot) {\n      const keypath = model.getKeypath().replace(/^@/, '');\n      warnOnceIfDebug(\n        `Cannot use two-way binding on <${\n          element.name\n        }> element: ${keypath} is read-only. To suppress this warning use <${\n          element.name\n        } twoway='false'...>`,\n        { ractive: this.ractive }\n      );\n      return false;\n    }\n\n    this.attribute.isTwoway = true;\n    this.model = model;\n\n    // initialise value, if it's undefined\n    let value = model.get();\n    this.wasUndefined = value === undefined;\n\n    if (value === undefined && this.getInitialValue) {\n      value = this.getInitialValue();\n      model.set(value);\n    }\n    this.lastVal(true, value);\n\n    const parentForm = findElement(this.element, false, 'form');\n    if (parentForm) {\n      this.resetValue = value;\n      parentForm.formBindings.push(this);\n    }\n  }\n\n  bind() {\n    this.model.registerTwowayBinding(this);\n  }\n\n  handleChange() {\n    const value = this.getValue();\n    if (this.lastVal() === value) return;\n\n    runloop.start();\n    this.attribute.locked = true;\n    this.model.set(value);\n    this.lastVal(true, value);\n\n    // if the value changes before observers fire, unlock to be updatable cause something weird and potentially freezy is up\n    if (this.model.get() !== value) this.attribute.locked = false;\n    else runloop.scheduleTask(() => (this.attribute.locked = false));\n\n    runloop.end();\n  }\n\n  lastVal(setting, value) {\n    if (setting) this.lastValue = value;\n    else return this.lastValue;\n  }\n\n  rebind(next, previous) {\n    if (this.model && this.model === previous) previous.unregisterTwowayBinding(this);\n    if (next) {\n      this.model = next;\n      runloop.scheduleTask(() => next.registerTwowayBinding(this));\n    }\n  }\n\n  render() {\n    this.node = this.element.node;\n    this.node._ractive.binding = this;\n    this.rendered = true; // TODO is this used anywhere?\n  }\n\n  setFromNode(node) {\n    this.model.set(node.value);\n  }\n\n  unbind() {\n    this.model.unregisterTwowayBinding(this);\n  }\n}\n\nBinding.prototype.unrender = noop;\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class CheckboxBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n    this.element.off('click', handleDomEvent);\n  }\n\n  getInitialValue() {\n    return !!this.element.getAttribute('checked');\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\n\nexport default function getBindingGroup(group, model, getValue) {\n  const hash = `${group}-bindingGroup`;\n  return model[hash] || (model[hash] = new BindingGroup(hash, model, getValue));\n}\n\nclass BindingGroup {\n  constructor(hash, model, getValue) {\n    this.model = model;\n    this.hash = hash;\n    this.getValue = () => {\n      this.value = getValue.call(this);\n      return this.value;\n    };\n\n    this.bindings = [];\n  }\n\n  add(binding) {\n    this.bindings.push(binding);\n  }\n\n  bind() {\n    this.value = this.model.get();\n    this.model.registerTwowayBinding(this);\n    this.bound = true;\n  }\n\n  remove(binding) {\n    removeFromArray(this.bindings, binding);\n    if (!this.bindings.length) {\n      this.unbind();\n    }\n  }\n\n  unbind() {\n    this.model.unregisterTwowayBinding(this);\n    this.bound = false;\n    delete this.model[this.hash];\n  }\n}\n\nBindingGroup.prototype.rebind = Binding.prototype.rebind;\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\nimport { isArray } from 'utils/is';\n\nconst push = [].push;\n\nfunction getValue() {\n  const all = this.bindings\n    .filter(b => b.node && b.node.checked)\n    .map(b => b.element.getAttribute('value'));\n  const res = [];\n  all.forEach(v => {\n    if (!this.bindings[0].arrayContains(res, v)) res.push(v);\n  });\n  return res;\n}\n\nexport default class CheckboxNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n    // Each input has a reference to an array containing it and its\n    // group, as two-way binding depends on being able to ascertain\n    // the status of all inputs within the group\n    this.group = getBindingGroup('checkboxes', this.model, getValue);\n    this.group.add(this);\n\n    if (this.noInitialValue) {\n      this.group.noInitialValue = true;\n    }\n\n    // If no initial value was set, and this input is checked, we\n    // update the model\n    if (this.group.noInitialValue && this.element.getAttribute('checked')) {\n      const existingValue = this.model.get();\n      const bindingValue = this.element.getAttribute('value');\n\n      if (!this.arrayContains(existingValue, bindingValue)) {\n        push.call(existingValue, bindingValue); // to avoid triggering runloop with array adaptor\n      }\n    }\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n  }\n\n  getInitialValue() {\n    // This only gets called once per group (of inputs that\n    // share a name), because it only gets called if there\n    // isn't an initial value. By the same token, we can make\n    // a note of that fact that there was no initial value,\n    // and populate it using any `checked` attributes that\n    // exist (which users should avoid, but which we should\n    // support anyway to avoid breaking expectations)\n    this.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\n    return [];\n  }\n\n  getValue() {\n    return this.group.value;\n  }\n\n  handleChange() {\n    this.isChecked = this.element.node.checked;\n    this.group.value = this.model.get();\n    const value = this.element.getAttribute('value');\n    if (this.isChecked && !this.arrayContains(this.group.value, value)) {\n      this.group.value.push(value);\n    } else if (!this.isChecked && this.arrayContains(this.group.value, value)) {\n      this.removeFromArray(this.group.value, value);\n    }\n    // make sure super knows there's a change\n    this.lastValue = null;\n    super.handleChange();\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    const existingValue = this.model.get();\n    const bindingValue = this.element.getAttribute('value');\n\n    if (isArray(existingValue)) {\n      this.isChecked = this.arrayContains(existingValue, bindingValue);\n    } else {\n      this.isChecked = this.element.compare(existingValue, bindingValue);\n    }\n    node.name = '{{' + this.model.getKeypath() + '}}';\n    node.checked = this.isChecked;\n\n    this.element.on('change', handleDomEvent);\n\n    // in case of IE emergency, bind to click event as well\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.group.bindings.forEach(binding => (binding.wasUndefined = true));\n\n    if (node.checked) {\n      const valueSoFar = this.group.getValue();\n      valueSoFar.push(this.element.getAttribute('value'));\n\n      this.group.model.set(valueSoFar);\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n    el.off('click', handleDomEvent);\n  }\n\n  arrayContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.element.compare(optionValue, selectValue[i])) return true;\n    }\n    return false;\n  }\n\n  removeFromArray(array, item) {\n    if (!array) return;\n    let i = array.length;\n    while (i--) {\n      if (this.element.compare(item, array[i])) {\n        array.splice(i, 1);\n      }\n    }\n  }\n}\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class ContentEditableBinding extends Binding {\n  getInitialValue() {\n    return this.element.fragment ? this.element.fragment.toString() : '';\n  }\n\n  getValue() {\n    return this.element.node.innerHTML;\n  }\n\n  render() {\n    super.render();\n\n    const el = this.element;\n\n    el.on('change', handleDomEvent);\n    el.on('blur', handleDomEvent);\n\n    if (!this.ractive.lazy) {\n      el.on('input', handleDomEvent);\n\n      if (this.node.attachEvent) {\n        el.on('keyup', handleDomEvent);\n      }\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.innerHTML);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('blur', handleDomEvent);\n    el.off('change', handleDomEvent);\n    el.off('input', handleDomEvent);\n    el.off('keyup', handleDomEvent);\n  }\n}\n","import { isNumeric } from 'utils/is';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nfunction handleBlur() {\n  handleDomEvent.call(this);\n\n  const value = this._ractive.binding.model.get();\n  this.value = value == undefined ? '' : value;\n}\n\nfunction handleDelay(delay) {\n  let timeout;\n\n  return function() {\n    if (timeout) clearTimeout(timeout);\n\n    timeout = setTimeout(() => {\n      const binding = this._ractive.binding;\n      if (binding.rendered) handleDomEvent.call(this);\n      timeout = null;\n    }, delay);\n  };\n}\n\nexport default class GenericBinding extends Binding {\n  getInitialValue() {\n    return '';\n  }\n\n  getValue() {\n    return this.node.value;\n  }\n\n  render() {\n    super.render();\n\n    // any lazy setting for this element overrides the root\n    // if the value is a number, it's a timeout\n    let lazy = this.ractive.lazy;\n    let timeout = false;\n    const el = this.element;\n\n    if ('lazy' in this.element) {\n      lazy = this.element.lazy;\n    }\n\n    if (isNumeric(lazy)) {\n      timeout = +lazy;\n      lazy = false;\n    }\n\n    this.handler = timeout ? handleDelay(timeout) : handleDomEvent;\n\n    const node = this.node;\n\n    el.on('change', handleDomEvent);\n\n    if (node.type !== 'file') {\n      if (!lazy) {\n        el.on('input', this.handler);\n\n        // IE is a special snowflake\n        if (node.attachEvent) {\n          el.on('keyup', this.handler);\n        }\n      }\n\n      el.on('blur', handleBlur);\n    }\n  }\n\n  unrender() {\n    const el = this.element;\n    this.rendered = false;\n\n    el.off('change', handleDomEvent);\n    el.off('input', this.handler);\n    el.off('keyup', this.handler);\n    el.off('blur', handleBlur);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class FileBinding extends GenericBinding {\n  getInitialValue() {\n    /* istanbul ignore next */\n    return undefined;\n  }\n\n  getValue() {\n    /* istanbul ignore next */\n    return this.node.files;\n  }\n\n  render() {\n    /* istanbul ignore next */\n    this.element.lazy = false;\n    /* istanbul ignore next */\n    super.render();\n  }\n\n  setFromNode(node) {\n    /* istanbul ignore next */\n    this.model.set(node.files);\n  }\n}\n","import { arrayContentsMatch } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class MultipleSelectBinding extends Binding {\n  getInitialValue() {\n    return this.element.options\n      .filter(option => option.getAttribute('selected'))\n      .map(option => option.getAttribute('value'));\n  }\n\n  getValue() {\n    const options = this.element.node.options;\n    const len = options.length;\n\n    const selectedValues = [];\n\n    for (let i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (option.selected) {\n        const optionValue = option._ractive ? option._ractive.value : option.value;\n        selectedValues.push(optionValue);\n      }\n    }\n\n    return selectedValues;\n  }\n\n  handleChange() {\n    const attribute = this.attribute;\n    const previousValue = attribute.getValue();\n\n    const value = this.getValue();\n\n    if (previousValue === undefined || !arrayContentsMatch(value, previousValue)) {\n      super.handleChange();\n    }\n\n    return this;\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.model.get() === undefined) {\n      // get value from DOM, if possible\n      this.handleChange();\n    }\n  }\n\n  setFromNode(node) {\n    const selectedOptions = getSelectedOptions(node);\n    let i = selectedOptions.length;\n    const result = new Array(i);\n\n    while (i--) {\n      const option = selectedOptions[i];\n      result[i] = option._ractive ? option._ractive.value : option.value;\n    }\n\n    this.model.set(result);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class NumericBinding extends GenericBinding {\n  getInitialValue() {\n    return undefined;\n  }\n\n  getValue() {\n    const value = parseFloat(this.node.value);\n    return isNaN(value) ? undefined : value;\n  }\n\n  setFromNode(node) {\n    const value = parseFloat(node.value);\n    if (!isNaN(value)) this.model.set(value);\n  }\n}\n","import runloop from 'src/global/runloop';\nimport { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nconst siblings = {};\n\nfunction getSiblings(hash) {\n  return siblings[hash] || (siblings[hash] = []);\n}\n\nexport default class RadioBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n\n    this.siblings = getSiblings(this.ractive._guid + this.element.getAttribute('name'));\n    this.siblings.push(this);\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  handleChange() {\n    runloop.start();\n\n    this.siblings.forEach(binding => {\n      binding.model.set(binding.getValue());\n    });\n\n    runloop.end();\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n\n  unbind() {\n    removeFromArray(this.siblings, this);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n    this.element.off('click', handleDomEvent);\n  }\n}\n","import noop from 'utils/noop';\nimport Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\n\nfunction getValue() {\n  const checked = this.bindings.filter(b => b.node.checked);\n  if (checked.length > 0) {\n    return checked[0].element.getAttribute('value');\n  }\n}\n\nexport default class RadioNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.group = getBindingGroup('radioname', this.model, getValue);\n    this.group.add(this);\n\n    if (element.checked) {\n      this.group.value = this.getValue();\n    }\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n\n    // update name keypath when necessary\n    this.nameAttributeBinding = {\n      handleChange: () => (this.node.name = `{{${this.model.getKeypath()}}}`),\n      rebind: noop\n    };\n\n    this.model.getKeypathModel().register(this.nameAttributeBinding);\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('checked')) {\n      return this.element.getAttribute('value');\n    }\n  }\n\n  getValue() {\n    return this.element.getAttribute('value');\n  }\n\n  handleChange() {\n    // If this <input> is the one that's checked, then the value of its\n    // `name` model gets set to its value\n    if (this.node.checked) {\n      this.group.value = this.getValue();\n      super.handleChange();\n    }\n  }\n\n  lastVal(setting, value) {\n    if (!this.group) return;\n    if (setting) this.group.lastValue = value;\n    else return this.group.lastValue;\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    node.name = `{{${this.model.getKeypath()}}}`;\n    node.checked = this.element.compare(this.model.get(), this.element.getAttribute('value'));\n\n    this.element.on('change', handleDomEvent);\n\n    if (node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    if (node.checked) {\n      this.group.model.set(this.element.getAttribute('value'));\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n\n    this.model.getKeypathModel().unregister(this.nameAttributeBinding);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n    el.off('click', handleDomEvent);\n  }\n}\n","import runloop from 'src/global/runloop';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class SingleSelectBinding extends Binding {\n  forceUpdate() {\n    const value = this.getValue();\n\n    if (value !== undefined) {\n      this.attribute.locked = true;\n      runloop.scheduleTask(() => (this.attribute.locked = false));\n      this.model.set(value);\n    }\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('value') !== undefined) {\n      return;\n    }\n\n    const options = this.element.options;\n    const len = options.length;\n\n    if (!len) return;\n\n    let value;\n    let optionWasSelected;\n    let i = len;\n\n    // take the final selected option...\n    while (i--) {\n      const option = options[i];\n\n      if (option.getAttribute('selected')) {\n        if (!option.getAttribute('disabled')) {\n          value = option.getAttribute('value');\n        }\n\n        optionWasSelected = true;\n        break;\n      }\n    }\n\n    // or the first non-disabled option, if none are selected\n    if (!optionWasSelected) {\n      while (++i < len) {\n        if (!options[i].getAttribute('disabled')) {\n          value = options[i].getAttribute('value');\n          break;\n        }\n      }\n    }\n\n    // This is an optimisation (aka hack) that allows us to forgo some\n    // other more expensive work\n    // TODO does it still work? seems at odds with new architecture\n    if (value !== undefined) {\n      this.element.attributeByName.value.value = value;\n    }\n\n    return value;\n  }\n\n  getValue() {\n    const options = this.node.options;\n    const len = options.length;\n\n    let i;\n    for (i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (options[i].selected && !options[i].disabled) {\n        return option._ractive ? option._ractive.value : option.value;\n      }\n    }\n  }\n\n  render() {\n    super.render();\n    this.element.on('change', handleDomEvent);\n  }\n\n  setFromNode(node) {\n    const option = getSelectedOptions(node)[0];\n    this.model.set(option._ractive ? option._ractive.value : option.value);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import { ATTRIBUTE, BINDING_FLAG, DECORATOR, DELEGATE_FLAG, EVENT, TRANSITION } from 'config/types';\nimport { win } from 'config/environment';\nimport { html, svg } from 'config/namespaces';\nimport { toArray, addToArray, removeFromArray } from 'utils/array';\nimport { escapeHtml, voidElementNames } from 'utils/html';\nimport { createElement, detachNode, matches, safeAttributeString } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport Context from 'shared/Context';\nimport { bind, destroyed, render, unbind, update } from 'shared/methodCallers';\nimport { ContainerItem } from './shared/Item';\nimport Fragment from '../Fragment';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport findElement from './shared/findElement';\nimport selectBinding from './element/binding/selectBinding';\nimport { assign, create, defineProperty } from 'utils/object';\n\nconst endsWithSemi = /;\\s*$/;\n\nexport default class Element extends ContainerItem {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.e.toLowerCase();\n\n    // find parent element\n    this.parent = findElement(this.up, false);\n\n    if (this.parent && this.parent.name === 'option') {\n      throw new Error(\n        `An <option> element cannot contain other elements (encountered <${this.name}>)`\n      );\n    }\n\n    this.decorators = [];\n\n    // create attributes\n    this.attributeByName = {};\n\n    let attrs;\n    let n, attr, val, cls, name, template, leftovers;\n\n    const m = this.template.m;\n    const len = (m && m.length) || 0;\n\n    for (let i = 0; i < len; i++) {\n      template = m[i];\n      switch (template.t) {\n        case ATTRIBUTE:\n        case BINDING_FLAG:\n        case DECORATOR:\n        case EVENT:\n        case TRANSITION:\n          attr = createItem({\n            owner: this,\n            up: this.up,\n            template\n          });\n\n          n = template.n;\n\n          attrs = attrs || (attrs = this.attributes = []);\n\n          if (n === 'value') val = attr;\n          else if (n === 'name') name = attr;\n          else if (n === 'class') cls = attr;\n          else attrs.push(attr);\n\n          break;\n\n        case DELEGATE_FLAG:\n          this.delegate = false;\n          break;\n\n        default:\n          (leftovers || (leftovers = [])).push(template);\n          break;\n      }\n    }\n\n    if (val) attrs.push(val);\n    if (name) attrs.push(name);\n    if (cls) attrs.unshift(cls);\n\n    if (leftovers) {\n      (attrs || (this.attributes = [])).push(\n        new ConditionalAttribute({\n          owner: this,\n          up: this.up,\n          template: leftovers\n        })\n      );\n\n      // empty leftovers array\n      leftovers = [];\n    }\n\n    // create children\n    if (options.template.f && !options.deferContent) {\n      this.fragment = new Fragment({\n        template: options.template.f,\n        owner: this,\n        cssIds: null\n      });\n    }\n\n    this.binding = null; // filled in later\n  }\n\n  bind() {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.binding = true;\n      attrs.forEach(bind);\n      attrs.binding = false;\n    }\n\n    if (this.fragment) this.fragment.bind();\n\n    // create two-way binding if necessary\n    if (!this.binding) this.recreateTwowayBinding();\n    else this.binding.bind();\n  }\n\n  createTwowayBinding() {\n    if ('twoway' in this ? this.twoway : this.ractive.twoway) {\n      const Binding = selectBinding(this);\n      if (Binding) {\n        const binding = new Binding(this);\n        if (binding && binding.model) return binding;\n      }\n    }\n  }\n\n  destroyed() {\n    if (this.attributes) this.attributes.forEach(destroyed);\n\n    if (!this.up.delegate && this.listeners) {\n      const ls = this.listeners;\n      for (const k in ls) {\n        if (ls[k] && ls[k].length) this.node.removeEventListener(k, handler);\n      }\n    }\n\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  detach() {\n    // if this element is no longer rendered, the transitions are complete and the attributes can be torn down\n    if (!this.rendered) this.destroyed();\n\n    return detachNode(this.node);\n  }\n\n  find(selector, options) {\n    if (this.node && matches(this.node, selector)) return this.node;\n    if (this.fragment) {\n      return this.fragment.find(selector, options);\n    }\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n\n    if (matches(this.node, selector)) {\n      result.push(this.node);\n    }\n\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findNextNode() {\n    return null;\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getAttribute(name) {\n    const attribute = this.attributeByName[name];\n    return attribute ? attribute.getValue() : undefined;\n  }\n\n  getContext(...assigns) {\n    if (this.fragment) return this.fragment.getContext(...assigns);\n\n    if (!this.ctx) this.ctx = new Context(this.up, this);\n    assigns.unshift(create(this.ctx));\n    return assign.apply(null, assigns);\n  }\n\n  off(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = this.listeners && this.listeners[event];\n\n    if (!ref) return;\n    removeFromArray(ref, callback);\n\n    if (delegate) {\n      const listeners =\n        (delegate.listeners || (delegate.listeners = [])) &&\n        (delegate.listeners[event] || (delegate.listeners[event] = []));\n      if (listeners.refs && !--listeners.refs) delegate.off(event, delegateHandler, true);\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        rem.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, true);\n        add.call(n, event, handler, false);\n      }\n    }\n  }\n\n  on(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = (this.listeners || (this.listeners = {}))[event] || (this.listeners[event] = []);\n\n    if (delegate) {\n      const listeners =\n        ((delegate.listeners || (delegate.listeners = [])) && delegate.listeners[event]) ||\n        (delegate.listeners[event] = []);\n      if (!listeners.refs) {\n        listeners.refs = 0;\n        delegate.on(event, delegateHandler, true);\n        listeners.refs++;\n      } else {\n        listeners.refs++;\n      }\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        add.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, false);\n        add.call(n, event, handler, true);\n      }\n    }\n\n    addToArray(this.listeners[event], callback);\n  }\n\n  recreateTwowayBinding() {\n    if (this.binding) {\n      this.binding.unbind();\n      this.binding.unrender();\n    }\n\n    if ((this.binding = this.createTwowayBinding())) {\n      this.binding.bind();\n      if (this.rendered) this.binding.render();\n    }\n  }\n\n  render(target, occupants) {\n    // TODO determine correct namespace\n    this.namespace = getNamespace(this);\n\n    let node;\n    let existing = false;\n\n    if (occupants) {\n      let n;\n      while ((n = occupants.shift())) {\n        if (\n          n.nodeName.toUpperCase() === this.template.e.toUpperCase() &&\n          n.namespaceURI === this.namespace\n        ) {\n          this.node = node = n;\n          existing = true;\n          break;\n        } else {\n          detachNode(n);\n        }\n      }\n    }\n\n    if (!existing && this.node) {\n      node = this.node;\n      target.appendChild(node);\n      existing = true;\n    }\n\n    if (!node) {\n      const name = this.template.e;\n      node = createElement(\n        this.namespace === html ? name.toLowerCase() : name,\n        this.namespace,\n        this.getAttribute('is')\n      );\n      this.node = node;\n    }\n\n    // tie the node to this vdom element\n    defineProperty(node, '_ractive', {\n      value: {\n        proxy: this\n      },\n      configurable: true\n    });\n\n    if (existing && this.foundNode) this.foundNode(node);\n\n    // register intro before rendering content so children can find the intro\n    const intro = this.intro;\n    if (intro && intro.shouldFire('intro')) {\n      intro.isIntro = true;\n      intro.isOutro = false;\n      runloop.registerTransition(intro);\n    }\n\n    if (this.fragment) {\n      const children = existing ? toArray(node.childNodes) : undefined;\n\n      this.fragment.render(node, children);\n\n      // clean up leftover children\n      if (children) {\n        children.forEach(detachNode);\n      }\n    }\n\n    if (existing) {\n      // store initial values for two-way binding\n      if (this.binding && this.binding.wasUndefined) this.binding.setFromNode(node);\n      // remove unused attributes\n      let i = node.attributes.length;\n      while (i--) {\n        const name = node.attributes[i].name;\n        if (!(name in this.attributeByName)) node.removeAttribute(name);\n      }\n    }\n\n    // Is this a top-level node of a component? If so, we may need to add\n    // a data-ractive-css attribute, for CSS encapsulation\n    if (this.up.cssIds) {\n      node.setAttribute('data-ractive-css', this.up.cssIds.map(x => `{${x}}`).join(' '));\n    }\n\n    if (this.attributes) this.attributes.forEach(render);\n    if (this.binding) this.binding.render();\n\n    if (!this.up.delegate && this.listeners) {\n      const ls = this.listeners;\n      for (const k in ls) {\n        if (ls[k] && ls[k].length) this.node.addEventListener(k, handler, !!ls[k].refs);\n      }\n    }\n\n    if (!existing) {\n      target.appendChild(node);\n    }\n\n    this.rendered = true;\n  }\n\n  toString() {\n    const tagName = this.template.e;\n\n    let attrs = (this.attributes && this.attributes.map(stringifyAttribute).join('')) || '';\n\n    // Special case - selected options\n    if (this.name === 'option' && this.isSelected()) {\n      attrs += ' selected';\n    }\n\n    // Special case - two-way radio name bindings\n    if (this.name === 'input' && inputIsCheckedRadio(this)) {\n      attrs += ' checked';\n    }\n\n    // Special case style and class attributes and directives\n    let style, cls;\n    this.attributes &&\n      this.attributes.forEach(attr => {\n        if (attr.name === 'class') {\n          cls = (cls || '') + (cls ? ' ' : '') + safeAttributeString(attr.getString());\n        } else if (attr.name === 'style') {\n          style = (style || '') + (style ? ' ' : '') + safeAttributeString(attr.getString());\n          if (style && !endsWithSemi.test(style)) style += ';';\n        } else if (attr.style) {\n          style =\n            (style || '') +\n            (style ? ' ' : '') +\n            `${attr.style}: ${safeAttributeString(attr.getString())};`;\n        } else if (attr.inlineClass && attr.getValue()) {\n          cls = (cls || '') + (cls ? ' ' : '') + attr.inlineClass;\n        }\n      });\n    // put classes first, then inline style\n    if (style !== undefined) attrs = ' style' + (style ? `=\"${style}\"` : '') + attrs;\n    if (cls !== undefined) attrs = ' class' + (cls ? `=\"${cls}\"` : '') + attrs;\n\n    if (this.up.cssIds) {\n      attrs += ` data-ractive-css=\"${this.up.cssIds.map(x => `{${x}}`).join(' ')}\"`;\n    }\n\n    let str = `<${tagName}${attrs}>`;\n\n    if (voidElementNames.test(this.name)) return str;\n\n    // Special case - textarea\n    if (this.name === 'textarea' && this.getAttribute('value') !== undefined) {\n      str += escapeHtml(this.getAttribute('value'));\n    } else if (this.getAttribute('contenteditable') !== undefined) {\n      // Special case - contenteditable\n      str += this.getAttribute('value') || '';\n    }\n\n    if (this.fragment) {\n      str += this.fragment.toString(!/^(?:script|style)$/i.test(this.template.e)); // escape text unless script/style\n    }\n\n    str += `</${tagName}>`;\n    return str;\n  }\n\n  unbind() {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.unbinding = true;\n      attrs.forEach(unbind);\n      attrs.unbinding = false;\n    }\n\n    if (this.binding) this.binding.unbind();\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (!this.rendered) return;\n    this.rendered = false;\n\n    // unrendering before intro completed? complete it now\n    // TODO should be an API for aborting transitions\n    const transition = this.intro;\n    if (transition && transition.complete) transition.complete();\n\n    // Detach as soon as we can\n    if (this.name === 'option') {\n      // <option> elements detach immediately, so that\n      // their parent <select> element syncs correctly, and\n      // since option elements can't have transitions anyway\n      this.detach();\n    } else if (shouldDestroy) {\n      runloop.detachWhenReady(this);\n    }\n\n    // outro transition\n    const outro = this.outro;\n    if (outro && outro.shouldFire('outro')) {\n      outro.isIntro = false;\n      outro.isOutro = true;\n      runloop.registerTransition(outro);\n    }\n\n    if (this.fragment) this.fragment.unrender();\n\n    if (this.binding) this.binding.unrender();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n\n      this.attributes && this.attributes.forEach(update);\n\n      if (this.fragment) this.fragment.update();\n    }\n  }\n}\n\nfunction inputIsCheckedRadio(element) {\n  const nameAttr = element.attributeByName.name;\n  return (\n    element.getAttribute('type') === 'radio' &&\n    (nameAttr || {}).interpolator &&\n    element.getAttribute('value') === nameAttr.interpolator.model.get()\n  );\n}\n\nfunction stringifyAttribute(attribute) {\n  const str = attribute.toString();\n  return str ? ' ' + str : '';\n}\n\nfunction getNamespace(element) {\n  // Use specified namespace...\n  const xmlns = element.getAttribute('xmlns');\n  if (xmlns) return xmlns;\n\n  // ...or SVG namespace, if this is an <svg> element\n  if (element.name === 'svg') return svg;\n\n  const parent = element.parent;\n\n  if (parent) {\n    // ...or HTML, if the parent is a <foreignObject>\n    if (parent.name === 'foreignobject') return html;\n\n    // ...or inherit from the parent node\n    return parent.node.namespaceURI;\n  }\n\n  return element.ractive.el.namespaceURI;\n}\n\nfunction delegateHandler(ev) {\n  const name = ev.type;\n  const end = ev.currentTarget;\n  const endEl = end._ractive && end._ractive.proxy;\n  let node = ev.target;\n  let bubble = true;\n  let listeners;\n\n  // starting with the origin node, walk up the DOM looking for ractive nodes with a matching event listener\n  while (bubble && node && node !== end) {\n    const proxy = node._ractive && node._ractive.proxy;\n    if (proxy && proxy.up.delegate === endEl && shouldFire(ev, node, end)) {\n      listeners = proxy.listeners && proxy.listeners[name];\n\n      if (listeners) {\n        listeners.forEach(l => {\n          bubble = l.call(node, ev) !== false && bubble;\n        });\n      }\n    }\n\n    node = node.parentNode || node.correspondingUseElement; // SVG with a <use> element in certain environments\n  }\n\n  return bubble;\n}\n\nconst UIEvent = win !== null ? win.UIEvent : null;\nfunction shouldFire(event, start, end) {\n  if (UIEvent && event instanceof UIEvent) {\n    let node = start;\n    while (node && node !== end) {\n      if (node.disabled) return false;\n      node = node.parentNode || node.correspondingUseElement;\n    }\n  }\n\n  return true;\n}\n\nfunction handler(ev) {\n  const el = this._ractive.proxy;\n  if (!el.listeners || !el.listeners[ev.type]) return;\n  el.listeners[ev.type].forEach(l => l.call(this, ev));\n}\n","import runloop from 'src/global/runloop';\nimport Element from '../../Element';\n\nexport default class Form extends Element {\n  constructor(options) {\n    super(options);\n    this.formBindings = [];\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.on('reset', handleReset);\n  }\n\n  unrender(shouldDestroy) {\n    this.off('reset', handleReset);\n    super.unrender(shouldDestroy);\n  }\n}\n\nfunction handleReset() {\n  const element = this._ractive.proxy;\n\n  runloop.start();\n  element.formBindings.forEach(updateModel);\n  runloop.end();\n}\n\nfunction updateModel(binding) {\n  binding.model.set(binding.resetValue);\n}\n","import { fatal } from 'utils/log';\nimport runloop from 'src/global/runloop';\nimport { win } from 'config/environment';\n\n// because IE\nconst whitelist = {\n  animationend: 1,\n  animationiteration: 1,\n  animationstart: 1,\n  transitioncancel: 1,\n  transitionend: 1,\n  transitionstart: 1,\n  transitionrun: 1\n};\n\nclass DOMEvent {\n  constructor(name, owner) {\n    if (name.indexOf('*') !== -1) {\n      fatal(\n        `Only component proxy-events may contain \"*\" wildcards, <${\n          owner.name\n        } on-${name}=\"...\"/> is not valid`\n      );\n    }\n\n    this.name = name;\n    this.owner = owner;\n    this.handler = null;\n  }\n\n  bind() {}\n\n  render(directive) {\n    // schedule events so that they take place after twoway binding\n    runloop.scheduleTask(() => {\n      const node = this.owner.node;\n      const name = this.name;\n      const on = `on${name}`;\n\n      // this is probably a custom event fired from a decorator or manually\n      if (!(on in node) && !(on in win) && !whitelist[name]) return;\n\n      this.owner.on(\n        name,\n        (this.handler = event => {\n          return directive.fire({\n            node,\n            original: event,\n            event,\n            name\n          });\n        })\n      );\n    }, true);\n  }\n\n  unbind() {}\n\n  unrender() {\n    if (this.handler) this.owner.off(this.name, this.handler);\n  }\n}\n\nclass CustomEvent {\n  constructor(eventPlugin, owner, name) {\n    this.eventPlugin = eventPlugin;\n    this.owner = owner;\n    this.name = name;\n    this.handler = null;\n  }\n\n  bind() {}\n\n  render(directive) {\n    runloop.scheduleTask(() => {\n      const node = this.owner.node;\n\n      this.handler = this.eventPlugin(node, (event = {}) => {\n        if (event.original) event.event = event.original;\n        else event.original = event.event;\n\n        event.name = this.name;\n        event.node = event.node || node;\n        return directive.fire(event);\n      });\n    });\n  }\n\n  unbind() {}\n\n  unrender() {\n    this.handler.teardown();\n  }\n}\n\nexport { DOMEvent, CustomEvent };\n","import Context from '../../../shared/Context';\n\nexport default class RactiveEvent {\n  constructor(component, name) {\n    this.component = component;\n    this.name = name;\n    this.handler = null;\n  }\n\n  bind(directive) {\n    const ractive = this.component.instance;\n\n    this.handler = ractive.on(this.name, (...args) => {\n      // watch for reproxy\n      if (args[0] instanceof Context) {\n        const ctx = args.shift();\n        ctx.component = ractive;\n        directive.fire(ctx, args);\n      } else {\n        directive.fire({}, args);\n      }\n\n      // cancel bubbling\n      return false;\n    });\n  }\n\n  render() {}\n\n  unbind() {\n    this.handler.cancel();\n  }\n\n  unrender() {}\n}\n","import { ANCHOR, COMPONENT } from 'config/types';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport fireEvent from 'src/events/fireEvent';\nimport { splitKeypath } from 'shared/keypaths';\nimport { findInViewHierarchy } from 'shared/registry';\nimport findElement from './findElement';\nimport { DOMEvent, CustomEvent } from '../element/ElementEvents';\nimport RactiveEvent from '../component/RactiveEvent';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport Context from 'src/shared/Context';\nimport { isArray, isString } from 'utils/is';\n\nconst specialPattern = /^(event|arguments|@node|@event|@context)(\\..+)?$/;\nconst dollarArgsPattern = /^\\$(\\d+)(\\..+)?$/;\n\nexport default class EventDirective {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up, true);\n    this.template = options.template;\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n    //const delegate = this.delegate = this.ractive.delegate && options.up.delegate;\n    this.events = [];\n\n    if (this.element.type === COMPONENT || this.element.type === ANCHOR) {\n      this.template.n.forEach(n => {\n        this.events.push(new RactiveEvent(this.element, n));\n      });\n    } else {\n      // make sure the delegate element has a storag object\n      //if ( delegate && !delegate.delegates ) delegate.delegates = {};\n\n      this.template.n.forEach(n => {\n        const fn = findInViewHierarchy('events', this.ractive, n);\n        if (fn) {\n          this.events.push(new CustomEvent(fn, this.element, n));\n        } else {\n          this.events.push(new DOMEvent(n, this.element));\n        }\n      });\n    }\n\n    // method calls\n    this.models = null;\n  }\n\n  bind() {\n    addToArray(this.element.events || (this.element.events = []), this);\n\n    setupArgsFn(this, this.template);\n    if (!this.fn) this.action = this.template.f;\n\n    this.events.forEach(e => e.bind(this));\n  }\n\n  destroyed() {\n    this.events.forEach(e => e.unrender());\n  }\n\n  fire(event, args = []) {\n    const context =\n      event instanceof Context && event.refire ? event : this.element.getContext(event);\n\n    if (this.fn) {\n      const values = [];\n\n      const models = resolveArgs(this, this.template, this.up, {\n        specialRef(ref) {\n          const specialMatch = specialPattern.exec(ref);\n          if (specialMatch) {\n            // on-click=\"foo(event.node)\"\n            return {\n              special: specialMatch[1],\n              keys: specialMatch[2] ? splitKeypath(specialMatch[2].substr(1)) : []\n            };\n          }\n\n          const dollarMatch = dollarArgsPattern.exec(ref);\n          if (dollarMatch) {\n            // on-click=\"foo($1)\"\n            return {\n              special: 'arguments',\n              keys: [dollarMatch[1] - 1].concat(\n                dollarMatch[2] ? splitKeypath(dollarMatch[2].substr(1)) : []\n              )\n            };\n          }\n        }\n      });\n\n      if (models) {\n        models.forEach(model => {\n          if (!model) return values.push(undefined);\n\n          if (model.special) {\n            const which = model.special;\n            let obj;\n\n            if (which === '@node') {\n              obj = this.element.node;\n            } else if (which === '@event') {\n              obj = event && event.event;\n            } else if (which === 'event') {\n              warnOnceIfDebug(\n                `The event reference available to event directives is deprecated and should be replaced with @context and @event`\n              );\n              obj = context;\n            } else if (which === '@context') {\n              obj = context;\n            } else {\n              obj = args;\n            }\n\n            const keys = model.keys.slice();\n\n            while (obj && keys.length) obj = obj[keys.shift()];\n            return values.push(obj);\n          }\n\n          if (model.wrapper) {\n            return values.push(model.wrapperValue);\n          }\n\n          values.push(model.get());\n        });\n      }\n\n      // make event available as `this.event`\n      const ractive = this.ractive;\n      const oldEvent = ractive.event;\n\n      ractive.event = context;\n      const returned = this.fn.apply(ractive, values);\n      let result = returned.pop();\n\n      // Auto prevent and stop if return is explicitly false\n      if (result === false) {\n        const original = event ? event.original : undefined;\n        if (original) {\n          original.preventDefault && original.preventDefault();\n          original.stopPropagation && original.stopPropagation();\n        } else {\n          warnOnceIfDebug(\n            `handler '${this.template.n.join(\n              ' '\n            )}' returned false, but there is no event available to cancel`\n          );\n        }\n      } else if (!returned.length && isArray(result) && isString(result[0])) {\n        // watch for proxy events\n        result = fireEvent(this.ractive, result.shift(), context, result);\n      }\n\n      ractive.event = oldEvent;\n\n      return result;\n    } else {\n      return fireEvent(this.ractive, this.action, context, args);\n    }\n  }\n\n  handleChange() {}\n\n  render() {\n    this.events.forEach(e => e.render(this));\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    removeFromArray(this.element.events, this);\n    this.events.forEach(e => e.unbind());\n  }\n\n  unrender() {\n    this.events.forEach(e => e.unrender());\n  }\n}\n\nEventDirective.prototype.update = noop;\n","import { rebindMatch } from 'shared/rebind';\nimport Item, { ContainerItem } from './Item';\nimport resolve from '../../resolvers/resolve';\nimport { assign } from 'utils/object';\n\nexport default class Mustache extends Item {\n  constructor(options) {\n    super(options);\n\n    if (options.owner) this.parent = options.owner;\n\n    this.isStatic = !!options.template.s;\n\n    this.model = null;\n    this.dirty = false;\n  }\n\n  bind() {\n    // yield mustaches should resolve in container context\n    const start = this.containerFragment || this.up;\n    // try to find a model for this view\n    const model = resolve(start, this.template);\n\n    if (model) {\n      const value = model.get();\n\n      if (this.isStatic) {\n        this.model = { get: () => value };\n        model.unreference();\n        return;\n      }\n\n      model.register(this);\n      this.model = model;\n    }\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebind(next, previous, safe) {\n    next = rebindMatch(this.template, next, previous, this.up);\n    if (next === this.model) return false;\n\n    if (this.model) {\n      this.model.unregister(this);\n    }\n    if (next) next.addShuffleRegister(this, 'mark');\n    this.model = next;\n    if (!safe) this.handleChange();\n    return true;\n  }\n\n  unbind() {\n    if (!this.isStatic) {\n      this.model && this.model.unregister(this);\n      this.model = undefined;\n    }\n  }\n}\n\nexport function MustacheContainer(options) {\n  Mustache.call(this, options);\n}\n\nconst proto = (MustacheContainer.prototype = Object.create(ContainerItem.prototype));\n\nassign(proto, Mustache.prototype, { constructor: MustacheContainer });\n","import progressiveText from './shared/progressiveText';\nimport { escapeHtml } from 'utils/html';\nimport { safeToStringValue } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport Mustache from './shared/Mustache';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Interpolator extends Mustache {\n  bubble() {\n    if (this.owner) this.owner.bubble();\n    super.bubble();\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getString() {\n    return this.model ? safeToStringValue(this.model.get()) : '';\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    const value = this.getString();\n\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, value);\n  }\n\n  toString(escape) {\n    const string = this.getString();\n    return escape ? escapeHtml(string) : string;\n  }\n\n  unrender(shouldDestroy) {\n    if (shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.rendered) {\n        this.node.data = this.getString();\n      }\n    }\n  }\n\n  valueOf() {\n    return this.model ? this.model.get() : undefined;\n  }\n}\n","import Element from '../../Element';\nimport { isFunction } from 'utils/is';\n\nexport default class Input extends Element {\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.node.defaultValue = this.node.value;\n  }\n  compare(value, attrValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(value, attrValue);\n      }\n      if (value && attrValue) {\n        return value[comparator] == attrValue[comparator];\n      }\n    }\n    return value == attrValue;\n  }\n}\n","import { warnIfDebug } from 'utils/log';\nimport { create, hasOwn } from 'utils/object';\n\nconst leadingWhitespace = /^\\s+/;\n\nconst ParseError = function(message) {\n  this.name = 'ParseError';\n  this.message = message;\n  try {\n    throw new Error(message);\n  } catch (e) {\n    this.stack = e.stack;\n  }\n};\n\nParseError.prototype = Error.prototype;\n\nconst Parser = function(str, options) {\n  let item;\n  let lineStart = 0;\n\n  this.str = str;\n  this.options = options || {};\n  this.pos = 0;\n\n  this.lines = this.str.split('\\n');\n  this.lineEnds = this.lines.map(line => {\n    const lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n    lineStart = lineEnd;\n    return lineEnd;\n  }, 0);\n\n  // Custom init logic\n  if (this.init) this.init(str, options);\n\n  const items = [];\n\n  while (this.pos < this.str.length && (item = this.read())) {\n    items.push(item);\n  }\n\n  this.leftover = this.remaining();\n  this.result = this.postProcess ? this.postProcess(items, options) : items;\n};\n\nParser.prototype = {\n  read(converters) {\n    let i, item;\n\n    if (!converters) converters = this.converters;\n\n    const pos = this.pos;\n\n    const len = converters.length;\n    for (i = 0; i < len; i += 1) {\n      this.pos = pos; // reset for each attempt\n\n      if ((item = converters[i](this))) {\n        return item;\n      }\n    }\n\n    return null;\n  },\n\n  getContextMessage(pos, message) {\n    const [lineNum, columnNum] = this.getLinePos(pos);\n    if (this.options.contextLines === -1) {\n      return [lineNum, columnNum, `${message} at line ${lineNum} character ${columnNum}`];\n    }\n\n    const line = this.lines[lineNum - 1];\n\n    let contextUp = '';\n    let contextDown = '';\n    if (this.options.contextLines) {\n      const start =\n        lineNum - 1 - this.options.contextLines < 0 ? 0 : lineNum - 1 - this.options.contextLines;\n      contextUp = this.lines\n        .slice(start, lineNum - 1 - start)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      contextDown = this.lines\n        .slice(lineNum, lineNum + this.options.contextLines)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      if (contextUp) {\n        contextUp += '\\n';\n      }\n      if (contextDown) {\n        contextDown = '\\n' + contextDown;\n      }\n    }\n\n    let numTabs = 0;\n    const annotation =\n      contextUp +\n      line.replace(/\\t/g, (match, char) => {\n        if (char < columnNum) {\n          numTabs += 1;\n        }\n\n        return '  ';\n      }) +\n      '\\n' +\n      new Array(columnNum + numTabs).join(' ') +\n      '^----' +\n      contextDown;\n\n    return [\n      lineNum,\n      columnNum,\n      `${message} at line ${lineNum} character ${columnNum}:\\n${annotation}`\n    ];\n  },\n\n  getLinePos(char) {\n    let lineNum = 0;\n    let lineStart = 0;\n\n    while (char >= this.lineEnds[lineNum]) {\n      lineStart = this.lineEnds[lineNum];\n      lineNum += 1;\n    }\n\n    const columnNum = char - lineStart;\n    return [lineNum + 1, columnNum + 1, char]; // line/col should be one-based, not zero-based!\n  },\n\n  error(message) {\n    const [lineNum, columnNum, msg] = this.getContextMessage(this.pos, message);\n\n    const error = new ParseError(msg);\n\n    error.line = lineNum;\n    error.character = columnNum;\n    error.shortMessage = message;\n\n    throw error;\n  },\n\n  matchString(string) {\n    if (this.str.substr(this.pos, string.length) === string) {\n      this.pos += string.length;\n      return string;\n    }\n  },\n\n  matchPattern(pattern) {\n    let match;\n\n    if ((match = pattern.exec(this.remaining()))) {\n      this.pos += match[0].length;\n      return match[1] || match[0];\n    }\n  },\n\n  sp() {\n    this.matchPattern(leadingWhitespace);\n  },\n\n  remaining() {\n    return this.str.substring(this.pos);\n  },\n\n  nextChar() {\n    return this.str.charAt(this.pos);\n  },\n\n  warn(message) {\n    const msg = this.getContextMessage(this.pos, message)[2];\n\n    warnIfDebug(msg);\n  }\n};\n\nParser.extend = function(proto) {\n  const Parent = this;\n  const Child = function(str, options) {\n    Parser.call(this, str, options);\n  };\n\n  Child.prototype = create(Parent.prototype);\n\n  for (const key in proto) {\n    if (hasOwn(proto, key)) {\n      Child.prototype[key] = proto[key];\n    }\n  }\n\n  Child.extend = Parser.extend;\n  return Child;\n};\n\nexport default Parser;\n","// Match one or more characters until: \", ', \\, or EOL/EOF.\n// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\nconst stringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n// Match one escape sequence, including the backslash.\nexport const escapeSequencePattern = /^\\\\(?:[`'\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n// Match one ES5 line continuation (backslash + line terminator).\nexport const lineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n// Helper for defining getDoubleQuotedString and getSingleQuotedString.\nexport default function(okQuote) {\n  return function(parser) {\n    let literal = '\"';\n    let done = false;\n    let next;\n\n    while (!done) {\n      next =\n        parser.matchPattern(stringMiddlePattern) ||\n        parser.matchPattern(escapeSequencePattern) ||\n        parser.matchString(okQuote);\n      if (next) {\n        if (next === `\"`) {\n          literal += `\\\\\"`;\n        } else if (next === `\\\\'`) {\n          literal += `'`;\n        } else {\n          literal += next;\n        }\n      } else {\n        next = parser.matchPattern(lineContinuationPattern);\n        if (next) {\n          // convert \\(newline-like) into a \\u escape, which is allowed in JSON\n          literal += '\\\\u' + ('000' + next.charCodeAt(1).toString(16)).slice(-4);\n        } else {\n          done = true;\n        }\n      }\n    }\n\n    literal += '\"';\n\n    // use JSON.parse to interpret escapes\n    return JSON.parse(literal);\n  };\n}\n","import { STRING_LITERAL } from '../../../../../config/types';\nimport makeQuotedStringMatcher from './stringLiteral/makeQuotedStringMatcher';\n\nconst singleMatcher = makeQuotedStringMatcher(`\"`);\nconst doubleMatcher = makeQuotedStringMatcher(`'`);\n\nexport default function(parser) {\n  const start = parser.pos;\n  const quote = parser.matchString(`'`) || parser.matchString(`\"`);\n\n  if (quote) {\n    const string = (quote === `'` ? singleMatcher : doubleMatcher)(parser);\n\n    if (!parser.matchString(quote)) {\n      parser.pos = start;\n      return null;\n    }\n\n    return {\n      t: STRING_LITERAL,\n      v: string\n    };\n  }\n\n  return null;\n}\n","import { NUMBER_LITERAL } from '../../../../../config/types';\n\n// bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\nconst numberPattern = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\nexport default function readNumberLiteral(parser) {\n  let result;\n\n  if ((result = parser.matchPattern(numberPattern))) {\n    return {\n      t: NUMBER_LITERAL,\n      v: result\n    };\n  }\n\n  return null;\n}\n","export const name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\nexport const spreadPattern = /^\\s*\\.{3}/;\nexport const legalReference = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:\\.(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nexport const relaxedName = /^[a-zA-Z_$][-\\/a-zA-Z_$0-9]*(?:\\.(?:[a-zA-Z_$][-\\/a-zA-Z_$0-9]*))*/;\n","import readStringLiteral from '../primary/literal/readStringLiteral';\nimport readNumberLiteral from '../primary/literal/readNumberLiteral';\nimport { name as namePattern } from './patterns';\n\nconst identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n// http://mathiasbynens.be/notes/javascript-properties\n// can be any name, string literal, or number literal\nexport default function readKey(parser) {\n  let token;\n\n  if ((token = readStringLiteral(parser))) {\n    return identifier.test(token.v) ? token.v : '\"' + token.v.replace(/\"/g, '\\\\\"') + '\"';\n  }\n\n  if ((token = readNumberLiteral(parser))) {\n    return token.v;\n  }\n\n  if ((token = parser.matchPattern(namePattern))) {\n    return token;\n  }\n\n  return null;\n}\n","import Parser from 'parse/Parser';\nimport readStringLiteral from 'parse/converters/expressions/primary/literal/readStringLiteral';\nimport readKey from 'parse/converters/expressions/shared/readKey';\nimport { hasOwn, keys } from 'utils/object';\n\n// simple JSON parser, without the restrictions of JSON parse\n// (i.e. having to double-quote keys).\n//\n// If passed a hash of values as the second argument, ${placeholders}\n// will be replaced with those values\n\nconst specials = {\n  true: true,\n  false: false,\n  null: null,\n  undefined\n};\n\nconst specialsPattern = new RegExp('^(?:' + keys(specials).join('|') + ')');\nconst numberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\nconst placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\nconst placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\nconst onlyWhitespace = /^\\s*$/;\n\nconst JsonParser = Parser.extend({\n  init(str, options) {\n    this.values = options.values;\n    this.sp();\n  },\n\n  postProcess(result) {\n    if (result.length !== 1 || !onlyWhitespace.test(this.leftover)) {\n      return null;\n    }\n\n    return { value: result[0].v };\n  },\n\n  converters: [\n    function getPlaceholder(parser) {\n      if (!parser.values) return null;\n\n      const placeholder = parser.matchPattern(placeholderAtStartPattern);\n\n      if (placeholder && hasOwn(parser.values, placeholder)) {\n        return { v: parser.values[placeholder] };\n      }\n    },\n\n    function getSpecial(parser) {\n      const special = parser.matchPattern(specialsPattern);\n      if (special) return { v: specials[special] };\n    },\n\n    function getNumber(parser) {\n      const number = parser.matchPattern(numberPattern);\n      if (number) return { v: +number };\n    },\n\n    function getString(parser) {\n      const stringLiteral = readStringLiteral(parser);\n      const values = parser.values;\n\n      if (stringLiteral && values) {\n        return {\n          v: stringLiteral.v.replace(\n            placeholderPattern,\n            (match, $1) => ($1 in values ? values[$1] : $1)\n          )\n        };\n      }\n\n      return stringLiteral;\n    },\n\n    function getObject(parser) {\n      if (!parser.matchString('{')) return null;\n\n      const result = {};\n\n      parser.sp();\n\n      if (parser.matchString('}')) {\n        return { v: result };\n      }\n\n      let pair;\n      while ((pair = getKeyValuePair(parser))) {\n        result[pair.key] = pair.value;\n\n        parser.sp();\n\n        if (parser.matchString('}')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n      }\n\n      return null;\n    },\n\n    function getArray(parser) {\n      if (!parser.matchString('[')) return null;\n\n      const result = [];\n\n      parser.sp();\n\n      if (parser.matchString(']')) {\n        return { v: result };\n      }\n\n      let valueToken;\n      while ((valueToken = parser.read())) {\n        result.push(valueToken.v);\n\n        parser.sp();\n\n        if (parser.matchString(']')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n\n        parser.sp();\n      }\n\n      return null;\n    }\n  ]\n});\n\nfunction getKeyValuePair(parser) {\n  parser.sp();\n\n  const key = readKey(parser);\n\n  if (!key) return null;\n\n  const pair = { key };\n\n  parser.sp();\n  if (!parser.matchString(':')) {\n    return null;\n  }\n  parser.sp();\n\n  const valueToken = parser.read();\n\n  if (!valueToken) return null;\n\n  pair.value = valueToken.v;\n  return pair;\n}\n\nexport default function(str, values) {\n  const parser = new JsonParser(str, { values });\n  return parser.result;\n}\n","import { INTERPOLATOR } from '../../../config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport parseJSON from '../../../utils/parseJSON';\nimport resolve from '../../resolvers/resolve';\nimport runloop from '../../../global/runloop';\nimport { warnIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isArray, isObjectType, isString } from 'utils/is';\n\nexport default class Mapping extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = this.element.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.element.attributeByName[this.name] = this;\n\n    this.value = options.template.f;\n  }\n\n  bind() {\n    const template = this.template.f;\n    const viewmodel = this.element.instance.viewmodel;\n\n    if (template === 0) {\n      // empty attributes are `true`\n      viewmodel.joinKey(this.name).set(true);\n    } else if (isString(template)) {\n      const parsed = parseJSON(template);\n      viewmodel.joinKey(this.name).set(parsed ? parsed.value : template);\n    } else if (isArray(template)) {\n      createMapping(this, true);\n    }\n  }\n\n  render() {}\n\n  unbind() {\n    if (this.model) this.model.unregister(this);\n    if (this.boundFragment) this.boundFragment.unbind();\n\n    if (this.element.bound) {\n      if (this.link.target === this.model) this.link.owner.unlink();\n    }\n  }\n\n  unrender() {}\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.boundFragment) this.boundFragment.update();\n    }\n  }\n}\n\nfunction createMapping(item) {\n  const template = item.template.f;\n  const viewmodel = item.element.instance.viewmodel;\n  const childData = viewmodel.value;\n\n  if (template.length === 1 && template[0].t === INTERPOLATOR) {\n    const model = resolve(item.up, template[0]);\n    const val = model.get(false);\n\n    // if the interpolator is not static\n    if (!template[0].s) {\n      item.model = model;\n      item.link = viewmodel.createLink(item.name, model, template[0].r, {\n        mapping: true\n      });\n\n      // initialize parent side of the mapping from child data\n      if (val === undefined && !model.isReadonly && item.name in childData) {\n        model.set(childData[item.name]);\n      }\n    } else if (!isObjectType(val) || template[0].x) {\n      // copy non-object, non-computed vals through\n      viewmodel.joinKey(splitKeypath(item.name)).set(val);\n    } else {\n      // warn about trying to copy an object\n      warnIfDebug(`Cannot copy non-computed object value from static mapping '${item.name}'`);\n    }\n\n    // if the item isn't going to manage the model, give it a chance to tear down if it's computed\n    if (model !== item.model) model.unregister();\n  } else {\n    item.boundFragment = new Fragment({\n      owner: item,\n      template\n    }).bind();\n\n    item.model = viewmodel.joinKey(splitKeypath(item.name));\n    item.model.set(item.boundFragment.valueOf());\n\n    // item is a *bit* of a hack\n    item.boundFragment.bubble = () => {\n      Fragment.prototype.bubble.call(item.boundFragment);\n      // defer this to avoid mucking around model deps if there happens to be an expression involved\n      runloop.scheduleTask(() => {\n        item.boundFragment.update();\n        item.model.set(item.boundFragment.valueOf());\n      });\n    };\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport Element from '../../Element';\nimport findElement from '../../shared/findElement';\nimport { isArray } from 'utils/is';\n\nexport default class Option extends Element {\n  constructor(options) {\n    const template = options.template;\n    if (!template.a) template.a = {};\n\n    // If the value attribute is missing, use the element's content,\n    // as long as it isn't disabled\n    if (template.a.value === undefined && !('disabled' in template.a)) {\n      template.a.value = template.f || '';\n    }\n\n    super(options);\n\n    this.select = findElement(this.parent || this.up, false, 'select');\n  }\n\n  bind() {\n    if (!this.select) {\n      super.bind();\n      return;\n    }\n\n    // If the select has a value, it overrides the `selected` attribute on\n    // this option - so we delete the attribute\n    const selectedAttribute = this.attributeByName.selected;\n    if (selectedAttribute && this.select.getAttribute('value') !== undefined) {\n      const index = this.attributes.indexOf(selectedAttribute);\n      this.attributes.splice(index, 1);\n      delete this.attributeByName.selected;\n    }\n\n    super.bind();\n    this.select.options.push(this);\n  }\n\n  bubble() {\n    // if we're using content as value, may need to update here\n    const value = this.getAttribute('value');\n    if (this.node && this.node.value !== value) {\n      this.node._ractive.value = value;\n    }\n    super.bubble();\n  }\n\n  getAttribute(name) {\n    const attribute = this.attributeByName[name];\n    return attribute\n      ? attribute.getValue()\n      : name === 'value' && this.fragment\n        ? this.fragment.valueOf()\n        : undefined;\n  }\n\n  isSelected() {\n    const optionValue = this.getAttribute('value');\n\n    if (optionValue === undefined || !this.select) {\n      return false;\n    }\n\n    const selectValue = this.select.getAttribute('value');\n\n    if (this.select.compare(selectValue, optionValue)) {\n      return true;\n    }\n\n    if (this.select.getAttribute('multiple') && isArray(selectValue)) {\n      let i = selectValue.length;\n      while (i--) {\n        if (this.select.compare(selectValue[i], optionValue)) {\n          return true;\n        }\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n\n    if (!this.attributeByName.value) {\n      this.node._ractive.value = this.getAttribute('value');\n    }\n  }\n\n  unbind() {\n    super.unbind();\n\n    if (this.select) {\n      removeFromArray(this.select.options, this);\n    }\n  }\n}\n","import { ELEMENT, PARTIAL, SECTION, SECTION_WITH, YIELDER } from 'config/types';\nimport { assign, create, hasOwn, keys } from 'utils/object';\nimport { isArray, isFunction, isObjectType, isString } from 'utils/is';\nimport noop from 'utils/noop';\nimport { MustacheContainer } from './shared/Mustache';\nimport Fragment from '../Fragment';\nimport getPartialTemplate from './partial/getPartialTemplate';\nimport { resolveAliases } from './Alias';\nimport { warnOnceIfDebug, warnIfDebug } from 'utils/log';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport runloop from 'src/global/runloop';\nimport { applyCSS } from 'src/global/css';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function Partial(options) {\n  MustacheContainer.call(this, options);\n\n  const tpl = options.template;\n\n  // yielder is a special form of partial that will later require special handling\n  if (tpl.t === YIELDER) {\n    this.yielder = 1;\n  } else if (tpl.t === ELEMENT) {\n    // this is a macro partial, complete with macro constructor\n    // leaving this as an element will confuse up-template searches\n    this.type = PARTIAL;\n    this.macro = options.macro;\n  }\n}\n\nconst proto = (Partial.prototype = create(MustacheContainer.prototype));\n\nassign(proto, {\n  constructor: Partial,\n\n  bind() {\n    const template = this.template;\n\n    if (this.yielder) {\n      // the container is the instance that owns this node\n      this.container = this.up.ractive;\n      this.component = this.container.component;\n      this.containerFragment = this.up;\n\n      // normal component\n      if (this.component) {\n        // yields skip the owning instance and go straight to the surrounding context\n        this.up = this.component.up;\n\n        // {{yield}} is equivalent to {{yield content}}\n        if (!template.r && !template.x && !template.tx) this.refName = 'content';\n      } else {\n        // plain-ish instance that may be attached to a parent later\n        this.fragment = new Fragment({\n          owner: this,\n          template: []\n        });\n        this.fragment.bind();\n        return;\n      }\n    }\n\n    // this is a macro/super partial\n    if (this.macro) {\n      this.fn = this.macro;\n    } else {\n      // this is a plain partial or yielder\n      if (!this.refName) this.refName = template.r;\n\n      // if the refName exists as a partial, this is a plain old partial reference where no model binding will happen\n      if (this.refName) {\n        partialFromValue(this, this.refName);\n      }\n\n      // this is a dynamic/inline partial\n      if (!this.partial && !this.fn) {\n        MustacheContainer.prototype.bind.call(this);\n        if (this.model) partialFromValue(this, this.model.get());\n      }\n    }\n\n    if (!this.partial && !this.fn) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    createFragment(this, this.partial || []);\n\n    // macro/super partial\n    if (this.fn) initMacro(this);\n\n    this.fragment.bind();\n  },\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.yielder) {\n        this.containerFragment.bubble();\n      } else {\n        this.up.bubble();\n      }\n    }\n  },\n\n  findNextNode() {\n    return (this.containerFragment || this.up).findNextNode(this);\n  },\n\n  handleChange() {\n    this.dirtyTemplate = true;\n    this.externalChange = true;\n    this.bubble();\n  },\n\n  refreshAttrs() {\n    keys(this._attrs).forEach(k => {\n      this.handle.attributes[k] = this._attrs[k].valueOf();\n    });\n  },\n\n  resetTemplate() {\n    if (this.fn && this.proxy) {\n      if (this.externalChange) {\n        if (isFunction(this.proxy.teardown)) this.proxy.teardown();\n        this.fn = this.proxy = null;\n      } else {\n        this.partial = this.fnTemplate;\n        return true;\n      }\n    }\n\n    const partial = this.partial;\n    this.partial = null;\n\n    if (this.refName) {\n      this.partial = getPartialTemplate(this.ractive, this.refName, this.up);\n    }\n\n    if (!this.partial && this.model) {\n      partialFromValue(this, this.model.get());\n    }\n\n    if (!this.fn && partial === this.partial) return false;\n\n    this.unbindAttrs();\n\n    if (this.fn) {\n      initMacro(this);\n      if (isFunction(this.proxy.render)) runloop.scheduleTask(() => this.proxy.render());\n    } else if (!this.partial) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    return true;\n  },\n\n  render(target, occupants) {\n    if (this.fn && this.fn._cssDef && !this.fn._cssDef.applied) applyCSS();\n\n    this.fragment.render(target, occupants);\n\n    if (this.proxy && isFunction(this.proxy.render)) this.proxy.render();\n  },\n\n  unbind() {\n    this.fragment.unbind();\n\n    this.fragment.aliases = null;\n\n    this.unbindAttrs();\n\n    MustacheContainer.prototype.unbind.call(this);\n  },\n\n  unbindAttrs() {\n    if (this._attrs) {\n      keys(this._attrs).forEach(k => {\n        this._attrs[k].unbind();\n      });\n    }\n  },\n\n  unrender(shouldDestroy) {\n    if (this.proxy && isFunction(this.proxy.teardown)) this.proxy.teardown();\n\n    this.fragment.unrender(shouldDestroy);\n  },\n\n  update() {\n    const proxy = this.proxy;\n    this.updating = 1;\n\n    if (this.dirtyAttrs) {\n      this.dirtyAttrs = false;\n      this.refreshAttrs();\n      if (isFunction(proxy.update)) proxy.update(this.handle.attributes);\n    }\n\n    if (this.dirtyTemplate) {\n      this.dirtyTemplate = false;\n      this.resetTemplate() && this.fragment.resetTemplate(this.partial || []);\n    }\n\n    if (this.dirty) {\n      this.dirty = false;\n      if (proxy && isFunction(proxy.invalidate)) proxy.invalidate();\n      this.fragment.update();\n    }\n\n    this.externalChange = false;\n    this.updating = 0;\n  }\n});\n\nfunction createFragment(self, partial) {\n  self.partial = partial;\n  contextifyTemplate(self);\n\n  const options = {\n    owner: self,\n    template: self.partial\n  };\n\n  if (self.yielder) options.ractive = self.container.parent;\n\n  if (self.fn) options.cssIds = self.fn._cssIds;\n\n  const fragment = (self.fragment = new Fragment(options));\n\n  // partials may have aliases that need to be in place before binding\n  if (self.template.z) {\n    fragment.aliases = resolveAliases(self.template.z, self.containerFragment || self.up);\n  }\n}\n\nfunction contextifyTemplate(self) {\n  if (self.template.c) {\n    self.partial = [{ t: SECTION, n: SECTION_WITH, f: self.partial }];\n    assign(self.partial[0], self.template.c);\n  }\n}\n\nfunction partialFromValue(self, value, okToParse) {\n  let tpl = value;\n\n  if (isArray(tpl)) {\n    self.partial = tpl;\n  } else if (tpl && isObjectType(tpl)) {\n    if (isArray(tpl.t)) self.partial = tpl.t;\n    else if (isString(tpl.template))\n      self.partial = parsePartial(tpl.template, tpl.template, self.ractive).t;\n  } else if (isFunction(tpl) && tpl.styleSet) {\n    self.fn = tpl;\n    if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n  } else if (tpl != null) {\n    tpl = getPartialTemplate(self.ractive, '' + tpl, self.containerFragment || self.up);\n    if (tpl) {\n      self.name = value;\n      if (tpl.styleSet) {\n        self.fn = tpl;\n        if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n      } else self.partial = tpl;\n    } else if (okToParse) {\n      self.partial = parsePartial('' + value, '' + value, self.ractive).t;\n    } else {\n      self.name = value;\n    }\n  }\n\n  return self.partial;\n}\n\nfunction setTemplate(template) {\n  partialFromValue(this, template, true);\n\n  if (!this.initing) {\n    this.dirtyTemplate = true;\n    this.fnTemplate = this.partial;\n\n    if (this.updating) {\n      this.bubble();\n      runloop.promise();\n    } else {\n      const promise = runloop.start();\n\n      this.bubble();\n      runloop.end();\n\n      return promise;\n    }\n  }\n}\n\nfunction aliasLocal(ref, name) {\n  const aliases = this.fragment.aliases || (this.fragment.aliases = {});\n  if (!name) {\n    aliases[ref] = this._data;\n  } else {\n    aliases[name] = this._data.joinAll(splitKeypath(ref));\n  }\n}\n\nconst extras = 'extra-attributes';\n\nfunction initMacro(self) {\n  const fn = self.fn;\n  const fragment = self.fragment;\n\n  // defensively copy the template in case it changes\n  const template = (self.template = assign({}, self.template));\n  const handle = (self.handle = fragment.getContext({\n    proxy: self,\n    aliasLocal,\n    name: self.template.e || self.name,\n    attributes: {},\n    setTemplate: setTemplate.bind(self),\n    template\n  }));\n\n  if (!template.p) template.p = {};\n  template.p = handle.partials = assign({}, template.p);\n  if (!hasOwn(template.p, 'content')) template.p.content = template.f || [];\n\n  if (isArray(fn.attributes)) {\n    self._attrs = {};\n\n    const invalidate = function() {\n      this.dirty = true;\n      self.dirtyAttrs = true;\n      self.bubble();\n    };\n\n    if (isArray(template.m)) {\n      const attrs = template.m;\n      template.p[extras] = template.m = attrs.filter(a => !~fn.attributes.indexOf(a.n));\n      attrs.filter(a => ~fn.attributes.indexOf(a.n)).forEach(a => {\n        const fragment = new Fragment({\n          template: a.f,\n          owner: self\n        });\n        fragment.bubble = invalidate;\n        fragment.findFirstNode = noop;\n        self._attrs[a.n] = fragment;\n      });\n    } else {\n      template.p[extras] = [];\n    }\n  } else {\n    template.p[extras] = template.m;\n  }\n\n  if (self._attrs) {\n    keys(self._attrs).forEach(k => {\n      self._attrs[k].bind();\n    });\n    self.refreshAttrs();\n  }\n\n  self.initing = 1;\n  self.proxy = fn(handle, handle.attributes) || {};\n  if (!self.partial) self.partial = [];\n  self.fnTemplate = self.partial;\n  self.initing = 0;\n\n  contextifyTemplate(self);\n  fragment.resetTemplate(self.partial);\n}\n\nfunction parsePartial(name, partial, ractive) {\n  let parsed;\n\n  try {\n    parsed = parser.parse(partial, parser.getParseOptions(ractive));\n  } catch (e) {\n    warnIfDebug(`Could not parse partial from expression '${name}'\\n${e.message}`);\n  }\n\n  return parsed || { t: [] };\n}\n","import { fromExpression, fromComputationString } from 'parse/utils/createFunction';\nimport { doc } from 'config/environment';\nimport { fatal } from 'utils/log';\nimport { addFunctions } from 'shared/getFunction';\nimport parse from 'parse/_parse';\nimport { isString } from 'utils/is';\n\nconst parseOptions = [\n  'delimiters',\n  'tripleDelimiters',\n  'staticDelimiters',\n  'staticTripleDelimiters',\n  'csp',\n  'interpolate',\n  'preserveWhitespace',\n  'sanitize',\n  'stripComments',\n  'contextLines',\n  'attributes'\n];\n\nconst TEMPLATE_INSTRUCTIONS = `Either preparse or use a ractive runtime source that includes the parser. `;\n\nconst COMPUTATION_INSTRUCTIONS = `Either include a version of Ractive that can parse or convert your computation strings to functions.`;\n\nfunction throwNoParse(method, error, instructions) {\n  if (!method) {\n    fatal(`Missing Ractive.parse - cannot parse ${error}. ${instructions}`);\n  }\n}\n\nexport function createFunction(body, length) {\n  throwNoParse(fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS);\n  return fromExpression(body, length);\n}\n\nexport function createFunctionFromString(str, bindTo) {\n  throwNoParse(fromComputationString, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS);\n  return fromComputationString(str, bindTo);\n}\n\nconst parser = {\n  fromId(id, options) {\n    if (!doc) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Cannot retrieve template #${id} as Ractive is not running in a browser.`);\n    }\n\n    if (id) id = id.replace(/^#/, '');\n\n    let template;\n\n    if (!(template = doc.getElementById(id))) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Could not find template element with id #${id}`);\n    }\n\n    if (template.tagName.toUpperCase() !== 'SCRIPT') {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Template element with id #${id}, must be a <script> element`);\n    }\n\n    return 'textContent' in template ? template.textContent : template.innerHTML;\n  },\n\n  isParsed(template) {\n    return !isString(template);\n  },\n\n  getParseOptions(ractive) {\n    // Could be Ractive or a Component\n    if (ractive.defaults) {\n      ractive = ractive.defaults;\n    }\n\n    return parseOptions.reduce((val, key) => {\n      val[key] = ractive[key];\n      return val;\n    }, {});\n  },\n\n  parse(template, options) {\n    throwNoParse(parse, 'template', TEMPLATE_INSTRUCTIONS);\n    const parsed = parse(template, options);\n    addFunctions(parsed);\n    return parsed;\n  },\n\n  parseFor(template, ractive) {\n    return this.parse(template, this.getParseOptions(ractive));\n  }\n};\n\nexport default parser;\n","import { createFunction } from '../Ractive/config/runtime-parser';\nimport { create, keys } from 'utils/object';\n\nconst functions = create(null);\n\nexport default function getFunction(str, i) {\n  if (functions[str]) return functions[str];\n  return (functions[str] = createFunction(str, i));\n}\n\nexport function addFunctions(template) {\n  if (!template) return;\n\n  const exp = template.e;\n\n  if (!exp) return;\n\n  keys(exp).forEach(str => {\n    if (functions[str]) return;\n    functions[str] = exp[str];\n  });\n}\n","import { TEMPLATE_VERSION } from 'config/template';\nimport { addFunctions } from 'shared/getFunction';\nimport parser from '../runtime-parser';\nimport { hasOwn } from 'utils/object';\nimport { isFunction, isNumber, isString } from 'utils/is';\n\nexport default {\n  name: 'template',\n\n  extend(Parent, proto, options) {\n    // only assign if exists\n    if ('template' in options) {\n      const template = options.template;\n\n      if (isFunction(template)) {\n        proto.template = template;\n      } else {\n        proto.template = parseTemplate(template, proto);\n      }\n    }\n  },\n\n  init(Parent, ractive, options) {\n    // TODO because of prototypal inheritance, we might just be able to use\n    // ractive.template, and not bother passing through the Parent object.\n    // At present that breaks the test mocks' expectations\n    let template = 'template' in options ? options.template : Parent.prototype.template;\n    template = template || { v: TEMPLATE_VERSION, t: [] };\n\n    if (isFunction(template)) {\n      const fn = template;\n      template = getDynamicTemplate(ractive, fn);\n\n      ractive._config.template = {\n        fn,\n        result: template\n      };\n    }\n\n    template = parseTemplate(template, ractive);\n\n    // TODO the naming of this is confusing - ractive.template refers to [...],\n    // but Component.prototype.template refers to {v:1,t:[],p:[]}...\n    // it's unnecessary, because the developer never needs to access\n    // ractive.template\n    ractive.template = template.t;\n\n    if (template.p) {\n      extendPartials(ractive.partials, template.p);\n    }\n  },\n\n  reset(ractive) {\n    const result = resetValue(ractive);\n\n    if (result) {\n      const parsed = parseTemplate(result, ractive);\n\n      ractive.template = parsed.t;\n      extendPartials(ractive.partials, parsed.p, true);\n\n      return true;\n    }\n  }\n};\n\nfunction resetValue(ractive) {\n  const initial = ractive._config.template;\n\n  // If this isn't a dynamic template, there's nothing to do\n  if (!initial || !initial.fn) {\n    return;\n  }\n\n  const result = getDynamicTemplate(ractive, initial.fn);\n\n  // TODO deep equality check to prevent unnecessary re-rendering\n  // in the case of already-parsed templates\n  if (result !== initial.result) {\n    initial.result = result;\n    return result;\n  }\n}\n\nfunction getDynamicTemplate(ractive, fn) {\n  return fn.call(ractive, {\n    fromId: parser.fromId,\n    isParsed: parser.isParsed,\n    parse(template, options = parser.getParseOptions(ractive)) {\n      return parser.parse(template, options);\n    }\n  });\n}\n\nfunction parseTemplate(template, ractive) {\n  if (isString(template)) {\n    // parse will validate and add expression functions\n    template = parseAsString(template, ractive);\n  } else {\n    // need to validate and add exp for already parsed template\n    validate(template);\n    addFunctions(template);\n  }\n\n  return template;\n}\n\nfunction parseAsString(template, ractive) {\n  // ID of an element containing the template?\n  if (template[0] === '#') {\n    template = parser.fromId(template);\n  }\n\n  return parser.parseFor(template, ractive);\n}\n\nfunction validate(template) {\n  // Check that the template even exists\n  if (template == undefined) {\n    throw new Error(`The template cannot be ${template}.`);\n  } else if (!isNumber(template.v)) {\n    // Check the parsed template has a version at all\n    throw new Error(\n      \"The template parser was passed a non-string template, but the template doesn't have a version.  Make sure you're passing in the template you think you are.\"\n    );\n  } else if (template.v !== TEMPLATE_VERSION) {\n    // Check we're using the correct version\n    throw new Error(\n      `Mismatched template version (expected ${TEMPLATE_VERSION}, got ${\n        template.v\n      }) Please ensure you are using the latest version of Ractive.js in your build process as well as in your app`\n    );\n  }\n}\n\nfunction extendPartials(existingPartials, newPartials, overwrite) {\n  if (!newPartials) return;\n\n  // TODO there's an ambiguity here - we need to overwrite in the `reset()`\n  // case, but not initially...\n\n  for (const key in newPartials) {\n    if (overwrite || !hasOwn(existingPartials, key)) {\n      existingPartials[key] = newPartials[key];\n    }\n  }\n}\n","import { create, keys } from 'utils/object';\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'computed',\n  'decorators',\n  'easing',\n  'events',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nconst registriesOnDefaults = ['computed'];\n\nclass Registry {\n  constructor(name, useDefaults) {\n    this.name = name;\n    this.useDefaults = useDefaults;\n  }\n\n  extend(Parent, proto, options) {\n    const parent = this.useDefaults ? Parent.defaults : Parent;\n    const target = this.useDefaults ? proto : proto.constructor;\n    this.configure(parent, target, options);\n  }\n\n  init() {\n    // noop\n  }\n\n  configure(Parent, target, options) {\n    const name = this.name;\n    const option = options[name];\n\n    const registry = create(Parent[name]);\n\n    for (const key in option) {\n      registry[key] = option[key];\n    }\n\n    target[name] = registry;\n  }\n\n  reset(ractive) {\n    const registry = ractive[this.name];\n    let changed = false;\n\n    keys(registry).forEach(key => {\n      const item = registry[key];\n\n      if (item._fn) {\n        if (item._fn.isOwner) {\n          registry[key] = item._fn;\n        } else {\n          delete registry[key];\n        }\n        changed = true;\n      }\n    });\n\n    return changed;\n  }\n}\n\nconst registries = registryNames.map(name => {\n  const putInDefaults = registriesOnDefaults.indexOf(name) > -1;\n  return new Registry(name, putInDefaults);\n});\n\nexport default registries;\n","import { warnIfDebug } from 'utils/log';\nimport adaptConfigurator from './custom/adapt';\nimport cssConfigurator from './custom/css/css';\nimport dataConfigurator from './custom/data';\nimport templateConfigurator from './custom/template';\nimport defaults from './defaults';\nimport registries from './registries';\nimport wrapPrototype from './wrapPrototypeMethod';\nimport deprecate from './deprecate';\nimport RactiveProto from '../prototype';\nimport { hasOwn, keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nconst custom = {\n  adapt: adaptConfigurator,\n  css: cssConfigurator,\n  data: dataConfigurator,\n  template: templateConfigurator\n};\n\nconst defaultKeys = keys(defaults);\n\nconst isStandardKey = makeObj(defaultKeys.filter(key => !custom[key]));\n\n// blacklisted keys that we don't double extend\nconst isBlacklisted = makeObj(\n  defaultKeys.concat(registries.map(r => r.name), ['on', 'observe', 'attributes', 'cssData'])\n);\n\nconst order = [].concat(\n  defaultKeys.filter(key => !registries[key] && !custom[key]),\n  registries,\n  //custom.data,\n  custom.template,\n  custom.css\n);\n\nconst config = {\n  extend: (Parent, proto, options, Child) => configure('extend', Parent, proto, options, Child),\n  init: (Parent, ractive, options) => configure('init', Parent, ractive, options),\n  reset: ractive => order.filter(c => c.reset && c.reset(ractive)).map(c => c.name)\n};\n\nfunction configure(method, Parent, target, options, Child) {\n  deprecate(options);\n\n  for (const key in options) {\n    if (hasOwn(isStandardKey, key)) {\n      const value = options[key];\n\n      // warn the developer if they passed a function and ignore its value\n\n      // NOTE: we allow some functions on \"el\" because we duck type element lists\n      // and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n      // function object as the result of querySelector methods\n      if (key !== 'el' && isFunction(value)) {\n        warnIfDebug(\n          `${key} is a Ractive option that does not expect a function and will be ignored`,\n          method === 'init' ? target : null\n        );\n      } else {\n        target[key] = value;\n      }\n    }\n  }\n\n  // disallow combination of `append` and `enhance`\n  if (options.append && options.enhance) {\n    throw new Error('Cannot use append and enhance at the same time');\n  }\n\n  registries.forEach(registry => {\n    registry[method](Parent, target, options, Child);\n  });\n\n  adaptConfigurator[method](Parent, target, options, Child);\n  templateConfigurator[method](Parent, target, options, Child);\n  cssConfigurator[method](Parent, target, options, Child);\n\n  extendOtherMethods(Parent.prototype, target, options);\n}\n\nconst _super = /\\b_super\\b/;\nfunction extendOtherMethods(parent, target, options) {\n  for (const key in options) {\n    if (!isBlacklisted[key] && hasOwn(options, key)) {\n      let member = options[key];\n\n      // if this is a method that overwrites a method, wrap it:\n      if (isFunction(member)) {\n        if (key in RactiveProto && !_super.test(member.toString())) {\n          warnIfDebug(\n            `Overriding Ractive prototype function '${key}' without calling the '${_super}' method can be very dangerous.`\n          );\n        }\n        member = wrapPrototype(parent, key, member);\n      }\n\n      target[key] = member;\n    }\n  }\n}\n\nfunction makeObj(array) {\n  const obj = {};\n  array.forEach(x => (obj[x] = true));\n  return obj;\n}\n\nexport default config;\n","import { createDocumentFragment } from 'utils/dom';\nimport noop from 'utils/noop';\n\nexport default class Item {\n  constructor(options) {\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n\n    this.template = options.template;\n    this.index = options.index;\n    this.type = options.template.t;\n\n    this.dirty = false;\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  find() {\n    return null;\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  findNextNode() {\n    return this.up.findNextNode(this);\n  }\n\n  shuffled() {\n    if (this.fragment) this.fragment.shuffled();\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n}\n\nItem.prototype.findAll = noop;\nItem.prototype.findAllComponents = noop;\n\nexport class ContainerItem extends Item {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    return this.fragment ? this.fragment.detach() : createDocumentFragment();\n  }\n\n  find(selector) {\n    if (this.fragment) {\n      return this.fragment.find(selector);\n    }\n  }\n\n  findAll(selector, options) {\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findComponent(name) {\n    if (this.fragment) {\n      return this.fragment.findComponent(name);\n    }\n  }\n\n  findAllComponents(name, options) {\n    if (this.fragment) {\n      this.fragment.findAllComponents(name, options);\n    }\n  }\n\n  firstNode(skipParent) {\n    return this.fragment && this.fragment.firstNode(skipParent);\n  }\n\n  toString(escape) {\n    return this.fragment ? this.fragment.toString(escape) : '';\n  }\n}\n","import { capture } from 'src/global/capture';\nimport Model from './Model';\nimport { handleChange, mark, marked } from 'shared/methodCallers';\nimport { hasOwn } from 'utils/object';\n\nexport default class ComputationChild extends Model {\n  constructor(parent, key) {\n    super(parent, key);\n\n    this.isReadonly = !this.root.ractive.syncComputedChildren;\n    this.dirty = true;\n  }\n\n  get setRoot() {\n    return this.parent.setRoot;\n  }\n\n  applyValue(value) {\n    super.applyValue(value);\n\n    if (!this.isReadonly) {\n      let source = this.parent;\n      // computed models don't have a shuffle method\n      while (source && source.shuffle) {\n        source = source.parent;\n      }\n\n      if (source) {\n        source.dependencies.forEach(mark);\n      }\n    }\n\n    if (this.setRoot) {\n      this.setRoot.set(this.setRoot.value);\n    }\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      this.dirty = false;\n      const parentValue = this.parent.get();\n      this.value = parentValue ? parentValue[this.key] : undefined;\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    }\n\n    return (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n      ? this.wrapperValue\n      : this.value;\n  }\n\n  handleChange() {\n    this.dirty = true;\n\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n    this.deps.forEach(handleChange);\n    this.children.forEach(handleChange);\n  }\n\n  joinKey(key) {\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new ComputationChild(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n}\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { capture, startCapturing, stopCapturing } from 'src/global/capture';\nimport { warnIfDebug } from 'utils/log';\nimport Model from './Model';\nimport { maybeBind } from './ModelBase';\nimport ComputationChild from './ComputationChild';\nimport { hasConsole } from 'config/environment';\nimport { isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\n\nexport default class Computation extends Model {\n  constructor(viewmodel, signature, key) {\n    super(null, null);\n\n    this.root = this.parent = viewmodel;\n    this.signature = signature;\n\n    this.key = key; // not actually used, but helps with debugging\n    this.isExpression = key && key[0] === '@';\n\n    this.isReadonly = !this.signature.setter;\n\n    this.context = viewmodel.computationContext;\n\n    this.dependencies = [];\n\n    this.children = [];\n    this.childByKey = {};\n\n    this.deps = [];\n\n    this.dirty = true;\n\n    // TODO: is there a less hackish way to do this?\n    this.shuffle = undefined;\n  }\n\n  get setRoot() {\n    if (this.signature.setter) return this;\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      this.dirty = false;\n      const old = this.value;\n      this.value = this.getValue();\n      // this may cause a view somewhere to update, so it must be in a runloop\n      if (!runloop.active()) {\n        runloop.start();\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n        runloop.end();\n      } else {\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n      }\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    }\n\n    // if capturing, this value needs to be unwrapped because it's for external use\n    return maybeBind(\n      this,\n      // if unwrap is supplied, it overrides capture\n      this.wrapper && (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture)\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      result = this.signature.getter.call(this.context);\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n\n      // TODO this is all well and good in Chrome, but...\n      // ...also, should encapsulate this stuff better, and only\n      // show it if Ractive.DEBUG\n      if (hasConsole) {\n        if (console.groupCollapsed)\n          console.groupCollapsed(\n            '%cshow details',\n            'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n          );\n        const sig = this.signature;\n        console.error(\n          `${err.name}: ${err.message}\\n\\n${sig.getterString}${\n            sig.getterUseStack ? '\\n\\n' + err.stack : ''\n          }`\n        );\n        if (console.groupCollapsed) console.groupEnd();\n      }\n    }\n\n    const dependencies = stopCapturing();\n    this.setDependencies(dependencies);\n\n    return result;\n  }\n\n  mark() {\n    this.handleChange();\n  }\n\n  rebind(next, previous) {\n    // computations will grab all of their deps again automagically\n    if (next !== previous) this.handleChange();\n  }\n\n  set(value) {\n    if (this.isReadonly) {\n      throw new Error(`Cannot set read-only computed value '${this.key}'`);\n    }\n\n    this.signature.setter(value);\n    this.mark();\n  }\n\n  setDependencies(dependencies) {\n    // unregister any soft dependencies we no longer have\n    let i = this.dependencies.length;\n    while (i--) {\n      const model = this.dependencies[i];\n      if (!~dependencies.indexOf(model)) model.unregister(this);\n    }\n\n    // and add any new ones\n    i = dependencies.length;\n    while (i--) {\n      const model = dependencies[i];\n      if (!~this.dependencies.indexOf(model)) model.register(this);\n    }\n\n    this.dependencies = dependencies;\n  }\n\n  teardown() {\n    let i = this.dependencies.length;\n    while (i--) {\n      if (this.dependencies[i]) this.dependencies[i].unregister(this);\n    }\n    if (this.root.computations[this.key] === this) delete this.root.computations[this.key];\n    super.teardown();\n  }\n}\n\nconst prototype = Computation.prototype;\nconst child = ComputationChild.prototype;\nprototype.handleChange = child.handleChange;\nprototype.joinKey = child.joinKey;\n","import { removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport { warnIfDebug } from 'utils/log';\nimport Model from 'src/model/Model';\nimport Computation from 'src/model/Computation';\nimport { startCapturing, stopCapturing } from 'src/global/capture';\nimport getFunction from 'shared/getFunction';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from './resolveReference';\n\nexport default class ExpressionProxy extends Model {\n  constructor(fragment, template) {\n    super(fragment.ractive.viewmodel, null);\n\n    this.fragment = fragment;\n    this.template = template;\n\n    this.isReadonly = true;\n    this.dirty = true;\n\n    this.fn = getFunction(template.s, template.r.length);\n\n    this.models = this.template.r.map(ref => {\n      return resolveReference(this.fragment, ref);\n    });\n    this.dependencies = [];\n\n    this.shuffle = undefined;\n\n    this.bubble();\n  }\n\n  bubble(actuallyChanged = true) {\n    // refresh the keypath\n    this.keypath = undefined;\n\n    if (actuallyChanged) {\n      this.handleChange();\n    }\n  }\n\n  getKeypath() {\n    if (!this.template) return '@undefined';\n    if (!this.keypath) {\n      this.keypath =\n        '@' +\n        this.template.s.replace(/_(\\d+)/g, (match, i) => {\n          if (i >= this.models.length) return match;\n\n          const model = this.models[i];\n          return model ? model.getKeypath() : '@undefined';\n        });\n    }\n\n    return this.keypath;\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      const params = this.models.map(m => (m ? m.get(true) : undefined));\n      result = this.fn.apply(this.fragment.ractive, params);\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n    }\n\n    const dependencies = stopCapturing();\n    // remove missing deps\n    this.dependencies.filter(d => !~dependencies.indexOf(d)).forEach(d => {\n      d.unregister(this);\n      removeFromArray(this.dependencies, d);\n    });\n    // register new deps\n    dependencies.filter(d => !~this.dependencies.indexOf(d)).forEach(d => {\n      d.register(this);\n      this.dependencies.push(d);\n    });\n\n    return result;\n  }\n\n  notifyUpstream() {}\n\n  rebind(next, previous, safe) {\n    const idx = this.models.indexOf(previous);\n\n    if (~idx) {\n      next = rebindMatch(this.template.r[idx], next, previous);\n      if (next !== previous) {\n        previous.unregister(this);\n        this.models.splice(idx, 1, next);\n        if (next) next.addShuffleRegister(this, 'mark');\n      }\n    }\n    this.bubble(!safe);\n  }\n\n  retrieve() {\n    return this.get();\n  }\n\n  teardown() {\n    this.fragment = undefined;\n    if (this.dependencies) this.dependencies.forEach(d => d.unregister(this));\n    super.teardown();\n  }\n\n  unreference() {\n    super.unreference();\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n\n  unregister(dep) {\n    super.unregister(dep);\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n}\n\nconst prototype = ExpressionProxy.prototype;\nconst computation = Computation.prototype;\nprototype.get = computation.get;\nprototype.handleChange = computation.handleChange;\nprototype.joinKey = computation.joinKey;\nprototype.mark = computation.mark;\nprototype.unbind = noop;\n","import Model from 'src/model/Model';\nimport { findBoundValue } from 'src/model/ModelBase';\nimport { REFERENCE } from 'config/types';\nimport { rebindMatch } from 'shared/rebind';\nimport { handleChange, mark, marked } from 'shared/methodCallers';\nimport { isEqual, isString } from 'utils/is';\nimport { escapeKey } from 'shared/keypaths';\nimport ExpressionProxy from './ExpressionProxy';\nimport resolveReference from './resolveReference';\nimport resolve from './resolve';\nimport { hasOwn } from 'utils/object';\nimport { capture } from 'src/global/capture';\n\nclass ReferenceExpressionChild extends Model {\n  constructor(parent, key) {\n    super(parent, key);\n    this.dirty = true;\n  }\n\n  applyValue(value) {\n    if (isEqual(value, this.value)) return;\n\n    let parent = this.parent;\n    const keys = [this.key];\n    while (parent) {\n      if (parent.base) {\n        const target = parent.model.joinAll(keys);\n        target.applyValue(value);\n        break;\n      }\n\n      keys.unshift(parent.key);\n\n      parent = parent.parent;\n    }\n  }\n\n  get(shouldCapture, opts) {\n    this.retrieve();\n    return super.get(shouldCapture, opts);\n  }\n\n  joinKey(key) {\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new ReferenceExpressionChild(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n\n  mark() {\n    this.dirty = true;\n    super.mark();\n  }\n\n  retrieve() {\n    if (this.dirty) {\n      this.dirty = false;\n      const parent = this.parent.get();\n      this.value = parent && parent[this.key];\n    }\n\n    return this.value;\n  }\n}\n\nconst missing = { get() {} };\n\nexport default class ReferenceExpressionProxy extends Model {\n  constructor(fragment, template) {\n    super(null, null);\n    this.dirty = true;\n    this.root = fragment.ractive.viewmodel;\n    this.template = template;\n\n    this.base = resolve(fragment, template);\n\n    const intermediary = (this.intermediary = {\n      handleChange: () => this.handleChange(),\n      rebind: (next, previous) => {\n        if (previous === this.base) {\n          next = rebindMatch(template, next, previous);\n          if (next !== this.base) {\n            this.base.unregister(intermediary);\n            this.base = next;\n          }\n        } else {\n          const idx = this.members.indexOf(previous);\n          if (~idx) {\n            // only direct references will rebind... expressions handle themselves\n            next = rebindMatch(template.m[idx].n, next, previous);\n            if (next !== this.members[idx]) {\n              this.members.splice(idx, 1, next || missing);\n            }\n          }\n        }\n\n        if (next !== previous) previous.unregister(intermediary);\n        if (next) next.addShuffleTask(() => next.register(intermediary));\n\n        this.bubble();\n      }\n    });\n\n    this.members = template.m.map(template => {\n      if (isString(template)) {\n        return { get: () => template };\n      }\n\n      let model;\n\n      if (template.t === REFERENCE) {\n        model = resolveReference(fragment, template.n);\n        model.register(intermediary);\n\n        return model;\n      }\n\n      model = new ExpressionProxy(fragment, template);\n      model.register(intermediary);\n      return model;\n    });\n\n    this.base.register(intermediary);\n\n    this.bubble();\n  }\n\n  bubble() {\n    if (!this.base) return;\n    if (!this.dirty) this.handleChange();\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n    if (this.dirty) {\n      this.bubble();\n\n      const keys = this.members.map(m => escapeKey(String(m.get())));\n      const model = this.base.joinAll(keys);\n\n      if (model !== this.model) {\n        if (this.model) {\n          this.model.unregister(this);\n          this.model.unregisterTwowayBinding(this);\n        }\n\n        this.model = model;\n        this.parent = model.parent;\n        this.model.register(this);\n        this.model.registerTwowayBinding(this);\n\n        if (this.keypathModel) this.keypathModel.handleChange();\n      }\n\n      this.value = this.model.get(shouldCapture, opts);\n      this.dirty = false;\n      this.mark();\n      return this.value;\n    } else {\n      return this.model ? this.model.get(shouldCapture, opts) : undefined;\n    }\n  }\n\n  // indirect two-way bindings\n  getValue() {\n    this.value = this.model ? this.model.get() : undefined;\n\n    let i = this.bindings.length;\n    while (i--) {\n      const value = this.bindings[i].getValue();\n      if (value !== this.value) return value;\n    }\n\n    // check one-way bindings\n    const oneway = findBoundValue(this.deps);\n    if (oneway) return oneway.value;\n\n    return this.value;\n  }\n\n  getKeypath() {\n    return this.model ? this.model.getKeypath() : '@undefined';\n  }\n\n  handleChange() {\n    this.dirty = true;\n    this.mark();\n  }\n\n  joinKey(key) {\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new ReferenceExpressionChild(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n\n  mark() {\n    if (this.dirty) {\n      this.deps.forEach(handleChange);\n    }\n\n    this.links.forEach(marked);\n    this.children.forEach(mark);\n  }\n\n  rebind() {\n    this.handleChange();\n  }\n\n  retrieve() {\n    return this.value;\n  }\n\n  set(value) {\n    this.model.set(value);\n  }\n\n  shuffle(newIndices, unsafe) {\n    if (this.model && !this.model.shuffling) this.model.shuffle(newIndices, unsafe);\n    else super.shuffle(newIndices, unsafe);\n  }\n\n  teardown() {\n    if (this.base) {\n      this.base.unregister(this.intermediary);\n    }\n    if (this.model) {\n      this.model.unregister(this);\n      this.model.unregisterTwowayBinding(this);\n    }\n    if (this.members) {\n      this.members.forEach(m => m && m.unregister && m.unregister(this.intermediary));\n    }\n  }\n\n  unreference() {\n    super.unreference();\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n\n  unregister(dep) {\n    super.unregister(dep);\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n}\n","import Fragment from '../Fragment';\nimport { ContainerItem } from './shared/Item';\nimport resolve from '../resolvers/resolve';\n\nexport function resolveAliases(aliases, fragment) {\n  const resolved = {};\n\n  for (let i = 0; i < aliases.length; i++) {\n    resolved[aliases[i].n] = resolve(fragment, aliases[i].x);\n  }\n\n  for (const k in resolved) {\n    resolved[k].reference();\n  }\n\n  return resolved;\n}\n\nexport default class Alias extends ContainerItem {\n  constructor(options) {\n    super(options);\n\n    this.fragment = null;\n  }\n\n  bind() {\n    this.fragment = new Fragment({\n      owner: this,\n      template: this.template.f\n    });\n\n    this.fragment.aliases = resolveAliases(this.template.z, this.up);\n    this.fragment.bind();\n  }\n\n  render(target) {\n    this.rendered = true;\n    if (this.fragment) this.fragment.render(target);\n  }\n\n  unbind() {\n    for (const k in this.fragment.aliases) {\n      this.fragment.aliases[k].unreference();\n    }\n\n    this.fragment.aliases = {};\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      this.fragment.update();\n    }\n  }\n}\n","import { keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\n// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\nexport const booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\nexport const voidElementNames = /^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;\n\nconst htmlEntities = {\n  quot: 34,\n  amp: 38,\n  apos: 39,\n  lt: 60,\n  gt: 62,\n  nbsp: 160,\n  iexcl: 161,\n  cent: 162,\n  pound: 163,\n  curren: 164,\n  yen: 165,\n  brvbar: 166,\n  sect: 167,\n  uml: 168,\n  copy: 169,\n  ordf: 170,\n  laquo: 171,\n  not: 172,\n  shy: 173,\n  reg: 174,\n  macr: 175,\n  deg: 176,\n  plusmn: 177,\n  sup2: 178,\n  sup3: 179,\n  acute: 180,\n  micro: 181,\n  para: 182,\n  middot: 183,\n  cedil: 184,\n  sup1: 185,\n  ordm: 186,\n  raquo: 187,\n  frac14: 188,\n  frac12: 189,\n  frac34: 190,\n  iquest: 191,\n  Agrave: 192,\n  Aacute: 193,\n  Acirc: 194,\n  Atilde: 195,\n  Auml: 196,\n  Aring: 197,\n  AElig: 198,\n  Ccedil: 199,\n  Egrave: 200,\n  Eacute: 201,\n  Ecirc: 202,\n  Euml: 203,\n  Igrave: 204,\n  Iacute: 205,\n  Icirc: 206,\n  Iuml: 207,\n  ETH: 208,\n  Ntilde: 209,\n  Ograve: 210,\n  Oacute: 211,\n  Ocirc: 212,\n  Otilde: 213,\n  Ouml: 214,\n  times: 215,\n  Oslash: 216,\n  Ugrave: 217,\n  Uacute: 218,\n  Ucirc: 219,\n  Uuml: 220,\n  Yacute: 221,\n  THORN: 222,\n  szlig: 223,\n  agrave: 224,\n  aacute: 225,\n  acirc: 226,\n  atilde: 227,\n  auml: 228,\n  aring: 229,\n  aelig: 230,\n  ccedil: 231,\n  egrave: 232,\n  eacute: 233,\n  ecirc: 234,\n  euml: 235,\n  igrave: 236,\n  iacute: 237,\n  icirc: 238,\n  iuml: 239,\n  eth: 240,\n  ntilde: 241,\n  ograve: 242,\n  oacute: 243,\n  ocirc: 244,\n  otilde: 245,\n  ouml: 246,\n  divide: 247,\n  oslash: 248,\n  ugrave: 249,\n  uacute: 250,\n  ucirc: 251,\n  uuml: 252,\n  yacute: 253,\n  thorn: 254,\n  yuml: 255,\n  OElig: 338,\n  oelig: 339,\n  Scaron: 352,\n  scaron: 353,\n  Yuml: 376,\n  fnof: 402,\n  circ: 710,\n  tilde: 732,\n  Alpha: 913,\n  Beta: 914,\n  Gamma: 915,\n  Delta: 916,\n  Epsilon: 917,\n  Zeta: 918,\n  Eta: 919,\n  Theta: 920,\n  Iota: 921,\n  Kappa: 922,\n  Lambda: 923,\n  Mu: 924,\n  Nu: 925,\n  Xi: 926,\n  Omicron: 927,\n  Pi: 928,\n  Rho: 929,\n  Sigma: 931,\n  Tau: 932,\n  Upsilon: 933,\n  Phi: 934,\n  Chi: 935,\n  Psi: 936,\n  Omega: 937,\n  alpha: 945,\n  beta: 946,\n  gamma: 947,\n  delta: 948,\n  epsilon: 949,\n  zeta: 950,\n  eta: 951,\n  theta: 952,\n  iota: 953,\n  kappa: 954,\n  lambda: 955,\n  mu: 956,\n  nu: 957,\n  xi: 958,\n  omicron: 959,\n  pi: 960,\n  rho: 961,\n  sigmaf: 962,\n  sigma: 963,\n  tau: 964,\n  upsilon: 965,\n  phi: 966,\n  chi: 967,\n  psi: 968,\n  omega: 969,\n  thetasym: 977,\n  upsih: 978,\n  piv: 982,\n  ensp: 8194,\n  emsp: 8195,\n  thinsp: 8201,\n  zwnj: 8204,\n  zwj: 8205,\n  lrm: 8206,\n  rlm: 8207,\n  ndash: 8211,\n  mdash: 8212,\n  lsquo: 8216,\n  rsquo: 8217,\n  sbquo: 8218,\n  ldquo: 8220,\n  rdquo: 8221,\n  bdquo: 8222,\n  dagger: 8224,\n  Dagger: 8225,\n  bull: 8226,\n  hellip: 8230,\n  permil: 8240,\n  prime: 8242,\n  Prime: 8243,\n  lsaquo: 8249,\n  rsaquo: 8250,\n  oline: 8254,\n  frasl: 8260,\n  euro: 8364,\n  image: 8465,\n  weierp: 8472,\n  real: 8476,\n  trade: 8482,\n  alefsym: 8501,\n  larr: 8592,\n  uarr: 8593,\n  rarr: 8594,\n  darr: 8595,\n  harr: 8596,\n  crarr: 8629,\n  lArr: 8656,\n  uArr: 8657,\n  rArr: 8658,\n  dArr: 8659,\n  hArr: 8660,\n  forall: 8704,\n  part: 8706,\n  exist: 8707,\n  empty: 8709,\n  nabla: 8711,\n  isin: 8712,\n  notin: 8713,\n  ni: 8715,\n  prod: 8719,\n  sum: 8721,\n  minus: 8722,\n  lowast: 8727,\n  radic: 8730,\n  prop: 8733,\n  infin: 8734,\n  ang: 8736,\n  and: 8743,\n  or: 8744,\n  cap: 8745,\n  cup: 8746,\n  int: 8747,\n  there4: 8756,\n  sim: 8764,\n  cong: 8773,\n  asymp: 8776,\n  ne: 8800,\n  equiv: 8801,\n  le: 8804,\n  ge: 8805,\n  sub: 8834,\n  sup: 8835,\n  nsub: 8836,\n  sube: 8838,\n  supe: 8839,\n  oplus: 8853,\n  otimes: 8855,\n  perp: 8869,\n  sdot: 8901,\n  lceil: 8968,\n  rceil: 8969,\n  lfloor: 8970,\n  rfloor: 8971,\n  lang: 9001,\n  rang: 9002,\n  loz: 9674,\n  spades: 9824,\n  clubs: 9827,\n  hearts: 9829,\n  diams: 9830\n};\nconst controlCharacters = [\n  8364,\n  129,\n  8218,\n  402,\n  8222,\n  8230,\n  8224,\n  8225,\n  710,\n  8240,\n  352,\n  8249,\n  338,\n  141,\n  381,\n  143,\n  144,\n  8216,\n  8217,\n  8220,\n  8221,\n  8226,\n  8211,\n  8212,\n  732,\n  8482,\n  353,\n  8250,\n  339,\n  157,\n  382,\n  376\n];\nconst entityPattern = new RegExp(\n  '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + keys(htmlEntities).join('|') + '));?',\n  'g'\n);\nconst codePointSupport = isFunction(String.fromCodePoint);\nconst codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\n\nexport function decodeCharacterReferences(html) {\n  return html.replace(entityPattern, (match, entity) => {\n    let code;\n\n    // Handle named entities\n    if (entity[0] !== '#') {\n      code = htmlEntities[entity];\n    } else if (entity[1] === 'x') {\n      code = parseInt(entity.substring(2), 16);\n    } else {\n      code = parseInt(entity.substring(1), 10);\n    }\n\n    if (!code) {\n      return match;\n    }\n\n    return codeToChar(validateCode(code));\n  });\n}\n\nconst lessThan = /</g;\nconst greaterThan = />/g;\nconst amp = /&/g;\nconst invalid = 65533;\n\nexport function escapeHtml(str) {\n  return str\n    .replace(amp, '&amp;')\n    .replace(lessThan, '&lt;')\n    .replace(greaterThan, '&gt;');\n}\n\n// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n// to replace them ourselves\n//\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\n/* istanbul ignore next */\nfunction validateCode(code) {\n  if (!code) {\n    return invalid;\n  }\n\n  // line feed becomes generic whitespace\n  if (code === 10) {\n    return 32;\n  }\n\n  // ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n  if (code < 128) {\n    return code;\n  }\n\n  // code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n  // to correct the mistake or we'll end up with missing  signs and so on\n  if (code <= 159) {\n    return controlCharacters[code - 128];\n  }\n\n  // basic multilingual plane\n  if (code < 55296) {\n    return code;\n  }\n\n  // UTF-16 surrogate halves\n  if (code <= 57343) {\n    return invalid;\n  }\n\n  // rest of the basic multilingual plane\n  if (code <= 65535) {\n    return code;\n  } else if (!codePointSupport) {\n    return invalid;\n  }\n\n  // supplementary multilingual plane 0x10000 - 0x1ffff\n  if (code >= 65536 && code <= 131071) {\n    return code;\n  }\n\n  // supplementary ideographic plane 0x20000 - 0x2ffff\n  if (code >= 131072 && code <= 196607) {\n    return code;\n  }\n\n  return invalid;\n}\n","export default function(camelCaseStr) {\n  return camelCaseStr.replace(/([A-Z])/g, (match, $1) => {\n    return '-' + $1.toLowerCase();\n  });\n}\n","import cleanCss from 'utils/cleanCss';\nimport { isString } from 'utils/is';\n\nconst space = /\\s+/;\n\nexport function readStyle(css) {\n  if (!isString(css)) return {};\n\n  return cleanCss(css, (css, reconstruct) => {\n    return css\n      .split(';')\n      .filter(rule => !!rule.trim())\n      .map(reconstruct)\n      .reduce((rules, rule) => {\n        const i = rule.indexOf(':');\n        const name = rule.substr(0, i).trim();\n        rules[name] = rule.substr(i + 1).trim();\n        return rules;\n      }, {});\n  });\n}\n\nexport function readClass(str) {\n  const list = str.split(space);\n\n  // remove any empty entries\n  let i = list.length;\n  while (i--) {\n    if (!list[i]) list.splice(i, 1);\n  }\n\n  return list;\n}\n","import { html } from 'config/namespaces';\nimport { safeToStringValue } from 'utils/dom';\nimport { arrayContains } from 'utils/array';\nimport noop from 'utils/noop';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport { readStyle, readClass } from 'src/view/helpers/specialAttrs';\nimport { keys as objectKeys } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\n\nconst textTypes = [\n  undefined,\n  'text',\n  'search',\n  'url',\n  'email',\n  'hidden',\n  'password',\n  'search',\n  'reset',\n  'submit'\n];\n\nexport default function getUpdateDelegate(attribute) {\n  const { element, name } = attribute;\n\n  if (name === 'value') {\n    if (attribute.interpolator) attribute.interpolator.bound = true;\n\n    // special case - selects\n    if (element.name === 'select' && name === 'value') {\n      return element.getAttribute('multiple') ? updateMultipleSelectValue : updateSelectValue;\n    }\n\n    if (element.name === 'textarea') return updateStringValue;\n\n    // special case - contenteditable\n    if (element.getAttribute('contenteditable') != null) return updateContentEditableValue;\n\n    // special case - <input>\n    if (element.name === 'input') {\n      const type = element.getAttribute('type');\n\n      // type='file' value='{{fileList}}'>\n      if (type === 'file') return noop; // read-only\n\n      // type='radio' name='{{twoway}}'\n      if (type === 'radio' && element.binding && element.binding.attribute.name === 'name')\n        return updateRadioValue;\n\n      if (~textTypes.indexOf(type)) return updateStringValue;\n    }\n\n    return updateValue;\n  }\n\n  const node = element.node;\n\n  // special case - <input type='radio' name='{{twoway}}' value='foo'>\n  if (attribute.isTwoway && name === 'name') {\n    if (node.type === 'radio') return updateRadioName;\n    if (node.type === 'checkbox') return updateCheckboxName;\n  }\n\n  if (name === 'style') return updateStyleAttribute;\n\n  if (name.indexOf('style-') === 0) return updateInlineStyle;\n\n  // special case - class names. IE fucks things up, again\n  if (name === 'class' && (!node.namespaceURI || node.namespaceURI === html))\n    return updateClassName;\n\n  if (name.indexOf('class-') === 0) return updateInlineClass;\n\n  if (attribute.isBoolean) {\n    const type = element.getAttribute('type');\n    if (attribute.interpolator && name === 'checked' && (type === 'checkbox' || type === 'radio'))\n      attribute.interpolator.bound = true;\n    return updateBoolean;\n  }\n\n  if (attribute.namespace && attribute.namespace !== attribute.node.namespaceURI)\n    return updateNamespacedAttribute;\n\n  return updateAttribute;\n}\n\nfunction updateMultipleSelectValue(reset) {\n  let value = this.getValue();\n\n  if (!isArray(value)) value = [value];\n\n  const options = this.node.options;\n  let i = options.length;\n\n  if (reset) {\n    while (i--) options[i].selected = false;\n  } else {\n    while (i--) {\n      const option = options[i];\n      const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n\n      option.selected = arrayContains(value, optionValue);\n    }\n  }\n}\n\nfunction updateSelectValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    // TODO is locked still a thing?\n    this.node._ractive.value = value;\n\n    const options = this.node.options;\n    let i = options.length;\n    let wasSelected = false;\n\n    if (reset) {\n      while (i--) options[i].selected = false;\n    } else {\n      while (i--) {\n        const option = options[i];\n        const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n        if (option.disabled && option.selected) wasSelected = true;\n\n        if (optionValue == value) {\n          // double equals as we may be comparing numbers with strings\n          option.selected = true;\n          return;\n        }\n      }\n    }\n\n    if (!wasSelected) this.node.selectedIndex = -1;\n  }\n}\n\nfunction updateContentEditableValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    if (reset) this.node.innerHTML = '';\n    else this.node.innerHTML = value === undefined ? '' : value;\n  }\n}\n\nfunction updateRadioValue(reset) {\n  const node = this.node;\n  const wasChecked = node.checked;\n\n  const value = this.getValue();\n\n  if (reset) return (node.checked = false);\n\n  //node.value = this.element.getAttribute( 'value' );\n  node.value = this.node._ractive.value = value;\n  node.checked = this.element.compare(value, this.element.getAttribute('name'));\n\n  // This is a special case - if the input was checked, and the value\n  // changed so that it's no longer checked, the twoway binding is\n  // most likely out of date. To fix it we have to jump through some\n  // hoops... this is a little kludgy but it works\n  if (wasChecked && !node.checked && this.element.binding && this.element.binding.rendered) {\n    this.element.binding.group.model.set(this.element.binding.group.getValue());\n  }\n}\n\nfunction updateValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node.removeAttribute('value');\n      this.node.value = this.node._ractive.value = null;\n    } else {\n      const value = this.getValue();\n\n      this.node.value = this.node._ractive.value = value;\n      this.node.setAttribute('value', safeToStringValue(value));\n    }\n  }\n}\n\nfunction updateStringValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node._ractive.value = '';\n      this.node.removeAttribute('value');\n    } else {\n      const value = this.getValue();\n\n      this.node._ractive.value = value;\n\n      this.node.value = safeToStringValue(value);\n      this.node.setAttribute('value', safeToStringValue(value));\n    }\n  }\n}\n\nfunction updateRadioName(reset) {\n  if (reset) this.node.checked = false;\n  else this.node.checked = this.element.compare(this.getValue(), this.element.binding.getValue());\n}\n\nfunction updateCheckboxName(reset) {\n  const { element, node } = this;\n  const binding = element.binding;\n\n  const value = this.getValue();\n  const valueAttribute = element.getAttribute('value');\n\n  if (reset) {\n    // TODO: WAT?\n  }\n\n  if (!isArray(value)) {\n    binding.isChecked = node.checked = element.compare(value, valueAttribute);\n  } else {\n    let i = value.length;\n    while (i--) {\n      if (element.compare(valueAttribute, value[i])) {\n        binding.isChecked = node.checked = true;\n        return;\n      }\n    }\n    binding.isChecked = node.checked = false;\n  }\n}\n\nfunction updateStyleAttribute(reset) {\n  const props = reset ? {} : readStyle(this.getValue() || '');\n  const style = this.node.style;\n  const keys = objectKeys(props);\n  const prev = this.previous || [];\n\n  let i = 0;\n  while (i < keys.length) {\n    if (keys[i] in style) {\n      const safe = props[keys[i]].replace('!important', '');\n      style.setProperty(keys[i], safe, safe.length !== props[keys[i]].length ? 'important' : '');\n    }\n    i++;\n  }\n\n  // remove now-missing attrs\n  i = prev.length;\n  while (i--) {\n    if (!~keys.indexOf(prev[i]) && prev[i] in style) style.setProperty(prev[i], '', '');\n  }\n\n  this.previous = keys;\n}\n\nfunction updateInlineStyle(reset) {\n  if (!this.style) {\n    this.style = hyphenateCamel(this.name.substr(6));\n  }\n\n  if (reset && this.node.style.getPropertyValue(this.style) !== this.last) return;\n\n  const value = reset ? '' : safeToStringValue(this.getValue());\n  const safe = value.replace('!important', '');\n  this.node.style.setProperty(this.style, safe, safe.length !== value.length ? 'important' : '');\n  this.last = safe;\n}\n\nfunction updateClassName(reset) {\n  const value = reset ? [] : readClass(safeToStringValue(this.getValue()));\n\n  // watch out for werdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const prev = this.previous || attr.slice(0);\n\n  const className = value.concat(attr.filter(c => !~prev.indexOf(c))).join(' ');\n\n  if (className !== cls) {\n    if (!isString(this.node.className)) {\n      this.node.className.baseVal = className;\n    } else {\n      this.node.className = className;\n    }\n  }\n\n  this.previous = value;\n}\n\nfunction updateInlineClass(reset) {\n  const name = this.name.substr(6);\n\n  // watch out for werdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const value = reset ? false : this.getValue();\n\n  if (!this.inlineClass) this.inlineClass = name;\n\n  if (value && !~attr.indexOf(name)) attr.push(name);\n  else if (!value && ~attr.indexOf(name)) attr.splice(attr.indexOf(name), 1);\n\n  if (!isString(this.node.className)) {\n    this.node.className.baseVal = attr.join(' ');\n  } else {\n    this.node.className = attr.join(' ');\n  }\n}\n\nfunction updateBoolean(reset) {\n  // with two-way binding, only update if the change wasn't initiated by the user\n  // otherwise the cursor will often be sent to the wrong place\n  if (!this.locked) {\n    if (reset) {\n      if (this.useProperty) this.node[this.propertyName] = false;\n      this.node.removeAttribute(this.propertyName);\n    } else {\n      if (this.useProperty) {\n        this.node[this.propertyName] = this.getValue();\n      } else {\n        const val = this.getValue();\n        if (val) {\n          this.node.setAttribute(this.propertyName, isString(val) ? val : '');\n        } else {\n          this.node.removeAttribute(this.propertyName);\n        }\n      }\n    }\n  }\n}\n\nfunction updateAttribute(reset) {\n  if (reset) {\n    if (this.node.getAttribute(this.name) === this.value) {\n      this.node.removeAttribute(this.name);\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttribute(this.name, this.value);\n  }\n}\n\nfunction updateNamespacedAttribute(reset) {\n  if (reset) {\n    if (\n      this.value ===\n      this.node.getAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1))\n    ) {\n      this.node.removeAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1));\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttributeNS(\n      this.namespace,\n      this.name.slice(this.name.indexOf(':') + 1),\n      this.value\n    );\n  }\n}\n","export default {\n  'accept-charset': 'acceptCharset',\n  accesskey: 'accessKey',\n  bgcolor: 'bgColor',\n  class: 'className',\n  codebase: 'codeBase',\n  colspan: 'colSpan',\n  contenteditable: 'contentEditable',\n  datetime: 'dateTime',\n  dirname: 'dirName',\n  for: 'htmlFor',\n  'http-equiv': 'httpEquiv',\n  ismap: 'isMap',\n  maxlength: 'maxLength',\n  novalidate: 'noValidate',\n  pubdate: 'pubDate',\n  readonly: 'readOnly',\n  rowspan: 'rowSpan',\n  tabindex: 'tabIndex',\n  usemap: 'useMap'\n};\n","import { doc } from 'config/environment';\nimport { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\n\nconst div = doc ? createElement('div') : null;\n\nlet attributes = false;\nexport function inAttributes() {\n  return attributes;\n}\n\nexport default class ConditionalAttribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.attributes = [];\n\n    this.owner = options.owner;\n\n    this.fragment = new Fragment({\n      ractive: this.ractive,\n      owner: this,\n      template: this.template\n    });\n\n    // this fragment can't participate in node-y things\n    this.fragment.findNextNode = noop;\n\n    this.dirty = false;\n  }\n\n  bind() {\n    this.fragment.bind();\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.owner.bubble();\n    }\n  }\n\n  destroyed() {\n    this.unrender();\n  }\n\n  render() {\n    this.node = this.owner.node;\n    if (this.node) {\n      this.isSvg = this.node.namespaceURI === svg;\n    }\n\n    attributes = true;\n    if (!this.rendered) this.fragment.render();\n\n    this.rendered = true;\n    this.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n    this.update();\n    attributes = false;\n  }\n\n  toString() {\n    return this.fragment.toString();\n  }\n\n  unbind() {\n    this.fragment.unbind();\n  }\n\n  unrender() {\n    this.rendered = false;\n    this.fragment.unrender();\n  }\n\n  update() {\n    let str;\n    let attrs;\n\n    if (this.dirty) {\n      this.dirty = false;\n\n      const current = attributes;\n      attributes = true;\n      this.fragment.update();\n\n      if (this.rendered && this.node) {\n        str = this.fragment.toString();\n\n        attrs = parseAttributes(str, this.isSvg);\n\n        // any attributes that previously existed but no longer do\n        // must be removed\n        this.attributes.filter(a => notIn(attrs, a)).forEach(a => {\n          this.node.removeAttribute(a.name);\n        });\n\n        attrs.forEach(a => {\n          this.node.setAttribute(a.name, a.value);\n        });\n\n        this.attributes = attrs;\n      }\n\n      attributes = current || false;\n    }\n  }\n}\n\nconst onlyWhitespace = /^\\s*$/;\nfunction parseAttributes(str, isSvg) {\n  if (onlyWhitespace.test(str)) return [];\n  const tagName = isSvg ? 'svg' : 'div';\n  return str\n    ? (div.innerHTML = `<${tagName} ${str}></${tagName}>`) && toArray(div.childNodes[0].attributes)\n    : [];\n}\n\nfunction notIn(haystack, needle) {\n  let i = haystack.length;\n\n  while (i--) {\n    if (haystack[i].name === needle.name) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import { INTERPOLATOR } from 'config/types';\nimport namespaces from 'config/namespaces';\nimport { safeAttributeString } from 'utils/dom';\nimport { booleanAttributes } from 'utils/html';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\nimport findElement from '../shared/findElement';\nimport getUpdateDelegate from './attribute/getUpdateDelegate';\nimport propertyNames from './attribute/propertyNames';\nimport { inAttributes } from './ConditionalAttribute';\nimport { isArray, isString } from 'utils/is';\n\nfunction lookupNamespace(node, prefix) {\n  const qualified = `xmlns:${prefix}`;\n\n  while (node) {\n    if (node.hasAttribute && node.hasAttribute(qualified)) return node.getAttribute(qualified);\n    node = node.parentNode;\n  }\n\n  return namespaces[prefix];\n}\n\nlet attribute = false;\nexport function inAttribute() {\n  return attribute;\n}\n\nexport default class Attribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n    this.namespace = null;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = options.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.rendered = false;\n    this.updateDelegate = null;\n    this.fragment = null;\n\n    this.element.attributeByName[this.name] = this;\n\n    if (!isArray(options.template.f)) {\n      this.value = options.template.f;\n      if (this.value === 0) {\n        this.value = '';\n      } else if (this.value === undefined) {\n        this.value = true;\n      }\n    } else {\n      this.fragment = new Fragment({\n        owner: this,\n        template: options.template.f\n      });\n    }\n\n    this.interpolator =\n      this.fragment &&\n      this.fragment.items.length === 1 &&\n      this.fragment.items[0].type === INTERPOLATOR &&\n      this.fragment.items[0];\n\n    if (this.interpolator) this.interpolator.owner = this;\n  }\n\n  bind() {\n    if (this.fragment) {\n      this.fragment.bind();\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.up.bubble();\n      this.element.bubble();\n      this.dirty = true;\n    }\n  }\n\n  firstNode() {}\n\n  getString() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.toString()\n      : this.value != null\n        ? '' + this.value\n        : '';\n    attribute = false;\n    return value;\n  }\n\n  // TODO could getValue ever be called for a static attribute,\n  // or can we assume that this.fragment exists?\n  getValue() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.valueOf()\n      : booleanAttributes.test(this.name)\n        ? true\n        : this.value;\n    attribute = false;\n    return value;\n  }\n\n  render() {\n    const node = this.element.node;\n    this.node = node;\n\n    // should we use direct property access, or setAttribute?\n    if (!node.namespaceURI || node.namespaceURI === namespaces.html) {\n      this.propertyName = propertyNames[this.name] || this.name;\n\n      if (node[this.propertyName] !== undefined) {\n        this.useProperty = true;\n      }\n\n      // is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n      // node.selected = true rather than node.setAttribute( 'selected', '' )\n      if (booleanAttributes.test(this.name) || this.isTwoway) {\n        this.isBoolean = true;\n      }\n\n      if (this.propertyName === 'value') {\n        node._ractive.value = this.value;\n      }\n    }\n\n    if (node.namespaceURI) {\n      const index = this.name.indexOf(':');\n      if (index !== -1) {\n        this.namespace = lookupNamespace(node, this.name.slice(0, index));\n      } else {\n        this.namespace = node.namespaceURI;\n      }\n    }\n\n    this.rendered = true;\n    this.updateDelegate = getUpdateDelegate(this);\n    this.updateDelegate();\n  }\n\n  toString() {\n    if (inAttributes()) return '';\n    attribute = true;\n\n    const value = this.getValue();\n\n    // Special case - select and textarea values (should not be stringified)\n    if (\n      this.name === 'value' &&\n      (this.element.getAttribute('contenteditable') !== undefined ||\n        (this.element.name === 'select' || this.element.name === 'textarea'))\n    ) {\n      return;\n    }\n\n    // Special case  bound radio `name` attributes\n    if (\n      this.name === 'name' &&\n      this.element.name === 'input' &&\n      this.interpolator &&\n      this.element.getAttribute('type') === 'radio'\n    ) {\n      return `name=\"{{${this.interpolator.model.getKeypath()}}}\"`;\n    }\n\n    // Special case - style and class attributes and directives\n    if (\n      this.owner === this.element &&\n      (this.name === 'style' || this.name === 'class' || this.style || this.inlineClass)\n    ) {\n      return;\n    }\n\n    if (\n      !this.rendered &&\n      this.owner === this.element &&\n      (!this.name.indexOf('style-') || !this.name.indexOf('class-'))\n    ) {\n      if (!this.name.indexOf('style-')) {\n        this.style = hyphenateCamel(this.name.substr(6));\n      } else {\n        this.inlineClass = this.name.substr(6);\n      }\n\n      return;\n    }\n\n    if (booleanAttributes.test(this.name))\n      return value\n        ? isString(value)\n          ? `${this.name}=\"${safeAttributeString(value)}\"`\n          : this.name\n        : '';\n    if (value == null) return '';\n\n    const str = safeAttributeString(this.getString());\n    attribute = false;\n\n    return str ? `${this.name}=\"${str}\"` : this.name;\n  }\n\n  unbind() {\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender() {\n    this.updateDelegate(true);\n\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      let binding;\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      if (this.rendered) this.updateDelegate();\n      if (this.isTwoway && !this.locked) {\n        this.interpolator.twowayBinding.lastVal(true, this.interpolator.model.get());\n      } else if (this.name === 'value' && (binding = this.element.binding)) {\n        // special case: name bound element with dynamic value\n        const attr = binding.attribute;\n        if (attr && !attr.dirty && attr.rendered) {\n          this.element.binding.attribute.updateDelegate();\n        }\n      }\n    }\n  }\n}\n","import { INTERPOLATOR, ELEMENT } from 'config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport { isArray } from 'utils/is';\n\nexport default class BindingFlag extends Item {\n  constructor(options) {\n    super(options);\n\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.flag = options.template.v === 'l' ? 'lazy' : 'twoway';\n    this.bubbler = this.owner === this.element ? this.element : this.up;\n\n    if (this.element.type === ELEMENT) {\n      if (isArray(options.template.f)) {\n        this.fragment = new Fragment({\n          owner: this,\n          template: options.template.f\n        });\n      }\n\n      this.interpolator =\n        this.fragment &&\n        this.fragment.items.length === 1 &&\n        this.fragment.items[0].type === INTERPOLATOR &&\n        this.fragment.items[0];\n    }\n  }\n\n  bind() {\n    if (this.fragment) this.fragment.bind();\n    set(this, this.getValue(), true);\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.bubbler.bubble();\n      this.dirty = true;\n    }\n  }\n\n  getValue() {\n    if (this.fragment) return this.fragment.valueOf();\n    else if ('value' in this) return this.value;\n    else if ('f' in this.template) return this.template.f;\n    else return true;\n  }\n\n  render() {\n    set(this, this.getValue(), true);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    if (this.fragment) this.fragment.unbind();\n\n    delete this.element[this.flag];\n  }\n\n  unrender() {\n    if (this.element.rendered) this.element.recreateTwowayBinding();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      set(this, this.getValue(), true);\n    }\n  }\n}\n\nfunction set(flag, value, update) {\n  if (value === 0) {\n    flag.value = true;\n  } else if (value === 'true') {\n    flag.value = true;\n  } else if (value === 'false' || value === '0') {\n    flag.value = false;\n  } else {\n    flag.value = value;\n  }\n\n  const current = flag.element[flag.flag];\n  flag.element[flag.flag] = flag.value;\n  if (update && !flag.element.attributes.binding && current !== flag.value) {\n    flag.element.recreateTwowayBinding();\n  }\n\n  return flag.value;\n}\n","import Item from './shared/Item';\nimport noop from 'utils/noop';\nimport { detachNode } from 'utils/dom';\nimport { doc } from 'config/environment';\nimport { assign, create } from 'utils/object';\n\nexport default function Comment(options) {\n  Item.call(this, options);\n}\n\nconst proto = create(Item.prototype);\n\nassign(proto, {\n  bind: noop,\n  unbind: noop,\n  update: noop,\n\n  detach() {\n    return detachNode(this.node);\n  },\n\n  firstNode() {\n    return this.node;\n  },\n\n  render(target) {\n    this.rendered = true;\n\n    this.node = doc.createComment(this.template.c);\n    target.appendChild(this.node);\n  },\n\n  toString() {\n    return `<!-- ${this.template.c} -->`;\n  },\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n});\n\nComment.prototype = proto;\n","import Hook from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\nimport { cancel } from 'shared/methodCallers';\nimport { warnIfDebug } from 'utils/log';\n\nconst teardownHook = new Hook('teardown');\nconst destructHook = new Hook('destruct');\n\n// Teardown. This goes through the root fragment and all its children, removing observers\n// and generally cleaning up after itself\n\nexport default function Ractive$teardown() {\n  if (this.torndown) {\n    warnIfDebug('ractive.teardown() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  this.shouldDestroy = true;\n  return teardown(this, () => (this.fragment.rendered ? this.unrender() : Promise.resolve()));\n}\n\nexport function teardown(instance, getPromise) {\n  instance.torndown = true;\n  instance.fragment.unbind();\n  instance._observers.slice().forEach(cancel);\n\n  if (instance.el && instance.el.__ractive_instances__) {\n    removeFromArray(instance.el.__ractive_instances__, instance);\n  }\n\n  const promise = getPromise();\n\n  teardownHook.fire(instance);\n\n  promise.then(() => {\n    destructHook.fire(instance);\n    instance.viewmodel.teardown();\n  });\n\n  return promise;\n}\n","import { SharedModel } from './SharedModel';\nimport { Missing } from '../LinkModel';\nimport { create } from 'utils/object';\n\nexport default class RactiveModel extends SharedModel {\n  constructor(ractive) {\n    super(ractive, '@this');\n    this.ractive = ractive;\n  }\n\n  joinKey(key) {\n    const model = super.joinKey(key);\n\n    if ((key === 'root' || key === 'parent') && !model.isLink) return initLink(model, key);\n    else if (key === 'data') return this.ractive.viewmodel;\n    else if (key === 'cssData') return this.ractive.constructor._cssModel;\n\n    return model;\n  }\n}\n\nfunction initLink(model, key) {\n  model.applyValue = function(value) {\n    this.parent.value[key] = value;\n    if (value && value.viewmodel) {\n      this.link(value.viewmodel.getRactiveModel(), key);\n      this._link.markedAll();\n    } else {\n      this.link(create(Missing), key);\n      this._link.markedAll();\n    }\n  };\n\n  model.applyValue(model.parent.ractive[key], key);\n  model._link.set = v => model.applyValue(v);\n  model._link.applyValue = v => model.applyValue(v);\n  return model._link;\n}\n","import { capture } from 'src/global/capture';\nimport Computation from './Computation';\nimport Model from './Model';\nimport { handleChange, mark } from 'shared/methodCallers';\nimport RactiveModel from './specials/RactiveModel';\nimport SharedModel, { GlobalModel } from './specials/SharedModel';\nimport { splitKeypath, escapeKey, unescapeKey } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\nimport { hasOwn, keys as objectKeys } from 'utils/object';\n\nexport default class RootModel extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.ractive = options.ractive; // TODO sever this link\n\n    this.value = options.data;\n    this.adaptors = options.adapt;\n    this.adapt();\n\n    this.computationContext = options.ractive;\n    this.computations = {};\n  }\n\n  attached(fragment) {\n    attachImplicits(this, fragment);\n  }\n\n  compute(key, signature) {\n    const computation = new Computation(this, signature, key);\n    this.computations[escapeKey(key)] = computation;\n\n    return computation;\n  }\n\n  createLink(keypath, target, targetPath, options) {\n    const keys = splitKeypath(keypath);\n\n    let model = this;\n    while (keys.length) {\n      const key = keys.shift();\n      model = model.childByKey[key] || model.joinKey(key);\n    }\n\n    return model.link(target, targetPath, options);\n  }\n\n  detached() {\n    detachImplicits(this);\n  }\n\n  get(shouldCapture, options) {\n    if (shouldCapture) capture(this);\n\n    if (!options || options.virtual !== false) {\n      const result = this.getVirtual();\n      const keys = objectKeys(this.computations);\n      let i = keys.length;\n      while (i--) {\n        result[keys[i]] = this.computations[keys[i]].get();\n      }\n\n      return result;\n    } else {\n      return this.value;\n    }\n  }\n\n  getKeypath() {\n    return '';\n  }\n\n  getRactiveModel() {\n    return this.ractiveModel || (this.ractiveModel = new RactiveModel(this.ractive));\n  }\n\n  getValueChildren() {\n    const children = super.getValueChildren(this.value);\n\n    this.children.forEach(child => {\n      if (child._link) {\n        const idx = children.indexOf(child);\n        if (~idx) children.splice(idx, 1, child._link);\n        else children.push(child._link);\n      }\n    });\n\n    for (const k in this.computations) {\n      children.push(this.computations[k]);\n    }\n\n    return children;\n  }\n\n  has(key) {\n    const value = this.value;\n    let unescapedKey = unescapeKey(key);\n\n    if (\n      unescapedKey === '@this' ||\n      unescapedKey === '@global' ||\n      unescapedKey === '@shared' ||\n      unescapedKey === '@style'\n    )\n      return true;\n    if (unescapedKey[0] === '~' && unescapedKey[1] === '/') unescapedKey = unescapedKey.slice(2);\n    if (key === '' || hasOwn(value, unescapedKey)) return true;\n\n    // mappings/links and computations\n    if (\n      key in this.computations ||\n      (this.childByKey[unescapedKey] && this.childByKey[unescapedKey]._link)\n    )\n      return true;\n\n    // We climb up the constructor chain to find if one of them contains the unescapedKey\n    let constructor = value.constructor;\n    while (constructor !== Function && constructor !== Array && constructor !== Object) {\n      if (hasOwn(constructor.prototype, unescapedKey)) return true;\n      constructor = constructor.constructor;\n    }\n\n    return false;\n  }\n\n  joinKey(key, opts) {\n    if (key[0] === '@') {\n      if (key === '@this' || key === '@') return this.getRactiveModel();\n      if (key === '@global') return GlobalModel;\n      if (key === '@shared') return SharedModel;\n      if (key === '@style') return this.getRactiveModel().joinKey('cssData');\n      return;\n    }\n\n    if (key[0] === '~' && key[1] === '/') key = key.slice(2);\n\n    return hasOwn(this.computations, key) ? this.computations[key] : super.joinKey(key, opts);\n  }\n\n  set(value) {\n    // TODO wrapping root node is a baaaad idea. We should prevent this\n    const wrapper = this.wrapper;\n    if (wrapper) {\n      const shouldTeardown = !wrapper.reset || wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        wrapper.teardown();\n        this.wrapper = null;\n        this.value = value;\n        this.adapt();\n      }\n    } else {\n      this.value = value;\n      this.adapt();\n    }\n\n    this.deps.forEach(handleChange);\n    this.children.forEach(mark);\n  }\n\n  retrieve() {\n    return this.wrapper ? this.wrapper.get() : this.value;\n  }\n\n  teardown() {\n    super.teardown();\n    for (const k in this.computations) {\n      this.computations[k].teardown();\n    }\n    this.ractiveModel && this.ractiveModel.teardown();\n  }\n}\nRootModel.prototype.update = noop;\n\nfunction attachImplicits(model, fragment) {\n  if (model._link && model._link.implicit && model._link.isDetached()) {\n    model.attach(fragment);\n  }\n\n  // look for virtual children to relink and cascade\n  for (const k in model.childByKey) {\n    if (k in model.value) {\n      attachImplicits(model.childByKey[k], fragment);\n    } else if (!model.childByKey[k]._link || model.childByKey[k]._link.isDetached()) {\n      const mdl = resolveReference(fragment, k);\n      if (mdl) {\n        model.childByKey[k].link(mdl, k, { implicit: true });\n      }\n    }\n  }\n}\n\nfunction detachImplicits(model) {\n  if (model._link && model._link.implicit) {\n    model.unlink();\n  }\n\n  for (const k in model.childByKey) {\n    detachImplicits(model.childByKey[k]);\n  }\n}\n","import { fatal, warnIfDebug, welcome } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { ensureArray, combine } from 'utils/array';\nimport { findInViewHierarchy } from 'shared/registry';\nimport dataConfigurator from './config/custom/data';\nimport RootModel from 'src/model/RootModel';\nimport Hook from 'src/events/Hook';\nimport getComputationSignature from './helpers/getComputationSignature';\nimport subscribe from './helpers/subscribe';\nimport Ractive from '../Ractive';\nimport { ATTRIBUTE, INTERPOLATOR } from 'config/types';\nimport { assign, create, hasOwn } from 'utils/object';\nimport { isString } from 'utils/is';\n\nconst constructHook = new Hook('construct');\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'decorators',\n  'easing',\n  'events',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nlet uid = 0;\n\nexport default function construct(ractive, options) {\n  if (Ractive.DEBUG) welcome();\n\n  initialiseProperties(ractive);\n  handleAttributes(ractive);\n\n  // set up event subscribers\n  subscribe(ractive, options, 'on');\n\n  // if there's not a delegation setting, inherit from parent if it's not default\n  if (\n    !hasOwn(options, 'delegate') &&\n    ractive.parent &&\n    ractive.parent.delegate !== ractive.delegate\n  ) {\n    ractive.delegate = false;\n  }\n\n  // TODO don't allow `onconstruct` with `new Ractive()`, there's no need for it\n  constructHook.fire(ractive, options);\n\n  // Add registries\n  let i = registryNames.length;\n  while (i--) {\n    const name = registryNames[i];\n    ractive[name] = assign(create(ractive.constructor[name] || null), options[name]);\n  }\n\n  if (ractive._attributePartial) {\n    ractive.partials['extra-attributes'] = ractive._attributePartial;\n    delete ractive._attributePartial;\n  }\n\n  // Create a viewmodel\n  const viewmodel = new RootModel({\n    adapt: getAdaptors(ractive, ractive.adapt, options),\n    data: dataConfigurator.init(ractive.constructor, ractive, options),\n    ractive\n  });\n\n  // once resolved, share the adaptors array between the root model and instance\n  ractive.adapt = viewmodel.adaptors;\n\n  ractive.viewmodel = viewmodel;\n\n  // Add computed properties\n  const computed = assign(create(ractive.constructor.prototype.computed), options.computed);\n\n  for (const key in computed) {\n    if (key === '__proto__') continue;\n    const signature = getComputationSignature(ractive, key, computed[key]);\n    viewmodel.compute(key, signature);\n  }\n}\n\nfunction getAdaptors(ractive, protoAdapt, options) {\n  protoAdapt = protoAdapt.map(lookup);\n  const adapt = ensureArray(options.adapt).map(lookup);\n\n  const srcs = [protoAdapt, adapt];\n  if (ractive.parent && !ractive.isolated) {\n    srcs.push(ractive.parent.viewmodel.adaptors);\n  }\n\n  return combine.apply(null, srcs);\n\n  function lookup(adaptor) {\n    if (isString(adaptor)) {\n      adaptor = findInViewHierarchy('adaptors', ractive, adaptor);\n\n      if (!adaptor) {\n        fatal(missingPlugin(adaptor, 'adaptor'));\n      }\n    }\n\n    return adaptor;\n  }\n}\n\nfunction initialiseProperties(ractive) {\n  // Generate a unique identifier, for places where you'd use a weak map if it\n  // existed\n  ractive._guid = 'r-' + uid++;\n\n  // events\n  ractive._subs = create(null);\n  ractive._nsSubs = 0;\n\n  // storage for item configuration from instantiation to reset,\n  // like dynamic functions or original values\n  ractive._config = {};\n\n  // events\n  ractive.event = null;\n  ractive._eventQueue = [];\n\n  // observers\n  ractive._observers = [];\n\n  // external children\n  ractive._children = [];\n  ractive._children.byName = {};\n  ractive.children = ractive._children;\n\n  if (!ractive.component) {\n    ractive.root = ractive;\n    ractive.parent = ractive.container = null; // TODO container still applicable?\n  }\n}\n\nfunction handleAttributes(ractive) {\n  const component = ractive.component;\n  const attributes = ractive.constructor.attributes;\n\n  if (attributes && component) {\n    const tpl = component.template;\n    const attrs = tpl.m ? tpl.m.slice() : [];\n\n    // grab all of the passed attribute names\n    const props = attrs.filter(a => a.t === ATTRIBUTE).map(a => a.n);\n\n    // warn about missing requireds\n    attributes.required.forEach(p => {\n      if (!~props.indexOf(p)) {\n        warnIfDebug(`Component '${component.name}' requires attribute '${p}' to be provided`);\n      }\n    });\n\n    // set up a partial containing non-property attributes\n    const all = attributes.optional.concat(attributes.required);\n    const partial = [];\n    let i = attrs.length;\n    while (i--) {\n      const a = attrs[i];\n      if (a.t === ATTRIBUTE && !~all.indexOf(a.n)) {\n        if (attributes.mapAll) {\n          // map the attribute if requested and make the extra attribute in the partial refer to the mapping\n          partial.unshift({\n            t: ATTRIBUTE,\n            n: a.n,\n            f: [{ t: INTERPOLATOR, r: `~/${a.n}` }]\n          });\n        } else {\n          // transfer the attribute to the extra attributes partal\n          partial.unshift(attrs.splice(i, 1)[0]);\n        }\n      }\n    }\n\n    if (partial.length) component.template = { t: tpl.t, e: tpl.e, f: tpl.f, m: attrs, p: tpl.p };\n    ractive._attributePartial = partial;\n  }\n}\n","import runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\nimport { bind, render as callRender, unbind, unrender, update } from 'shared/methodCallers';\nimport { teardown } from 'src/Ractive/prototype/teardown';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { warnIfDebug } from 'utils/log';\nimport { createDocumentFragment } from 'utils/dom';\nimport {\n  ANCHOR,\n  ATTRIBUTE,\n  BINDING_FLAG,\n  COMPONENT,\n  DECORATOR,\n  EVENT,\n  TRANSITION,\n  YIELDER\n} from 'config/types';\nimport construct from 'src/Ractive/construct';\nimport initialise from 'src/Ractive/initialise';\nimport render from 'src/Ractive/render';\nimport Item from './shared/Item';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { assign, create } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\n\nexport default class Component extends Item {\n  constructor(options, ComponentConstructor) {\n    super(options);\n    let template = options.template;\n    this.isAnchor = template.t === ANCHOR;\n    this.type = this.isAnchor ? ANCHOR : COMPONENT; // override ELEMENT from super\n    let attrs = template.m;\n\n    const partials = template.p || {};\n    if (!('content' in partials)) partials.content = template.f || [];\n    this._partials = partials; // TEMP\n\n    if (this.isAnchor) {\n      this.name = template.n;\n\n      this.addChild = addChild;\n      this.removeChild = removeChild;\n    } else {\n      const instance = create(ComponentConstructor.prototype);\n\n      this.instance = instance;\n      this.name = template.e;\n\n      if (instance.el) {\n        warnIfDebug(\n          `The <${this.name}> component has a default 'el' property; it has been disregarded`\n        );\n      }\n\n      // find container\n      let fragment = options.up;\n      let container;\n      while (fragment) {\n        if (fragment.owner.type === YIELDER) {\n          container = fragment.owner.container;\n          break;\n        }\n\n        fragment = fragment.parent;\n      }\n\n      // add component-instance-specific properties\n      instance.parent = this.up.ractive;\n      instance.container = container || null;\n      instance.root = instance.parent.root;\n      instance.component = this;\n\n      construct(this.instance, { partials });\n\n      // these can be modified during construction\n      template = this.template;\n      attrs = template.m;\n\n      // allow components that are so inclined to add programmatic mappings\n      if (isArray(this.mappings)) {\n        attrs = (attrs || []).concat(this.mappings);\n      } else if (isString(this.mappings)) {\n        attrs = (attrs || []).concat(parser.parse(this.mappings, { attributes: true }).t);\n      }\n\n      // for hackability, this could be an open option\n      // for any ractive instance, but for now, just\n      // for components and just for ractive...\n      instance._inlinePartials = partials;\n    }\n\n    this.attributeByName = {};\n    this.attributes = [];\n\n    if (attrs) {\n      const leftovers = [];\n      attrs.forEach(template => {\n        switch (template.t) {\n          case ATTRIBUTE:\n          case EVENT:\n            this.attributes.push(\n              createItem({\n                owner: this,\n                up: this.up,\n                template\n              })\n            );\n            break;\n\n          case TRANSITION:\n          case BINDING_FLAG:\n          case DECORATOR:\n            break;\n\n          default:\n            leftovers.push(template);\n            break;\n        }\n      });\n\n      if (leftovers.length) {\n        this.attributes.push(\n          new ConditionalAttribute({\n            owner: this,\n            up: this.up,\n            template: leftovers\n          })\n        );\n      }\n    }\n\n    this.eventHandlers = [];\n  }\n\n  bind() {\n    if (!this.isAnchor) {\n      this.attributes.forEach(bind);\n      this.eventHandlers.forEach(bind);\n\n      initialise(\n        this.instance,\n        {\n          partials: this._partials\n        },\n        {\n          cssIds: this.up.cssIds\n        }\n      );\n\n      this.bound = true;\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (!this.isAnchor && this.instance.fragment) this.instance.fragment.destroyed();\n  }\n\n  detach() {\n    if (this.isAnchor) {\n      if (this.instance) return this.instance.fragment.detach();\n      return createDocumentFragment();\n    }\n\n    return this.instance.fragment.detach();\n  }\n\n  find(selector, options) {\n    if (this.instance) return this.instance.fragment.find(selector, options);\n  }\n\n  findAll(selector, options) {\n    if (this.instance) this.instance.fragment.findAll(selector, options);\n  }\n\n  findComponent(name, options) {\n    if (!name || this.name === name) return this.instance;\n\n    if (this.instance.fragment) {\n      return this.instance.fragment.findComponent(name, options);\n    }\n  }\n\n  findAllComponents(name, options) {\n    const { result } = options;\n\n    if (this.instance && (!name || this.name === name)) {\n      result.push(this.instance);\n    }\n\n    if (this.instance) this.instance.findAllComponents(name, options);\n  }\n\n  firstNode(skipParent) {\n    if (this.instance) return this.instance.fragment.firstNode(skipParent);\n  }\n\n  getContext(...assigns) {\n    assigns.unshift(this.instance);\n    return getRactiveContext.apply(null, assigns);\n  }\n\n  render(target, occupants) {\n    if (this.isAnchor) {\n      this.rendered = true;\n      this.target = target;\n\n      if (!checking.length) {\n        checking.push(this.ractive);\n        if (occupants) {\n          this.occupants = occupants;\n          checkAnchors();\n          this.occupants = null;\n        } else {\n          runloop.scheduleTask(checkAnchors, true);\n        }\n      }\n    } else {\n      this.attributes.forEach(callRender);\n      this.eventHandlers.forEach(callRender);\n\n      render(this.instance, target, null, occupants);\n\n      this.rendered = true;\n    }\n  }\n\n  toString() {\n    if (this.instance) return this.instance.toHTML();\n  }\n\n  unbind() {\n    if (!this.isAnchor) {\n      this.bound = false;\n\n      this.attributes.forEach(unbind);\n\n      teardown(this.instance, () => runloop.promise());\n    }\n  }\n\n  unrender(shouldDestroy) {\n    this.shouldDestroy = shouldDestroy;\n\n    if (this.isAnchor) {\n      if (this.item) unrenderItem(this, this.item);\n      this.target = null;\n      if (!checking.length) {\n        checking.push(this.ractive);\n        runloop.scheduleTask(checkAnchors, true);\n      }\n    } else {\n      this.instance.unrender();\n      this.instance.el = this.instance.target = null;\n      this.attributes.forEach(unrender);\n      this.eventHandlers.forEach(unrender);\n    }\n\n    this.rendered = false;\n  }\n\n  update() {\n    this.dirty = false;\n    if (this.instance) {\n      this.instance.fragment.update();\n      this.attributes.forEach(update);\n      this.eventHandlers.forEach(update);\n    }\n  }\n}\n\nfunction addChild(meta) {\n  if (this.item) this.removeChild(this.item);\n\n  const child = meta.instance;\n  meta.anchor = this;\n\n  meta.up = this.up;\n  meta.name = meta.nameOption || this.name;\n  this.name = meta.name;\n\n  if (!child.isolated) child.viewmodel.attached(this.up);\n\n  // render as necessary\n  if (this.rendered) {\n    renderItem(this, meta);\n  }\n}\n\nfunction removeChild(meta) {\n  // unrender as necessary\n  if (this.item === meta) {\n    unrenderItem(this, meta);\n    this.name = this.template.n;\n  }\n}\n\nfunction renderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = false;\n  meta.up = anchor.up;\n\n  anchor.item = meta;\n  anchor.instance = meta.instance;\n  const nextNode = anchor.up.findNextNode(anchor);\n\n  if (meta.instance.fragment.rendered) {\n    meta.instance.unrender();\n  }\n\n  meta.partials = meta.instance.partials;\n  meta.instance.partials = assign(create(meta.partials), meta.partials, anchor._partials);\n\n  meta.instance.fragment.unbind();\n  meta.instance.fragment.componentParent = anchor.up;\n  meta.instance.fragment.bind(meta.instance.viewmodel);\n\n  anchor.attributes.forEach(bind);\n  anchor.eventHandlers.forEach(bind);\n  anchor.attributes.forEach(callRender);\n  anchor.eventHandlers.forEach(callRender);\n\n  const target = anchor.up.findParentNode();\n  render(meta.instance, target, target.contains(nextNode) ? nextNode : null, anchor.occupants);\n\n  if (meta.lastBound !== anchor) {\n    meta.lastBound = anchor;\n  }\n}\n\nfunction unrenderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = true;\n  meta.instance.unrender();\n\n  anchor.eventHandlers.forEach(unrender);\n  anchor.attributes.forEach(unrender);\n  anchor.eventHandlers.forEach(unbind);\n  anchor.attributes.forEach(unbind);\n\n  meta.instance.el = meta.instance.anchor = null;\n  meta.instance.fragment.componentParent = null;\n  meta.up = null;\n  meta.anchor = null;\n  anchor.item = null;\n  anchor.instance = null;\n}\n\nlet checking = [];\nexport function checkAnchors() {\n  const list = checking;\n  checking = [];\n\n  list.forEach(updateAnchors);\n}\n","import { findInViewHierarchy } from 'shared/registry';\nimport { warnOnce } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport noop from 'utils/noop';\nimport runloop from 'src/global/runloop';\nimport { rebindMatch } from 'src/shared/rebind';\nimport findElement from '../shared/findElement';\nimport { setupArgsFn, teardownArgsFn } from '../shared/directiveArgs';\n\nconst missingDecorator = {\n  update: noop,\n  teardown: noop\n};\n\nexport default class Decorator {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.up = options.up || this.owner.up;\n    this.ractive = this.owner.ractive;\n    const template = (this.template = options.template);\n\n    this.name = template.n;\n\n    this.node = null;\n    this.handle = null;\n\n    this.element.decorators.push(this);\n  }\n\n  bind() {\n    setupArgsFn(this, this.template, this.up, { register: true });\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      // decorators may be owned directly by an element or by a fragment if conditional\n      this.owner.bubble();\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n    this.shouldDestroy = true;\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebind(next, previous, safe) {\n    const idx = this.models.indexOf(previous);\n    if (!~idx) return;\n\n    next = rebindMatch(this.template.f.r[idx], next, previous);\n    if (next === previous) return;\n\n    previous.unregister(this);\n    this.models.splice(idx, 1, next);\n    if (next) next.addShuffleRegister(this, 'mark');\n\n    if (!safe) this.bubble();\n  }\n\n  render() {\n    this.shouldDestroy = false;\n    if (this.handle) this.unrender();\n    runloop.scheduleTask(() => {\n      const fn = findInViewHierarchy('decorators', this.ractive, this.name);\n\n      if (!fn) {\n        warnOnce(missingPlugin(this.name, 'decorator'));\n        this.handle = missingDecorator;\n        return;\n      }\n\n      this.node = this.element.node;\n\n      let args;\n      if (this.fn) {\n        args = this.models.map(model => {\n          if (!model) return undefined;\n\n          return model.get();\n        });\n        args = this.fn.apply(this.ractive, args);\n      }\n\n      this.handle = fn.apply(this.ractive, [this.node].concat(args));\n\n      if (!this.handle || !this.handle.teardown) {\n        throw new Error(\n          `The '${this.name}' decorator must return an object with a teardown method`\n        );\n      }\n\n      // watch out for decorators that cause their host element to be unrendered\n      if (this.shouldDestroy) this.destroyed();\n    }, true);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    teardownArgsFn(this, this.template);\n  }\n\n  unrender(shouldDestroy) {\n    if ((!shouldDestroy || this.element.rendered) && this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n  }\n\n  update() {\n    const instance = this.handle;\n\n    if (!this.dirty) {\n      if (instance && instance.invalidate) {\n        runloop.scheduleTask(() => instance.invalidate(), true);\n      }\n      return;\n    }\n\n    this.dirty = false;\n\n    if (instance) {\n      if (!instance.update) {\n        this.unrender();\n        this.render();\n      } else {\n        const args = this.models.map(model => model && model.get());\n        instance.update.apply(this.ractive, this.fn.apply(this.ractive, args));\n      }\n    }\n  }\n}\n","import noop from 'utils/noop';\nimport Item from './shared/Item';\n\nexport default class Doctype extends Item {\n  toString() {\n    return '<!DOCTYPE' + this.template.a + '>';\n  }\n}\n\nconst proto = Doctype.prototype;\nproto.bind = proto.render = proto.teardown = proto.unbind = proto.unrender = proto.update = noop;\n","// Error messages that are used (or could be) in multiple places\nexport const badArguments = 'Bad arguments';\nexport const noRegistryFunctionReturn =\n  'A function was specified for \"%s\" %s, but no %s was returned';\nexport const missingPlugin = (name, type) =>\n  `Missing \"${name}\" ${type} plugin. You may need to download a plugin via http://ractive.js.org/integrations/#${type}s`;\n","import { isArray, isObject, isNumeric } from 'utils/is';\nimport interpolate from 'shared/interpolate';\nimport { hasOwn } from 'utils/object';\n\nconst interpolators = {\n  number(from, to) {\n    if (!isNumeric(from) || !isNumeric(to)) {\n      return null;\n    }\n\n    from = +from;\n    to = +to;\n\n    const delta = to - from;\n\n    if (!delta) {\n      return function() {\n        return from;\n      };\n    }\n\n    return function(t) {\n      return from + t * delta;\n    };\n  },\n\n  array(from, to) {\n    let len, i;\n\n    if (!isArray(from) || !isArray(to)) {\n      return null;\n    }\n\n    const intermediate = [];\n    const interpolators = [];\n\n    i = len = Math.min(from.length, to.length);\n    while (i--) {\n      interpolators[i] = interpolate(from[i], to[i]);\n    }\n\n    // surplus values - don't interpolate, but don't exclude them either\n    for (i = len; i < from.length; i += 1) {\n      intermediate[i] = from[i];\n    }\n\n    for (i = len; i < to.length; i += 1) {\n      intermediate[i] = to[i];\n    }\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        intermediate[i] = interpolators[i](t);\n      }\n\n      return intermediate;\n    };\n  },\n\n  object(from, to) {\n    if (!isObject(from) || !isObject(to)) {\n      return null;\n    }\n\n    const properties = [];\n    const intermediate = {};\n    const interpolators = {};\n\n    for (const prop in from) {\n      if (hasOwn(from, prop)) {\n        if (hasOwn(to, prop)) {\n          properties.push(prop);\n          interpolators[prop] = interpolate(from[prop], to[prop]) || (() => to[prop]);\n        } else {\n          intermediate[prop] = from[prop];\n        }\n      }\n    }\n\n    for (const prop in to) {\n      if (hasOwn(to, prop) && !hasOwn(from, prop)) {\n        intermediate[prop] = to[prop];\n      }\n    }\n\n    const len = properties.length;\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        const prop = properties[i];\n\n        intermediate[prop] = interpolators[prop](t);\n      }\n\n      return intermediate;\n    };\n  }\n};\n\nexport default interpolators;\n","import { isString } from 'utils/is';\n\nconst refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\nconst splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\nconst escapeKeyPattern = /\\\\|\\./g;\nconst unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\n\nexport function escapeKey(key) {\n  if (isString(key)) {\n    return key.replace(escapeKeyPattern, '\\\\$&');\n  }\n\n  return key;\n}\n\nexport function normalise(ref) {\n  return ref ? ref.replace(refPattern, '.$1') : '';\n}\n\nexport function splitKeypath(keypath) {\n  const result = [];\n  let match;\n\n  keypath = normalise(keypath);\n\n  while ((match = splitPattern.exec(keypath))) {\n    const index = match.index + match[1].length;\n    result.push(keypath.substr(0, index));\n    keypath = keypath.substr(index + 1);\n  }\n\n  result.push(keypath);\n\n  return result;\n}\n\nexport function unescapeKey(key) {\n  if (isString(key)) {\n    return key.replace(unescapeKeyPattern, '$1$2');\n  }\n\n  return key;\n}\n","const stack = [];\nlet captureGroup;\n\nexport function startCapturing() {\n  stack.push((captureGroup = []));\n}\n\nexport function stopCapturing() {\n  const dependencies = stack.pop();\n  captureGroup = stack[stack.length - 1];\n  return dependencies;\n}\n\nexport function capture(model) {\n  if (captureGroup) {\n    captureGroup.push(model);\n  }\n}\n","import { addToArray, removeFromArray } from 'utils/array';\nimport { unescapeKey } from 'shared/keypaths';\nimport { capture } from 'src/global/capture';\nimport noop from 'utils/noop';\n\nexport default class KeyModel {\n  constructor(key, parent) {\n    this.value = key;\n    this.isReadonly = this.isKey = true;\n    this.deps = [];\n    this.links = [];\n    this.parent = parent;\n  }\n\n  get(shouldCapture) {\n    if (shouldCapture) capture(this);\n    return unescapeKey(this.value);\n  }\n\n  getKeypath() {\n    return unescapeKey(this.value);\n  }\n\n  has() {\n    return false;\n  }\n\n  rebind(next, previous) {\n    let i = this.deps.length;\n    while (i--) this.deps[i].rebind(next, previous, false);\n\n    i = this.links.length;\n    while (i--) this.links[i].relinking(next, false);\n  }\n\n  register(dependant) {\n    this.deps.push(dependant);\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  unregister(dependant) {\n    removeFromArray(this.deps, dependant);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n}\n\nKeyModel.prototype.reference = noop;\nKeyModel.prototype.unreference = noop;\n","import { removeFromArray } from 'utils/array';\nimport { handleChange } from 'shared/methodCallers';\nimport { capture } from 'src/global/capture';\nimport noop from 'utils/noop';\nimport { keys as objectKeys } from 'utils/object';\n\nexport default class KeypathModel {\n  constructor(parent, ractive) {\n    this.parent = parent;\n    this.ractive = ractive;\n    this.value = ractive ? parent.getKeypath(ractive) : parent.getKeypath();\n    this.deps = [];\n    this.children = {};\n    this.isReadonly = this.isKeypath = true;\n  }\n\n  get(shouldCapture) {\n    if (shouldCapture) capture(this);\n    return this.value;\n  }\n\n  getChild(ractive) {\n    if (!(ractive._guid in this.children)) {\n      const model = new KeypathModel(this.parent, ractive);\n      this.children[ractive._guid] = model;\n      model.owner = this;\n    }\n    return this.children[ractive._guid];\n  }\n\n  getKeypath() {\n    return this.value;\n  }\n\n  handleChange() {\n    const keys = objectKeys(this.children);\n    let i = keys.length;\n    while (i--) {\n      this.children[keys[i]].handleChange();\n    }\n\n    this.deps.forEach(handleChange);\n  }\n\n  has() {\n    return false;\n  }\n\n  rebindChildren(next) {\n    const keys = objectKeys(this.children);\n    let i = keys.length;\n    while (i--) {\n      const child = this.children[keys[i]];\n      child.value = next.getKeypath(child.ractive);\n      child.handleChange();\n    }\n  }\n\n  rebind(next, previous) {\n    const model = next ? next.getKeypathModel(this.ractive) : undefined;\n\n    const keys = objectKeys(this.children);\n    let i = keys.length;\n    while (i--) {\n      this.children[keys[i]].rebind(next, previous, false);\n    }\n\n    i = this.deps.length;\n    while (i--) {\n      this.deps[i].rebind(model, this, false);\n    }\n  }\n\n  register(dep) {\n    this.deps.push(dep);\n  }\n\n  removeChild(model) {\n    if (model.ractive) delete this.children[model.ractive._guid];\n  }\n\n  teardown() {\n    if (this.owner) this.owner.removeChild(this);\n\n    const keys = objectKeys(this.children);\n    let i = keys.length;\n    while (i--) {\n      this.children[keys[i]].teardown();\n    }\n  }\n\n  unregister(dep) {\n    removeFromArray(this.deps, dep);\n    if (!this.deps.length) this.teardown();\n  }\n}\n\nKeypathModel.prototype.reference = noop;\nKeypathModel.prototype.unreference = noop;\n","const fnBind = Function.prototype.bind;\n\nexport default function bind(fn, context) {\n  if (!/this/.test(fn.toString())) return fn;\n\n  const bound = fnBind.call(fn, context);\n  for (const prop in fn) bound[prop] = fn[prop];\n\n  return bound;\n}\n","import KeyModel from './specials/KeyModel';\nimport KeypathModel from './specials/KeypathModel';\nimport { escapeKey, unescapeKey } from 'shared/keypaths';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isFunction } from 'utils/is';\nimport bind from 'utils/bind';\nimport { hasOwn, keys as objectKeys } from 'utils/object';\n\nconst shuffleTasks = { early: [], mark: [] };\nconst registerQueue = { early: [], mark: [] };\n\nexport default class ModelBase {\n  constructor(parent) {\n    this.deps = [];\n\n    this.children = [];\n    this.childByKey = {};\n    this.links = [];\n\n    this.keyModels = {};\n\n    this.bindings = [];\n    this.patternObservers = [];\n\n    if (parent) {\n      this.parent = parent;\n      this.root = parent.root;\n    }\n  }\n\n  addShuffleTask(task, stage = 'early') {\n    shuffleTasks[stage].push(task);\n  }\n  addShuffleRegister(item, stage = 'early') {\n    registerQueue[stage].push({ model: this, item });\n  }\n\n  downstreamChanged() {}\n\n  findMatches(keys) {\n    const len = keys.length;\n\n    let existingMatches = [this];\n    let matches;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const key = keys[i];\n\n      if (key === '*') {\n        matches = [];\n        existingMatches.forEach(model => {\n          matches.push.apply(matches, model.getValueChildren(model.get()));\n        });\n      } else {\n        matches = existingMatches.map(model => model.joinKey(key));\n      }\n\n      existingMatches = matches;\n    }\n\n    return matches;\n  }\n\n  getKeyModel(key, skip) {\n    if (key !== undefined && !skip) return this.parent.getKeyModel(key, true);\n\n    if (!(key in this.keyModels)) this.keyModels[key] = new KeyModel(escapeKey(key), this);\n\n    return this.keyModels[key];\n  }\n\n  getKeypath(ractive) {\n    if (ractive !== this.ractive && this._link) return this._link.target.getKeypath(ractive);\n\n    if (!this.keypath) {\n      const parent = this.parent && this.parent.getKeypath(ractive);\n      this.keypath = parent\n        ? `${this.parent.getKeypath(ractive)}.${escapeKey(this.key)}`\n        : escapeKey(this.key);\n    }\n\n    return this.keypath;\n  }\n\n  getValueChildren(value) {\n    let children;\n    if (isArray(value)) {\n      children = [];\n      if ('length' in this && this.length !== value.length) {\n        children.push(this.joinKey('length'));\n      }\n      value.forEach((m, i) => {\n        children.push(this.joinKey(i));\n      });\n    } else if (isObject(value) || isFunction(value)) {\n      children = objectKeys(value).map(key => this.joinKey(key));\n    } else if (value != null) {\n      return [];\n    }\n\n    return children;\n  }\n\n  getVirtual(shouldCapture) {\n    const value = this.get(shouldCapture, { virtual: false });\n    if (isObject(value)) {\n      const result = isArray(value) ? [] : {};\n\n      const keys = objectKeys(value);\n      let i = keys.length;\n      while (i--) {\n        const child = this.childByKey[keys[i]];\n        if (!child) result[keys[i]] = value[keys[i]];\n        else if (child._link) result[keys[i]] = child._link.getVirtual();\n        else result[keys[i]] = child.getVirtual();\n      }\n\n      i = this.children.length;\n      while (i--) {\n        const child = this.children[i];\n        if (!(child.key in result) && child._link) {\n          result[child.key] = child._link.getVirtual();\n        }\n      }\n\n      return result;\n    } else return value;\n  }\n\n  has(key) {\n    if (this._link) return this._link.has(key);\n\n    const value = this.get();\n    if (!value) return false;\n\n    key = unescapeKey(key);\n    if (hasOwn(value, key)) return true;\n\n    // We climb up the constructor chain to find if one of them contains the key\n    let constructor = value.constructor;\n    while (constructor !== Function && constructor !== Array && constructor !== Object) {\n      if (hasOwn(constructor.prototype, key)) return true;\n      constructor = constructor.constructor;\n    }\n\n    return false;\n  }\n\n  joinAll(keys, opts) {\n    let model = this;\n    for (let i = 0; i < keys.length; i += 1) {\n      if (\n        opts &&\n        opts.lastLink === false &&\n        i + 1 === keys.length &&\n        model.childByKey[keys[i]] &&\n        model.childByKey[keys[i]]._link\n      )\n        return model.childByKey[keys[i]];\n      model = model.joinKey(keys[i], opts);\n    }\n\n    return model;\n  }\n\n  notifyUpstream(startPath) {\n    let parent = this.parent;\n    const path = startPath || [this.key];\n    while (parent) {\n      if (parent.patternObservers.length)\n        parent.patternObservers.forEach(o => o.notify(path.slice()));\n      path.unshift(parent.key);\n      parent.links.forEach(l => l.notifiedUpstream(path, this.root));\n      parent.deps.forEach(d => d.handleChange(path));\n      parent.downstreamChanged(startPath);\n      parent = parent.parent;\n    }\n  }\n\n  rebind(next, previous, safe) {\n    if (this._link) {\n      this._link.rebind(next, previous, false);\n    }\n\n    // tell the deps to move to the new target\n    let i = this.deps.length;\n    while (i--) {\n      if (this.deps[i].rebind) this.deps[i].rebind(next, previous, safe);\n    }\n\n    i = this.links.length;\n    while (i--) {\n      const link = this.links[i];\n      // only relink the root of the link tree\n      if (link.owner._link) link.relinking(next, safe);\n    }\n\n    i = this.children.length;\n    while (i--) {\n      const child = this.children[i];\n      child.rebind(next ? next.joinKey(child.key) : undefined, child, safe);\n    }\n\n    if (this.keypathModel) this.keypathModel.rebind(next, previous, false);\n\n    i = this.bindings.length;\n    while (i--) {\n      this.bindings[i].rebind(next, previous, safe);\n    }\n  }\n\n  reference() {\n    'refs' in this ? this.refs++ : (this.refs = 1);\n  }\n\n  register(dep) {\n    this.deps.push(dep);\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  registerPatternObserver(observer) {\n    this.patternObservers.push(observer);\n    this.register(observer);\n  }\n\n  registerTwowayBinding(binding) {\n    this.bindings.push(binding);\n  }\n\n  unreference() {\n    if ('refs' in this) this.refs--;\n  }\n\n  unregister(dep) {\n    removeFromArray(this.deps, dep);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n\n  unregisterPatternObserver(observer) {\n    removeFromArray(this.patternObservers, observer);\n    this.unregister(observer);\n  }\n\n  unregisterTwowayBinding(binding) {\n    removeFromArray(this.bindings, binding);\n  }\n\n  updateFromBindings(cascade) {\n    let i = this.bindings.length;\n    while (i--) {\n      const value = this.bindings[i].getValue();\n      if (value !== this.value) this.set(value);\n    }\n\n    // check for one-way bindings if there are no two-ways\n    if (!this.bindings.length) {\n      const oneway = findBoundValue(this.deps);\n      if (oneway && oneway.value !== this.value) this.set(oneway.value);\n    }\n\n    if (cascade) {\n      this.children.forEach(updateFromBindings);\n      this.links.forEach(updateFromBindings);\n      if (this._link) this._link.updateFromBindings(cascade);\n    }\n  }\n}\n\n// TODO: this may be better handled by overreiding `get` on models with a parent that isRoot\nexport function maybeBind(model, value, shouldBind) {\n  if (shouldBind && isFunction(value) && model.parent && model.parent.isRoot) {\n    if (!model.boundValue) {\n      model.boundValue = bind(value._r_unbound || value, model.parent.ractive);\n    }\n\n    return model.boundValue;\n  }\n\n  return value;\n}\n\nfunction updateFromBindings(model) {\n  model.updateFromBindings(true);\n}\n\nexport function findBoundValue(list) {\n  let i = list.length;\n  while (i--) {\n    if (list[i].bound) {\n      const owner = list[i].owner;\n      if (owner) {\n        const value = owner.name === 'checked' ? owner.node.checked : owner.node.value;\n        return { value };\n      }\n    }\n  }\n}\n\nexport function fireShuffleTasks(stage) {\n  if (!stage) {\n    fireShuffleTasks('early');\n    fireShuffleTasks('mark');\n  } else {\n    const tasks = shuffleTasks[stage];\n    shuffleTasks[stage] = [];\n    let i = tasks.length;\n    while (i--) tasks[i]();\n\n    const register = registerQueue[stage];\n    registerQueue[stage] = [];\n    i = register.length;\n    while (i--) register[i].model.register(register[i].item);\n  }\n}\n\nexport function shuffle(model, newIndices, link, unsafe) {\n  model.shuffling = true;\n\n  let i = newIndices.length;\n  while (i--) {\n    const idx = newIndices[i];\n    // nothing is actually changing, so move in the index and roll on\n    if (i === idx) {\n      continue;\n    }\n\n    // rebind the children on i to idx\n    if (i in model.childByKey)\n      model.childByKey[i].rebind(\n        !~idx ? undefined : model.joinKey(idx),\n        model.childByKey[i],\n        !unsafe\n      );\n\n    if (!~idx && model.keyModels[i]) {\n      model.keyModels[i].rebind(undefined, model.keyModels[i], false);\n    } else if (~idx && model.keyModels[i]) {\n      if (!model.keyModels[idx]) model.childByKey[idx].getKeyModel(idx);\n      model.keyModels[i].rebind(model.keyModels[idx], model.keyModels[i], false);\n    }\n  }\n\n  const upstream = model.source().length !== model.source().value.length;\n\n  model.links.forEach(l => l.shuffle(newIndices));\n  if (!link) fireShuffleTasks('early');\n\n  i = model.deps.length;\n  while (i--) {\n    if (model.deps[i].shuffle) model.deps[i].shuffle(newIndices);\n  }\n\n  model[link ? 'marked' : 'mark']();\n  if (!link) fireShuffleTasks('mark');\n\n  if (upstream) model.notifyUpstream();\n\n  model.shuffling = false;\n}\n\nKeyModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\nKeyModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\nKeypathModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\nKeypathModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\n","import ModelBase, { fireShuffleTasks, maybeBind, shuffle } from './ModelBase';\nimport KeypathModel from './specials/KeypathModel';\nimport { capture } from '../global/capture';\nimport { handleChange, marked, markedAll, teardown } from 'shared/methodCallers';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\nimport { hasOwn } from 'utils/object';\n\n// temporary placeholder target for detached implicit links\nexport const Missing = {\n  key: '@missing',\n  animate: noop,\n  applyValue: noop,\n  get: noop,\n  getKeypath() {\n    return this.key;\n  },\n  joinAll() {\n    return this;\n  },\n  joinKey() {\n    return this;\n  },\n  mark: noop,\n  registerLink: noop,\n  shufle: noop,\n  set: noop,\n  unregisterLink: noop\n};\nMissing.parent = Missing;\n\nexport default class LinkModel extends ModelBase {\n  constructor(parent, owner, target, key) {\n    super(parent);\n\n    this.owner = owner;\n    this.target = target;\n    this.key = key === undefined ? owner.key : key;\n    if (owner.isLink) this.sourcePath = `${owner.sourcePath}.${this.key}`;\n\n    target.registerLink(this);\n\n    if (parent) this.isReadonly = parent.isReadonly;\n\n    this.isLink = true;\n  }\n\n  animate(from, to, options, interpolator) {\n    return this.target.animate(from, to, options, interpolator);\n  }\n\n  applyValue(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.applyValue(value);\n  }\n\n  attach(fragment) {\n    const model = resolveReference(fragment, this.key);\n    if (model) {\n      this.relinking(model, false);\n    } else {\n      // if there is no link available, move everything here to real models\n      this.owner.unlink();\n    }\n  }\n\n  detach() {\n    this.relinking(Missing, false);\n  }\n\n  get(shouldCapture, opts = {}) {\n    if (shouldCapture) {\n      capture(this);\n\n      // may need to tell the target to unwrap\n      opts.unwrap = 'unwrap' in opts ? opts.unwrap : true;\n    }\n\n    const bind = 'shouldBind' in opts ? opts.shouldBind : true;\n    opts.shouldBind = this.mapping && this.target.parent && this.target.parent.isRoot;\n\n    return maybeBind(this, this.target.get(false, opts), bind);\n  }\n\n  getKeypath(ractive) {\n    if (ractive && ractive !== this.root.ractive) return this.target.getKeypath(ractive);\n\n    return super.getKeypath(ractive);\n  }\n\n  getKeypathModel(ractive) {\n    if (!this.keypathModel) this.keypathModel = new KeypathModel(this);\n    if (ractive && ractive !== this.root.ractive) return this.keypathModel.getChild(ractive);\n    return this.keypathModel;\n  }\n\n  handleChange() {\n    this.deps.forEach(handleChange);\n    this.links.forEach(handleChange);\n    this.notifyUpstream();\n  }\n\n  isDetached() {\n    return this.virtual && this.target === Missing;\n  }\n\n  joinKey(key) {\n    // TODO: handle nested links\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new LinkModel(this, this, this.target.joinKey(key), key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n\n  mark(force) {\n    this.target.mark(force);\n  }\n\n  marked() {\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n\n    this.deps.forEach(handleChange);\n  }\n\n  markedAll() {\n    this.children.forEach(markedAll);\n    this.marked();\n  }\n\n  notifiedUpstream(startPath, root) {\n    this.links.forEach(l => l.notifiedUpstream(startPath, this.root));\n    this.deps.forEach(handleChange);\n    if (startPath && this.rootLink && this.root !== root) {\n      const path = startPath.slice(1);\n      path.unshift(this.key);\n      this.notifyUpstream(path);\n    }\n  }\n\n  relinked() {\n    this.target.registerLink(this);\n    this.children.forEach(c => c.relinked());\n  }\n\n  relinking(target, safe) {\n    if (this.rootLink && this.sourcePath)\n      target = rebindMatch(this.sourcePath, target, this.target);\n    if (!target || this.target === target) return;\n\n    this.target.unregisterLink(this);\n    if (this.keypathModel) this.keypathModel.rebindChildren(target);\n\n    this.target = target;\n    this.children.forEach(c => {\n      c.relinking(target.joinKey(c.key), safe);\n    });\n\n    if (this.rootLink)\n      this.addShuffleTask(() => {\n        this.relinked();\n        if (!safe) {\n          this.markedAll();\n          this.notifyUpstream();\n        }\n      });\n  }\n\n  set(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.set(value);\n  }\n\n  shuffle(newIndices) {\n    // watch for extra shuffles caused by a shuffle in a downstream link\n    if (this.shuffling) return;\n\n    // let the real model handle firing off shuffles\n    if (!this.target.shuffling) {\n      if (this.target.shuffle) {\n        this.target.shuffle(newIndices);\n      } else {\n        // the target is a computation, which can't shuffle\n        this.target.mark();\n      }\n    } else {\n      shuffle(this, newIndices, true);\n    }\n  }\n\n  source() {\n    if (this.target.source) return this.target.source();\n    else return this.target;\n  }\n\n  teardown() {\n    if (this._link) this._link.teardown();\n    this.target.unregisterLink(this);\n    this.children.forEach(teardown);\n  }\n}\n\nModelBase.prototype.link = function link(model, keypath, options) {\n  const lnk = this._link || new LinkModel(this.parent, this, model, this.key);\n  lnk.implicit = options && options.implicit;\n  lnk.mapping = options && options.mapping;\n  lnk.sourcePath = keypath;\n  lnk.rootLink = true;\n  if (this._link) this._link.relinking(model, false);\n  this.rebind(lnk, this, false);\n  fireShuffleTasks();\n\n  this._link = lnk;\n  lnk.markedAll();\n\n  this.notifyUpstream();\n  return lnk;\n};\n\nModelBase.prototype.unlink = function unlink() {\n  if (this._link) {\n    const ln = this._link;\n    this._link = undefined;\n    ln.rebind(this, ln, false);\n    fireShuffleTasks();\n    ln.teardown();\n    this.notifyUpstream();\n  }\n};\n","import { removeFromArray } from 'utils/array';\nimport { isFunction } from 'utils/is';\n\nexport default class TransitionManager {\n  constructor(callback, parent) {\n    this.callback = callback;\n    this.parent = parent;\n\n    this.intros = [];\n    this.outros = [];\n\n    this.children = [];\n    this.totalChildren = this.outroChildren = 0;\n\n    this.detachQueue = [];\n    this.outrosComplete = false;\n\n    if (parent) {\n      parent.addChild(this);\n    }\n  }\n\n  add(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    transition.starting = true;\n    list.push(transition);\n  }\n\n  addChild(child) {\n    this.children.push(child);\n\n    this.totalChildren += 1;\n    this.outroChildren += 1;\n  }\n\n  decrementOutros() {\n    this.outroChildren -= 1;\n    check(this);\n  }\n\n  decrementTotal() {\n    this.totalChildren -= 1;\n    check(this);\n  }\n\n  detachNodes() {\n    this.detachQueue.forEach(detach);\n    this.children.forEach(_detachNodes);\n    this.detachQueue = [];\n  }\n\n  ready() {\n    if (this.detachQueue.length) detachImmediate(this);\n  }\n\n  remove(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    removeFromArray(list, transition);\n    check(this);\n  }\n\n  start() {\n    this.children.forEach(c => c.start());\n    this.intros.concat(this.outros).forEach(t => t.start());\n    this.ready = true;\n    check(this);\n  }\n}\n\nfunction detach(element) {\n  element.detach();\n}\n\nfunction _detachNodes(tm) {\n  // _ to avoid transpiler quirk\n  tm.detachNodes();\n}\n\nfunction check(tm) {\n  if (!tm.ready || tm.outros.length || tm.outroChildren) return;\n\n  // If all outros are complete, and we haven't already done this,\n  // we notify the parent if there is one, otherwise\n  // start detaching nodes\n  if (!tm.outrosComplete) {\n    tm.outrosComplete = true;\n\n    if (tm.parent && !tm.parent.outrosComplete) {\n      tm.parent.decrementOutros(tm);\n    } else {\n      tm.detachNodes();\n    }\n  }\n\n  // Once everything is done, we can notify parent transition\n  // manager and call the callback\n  if (!tm.intros.length && !tm.totalChildren) {\n    if (isFunction(tm.callback)) {\n      tm.callback();\n    }\n\n    if (tm.parent && !tm.notifiedTotal) {\n      tm.notifiedTotal = true;\n      tm.parent.decrementTotal();\n    }\n  }\n}\n\n// check through the detach queue to see if a node is up or downstream from a\n// transition and if not, go ahead and detach it\nfunction detachImmediate(manager) {\n  const queue = manager.detachQueue;\n  const outros = collectAllOutros(manager);\n\n  let i = queue.length;\n  let j = 0;\n  let node, trans;\n  start: while (i--) {\n    node = queue[i].node;\n    j = outros.length;\n    while (j--) {\n      trans = outros[j].element.node;\n      // check to see if the node is, contains, or is contained by the transitioning node\n      if (trans === node || trans.contains(node) || node.contains(trans)) continue start;\n    }\n\n    // no match, we can drop it\n    queue[i].detach();\n    queue.splice(i, 1);\n  }\n}\n\nfunction collectAllOutros(manager, _list) {\n  let list = _list;\n\n  // if there's no list, we're starting at the root to build one\n  if (!list) {\n    list = [];\n    let parent = manager;\n    while (parent.parent) parent = parent.parent;\n    return collectAllOutros(parent, list);\n  } else {\n    // grab all outros from child managers\n    let i = manager.children.length;\n    while (i--) {\n      list = collectAllOutros(manager.children[i], list);\n    }\n\n    // grab any from this manager if there are any\n    if (manager.outros.length) list = list.concat(manager.outros);\n\n    return list;\n  }\n}\n","import { addToArray } from 'utils/array';\nimport TransitionManager from './TransitionManager';\n\nlet batch;\n\nconst runloop = {\n  active() {\n    return !!batch;\n  },\n\n  start() {\n    let fulfilPromise;\n    const promise = new Promise(f => (fulfilPromise = f));\n\n    batch = {\n      previousBatch: batch,\n      transitionManager: new TransitionManager(fulfilPromise, batch && batch.transitionManager),\n      fragments: [],\n      tasks: [],\n      immediateObservers: [],\n      deferredObservers: [],\n      promise\n    };\n\n    return promise;\n  },\n\n  end() {\n    flushChanges();\n\n    if (!batch.previousBatch) batch.transitionManager.start();\n\n    batch = batch.previousBatch;\n  },\n\n  addFragment(fragment) {\n    addToArray(batch.fragments, fragment);\n  },\n\n  // TODO: come up with a better way to handle fragments that trigger their own update\n  addFragmentToRoot(fragment) {\n    if (!batch) return;\n\n    let b = batch;\n    while (b.previousBatch) {\n      b = b.previousBatch;\n    }\n\n    addToArray(b.fragments, fragment);\n  },\n\n  addObserver(observer, defer) {\n    if (!batch) {\n      observer.dispatch();\n    } else {\n      addToArray(defer ? batch.deferredObservers : batch.immediateObservers, observer);\n    }\n  },\n\n  registerTransition(transition) {\n    transition._manager = batch.transitionManager;\n    batch.transitionManager.add(transition);\n  },\n\n  // synchronise node detachments with transition ends\n  detachWhenReady(thing) {\n    batch.transitionManager.detachQueue.push(thing);\n  },\n\n  scheduleTask(task, postRender) {\n    let _batch;\n\n    if (!batch) {\n      task();\n    } else {\n      _batch = batch;\n      while (postRender && _batch.previousBatch) {\n        // this can't happen until the DOM has been fully updated\n        // otherwise in some situations (with components inside elements)\n        // transitions and decorators will initialise prematurely\n        _batch = _batch.previousBatch;\n      }\n\n      _batch.tasks.push(task);\n    }\n  },\n\n  promise() {\n    if (!batch) return Promise.resolve();\n\n    let target = batch;\n    while (target.previousBatch) {\n      target = target.previousBatch;\n    }\n\n    return target.promise || Promise.resolve();\n  }\n};\n\nexport default runloop;\n\nfunction dispatch(observer) {\n  observer.dispatch();\n}\n\nfunction flushChanges() {\n  let which = batch.immediateObservers;\n  batch.immediateObservers = [];\n  which.forEach(dispatch);\n\n  // Now that changes have been fully propagated, we can update the DOM\n  // and complete other tasks\n  let i = batch.fragments.length;\n  let fragment;\n\n  which = batch.fragments;\n  batch.fragments = [];\n\n  while (i--) {\n    fragment = which[i];\n    fragment.update();\n  }\n\n  batch.transitionManager.ready();\n\n  which = batch.deferredObservers;\n  batch.deferredObservers = [];\n  which.forEach(dispatch);\n\n  const tasks = batch.tasks;\n  batch.tasks = [];\n\n  for (i = 0; i < tasks.length; i += 1) {\n    tasks[i]();\n  }\n\n  // If updating the view caused some model blowback - e.g. a triple\n  // containing <option> elements caused the binding on the <select>\n  // to update - then we start over\n  if (\n    batch.fragments.length ||\n    batch.immediateObservers.length ||\n    batch.deferredObservers.length ||\n    batch.tasks.length\n  )\n    return flushChanges();\n}\n","import runloop from 'src/global/runloop';\n\n// TODO what happens if a transition is aborted?\n\nconst tickers = [];\nlet running = false;\n\nfunction tick() {\n  runloop.start();\n\n  const now = performance.now();\n\n  let i;\n  let ticker;\n\n  for (i = 0; i < tickers.length; i += 1) {\n    ticker = tickers[i];\n\n    if (!ticker.tick(now)) {\n      // ticker is complete, remove it from the stack, and decrement i so we don't miss one\n      tickers.splice(i--, 1);\n    }\n  }\n\n  runloop.end();\n\n  if (tickers.length) {\n    requestAnimationFrame(tick);\n  } else {\n    running = false;\n  }\n}\n\nexport default class Ticker {\n  constructor(options) {\n    this.duration = options.duration;\n    this.step = options.step;\n    this.complete = options.complete;\n    this.easing = options.easing;\n\n    this.start = performance.now();\n    this.end = this.start + this.duration;\n\n    this.running = true;\n\n    tickers.push(this);\n    if (!running) requestAnimationFrame(tick);\n  }\n\n  tick(now) {\n    if (!this.running) return false;\n\n    if (now > this.end) {\n      if (this.step) this.step(1);\n      if (this.complete) this.complete(1);\n\n      return false;\n    }\n\n    const elapsed = now - this.start;\n    const eased = this.easing(elapsed / this.duration);\n\n    if (this.step) this.step(eased);\n\n    return true;\n  }\n\n  stop() {\n    if (this.abort) this.abort();\n    this.running = false;\n  }\n}\n","import { hasOwn } from 'utils/object';\nimport { isString, isObjectType } from 'utils/is';\n\nconst prefixers = {};\n\n// TODO this is legacy. sooner we can replace the old adaptor API the better\n/* istanbul ignore next */\nfunction prefixKeypath(obj, prefix) {\n  const prefixed = {};\n\n  if (!prefix) {\n    return obj;\n  }\n\n  prefix += '.';\n\n  for (const key in obj) {\n    if (hasOwn(obj, key)) {\n      prefixed[prefix + key] = obj[key];\n    }\n  }\n\n  return prefixed;\n}\n\nexport default function getPrefixer(rootKeypath) {\n  let rootDot;\n\n  if (!prefixers[rootKeypath]) {\n    rootDot = rootKeypath ? rootKeypath + '.' : '';\n\n    /* istanbul ignore next */\n    prefixers[rootKeypath] = function(relativeKeypath, value) {\n      let obj;\n\n      if (isString(relativeKeypath)) {\n        obj = {};\n        obj[rootDot + relativeKeypath] = value;\n        return obj;\n      }\n\n      if (isObjectType(relativeKeypath)) {\n        // 'relativeKeypath' is in fact a hash, not a keypath\n        return rootDot ? prefixKeypath(relativeKeypath, rootKeypath) : relativeKeypath;\n      }\n    };\n  }\n\n  return prefixers[rootKeypath];\n}\n","import ModelBase, { maybeBind, shuffle } from './ModelBase';\nimport LinkModel from './LinkModel'; // eslint-disable-line no-unused-vars\nimport KeypathModel from './specials/KeypathModel';\nimport { capture } from 'src/global/capture';\nimport { isArray, isEqual, isNumeric, isObjectLike } from 'utils/is';\nimport { handleChange, mark, markForce, marked, teardown } from 'shared/methodCallers';\nimport Ticker from 'shared/Ticker';\nimport getPrefixer from './helpers/getPrefixer';\nimport { unescapeKey } from 'shared/keypaths';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn } from 'utils/object';\n\nexport default class Model extends ModelBase {\n  constructor(parent, key) {\n    super(parent);\n\n    this.ticker = null;\n\n    if (parent) {\n      this.key = unescapeKey(key);\n      this.isReadonly = parent.isReadonly;\n\n      if (parent.value) {\n        this.value = parent.value[this.key];\n        if (isArray(this.value)) this.length = this.value.length;\n        this.adapt();\n      }\n    }\n  }\n\n  adapt() {\n    const adaptors = this.root.adaptors;\n    const len = adaptors.length;\n\n    this.rewrap = false;\n\n    // Exit early if no adaptors\n    if (len === 0) return;\n\n    const value = this.wrapper\n      ? 'newWrapperValue' in this\n        ? this.newWrapperValue\n        : this.wrapperValue\n      : this.value;\n\n    // TODO remove this legacy nonsense\n    const ractive = this.root.ractive;\n    const keypath = this.getKeypath();\n\n    // tear previous adaptor down if present\n    if (this.wrapper) {\n      const shouldTeardown =\n        this.wrapperValue === value\n          ? false\n          : !this.wrapper.reset || this.wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        this.wrapper.teardown();\n        delete this.wrapper;\n        delete this.wrapperValue;\n\n        // don't branch for undefined values\n        if (this.value !== undefined) {\n          const parentValue = this.parent.value || this.parent.createBranch(this.key);\n          if (parentValue[this.key] !== value) parentValue[this.key] = value;\n          this.value = value;\n        }\n      } else {\n        delete this.newWrapperValue;\n        this.value = this.wrapper.get();\n        return;\n      }\n    }\n\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const adaptor = adaptors[i];\n      if (adaptor.filter(value, keypath, ractive)) {\n        this.wrapper = adaptor.wrap(ractive, value, keypath, getPrefixer(keypath));\n        this.wrapperValue = value;\n        this.wrapper.__model = this; // massive temporary hack to enable array adaptor\n\n        this.value = this.wrapper.get();\n\n        break;\n      }\n    }\n  }\n\n  animate(from, to, options, interpolator) {\n    if (this.ticker) this.ticker.stop();\n\n    let fulfilPromise;\n    const promise = new Promise(fulfil => (fulfilPromise = fulfil));\n\n    this.ticker = new Ticker({\n      duration: options.duration,\n      easing: options.easing,\n      step: t => {\n        const value = interpolator(t);\n        this.applyValue(value);\n        if (options.step) options.step(t, value);\n      },\n      complete: () => {\n        this.applyValue(to);\n        if (options.complete) options.complete(to);\n\n        this.ticker = null;\n        fulfilPromise(to);\n      }\n    });\n\n    promise.stop = this.ticker.stop;\n    return promise;\n  }\n\n  applyValue(value, notify = true) {\n    if (isEqual(value, this.value)) return;\n    if (this.boundValue) this.boundValue = null;\n\n    if (this.parent.wrapper && this.parent.wrapper.set) {\n      this.parent.wrapper.set(this.key, value);\n      this.parent.value = this.parent.wrapper.get();\n\n      this.value = this.parent.value[this.key];\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    } else if (this.wrapper) {\n      this.newWrapperValue = value;\n      this.adapt();\n    } else {\n      const parentValue = this.parent.value || this.parent.createBranch(this.key);\n      if (isObjectLike(parentValue)) {\n        parentValue[this.key] = value;\n      } else {\n        warnIfDebug(`Attempted to set a property of a non-object '${this.getKeypath()}'`);\n        return;\n      }\n\n      this.value = value;\n      this.adapt();\n    }\n\n    // keep track of array stuff\n    if (isArray(value)) {\n      this.length = value.length;\n      this.isArray = true;\n    } else {\n      this.isArray = false;\n    }\n\n    // notify dependants\n    this.links.forEach(handleChange);\n    this.children.forEach(mark);\n    this.deps.forEach(handleChange);\n\n    if (notify) this.notifyUpstream();\n\n    if (this.parent.isArray) {\n      if (this.key === 'length') this.parent.length = value;\n      else this.parent.joinKey('length').mark();\n    }\n  }\n\n  createBranch(key) {\n    const branch = isNumeric(key) ? [] : {};\n    this.applyValue(branch, false);\n\n    return branch;\n  }\n\n  get(shouldCapture, opts) {\n    if (this._link) return this._link.get(shouldCapture, opts);\n    if (shouldCapture) capture(this);\n    // if capturing, this value needs to be unwrapped because it's for external use\n    if (opts && opts.virtual) return this.getVirtual(false);\n    return maybeBind(\n      this,\n      (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  getKeypathModel() {\n    if (!this.keypathModel) this.keypathModel = new KeypathModel(this);\n    return this.keypathModel;\n  }\n\n  joinKey(key, opts) {\n    if (this._link) {\n      if (opts && opts.lastLink !== false && (key === undefined || key === '')) return this;\n      return this._link.joinKey(key);\n    }\n\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new Model(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    if (this.childByKey[key]._link && (!opts || opts.lastLink !== false))\n      return this.childByKey[key]._link;\n    return this.childByKey[key];\n  }\n\n  mark(force) {\n    if (this._link) return this._link.mark(force);\n\n    const old = this.value;\n    const value = this.retrieve();\n\n    if (force || !isEqual(value, old)) {\n      this.value = value;\n      if (this.boundValue) this.boundValue = null;\n\n      // make sure the wrapper stays in sync\n      if (old !== value || this.rewrap) {\n        if (this.wrapper) this.newWrapperValue = value;\n        this.adapt();\n      }\n\n      // keep track of array stuff\n      if (isArray(value)) {\n        this.length = value.length;\n        this.isArray = true;\n      } else {\n        this.isArray = false;\n      }\n\n      this.children.forEach(force ? markForce : mark);\n      this.links.forEach(marked);\n\n      this.deps.forEach(handleChange);\n    }\n  }\n\n  merge(array, comparator) {\n    let oldArray = this.value;\n    let newArray = array;\n    if (oldArray === newArray) oldArray = recreateArray(this);\n    if (comparator) {\n      oldArray = oldArray.map(comparator);\n      newArray = newArray.map(comparator);\n    }\n\n    const oldLength = oldArray.length;\n\n    const usedIndices = {};\n    let firstUnusedIndex = 0;\n\n    const newIndices = oldArray.map(item => {\n      let index;\n      let start = firstUnusedIndex;\n\n      do {\n        index = newArray.indexOf(item, start);\n\n        if (index === -1) {\n          return -1;\n        }\n\n        start = index + 1;\n      } while (usedIndices[index] === true && start < oldLength);\n\n      // keep track of the first unused index, so we don't search\n      // the whole of newArray for each item in oldArray unnecessarily\n      if (index === firstUnusedIndex) {\n        firstUnusedIndex += 1;\n      }\n      // allow next instance of next \"equal\" to be found item\n      usedIndices[index] = true;\n      return index;\n    });\n\n    this.parent.value[this.key] = array;\n    this.shuffle(newIndices, true);\n  }\n\n  retrieve() {\n    return this.parent.value ? this.parent.value[this.key] : undefined;\n  }\n\n  set(value) {\n    if (this.ticker) this.ticker.stop();\n    this.applyValue(value);\n  }\n\n  shuffle(newIndices, unsafe) {\n    shuffle(this, newIndices, false, unsafe);\n  }\n\n  source() {\n    return this;\n  }\n\n  teardown() {\n    if (this._link) {\n      this._link.teardown();\n      this._link = null;\n    }\n    this.children.forEach(teardown);\n    if (this.wrapper) this.wrapper.teardown();\n    if (this.keypathModel) this.keypathModel.teardown();\n  }\n}\n\nfunction recreateArray(model) {\n  const array = [];\n\n  for (let i = 0; i < model.length; i++) {\n    array[i] = (model.childByKey[i] || {}).value;\n  }\n\n  return array;\n}\n","/* global global */\nimport Model from '../Model';\n\nexport const data = {};\n\nexport class SharedModel extends Model {\n  constructor(value, name) {\n    super(null, `@${name}`);\n    this.key = `@${name}`;\n    this.value = value;\n    this.isRoot = true;\n    this.root = this;\n    this.adaptors = [];\n  }\n\n  getKeypath() {\n    return this.key;\n  }\n\n  retrieve() {\n    return this.value;\n  }\n}\n\nexport default new SharedModel(data, 'shared');\n\nexport const GlobalModel = new SharedModel(\n  typeof global !== 'undefined' ? global : window,\n  'global'\n);\n","import { splitKeypath } from 'shared/keypaths';\nimport SharedModel, { GlobalModel } from 'src/model/specials/SharedModel';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nexport default function resolveReference(fragment, ref) {\n  const initialFragment = fragment;\n  // current context ref\n  if (ref === '.') return fragment.findContext();\n\n  // ancestor references\n  if (ref[0] === '~') return fragment.ractive.viewmodel.joinAll(splitKeypath(ref.slice(2)));\n\n  // scoped references\n  if (ref[0] === '.' || ref[0] === '^') {\n    let frag = fragment;\n    const parts = ref.split('/');\n    const explicitContext = parts[0] === '^^';\n    let context = explicitContext ? null : fragment.findContext();\n\n    // account for the first context hop\n    if (explicitContext) parts.unshift('^^');\n\n    // walk up the context chain\n    while (parts[0] === '^^') {\n      parts.shift();\n      context = null;\n      while (frag && !context) {\n        context = frag.context;\n        frag = frag.parent.component ? frag.parent.component.up : frag.parent;\n      }\n    }\n\n    if (!context && explicitContext) {\n      throw new Error(\n        `Invalid context parent reference ('${ref}'). There is not context at that level.`\n      );\n    }\n\n    // walk up the context path\n    while (parts[0] === '.' || parts[0] === '..') {\n      const part = parts.shift();\n\n      if (part === '..') {\n        context = context.parent;\n      }\n    }\n\n    ref = parts.join('/');\n\n    // special case - `{{.foo}}` means the same as `{{./foo}}`\n    if (ref[0] === '.') ref = ref.slice(1);\n    return context.joinAll(splitKeypath(ref));\n  }\n\n  const keys = splitKeypath(ref);\n  if (!keys.length) return;\n  const base = keys.shift();\n\n  // special refs\n  if (base[0] === '@') {\n    // shorthand from outside the template\n    // @this referring to local ractive instance\n    if (base === '@this' || base === '@') {\n      return fragment.ractive.viewmodel.getRactiveModel().joinAll(keys);\n    } else if (base === '@index' || base === '@key') {\n      // @index or @key referring to the nearest repeating index or key\n      if (keys.length) badReference(base);\n      const repeater = fragment.findRepeatingFragment();\n      // make sure the found fragment is actually an iteration\n      if (!repeater.isIteration) return;\n      return (\n        repeater.context && repeater.context.getKeyModel(repeater[ref[1] === 'i' ? 'index' : 'key'])\n      );\n    } else if (base === '@global') {\n      // @global referring to window or global\n      return GlobalModel.joinAll(keys);\n    } else if (base === '@shared') {\n      // @global referring to window or global\n      return SharedModel.joinAll(keys);\n    } else if (base === '@keypath' || base === '@rootpath') {\n      // @keypath or @rootpath, the current keypath string\n      const root = ref[1] === 'r' ? fragment.ractive.root : null;\n      let context = fragment.findContext();\n\n      // skip over component roots, which provide no context\n      while (root && context.isRoot && context.ractive.component) {\n        context = context.ractive.component.up.findContext();\n      }\n\n      return context.getKeypathModel(root);\n    } else if (base === '@context') {\n      return new ContextModel(fragment.getContext());\n    } else if (base === '@local') {\n      // @context-local data\n      return fragment.getContext()._data.joinAll(keys);\n    } else if (base === '@style') {\n      // @style shared model\n      return fragment.ractive.constructor._cssModel.joinAll(keys);\n    } else {\n      // nope\n      throw new Error(`Invalid special reference '${base}'`);\n    }\n  }\n\n  const context = fragment.findContext();\n\n  // check immediate context for a match\n  if (context.has(base)) {\n    return context.joinKey(base).joinAll(keys);\n  }\n\n  // walk up the fragment hierarchy looking for a matching ref, alias, or key in a context\n  let createMapping = false;\n  const shouldWarn = fragment.ractive.warnAboutAmbiguity;\n  let model;\n\n  while (fragment) {\n    // repeated fragments\n    if (fragment.isIteration) {\n      if (base === fragment.parent.keyRef) {\n        model = fragment.context.getKeyModel(fragment.key);\n      } else if (base === fragment.parent.indexRef) {\n        model = fragment.context.getKeyModel(fragment.index);\n      }\n\n      if (model && keys.length) badReference(base);\n    }\n\n    // alias node or iteration\n    if (!model && fragment.aliases && hasOwn(fragment.aliases, base)) {\n      model = fragment.aliases[base];\n    }\n\n    // check fragment context to see if it has the key we need\n    if (!model && fragment.context && fragment.context.has(base)) {\n      model = fragment.context.joinKey(base);\n\n      // this is an implicit mapping\n      if (createMapping) {\n        if (shouldWarn)\n          warnIfDebug(\n            `'${ref}' resolved but is ambiguous and will create a mapping to a parent component.`\n          );\n      } else if (shouldWarn) warnIfDebug(`'${ref}' resolved but is ambiguous.`);\n    }\n\n    if (model) {\n      if (createMapping) {\n        model = initialFragment.ractive.viewmodel.createLink(base, model, base, { implicit: true });\n      }\n\n      if (keys.length > 0 && isFunction(model.joinAll)) {\n        model = model.joinAll(keys);\n      }\n\n      return model;\n    }\n\n    if (\n      (fragment.componentParent || (!fragment.parent && fragment.ractive.component)) &&\n      !fragment.ractive.isolated\n    ) {\n      // ascend through component boundary\n      fragment = fragment.componentParent || fragment.ractive.component.up;\n      createMapping = true;\n    } else {\n      fragment = fragment.parent;\n    }\n  }\n\n  // if enabled, check the instance for a match\n  const instance = initialFragment.ractive;\n  if (instance.resolveInstanceMembers && base !== 'data' && base in instance) {\n    return instance.viewmodel\n      .getRactiveModel()\n      .joinKey(base)\n      .joinAll(keys);\n  }\n\n  if (shouldWarn) {\n    warnIfDebug(`'${ref}' is ambiguous and did not resolve.`);\n  }\n\n  // didn't find anything, so go ahead and create the key on the local model\n  return context.joinKey(base).joinAll(keys);\n}\n\nfunction badReference(key) {\n  throw new Error(`An index or key reference (${key}) cannot have child properties`);\n}\n\nclass ContextModel {\n  constructor(context) {\n    this.context = context;\n  }\n\n  get() {\n    return this.context;\n  }\n}\n","import noop from 'utils/noop';\nimport { assign, create } from 'utils/object';\n\nexport const extern = {};\n\nexport default function getRactiveContext(ractive, ...assigns) {\n  const fragment =\n    ractive.fragment ||\n    ractive._fakeFragment ||\n    (ractive._fakeFragment = new FakeFragment(ractive));\n  return fragment.getContext.apply(fragment, assigns);\n}\n\nexport function getContext(...assigns) {\n  if (!this.ctx) this.ctx = new extern.Context(this);\n  assigns.unshift(create(this.ctx));\n  return assign.apply(null, assigns);\n}\n\nexport class FakeFragment {\n  constructor(ractive) {\n    this.ractive = ractive;\n  }\n\n  findContext() {\n    return this.ractive.viewmodel;\n  }\n}\nconst proto = FakeFragment.prototype;\nproto.getContext = getContext;\nproto.find = proto.findComponent = proto.findAll = proto.findAllComponents = noop;\n\nexport function findParentWithContext(fragment) {\n  let frag = fragment;\n  while (frag && !frag.context) frag = frag.parent;\n  if (!frag) return fragment && fragment.ractive.fragment;\n  else return frag;\n}\n","import { isArray, isObject, isObjectType, isFunction, isString } from 'utils/is';\nimport { warnIfDebug } from 'utils/log';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from '../global/runloop';\nimport { splitKeypath } from './keypaths';\nimport { FakeFragment } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\n\nexport let keep = false;\n\nexport function set(pairs, options) {\n  const k = keep;\n\n  const deep = options && options.deep;\n  const shuffle = options && options.shuffle;\n  const promise = runloop.start();\n  if (options && 'keep' in options) keep = options.keep;\n\n  let i = pairs.length;\n  while (i--) {\n    const model = pairs[i][0];\n    const value = pairs[i][1];\n    const keypath = pairs[i][2];\n\n    if (!model) {\n      runloop.end();\n      throw new Error(`Failed to set invalid keypath '${keypath}'`);\n    }\n\n    if (deep) deepSet(model, value);\n    else if (shuffle) {\n      let array = value;\n      const target = model.get();\n      // shuffle target array with itself\n      if (!array) array = target;\n\n      // if there's not an array there yet, go ahead and set\n      if (target === undefined) {\n        model.set(array);\n      } else {\n        if (!isArray(target) || !isArray(array)) {\n          runloop.end();\n          throw new Error('You cannot merge an array with a non-array');\n        }\n\n        const comparator = getComparator(shuffle);\n        model.merge(array, comparator);\n      }\n    } else model.set(value);\n  }\n\n  runloop.end();\n\n  keep = k;\n\n  return promise;\n}\n\nconst star = /\\*/;\nexport function gather(ractive, keypath, base, isolated) {\n  if (!base && (keypath[0] === '.' || keypath[1] === '^')) {\n    warnIfDebug(\n      `Attempted to set a relative keypath from a non-relative context. You can use a context object to set relative keypaths.`\n    );\n    return [];\n  }\n\n  const keys = splitKeypath(keypath);\n  const model = base || ractive.viewmodel;\n\n  if (star.test(keypath)) {\n    return model.findMatches(keys);\n  } else {\n    if (model === ractive.viewmodel) {\n      // allow implicit mappings\n      if (\n        ractive.component &&\n        !ractive.isolated &&\n        !model.has(keys[0]) &&\n        keypath[0] !== '@' &&\n        keypath[0] &&\n        !isolated\n      ) {\n        return [resolveReference(ractive.fragment || new FakeFragment(ractive), keypath)];\n      } else {\n        return [model.joinAll(keys)];\n      }\n    } else {\n      return [model.joinAll(keys)];\n    }\n  }\n}\n\nexport function build(ractive, keypath, value, isolated) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push.apply(sets, gather(ractive, k, null, isolated).map(m => [m, keypath[k], k]));\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push.apply(sets, gather(ractive, keypath, null, isolated).map(m => [m, value, keypath]));\n  }\n\n  return sets;\n}\n\nconst deepOpts = { virtual: false };\nfunction deepSet(model, value) {\n  const dest = model.get(false, deepOpts);\n\n  // if dest doesn't exist, just set it\n  if (dest == null || !isObjectType(value)) return model.set(value);\n  if (!isObjectType(dest)) return model.set(value);\n\n  for (const k in value) {\n    if (hasOwn(value, k)) {\n      deepSet(model.joinKey(k), value[k]);\n    }\n  }\n}\n\nconst comparators = {};\nfunction getComparator(option) {\n  if (option === true) return null; // use existing arrays\n  if (isFunction(option)) return option;\n\n  if (isString(option)) {\n    return comparators[option] || (comparators[option] = thing => thing[option]);\n  }\n\n  throw new Error('If supplied, options.compare must be a string, function, or true'); // TODO link to docs\n}\n","import { isNumeric, isString } from 'utils/is';\nimport { build, set } from 'shared/set';\n\nconst errorMessage = 'Cannot add to a non-numeric value';\n\nexport default function add(ractive, keypath, d, options) {\n  if (!isString(keypath) || !isNumeric(d)) {\n    throw new Error('Bad arguments');\n  }\n\n  const sets = build(ractive, keypath, d, options && options.isolated);\n\n  return set(\n    sets.map(pair => {\n      const [model, add] = pair;\n      const value = model.get();\n      if (!isNumeric(add) || !isNumeric(value)) throw new Error(errorMessage);\n      return [model, value + add];\n    })\n  );\n}\n","import runloop from 'src/global/runloop';\nimport easing from 'src/Ractive/static/easing';\nimport interpolate from 'shared/interpolate';\nimport { isEqual, isFunction, isObjectType } from 'utils/is';\nimport noop from 'utils/noop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { defineProperty, keys as objectKeys } from 'utils/object';\n\nfunction immediate(value) {\n  const result = Promise.resolve(value);\n  defineProperty(result, 'stop', { value: noop });\n  return result;\n}\n\nconst linear = easing.linear;\n\nfunction getOptions(options, instance) {\n  options = options || {};\n\n  let easing;\n  if (options.easing) {\n    easing = isFunction(options.easing) ? options.easing : instance.easing[options.easing];\n  }\n\n  return {\n    easing: easing || linear,\n    duration: 'duration' in options ? options.duration : 400,\n    complete: options.complete || noop,\n    step: options.step || noop,\n    interpolator: options.interpolator\n  };\n}\n\nexport function animate(ractive, model, to, options) {\n  options = getOptions(options, ractive);\n  const from = model.get();\n\n  // don't bother animating values that stay the same\n  if (isEqual(from, to)) {\n    options.complete(options.to);\n    return immediate(to);\n  }\n\n  const interpolator = interpolate(from, to, ractive, options.interpolator);\n\n  // if we can't interpolate the value, set it immediately\n  if (!interpolator) {\n    runloop.start();\n    model.set(to);\n    runloop.end();\n\n    return immediate(to);\n  }\n\n  return model.animate(from, to, options, interpolator);\n}\n\nexport default function Ractive$animate(keypath, to, options) {\n  if (isObjectType(keypath)) {\n    const keys = objectKeys(keypath);\n\n    throw new Error(`ractive.animate(...) no longer supports objects. Instead of ractive.animate({\n  ${keys.map(key => `'${key}': ${keypath[key]}`).join('\\n  ')}\n}, {...}), do\n\n${keys.map(key => `ractive.animate('${key}', ${keypath[key]}, {...});`).join('\\n')}\n`);\n  }\n\n  return animate(this, this.viewmodel.joinAll(splitKeypath(keypath)), to, options);\n}\n","import { enqueue, dequeue } from './eventStack';\n\nconst initStars = {};\nconst bubbleStars = {};\n\n// cartesian product of name parts and stars\n// adjusted appropriately for special cases\nfunction variants(name, initial) {\n  const map = initial ? initStars : bubbleStars;\n  if (map[name]) return map[name];\n\n  const parts = name.split('.');\n  const result = [];\n  let base = false;\n\n  // initial events the implicit namespace of 'this'\n  if (initial) {\n    parts.unshift('this');\n    base = true;\n  }\n\n  // use max - 1 bits as a bitmap to pick a part or a *\n  // need to skip the full star case if the namespace is synthetic\n  const max = Math.pow(2, parts.length) - (initial ? 1 : 0);\n  for (let i = 0; i < max; i++) {\n    const join = [];\n    for (let j = 0; j < parts.length; j++) {\n      join.push(1 & (i >> j) ? '*' : parts[j]);\n    }\n    result.unshift(join.join('.'));\n  }\n\n  if (base) {\n    // include non-this-namespaced versions\n    if (parts.length > 2) {\n      result.push.apply(result, variants(name, false));\n    } else {\n      result.push('*');\n      result.push(name);\n    }\n  }\n\n  map[name] = result;\n  return result;\n}\n\nexport default function fireEvent(ractive, eventName, context, args = []) {\n  if (!eventName) {\n    return;\n  }\n\n  context.name = eventName;\n  args.unshift(context);\n\n  const eventNames = ractive._nsSubs ? variants(eventName, true) : ['*', eventName];\n\n  return fireEventAs(ractive, eventNames, context, args, true);\n}\n\nfunction fireEventAs(ractive, eventNames, context, args, initialFire = false) {\n  let bubble = true;\n\n  if (initialFire || ractive._nsSubs) {\n    enqueue(ractive, context);\n\n    let i = eventNames.length;\n    while (i--) {\n      if (eventNames[i] in ractive._subs) {\n        bubble = notifySubscribers(ractive, ractive._subs[eventNames[i]], context, args) && bubble;\n      }\n    }\n\n    dequeue(ractive);\n  }\n\n  if (ractive.parent && bubble) {\n    if (initialFire && ractive.component) {\n      const fullName = ractive.component.name + '.' + eventNames[eventNames.length - 1];\n      eventNames = variants(fullName, false);\n\n      if (context && !context.component) {\n        context.component = ractive;\n      }\n    }\n\n    bubble = fireEventAs(ractive.parent, eventNames, context, args);\n  }\n\n  return bubble;\n}\n\nfunction notifySubscribers(ractive, subscribers, context, args) {\n  let originalEvent = null;\n  let stopEvent = false;\n\n  // subscribers can be modified inflight, e.g. \"once\" functionality\n  // so we need to copy to make sure everyone gets called\n  subscribers = subscribers.slice();\n\n  for (let i = 0, len = subscribers.length; i < len; i += 1) {\n    if (!subscribers[i].off && subscribers[i].handler.apply(ractive, args) === false) {\n      stopEvent = true;\n    }\n  }\n\n  if (context && stopEvent && (originalEvent = context.event)) {\n    originalEvent.preventDefault && originalEvent.preventDefault();\n    originalEvent.stopPropagation && originalEvent.stopPropagation();\n  }\n\n  return !stopEvent;\n}\n","import fireEvent from './fireEvent';\nimport getRactiveContext from '../shared/getRactiveContext';\n\nexport default class Hook {\n  constructor(event) {\n    this.event = event;\n    this.method = 'on' + event;\n  }\n\n  fire(ractive, arg) {\n    const context = getRactiveContext(ractive);\n\n    if (ractive[this.method]) {\n      arg ? ractive[this.method](context, arg) : ractive[this.method](context);\n    }\n\n    fireEvent(ractive, this.event, context, arg ? [arg, ractive] : [ractive]);\n  }\n}\n","import Hook from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { unrenderChild, updateAnchors } from 'shared/anchors';\n\nconst attachHook = new Hook('attachchild');\n\nexport default function attachChild(child, options = {}) {\n  const children = this._children;\n  let idx;\n\n  if (child.parent && child.parent !== this)\n    throw new Error(\n      `Instance ${child._guid} is already attached to a different instance ${\n        child.parent._guid\n      }. Please detach it from the other instance using detachChild first.`\n    );\n  else if (child.parent)\n    throw new Error(`Instance ${child._guid} is already attached to this instance.`);\n\n  const meta = {\n    instance: child,\n    ractive: this,\n    name: options.name || child.constructor.name || 'Ractive',\n    target: options.target || false,\n    bubble,\n    findNextNode\n  };\n  meta.nameOption = options.name;\n\n  // child is managing itself\n  if (!meta.target) {\n    meta.up = this.fragment;\n    meta.external = true;\n  } else {\n    let list;\n    if (!(list = children.byName[meta.target])) {\n      list = [];\n      this.set(`@this.children.byName.${meta.target}`, list);\n    }\n    idx = options.prepend ? 0 : options.insertAt !== undefined ? options.insertAt : list.length;\n  }\n\n  child.set({\n    '@this.parent': this,\n    '@this.root': this.root\n  });\n  child.component = meta;\n  children.push(meta);\n\n  attachHook.fire(child);\n\n  const promise = runloop.start();\n\n  if (meta.target) {\n    unrenderChild(meta);\n    this.splice(`@this.children.byName.${meta.target}`, idx, 0, meta);\n    updateAnchors(this, meta.target);\n  } else {\n    if (!child.isolated) child.viewmodel.attached(this.fragment);\n  }\n\n  runloop.end();\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n\nfunction bubble() {\n  runloop.addFragment(this.instance.fragment);\n}\n\nfunction findNextNode() {\n  if (this.anchor) return this.anchor.findNextNode();\n}\n","import Hook from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\n\nconst detachHook = new Hook('detach');\n\nexport default function Ractive$detach() {\n  if (this.isDetached) {\n    return this.el;\n  }\n\n  if (this.el) {\n    removeFromArray(this.el.__ractive_instances__, this);\n  }\n\n  this.el = this.fragment.detach();\n  this.isDetached = true;\n\n  detachHook.fire(this);\n  return this.el;\n}\n","import Hook from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\n\nconst detachHook = new Hook('detachchild');\n\nexport default function detachChild(child) {\n  const children = this._children;\n  let meta, index;\n\n  let i = children.length;\n  while (i--) {\n    if (children[i].instance === child) {\n      index = i;\n      meta = children[i];\n      break;\n    }\n  }\n\n  if (!meta || child.parent !== this)\n    throw new Error(`Instance ${child._guid} is not attached to this instance.`);\n\n  const promise = runloop.start();\n\n  if (meta.anchor) meta.anchor.removeChild(meta);\n  if (!child.isolated) child.viewmodel.detached();\n\n  runloop.end();\n\n  children.splice(index, 1);\n  if (meta.target) {\n    this.splice(\n      `@this.children.byName.${meta.target}`,\n      children.byName[meta.target].indexOf(meta),\n      1\n    );\n    updateAnchors(this, meta.target);\n  }\n  child.set({\n    '@this.parent': undefined,\n    '@this.root': child\n  });\n  child.component = null;\n\n  detachHook.fire(child);\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n","export const TEXT = 1;\nexport const INTERPOLATOR = 2;\nexport const TRIPLE = 3;\nexport const SECTION = 4;\nexport const INVERTED = 5;\nexport const CLOSING = 6;\nexport const ELEMENT = 7;\nexport const PARTIAL = 8;\nexport const COMMENT = 9;\nexport const DELIMCHANGE = 10;\nexport const ANCHOR = 11;\nexport const ATTRIBUTE = 13;\nexport const CLOSING_TAG = 14;\nexport const COMPONENT = 15;\nexport const YIELDER = 16;\nexport const INLINE_PARTIAL = 17;\nexport const DOCTYPE = 18;\nexport const ALIAS = 19;\n\nexport const NUMBER_LITERAL = 20;\nexport const STRING_LITERAL = 21;\nexport const ARRAY_LITERAL = 22;\nexport const OBJECT_LITERAL = 23;\nexport const BOOLEAN_LITERAL = 24;\nexport const REGEXP_LITERAL = 25;\n\nexport const GLOBAL = 26;\nexport const KEY_VALUE_PAIR = 27;\n\nexport const REFERENCE = 30;\nexport const REFINEMENT = 31;\nexport const MEMBER = 32;\nexport const PREFIX_OPERATOR = 33;\nexport const BRACKETED = 34;\nexport const CONDITIONAL = 35;\nexport const INFIX_OPERATOR = 36;\n\nexport const INVOCATION = 40;\n\nexport const SECTION_IF = 50;\nexport const SECTION_UNLESS = 51;\nexport const SECTION_EACH = 52;\nexport const SECTION_WITH = 53;\nexport const SECTION_IF_WITH = 54;\n\nexport const ELSE = 60;\nexport const ELSEIF = 61;\n\nexport const EVENT = 70;\nexport const DECORATOR = 71;\nexport const TRANSITION = 72;\nexport const BINDING_FLAG = 73;\nexport const DELEGATE_FLAG = 74;\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\nimport getNewIndices from 'shared/getNewIndices';\nimport { isArray } from 'utils/is';\n\nconst arrayProto = Array.prototype;\n\nexport default function(methodName) {\n  function path(keypath, ...args) {\n    return model(this.viewmodel.joinAll(splitKeypath(keypath)), args);\n  }\n\n  function model(mdl, args) {\n    let array = mdl.get();\n\n    if (!isArray(array)) {\n      if (array === undefined) {\n        array = [];\n        const result = arrayProto[methodName].apply(array, args);\n        const promise = runloop.start().then(() => result);\n        mdl.set(array);\n        runloop.end();\n        return promise;\n      } else {\n        throw new Error(\n          `shuffle array method ${methodName} called on non-array at ${mdl.getKeypath()}`\n        );\n      }\n    }\n\n    const newIndices = getNewIndices(array.length, methodName, args);\n    const result = arrayProto[methodName].apply(array, args);\n\n    const promise = runloop.start().then(() => result);\n    promise.result = result;\n\n    if (newIndices) {\n      if (mdl.shuffle) {\n        mdl.shuffle(newIndices);\n      } else {\n        // it's a computation, which don't have a shuffle, so just invalidate\n        mdl.mark();\n      }\n    } else {\n      mdl.set(result);\n    }\n\n    runloop.end();\n\n    return promise;\n  }\n\n  return { path, model };\n}\n","import Hook from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isString } from 'utils/is';\n\nconst updateHook = new Hook('update');\n\nexport function update(ractive, model, options) {\n  // if the parent is wrapped, the adaptor will need to be updated before\n  // updating on this keypath\n  if (model.parent && model.parent.wrapper) {\n    model.parent.adapt();\n  }\n\n  const promise = runloop.start();\n\n  model.mark(options && options.force);\n\n  // notify upstream of changes\n  model.notifyUpstream();\n\n  runloop.end();\n\n  updateHook.fire(ractive, model);\n\n  return promise;\n}\n\nexport default function Ractive$update(keypath, options) {\n  let opts, path;\n\n  if (isString(keypath)) {\n    path = splitKeypath(keypath);\n    opts = options;\n  } else {\n    opts = keypath;\n  }\n\n  return update(this, path ? this.viewmodel.joinAll(path) : this.viewmodel, opts);\n}\n","import resolveReference from 'src/view/resolvers/resolveReference';\nimport Model from 'src/model/Model';\nimport { isNumeric, isObject, isNumber, isObjectType, isString } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport findElement from 'src/view/items/shared/findElement';\nimport { set as sharedSet } from './set';\nimport makeArrayMethod from '../Ractive/prototype/shared/makeArrayMethod';\nimport { animate as protoAnimate } from '../Ractive/prototype/animate';\nimport { update as protoUpdate } from '../Ractive/prototype/update';\nimport getRactiveContext, { extern, findParentWithContext } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\nimport { ELEMENT, EVENT } from 'config/types';\n\nconst modelPush = makeArrayMethod('push').model;\nconst modelPop = makeArrayMethod('pop').model;\nconst modelShift = makeArrayMethod('shift').model;\nconst modelUnshift = makeArrayMethod('unshift').model;\nconst modelSort = makeArrayMethod('sort').model;\nconst modelSplice = makeArrayMethod('splice').model;\nconst modelReverse = makeArrayMethod('reverse').model;\n\nclass ContextData extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.value = {};\n    this.ractive = options.ractive;\n    this.adaptors = [];\n    this.context = options.context;\n  }\n\n  getKeypath() {\n    return '@context.data';\n  }\n}\n\nexport default class Context {\n  constructor(fragment, element) {\n    this.fragment = fragment;\n    this.element = element || findElement(fragment);\n    this.node = this.element && this.element.node;\n    this.ractive = fragment.ractive;\n    this.root = this;\n  }\n\n  get decorators() {\n    const items = {};\n    if (!this.element) return items;\n    this.element.decorators.forEach(d => (items[d.name] = d.handle));\n    return items;\n  }\n\n  get _data() {\n    return (\n      this.model ||\n      (this.root.model = new ContextData({\n        ractive: this.ractive,\n        context: this.root\n      }))\n    );\n  }\n\n  // the usual mutation suspects\n  add(keypath, d, options) {\n    const num = isNumber(d) ? +d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value + val];\n      }),\n      opts\n    );\n  }\n\n  animate(keypath, value, options) {\n    const model = findModel(this, keypath).model;\n    return protoAnimate(this.ractive, model, value, options);\n  }\n\n  // get relative keypaths and values\n  get(keypath) {\n    if (!keypath) return this.fragment.findContext().get(true);\n\n    const { model } = findModel(this, keypath);\n\n    return model ? model.get(true) : undefined;\n  }\n\n  getParent(component) {\n    let fragment = this.fragment;\n\n    if (fragment.context)\n      fragment = findParentWithContext(fragment.parent || (component && fragment.componentParent));\n    else {\n      fragment = findParentWithContext(fragment.parent || (component && fragment.componentParent));\n      if (fragment)\n        fragment = findParentWithContext(\n          fragment.parent || (component && fragment.componentParent)\n        );\n    }\n\n    if (!fragment || fragment === this.fragment) return;\n    else return fragment.getContext();\n  }\n\n  hasListener(name, bubble) {\n    let el = this.element || this.fragment.owner;\n\n    do {\n      if (el.template.t === ELEMENT) {\n        if (findEvent(el, name)) return true;\n      }\n      el = el.up && el.up.owner;\n      if (el && el.component) el = el.component;\n    } while (el && bubble);\n  }\n\n  link(source, dest) {\n    const there = findModel(this, source).model;\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    here.link(there, source);\n    runloop.end();\n    return promise;\n  }\n\n  listen(event, handler) {\n    const el = this.element;\n    el.on(event, handler);\n    return {\n      cancel() {\n        el.off(event, handler);\n      }\n    };\n  }\n\n  observe(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observe(keypath, callback, options);\n  }\n\n  observeOnce(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observeOnce(keypath, callback, options);\n  }\n\n  pop(keypath) {\n    return modelPop(findModel(this, keypath).model, []);\n  }\n\n  push(keypath, ...values) {\n    return modelPush(findModel(this, keypath).model, values);\n  }\n\n  raise(name, event, ...args) {\n    let el = this.element;\n    let ev;\n\n    while (el) {\n      if (el.component) el = el.component;\n      ev = findEvent(el, name);\n      if (ev) {\n        return ev.fire(\n          ev.element.getContext(\n            event || {},\n            event && !('original' in event) ? { original: {} } : {}\n          ),\n          args\n        );\n      }\n\n      el = el.up && el.up.owner;\n    }\n  }\n\n  readLink(keypath, options) {\n    return this.ractive.readLink(this.resolve(keypath), options);\n  }\n\n  resolve(path, ractive) {\n    const { model, instance } = findModel(this, path);\n    return model ? model.getKeypath(ractive || instance) : path;\n  }\n\n  reverse(keypath) {\n    return modelReverse(findModel(this, keypath).model, []);\n  }\n\n  set(keypath, value, options) {\n    return sharedSet(build(this, keypath, value), options);\n  }\n\n  shift(keypath) {\n    return modelShift(findModel(this, keypath).model, []);\n  }\n\n  splice(keypath, index, drop, ...add) {\n    add.unshift(index, drop);\n    return modelSplice(findModel(this, keypath).model, add);\n  }\n\n  sort(keypath) {\n    return modelSort(findModel(this, keypath).model, []);\n  }\n\n  subtract(keypath, d, options) {\n    const num = isNumber(d) ? d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value - val];\n      }),\n      opts\n    );\n  }\n\n  toggle(keypath, options) {\n    const { model } = findModel(this, keypath);\n    return sharedSet([[model, !model.get()]], options);\n  }\n\n  unlink(dest) {\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    if (here.owner && here.owner._link) here.owner.unlink();\n    runloop.end();\n    return promise;\n  }\n\n  unlisten(event, handler) {\n    this.element.off(event, handler);\n  }\n\n  unshift(keypath, ...add) {\n    return modelUnshift(findModel(this, keypath).model, add);\n  }\n\n  update(keypath, options) {\n    return protoUpdate(this.ractive, findModel(this, keypath).model, options);\n  }\n\n  updateModel(keypath, cascade) {\n    const { model } = findModel(this, keypath);\n    const promise = runloop.start();\n    model.updateFromBindings(cascade);\n    runloop.end();\n    return promise;\n  }\n\n  // two-way binding related helpers\n  isBound() {\n    const { model } = this.getBindingModel(this);\n    return !!model;\n  }\n\n  getBindingPath(ractive) {\n    const { model, instance } = this.getBindingModel(this);\n    if (model) return model.getKeypath(ractive || instance);\n  }\n\n  getBinding() {\n    const { model } = this.getBindingModel(this);\n    if (model) return model.get(true);\n  }\n\n  getBindingModel(ctx) {\n    const el = ctx.element;\n    return { model: el.binding && el.binding.model, instance: el.up.ractive };\n  }\n\n  setBinding(value) {\n    const { model } = this.getBindingModel(this);\n    return sharedSet([[model, value]]);\n  }\n}\n\nContext.forRactive = getRactiveContext;\n// circular deps are fun\nextern.Context = Context;\n\n// TODO: at some point perhaps this could support relative * keypaths?\nfunction build(ctx, keypath, value) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push([findModel(ctx, k).model, keypath[k]]);\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push([findModel(ctx, keypath).model, value]);\n  }\n\n  return sets;\n}\n\nfunction findModel(ctx, path) {\n  const frag = ctx.fragment;\n\n  if (!isString(path)) {\n    return { model: frag.findContext(), instance: path };\n  }\n\n  return { model: resolveReference(frag, path), instance: frag.ractive };\n}\n\nfunction findEvent(el, name) {\n  return (\n    el.attributes && el.attributes.find(a => a.template.t === EVENT && ~a.template.n.indexOf(name))\n  );\n}\n","import { doc } from 'config/environment';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { isString } from 'utils/is';\n\nconst query = doc && doc.querySelector;\n\nexport default function getContext(node) {\n  if (isString(node) && query) {\n    node = query.call(document, node);\n  }\n\n  let instances;\n  if (node) {\n    if (node._ractive) {\n      return node._ractive.proxy.getContext();\n    } else if ((instances = node.__ractive_instances__) && instances.length === 1) {\n      return getRactiveContext(instances[0]);\n    }\n  }\n}\n\nexport function getNodeInfo(node) {\n  warnOnceIfDebug(\n    `getNodeInfo has been renamed to getContext, and the getNodeInfo alias will be removed in a future release.`\n  );\n  return getContext(node);\n}\n","import { isClient, svg, vendors, win, doc } from 'config/environment';\nimport { html } from 'config/namespaces';\nimport { isString, isNumber } from 'utils/is';\n\nlet createElement, matches, div, methodNames, unprefixed, prefixed, i, j, makeFunction;\n\n// Test for SVG support\nif (!svg) {\n  /* istanbul ignore next */\n  createElement = (type, ns, extend) => {\n    if (ns && ns !== html) {\n      throw \"This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you're trying to render SVG in an older browser. See http://ractive.js.org/support/#svgs for more information\";\n    }\n\n    return extend ? doc.createElement(type, extend) : doc.createElement(type);\n  };\n} else {\n  createElement = (type, ns, extend) => {\n    if (!ns || ns === html) {\n      return extend ? doc.createElement(type, extend) : doc.createElement(type);\n    }\n\n    return extend ? doc.createElementNS(ns, type, extend) : doc.createElementNS(ns, type);\n  };\n}\n\nexport function createDocumentFragment() {\n  return doc.createDocumentFragment();\n}\n\nfunction getElement(input) {\n  let output;\n\n  if (!input || typeof input === 'boolean') {\n    return;\n  }\n\n  /* istanbul ignore next */\n  if (!win || !doc || !input) {\n    return null;\n  }\n\n  // We already have a DOM node - no work to do. (Duck typing alert!)\n  if (input.nodeType) {\n    return input;\n  }\n\n  // Get node from string\n  if (isString(input)) {\n    // try ID first\n    output = doc.getElementById(input);\n\n    // then as selector, if possible\n    if (!output && doc.querySelector) {\n      try {\n        output = doc.querySelector(input);\n      } catch (e) {\n        /* this space intentionally left blank */\n      }\n    }\n\n    // did it work?\n    if (output && output.nodeType) {\n      return output;\n    }\n  }\n\n  // If we've been given a collection (jQuery, Zepto etc), extract the first item\n  if (input[0] && input[0].nodeType) {\n    return input[0];\n  }\n\n  return null;\n}\n\nif (!isClient) {\n  matches = null;\n} else {\n  div = createElement('div');\n  methodNames = ['matches', 'matchesSelector'];\n\n  makeFunction = function(methodName) {\n    return function(node, selector) {\n      return node[methodName](selector);\n    };\n  };\n\n  i = methodNames.length;\n\n  while (i-- && !matches) {\n    unprefixed = methodNames[i];\n\n    if (div[unprefixed]) {\n      matches = makeFunction(unprefixed);\n    } else {\n      j = vendors.length;\n      while (j--) {\n        prefixed = vendors[i] + unprefixed.substr(0, 1).toUpperCase() + unprefixed.substring(1);\n\n        if (div[prefixed]) {\n          matches = makeFunction(prefixed);\n          break;\n        }\n      }\n    }\n  }\n\n  // IE8... and apparently phantom some?\n  /* istanbul ignore next */\n  if (!matches) {\n    matches = function(node, selector) {\n      let parentNode, i;\n\n      parentNode = node.parentNode;\n\n      if (!parentNode) {\n        // empty dummy <div>\n        div.innerHTML = '';\n\n        parentNode = div;\n        node = node.cloneNode();\n\n        div.appendChild(node);\n      }\n\n      const nodes = parentNode.querySelectorAll(selector);\n\n      i = nodes.length;\n      while (i--) {\n        if (nodes[i] === node) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  }\n}\n\nfunction detachNode(node) {\n  // stupid ie\n  // eslint-disable-next-line valid-typeof\n  if (node && typeof node.parentNode !== 'unknown' && node.parentNode) {\n    node.parentNode.removeChild(node);\n  }\n\n  return node;\n}\n\nfunction safeToStringValue(value) {\n  return value == null || (isNumber(value) && isNaN(value)) || !value.toString ? '' : '' + value;\n}\n\nfunction safeAttributeString(string) {\n  return safeToStringValue(string)\n    .replace(/&/g, '&amp;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\nexport { createElement, detachNode, getElement, matches, safeToStringValue, safeAttributeString };\n","export const html = 'http://www.w3.org/1999/xhtml';\nexport const mathml = 'http://www.w3.org/1998/Math/MathML';\nexport const svg = 'http://www.w3.org/2000/svg';\nexport const xlink = 'http://www.w3.org/1999/xlink';\nexport const xml = 'http://www.w3.org/XML/1998/namespace';\nexport const xmlns = 'http://www.w3.org/2000/xmlns';\n\nexport default { html, mathml, svg, xlink, xml, xmlns };\n","import Hook from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\n\nconst insertHook = new Hook('insert');\n\nexport default function Ractive$insert(target, anchor) {\n  if (!this.fragment.rendered) {\n    // TODO create, and link to, documentation explaining this\n    throw new Error(\n      'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.'\n    );\n  }\n\n  target = getElement(target);\n  anchor = getElement(anchor) || null;\n\n  if (!target) {\n    throw new Error('You must specify a valid target to insert into');\n  }\n\n  target.insertBefore(this.detach(), anchor);\n  this.el = target;\n\n  (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(this);\n  this.isDetached = false;\n\n  fireInsertHook(this);\n}\n\nfunction fireInsertHook(ractive) {\n  insertHook.fire(ractive);\n\n  ractive.findAllComponents('*').forEach(child => {\n    fireInsertHook(child.instance);\n  });\n}\n","import { isEqual, isFunction } from 'utils/is';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\nimport { rebindMatch } from 'shared/rebind';\nimport { create } from 'utils/object';\n\nexport default class Observer {\n  constructor(ractive, model, callback, options) {\n    this.context = options.context || ractive;\n    this.callback = callback;\n    this.ractive = ractive;\n    this.keypath = options.keypath;\n    this.options = options;\n\n    if (model) this.resolved(model);\n\n    if (isFunction(options.old)) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    if (options.init !== false) {\n      this.dirty = true;\n      this.dispatch();\n    } else {\n      updateOld(this);\n    }\n\n    this.dirty = false;\n  }\n\n  cancel() {\n    this.cancelled = true;\n    if (this.model) {\n      this.model.unregister(this);\n    } else {\n      this.resolver.unbind();\n    }\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    if (!this.cancelled) {\n      this.callback.call(this.context, this.newValue, this.oldValue, this.keypath);\n      updateOld(this, true);\n      this.dirty = false;\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty) {\n      const newValue = this.model.get();\n      if (isEqual(newValue, this.oldValue)) return;\n\n      this.newValue = newValue;\n\n      if (this.options.strict && this.newValue === this.oldValue) return;\n\n      runloop.addObserver(this, this.options.defer);\n      this.dirty = true;\n\n      if (this.options.once) runloop.scheduleTask(() => this.cancel());\n    } else {\n      // make sure the newValue stays updated in case this observer gets touched multiple times in one loop\n      this.newValue = this.model.get();\n    }\n  }\n\n  rebind(next, previous) {\n    next = rebindMatch(this.keypath, next, previous);\n    if (next === this.model) return false;\n\n    if (this.model) this.model.unregister(this);\n    if (next) next.addShuffleTask(() => this.resolved(next));\n  }\n\n  resolved(model) {\n    this.model = model;\n\n    this.oldValue = undefined;\n    this.newValue = model.get();\n\n    model.register(this);\n  }\n}\n\nfunction updateOld(observer, fresh) {\n  const next = fresh\n    ? observer.model\n      ? observer.model.get()\n      : observer.newValue\n    : observer.newValue;\n  observer.oldValue = observer.oldFn\n    ? observer.oldFn.call(observer.oldContext, undefined, next, observer.keypath)\n    : next;\n}\n","import { escapeKey } from 'shared/keypaths';\nimport { removeFromArray } from 'utils/array';\nimport { isArray, isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport { create, keys } from 'utils/object';\n\nconst star = /\\*+/g;\n\nexport default class PatternObserver {\n  constructor(ractive, baseModel, keys, callback, options) {\n    this.context = options.context || ractive;\n    this.ractive = ractive;\n    this.baseModel = baseModel;\n    this.keys = keys;\n    this.callback = callback;\n\n    const pattern = keys.join('\\\\.').replace(star, '(.+)');\n    const baseKeypath = (this.baseKeypath = baseModel.getKeypath(ractive));\n    this.pattern = new RegExp(`^${baseKeypath ? baseKeypath + '\\\\.' : ''}${pattern}$`);\n    this.recursive = keys.length === 1 && keys[0] === '**';\n    if (this.recursive) this.keys = ['*'];\n    if (options.old) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    this.oldValues = {};\n    this.newValues = {};\n\n    this.defer = options.defer;\n    this.once = options.once;\n    this.strict = options.strict;\n\n    this.dirty = false;\n    this.changed = [];\n    this.partial = false;\n    this.links = options.links;\n\n    const models = baseModel.findMatches(this.keys);\n\n    models.forEach(model => {\n      this.newValues[model.getKeypath(this.ractive)] = model.get();\n    });\n\n    if (options.init !== false) {\n      this.dispatch();\n    } else {\n      updateOld(this, this.newValues);\n    }\n\n    baseModel.registerPatternObserver(this);\n  }\n\n  cancel() {\n    this.baseModel.unregisterPatternObserver(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    const newValues = this.newValues;\n    this.newValues = {};\n    keys(newValues).forEach(keypath => {\n      const newValue = newValues[keypath];\n      const oldValue = this.oldValues[keypath];\n\n      if (this.strict && newValue === oldValue) return;\n      if (isEqual(newValue, oldValue)) return;\n\n      let args = [newValue, oldValue, keypath];\n      if (keypath) {\n        const wildcards = this.pattern.exec(keypath);\n        if (wildcards) {\n          args = args.concat(wildcards.slice(1));\n        }\n      }\n\n      this.callback.apply(this.context, args);\n    });\n\n    updateOld(this, newValues, this.partial);\n\n    this.dirty = false;\n  }\n\n  notify(key) {\n    this.changed.push(key);\n  }\n\n  shuffle(newIndices) {\n    if (!isArray(this.baseModel.value)) return;\n\n    const max = this.baseModel.value.length;\n\n    for (let i = 0; i < newIndices.length; i++) {\n      if (newIndices[i] === -1 || newIndices[i] === i) continue;\n      this.changed.push([i]);\n    }\n\n    for (let i = newIndices.touchedFrom; i < max; i++) {\n      this.changed.push([i]);\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty || this.changed.length) {\n      if (!this.dirty) this.newValues = {};\n\n      if (!this.changed.length) {\n        this.baseModel.findMatches(this.keys).forEach(model => {\n          const keypath = model.getKeypath(this.ractive);\n          this.newValues[keypath] = model.get();\n        });\n        this.partial = false;\n      } else {\n        let count = 0;\n\n        if (this.recursive) {\n          this.changed.forEach(keys => {\n            const model = this.baseModel.joinAll(keys);\n            if (model.isLink && !this.links) return;\n            count++;\n            this.newValues[model.getKeypath(this.ractive)] = model.get();\n          });\n        } else {\n          const ok = this.baseModel.isRoot\n            ? this.changed.map(keys => keys.map(escapeKey).join('.'))\n            : this.changed.map(keys => this.baseKeypath + '.' + keys.map(escapeKey).join('.'));\n\n          this.baseModel.findMatches(this.keys).forEach(model => {\n            const keypath = model.getKeypath(this.ractive);\n            const check = k => {\n              return (\n                (k.indexOf(keypath) === 0 &&\n                  (k.length === keypath.length || k[keypath.length] === '.')) ||\n                (keypath.indexOf(k) === 0 &&\n                  (k.length === keypath.length || keypath[k.length] === '.'))\n              );\n            };\n\n            // is this model on a changed keypath?\n            if (ok.filter(check).length) {\n              count++;\n              this.newValues[keypath] = model.get();\n            }\n          });\n        }\n\n        // no valid change triggered, so bail to avoid breakage\n        if (!count) return;\n\n        this.partial = true;\n      }\n\n      runloop.addObserver(this, this.defer);\n      this.dirty = true;\n      this.changed.length = 0;\n\n      if (this.once) this.cancel();\n    }\n  }\n}\n\nfunction updateOld(observer, vals, partial) {\n  const olds = observer.oldValues;\n\n  if (observer.oldFn) {\n    if (!partial) observer.oldValues = {};\n\n    keys(vals).forEach(k => {\n      const args = [olds[k], vals[k], k];\n      const parts = observer.pattern.exec(k);\n      if (parts) {\n        args.push.apply(args, parts.slice(1));\n      }\n      observer.oldValues[k] = observer.oldFn.apply(observer.oldContext, args);\n    });\n  } else {\n    if (partial) {\n      keys(vals).forEach(k => (olds[k] = vals[k]));\n    } else {\n      observer.oldValues = vals;\n    }\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport { isArray } from 'utils/is';\nimport runloop from 'src/global/runloop';\n\nfunction negativeOne() {\n  return -1;\n}\n\nexport default class ArrayObserver {\n  constructor(ractive, model, callback, options) {\n    this.ractive = ractive;\n    this.model = model;\n    this.keypath = model.getKeypath();\n    this.callback = callback;\n    this.options = options;\n\n    this.pending = null;\n\n    model.register(this);\n\n    if (options.init !== false) {\n      this.sliced = [];\n      this.shuffle([]);\n      this.dispatch();\n    } else {\n      this.sliced = this.slice();\n    }\n  }\n\n  cancel() {\n    this.model.unregister(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    this.callback(this.pending);\n    this.pending = null;\n    if (this.options.once) this.cancel();\n  }\n\n  handleChange(path) {\n    if (this.pending) {\n      // post-shuffle\n      runloop.addObserver(this, this.options.defer);\n    } else if (!path) {\n      // entire array changed\n      this.shuffle(this.sliced.map(negativeOne));\n      this.handleChange();\n    }\n  }\n\n  shuffle(newIndices) {\n    const newValue = this.slice();\n\n    const inserted = [];\n    const deleted = [];\n    let start;\n\n    const hadIndex = {};\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      hadIndex[newIndex] = true;\n\n      if (newIndex !== oldIndex && start === undefined) {\n        start = oldIndex;\n      }\n\n      if (newIndex === -1) {\n        deleted.push(this.sliced[oldIndex]);\n      }\n    });\n\n    if (start === undefined) start = newIndices.length;\n\n    const len = newValue.length;\n    for (let i = 0; i < len; i += 1) {\n      if (!hadIndex[i]) inserted.push(newValue[i]);\n    }\n\n    this.pending = { inserted, deleted, start };\n    this.sliced = newValue;\n  }\n\n  slice() {\n    const value = this.model.get();\n    return isArray(value) ? value.slice() : [];\n  }\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { assign } from 'utils/object';\n\nconst onceOptions = { init: false, once: true };\n\nexport default function observeOnce(keypath, callback, options) {\n  if (isObject(keypath) || isFunction(keypath)) {\n    options = assign(callback || {}, onceOptions);\n    return this.observe(keypath, options);\n  }\n\n  options = assign(options || {}, onceOptions);\n  return this.observe(keypath, callback, options);\n}\n","export default str => str.trim();\n","export default str => str !== '';\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('pop').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('push').path;\n","import { doc } from '../config/environment';\n\nconst PREFIX = '/* Ractive.js component styles */';\n\n// Holds current definitions of styles.\nconst styleDefinitions = [];\n\n// Flag to tell if we need to update the CSS\nlet isDirty = false;\n\n// These only make sense on the browser. See additional setup below.\nlet styleElement = null;\nlet useCssText = null;\n\nexport function addCSS(styleDefinition) {\n  styleDefinitions.push(styleDefinition);\n  isDirty = true;\n}\n\nexport function applyCSS(force) {\n  const styleElement = style();\n\n  // Apply only seems to make sense when we're in the DOM. Server-side renders\n  // can call toCSS to get the updated CSS.\n  if (!styleElement || (!force && !isDirty)) return;\n\n  if (useCssText) {\n    styleElement.styleSheet.cssText = getCSS(null);\n  } else {\n    styleElement.innerHTML = getCSS(null);\n  }\n\n  isDirty = false;\n}\n\nexport function getCSS(cssIds) {\n  const filteredStyleDefinitions = cssIds\n    ? styleDefinitions.filter(style => ~cssIds.indexOf(style.id))\n    : styleDefinitions;\n\n  filteredStyleDefinitions.forEach(d => (d.applied = true));\n\n  return filteredStyleDefinitions.reduce(\n    (styles, style) => `${styles ? `${styles}\\n\\n/* {${style.id}} */\\n${style.styles}` : ''}`,\n    PREFIX\n  );\n}\n\nfunction style() {\n  // If we're on the browser, additional setup needed.\n  if (doc && !styleElement) {\n    styleElement = doc.createElement('style');\n    styleElement.type = 'text/css';\n    styleElement.setAttribute('data-ractive-css', '');\n\n    doc.getElementsByTagName('head')[0].appendChild(styleElement);\n\n    useCssText = !!styleElement.styleSheet;\n  }\n\n  return styleElement;\n}\n","import { ensureArray, combine } from 'utils/array';\n\nexport default {\n  extend: (Parent, proto, options) => {\n    proto.adapt = combine(proto.adapt, ensureArray(options.adapt));\n  },\n\n  init() {}\n};\n","const remove = /\\/\\*(?:[\\s\\S]*?)\\*\\//g;\nconst escape = /url\\(\\s*(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\1\\s*\\)|url\\((?:\\\\[\\s\\S]|[^)])*\\)|(['\"])(?:\\\\[\\s\\S]|(?!\\2).)*\\2/gi;\nconst value = /\\0(\\d+)/g;\n\n// Removes comments and strings from the given CSS to make it easier to parse.\n// Callback receives the cleaned CSS and a function which can be used to put\n// the removed strings back in place after parsing is done.\nexport default function(css, callback, additionalReplaceRules = []) {\n  const values = [];\n  const reconstruct = css => css.replace(value, (match, n) => values[n]);\n  css = css.replace(escape, match => `\\0${values.push(match) - 1}`).replace(remove, '');\n\n  additionalReplaceRules.forEach(pattern => {\n    css = css.replace(pattern, match => `\\0${values.push(match) - 1}`);\n  });\n\n  return callback(css, reconstruct);\n}\n","import cleanCss from 'utils/cleanCss';\n\nconst selectorsPattern = /(?:^|\\}|\\{)\\s*([^\\{\\}\\0]+)\\s*(?=\\{)/g;\nconst keyframesDeclarationPattern = /@keyframes\\s+[^\\{\\}]+\\s*\\{(?:[^{}]+|\\{[^{}]+})*}/gi;\nconst selectorUnitPattern = /((?:(?:\\[[^\\]]+\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\nconst excludePattern = /^(?:@|\\d+%)/;\nconst dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\nfunction trim(str) {\n  return str.trim();\n}\n\nfunction extractString(unit) {\n  return unit.str;\n}\n\nfunction transformSelector(selector, parent) {\n  const selectorUnits = [];\n  let match;\n\n  while ((match = selectorUnitPattern.exec(selector))) {\n    selectorUnits.push({\n      str: match[0],\n      base: match[1],\n      modifiers: match[2]\n    });\n  }\n\n  // For each simple selector within the selector, we need to create a version\n  // that a) combines with the id, and b) is inside the id\n  const base = selectorUnits.map(extractString);\n\n  const transformed = [];\n  let i = selectorUnits.length;\n\n  while (i--) {\n    const appended = base.slice();\n\n    // Pseudo-selectors should go after the attribute selector\n    const unit = selectorUnits[i];\n    appended[i] = unit.base + parent + unit.modifiers || '';\n\n    const prepended = base.slice();\n    prepended[i] = parent + ' ' + prepended[i];\n\n    transformed.push(appended.join(' '), prepended.join(' '));\n  }\n\n  return transformed.join(', ');\n}\n\nexport default function transformCss(css, id) {\n  const dataAttr = `[data-ractive-css~=\"{${id}}\"]`;\n\n  let transformed;\n\n  if (dataRvcGuidPattern.test(css)) {\n    transformed = css.replace(dataRvcGuidPattern, dataAttr);\n  } else {\n    transformed = cleanCss(\n      css,\n      (css, reconstruct) => {\n        css = css.replace(selectorsPattern, (match, $1) => {\n          // don't transform at-rules and keyframe declarations\n          if (excludePattern.test($1)) return match;\n\n          const selectors = $1.split(',').map(trim);\n          const transformed =\n            selectors.map(selector => transformSelector(selector, dataAttr)).join(', ') + ' ';\n\n          return match.replace($1, transformed);\n        });\n\n        return reconstruct(css);\n      },\n      [keyframesDeclarationPattern]\n    );\n  }\n\n  return transformed;\n}\n","import { SharedModel } from './SharedModel';\nimport { applyChanges } from '../../Ractive/static/styleSet';\n\nexport default class CSSModel extends SharedModel {\n  constructor(component) {\n    super(component.cssData, '@style');\n    this.component = component;\n  }\n\n  downstreamChanged(path, depth) {\n    if (this.locked) return;\n\n    const component = this.component;\n\n    component.extensions.forEach(e => {\n      const model = e._cssModel;\n      model.mark();\n      model.downstreamChanged(path, depth || 1);\n    });\n\n    if (!depth) {\n      applyChanges(component, true);\n    }\n  }\n}\n","import { addCSS } from 'src/global/css';\nimport transformCss from './transform';\nimport { uuid } from 'utils/id';\nimport { warnIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport { splitKeypath } from 'shared/keypaths';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperty } from 'utils/object';\nimport { isString, isFunction, isObjectType } from 'utils/is';\n\nconst hasCurly = /\\{/;\nexport default {\n  name: 'css',\n\n  // Called when creating a new component definition\n  extend: (Parent, proto, options, Child) => {\n    Child._cssIds = gatherIds(Parent);\n\n    defineProperty(Child, 'cssData', {\n      configurable: true,\n      value: assign(create(Parent.cssData), options.cssData || {})\n    });\n\n    defineProperty(Child, '_cssModel', {\n      configurable: true,\n      value: new CSSModel(Child)\n    });\n\n    if (options.css) initCSS(options, Child, proto);\n  },\n\n  // Called when creating a new component instance\n  init: (Parent, target, options) => {\n    if (!options.css) return;\n\n    warnIfDebug(`\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\n\nconst Component = Ractive.extend({\n\t...\n\tcss: '/* your css */',\n\t...\n});\n\nconst componentInstance = new Component({ ... })\n\t\t`);\n  }\n};\n\nfunction gatherIds(start) {\n  let cmp = start;\n  const ids = [];\n\n  while (cmp) {\n    if (cmp.prototype.cssId) ids.push(cmp.prototype.cssId);\n    cmp = cmp.Parent;\n  }\n\n  return ids;\n}\n\nexport function evalCSS(component, css) {\n  const cssData = component.cssData;\n  const model = component._cssModel;\n  const data = function data(path) {\n    return model.joinAll(splitKeypath(path)).get();\n  };\n  data.__proto__ = cssData;\n\n  const result = css.call(component, data);\n  return isString(result) ? result : '';\n}\n\nexport function initCSS(options, target, proto) {\n  let css =\n    isString(options.css) && !hasCurly.test(options.css)\n      ? getElement(options.css) || options.css\n      : options.css;\n\n  const id = options.cssId || uuid();\n\n  if (isObjectType(css)) {\n    css = 'textContent' in css ? css.textContent : css.innerHTML;\n  } else if (isFunction(css)) {\n    target._css = options.css;\n    css = evalCSS(target, css);\n  }\n\n  const def = (target._cssDef = { transform: !options.noCssTransform });\n\n  def.styles = def.transform ? transformCss(css, id) : css;\n  def.id = proto.cssId = id;\n  target._cssIds.push(id);\n\n  addCSS(target._cssDef);\n}\n","import { fatal, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { isArray, isObject, isFunction, isObjectType } from 'utils/is';\nimport bind from 'utils/bind';\n\nfunction validate(data) {\n  // Warn if userOptions.data is a non-POJO\n  if (data && data.constructor !== Object) {\n    if (isFunction(data)) {\n      // TODO do we need to support this in the new Ractive() case?\n    } else if (!isObjectType(data)) {\n      fatal(`data option must be an object or a function, \\`${data}\\` is not valid`);\n    } else {\n      warnIfDebug(\n        'If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged'\n      );\n    }\n  }\n}\n\nexport default {\n  name: 'data',\n\n  extend: (Parent, proto, options) => {\n    let key;\n    let value;\n\n    // check for non-primitives, which could cause mutation-related bugs\n    if (options.data && isObject(options.data)) {\n      for (key in options.data) {\n        value = options.data[key];\n\n        if (value && isObjectType(value)) {\n          if (isObject(value) || isArray(value)) {\n            warnIfDebug(`Passing a \\`data\\` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }`);\n          }\n        }\n      }\n    }\n\n    proto.data = combine(proto.data, options.data);\n  },\n\n  init: (Parent, ractive, options) => {\n    let result = combine(Parent.prototype.data, options.data);\n\n    if (isFunction(result)) result = result.call(ractive);\n\n    // bind functions to the ractive instance at the top level,\n    // unless it's a non-POJO (in which case alarm bells should ring)\n    if (result && result.constructor === Object) {\n      for (const prop in result) {\n        if (isFunction(result[prop])) {\n          const value = result[prop];\n          result[prop] = bind(value, ractive);\n          result[prop]._r_unbound = value;\n        }\n      }\n    }\n\n    return result || {};\n  },\n\n  reset(ractive) {\n    const result = this.init(ractive.constructor, ractive, ractive.viewmodel);\n    ractive.viewmodel.root.set(result);\n    return true;\n  }\n};\n\nfunction emptyData() {\n  return {};\n}\n\nfunction combine(parentValue, childValue) {\n  validate(childValue);\n\n  const parentIsFn = isFunction(parentValue);\n\n  // Very important, otherwise child instance can become\n  // the default data object on Ractive or a component.\n  // then ractive.set() ends up setting on the prototype!\n  if (!childValue && !parentIsFn) {\n    // this needs to be a function so that it can still inherit parent defaults\n    childValue = emptyData;\n  }\n\n  const childIsFn = isFunction(childValue);\n\n  // Fast path, where we just need to copy properties from\n  // parent to child\n  if (!parentIsFn && !childIsFn) {\n    return fromProperties(childValue, parentValue);\n  }\n\n  return function() {\n    const child = childIsFn ? callDataFunction(childValue, this) : childValue;\n    const parent = parentIsFn ? callDataFunction(parentValue, this) : parentValue;\n\n    return fromProperties(child, parent);\n  };\n}\n\nfunction callDataFunction(fn, context) {\n  const data = fn.call(context);\n\n  if (!data) return;\n\n  if (!isObjectType(data)) {\n    fatal('Data function must return an object');\n  }\n\n  if (data.constructor !== Object) {\n    warnOnceIfDebug(\n      'Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged'\n    );\n  }\n\n  return data;\n}\n\nfunction fromProperties(primary, secondary) {\n  if (primary && secondary) {\n    for (const key in secondary) {\n      if (!(key in primary)) {\n        primary[key] = secondary[key];\n      }\n    }\n\n    return primary;\n  }\n\n  return primary || secondary;\n}\n","export const TEMPLATE_VERSION = 4;\n","const pattern = /\\$\\{([^\\}]+)\\}/g;\n\nexport function fromExpression(body, length = 0) {\n  const args = new Array(length);\n\n  while (length--) {\n    args[length] = `_${length}`;\n  }\n\n  // Functions created directly with new Function() look like this:\n  //     function anonymous (_0 /**/) { return _0*2 }\n  //\n  // With this workaround, we get a little more compact:\n  //     function (_0){return _0*2}\n  return new Function([], `return function (${args.join(',')}){return(${body});};`)();\n}\n\nexport function fromComputationString(str, bindTo) {\n  let hasThis;\n\n  let functionBody =\n    'return (' +\n    str.replace(pattern, (match, keypath) => {\n      hasThis = true;\n      return `__ractive.get(\"${keypath}\")`;\n    }) +\n    ');';\n\n  if (hasThis) functionBody = `var __ractive = this; ${functionBody}`;\n  const fn = new Function(functionBody);\n  return hasThis ? fn.bind(bindTo) : fn;\n}\n","import { TEMPLATE_VERSION } from 'config/template';\nimport Parser from './Parser';\nimport readMustache from './converters/readMustache';\nimport readTriple from './converters/mustache/readTriple';\nimport readUnescaped from './converters/mustache/readUnescaped';\nimport readPartial from './converters/mustache/readPartial';\nimport readMustacheComment from './converters/mustache/readMustacheComment';\nimport readInterpolator from './converters/mustache/readInterpolator';\nimport readSection from './converters/mustache/readSection';\nimport readHtmlComment from './converters/readHtmlComment';\nimport readElement from './converters/readElement';\nimport readText from './converters/readText';\nimport readPartialDefinitionSection from './converters/readPartialDefinitionSection';\nimport readTemplate from './converters/readTemplate';\nimport cleanup from './utils/cleanup';\nimport insertExpressions from './utils/insertExpressions';\nimport shared from '../Ractive/shared';\nimport { create, keys } from 'utils/object';\n\n// See https://github.com/ractivejs/template-spec for information\n// about the Ractive template specification\n\nconst STANDARD_READERS = [\n  readPartial,\n  readUnescaped,\n  readSection,\n  readInterpolator,\n  readMustacheComment\n];\nconst TRIPLE_READERS = [readTriple];\n\nexport const READERS = [readMustache, readHtmlComment, readElement, readText];\nexport const PARTIAL_READERS = [readPartialDefinitionSection];\n\nconst defaultInterpolate = ['script', 'style', 'template'];\n\nconst StandardParser = Parser.extend({\n  init(str, options) {\n    const tripleDelimiters = options.tripleDelimiters || shared.defaults.tripleDelimiters;\n    const staticDelimiters = options.staticDelimiters || shared.defaults.staticDelimiters;\n    const staticTripleDelimiters =\n      options.staticTripleDelimiters || shared.defaults.staticTripleDelimiters;\n\n    this.standardDelimiters = options.delimiters || shared.defaults.delimiters;\n\n    this.tags = [\n      {\n        isStatic: false,\n        isTriple: false,\n        open: this.standardDelimiters[0],\n        close: this.standardDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: false,\n        isTriple: true,\n        open: tripleDelimiters[0],\n        close: tripleDelimiters[1],\n        readers: TRIPLE_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: false,\n        open: staticDelimiters[0],\n        close: staticDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: true,\n        open: staticTripleDelimiters[0],\n        close: staticTripleDelimiters[1],\n        readers: TRIPLE_READERS\n      }\n    ];\n\n    this.contextLines = options.contextLines || shared.defaults.contextLines;\n\n    this.sortMustacheTags();\n\n    this.sectionDepth = 0;\n    this.elementStack = [];\n\n    this.interpolate = create(options.interpolate || shared.defaults.interpolate || {});\n    this.interpolate.textarea = true;\n    defaultInterpolate.forEach(\n      t => (this.interpolate[t] = !options.interpolate || options.interpolate[t] !== false)\n    );\n\n    if (options.sanitize === true) {\n      options.sanitize = {\n        // blacklist from https://code.google.com/p/google-caja/source/browse/trunk/src/com/google/caja/lang/html/html4-elements-whitelist.json\n        elements: 'applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title'.split(\n          ' '\n        ),\n        eventAttributes: true\n      };\n    }\n\n    this.stripComments = options.stripComments !== false;\n    this.preserveWhitespace = options.preserveWhitespace;\n    this.sanitizeElements = options.sanitize && options.sanitize.elements;\n    this.sanitizeEventAttributes = options.sanitize && options.sanitize.eventAttributes;\n    this.includeLinePositions = options.includeLinePositions;\n    this.textOnlyMode = options.textOnlyMode;\n    this.csp = options.csp;\n\n    if (options.attributes) this.inTag = true;\n  },\n\n  postProcess(result) {\n    // special case - empty string\n    if (!result.length) {\n      return { t: [], v: TEMPLATE_VERSION };\n    }\n\n    if (this.sectionDepth > 0) {\n      this.error('A section was left open');\n    }\n\n    cleanup(\n      result[0].t,\n      this.stripComments,\n      this.preserveWhitespace,\n      !this.preserveWhitespace,\n      !this.preserveWhitespace\n    );\n\n    if (this.csp !== false) {\n      const expr = {};\n      insertExpressions(result[0].t, expr);\n      if (keys(expr).length) result[0].e = expr;\n    }\n\n    return result[0];\n  },\n\n  converters: [readTemplate],\n\n  sortMustacheTags() {\n    // Sort in order of descending opening delimiter length (longer first),\n    // to protect against opening delimiters being substrings of each other\n    this.tags.sort((a, b) => {\n      return b.open.length - a.open.length;\n    });\n  }\n});\n\nexport default function parse(template, options) {\n  return new StandardParser(template, options || {}).result;\n}\n","import { fatal } from 'utils/log';\nimport bind from 'utils/bind';\nimport { createFunctionFromString } from '../config/runtime-parser';\nimport { isFunction, isString, isObjectType } from 'utils/is';\n\nexport default function getComputationSignature(ractive, key, signature) {\n  let getter;\n  let setter;\n\n  // useful for debugging\n  let getterString;\n  let getterUseStack;\n  let setterString;\n\n  if (isFunction(signature)) {\n    getter = bind(signature, ractive);\n    getterString = signature.toString();\n    getterUseStack = true;\n  }\n\n  if (isString(signature)) {\n    getter = createFunctionFromString(signature, ractive);\n    getterString = signature;\n  }\n\n  if (isObjectType(signature)) {\n    if (isString(signature.get)) {\n      getter = createFunctionFromString(signature.get, ractive);\n      getterString = signature.get;\n    } else if (isFunction(signature.get)) {\n      getter = bind(signature.get, ractive);\n      getterString = signature.get.toString();\n      getterUseStack = true;\n    } else {\n      fatal('`%s` computation must have a `get()` method', key);\n    }\n\n    if (isFunction(signature.set)) {\n      setter = bind(signature.set, ractive);\n      setterString = signature.set.toString();\n    }\n  }\n\n  return {\n    getter,\n    setter,\n    getterString,\n    setterString,\n    getterUseStack\n  };\n}\n","import { create, toPairs } from 'utils/object';\nimport { isFunction, isObjectType } from 'utils/is';\n\nexport default function subscribe(instance, options, type) {\n  const subs = (instance.constructor[`_${type}`] || []).concat(toPairs(options[type] || []));\n  const single = type === 'on' ? 'once' : `${type}Once`;\n\n  subs.forEach(([target, config]) => {\n    if (isFunction(config)) {\n      instance[type](target, config);\n    } else if (isObjectType(config) && isFunction(config.handler)) {\n      instance[config.once ? single : type](target, config.handler, create(config));\n    }\n  });\n}\n","import getFunction from 'shared/getFunction';\nimport resolveReference from '../../resolvers/resolveReference';\n\nexport function setupArgsFn(item, template, fragment, opts = {}) {\n  if (template && template.f && template.f.s) {\n    item.fn = getFunction(template.f.s, template.f.r.length);\n    if (opts.register === true) {\n      item.models = resolveArgs(item, template, fragment, opts);\n    }\n  }\n}\n\nexport function resolveArgs(item, template, fragment, opts = {}) {\n  return template.f.r.map((ref, i) => {\n    let model;\n\n    if (opts.specialRef && (model = opts.specialRef(ref, i))) return model;\n\n    model = resolveReference(fragment, ref);\n    if (opts.register === true) {\n      model.register(item);\n    }\n\n    return model;\n  });\n}\n\nexport function teardownArgsFn(item, template) {\n  if (template && template.f && template.f.s) {\n    if (item.models)\n      item.models.forEach(m => {\n        if (m && m.unregister) m.unregister(item);\n      });\n    item.models = null;\n  }\n}\n","// This is the handler for DOM events that would lead to a change in the model\n// (i.e. change, sometimes, input, and occasionally click and keyup)\nexport default function handleDomEvent() {\n  this._ractive.binding.handleChange();\n}\n","import { toArray } from './array';\n\nexport default function getSelectedOptions(select) {\n  /* istanbul ignore next */\n  return select.selectedOptions\n    ? toArray(select.selectedOptions)\n    : select.options\n      ? toArray(select.options).filter(option => option.selected)\n      : [];\n}\n","import { INTERPOLATOR, TRIPLE } from 'config/types';\nimport { warnIfDebug } from 'utils/log';\nimport CheckboxBinding from './CheckboxBinding';\nimport CheckboxNameBinding from './CheckboxNameBinding';\nimport ContentEditableBinding from './ContentEditableBinding';\nimport FileBinding from './FileBinding';\nimport GenericBinding from './GenericBinding';\nimport MultipleSelectBinding from './MultipleSelectBinding';\nimport NumericBinding from './NumericBinding';\nimport RadioBinding from './RadioBinding';\nimport RadioNameBinding from './RadioNameBinding';\nimport SingleSelectBinding from './SingleSelectBinding';\n\nexport function isBindable(attribute) {\n  // The fragment must be a single non-string fragment\n  if (\n    !attribute ||\n    !attribute.template.f ||\n    attribute.template.f.length !== 1 ||\n    attribute.template.f[0].s\n  )\n    return false;\n\n  // A binding is an interpolator `{{ }}`, yey.\n  if (attribute.template.f[0].t === INTERPOLATOR) return true;\n\n  // The above is probably the only true case. For the rest, show an appropriate\n  // warning before returning false.\n\n  // You can't bind a triple curly. HTML values on an attribute makes no sense.\n  if (attribute.template.f[0].t === TRIPLE)\n    warnIfDebug('It is not possible create a binding using a triple mustache.');\n\n  return false;\n}\n\nexport default function selectBinding(element) {\n  const name = element.name;\n  const attributes = element.attributeByName;\n  const isBindableByValue = isBindable(attributes.value);\n  const isBindableByContentEditable = isBindable(attributes.contenteditable);\n  const isContentEditable = element.getAttribute('contenteditable');\n\n  // contenteditable\n  // Bind if the contenteditable is true or a binding that may become true.\n  if ((isContentEditable || isBindableByContentEditable) && isBindableByValue)\n    return ContentEditableBinding;\n\n  // <input>\n  if (name === 'input') {\n    const type = element.getAttribute('type');\n\n    if (type === 'radio') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // For radios we can either bind the name or checked, but not both.\n      // Name binding is handed instead.\n      if (isBindableByName && isBindableByChecked) {\n        warnIfDebug(\n          'A radio input can have two-way binding on its name attribute, or its checked attribute - not both',\n          { ractive: element.root }\n        );\n        return RadioNameBinding;\n      }\n\n      if (isBindableByName) return RadioNameBinding;\n\n      if (isBindableByChecked) return RadioBinding;\n\n      // Dead end. Unknown binding on radio input.\n      return null;\n    }\n\n    if (type === 'checkbox') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // A checkbox with bindings for both name and checked. Checked treated as\n      // the checkbox value, name is treated as a regular binding.\n      //\n      // See https://github.com/ractivejs/ractive/issues/1749\n      if (isBindableByName && isBindableByChecked) return CheckboxBinding;\n\n      if (isBindableByName) return CheckboxNameBinding;\n\n      if (isBindableByChecked) return CheckboxBinding;\n\n      // Dead end. Unknown binding on checkbox input.\n      return null;\n    }\n\n    if (type === 'file' && isBindableByValue) return FileBinding;\n\n    if (type === 'number' && isBindableByValue) return NumericBinding;\n\n    if (type === 'range' && isBindableByValue) return NumericBinding;\n\n    // Some input of unknown type (browser usually falls back to text).\n    if (isBindableByValue) return GenericBinding;\n\n    // Dead end. Some unknown input and an unbindable.\n    return null;\n  }\n\n  // <select>\n  if (name === 'select' && isBindableByValue) {\n    return element.getAttribute('multiple') ? MultipleSelectBinding : SingleSelectBinding;\n  }\n\n  // <textarea>\n  if (name === 'textarea' && isBindableByValue) return GenericBinding;\n\n  // Dead end. Some unbindable element.\n  return null;\n}\n","import { doc } from 'config/environment';\n\nexport default function progressiveText(item, target, occupants, text) {\n  if (occupants) {\n    let n = occupants[0];\n    if (n && n.nodeType === 3) {\n      const idx = n.nodeValue.indexOf(text);\n      occupants.shift();\n\n      if (idx === 0) {\n        if (n.nodeValue.length !== text.length) {\n          occupants.unshift(n.splitText(text.length));\n        }\n      } else {\n        n.nodeValue = text;\n      }\n    } else {\n      n = item.node = doc.createTextNode(text);\n      if (occupants[0]) {\n        target.insertBefore(n, occupants[0]);\n      } else {\n        target.appendChild(n);\n      }\n    }\n\n    item.node = n;\n  } else {\n    if (!item.node) item.node = doc.createTextNode(text);\n    target.appendChild(item.node);\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { fillGaps, hasOwn } from 'utils/object';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { findInstance } from 'shared/registry';\nimport { isArray, isFunction } from 'utils/is';\n\nexport default function getPartialTemplate(ractive, name, up) {\n  // If the partial in instance or view heirarchy instances, great\n  let partial = getPartialFromRegistry(ractive, name, up || {});\n  if (partial) return partial;\n\n  // Does it exist on the page as a script tag?\n  partial = parser.fromId(name, { noThrow: true });\n  if (partial) {\n    // parse and register to this ractive instance\n    const parsed = parser.parseFor(partial, ractive);\n\n    // register extra partials on the ractive instance if they don't already exist\n    if (parsed.p) fillGaps(ractive.partials, parsed.p);\n\n    // register (and return main partial if there are others in the template)\n    return (ractive.partials[name] = parsed.t);\n  }\n}\n\nfunction getPartialFromRegistry(ractive, name, up) {\n  // if there was an instance up-hierarchy, cool\n  let partial = findParentPartial(name, up.owner);\n  if (partial) return partial;\n\n  // find first instance in the ractive or view hierarchy that has this partial\n  const instance = findInstance('partials', ractive, name);\n\n  if (!instance) {\n    return;\n  }\n\n  partial = instance.partials[name];\n\n  // partial is a function?\n  let fn;\n  if (isFunction(partial)) {\n    fn = partial;\n    // super partial\n    if (fn.styleSet) return fn;\n\n    fn = partial.bind(instance);\n    fn.isOwner = hasOwn(instance.partials, name);\n    partial = fn.call(ractive, parser);\n  }\n\n  if (!partial && partial !== '') {\n    warnIfDebug(noRegistryFunctionReturn, name, 'partial', 'partial', {\n      ractive\n    });\n    return;\n  }\n\n  // If this was added manually to the registry,\n  // but hasn't been parsed, parse it now\n  if (!parser.isParsed(partial)) {\n    // use the parseOptions of the ractive instance on which it was found\n    const parsed = parser.parseFor(partial, instance);\n\n    // Partials cannot contain nested partials!\n    // TODO add a test for this\n    if (parsed.p) {\n      warnIfDebug('Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive });\n    }\n\n    // if fn, use instance to store result, otherwise needs to go\n    // in the correct point in prototype chain on instance or constructor\n    const target = fn ? instance : findOwner(instance, name);\n\n    // may be a template with partials, which need to be registered and main template extracted\n    target.partials[name] = partial = parsed.t;\n  }\n\n  // store for reset\n  if (fn) partial._fn = fn;\n\n  return partial.v ? partial.t : partial;\n}\n\nfunction findOwner(ractive, key) {\n  return hasOwn(ractive.partials, key) ? ractive : findConstructor(ractive.constructor, key);\n}\n\nfunction findConstructor(constructor, key) {\n  if (!constructor) {\n    return;\n  }\n  return hasOwn(constructor.partials, key) ? constructor : findConstructor(constructor.Parent, key);\n}\n\nfunction findParentPartial(name, parent) {\n  if (parent) {\n    if (\n      parent.template &&\n      parent.template.p &&\n      !isArray(parent.template.p) &&\n      hasOwn(parent.template.p, name)\n    ) {\n      return parent.template.p[name];\n    } else if (parent.up && parent.up.owner) {\n      return findParentPartial(name, parent.up.owner);\n    }\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { findInstance } from 'shared/registry';\nimport { hasOwn } from 'utils/object';\nimport { isString } from 'utils/is';\n\n// finds the component constructor in the registry or view hierarchy registries\nexport default function getComponentConstructor(ractive, name) {\n  const instance = findInstance('components', ractive, name);\n  let Component;\n\n  if (instance) {\n    Component = instance.components[name];\n\n    // if not from Ractive.extend or a Promise, it's a function that shold return a constructor\n    if (Component && !Component.isInstance && !Component.then) {\n      // function option, execute and store for reset\n      const fn = Component.bind(instance);\n      fn.isOwner = hasOwn(instance.components, name);\n      Component = fn();\n\n      if (!Component) {\n        warnIfDebug(noRegistryFunctionReturn, name, 'component', 'component', {\n          ractive\n        });\n        return;\n      }\n\n      if (isString(Component)) {\n        // allow string lookup\n        Component = getComponentConstructor(ractive, Component);\n      }\n\n      Component._fn = fn;\n      instance.components[name] = Component;\n    }\n  }\n\n  return Component;\n}\n","import Partial from './Partial';\nimport { ELEMENT } from 'config/types';\nimport { assign } from 'utils/object';\n\nexport default function asyncProxy(promise, options) {\n  const partials = options.template.p || {};\n  const name = options.template.e;\n\n  const opts = assign({}, options, {\n    template: { t: ELEMENT, e: name },\n    macro(handle) {\n      handle.setTemplate(partials['async-loading'] || []);\n      promise.then(\n        cmp => {\n          options.up.ractive.components[name] = cmp;\n          if (partials['async-loaded']) {\n            handle.partials.component = [options.template];\n            handle.setTemplate(partials['async-loaded']);\n          } else {\n            handle.setTemplate([options.template]);\n          }\n        },\n        err => {\n          if (partials['async-failed']) {\n            handle.aliasLocal('error', 'error');\n            handle.set('@local.error', err);\n            handle.setTemplate(partials['async-failed']);\n          } else {\n            handle.setTemplate([]);\n          }\n        }\n      );\n    }\n  });\n  return new Partial(opts);\n}\n","import { TEXT } from 'config/types';\n\n// TODO all this code needs to die\nexport default function processItems(items, values, guid, counter = 0) {\n  return items\n    .map(item => {\n      if (item.type === TEXT) {\n        return item.template;\n      }\n\n      if (item.fragment) {\n        if (item.fragment.iterations) {\n          return item.fragment.iterations\n            .map(fragment => {\n              return processItems(fragment.items, values, guid, counter);\n            })\n            .join('');\n        } else {\n          return processItems(item.fragment.items, values, guid, counter);\n        }\n      }\n\n      const placeholderId = `${guid}-${counter++}`;\n      const model = item.model || item.newModel;\n\n      values[placeholderId] = model\n        ? model.wrapper\n          ? model.wrapperValue\n          : model.get()\n        : undefined;\n\n      return '${' + placeholderId + '}';\n    })\n    .join('');\n}\n","import { getElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport { warnIfDebug } from 'utils/log';\nimport render from '../render';\nimport { teardown } from 'shared/methodCallers';\n\nexport default function Ractive$render(target, anchor) {\n  if (this.torndown) {\n    warnIfDebug('ractive.render() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  target = getElement(target) || this.el;\n\n  if (!this.append && target) {\n    // Teardown any existing instances *before* trying to set up the new one -\n    // avoids certain weird bugs\n    const others = target.__ractive_instances__;\n    if (others) others.forEach(teardown);\n\n    // make sure we are the only occupants\n    if (!this.enhance) {\n      target.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n    }\n  }\n\n  const occupants = this.enhance ? toArray(target.childNodes) : null;\n  const promise = render(this, target, anchor, occupants);\n\n  if (occupants) {\n    while (occupants.length) target.removeChild(occupants.pop());\n  }\n\n  return promise;\n}\n","import { createDocumentFragment } from 'utils/dom';\nimport Fragment from 'src/view/Fragment';\nimport runloop from 'src/global/runloop';\nimport { default as templateConfigurator } from '../config/custom/template';\n\n// TODO should resetTemplate be asynchronous? i.e. should it be a case\n// of outro, update template, intro? I reckon probably not, since that\n// could be achieved with unrender-resetTemplate-render. Also, it should\n// conceptually be similar to resetPartial, which couldn't be async\n\nexport default function Ractive$resetTemplate(template) {\n  templateConfigurator.init(null, this, { template });\n\n  const transitionsEnabled = this.transitionsEnabled;\n  this.transitionsEnabled = false;\n\n  // Is this is a component, we need to set the `shouldDestroy`\n  // flag, otherwise it will assume by default that a parent node\n  // will be detached, and therefore it doesn't need to bother\n  // detaching its own nodes\n  const component = this.component;\n  if (component) component.shouldDestroy = true;\n  this.unrender();\n  if (component) component.shouldDestroy = false;\n\n  const promise = runloop.start();\n\n  // remove existing fragment and create new one\n  this.fragment.unbind().unrender(true);\n\n  this.fragment = new Fragment({\n    template: this.template,\n    root: this,\n    owner: this\n  });\n\n  const docFrag = createDocumentFragment();\n  this.fragment.bind(this.viewmodel).render(docFrag);\n\n  // if this is a component, its el may not be valid, so find a\n  // target based on the component container\n  if (component && !component.external) {\n    this.fragment.findParentNode().insertBefore(docFrag, component.findNextNode());\n  } else {\n    this.el.insertBefore(docFrag, this.anchor);\n  }\n\n  runloop.end();\n\n  this.transitionsEnabled = transitionsEnabled;\n\n  return promise;\n}\n","import { build, set } from 'shared/set';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$set(keypath, value, options) {\n  const ractive = this;\n\n  const opts = isObjectType(keypath) ? value : options;\n\n  return set(build(ractive, keypath, value, opts && opts.isolated), opts);\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$subtract(keypath, d, options) {\n  const num = isNumber(d) ? -d : -1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","import { badArguments } from 'config/errors';\nimport { gather, set } from 'shared/set';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$toggle(keypath, options) {\n  if (!isString(keypath)) {\n    throw new TypeError(badArguments);\n  }\n\n  return set(\n    gather(this, keypath, null, options && options.isolated).map(m => [m, !m.get()]),\n    options\n  );\n}\n","import { getCSS } from 'src/global/css';\nimport { keys } from 'utils/object';\n\nexport default function Ractive$toCSS() {\n  const cssIds = [this.cssId, ...this.findAllComponents().map(c => c.cssId)];\n  const uniqueCssIds = keys(cssIds.reduce((ids, id) => ((ids[id] = true), ids), {}));\n  return getCSS(uniqueCssIds);\n}\n","export default function Ractive$toHTML() {\n  return this.fragment.toString(true);\n}\n","export default function toText() {\n  return this.fragment.toString(false);\n}\n","import runloop from 'src/global/runloop';\nimport Transition from '../../view/items/element/Transition';\nimport { fatal } from 'utils/log';\nimport { isObject } from 'utils/is';\n\nexport default function Ractive$transition(name, node, params) {\n  if (node instanceof HTMLElement) {\n    // good to go\n  } else if (isObject(node)) {\n    // omitted, use event node\n    params = node;\n  }\n\n  // if we allow query selector, then it won't work\n  // simple params like \"fast\"\n\n  // else if ( typeof node === 'string' ) {\n  // \t// query selector\n  // \tnode = this.find( node )\n  // }\n\n  node = node || this.event.node;\n\n  if (!node || !node._ractive) {\n    fatal(`No node was supplied for transition ${name}`);\n  }\n\n  params = params || {};\n  const owner = node._ractive.proxy;\n  const transition = new Transition({ owner, up: owner.up, name, params });\n  transition.bind();\n\n  const promise = runloop.start();\n  runloop.registerTransition(transition);\n  runloop.end();\n\n  promise.then(() => transition.unbind());\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function unlink(here) {\n  const promise = runloop.start();\n  this.viewmodel.joinAll(splitKeypath(here), { lastLink: false }).unlink();\n  runloop.end();\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function Ractive$updateModel(keypath, cascade) {\n  const promise = runloop.start();\n\n  if (!keypath) {\n    this.viewmodel.updateFromBindings(true);\n  } else {\n    this.viewmodel.joinAll(splitKeypath(keypath)).updateFromBindings(cascade !== false);\n  }\n\n  runloop.end();\n\n  return promise;\n}\n","export default function isInstance(object) {\n  return object && object instanceof this;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function styleGet(keypath) {\n  return this._cssModel.joinAll(splitKeypath(keypath)).get();\n}\n","import { build, set } from '../../shared/set';\nimport SharedModel from '../../model/specials/SharedModel';\nimport { isObjectType } from 'utils/is';\n\nexport default function sharedSet(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = SharedModel;\n\n  return set(build({ viewmodel: model }, keypath, value, true), opts);\n}\n","import SharedModel from '../../model/specials/SharedModel';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function sharedGet(keypath) {\n  return SharedModel.joinAll(splitKeypath(keypath)).get();\n}\n","import styleGet from '../Ractive/static/styleGet';\nimport styleSet from '../Ractive/static/styleSet';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperties, defineProperty } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nimport { initCSS } from 'src/Ractive/config/custom/css/css';\n\nexport default function macro(fn, opts) {\n  if (!isFunction(fn)) throw new Error(`The macro must be a function`);\n\n  assign(fn, opts);\n\n  defineProperties(fn, {\n    extensions: { value: [] },\n    _cssIds: { value: [] },\n    cssData: { value: assign(create(this.cssData), fn.cssData || {}) },\n\n    styleGet: { value: styleGet.bind(fn) },\n    styleSet: { value: styleSet.bind(fn) }\n  });\n\n  defineProperty(fn, '_cssModel', { value: new CSSModel(fn) });\n\n  if (fn.css) initCSS(fn, fn, fn);\n\n  this.extensions.push(fn);\n\n  return fn;\n}\n","import { escapeKey, splitKeypath as splitKeypathI, unescapeKey } from 'shared/keypaths';\n\nexport function joinKeys(...keys) {\n  return keys.map(escapeKey).join('.');\n}\n\nexport function splitKeypath(keypath) {\n  return splitKeypathI(keypath).map(unescapeKey);\n}\n","import { findInViewHierarchy } from 'shared/registry';\n\nexport function findPlugin(name, type, instance) {\n  return findInViewHierarchy(type, instance, name);\n}\n","/* istanbul ignore if */\nif (!Object.assign) {\n  Object.assign = function(target, ...sources) {\n    if (target == null) throw new TypeError('Cannot convert undefined or null to object');\n\n    const to = Object(target);\n    const sourcesLength = sources.length;\n\n    for (let index = 0; index < sourcesLength; index++) {\n      const nextSource = sources[index];\n      for (const nextKey in nextSource) {\n        if (!Object.prototype.hasOwnProperty.call(nextSource, nextKey)) continue;\n        to[nextKey] = nextSource[nextKey];\n      }\n    }\n\n    return to;\n  };\n}\n","export function hasOwn(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function fillGaps(target, ...sources) {\n  for (let i = 0; i < sources.length; i++) {\n    const source = sources[i];\n    for (const key in source) {\n      // Source can be a prototype-less object.\n      if (key in target || !hasOwn(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nexport function toPairs(obj = {}) {\n  const pairs = [];\n  for (const key in obj) {\n    // Source can be a prototype-less object.\n    if (!hasOwn(obj, key)) continue;\n    pairs.push([key, obj[key]]);\n  }\n  return pairs;\n}\n\nconst obj = Object;\n\nexport const assign = obj.assign;\n\nexport const create = obj.create;\n\nexport const defineProperty = obj.defineProperty;\n\nexport const defineProperties = obj.defineProperties;\n\nexport const keys = obj.keys;\n","const toString = Object.prototype.toString;\nconst arrayLikePattern = /^\\[object (?:Array|FileList)\\]$/;\n\nexport function isArrayLike(obj) {\n  return arrayLikePattern.test(toString.call(obj));\n}\n\nexport const isArray = Array.isArray;\n\nexport function isEqual(a, b) {\n  if (a === null && b === null) {\n    return true;\n  }\n\n  if (isObjectType(a) || isObjectType(b)) {\n    return false;\n  }\n\n  return a === b;\n}\n\n// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\nexport function isNumeric(thing) {\n  return !isNaN(parseFloat(thing)) && isFinite(thing);\n}\n\nexport function isObject(thing) {\n  return thing && toString.call(thing) === '[object Object]';\n}\n\nexport function isObjectLike(thing) {\n  return !!(thing && (isObjectType(thing) || isFunction(thing)));\n}\n\nexport function isObjectType(thing) {\n  return typeof thing === 'object';\n}\n\nexport function isFunction(thing) {\n  return typeof thing === 'function';\n}\n\nexport function isString(thing) {\n  return typeof thing === 'string';\n}\n\nexport function isNumber(thing) {\n  return typeof thing === 'number';\n}\n","/* istanbul ignore if */\nif (typeof window !== 'undefined' && window.performance && !window.performance.now) {\n  window.performance = window.performance || {};\n\n  const nowOffset = Date.now();\n\n  window.performance.now = function() {\n    return Date.now() - nowOffset;\n  };\n}\n","import { hasOwn, defineProperty } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\n/* istanbul ignore if */\nif (!Array.prototype.find) {\n  defineProperty(Array.prototype, 'find', {\n    value(callback, thisArg) {\n      if (this === null || this === undefined)\n        throw new TypeError('Array.prototype.find called on null or undefined');\n\n      if (!isFunction(callback)) throw new TypeError(`${callback} is not a function`);\n\n      const array = Object(this);\n      const arrayLength = array.length >>> 0;\n\n      for (let index = 0; index < arrayLength; index++) {\n        if (!hasOwn(array, index)) continue;\n        if (!callback.call(thisArg, array[index], index, array)) continue;\n        return array[index];\n      }\n\n      return undefined;\n    },\n    configurable: true,\n    writable: true\n  });\n}\n","// NOTE: Node doesn't exist in IE8. Nothing can be done.\n/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  window.Node &&\n  window.Node.prototype &&\n  !window.Node.prototype.contains\n) {\n  Node.prototype.contains = function(node) {\n    if (!node) throw new TypeError('node required');\n\n    do {\n      if (this === node) return true;\n    } while ((node = node && node.parentNode));\n\n    return false;\n  };\n}\n","import { isFunction, isObjectType } from 'utils/is';\n\n/* istanbul ignore if */\nif (typeof window !== 'undefined' && !window.Promise) {\n  const PENDING = {};\n  const FULFILLED = {};\n  const REJECTED = {};\n\n  const Promise = (window.Promise = function(callback) {\n    const fulfilledHandlers = [];\n    const rejectedHandlers = [];\n    let state = PENDING;\n    let result;\n    let dispatchHandlers;\n\n    const makeResolver = newState => {\n      return function(value) {\n        if (state !== PENDING) return;\n        result = value;\n        state = newState;\n        dispatchHandlers = makeDispatcher(\n          state === FULFILLED ? fulfilledHandlers : rejectedHandlers,\n          result\n        );\n        wait(dispatchHandlers);\n      };\n    };\n\n    const fulfill = makeResolver(FULFILLED);\n    const reject = makeResolver(REJECTED);\n\n    try {\n      callback(fulfill, reject);\n    } catch (err) {\n      reject(err);\n    }\n\n    return {\n      // `then()` returns a Promise - 2.2.7\n      then(onFulfilled, onRejected) {\n        const promise2 = new Promise((fulfill, reject) => {\n          const processResolutionHandler = (handler, handlers, forward) => {\n            if (isFunction(handler)) {\n              handlers.push(p1result => {\n                try {\n                  resolve(promise2, handler(p1result), fulfill, reject);\n                } catch (err) {\n                  reject(err);\n                }\n              });\n            } else {\n              handlers.push(forward);\n            }\n          };\n\n          processResolutionHandler(onFulfilled, fulfilledHandlers, fulfill);\n          processResolutionHandler(onRejected, rejectedHandlers, reject);\n\n          if (state !== PENDING) {\n            wait(dispatchHandlers);\n          }\n        });\n        return promise2;\n      },\n      catch(onRejected) {\n        return this.then(null, onRejected);\n      }\n    };\n  });\n\n  Promise.all = function(promises) {\n    return new Promise((fulfil, reject) => {\n      const result = [];\n      let pending;\n      let i;\n\n      if (!promises.length) {\n        fulfil(result);\n        return;\n      }\n\n      const processPromise = (promise, i) => {\n        if (promise && isFunction(promise.then)) {\n          promise.then(value => {\n            result[i] = value;\n            --pending || fulfil(result);\n          }, reject);\n        } else {\n          result[i] = promise;\n          --pending || fulfil(result);\n        }\n      };\n\n      pending = i = promises.length;\n\n      while (i--) {\n        processPromise(promises[i], i);\n      }\n    });\n  };\n\n  Promise.resolve = function(value) {\n    return new Promise(fulfill => {\n      fulfill(value);\n    });\n  };\n\n  Promise.reject = function(reason) {\n    return new Promise((fulfill, reject) => {\n      reject(reason);\n    });\n  };\n\n  // TODO use MutationObservers or something to simulate setImmediate\n  const wait = function(callback) {\n    setTimeout(callback, 0);\n  };\n\n  const makeDispatcher = function(handlers, result) {\n    return function() {\n      for (let handler; (handler = handlers.shift()); ) {\n        handler(result);\n      }\n    };\n  };\n\n  const resolve = function(promise, x, fulfil, reject) {\n    let then;\n    if (x === promise) {\n      throw new TypeError(`A promise's fulfillment handler cannot return the same promise`);\n    }\n    if (x instanceof Promise) {\n      x.then(fulfil, reject);\n    } else if (x && (isObjectType(x) || isFunction(x))) {\n      try {\n        then = x.then;\n      } catch (e) {\n        reject(e);\n        return;\n      }\n      if (isFunction(then)) {\n        let called;\n\n        const resolvePromise = function(y) {\n          if (called) return;\n          called = true;\n          resolve(promise, y, fulfil, reject);\n        };\n        const rejectPromise = function(r) {\n          if (called) return;\n          called = true;\n          reject(r);\n        };\n\n        try {\n          then.call(x, resolvePromise, rejectPromise);\n        } catch (e) {\n          if (!called) {\n            reject(e);\n            called = true;\n            return;\n          }\n        }\n      } else {\n        fulfil(x);\n      }\n    } else {\n      fulfil(x);\n    }\n  };\n}\n","/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  !(window.requestAnimationFrame && window.cancelAnimationFrame)\n) {\n  let lastTime = 0;\n  window.requestAnimationFrame = function(callback) {\n    const currentTime = Date.now();\n    const timeToNextCall = Math.max(0, 16 - (currentTime - lastTime));\n    const id = window.setTimeout(() => {\n      callback(currentTime + timeToNextCall);\n    }, timeToNextCall);\n    lastTime = currentTime + timeToNextCall;\n    return id;\n  };\n  window.cancelAnimationFrame = function(id) {\n    clearTimeout(id);\n  };\n}\n","export default {\n  // render placement:\n  el: void 0,\n  append: false,\n  delegate: true,\n\n  // template:\n  template: null,\n\n  // parse:\n  delimiters: ['{{', '}}'],\n  tripleDelimiters: ['{{{', '}}}'],\n  staticDelimiters: ['[[', ']]'],\n  staticTripleDelimiters: ['[[[', ']]]'],\n  csp: true,\n  interpolate: false,\n  preserveWhitespace: false,\n  sanitize: false,\n  stripComments: true,\n  contextLines: 0,\n\n  // data & binding:\n  data: {},\n  computed: {},\n  syncComputedChildren: false,\n  resolveInstanceMembers: true,\n  warnAboutAmbiguity: false,\n  adapt: [],\n  isolated: true,\n  twoway: true,\n  lazy: false,\n\n  // transitions:\n  noIntro: false,\n  noOutro: false,\n  transitionsEnabled: true,\n  complete: void 0,\n  nestedTransitions: true,\n\n  // css:\n  css: null,\n  noCssTransform: false\n};\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { hasConsole } from '../config/environment';\nimport Ractive from '../Ractive';\nimport noop from './noop';\nimport { isObjectType } from 'utils/is';\n\nconst alreadyWarned = {};\nlet log, printWarning, welcome;\n\nif (hasConsole) {\n  const welcomeIntro = [\n    `%cRactive.js %cBUILD_PLACEHOLDER_VERSION %cin debug mode, %cmore...`,\n    'color: rgb(114, 157, 52); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n  ];\n  const welcomeMessage = `You're running Ractive BUILD_PLACEHOLDER_VERSION in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://ractive.js.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n`;\n\n  welcome = () => {\n    if (Ractive.WELCOME_MESSAGE === false) {\n      welcome = noop;\n      return;\n    }\n    const message = 'WELCOME_MESSAGE' in Ractive ? Ractive.WELCOME_MESSAGE : welcomeMessage;\n    const hasGroup = !!console.groupCollapsed;\n    if (hasGroup) console.groupCollapsed.apply(console, welcomeIntro);\n    console.log(message);\n    if (hasGroup) {\n      console.groupEnd(welcomeIntro);\n    }\n\n    welcome = noop;\n  };\n\n  printWarning = (message, args) => {\n    welcome();\n\n    // extract information about the instance this message pertains to, if applicable\n    if (isObjectType(args[args.length - 1])) {\n      const options = args.pop();\n      const ractive = options ? options.ractive : null;\n\n      if (ractive) {\n        // if this is an instance of a component that we know the name of, add\n        // it to the message\n        let name;\n        if (ractive.component && (name = ractive.component.name)) {\n          message = `<${name}> ${message}`;\n        }\n\n        let node;\n        if (\n          (node =\n            options.node || (ractive.fragment && ractive.fragment.rendered && ractive.find('*')))\n        ) {\n          args.push(node);\n        }\n      }\n    }\n\n    console.warn.apply(\n      console,\n      ['%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);'].concat(\n        args\n      )\n    );\n  };\n\n  log = function() {\n    console.log.apply(console, arguments);\n  };\n} else {\n  printWarning = log = welcome = noop;\n}\n\nfunction format(message, args) {\n  return message.replace(/%s/g, () => args.shift());\n}\n\nfunction fatal(message, ...args) {\n  message = format(message, args);\n  throw new Error(message);\n}\n\nfunction logIfDebug() {\n  if (Ractive.DEBUG) {\n    log.apply(null, arguments);\n  }\n}\n\nfunction warn(message, ...args) {\n  message = format(message, args);\n  printWarning(message, args);\n}\n\nfunction warnOnce(message, ...args) {\n  message = format(message, args);\n\n  if (alreadyWarned[message]) {\n    return;\n  }\n\n  alreadyWarned[message] = true;\n  printWarning(message, args);\n}\n\nfunction warnIfDebug() {\n  if (Ractive.DEBUG) {\n    warn.apply(null, arguments);\n  }\n}\n\nfunction warnOnceIfDebug() {\n  if (Ractive.DEBUG) {\n    warnOnce.apply(null, arguments);\n  }\n}\n\nexport { fatal, log, logIfDebug, warn, warnOnce, warnIfDebug, warnOnceIfDebug, welcome };\n","// These are a subset of the easing equations found at\n// https://raw.github.com/danro/easing-js - license info\n// follows:\n\n// --------------------------------------------------\n// easing.js v0.5.4\n// Generic set of easing functions with AMD support\n// https://github.com/danro/easing-js\n// This code may be freely distributed under the MIT license\n// http://danro.mit-license.org/\n// --------------------------------------------------\n// All functions adapted from Thomas Fuchs & Jeremy Kahn\n// Easing Equations (c) 2003 Robert Penner, BSD license\n// https://raw.github.com/danro/easing-js/master/LICENSE\n// --------------------------------------------------\n\n// In that library, the functions named easeIn, easeOut, and\n// easeInOut below are named easeInCubic, easeOutCubic, and\n// (you guessed it) easeInOutCubic.\n//\n// You can add additional easing functions to this list, and they\n// will be globally available.\n\nexport default {\n  linear(pos) {\n    return pos;\n  },\n  easeIn(pos) {\n    /* istanbul ignore next */\n    return Math.pow(pos, 3);\n  },\n  easeOut(pos) {\n    return Math.pow(pos - 1, 3) + 1;\n  },\n  easeInOut(pos) {\n    /* istanbul ignore next */\n    if ((pos /= 0.5) < 1) {\n      return 0.5 * Math.pow(pos, 3);\n    }\n    /* istanbul ignore next */\n    return 0.5 * (Math.pow(pos - 2, 3) + 2);\n  }\n};\n","/* eslint no-console:\"off\" */\nimport { isFunction } from 'utils/is';\n\nconst win = typeof window !== 'undefined' ? window : null;\nconst doc = win ? document : null;\nconst isClient = !!doc;\nconst hasConsole =\n  typeof console !== 'undefined' && isFunction(console.warn) && isFunction(console.warn.apply);\n\nconst svg = doc\n  ? doc.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1')\n  : false;\n\nconst vendors = ['o', 'ms', 'moz', 'webkit'];\n\nexport { win, doc, isClient, hasConsole, svg, vendors };\n","export default function() {}\n","export function findInViewHierarchy(registryName, ractive, name) {\n  const instance = findInstance(registryName, ractive, name);\n  return instance ? instance[registryName][name] : null;\n}\n\nexport function findInstance(registryName, ractive, name) {\n  while (ractive) {\n    if (name in ractive[registryName]) {\n      return ractive;\n    }\n\n    if (ractive.isolated) {\n      return null;\n    }\n\n    ractive = ractive.parent;\n  }\n}\n","import { fatal } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport interpolators from '../Ractive/static/interpolators';\nimport { findInViewHierarchy } from './registry';\n\nexport default function interpolate(from, to, ractive, type) {\n  if (from === to) return null;\n\n  if (type) {\n    const interpol = findInViewHierarchy('interpolators', ractive, type);\n    if (interpol) return interpol(from, to) || null;\n\n    fatal(missingPlugin(type, 'interpolator'));\n  }\n\n  return (\n    interpolators.number(from, to) ||\n    interpolators.array(from, to) ||\n    interpolators.object(from, to) ||\n    null\n  );\n}\n","import { isArray, isString } from './is';\n\nexport function addToArray(array, value) {\n  const index = array.indexOf(value);\n\n  if (index === -1) {\n    array.push(value);\n  }\n}\n\nexport function arrayContains(array, value) {\n  for (let i = 0, c = array.length; i < c; i++) {\n    if (array[i] == value) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function arrayContentsMatch(a, b) {\n  let i;\n\n  if (!isArray(a) || !isArray(b)) {\n    return false;\n  }\n\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  i = a.length;\n  while (i--) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function ensureArray(x) {\n  if (isString(x)) {\n    return [x];\n  }\n\n  if (x === undefined) {\n    return [];\n  }\n\n  return x;\n}\n\nexport function lastItem(array) {\n  return array[array.length - 1];\n}\n\nexport function removeFromArray(array, member) {\n  if (!array) {\n    return;\n  }\n\n  const index = array.indexOf(member);\n\n  if (index !== -1) {\n    array.splice(index, 1);\n  }\n}\n\nexport function combine(...arrays) {\n  const res = arrays.concat.apply([], arrays);\n  let i = res.length;\n  while (i--) {\n    const idx = res.indexOf(res[i]);\n    if (~idx && idx < i) res.splice(i, 1);\n  }\n\n  return res;\n}\n\nexport function toArray(arrayLike) {\n  const array = [];\n  let i = arrayLike.length;\n  while (i--) {\n    array[i] = arrayLike[i];\n  }\n\n  return array;\n}\n\nexport function findMap(array, fn) {\n  const len = array.length;\n  for (let i = 0; i < len; i++) {\n    const result = fn(array[i]);\n    if (result) return result;\n  }\n}\n","export function bind(x) {\n  x.bind();\n}\nexport function cancel(x) {\n  x.cancel();\n}\nexport function destroyed(x) {\n  x.destroyed();\n}\nexport function handleChange(x) {\n  x.handleChange();\n}\nexport function mark(x) {\n  x.mark();\n}\nexport function markForce(x) {\n  x.mark(true);\n}\nexport function marked(x) {\n  x.marked();\n}\nexport function markedAll(x) {\n  x.markedAll();\n}\nexport function render(x) {\n  x.render();\n}\nexport function shuffled(x) {\n  x.shuffled();\n}\nexport function teardown(x) {\n  x.teardown();\n}\nexport function unbind(x) {\n  x.unbind();\n}\nexport function unrender(x) {\n  x.unrender();\n}\nexport function unrenderAndDestroy(x) {\n  x.unrender(true);\n}\nexport function update(x) {\n  x.update();\n}\nexport function toString(x) {\n  return x.toString();\n}\nexport function toEscapedString(x) {\n  return x.toString(true);\n}\n","import { splitKeypath } from './keypaths';\nimport { isString } from 'utils/is';\n\n// this is the dry method of checking to see if a rebind applies to\n// a particular keypath because in some cases, a dep may be bound\n// directly to a particular keypath e.g. foo.bars.0.baz and need\n// to avoid getting kicked to foo.bars.1.baz if foo.bars is unshifted\nexport function rebindMatch(template, next, previous, fragment) {\n  const keypath = template.r || template;\n\n  // no valid keypath, go with next\n  if (!keypath || !isString(keypath)) return next;\n\n  // completely contextual ref, go with next\n  if (\n    keypath === '.' ||\n    keypath[0] === '@' ||\n    (next || previous).isKey ||\n    (next || previous).isKeypath\n  )\n    return next;\n\n  const parts = keypath.split('/');\n  let keys = splitKeypath(parts[parts.length - 1]);\n  const last = keys[keys.length - 1];\n\n  // check the keypath against the model keypath to see if it matches\n  let model = next || previous;\n\n  // check to see if this was an alias\n  if (model && keys.length === 1 && last !== model.key && fragment) {\n    keys = findAlias(last, fragment) || keys;\n  }\n\n  let i = keys.length;\n  let match = true;\n  let shuffling = false;\n\n  while (model && i--) {\n    if (model.shuffling) shuffling = true;\n    // non-strict comparison to account for indices in keypaths\n    if (keys[i] != model.key) match = false;\n    model = model.parent;\n  }\n\n  // next is undefined, but keypath is shuffling and previous matches\n  if (!next && match && shuffling) return previous;\n  else if (next && !match && shuffling)\n    // next is defined, but doesn't match the keypath\n    return previous;\n  else return next;\n}\n\nfunction findAlias(name, fragment) {\n  while (fragment) {\n    const z = fragment.aliases;\n    if (z && z[name]) {\n      const aliases = (fragment.owner.iterations ? fragment.owner : fragment).owner.template.z;\n      for (let i = 0; i < aliases.length; i++) {\n        if (aliases[i].n === name) {\n          const alias = aliases[i].x;\n          if (!alias.r) return false;\n          const parts = alias.r.split('/');\n          return splitKeypath(parts[parts.length - 1]);\n        }\n      }\n      return;\n    }\n\n    fragment = fragment.componentParent || fragment.parent;\n  }\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$add(keypath, d, options) {\n  const num = isNumber(d) ? d : 1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","export function enqueue(ractive, event) {\n  if (ractive.event) {\n    ractive._eventQueue.push(ractive.event);\n  }\n\n  ractive.event = event;\n}\n\nexport function dequeue(ractive) {\n  if (ractive._eventQueue.length) {\n    ractive.event = ractive._eventQueue.pop();\n  } else {\n    ractive.event = null;\n  }\n}\n","export function findAnchors(fragment, name = null) {\n  const res = [];\n\n  findAnchorsIn(fragment, name, res);\n\n  return res;\n}\n\nfunction findAnchorsIn(item, name, result) {\n  if (item.isAnchor) {\n    if (!name || item.name === name) {\n      result.push(item);\n    }\n  } else if (item.items) {\n    item.items.forEach(i => findAnchorsIn(i, name, result));\n  } else if (item.iterations) {\n    item.iterations.forEach(i => findAnchorsIn(i, name, result));\n  } else if (item.fragment && !item.component) {\n    findAnchorsIn(item.fragment, name, result);\n  }\n}\n\nexport function updateAnchors(instance, name = null) {\n  const anchors = findAnchors(instance.fragment, name);\n  const idxs = {};\n  const children = instance._children.byName;\n\n  anchors.forEach(a => {\n    const name = a.name;\n    if (!(name in idxs)) idxs[name] = 0;\n    const idx = idxs[name];\n    const child = (children[name] || [])[idx];\n\n    if (child && child.lastBound !== a) {\n      if (child.lastBound) child.lastBound.removeChild(child);\n      a.addChild(child);\n    }\n\n    idxs[name]++;\n  });\n}\n\nexport function unrenderChild(meta) {\n  if (meta.instance.fragment.rendered) {\n    meta.shouldDestroy = true;\n    meta.instance.unrender();\n  }\n  meta.instance.el = null;\n}\n","export default function Ractive$find(selector, options = {}) {\n  if (!this.el)\n    throw new Error(\n      `Cannot call ractive.find('${selector}') unless instance is rendered to the DOM`\n    );\n\n  let node = this.fragment.find(selector, options);\n  if (node) return node;\n\n  if (options.remote) {\n    for (let i = 0; i < this._children.length; i++) {\n      if (!this._children[i].instance.fragment.rendered) continue;\n      node = this._children[i].instance.find(selector, options);\n      if (node) return node;\n    }\n  }\n}\n","import { isArray } from 'utils/is';\n\nexport default function Ractive$findAll(selector, options = {}) {\n  if (!this.el)\n    throw new Error(\n      `Cannot call ractive.findAll('${selector}', ...) unless instance is rendered to the DOM`\n    );\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAll(selector, options);\n\n  if (options.remote) {\n    // seach non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        c.instance.findAll(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isArray, isObjectType } from 'utils/is';\n\nexport default function Ractive$findAllComponents(selector, options) {\n  if (!options && isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  options = options || {};\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAllComponents(selector, options);\n\n  if (options.remote) {\n    // search non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        if (!selector || c.name === selector) {\n          options.result.push(c.instance);\n        }\n\n        c.instance.findAllComponents(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isObjectType } from 'utils/is';\n\nexport default function Ractive$findComponent(selector, options = {}) {\n  if (isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  let child = this.fragment.findComponent(selector, options);\n  if (child) return child;\n\n  if (options.remote) {\n    if (!selector && this._children.length) return this._children[0].instance;\n    for (let i = 0; i < this._children.length; i++) {\n      // skip children that are or should be in an anchor\n      if (this._children[i].target) continue;\n      if (this._children[i].name === selector) return this._children[i].instance;\n      child = this._children[i].instance.findComponent(selector, options);\n      if (child) return child;\n    }\n  }\n}\n","export default function Ractive$findContainer(selector) {\n  if (this.container) {\n    if (this.container.component && this.container.component.name === selector) {\n      return this.container;\n    } else {\n      return this.container.findContainer(selector);\n    }\n  }\n\n  return null;\n}\n","export default function Ractive$findParent(selector) {\n  if (this.parent) {\n    if (this.parent.component && this.parent.component.name === selector) {\n      return this.parent;\n    } else {\n      return this.parent.findParent(selector);\n    }\n  }\n\n  return null;\n}\n","import { ANCHOR, COMPONENT, ELEMENT } from 'config/types';\n\nexport default function findElement(start, orComponent = true, name) {\n  while (\n    start &&\n    (start.type !== ELEMENT || (name && start.name !== name)) &&\n    (!orComponent || (start.type !== COMPONENT && start.type !== ANCHOR))\n  ) {\n    // start is a fragment - look at the owner\n    if (start.owner) start = start.owner;\n    else if (start.component)\n      // start is a component or yielder - look at the container\n      start = start.containerFragment || start.component.up;\n    else if (start.parent)\n      // start is an item - look at the parent\n      start = start.parent;\n    else if (start.up)\n      // start is an item without a parent - look at the parent fragment\n      start = start.up;\n    else start = undefined;\n  }\n\n  return start;\n}\n","import { isNumber } from 'utils/is';\n\n// This function takes an array, the name of a mutator method, and the\n// arguments to call that mutator method with, and returns an array that\n// maps the old indices to their new indices.\n\n// So if you had something like this...\n//\n//     array = [ 'a', 'b', 'c', 'd' ];\n//     array.push( 'e' );\n//\n// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n// have changed. If you then did this...\n//\n//     array.unshift( 'z' );\n//\n// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n// one higher to make room for the 'z'. If you removed an item, the new index\n// would be -1...\n//\n//     array.splice( 2, 2 );\n//\n// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n//\n// This information is used to enable fast, non-destructive shuffling of list\n// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\nexport default function getNewIndices(length, methodName, args) {\n  const newIndices = [];\n\n  const spliceArguments = getSpliceEquivalent(length, methodName, args);\n\n  if (!spliceArguments) {\n    return null; // TODO support reverse and sort?\n  }\n\n  const balance = spliceArguments.length - 2 - spliceArguments[1];\n\n  const removeStart = Math.min(length, spliceArguments[0]);\n  const removeEnd = removeStart + spliceArguments[1];\n  newIndices.startIndex = removeStart;\n\n  let i;\n  for (i = 0; i < removeStart; i += 1) {\n    newIndices.push(i);\n  }\n\n  for (; i < removeEnd; i += 1) {\n    newIndices.push(-1);\n  }\n\n  for (; i < length; i += 1) {\n    newIndices.push(i + balance);\n  }\n\n  // there is a net shift for the rest of the array starting with index + balance\n  if (balance !== 0) {\n    newIndices.touchedFrom = spliceArguments[0];\n  } else {\n    newIndices.touchedFrom = length;\n  }\n\n  return newIndices;\n}\n\n// The pop, push, shift an unshift methods can all be represented\n// as an equivalent splice\nfunction getSpliceEquivalent(length, methodName, args) {\n  switch (methodName) {\n    case 'splice':\n      if (args[0] !== undefined && args[0] < 0) {\n        args[0] = length + Math.max(args[0], -length);\n      }\n\n      if (args[0] === undefined) args[0] = 0;\n\n      while (args.length < 2) {\n        args.push(length - args[0]);\n      }\n\n      if (!isNumber(args[1])) {\n        args[1] = length - args[0];\n      }\n\n      // ensure we only remove elements that exist\n      args[1] = Math.min(args[1], length - args[0]);\n\n      return args;\n\n    case 'sort':\n    case 'reverse':\n      return null;\n\n    case 'pop':\n      if (length) {\n        return [length - 1, 1];\n      }\n      return [0, 0];\n\n    case 'push':\n      return [length, 0].concat(args);\n\n    case 'shift':\n      return [0, length ? 1 : 0];\n\n    case 'unshift':\n      return [0, 0].concat(args);\n  }\n}\n","import fireEvent from 'src/events/fireEvent';\nimport Context from 'shared/Context';\nimport { assign, create } from 'utils/object';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$fire(eventName, ...args) {\n  let ctx;\n\n  // watch for reproxy\n  if (args[0] instanceof Context) {\n    const proto = args.shift();\n    ctx = create(proto);\n    assign(ctx, proto);\n  } else if (isObjectType(args[0]) && (args[0] === null || args[0].constructor === Object)) {\n    ctx = Context.forRactive(this, args.shift());\n  } else {\n    ctx = Context.forRactive(this);\n  }\n\n  return fireEvent(this, eventName, ctx, args);\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport { FakeFragment } from 'shared/getRactiveContext';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$get(keypath, opts) {\n  if (!isString(keypath)) return this.viewmodel.get(true, keypath);\n\n  const keys = splitKeypath(keypath);\n  const key = keys[0];\n\n  let model;\n\n  if (!this.viewmodel.has(key)) {\n    // if this is an inline component, we may need to create\n    // an implicit mapping\n    if (this.component && !this.isolated) {\n      model = resolveReference(this.fragment || new FakeFragment(this), key);\n    }\n  }\n\n  model = this.viewmodel.joinAll(keys);\n  return model.get(true, opts);\n}\n","import staticContext, { getNodeInfo as staticInfo } from '../static/getContext';\nimport { isString } from 'utils/is';\n\nexport default function getContext(node, options) {\n  if (isString(node)) {\n    node = this.find(node, options);\n  }\n\n  return staticContext(node);\n}\n\nexport function getNodeInfo(node, options) {\n  if (isString(node)) {\n    node = this.find(node, options);\n  }\n\n  return staticInfo(node);\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from 'src/global/runloop';\n\nexport default function link(there, here, options) {\n  let model;\n  const target = (options && (options.ractive || options.instance)) || this;\n\n  // may need to allow a mapping to resolve implicitly\n  const sourcePath = splitKeypath(there);\n  if (!target.viewmodel.has(sourcePath[0]) && target.component) {\n    model = resolveReference(target.component.up, sourcePath[0]);\n    model = model.joinAll(sourcePath.slice(1));\n  }\n\n  const src = model || target.viewmodel.joinAll(sourcePath);\n  const dest = this.viewmodel.joinAll(splitKeypath(here), { lastLink: false });\n\n  if (isUpstream(src, dest) || isUpstream(dest, src)) {\n    throw new Error('A keypath cannot be linked to itself.');\n  }\n\n  const promise = runloop.start();\n\n  dest.link(src, (options && options.keypath) || there);\n\n  runloop.end();\n\n  return promise;\n}\n\nfunction isUpstream(check, start) {\n  let model = start;\n  while (model) {\n    if (model === check || model.owner === check) return true;\n    model = model.target || model.parent;\n  }\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport Observer from './observe/Observer';\nimport PatternObserver from './observe/Pattern';\nimport ArrayObserver from './observe/Array';\nimport { keys } from 'utils/object';\n\nexport default function observe(keypath, callback, options) {\n  const observers = [];\n  let map;\n  let opts;\n\n  if (isObject(keypath)) {\n    map = keypath;\n    opts = callback || {};\n  } else {\n    if (isFunction(keypath)) {\n      map = { '': keypath };\n      opts = callback || {};\n    } else {\n      map = {};\n      map[keypath] = callback;\n      opts = options || {};\n    }\n  }\n\n  let silent = false;\n  keys(map).forEach(keypath => {\n    const callback = map[keypath];\n    const caller = function(...args) {\n      if (silent) return;\n      return callback.apply(this, args);\n    };\n\n    let keypaths = keypath.split(' ');\n    if (keypaths.length > 1) keypaths = keypaths.filter(k => k);\n\n    keypaths.forEach(keypath => {\n      opts.keypath = keypath;\n      const observer = createObserver(this, keypath, caller, opts);\n      if (observer) observers.push(observer);\n    });\n  });\n\n  // add observers to the Ractive instance, so they can be\n  // cancelled on ractive.teardown()\n  this._observers.push.apply(this._observers, observers);\n\n  return {\n    cancel: () => observers.forEach(o => o.cancel()),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n\nfunction createObserver(ractive, keypath, callback, options) {\n  const keys = splitKeypath(keypath);\n  let wildcardIndex = keys.indexOf('*');\n  if (!~wildcardIndex) wildcardIndex = keys.indexOf('**');\n\n  options.fragment = options.fragment || ractive.fragment;\n\n  let model;\n  if (!options.fragment) {\n    model = ractive.viewmodel.joinKey(keys[0]);\n  } else {\n    // .*.whatever relative wildcard is a special case because splitkeypath doesn't handle the leading .\n    if (~keys[0].indexOf('.*')) {\n      model = options.fragment.findContext();\n      wildcardIndex = 0;\n      keys[0] = keys[0].slice(1);\n    } else {\n      model =\n        wildcardIndex === 0\n          ? options.fragment.findContext()\n          : resolveReference(options.fragment, keys[0]);\n    }\n  }\n\n  // the model may not exist key\n  if (!model) model = ractive.viewmodel.joinKey(keys[0]);\n\n  if (!~wildcardIndex) {\n    model = model.joinAll(keys.slice(1));\n    if (options.array) {\n      return new ArrayObserver(ractive, model, callback, options);\n    } else {\n      return new Observer(ractive, model, callback, options);\n    }\n  } else {\n    const double = keys.indexOf('**');\n    if (~double) {\n      if (double + 1 !== keys.length || ~keys.indexOf('*')) {\n        warnOnceIfDebug(\n          `Recursive observers may only specify a single '**' at the end of the path.`\n        );\n        return;\n      }\n    }\n\n    model = model.joinAll(keys.slice(1, wildcardIndex));\n\n    return new PatternObserver(ractive, model, keys.slice(wildcardIndex), callback, options);\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\n\nexport default function Ractive$off(eventName, callback) {\n  // if no event is specified, remove _all_ event listeners\n  if (!eventName) {\n    this._subs = {};\n  } else {\n    // Handle multiple space-separated event names\n    const eventNames = eventName\n      .split(' ')\n      .map(trim)\n      .filter(notEmptyString);\n\n    eventNames.forEach(event => {\n      const subs = this._subs[event];\n      // if given a specific callback to remove, remove only it\n      if (subs && callback) {\n        const entry = subs.find(s => s.callback === callback);\n        if (entry) {\n          removeFromArray(subs, entry);\n          entry.off = true;\n\n          if (event.indexOf('.')) this._nsSubs--;\n        }\n      } else if (subs) {\n        // otherwise, remove all listeners for this event\n        if (event.indexOf('.')) this._nsSubs -= subs.length;\n        subs.length = 0;\n      }\n    });\n  }\n\n  return this;\n}\n","import trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\nimport { hasOwn } from 'utils/object';\nimport { isObjectType, isString } from 'utils/is';\n\nexport default function Ractive$on(eventName, callback) {\n  // eventName may already be a map\n  const map = isObjectType(eventName) ? eventName : {};\n  // or it may be a string along with a callback\n  if (isString(eventName)) map[eventName] = callback;\n\n  let silent = false;\n  const events = [];\n\n  for (const k in map) {\n    const callback = map[k];\n    const caller = function(...args) {\n      if (!silent) return callback.apply(this, args);\n    };\n    const entry = {\n      callback,\n      handler: caller\n    };\n\n    if (hasOwn(map, k)) {\n      const names = k\n        .split(' ')\n        .map(trim)\n        .filter(notEmptyString);\n      names.forEach(n => {\n        (this._subs[n] || (this._subs[n] = [])).push(entry);\n        if (n.indexOf('.')) this._nsSubs++;\n        events.push([n, entry]);\n      });\n    }\n  }\n\n  return {\n    cancel: () => events.forEach(e => this.off(e[0], e[1].callback)),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n","export default function Ractive$once(eventName, handler) {\n  const listener = this.on(eventName, function() {\n    handler.apply(this, arguments);\n    listener.cancel();\n  });\n\n  // so we can still do listener.cancel() manually\n  return listener;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function readLink(keypath, options = {}) {\n  const path = splitKeypath(keypath);\n\n  if (this.viewmodel.has(path[0])) {\n    let model = this.viewmodel.joinAll(path);\n\n    if (!model.isLink) return;\n\n    while ((model = model.target) && options.canonical !== false) {\n      if (!model.isLink) break;\n    }\n\n    if (model) return { ractive: model.root.ractive, keypath: model.getKeypath() };\n  }\n}\n","function s4() {\n  return Math.floor((1 + Math.random()) * 0x10000)\n    .toString(16)\n    .substring(1);\n}\n\nexport function uuid() {\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\n","import { applyCSS } from '../../global/css';\nimport transformCSS from '../config/custom/css/transform';\nimport { evalCSS } from '../config/custom/css/css';\nimport { build, set } from '../../shared/set';\nimport runloop from '../../global/runloop';\nimport { isObjectType, isFunction } from 'utils/is';\n\nexport default function setCSSData(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = this._cssModel;\n\n  model.locked = true;\n  const promise = set(build({ viewmodel: model }, keypath, value, true), opts);\n  model.locked = false;\n\n  const cascade = runloop.start();\n  this.extensions.forEach(e => {\n    const model = e._cssModel;\n    model.mark();\n    model.downstreamChanged('', 1);\n  });\n  runloop.end();\n\n  applyChanges(this, !opts || opts.apply !== false);\n\n  return promise.then(() => cascade);\n}\n\nexport function applyChanges(component, apply) {\n  const local = recomputeCSS(component);\n  const child = component.extensions\n    .map(e => applyChanges(e, false))\n    .reduce((a, c) => c || a, false);\n\n  if (apply && (local || child)) {\n    const def = component._cssDef;\n    if (!def || (def && def.applied)) applyCSS(true);\n  }\n\n  return local || child;\n}\n\nfunction recomputeCSS(component) {\n  const css = component._css;\n\n  if (!isFunction(css)) return;\n\n  const def = component._cssDef;\n  const result = evalCSS(component, css);\n  const styles = def.transform ? transformCSS(result, def.id) : result;\n\n  if (def.styles === styles) return;\n\n  def.styles = styles;\n\n  return true;\n}\n","import noop from 'utils/noop';\nimport { isFunction } from 'utils/is';\n\nexport default function wrap(parent, name, method) {\n  if (!/_super/.test(method)) return method;\n\n  function wrapper() {\n    const superMethod = getSuperMethod(wrapper._parent, name);\n    const hasSuper = '_super' in this;\n    const oldSuper = this._super;\n\n    this._super = superMethod;\n\n    const result = method.apply(this, arguments);\n\n    if (hasSuper) {\n      this._super = oldSuper;\n    } else {\n      delete this._super;\n    }\n\n    return result;\n  }\n\n  wrapper._parent = parent;\n  wrapper._method = method;\n\n  return wrapper;\n}\n\nfunction getSuperMethod(parent, name) {\n  if (name in parent) {\n    const value = parent[name];\n\n    return isFunction(value) ? value : () => value;\n  }\n\n  return noop;\n}\n","import { warnIfDebug } from 'utils/log';\nimport { isArray } from 'utils/is';\n\nfunction getMessage(deprecated, correct, isError) {\n  return (\n    `options.${deprecated} has been deprecated in favour of options.${correct}.` +\n    (isError ? ` You cannot specify both options, please use options.${correct}.` : '')\n  );\n}\n\nfunction deprecateOption(options, deprecatedOption, correct) {\n  if (deprecatedOption in options) {\n    if (!(correct in options)) {\n      warnIfDebug(getMessage(deprecatedOption, correct));\n      options[correct] = options[deprecatedOption];\n    } else {\n      throw new Error(getMessage(deprecatedOption, correct, true));\n    }\n  }\n}\n\nexport default function deprecate(options) {\n  deprecateOption(options, 'beforeInit', 'onconstruct');\n  deprecateOption(options, 'init', 'onrender');\n  deprecateOption(options, 'complete', 'oncomplete');\n  deprecateOption(options, 'eventDefinitions', 'events');\n\n  // Using extend with Component instead of options,\n  // like Human.extend( Spider ) means adaptors as a registry\n  // gets copied to options. So we have to check if actually an array\n  if (isArray(options.adaptors)) {\n    deprecateOption(options, 'adaptors', 'adapt');\n  }\n}\n","import resolveReference from './resolveReference';\nimport ExpressionProxy from './ExpressionProxy';\nimport ReferenceExpressionProxy from './ReferenceExpressionProxy';\n\nexport default function resolve(fragment, template) {\n  if (template.r) {\n    return resolveReference(fragment, template.r);\n  } else if (template.x) {\n    return new ExpressionProxy(fragment, template.x);\n  } else if (template.rx) {\n    return new ReferenceExpressionProxy(fragment, template.rx);\n  }\n}\n"],"names":["this","delegate","cssIds","options","parent","context","rendered","iterations","template","indexRef","keyRef","pendingNewIndices","previousIterations","isArray","RepeatedFragment__proto__","RepeatedFragment","prototype","bind","bound","value","get","let","max","length","i","this$1","createIteration","isObject","refs","split","keys","map","key","index","bubble","bubbled","push","owner","fragment","Fragment","isIteration","model","joinKey","z","aliases","n","destroyed","forEach","detach","docFrag","createDocumentFragment","appendChild","find","selector","findMap","findAll","findAllComponents","name","findComponent","findContext","findNextNode","iteration","node","firstNode","skipParent","rebind","next","undefined","render","target","occupants","xs","len","shuffle","newIndices","slice","newIndex","oldIndex","dirty","shuffled","toString","escape","toEscapedString","join","unbind","unrender","shouldDestroy","unrenderAndDestroy","update","updatePostShuffle","updating","toRemove","oldKeys","wasArray","reset","splice","newLength","parentNode","findParentNode","anchor","insertBefore","indices","oldLen","removed","frag","contiguous","startIndex","childNodes","k","getContext","Section","MustacheContainer","super","sectionType","templateSectionType","subordinate","l","Section__proto__","constructor","sibling","up","items","indexOf","nextSibling","SECTION_UNLESS","isTruthy","f","const","detached","call","isRoot","SECTION_IF_WITH","isEmpty","previous","safe","SECTION_IF","SECTION_EACH","siblingFalsey","lastType","getType","newFragment","fragmentShouldExist","SECTION_WITH","attach","keep","runloop","promise","then","Select","Element","Select__proto__","foundNode","binding","selectedOptions","getSelectedOptions","sync","defaultSelected","selected","selectNode","toArray","o","setFromNode","selectValue","getAttribute","isMultiple","array","optionWasSelected","optionValue","_ractive","shouldSelect","valueContains","compare","forceUpdate","comparator","isFunction","Textarea","Input","deferContent","attributeByName","isBindable","attributes","createItem","t","ATTRIBUTE","Textarea__proto__","scheduleTask","Text","Item","type","TEXT","Text__proto__","detachNode","inAttributes","progressiveText","escapeHtml","valueOf","proto","noop","visible","hidden","doc","prefix","vendors","vendor","addEventListener","onChange","onHide","onShow","win","isClient","prefixCache","testStyle","createElement","style","prop","hyphenateCamel","createTransitions","prefix$1","vendorPattern","RegExp","hyphenate","str","test","replace","match","toLowerCase","TRANSITION","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","linear","x","canUseCssTransitions","cannotUseCssTransitions","transition","webkitTransition","to","changedProperties","resolve","setTimeout","transitionDone","clearTimeout","cssTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","unregisterCompleteHandler","ractive","fire","isIntro","transitionEndHandler","event","propertyName","cssTransitionsDone","property","duration","timing","removeEventListener","hashPrefix","namespaceURI","tagName","delay","registerCompleteHandler","easingName","easing","cssTiming","hash","suffix","interpolator","originalValue","propertiesToTransitionInJs","initial","getStyle","warnIfDebug","exec","interpolate","parseFloat","isString","warnOnceIfDebug","missingPlugin","Ticker","step","pos","complete","createTransitions$1","getComputedStyle","resolved","Promise","names","t0","t1","t2","Transition","findElement","element","onComplete","Transition__proto__","animateStyle","arguments","Error","setStyle","fulfil","propertyNames","computedStyle","current","init","originals","targets","v","intro","outro","eventName","params","_fn","findInViewHierarchy","setupArgsFn","getParams","fn","values","resolveArgs","apply","props","styles","processParams","defaults","isNumber","assign","addToArray","hasOwn","shouldFire","transitionsEnabled","rendering","nearestProp","unrendering","nested","el","starting","start","completed","args","noReset","_manager","remove","concat","unbinding","removeFromArray","ieBug","ieBlacklist","elementCache","innerHTML","err","TABLE","THEAD","TBODY","TR","SELECT","insertHtml","html","nodes","container","wrapper","selectedOption","querySelector","selectedIndex","svg","textContent","child","firstChild","removeChild","Triple","Mustache","Triple__proto__","nodeType","matches","queryResult","result","queryAllResult","querySelectorAll","shift","outerHTML","nodeValue","inAttribute","decodeCharacterReferences","detachWhenReady","constructors","ALIAS","Alias","ANCHOR","Component","DOCTYPE","Doctype","INTERPOLATOR","Interpolator","PARTIAL","Partial","SECTION","TRIPLE","YIELDER","Attribute","BINDING_FLAG","BindingFlag","DECORATOR","Decorator","EVENT","EventDirective","COMMENT","Comment","specialElements","doctype","form","Form","input","option","Option","select","textarea","componentParent","component","containerFragment","dirtyValue","createItems","Fragment__proto__","addFragment","base","findParentWithContext","viewmodel","item","it","ELEMENT","findRepeatingFragment","resetTemplate","wasBound","wasRendered","addFragmentToRoot","source","processItems","_guid","parsed","parseJSON","HookQueue","hook","Hook","inProcess","queue","HookQueue__proto__","begin","end","getChildQueue","configHook","initHook","renderHook","completeHook","shouldRerender","resetHook","unrenderHook","resetPartial","partial","collection","collect","partials","handleChange","reverse","makeArrayMethod","path","sort","unshift","add","animate","attachChild","detachChild","findContainer","findParent","getNodeInfo","insert","link","observe","observeOnce","off","on","once","pop","readLink","set","subtract","teardown","toggle","toCSS","toCss","toHTML","toHtml","toText","unlink","updateModel","defineProperty","callsSuper","defineProperties","Ractive","sharedGet","sharedSet","styleGet","configurable","styleSet","opts","script","document","currentScript","warn","DEBUG","writable","DEBUG_PROMISES","extend","extendWith","escapeKey","evalObjectString","findPlugin","getCSS","isInstance","joinKeys","macro","normaliseKeypath","normalise","parse","splitKeypath","unescapeKey","enhance","VERSION","adaptors","components","decorators","events","extensions","interpolators","transitions","cssData","sharedData","Context","extern","CSSModel","Binding__proto__","registerTwowayBinding","getValue","lastVal","attribute","locked","setting","lastValue","unregisterTwowayBinding","Binding","CheckboxBinding","CheckboxBinding__proto__","handleDomEvent","attachEvent","getInitialValue","checked","BindingGroup","bindings","BindingGroup__proto__","CheckboxNameBinding","checkboxName","group","getBindingGroup","noInitialValue","existingValue","bindingValue","arrayContains","CheckboxNameBinding__proto__","isChecked","getKeypath","wasUndefined","valueSoFar","ContentEditableBinding","ContentEditableBinding__proto__","lazy","GenericBinding","GenericBinding__proto__","timeout","isNumeric","handler","handleDelay","handleBlur","FileBinding","FileBinding__proto__","files","MultipleSelectBinding","MultipleSelectBinding__proto__","filter","selectedValues","previousValue","arrayContentsMatch","Array","NumericBinding","NumericBinding__proto__","isNaN","siblings","RadioBinding","getSiblings","RadioBinding__proto__","RadioNameBinding","RadioNameBinding__proto__","nameAttributeBinding","getKeypathModel","register","unregister","SingleSelectBinding","SingleSelectBinding__proto__","disabled","endsWithSemi","ContainerItem","e","attrs","attr","val","cls","leftovers","m","DELEGATE_FLAG","ConditionalAttribute","Element__proto__","recreateTwowayBinding","createTwowayBinding","twoway","selectBinding","listeners","ls","ref","assigns","ctx","create","callback","capture","delegateHandler","rem","namespace","getNamespace","existing","nodeName","toUpperCase","proxy","isOutro","registerTransition","children","removeAttribute","setAttribute","stringifyAttribute","isSelected","inputIsCheckedRadio","safeAttributeString","getString","inlineClass","voidElementNames","UIEvent","formBindings","Form__proto__","handleReset","whitelist","animationend","animationiteration","animationstart","transitioncancel","transitionend","transitionstart","transitionrun","DOMEvent","fatal","DOMEvent__proto__","directive","original","CustomEvent","eventPlugin","CustomEvent__proto__","RactiveEvent","RactiveEvent__proto__","instance","cancel","specialPattern","dollarArgsPattern","COMPONENT","models","EventDirective__proto__","action","refire","specialRef","specialMatch","special","substr","dollarMatch","obj","which","wrapperValue","oldEvent","returned","preventDefault","stopPropagation","fireEvent","isStatic","s","Mustache__proto__","unreference","rebindMatch","addShuffleRegister","Object","Interpolator__proto__","safeToStringValue","string","data","Input__proto__","defaultValue","attrValue","leadingWhitespace","ParseError","message","stack","Parser","lineStart","lines","lineEnds","line","lineEnd","read","leftover","remaining","postProcess","converters","getContextMessage","getLinePos","lineNum","columnNum","contextLines","contextUp","contextDown","numTabs","annotation","char","error","msg","character","shortMessage","matchString","matchPattern","pattern","sp","substring","nextChar","charAt","Parent","Child","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","makeQuotedStringMatcher","okQuote","parser","literal","done","charCodeAt","JSON","singleMatcher","doubleMatcher","readStringLiteral","quote","STRING_LITERAL","numberPattern","identifier","specials","true","false","null","specialsPattern","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","JsonParser","placeholder","number","stringLiteral","$1","pair","getKeyValuePair","valueToken","Mapping","Mapping__proto__","createMapping","boundFragment","a","Option__proto__","selectedAttribute","yielder","r","tx","refName","partialFromValue","createFragment","initMacro","dirtyTemplate","externalChange","refreshAttrs","_attrs","handle","fnTemplate","getPartialTemplate","unbindAttrs","_cssDef","applied","applyCSS","dirtyAttrs","invalidate","extras","findDelegate","noThrow","id","getElementById","isParsed","getParseOptions","parseOptions","reduce","throwNoParse","TEMPLATE_INSTRUCTIONS","addFunctions","parseFor","functions","templateConfigurator","parseTemplate","TEMPLATE_VERSION","getDynamicTemplate","_config","p","extendPartials","resetValue","registryNames","registriesOnDefaults","Registry","useDefaults","Registry__proto__","configure","registry","changed","isOwner","registries","putInDefaults","custom","adapt","adaptConfigurator","css","cssConfigurator","dataConfigurator","defaultKeys","isStandardKey","makeObj","isBlacklisted","order","config","c","_super","Item__proto__","ContainerItem__proto__","ComputationChild","Model","isReadonly","root","syncComputedChildren","prototypeAccessors$1","setRoot","ComputationChild__proto__","applyValue","dependencies","mark","shouldCapture","parentValue","newWrapperValue","unwrap","boundValue","links","marked","deps","childByKey","Computation","signature","isExpression","setter","computationContext","prototypeAccessors$2","Computation__proto__","old","active","isEqual","notifyUpstream","maybeBind","shouldBind","startCapturing","getter","hasConsole","console","groupCollapsed","sig","getterUseStack","groupEnd","stopCapturing","setDependencies","computations","ExpressionProxy","getFunction","resolveReference","ExpressionProxy__proto__","actuallyChanged","keypath","d","idx","retrieve","dep","computation","ReferenceExpressionChild","ReferenceExpressionChild__proto__","joinAll","missing","ReferenceExpressionProxy","intermediary","members","addShuffleTask","REFERENCE","ReferenceExpressionProxy__proto__","String","keypathModel","oneway","findBoundValue","unsafe","shuffling","Alias__proto__","resolveAliases","booleanAttributes","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","codePointSupport","fromCodePoint","codeToChar","fromCharCode","lessThan","greaterThan","invalid","camelCaseStr","space","textTypes","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","ismap","maxlength","novalidate","pubdate","readonly","rowspan","tabindex","usemap","div","ConditionalAttribute__proto__","isSvg","parseAttributes","notIn","updateDelegate","Attribute__proto__","namespaces","useProperty","isTwoway","isBoolean","lookupNamespace","getUpdateDelegate","twowayBinding","flag","bubbler","BindingFlag__proto__","createComment","teardownHook","destructHook","RactiveModel","SharedModel","RactiveModel__proto__","isLink","_cssModel","initLink","RootModel","RootModel__proto__","attached","attachImplicits","compute","createLink","targetPath","detachImplicits","virtual","getVirtual","objectKeys","getRactiveModel","ractiveModel","getValueChildren","_link","has","unescapedKey","Function","GlobalModel","shouldTeardown","constructHook","uid","ComponentConstructor","isAnchor","content","_partials","addChild","construct","mappings","_inlinePartials","eventHandlers","Component__proto__","initialise","getRactiveContext","checking","checkAnchors","callRender","unrenderItem","missingDecorator","Decorator__proto__","warnOnce","teardownArgsFn","Doctype__proto__","parentForm","from","intermediate","Math","min","object","properties","loop","refPattern","splitPattern","escapeKeyPattern","unescapeKeyPattern","KeyModel","isKey","KeyModel__proto__","relinking","dependant","registerLink","unregisterLink","reference","KeypathModel","isKeypath","KeypathModel__proto__","getChild","rebindChildren","fnBind","shuffleTasks","early","registerQueue","ModelBase","keyModels","patternObservers","ModelBase__proto__","task","stage","downstreamChanged","findMatches","existingMatches","getKeyModel","skip","lastLink","startPath","notify","notifiedUpstream","registerPatternObserver","observer","unregisterPatternObserver","updateFromBindings","cascade","Missing","shufle","LinkModel","sourcePath","LinkModel__proto__","mapping","isDetached","force","markedAll","rootLink","relinked","lnk","implicit","fireShuffleTasks","ln","TransitionManager","intros","outros","totalChildren","outroChildren","detachQueue","outrosComplete","TransitionManager__proto__","list","decrementOutros","check","decrementTotal","detachNodes","_detachNodes","ready","detachImmediate","batch","fulfilPromise","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","flushChanges","b","addObserver","defer","dispatch","thing","postRender","_batch","tickers","running","performance","now","requestAnimationFrame","tick","Ticker__proto__","elapsed","eased","stop","abort","prefixers","ticker","Model__proto__","rewrap","createBranch","adaptor","wrap","getPrefixer","__model","isObjectLike","branch","markForce","merge","oldArray","newArray","recreateArray","oldLength","usedIndices","firstUnusedIndex","SharedModel__proto__","SharedModel$1","global","window","ContextModel","FakeFragment","star","deepOpts","comparators","errorMessage","initStars","bubbleStars","method","arg","attachHook","detachHook","NUMBER_LITERAL","arrayProto","methodName","mdl","getNewIndices","updateHook","modelPush","modelPop","modelShift","modelUnshift","modelSort","modelSplice","modelReverse","ContextData","ContextData__proto__","prototypeAccessors","_data","Context__proto__","num","isObjectType","build","findModel","protoAnimate","getParent","hasListener","findEvent","dest","there","here","listen","raise","ev","drop","unlisten","protoUpdate","isBound","getBindingModel","getBindingPath","getBinding","setBinding","forRactive","methodNames","unprefixed","prefixed","j","makeFunction","query","mathml","xlink","xml","xmlns","ns","createElementNS","cloneNode","insertHook","Observer","oldContext","oldFn","updateOld","Observer__proto__","cancelled","resolver","_observers","newValue","oldValue","strict","PatternObserver","baseModel","baseKeypath","recursive","oldValues","newValues","PatternObserver__proto__","wildcards","touchedFrom","count","ok","ArrayObserver","pending","sliced","ArrayObserver__proto__","negativeOne","inserted","deleted","hadIndex","onceOptions","trim","notEmptyString","PREFIX","styleDefinitions","isDirty","styleElement","useCssText","combine","ensureArray","cleanCss","additionalReplaceRules","reconstruct","selectorsPattern","keyframesDeclarationPattern","selectorUnitPattern","excludePattern","dataRvcGuidPattern","CSSModel__proto__","depth","applyChanges","hasCurly","_cssIds","gatherIds","initCSS","_r_unbound","COMPUTATION_INSTRUCTIONS","fromId","updateClassName","updateInlineClass","updateBoolean","updateNamespacedAttribute","updateAttribute","updateMultipleSelectValue","updateSelectValue","wasSelected","updateContentEditableValue","updateRadioValue","wasChecked","updateValue","updateStringValue","updateRadioName","updateCheckboxName","valueAttribute","updateStyleAttribute","readStyle","prev","setProperty","updateInlineStyle","getPropertyValue","last","readClass","className","baseVal","getAttributeNS","removeAttributeNS","setAttributeNS","haystack","needle","qualified","hasAttribute","Ractive$teardown","torndown","getPromise","__ractive_instances__","getComputationSignature","getterString","setterString","createFunctionFromString","subscribe","subs","toPairs","single","welcome","initialiseProperties","handleAttributes","_attributePartial","getAdaptors","computed","protoAdapt","lookup","srcs","isolated","_subs","_nsSubs","_eventQueue","_children","byName","tpl","required","all","optional","mapAll","meta","nameOption","renderItem","nextNode","contains","lastBound","updateAnchors","res","isBindableByValue","isBindableByContentEditable","isContentEditable","isBindableByName","isBindableByChecked","nameAttr","currentTarget","endEl","correspondingUseElement","text","splitText","createTextNode","readNumberLiteral","readKey","token","namePattern","childData","getPartialFromRegistry","fillGaps","findParentPartial","findInstance","noRegistryFunctionReturn","findOwner","findConstructor","self","contextifyTemplate","okToParse","parsePartial","setTemplate","initing","aliasLocal","findFirstNode","hasIndexRef","section","getComponentConstructor","asyncProxy","cmp","ctor","guid","counter","placeholderId","newModel","hookQueue","childQueue","userOptions","getElement","append","logIfDebug","cssId","Ractive$render","others","Ractive$reset","rerender","changes","Ractive$resetTemplate","external","Ractive$set","Ractive$subtract","Ractive$toggle","TypeError","badArguments","gather","Ractive$toCSS","uniqueCssIds","ids","Ractive$toHTML","Ractive$transition","HTMLElement","Ractive$unrender","Ractive$updateModel","extendOne","Class","Target","_on","_observe","splitKeypathI","sourcesLength","sources","nextSource","nextKey","hasOwnProperty","thisArg","arrayLength","Node","nowOffset","Date","PENDING","FULFILLED","REJECTED","dispatchHandlers","fulfilledHandlers","rejectedHandlers","state","makeResolver","newState","makeDispatcher","wait","fulfill","reject","onFulfilled","onRejected","promise2","processResolutionHandler","handlers","forward","p1result","catch","promises","processPromise","reason","called","resolvePromise","y","rejectPromise","cancelAnimationFrame","lastTime","currentTime","timeToNextCall","log","printWarning","delimiters","tripleDelimiters","staticDelimiters","staticTripleDelimiters","csp","preserveWhitespace","sanitize","stripComments","resolveInstanceMembers","warnAboutAmbiguity","noIntro","noOutro","nestedTransitions","noCssTransform","easeIn","pow","easeOut","easeInOut","implementation","hasFeature","alreadyWarned","welcomeIntro","welcomeMessage","WELCOME_MESSAGE","hasGroup","captureGroup","pairs","isFinite","format","registryName","interpol","member","arrays","arrayLike","upstream","parts","findAlias","alias","tm","notifiedTotal","manager","trans","collectAllOutros","_list","prefixKeypath","rootKeypath","rootDot","relativeKeypath","initialFragment","explicitContext","badReference","repeater","shouldWarn","_fakeFragment","deep","deepSet","getComparator","sets","Ractive$add","immediate","getOptions","Ractive$animate","enqueue","dequeue","variants","eventNames","fireEventAs","initialFire","notifySubscribers","fullName","subscribers","originalEvent","stopEvent","findAnchors","findAnchorsIn","anchors","idxs","unrenderChild","prepend","insertAt","@this.parent","@this.root","Ractive$detach","Ractive$find","remote","Ractive$findAll","Ractive$findAllComponents","Ractive$findComponent","Ractive$findContainer","Ractive$findParent","orComponent","spliceArguments","getSpliceEquivalent","balance","removeStart","removeEnd","Ractive$update","Ractive$fire","Ractive$get","instances","staticContext","staticInfo","output","Ractive$insert","fireInsertHook","src","isUpstream","fresh","vals","olds","observers","silent","caller","keypaths","createObserver","isSilenced","silence","resume","wildcardIndex","double","Ractive$off","entry","Ractive$on","Ractive$once","listener","canonical","addCSS","styleDefinition","styleSheet","cssText","filteredStyleDefinitions","getElementsByTagName","extractString","unit","transformSelector","selectorUnits","modifiers","transformed","appended","prepended","transformCss","dataAttr","selectors","s4","floor","random","uuid","setCSSData","local","recomputeCSS","def","_css","evalCSS","transform","transformCSS","__proto__","validate","emptyData","childValue","parentIsFn","childIsFn","callDataFunction","fromProperties","primary","secondary","fromExpression","body","fromComputationString","bindTo","hasThis","functionBody","instructions","createFunction","exp","parseAsString","existingPartials","newPartials","overwrite","superMethod","getSuperMethod","_parent","hasSuper","oldSuper","_method","getMessage","deprecated","correct","isError","deprecateOption","deprecatedOption","deprecate","extendOtherMethods","RactiveProto","wrapPrototype","rx","entity","code","parseInt","validateCode","rule","rules"],"mappings":"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"}