{"version":3,"file":"runtime.min.js","sources":["../src/view/Fragment.js","../src/Ractive/prototype/reset.js","../src/Ractive/prototype/reverse.js","../src/Ractive/prototype/shift.js","../src/Ractive/prototype/sort.js","../src/Ractive/prototype/splice.js","../src/Ractive/prototype/unshift.js","../src/Ractive/prototype.js","../src/Ractive/static/styles.js","../src/extend/_extend.js","../src/Ractive.js","../src/parse/Parser.js","../src/parse/converters/expressions/primary/literal/stringLiteral/makeQuotedStringMatcher.js","../src/parse/converters/expressions/primary/literal/readStringLiteral.js","../src/parse/converters/expressions/primary/literal/readNumberLiteral.js","../src/parse/converters/expressions/shared/patterns.js","../src/parse/converters/expressions/shared/readKey.js","../src/utils/parseJSON.js","../src/view/items/component/Mapping.js","../src/view/items/element/specials/Option.js","../src/view/items/Partial.js","../src/model/specials/KeyModel.js","../src/view/RepeatedFragment.js","../src/view/items/Section.js","../src/view/items/element/specials/Select.js","../src/view/items/element/specials/Textarea.js","../src/view/items/Text.js","../src/config/visibility.js","../src/view/items/element/transitions/prefix.js","../src/view/items/element/transitions/createTransitions.js","../src/view/items/element/transitions/hyphenate.js","../src/view/items/element/Transition.js","../src/view/items/triple/insertHtml.js","../src/view/items/Triple.js","../src/view/items/createItem.js","../src/view/items/Component.js","../src/view/items/element/Decorator.js","../src/view/items/Doctype.js","../src/view/items/element/binding/Binding.js","../src/view/items/element/binding/CheckboxBinding.js","../src/view/items/element/binding/getBindingGroup.js","../src/view/items/element/binding/CheckboxNameBinding.js","../src/view/items/element/binding/ContentEditableBinding.js","../src/view/items/element/binding/GenericBinding.js","../src/view/items/element/binding/FileBinding.js","../src/view/items/element/binding/MultipleSelectBinding.js","../src/view/items/element/binding/NumericBinding.js","../src/view/items/element/binding/RadioBinding.js","../src/view/items/element/binding/RadioNameBinding.js","../src/view/items/element/binding/SingleSelectBinding.js","../src/view/items/Element.js","../src/view/items/element/specials/Form.js","../src/view/items/element/ElementEvents.js","../src/view/items/component/RactiveEvent.js","../src/view/items/shared/EventDirective.js","../src/view/items/shared/Mustache.js","../src/view/items/Interpolator.js","../src/view/items/element/specials/Input.js","../src/utils/dom.js","../src/Ractive/prototype/observe/Observer.js","../src/Ractive/prototype/observe/Pattern.js","../src/Ractive/prototype/observe/Array.js","../src/Ractive/prototype/observeOnce.js","../src/Ractive/prototype/shared/trim.js","../src/Ractive/prototype/shared/notEmptyString.js","../src/Ractive/prototype/pop.js","../src/Ractive/prototype/push.js","../src/global/css.js","../src/Ractive/config/custom/adapt.js","../src/utils/cleanCss.js","../src/Ractive/config/custom/css/transform.js","../src/model/specials/CSSModel.js","../src/Ractive/config/custom/css/css.js","../src/Ractive/config/custom/data.js","../src/config/template.js","../src/Ractive/config/custom/template.js","../src/Ractive/config/registries.js","../src/Ractive/config/config.js","../src/view/items/shared/Item.js","../src/model/ComputationChild.js","../src/model/Computation.js","../src/view/resolvers/ExpressionProxy.js","../src/view/resolvers/ReferenceExpressionProxy.js","../src/view/items/Alias.js","../src/utils/html.js","../src/view/helpers/specialAttrs.js","../src/view/items/element/attribute/getUpdateDelegate.js","../src/view/items/element/attribute/propertyNames.js","../src/view/items/element/ConditionalAttribute.js","../src/view/items/element/Attribute.js","../src/view/items/element/BindingFlag.js","../src/view/items/Comment.js","../src/model/specials/RactiveModel.js","../src/model/RootModel.js","../src/Ractive/construct.js","../src/Ractive/prototype/use.js","../src/Ractive/static/isInstance.js","../src/Ractive/static/styleGet.js","../src/Ractive/static/sharedSet.js","../src/Ractive/static/sharedGet.js","../src/Ractive/static/use.js","../src/extend/_macro.js","../src/Ractive/static/keypaths.js","../src/Ractive/static/findPlugin.js","../src/polyfills/Object.assign.js","../src/utils/object.js","../src/utils/is.js","../src/polyfills/performance.now.js","../src/polyfills/array.find.js","../src/polyfills/node.contains.js","../src/config/environment.js","../src/polyfills/Promise.js","../src/polyfills/requestAnimationFrame.js","../src/Ractive/config/defaults.js","../src/utils/log.js","../src/Ractive/static/easing.js","../src/config/errors.js","../src/Ractive/static/interpolators.js","../src/shared/keypaths.js","../src/utils/bind.js","../src/model/ModelBase.js","../src/global/capture.js","../src/model/LinkModel.js","../src/shared/getFunction.js","../src/parse/_parse.js","../src/Ractive/config/runtime-parser.js","../src/global/TransitionManager.js","../src/global/runloop.js","../src/shared/Ticker.js","../src/model/helpers/getPrefixer.js","../src/model/Model.js","../src/model/specials/SharedModel.js","../src/shared/getRactiveContext.js","../src/shared/set.js","../src/Ractive/prototype/shared/add.js","../src/Ractive/prototype/animate.js","../src/events/fireEvent.js","../src/events/Hook.js","../src/config/types.js","../src/Ractive/prototype/shared/makeArrayMethod.js","../src/shared/Context.js","../src/Ractive/static/getContext.js","../src/config/namespaces.js","../src/Ractive/config/wrapPrototypeMethod.js","../src/Ractive/config/deprecate.js","../src/view/resolvers/resolve.js","../src/utils/hyphenateCamel.js","../src/Ractive/prototype/teardown.js","../src/Ractive/helpers/subscribe.js","../src/view/items/shared/directiveArgs.js","../src/view/items/element/binding/handleDomEvent.js","../src/utils/getSelectedOptions.js","../src/view/items/element/binding/selectBinding.js","../src/view/items/shared/progressiveText.js","../src/view/items/partial/getPartialTemplate.js","../src/view/items/component/getComponentConstructor.js","../src/view/items/asyncProxy.js","../src/view/items/Await.js","../src/view/helpers/processItems.js","../src/Ractive/initialise.js","../src/Ractive/render.js","../src/Ractive/prototype/render.js","../src/Ractive/prototype/resetPartial.js","../src/Ractive/prototype/resetTemplate.js","../src/Ractive/prototype/set.js","../src/Ractive/prototype/subtract.js","../src/Ractive/prototype/toggle.js","../src/Ractive/prototype/toCSS.js","../src/Ractive/prototype/toHTML.js","../src/Ractive/prototype/toText.js","../src/Ractive/prototype/transition.js","../src/Ractive/prototype/unlink.js","../src/Ractive/prototype/unrender.js","../src/Ractive/prototype/updateModel.js","../src/utils/noop.js","../src/shared/registry.js","../src/shared/interpolate.js","../src/utils/array.js","../src/shared/methodCallers.js","../src/shared/rebind.js","../src/parse/utils/createFunction.js","../src/Ractive/helpers/getComputationSignature.js","../src/view/resolvers/resolveReference.js","../src/Ractive/prototype/add.js","../src/events/eventStack.js","../src/shared/anchors.js","../src/Ractive/prototype/attachChild.js","../src/Ractive/prototype/compute.js","../src/Ractive/prototype/detach.js","../src/Ractive/prototype/detachChild.js","../src/Ractive/prototype/find.js","../src/Ractive/prototype/findAll.js","../src/Ractive/prototype/findAllComponents.js","../src/Ractive/prototype/findComponent.js","../src/Ractive/prototype/findContainer.js","../src/Ractive/prototype/findParent.js","../src/view/items/shared/findElement.js","../src/shared/getNewIndices.js","../src/Ractive/prototype/update.js","../src/Ractive/prototype/fire.js","../src/Ractive/prototype/get.js","../src/Ractive/prototype/getContext.js","../src/Ractive/prototype/insert.js","../src/Ractive/prototype/link.js","../src/Ractive/prototype/observe.js","../src/Ractive/prototype/off.js","../src/Ractive/prototype/on.js","../src/Ractive/prototype/once.js","../src/Ractive/prototype/readLink.js","../src/utils/id.js","../src/Ractive/static/styleSet.js"],"sourcesContent":["import { ELEMENT, YIELDER } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport { findMap } from 'utils/array';\nimport { getContext, findParentWithContext } from 'shared/getRactiveContext';\nimport { shuffled, toEscapedString, toString } from 'shared/methodCallers';\nimport createItem from './items/createItem';\nimport processItems from './helpers/processItems';\nimport parseJSON from 'utils/parseJSON';\nimport { createDocumentFragment } from 'utils/dom';\nimport KeyModel from 'src/model/specials/KeyModel';\n\nexport default class Fragment {\n  constructor(options) {\n    this.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n    this.isRoot = !options.owner.up;\n    this.parent = this.isRoot ? null : this.owner.up;\n    this.ractive = options.ractive || (this.isRoot ? options.owner : this.parent.ractive);\n\n    this.componentParent = this.isRoot && this.ractive.component ? this.ractive.component.up : null;\n    if (!this.isRoot || this.ractive.delegate) {\n      this.delegate = this.owner.containerFragment\n        ? this.owner.containerFragment && this.owner.containerFragment.delegate\n        : (this.componentParent && this.componentParent.delegate) ||\n          (this.parent && this.parent.delegate);\n    } else {\n      this.delegate = false;\n    }\n\n    this.context = null;\n    this.rendered = false;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    if ('cssIds' in options) {\n      this.cssIds = options.cssIds && options.cssIds.length && options.cssIds;\n    } else {\n      this.cssIds = this.parent ? this.parent.cssIds : null;\n    }\n\n    this.dirty = false;\n    this.dirtyValue = true; // used for attribute values\n\n    this.template = options.template || [];\n    this.createItems();\n  }\n\n  bind(context) {\n    this.context = context;\n    const len = this.items.length;\n    for (let i = 0; i < len; i++) this.items[i].bind();\n    this.bound = true;\n\n    // in rare cases, a forced resolution (or similar) will cause the\n    // fragment to be dirty before it's even finished binding. In those\n    // cases we update immediately\n    if (this.dirty) this.update();\n\n    return this;\n  }\n\n  bubble() {\n    this.dirtyValue = true;\n\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.isRoot) {\n        // TODO encapsulate 'is component root, but not overall root' check?\n        if (this.ractive.component) {\n          this.ractive.component.bubble();\n        } else if (this.bound) {\n          runloop.addFragment(this);\n        }\n      } else {\n        this.owner.bubble(this.index);\n      }\n    }\n  }\n\n  createItems() {\n    // this is a hot code path\n    const max = this.template.length;\n    this.items = [];\n    for (let i = 0; i < max; i++) {\n      this.items[i] = createItem({\n        up: this,\n        template: this.template[i],\n        index: i\n      });\n    }\n  }\n\n  destroyed() {\n    const len = this.items.length;\n    for (let i = 0; i < len; i++) this.items[i].destroyed();\n    if (this.pathModel) this.pathModel.destroyed();\n    if (this.rootModel) this.rootModel.destroyed();\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      docFrag.appendChild(xs[i].detach());\n    }\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.items, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAll && i.findAll(selector, options));\n    }\n  }\n\n  findComponent(name, options) {\n    return findMap(this.items, i => i.findComponent(name, options));\n  }\n\n  findAllComponents(name, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAllComponents && i.findAllComponents(name, options));\n    }\n  }\n\n  findContext() {\n    const base = findParentWithContext(this);\n    if (!base || !base.context) return this.ractive.viewmodel;\n    else return base.context;\n  }\n\n  findNextNode(item) {\n    // search for the next node going forward\n    if (item) {\n      let it;\n      for (let i = item.index + 1; i < this.items.length; i++) {\n        it = this.items[i];\n        if (!it || !it.firstNode) continue;\n\n        const node = it.firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    // if this is the root fragment, and there are no more items,\n    // it means we're at the end...\n    if (this.isRoot) {\n      if (this.ractive.component) {\n        return this.ractive.component.up.findNextNode(this.ractive.component);\n      }\n\n      // TODO possible edge case with other content\n      // appended to this.ractive.el?\n      return null;\n    }\n\n    if (this.parent) return this.owner.findNextNode(this); // the argument is in case the parent is a RepeatedFragment\n  }\n\n  findParentNode() {\n    let fragment = this;\n\n    do {\n      if (fragment.owner.type === ELEMENT) {\n        return fragment.owner.node;\n      }\n\n      if (fragment.isRoot && !fragment.ractive.component) {\n        // TODO encapsulate check\n        return fragment.ractive.el;\n      }\n\n      if (fragment.owner.type === YIELDER) {\n        fragment = fragment.owner.containerFragment;\n      } else {\n        fragment = fragment.componentParent || fragment.parent; // TODO ugh\n      }\n    } while (fragment);\n\n    throw new Error('Could not find parent node'); // TODO link to issue tracker\n  }\n\n  firstNode(skipParent) {\n    const node = findMap(this.items, i => i.firstNode(true));\n    if (node) return node;\n    if (skipParent) return null;\n\n    return this.parent.findNextNode(this.owner);\n  }\n\n  getKey() {\n    return this.keyModel || (this.keyModel = new KeyModel(this.key));\n  }\n\n  getIndex() {\n    return this.idxModel || (this.idxModel = new KeyModel(this.index));\n  }\n\n  rebind(next) {\n    this.context = next;\n    if (this.rootModel) this.rootModel.context = this.context;\n    if (this.pathModel) this.pathModel.context = this.context;\n  }\n\n  rebound(update) {\n    this.items.forEach(x => x.rebound(update));\n    if (update) {\n      if (this.rootModel) this.rootModel.applyValue(this.context.getKeypath(this.ractive.root));\n      if (this.pathModel) this.pathModel.applyValue(this.context.getKeypath());\n    }\n  }\n\n  render(target, occupants) {\n    if (this.rendered) throw new Error('Fragment is already rendered!');\n    this.rendered = true;\n\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      xs[i].render(target, occupants);\n    }\n  }\n\n  resetTemplate(template) {\n    const wasBound = this.bound;\n    const wasRendered = this.rendered;\n\n    // TODO ensure transitions are disabled globally during reset\n\n    if (wasBound) {\n      if (wasRendered) this.unrender(true);\n      this.unbind();\n    }\n\n    this.template = template;\n    this.createItems();\n\n    if (wasBound) {\n      this.bind(this.context);\n\n      if (wasRendered) {\n        const parentNode = this.findParentNode();\n        const anchor = this.findNextNode();\n\n        if (anchor) {\n          const docFrag = createDocumentFragment();\n          this.render(docFrag);\n          parentNode.insertBefore(docFrag, anchor);\n        } else {\n          this.render(parentNode);\n        }\n      }\n    }\n  }\n\n  shuffled() {\n    this.items.forEach(shuffled);\n    if (this.rootModel) this.rootModel.applyValue(this.context.getKeypath(this.ractive.root));\n    if (this.pathModel) this.pathModel.applyValue(this.context.getKeypath());\n  }\n\n  toString(escape) {\n    return this.items.map(escape ? toEscapedString : toString).join('');\n  }\n\n  unbind(view) {\n    this.context = null;\n    const len = this.items.length;\n    for (let i = 0; i < len; i++) this.items[i].unbind(view);\n    this.bound = false;\n\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    const len = this.items.length;\n    for (let i = 0; i < len; i++) this.items[i].unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      if (!this.updating) {\n        this.dirty = false;\n        this.updating = true;\n        const len = this.items.length;\n        for (let i = 0; i < len; i++) this.items[i].update();\n        this.updating = false;\n      } else if (this.isRoot) {\n        runloop.addFragmentToRoot(this);\n      }\n    }\n  }\n\n  valueOf() {\n    if (this.items.length === 1) {\n      return this.items[0].valueOf();\n    }\n\n    if (this.dirtyValue) {\n      const values = {};\n      const source = processItems(this.items, values, this.ractive._guid);\n      const parsed = parseJSON(source, values);\n\n      this.value = parsed ? parsed.value : this.toString();\n\n      this.dirtyValue = false;\n    }\n\n    return this.value;\n  }\n}\nFragment.prototype.getContext = getContext;\nFragment.prototype.getKeypath = getKeypath;\n\nexport function getKeypath(root) {\n  const base = findParentWithContext(this);\n  let model;\n  if (root) {\n    if (!this.rootModel) {\n      this.rootModel = new KeyModel(\n        this.context.getKeypath(this.ractive.root),\n        this.context,\n        this.ractive.root\n      );\n      model = this.rootModel;\n    } else return this.rootModel;\n  } else {\n    if (!this.pathModel) {\n      this.pathModel = new KeyModel(this.context.getKeypath(), this.context);\n      model = this.pathModel;\n    } else return this.pathModel;\n  }\n\n  if (base && base.context) base.getKeypath(root).registerChild(model);\n\n  return model;\n}\n","import runloop from 'src/global/runloop';\nimport config from '../config/config';\nimport hooks from '../../events/Hook';\nimport dataConfigurator from '../config/custom/data';\nimport { isObjectType } from 'utils/is';\n\nconst shouldRerender = ['template', 'partials', 'components', 'decorators', 'events'];\n\nexport default function Ractive$reset(data) {\n  data = data || {};\n\n  if (!isObjectType(data)) {\n    throw new Error('The reset method takes either no arguments, or an object containing new data');\n  }\n\n  // TEMP need to tidy this up\n  data = dataConfigurator.init(this.constructor, this, { data });\n\n  const promise = runloop.start();\n\n  // If the root object is wrapped, try and use the wrapper's reset value\n  const wrapper = this.viewmodel.wrapper;\n  if (wrapper && wrapper.reset) {\n    if (wrapper.reset(data) === false) {\n      // reset was rejected, we need to replace the object\n      this.viewmodel.set(data);\n    }\n  } else {\n    this.viewmodel.set(data);\n  }\n\n  // reset config items and track if need to rerender\n  const changes = config.reset(this);\n  let rerender;\n\n  let i = changes.length;\n  while (i--) {\n    if (shouldRerender.indexOf(changes[i]) > -1) {\n      rerender = true;\n      break;\n    }\n  }\n\n  if (rerender) {\n    hooks.unrender.fire(this);\n    this.fragment.resetTemplate(this.template);\n    hooks.render.fire(this);\n    hooks.complete.fire(this);\n  }\n\n  runloop.end();\n\n  hooks.reset.fire(this, data);\n\n  return promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('reverse').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('shift').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('sort').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('splice').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('unshift').path;\n","import add from './prototype/add';\nimport animate from './prototype/animate';\nimport attachChild from './prototype/attachChild';\nimport compute from './prototype/compute';\nimport detach from './prototype/detach';\nimport detachChild from './prototype/detachChild';\nimport find from './prototype/find';\nimport findAll from './prototype/findAll';\nimport findAllComponents from './prototype/findAllComponents';\nimport findComponent from './prototype/findComponent';\nimport findContainer from './prototype/findContainer';\nimport findParent from './prototype/findParent';\nimport fire from './prototype/fire';\nimport get from './prototype/get';\nimport getContext from './prototype/getContext';\nimport insert from './prototype/insert';\nimport link from './prototype/link';\nimport observe from './prototype/observe';\nimport observeOnce from './prototype/observeOnce';\nimport off from './prototype/off';\nimport on from './prototype/on';\nimport once from './prototype/once';\nimport pop from './prototype/pop';\nimport push from './prototype/push';\nimport readLink from './prototype/readLink';\nimport render from './prototype/render';\nimport reset from './prototype/reset';\nimport resetPartial from './prototype/resetPartial';\nimport resetTemplate from './prototype/resetTemplate';\nimport reverse from './prototype/reverse';\nimport set from './prototype/set';\nimport shift from './prototype/shift';\nimport sort from './prototype/sort';\nimport splice from './prototype/splice';\nimport subtract from './prototype/subtract';\nimport teardown from './prototype/teardown';\nimport toggle from './prototype/toggle';\nimport toCSS from './prototype/toCSS';\nimport toHTML from './prototype/toHTML';\nimport toText from './prototype/toText';\nimport transition from './prototype/transition';\nimport unlink from './prototype/unlink';\nimport unrender from './prototype/unrender';\nimport unshift from './prototype/unshift';\nimport update from './prototype/update';\nimport updateModel from './prototype/updateModel';\nimport use from './prototype/use';\n\nconst proto = {\n  add,\n  animate,\n  attachChild,\n  compute,\n  detach,\n  detachChild,\n  find,\n  findAll,\n  findAllComponents,\n  findComponent,\n  findContainer,\n  findParent,\n  fire,\n  get,\n  getContext,\n  insert,\n  link,\n  observe,\n  observeOnce,\n  off,\n  on,\n  once,\n  pop,\n  push,\n  readLink,\n  render,\n  reset,\n  resetPartial,\n  resetTemplate,\n  reverse,\n  set,\n  shift,\n  sort,\n  splice,\n  subtract,\n  teardown,\n  toggle,\n  toCSS,\n  toCss: toCSS,\n  toHTML,\n  toHtml: toHTML,\n  toText,\n  transition,\n  unlink,\n  unrender,\n  unshift,\n  update,\n  updateModel,\n  use\n};\n\nexport default proto;\n","import { isFunction } from 'utils/is';\nimport { addCSS, applyCSS } from 'src/global/css';\nimport { recomputeCSS } from './styleSet';\n\nconst styles = [];\n\nexport function addStyle(id, css) {\n  if (styles.find(s => s.id === id))\n    throw new Error(`Extra styles with the id '${id}' have already been added.`);\n  styles.push({ id, css });\n\n  if (!this.css) {\n    Object.defineProperty(this, 'css', { configurable: false, writable: false, value: buildCSS });\n  }\n\n  if (!this._cssDef) {\n    Object.defineProperty(this, '_cssDef', {\n      configurable: true,\n      writable: false,\n      value: {\n        transform: false,\n        id: 'Ractive.addStyle'\n      }\n    });\n\n    addCSS(this._cssDef);\n  }\n\n  recomputeCSS(this);\n  applyCSS(true);\n}\n\nfunction buildCSS(data) {\n  return styles\n    .map(s => `\\n/* ---- extra style ${s.id} */\\n` + (isFunction(s.css) ? s.css(data) : s.css))\n    .join('');\n}\n\nexport function hasStyle(id) {\n  return !!styles.find(s => s.id === id);\n}\n","import config from '../Ractive/config/config';\nimport dataConfigurator from '../Ractive/config/custom/data';\nimport construct from '../Ractive/construct';\nimport initialise from '../Ractive/initialise';\nimport Ractive from '../Ractive';\nimport isInstance from '../Ractive/static/isInstance';\nimport styleSet from '../Ractive/static/styleSet';\nimport styleGet from '../Ractive/static/styleGet';\nimport { addStyle, hasStyle } from '../Ractive/static/styles';\nimport sharedSet from '../Ractive/static/sharedSet';\nimport sharedGet from '../Ractive/static/sharedGet';\nimport use from '../Ractive/static/use';\nimport { create, defineProperties, toPairs, defineProperty } from 'utils/object';\nimport { isArray, isFunction } from 'utils/is';\n\nconst callsSuper = /super\\s*\\(|\\.call\\s*\\(\\s*this/;\n\nexport function extend(...options) {\n  if (!options.length) {\n    return extendOne(this);\n  } else {\n    return options.reduce(extendOne, this);\n  }\n}\n\nexport function extendWith(Class, options = {}) {\n  return extendOne(this, options, Class);\n}\n\nfunction extendOne(Parent, options = {}, Target) {\n  let proto;\n  let Child = isFunction(Target) && Target;\n\n  if (options.prototype instanceof Ractive) {\n    throw new Error(`Ractive no longer supports multiple inheritance.`);\n  }\n\n  if (Child) {\n    if (!(Child.prototype instanceof Parent)) {\n      throw new Error(\n        `Only classes that inherit the appropriate prototype may be used with extend`\n      );\n    }\n    if (!callsSuper.test(Child.toString())) {\n      throw new Error(`Only classes that call super in their constructor may be used with extend`);\n    }\n\n    proto = Child.prototype;\n  } else {\n    Child = function(options) {\n      if (!(this instanceof Child)) return new Child(options);\n\n      construct(this, options || {});\n      initialise(this, options || {}, {});\n    };\n\n    proto = create(Parent.prototype);\n    proto.constructor = Child;\n\n    Child.prototype = proto;\n  }\n\n  // Static properties\n  defineProperties(Child, {\n    // alias prototype as defaults\n    defaults: { value: proto },\n\n    extend: { value: extend, writable: true, configurable: true },\n    extendWith: { value: extendWith, writable: true, configurable: true },\n    extensions: { value: [] },\n    use: { value: use },\n\n    isInstance: { value: isInstance },\n\n    Parent: { value: Parent },\n    Ractive: { value: Ractive },\n\n    styleGet: { value: styleGet.bind(Child), configurable: true },\n    styleSet: { value: styleSet.bind(Child), configurable: true }\n  });\n\n  // extend configuration\n  config.extend(Parent, proto, options, Child);\n\n  // store event and observer registries on the constructor when extending\n  Child._on = (Parent._on || []).concat(toPairs(options.on));\n  Child._observe = (Parent._observe || []).concat(toPairs(options.observe));\n\n  Parent.extensions.push(Child);\n\n  // attribute defs are not inherited, but they need to be stored\n  if (options.attributes) {\n    let attrs;\n\n    // allow an array of optional props or an object with arrays for optional and required props\n    if (isArray(options.attributes)) {\n      attrs = { optional: options.attributes, required: [] };\n    } else {\n      attrs = options.attributes;\n    }\n\n    // make sure the requisite keys actually store arrays\n    if (!isArray(attrs.required)) attrs.required = [];\n    if (!isArray(attrs.optional)) attrs.optional = [];\n\n    Child.attributes = attrs;\n  }\n\n  dataConfigurator.extend(Parent, proto, options, Child);\n\n  defineProperty(Child, 'helpers', { writable: true, value: proto.helpers });\n\n  if (isArray(options.use)) Child.use.apply(Child, options.use);\n\n  return Child;\n}\n\ndefineProperties(Ractive, {\n  sharedGet: { value: sharedGet },\n  sharedSet: { value: sharedSet },\n  styleGet: { configurable: true, value: styleGet.bind(Ractive) },\n  styleSet: { configurable: true, value: styleSet.bind(Ractive) },\n  addCSS: { configurable: false, value: addStyle.bind(Ractive) },\n  hasCSS: { configurable: false, value: hasStyle.bind(Ractive) }\n});\n","import './polyfills/Object.assign';\nimport './polyfills/array.find';\nimport './polyfills/node.contains';\nimport './polyfills/performance.now';\nimport './polyfills/Promise';\nimport './polyfills/requestAnimationFrame';\n\nimport defaults from './Ractive/config/defaults';\nimport easing from './Ractive/static/easing';\nimport interpolators from './Ractive/static/interpolators';\nimport { svg, win } from './config/environment';\nimport proto from './Ractive/prototype';\nimport { extend, extendWith } from './extend/_extend';\nimport macro from './extend/_macro';\nimport parse from './parse/_parse';\nimport getContext from './Ractive/static/getContext';\nimport isInstance from './Ractive/static/isInstance';\nimport use from './Ractive/static/use';\nimport construct from './Ractive/construct';\nimport initialise from './Ractive/initialise';\nimport { getCSS } from './global/css';\nimport { escapeKey, unescapeKey, normalise } from './shared/keypaths';\nimport { joinKeys, splitKeypath } from './Ractive/static/keypaths';\nimport shared from './Ractive/shared';\nimport { findPlugin } from './Ractive/static/findPlugin';\nimport parseJSON from './utils/parseJSON';\nimport CSSModel from './model/specials/CSSModel';\nimport { data as sharedData } from './model/specials/SharedModel';\nimport { extern } from './shared/getRactiveContext';\nimport { warn } from 'utils/log';\n\nimport { assign, defineProperty, defineProperties } from 'utils/object';\n\nexport default function Ractive(options) {\n  if (!(this instanceof Ractive)) return new Ractive(options);\n\n  construct(this, options || {});\n  initialise(this, options || {}, {});\n}\n\n// check to see if we're being asked to force Ractive as a global for some weird environments\nif (win && !win.Ractive) {\n  let opts = '';\n  const script =\n    document.currentScript ||\n    /* istanbul ignore next */ document.querySelector('script[data-ractive-options]');\n\n  if (script) opts = script.getAttribute('data-ractive-options') || '';\n\n  /* istanbul ignore next */\n  if (~opts.indexOf('ForceGlobal')) win.Ractive = Ractive;\n} else if (win) {\n  warn(`Ractive already appears to be loaded while loading BUILD_PLACEHOLDER_VERSION.`);\n}\n\nassign(Ractive.prototype, proto, defaults);\nRactive.prototype.constructor = Ractive;\n\n// alias prototype as `defaults`\nRactive.defaults = Ractive.prototype;\n\n// share defaults with the parser\nshared.defaults = Ractive.defaults;\nshared.Ractive = Ractive;\n\n// static properties\ndefineProperties(Ractive, {\n  // debug flag\n  DEBUG: { writable: true, value: true },\n  DEBUG_PROMISES: { writable: true, value: true },\n\n  // static methods:\n  extend: { value: extend },\n  extendWith: { value: extendWith },\n  escapeKey: { value: escapeKey },\n  evalObjectString: { value: parseJSON },\n  findPlugin: { value: findPlugin },\n  getContext: { value: getContext },\n  getCSS: { value: getCSS },\n  isInstance: { value: isInstance },\n  joinKeys: { value: joinKeys },\n  macro: { value: macro },\n  normaliseKeypath: { value: normalise },\n  parse: { value: parse },\n  splitKeypath: { value: splitKeypath },\n  // sharedSet and styleSet are in _extend because circular refs\n  unescapeKey: { value: unescapeKey },\n  use: { value: use },\n\n  // support\n  enhance: { writable: true, value: false },\n  svg: { value: svg },\n\n  // version\n  VERSION: { value: 'BUILD_PLACEHOLDER_VERSION' },\n\n  // plugins\n  adaptors: { writable: true, value: {} },\n  components: { writable: true, value: {} },\n  decorators: { writable: true, value: {} },\n  easing: { writable: true, value: easing },\n  events: { writable: true, value: {} },\n  extensions: { value: [] },\n  helpers: { writable: true, value: defaults.helpers },\n  interpolators: { writable: true, value: interpolators },\n  partials: { writable: true, value: {} },\n  transitions: { writable: true, value: {} },\n\n  // CSS variables\n  cssData: { configurable: true, value: {} },\n\n  // access to @shared without an instance\n  sharedData: { value: sharedData },\n\n  // for getting the source Ractive lib from a constructor\n  Ractive: { value: Ractive },\n\n  // to allow extending contexts\n  Context: { value: extern.Context.prototype }\n});\n\n// cssData must already be in place\ndefineProperty(Ractive, '_cssModel', {\n  configurable: true,\n  value: new CSSModel(Ractive)\n});\n\ndefineProperty(Ractive.prototype, 'rendered', {\n  get() {\n    return this.fragment && this.fragment.rendered;\n  }\n});\n","import { warnIfDebug } from 'utils/log';\nimport { create, hasOwn } from 'utils/object';\n\nconst leadingWhitespace = /^\\s+/;\n\nconst ParseError = function(message) {\n  this.name = 'ParseError';\n  this.message = message;\n  try {\n    throw new Error(message);\n  } catch (e) {\n    this.stack = e.stack;\n  }\n};\n\nParseError.prototype = Error.prototype;\n\nconst Parser = function(str, options) {\n  let item;\n  let lineStart = 0;\n\n  this.str = str;\n  this.options = options || {};\n  this.pos = 0;\n\n  this.lines = this.str.split('\\n');\n  this.lineEnds = this.lines.map(line => {\n    const lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n    lineStart = lineEnd;\n    return lineEnd;\n  }, 0);\n\n  // Custom init logic\n  if (this.init) this.init(str, options);\n\n  const items = [];\n\n  while (this.pos < this.str.length && (item = this.read())) {\n    items.push(item);\n  }\n\n  this.leftover = this.remaining();\n  this.result = this.postProcess ? this.postProcess(items, options) : items;\n};\n\nParser.prototype = {\n  read(converters) {\n    let i, item;\n\n    if (!converters) converters = this.converters;\n\n    const pos = this.pos;\n\n    const len = converters.length;\n    for (i = 0; i < len; i += 1) {\n      this.pos = pos; // reset for each attempt\n\n      if ((item = converters[i](this))) {\n        return item;\n      }\n    }\n\n    return null;\n  },\n\n  getContextMessage(pos, message) {\n    const [lineNum, columnNum] = this.getLinePos(pos);\n    if (this.options.contextLines === -1) {\n      return [lineNum, columnNum, `${message} at line ${lineNum} character ${columnNum}`];\n    }\n\n    const line = this.lines[lineNum - 1];\n\n    let contextUp = '';\n    let contextDown = '';\n    if (this.options.contextLines) {\n      const start =\n        lineNum - 1 - this.options.contextLines < 0 ? 0 : lineNum - 1 - this.options.contextLines;\n      contextUp = this.lines\n        .slice(start, lineNum - 1 - start)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      contextDown = this.lines\n        .slice(lineNum, lineNum + this.options.contextLines)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      if (contextUp) {\n        contextUp += '\\n';\n      }\n      if (contextDown) {\n        contextDown = '\\n' + contextDown;\n      }\n    }\n\n    let numTabs = 0;\n    const annotation =\n      contextUp +\n      line.replace(/\\t/g, (match, char) => {\n        if (char < columnNum) {\n          numTabs += 1;\n        }\n\n        return '  ';\n      }) +\n      '\\n' +\n      new Array(columnNum + numTabs).join(' ') +\n      '^----' +\n      contextDown;\n\n    return [\n      lineNum,\n      columnNum,\n      `${message} at line ${lineNum} character ${columnNum}:\\n${annotation}`\n    ];\n  },\n\n  getLinePos(char) {\n    let lineNum = 0;\n    let lineStart = 0;\n\n    while (char >= this.lineEnds[lineNum]) {\n      lineStart = this.lineEnds[lineNum];\n      lineNum += 1;\n    }\n\n    const columnNum = char - lineStart;\n    return [lineNum + 1, columnNum + 1, char]; // line/col should be one-based, not zero-based!\n  },\n\n  error(message) {\n    const [lineNum, columnNum, msg] = this.getContextMessage(this.pos, message);\n\n    const error = new ParseError(msg);\n\n    error.line = lineNum;\n    error.character = columnNum;\n    error.shortMessage = message;\n\n    throw error;\n  },\n\n  matchString(string) {\n    if (this.str.substr(this.pos, string.length) === string) {\n      this.pos += string.length;\n      return string;\n    }\n  },\n\n  matchPattern(pattern) {\n    let match;\n\n    if ((match = pattern.exec(this.remaining()))) {\n      this.pos += match[0].length;\n      return match[1] || match[0];\n    }\n  },\n\n  sp() {\n    this.matchPattern(leadingWhitespace);\n  },\n\n  remaining() {\n    return this.str.substring(this.pos);\n  },\n\n  nextChar() {\n    return this.str.charAt(this.pos);\n  },\n\n  warn(message) {\n    const msg = this.getContextMessage(this.pos, message)[2];\n\n    warnIfDebug(msg);\n  }\n};\n\nParser.extend = function(proto) {\n  const Parent = this;\n  const Child = function(str, options) {\n    Parser.call(this, str, options);\n  };\n\n  Child.prototype = create(Parent.prototype);\n\n  for (const key in proto) {\n    if (hasOwn(proto, key)) {\n      Child.prototype[key] = proto[key];\n    }\n  }\n\n  Child.extend = Parser.extend;\n  return Child;\n};\n\nexport default Parser;\n","// Match one or more characters until: \", ', \\, or EOL/EOF.\n// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\nconst stringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n// Match one escape sequence, including the backslash.\nexport const escapeSequencePattern = /^\\\\(?:[`'\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n// Match one ES5 line continuation (backslash + line terminator).\nexport const lineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n// Helper for defining getDoubleQuotedString and getSingleQuotedString.\nexport default function(okQuote) {\n  return function(parser) {\n    let literal = '\"';\n    let done = false;\n    let next;\n\n    while (!done) {\n      next =\n        parser.matchPattern(stringMiddlePattern) ||\n        parser.matchPattern(escapeSequencePattern) ||\n        parser.matchString(okQuote);\n      if (next) {\n        if (next === `\"`) {\n          literal += `\\\\\"`;\n        } else if (next === `\\\\'`) {\n          literal += `'`;\n        } else {\n          literal += next;\n        }\n      } else {\n        next = parser.matchPattern(lineContinuationPattern);\n        if (next) {\n          // convert \\(newline-like) into a \\u escape, which is allowed in JSON\n          literal += '\\\\u' + ('000' + next.charCodeAt(1).toString(16)).slice(-4);\n        } else {\n          done = true;\n        }\n      }\n    }\n\n    literal += '\"';\n\n    // use JSON.parse to interpret escapes\n    return JSON.parse(literal);\n  };\n}\n","import { STRING_LITERAL } from '../../../../../config/types';\nimport makeQuotedStringMatcher from './stringLiteral/makeQuotedStringMatcher';\n\nconst singleMatcher = makeQuotedStringMatcher(`\"`);\nconst doubleMatcher = makeQuotedStringMatcher(`'`);\n\nexport default function(parser) {\n  const start = parser.pos;\n  const quote = parser.matchString(`'`) || parser.matchString(`\"`);\n\n  if (quote) {\n    const string = (quote === `'` ? singleMatcher : doubleMatcher)(parser);\n\n    if (!parser.matchString(quote)) {\n      parser.pos = start;\n      return null;\n    }\n\n    return {\n      t: STRING_LITERAL,\n      v: string\n    };\n  }\n\n  return null;\n}\n","import { NUMBER_LITERAL } from '../../../../../config/types';\n\n// bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\nconst numberPattern = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\nexport default function readNumberLiteral(parser) {\n  let result;\n\n  if ((result = parser.matchPattern(numberPattern))) {\n    return {\n      t: NUMBER_LITERAL,\n      v: result\n    };\n  }\n\n  return null;\n}\n","export const name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\nexport const spreadPattern = /^\\s*\\.{3}/;\nexport const legalReference = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:\\.(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nexport const relaxedName = /^[a-zA-Z_$][-\\/a-zA-Z_$0-9]*(?:\\.(?:[a-zA-Z_$][-\\/a-zA-Z_$0-9]*))*/;\n","import readStringLiteral from '../primary/literal/readStringLiteral';\nimport readNumberLiteral from '../primary/literal/readNumberLiteral';\nimport { name as namePattern } from './patterns';\n\nconst identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n// http://mathiasbynens.be/notes/javascript-properties\n// can be any name, string literal, or number literal\nexport default function readKey(parser) {\n  let token;\n\n  if ((token = readStringLiteral(parser))) {\n    return identifier.test(token.v) ? token.v : '\"' + token.v.replace(/\"/g, '\\\\\"') + '\"';\n  }\n\n  if ((token = readNumberLiteral(parser))) {\n    return token.v;\n  }\n\n  if ((token = parser.matchPattern(namePattern))) {\n    return token;\n  }\n\n  return null;\n}\n","import Parser from 'parse/Parser';\nimport readStringLiteral from 'parse/converters/expressions/primary/literal/readStringLiteral';\nimport readKey from 'parse/converters/expressions/shared/readKey';\nimport { hasOwn, keys } from 'utils/object';\n\n// simple JSON parser, without the restrictions of JSON parse\n// (i.e. having to double-quote keys).\n//\n// If passed a hash of values as the second argument, ${placeholders}\n// will be replaced with those values\n\nconst specials = {\n  true: true,\n  false: false,\n  null: null,\n  undefined\n};\n\nconst specialsPattern = new RegExp('^(?:' + keys(specials).join('|') + ')');\nconst numberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\nconst placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\nconst placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\nconst onlyWhitespace = /^\\s*$/;\n\nconst JsonParser = Parser.extend({\n  init(str, options) {\n    this.values = options.values;\n    this.sp();\n  },\n\n  postProcess(result) {\n    if (result.length !== 1 || !onlyWhitespace.test(this.leftover)) {\n      return null;\n    }\n\n    return { value: result[0].v };\n  },\n\n  converters: [\n    function getPlaceholder(parser) {\n      if (!parser.values) return null;\n\n      const placeholder = parser.matchPattern(placeholderAtStartPattern);\n\n      if (placeholder && hasOwn(parser.values, placeholder)) {\n        return { v: parser.values[placeholder] };\n      }\n    },\n\n    function getSpecial(parser) {\n      const special = parser.matchPattern(specialsPattern);\n      if (special) return { v: specials[special] };\n    },\n\n    function getNumber(parser) {\n      const number = parser.matchPattern(numberPattern);\n      if (number) return { v: +number };\n    },\n\n    function getString(parser) {\n      const stringLiteral = readStringLiteral(parser);\n      const values = parser.values;\n\n      if (stringLiteral && values) {\n        return {\n          v: stringLiteral.v.replace(placeholderPattern, (match, $1) =>\n            $1 in values ? values[$1] : $1\n          )\n        };\n      }\n\n      return stringLiteral;\n    },\n\n    function getObject(parser) {\n      if (!parser.matchString('{')) return null;\n\n      const result = {};\n\n      parser.sp();\n\n      if (parser.matchString('}')) {\n        return { v: result };\n      }\n\n      let pair;\n      while ((pair = getKeyValuePair(parser))) {\n        result[pair.key] = pair.value;\n\n        parser.sp();\n\n        if (parser.matchString('}')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n      }\n\n      return null;\n    },\n\n    function getArray(parser) {\n      if (!parser.matchString('[')) return null;\n\n      const result = [];\n\n      parser.sp();\n\n      if (parser.matchString(']')) {\n        return { v: result };\n      }\n\n      let valueToken;\n      while ((valueToken = parser.read())) {\n        result.push(valueToken.v);\n\n        parser.sp();\n\n        if (parser.matchString(']')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n\n        parser.sp();\n      }\n\n      return null;\n    }\n  ]\n});\n\nfunction getKeyValuePair(parser) {\n  parser.sp();\n\n  const key = readKey(parser);\n\n  if (!key) return null;\n\n  const pair = { key };\n\n  parser.sp();\n  if (!parser.matchString(':')) {\n    return null;\n  }\n  parser.sp();\n\n  const valueToken = parser.read();\n\n  if (!valueToken) return null;\n\n  pair.value = valueToken.v;\n  return pair;\n}\n\nexport default function(str, values) {\n  const parser = new JsonParser(str, { values });\n  return parser.result;\n}\n","import { INTERPOLATOR } from '../../../config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport parseJSON from '../../../utils/parseJSON';\nimport resolve from '../../resolvers/resolve';\nimport runloop from '../../../global/runloop';\nimport { warnIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isArray, isObjectType, isString } from 'utils/is';\n\nexport default class Mapping extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = this.element.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.element.attributeByName[this.name] = this;\n\n    this.value = options.template.f;\n  }\n\n  bind() {\n    const template = this.template.f;\n    const viewmodel = this.element.instance.viewmodel;\n\n    if (template === 0) {\n      // empty attributes are `true`\n      viewmodel.joinKey(this.name).set(true);\n    } else if (isString(template)) {\n      const parsed = parseJSON(template);\n      viewmodel.joinKey(this.name).set(parsed ? parsed.value : template);\n    } else if (isArray(template)) {\n      createMapping(this, true);\n    }\n  }\n\n  rebound(update) {\n    if (this.boundFragment) this.boundFragment.rebound(update);\n    if (this.link) {\n      this.model = resolve(this.up, this.template.f[0]);\n      const model = this.element.instance.viewmodel.joinAll(splitKeypath(this.name));\n      model.link(this.model, this.name, { mapping: true });\n    }\n  }\n\n  render() {}\n\n  unbind(view) {\n    if (this.model) this.model.unregister(this);\n    if (this.boundFragment) this.boundFragment.unbind(view);\n\n    if (this.element.bound) {\n      if (this.link.target === this.model) this.link.owner.unlink();\n    }\n  }\n\n  unrender() {}\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.boundFragment) this.boundFragment.update();\n    }\n  }\n}\n\nfunction createMapping(item) {\n  const template = item.template.f;\n  const viewmodel = item.element.instance.viewmodel;\n  const childData = viewmodel.value;\n\n  if (template.length === 1 && template[0].t === INTERPOLATOR) {\n    const model = resolve(item.up, template[0]);\n    const val = model.get(false);\n\n    // if the interpolator is not static\n    if (!template[0].s) {\n      item.model = model;\n      item.link = viewmodel.createLink(item.name, model, template[0].r, {\n        mapping: true\n      });\n\n      // initialize parent side of the mapping from child data\n      if (val === undefined && !model.isReadonly && item.name in childData) {\n        model.set(childData[item.name]);\n      }\n    } else if (!isObjectType(val) || template[0].x) {\n      // copy non-object, non-computed vals through\n      viewmodel.joinKey(splitKeypath(item.name)).set(val);\n    } else {\n      // warn about trying to copy an object\n      warnIfDebug(`Cannot copy non-computed object value from static mapping '${item.name}'`);\n    }\n\n    // if the item isn't going to manage the model, give it a change to tear down if it's computed\n    if (model !== item.model) model.unregister();\n  } else {\n    item.boundFragment = new Fragment({\n      owner: item,\n      template\n    }).bind();\n\n    item.model = viewmodel.joinKey(splitKeypath(item.name));\n    item.model.set(item.boundFragment.valueOf());\n\n    // item is a *bit* of a hack\n    item.boundFragment.bubble = () => {\n      Fragment.prototype.bubble.call(item.boundFragment);\n      // defer this to avoid mucking around model deps if there happens to be an expression involved\n      runloop.scheduleTask(() => {\n        item.boundFragment.update();\n        item.model.set(item.boundFragment.valueOf());\n      });\n    };\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport Element from '../../Element';\nimport findElement from '../../shared/findElement';\nimport { isArray } from 'utils/is';\n\nexport default class Option extends Element {\n  constructor(options) {\n    const template = options.template;\n    if (!template.a) template.a = {};\n\n    // If the value attribute is missing, use the element's content,\n    // as long as it isn't disabled\n    if (template.a.value === undefined && !('disabled' in template.a)) {\n      template.a.value = template.f || '';\n    }\n\n    super(options);\n\n    this.select = findElement(this.parent || this.up, false, 'select');\n  }\n\n  bind() {\n    if (!this.select) {\n      super.bind();\n      return;\n    }\n\n    // If the select has a value, it overrides the `selected` attribute on\n    // this option - so we delete the attribute\n    const selectedAttribute = this.attributeByName.selected;\n    if (selectedAttribute && this.select.getAttribute('value') !== undefined) {\n      const index = this.attributes.indexOf(selectedAttribute);\n      this.attributes.splice(index, 1);\n      delete this.attributeByName.selected;\n    }\n\n    super.bind();\n    this.select.options.push(this);\n  }\n\n  bubble() {\n    // if we're using content as value, may need to update here\n    const value = this.getAttribute('value');\n    if (this.node && this.node.value !== value) {\n      this.node._ractive.value = value;\n    }\n    super.bubble();\n  }\n\n  getAttribute(name) {\n    const attribute = this.attributeByName[name];\n    return attribute\n      ? attribute.getValue()\n      : name === 'value' && this.fragment\n      ? this.fragment.valueOf()\n      : undefined;\n  }\n\n  isSelected() {\n    const optionValue = this.getAttribute('value');\n\n    if (optionValue === undefined || !this.select) {\n      return false;\n    }\n\n    const selectValue = this.select.getAttribute('value');\n\n    if (this.select.compare(selectValue, optionValue)) {\n      return true;\n    }\n\n    if (this.select.getAttribute('multiple') && isArray(selectValue)) {\n      let i = selectValue.length;\n      while (i--) {\n        if (this.select.compare(selectValue[i], optionValue)) {\n          return true;\n        }\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n\n    if (!this.attributeByName.value) {\n      this.node._ractive.value = this.getAttribute('value');\n    }\n  }\n\n  unbind(view) {\n    super.unbind(view);\n\n    if (this.select) {\n      removeFromArray(this.select.options, this);\n    }\n  }\n}\n","import { ELEMENT, PARTIAL, SECTION, SECTION_WITH, YIELDER } from 'config/types';\nimport { assign, create, hasOwn, keys } from 'utils/object';\nimport { isArray, isFunction, isObjectType, isString } from 'utils/is';\nimport noop from 'utils/noop';\nimport { MustacheContainer } from './shared/Mustache';\nimport Fragment from '../Fragment';\nimport getPartialTemplate from './partial/getPartialTemplate';\nimport { resolveAliases } from './Alias';\nimport { warnOnceIfDebug, warnIfDebug } from 'utils/log';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport runloop from 'src/global/runloop';\nimport { applyCSS } from 'src/global/css';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function Partial(options) {\n  MustacheContainer.call(this, options);\n\n  const tpl = options.template;\n\n  // yielder is a special form of partial that will later require special handling\n  if (tpl.t === YIELDER) {\n    this.yielder = 1;\n  } else if (tpl.t === ELEMENT) {\n    // this is a macro partial, complete with macro constructor\n    // leaving this as an element will confuse up-template searches\n    this.type = PARTIAL;\n    this.macro = options.macro;\n  }\n}\n\nconst proto = (Partial.prototype = create(MustacheContainer.prototype));\n\nassign(proto, {\n  constructor: Partial,\n\n  bind() {\n    const template = this.template;\n\n    if (this.yielder) {\n      // the container is the instance that owns this node\n      this.container = this.up.ractive;\n      this.component = this.container.component;\n      this.containerFragment = this.up;\n\n      // normal component\n      if (this.component) {\n        // yields skip the owning instance and go straight to the surrounding context\n        this.up = this.component.up;\n\n        // {{yield}} is equivalent to {{yield content}}\n        if (!template.r && !template.x && !template.rx) this.refName = 'content';\n      } else {\n        // plain-ish instance that may be attached to a parent later\n        this.fragment = new Fragment({\n          owner: this,\n          template: []\n        });\n        this.fragment.bind();\n        return;\n      }\n    }\n\n    // this is a macro/super partial\n    if (this.macro) {\n      this.fn = this.macro;\n    } else {\n      // this is a plain partial or yielder\n      if (!this.refName) this.refName = template.r;\n\n      // if the refName exists as a partial, this is a plain old partial reference where no model binding will happen\n      if (this.refName) {\n        partialFromValue(this, this.refName);\n      }\n\n      // this is a dynamic/inline partial\n      if (!this.partial && !this.fn) {\n        MustacheContainer.prototype.bind.call(this);\n        if (this.model) partialFromValue(this, this.model.get());\n      }\n    }\n\n    if (!this.partial && !this.fn) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    createFragment(this, this.partial || []);\n\n    // macro/super partial\n    if (this.fn) initMacro(this);\n\n    this.fragment.bind();\n  },\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.yielder) {\n        this.containerFragment.bubble();\n      } else {\n        this.up.bubble();\n      }\n    }\n  },\n\n  findNextNode() {\n    return (this.containerFragment || this.up).findNextNode(this);\n  },\n\n  handleChange() {\n    this.dirtyTemplate = true;\n    this.externalChange = true;\n    this.bubble();\n  },\n\n  rebound(update) {\n    const aliases = this.fragment && this.fragment.aliases;\n    if (aliases) {\n      for (const k in aliases) {\n        if (aliases[k].rebound) aliases[k].rebound(update);\n        else {\n          aliases[k].unreference();\n          aliases[k] = 0;\n        }\n      }\n      if (this.template.z) {\n        resolveAliases(this.template.z, this.containerFragment || this.up, aliases);\n      }\n    }\n    if (this._attrs) {\n      keys(this._attrs).forEach(k => this._attrs[k].rebound(update));\n    }\n    MustacheContainer.prototype.rebound.call(this, update);\n  },\n\n  refreshAttrs() {\n    keys(this._attrs).forEach(k => {\n      this.handle.attributes[k] = !this._attrs[k].items.length || this._attrs[k].valueOf();\n    });\n  },\n\n  resetTemplate() {\n    if (this.fn && this.proxy) {\n      this.last = 0;\n      if (this.externalChange) {\n        if (isFunction(this.proxy.teardown)) this.proxy.teardown();\n        this.fn = this.proxy = null;\n      } else {\n        this.partial = this.fnTemplate;\n        return true;\n      }\n    }\n\n    this.partial = null;\n\n    if (this.refName) {\n      this.partial = getPartialTemplate(this.ractive, this.refName, this.up);\n    }\n\n    if (!this.partial && this.model) {\n      partialFromValue(this, this.model.get());\n    }\n\n    if (!this.fn) {\n      if (this.last && this.partial === this.last) return false;\n      else if (this.partial) {\n        this.last = this.partial;\n        contextifyTemplate(this);\n      }\n    }\n\n    this.unbindAttrs();\n\n    if (this.fn) {\n      initMacro(this);\n      if (isFunction(this.proxy.render)) runloop.scheduleTask(() => this.proxy.render());\n    } else if (!this.partial) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    return true;\n  },\n\n  render(target, occupants) {\n    if (this.fn && this.fn._cssDef && !this.fn._cssDef.applied) applyCSS();\n\n    this.fragment.render(target, occupants);\n\n    if (this.proxy && isFunction(this.proxy.render)) this.proxy.render();\n  },\n\n  unbind(view) {\n    this.fragment.unbind(view);\n\n    this.fragment.aliases = null;\n\n    this.unbindAttrs(view);\n\n    MustacheContainer.prototype.unbind.call(this, view);\n  },\n\n  unbindAttrs(view) {\n    if (this._attrs) {\n      keys(this._attrs).forEach(k => {\n        this._attrs[k].unbind(view);\n      });\n    }\n  },\n\n  unrender(shouldDestroy) {\n    if (this.proxy && isFunction(this.proxy.teardown)) this.proxy.teardown();\n\n    this.fragment.unrender(shouldDestroy);\n  },\n\n  update() {\n    const proxy = this.proxy;\n    this.updating = 1;\n\n    if (this.dirtyAttrs) {\n      this.dirtyAttrs = false;\n      keys(this._attrs).forEach(k => this._attrs[k].update());\n      this.refreshAttrs();\n      if (isFunction(proxy.update)) proxy.update(this.handle.attributes);\n    }\n\n    if (this.dirtyTemplate) {\n      this.dirtyTemplate = false;\n      this.resetTemplate() && this.fragment.resetTemplate(this.partial || []);\n    }\n\n    if (this.dirty) {\n      this.dirty = false;\n      if (proxy && isFunction(proxy.invalidate)) proxy.invalidate();\n      this.fragment.update();\n    }\n\n    this.externalChange = false;\n    this.updating = 0;\n  }\n});\n\nfunction createFragment(self, partial) {\n  self.partial = self.last = partial;\n  contextifyTemplate(self);\n\n  const options = {\n    owner: self,\n    template: self.partial\n  };\n\n  if (self.yielder) options.ractive = self.container.parent;\n\n  if (self.fn) options.cssIds = self.fn._cssIds;\n\n  const fragment = (self.fragment = new Fragment(options));\n\n  // partials may have aliases that need to be in place before binding\n  if (self.template.z) {\n    fragment.aliases = resolveAliases(self.template.z, self.containerFragment || self.up);\n  }\n}\n\nfunction contextifyTemplate(self) {\n  if (self.template.c) {\n    self.partial = [{ t: SECTION, n: SECTION_WITH, f: self.partial }];\n    assign(self.partial[0], self.template.c);\n    if (self.yielder) self.partial[0].y = self;\n  }\n}\n\nfunction partialFromValue(self, value, okToParse) {\n  let tpl = value;\n\n  if (isArray(tpl)) {\n    self.partial = tpl;\n  } else if (tpl && isObjectType(tpl)) {\n    if (isArray(tpl.t)) self.partial = tpl.t;\n    else if (isString(tpl.template))\n      self.partial = parsePartial(tpl.template, tpl.template, self.ractive).t;\n  } else if (isFunction(tpl) && tpl.styleSet) {\n    self.fn = tpl;\n    if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n  } else if (tpl != null) {\n    tpl = getPartialTemplate(self.ractive, '' + tpl, self.containerFragment || self.up);\n    if (tpl) {\n      self.name = value;\n      if (tpl.styleSet) {\n        self.fn = tpl;\n        if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n      } else self.partial = tpl;\n    } else if (okToParse) {\n      self.partial = parsePartial('' + value, '' + value, self.ractive).t;\n    } else {\n      self.name = value;\n    }\n  }\n\n  return self.partial;\n}\n\nfunction setTemplate(template) {\n  partialFromValue(this, template, true);\n\n  if (!this.initing) {\n    this.dirtyTemplate = true;\n    this.fnTemplate = this.partial;\n\n    if (this.updating) {\n      this.bubble();\n      runloop.promise();\n    } else {\n      const promise = runloop.start();\n\n      this.bubble();\n      runloop.end();\n\n      return promise;\n    }\n  }\n}\n\nfunction aliasLocal(ref, name) {\n  const aliases = this.fragment.aliases || (this.fragment.aliases = {});\n  if (!name) {\n    aliases[ref] = this._data;\n  } else {\n    aliases[name] = this._data.joinAll(splitKeypath(ref));\n  }\n}\n\nconst extras = 'extra-attributes';\n\nfunction initMacro(self) {\n  const fn = self.fn;\n  const fragment = self.fragment;\n\n  // defensively copy the template in case it changes\n  const template = (self.template = assign({}, self.template));\n  const handle = (self.handle = fragment.getContext({\n    proxy: self,\n    aliasLocal,\n    name: self.template.e || self.name,\n    attributes: {},\n    setTemplate: setTemplate.bind(self),\n    template,\n    macro: fn\n  }));\n\n  if (!template.p) template.p = {};\n  template.p = handle.partials = assign({}, template.p);\n  if (!hasOwn(template.p, 'content')) template.p.content = template.f || [];\n\n  if (isArray(fn.attributes)) {\n    self._attrs = {};\n\n    const invalidate = function() {\n      this.dirty = true;\n      self.dirtyAttrs = true;\n      self.bubble();\n    };\n\n    if (isArray(template.m)) {\n      const attrs = template.m;\n      template.p[extras] = template.m = attrs.filter(a => !~fn.attributes.indexOf(a.n));\n      attrs\n        .filter(a => ~fn.attributes.indexOf(a.n))\n        .forEach(a => {\n          const fragment = new Fragment({\n            template: a.f,\n            owner: self\n          });\n          fragment.bubble = invalidate;\n          fragment.findFirstNode = noop;\n          self._attrs[a.n] = fragment;\n        });\n    } else {\n      template.p[extras] = [];\n    }\n  } else {\n    template.p[extras] = template.m;\n  }\n\n  if (self._attrs) {\n    keys(self._attrs).forEach(k => {\n      self._attrs[k].bind();\n    });\n    self.refreshAttrs();\n  }\n\n  self.initing = 1;\n  self.proxy = fn.call(self.ractive, handle, handle.attributes) || {};\n  if (!self.partial) self.partial = [];\n  self.fnTemplate = self.partial;\n  self.initing = 0;\n\n  contextifyTemplate(self);\n  fragment.resetTemplate(self.partial);\n}\n\nfunction parsePartial(name, partial, ractive) {\n  let parsed;\n\n  try {\n    parsed = parser.parse(partial, parser.getParseOptions(ractive));\n  } catch (e) {\n    warnIfDebug(`Could not parse partial from expression '${name}'\\n${e.message}`);\n  }\n\n  return parsed || { t: [] };\n}\n","import { addToArray, removeFromArray } from 'utils/array';\nimport { unescapeKey } from 'shared/keypaths';\nimport { capture } from 'src/global/capture';\nimport { handleChange } from 'src/shared/methodCallers';\nimport noop from 'utils/noop';\n\nexport default class KeyModel {\n  constructor(value, context, instance) {\n    this.value = this.key = value;\n    this.context = context;\n    this.isReadonly = this.isKey = true;\n    this.deps = [];\n    this.links = [];\n    this.children = [];\n    this.instance = instance;\n  }\n\n  applyValue(value) {\n    if (value !== this.value) {\n      this.value = this.key = value;\n      this.deps.forEach(handleChange);\n      this.links.forEach(handleChange);\n      this.children.forEach(c => {\n        c.applyValue(c.context.getKeypath(c.instance));\n      });\n    }\n  }\n\n  destroyed() {\n    if (this.upstream) this.upstream.unregisterChild(this);\n  }\n\n  get(shouldCapture) {\n    if (shouldCapture) capture(this);\n    return unescapeKey(this.value);\n  }\n\n  getKeypath() {\n    return unescapeKey(this.value);\n  }\n\n  has() {\n    return false;\n  }\n\n  rebind(next, previous) {\n    let i = this.deps.length;\n    while (i--) this.deps[i].rebind(next, previous, false);\n\n    i = this.links.length;\n    while (i--) this.links[i].relinking(next, false);\n  }\n\n  register(dependant) {\n    this.deps.push(dependant);\n  }\n\n  registerChild(child) {\n    addToArray(this.children, child);\n    child.upstream = this;\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  unregister(dependant) {\n    removeFromArray(this.deps, dependant);\n  }\n\n  unregisterChild(child) {\n    removeFromArray(this.children, child);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n}\n\nKeyModel.prototype.reference = noop;\nKeyModel.prototype.unreference = noop;\n","import { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject, isObjectType } from 'utils/is';\nimport { findMap, buildNewIndices } from 'utils/array';\nimport { toEscapedString, toString, shuffled } from 'shared/methodCallers';\nimport Fragment, { getKeypath } from './Fragment';\nimport { ELEMENT } from 'config/types';\nimport { getContext } from 'shared/getRactiveContext';\nimport { keys } from 'utils/object';\nimport KeyModel from 'src/model/specials/KeyModel';\nimport { splitKeypath } from '../shared/keypaths';\nimport resolve from './resolvers/resolve';\n\nconst keypathString = /^\"(\\\\\"|[^\"])+\"$/;\n\nexport default class RepeatedFragment {\n  constructor(options) {\n    this.parent = options.owner.up;\n\n    // bit of a hack, so reference resolution works without another\n    // layer of indirection\n    this.up = this;\n    this.owner = options.owner;\n    this.ractive = this.parent.ractive;\n    this.delegate =\n      this.ractive.delegate !== false && (this.parent.delegate || findDelegate(this.parent));\n    // delegation disabled by directive\n    if (this.delegate && this.delegate.delegate === false) this.delegate = false;\n    // let the element know it's a delegate handler\n    if (this.delegate) this.delegate.delegate = this.delegate;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    this.cssIds = 'cssIds' in options ? options.cssIds : this.parent ? this.parent.cssIds : null;\n\n    this.context = null;\n    this.rendered = false;\n    this.iterations = [];\n\n    this.template = options.template;\n\n    this.indexRef = options.indexRef;\n    this.keyRef = options.keyRef;\n\n    this.pendingNewIndices = null;\n    this.previousIterations = null;\n\n    // track array versus object so updates of type rest\n    this.isArray = false;\n  }\n\n  bind(context) {\n    this.context = context;\n    this.bound = true;\n    const value = context.get();\n\n    const aliases = (this.aliases = this.owner.template.z && this.owner.template.z.slice());\n\n    const shuffler = aliases && aliases.find(a => a.n === 'shuffle');\n    if (shuffler && shuffler.x && shuffler.x.x) {\n      if (shuffler.x.x.s === 'true') this.shuffler = true;\n      else if (keypathString.test(shuffler.x.x.s))\n        this.shuffler = splitKeypath(shuffler.x.x.s.slice(1, -1));\n    }\n\n    if (this.shuffler) this.values = shuffleValues(this, this.shuffler);\n\n    if (this.source) this.source.model.unbind(this.source);\n    const source = context.isComputed && aliases && aliases.find(a => a.n === 'source');\n    if (source && source.x && source.x.r) {\n      const model = resolve(this, source.x);\n      this.source = {\n        handleChange() {},\n        rebind(next) {\n          this.model.unregister(this);\n          this.model = next;\n          next.register(this);\n        }\n      };\n      this.source.model = model;\n      model.register(this.source);\n    }\n\n    // {{#each array}}...\n    if ((this.isArray = isArray(value))) {\n      // we can't use map, because of sparse arrays\n      this.iterations = [];\n      const max = (this.length = value.length);\n      for (let i = 0; i < max; i += 1) {\n        this.iterations[i] = this.createIteration(i, i);\n      }\n    } else if (isObject(value)) {\n      // {{#each object}}...\n      this.isArray = false;\n\n      // TODO this is a dreadful hack. There must be a neater way\n      if (this.indexRef) {\n        const refs = this.indexRef.split(',');\n        this.keyRef = refs[0];\n        this.indexRef = refs[1];\n      }\n\n      const ks = keys(value);\n      this.length = ks.length;\n\n      this.iterations = ks.map((key, index) => {\n        return this.createIteration(key, index);\n      });\n    }\n\n    return this;\n  }\n\n  bubble(index) {\n    if (!this.bubbled) this.bubbled = [];\n    this.bubbled.push(index);\n\n    if (!this.rebounding) this.owner.bubble();\n  }\n\n  createIteration(key, index) {\n    const fragment = new Fragment({\n      owner: this,\n      template: this.template\n    });\n\n    fragment.isIteration = true;\n    fragment.delegate = this.delegate;\n\n    if (this.aliases) fragment.aliases = {};\n    swizzleFragment(this, fragment, key, index);\n\n    return fragment.bind(fragment.context);\n  }\n\n  destroyed() {\n    const len = this.iterations.length;\n    for (let i = 0; i < len; i++) this.iterations[i].destroyed();\n    if (this.pathModel) this.pathModel.destroyed();\n    if (this.rootModel) this.rootModel.destroyed();\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    this.iterations.forEach(fragment => docFrag.appendChild(fragment.detach()));\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.iterations, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    return this.iterations.forEach(i => i.findAll(selector, options));\n  }\n\n  findAllComponents(name, options) {\n    return this.iterations.forEach(i => i.findAllComponents(name, options));\n  }\n\n  findComponent(name, options) {\n    return findMap(this.iterations, i => i.findComponent(name, options));\n  }\n\n  findContext() {\n    return this.context;\n  }\n\n  findNextNode(iteration) {\n    if (iteration.index < this.iterations.length - 1) {\n      for (let i = iteration.index + 1; i < this.iterations.length; i++) {\n        const node = this.iterations[i].firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    return this.owner.findNextNode();\n  }\n\n  firstNode(skipParent) {\n    return this.iterations[0] ? this.iterations[0].firstNode(skipParent) : null;\n  }\n\n  getLast() {\n    return this.lastModel || (this.lastModel = new KeyModel(this.length - 1));\n  }\n\n  rebind(next) {\n    this.context = next;\n    if (this.source) return;\n    this.iterations.forEach(fragment => {\n      swizzleFragment(this, fragment, fragment.key, fragment.index);\n    });\n  }\n\n  rebound(update) {\n    this.context = this.owner.model;\n    this.iterations.forEach((f, i) => {\n      f.context = contextFor(this, f, i);\n      f.rebound(update);\n    });\n  }\n\n  render(target, occupants) {\n    const xs = this.iterations;\n    if (xs) {\n      const len = xs.length;\n      for (let i = 0; i < len; i++) {\n        xs[i].render(target, occupants);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  shuffle(newIndices, merge) {\n    if (!this.pendingNewIndices) this.previousIterations = this.iterations.slice();\n\n    if (!this.pendingNewIndices) this.pendingNewIndices = [];\n\n    this.pendingNewIndices.push(newIndices);\n\n    const iterations = [];\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      if (newIndex === -1) return;\n\n      const fragment = this.iterations[oldIndex];\n      iterations[newIndex] = fragment;\n\n      if (newIndex !== oldIndex && fragment) {\n        fragment.dirty = true;\n        if (merge) fragment.shouldRebind = 1;\n      }\n    });\n\n    this.iterations = iterations;\n\n    // if merging, we're in the midst of an update already\n    if (!merge) this.bubble();\n  }\n\n  shuffled() {\n    this.iterations.forEach(shuffled);\n  }\n\n  toString(escape) {\n    return this.iterations ? this.iterations.map(escape ? toEscapedString : toString).join('') : '';\n  }\n\n  unbind(view) {\n    this.bound = false;\n    if (this.source) this.source.model.unregister(this.source);\n    const iterations = this.pendingNewIndices ? this.previousIterations : this.iterations;\n    const len = iterations.length;\n    for (let i = 0; i < len; i++) iterations[i].unbind(view);\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    let len = this.iterations.length;\n    for (let i = 0; i < len; i++) this.iterations[i].unrender(shouldDestroy);\n    if (this.pendingNewIndices && this.previousIterations) {\n      len = this.previousIterations.length;\n      for (let i = 0; i < len; i++) this.previousIterations[i].unrender(shouldDestroy);\n    }\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.pendingNewIndices) {\n      this.bubbled.length = 0;\n      this.updatePostShuffle();\n      return;\n    }\n\n    if (this.updating) return;\n    this.updating = true;\n\n    if (this.shuffler) {\n      const values = shuffleValues(this, this.shuffler);\n      this.shuffle(buildNewIndices(this.values, values), true);\n      this.updatePostShuffle();\n    } else {\n      let len = this.iterations.length;\n      for (let i = 0; i < len; i++) {\n        const f = this.iterations[i];\n        f && f.idxModel && f.idxModel.applyValue(i);\n      }\n\n      const value = this.context.get();\n      const wasArray = this.isArray;\n\n      let toRemove;\n      let oldKeys;\n      let reset = true;\n      let i;\n\n      if ((this.isArray = isArray(value))) {\n        // if there's a source to map back to, make sure everything stays bound correctly\n        if (this.source) {\n          this.rebounding = 1;\n          const source = this.source.model.get();\n          this.iterations.forEach((f, c) => {\n            if (c < value.length && f.lastValue !== value[c] && ~(i = source.indexOf(value[c]))) {\n              swizzleFragment(this, f, c, c);\n              f.rebound(true);\n            }\n          });\n          this.rebounding = 0;\n        }\n\n        if (wasArray) {\n          reset = false;\n          if (this.iterations.length > value.length) {\n            toRemove = this.iterations.splice(value.length);\n          }\n        }\n      } else if (isObject(value) && !wasArray) {\n        reset = false;\n        toRemove = [];\n        oldKeys = {};\n        i = this.iterations.length;\n\n        while (i--) {\n          const fragment = this.iterations[i];\n          if (fragment.key in value) {\n            oldKeys[fragment.key] = true;\n          } else {\n            this.iterations.splice(i, 1);\n            toRemove.push(fragment);\n          }\n        }\n      }\n\n      const newLength = isArray(value) ? value.length : isObject(value) ? keys(value).length : 0;\n      this.length = newLength;\n      this.updateLast();\n\n      if (reset) {\n        toRemove = this.iterations;\n        this.iterations = [];\n      }\n\n      if (toRemove) {\n        len = toRemove.length;\n        for (let i = 0; i < len; i++) toRemove[i].unbind().unrender(true);\n      }\n\n      // update the remaining ones\n      if (!reset && this.isArray && this.bubbled && this.bubbled.length) {\n        const bubbled = this.bubbled;\n        this.bubbled = [];\n        len = bubbled.length;\n        for (let i = 0; i < len; i++)\n          this.iterations[bubbled[i]] && this.iterations[bubbled[i]].update();\n      } else {\n        len = this.iterations.length;\n        for (let i = 0; i < len; i++) this.iterations[i].update();\n      }\n\n      // add new iterations\n      let docFrag;\n      let fragment;\n\n      if (newLength > this.iterations.length) {\n        docFrag = this.rendered ? createDocumentFragment() : null;\n        i = this.iterations.length;\n\n        if (isArray(value)) {\n          while (i < value.length) {\n            fragment = this.createIteration(i, i);\n\n            this.iterations.push(fragment);\n            if (this.rendered) fragment.render(docFrag);\n\n            i += 1;\n          }\n        } else if (isObject(value)) {\n          // TODO this is a dreadful hack. There must be a neater way\n          if (this.indexRef && !this.keyRef) {\n            const refs = this.indexRef.split(',');\n            this.keyRef = refs[0];\n            this.indexRef = refs[1];\n          }\n\n          keys(value).forEach(key => {\n            if (!oldKeys || !(key in oldKeys)) {\n              fragment = this.createIteration(key, i);\n\n              this.iterations.push(fragment);\n              if (this.rendered) fragment.render(docFrag);\n\n              i += 1;\n            }\n          });\n        }\n\n        if (this.rendered) {\n          const parentNode = this.parent.findParentNode();\n          const anchor = this.parent.findNextNode(this.owner);\n\n          parentNode.insertBefore(docFrag, anchor);\n        }\n      }\n    }\n\n    this.updating = false;\n  }\n\n  updateLast() {\n    if (this.lastModel) this.lastModel.applyValue(this.length - 1);\n  }\n\n  updatePostShuffle() {\n    const newIndices = this.pendingNewIndices[0];\n    const parentNode = this.rendered ? this.parent.findParentNode() : null;\n    const nextNode = parentNode && this.owner.findNextNode();\n    const docFrag = parentNode ? createDocumentFragment() : null;\n\n    // map first shuffle through\n    this.pendingNewIndices.slice(1).forEach(indices => {\n      newIndices.forEach((newIndex, oldIndex) => {\n        newIndices[oldIndex] = indices[newIndex];\n      });\n    });\n\n    const len = (this.length = this.context.get().length);\n    const prev = this.previousIterations;\n    const iters = this.iterations;\n    const value = this.context.get();\n    const stash = {};\n    let idx, dest, pos, next, anchor, rebound;\n\n    const map = new Array(newIndices.length);\n    newIndices.forEach((e, i) => (map[e] = i));\n\n    this.updateLast();\n\n    idx = pos = 0;\n    while (idx < len) {\n      dest = newIndices[pos];\n      next = null;\n      rebound = false;\n\n      if (dest === -1) {\n        // drop it like it's hot\n        prev[pos].unbind().unrender(true);\n        prev[pos++] = 0;\n      } else if (dest > idx) {\n        // need to stash or pull one up\n        next = newIndices[pos + 1]; // TODO: maybe a shouldMove function that tracks multiple entries?\n        if (next <= dest) {\n          stash[dest] = prev[pos];\n          prev[pos++] = null;\n        } else {\n          next = stash[idx] || prev[map[idx]];\n          prev[map[idx]] = null;\n          anchor = prev[nextRendered(pos, newIndices, prev)];\n          anchor = (anchor && parentNode && anchor.firstNode()) || nextNode;\n\n          if (next) {\n            rebound = this.source && next.lastValue !== value[idx];\n            swizzleFragment(this, next, idx, idx);\n            if (parentNode) parentNode.insertBefore(next.detach(), anchor);\n          } else {\n            next = iters[idx] = this.createIteration(idx, idx);\n            if (parentNode) {\n              next.render(docFrag);\n              parentNode.insertBefore(docFrag, anchor);\n            }\n          }\n\n          idx++;\n        }\n      } else {\n        // all is well\n        next = iters[idx];\n        anchor = prev[nextRendered(pos, newIndices, prev)];\n        anchor = (anchor && parentNode && anchor.firstNode()) || nextNode;\n        if (!next) {\n          next = iters[idx] = this.createIteration(idx, idx);\n          if (parentNode) {\n            next.render(docFrag);\n            parentNode.insertBefore(docFrag, anchor);\n          }\n        } else if (pos !== idx || stash[idx]) {\n          rebound = this.source && next.lastValue !== value[idx];\n          swizzleFragment(this, next, idx, idx);\n          if (stash[idx] && parentNode) parentNode.insertBefore(next.detach(), anchor);\n        }\n\n        idx++;\n        prev[pos++] = null;\n      }\n\n      if (next && isObjectType(next)) {\n        if (next.shouldRebind || rebound) {\n          next.rebound(rebound);\n          next.shouldRebind = 0;\n        }\n        next.update();\n        next.shuffled();\n      }\n    }\n\n    // clean up any stragglers\n    const plen = prev.length;\n    for (let i = 0; i < plen; i++) prev[i] && prev[i].unbind().unrender(true);\n\n    if (this.shuffler) this.values = shuffleValues(this, this.shuffler);\n\n    this.pendingNewIndices = null;\n    this.previousIterations = null;\n  }\n}\n\nRepeatedFragment.prototype.getContext = getContext;\nRepeatedFragment.prototype.getKeypath = getKeypath;\n\n// find the topmost delegate\nfunction findDelegate(start) {\n  let frag = start;\n  let delegate, el;\n\n  out: while (frag) {\n    // find next element\n    el = 0;\n    while (!el && frag) {\n      if (frag.owner.type === ELEMENT) el = frag.owner;\n      if (frag.owner.ractive && frag.owner.ractive.delegate === false) break out;\n      frag = frag.parent || frag.componentParent;\n    }\n\n    if (el.delegate === false) break out;\n    delegate = el.delegate || el;\n\n    // find next repeated fragment\n    while (frag) {\n      if (frag.iterations) break;\n      if (frag.owner.ractive && frag.owner.ractive.delegate === false) break out;\n      frag = frag.parent || frag.componentParent;\n    }\n  }\n\n  return delegate;\n}\n\nfunction nextRendered(start, newIndices, frags) {\n  const len = newIndices.length;\n  for (let i = start; i < len; i++) {\n    if (~newIndices[i] && frags[i] && frags[i].rendered) return i;\n  }\n}\n\nfunction swizzleFragment(section, fragment, key, idx) {\n  const model = section.context ? contextFor(section, fragment, key) : undefined;\n\n  fragment.key = key;\n  fragment.index = idx;\n  fragment.context = model;\n  if (section.source) fragment.lastValue = model && model.get();\n\n  if (fragment.idxModel) fragment.idxModel.applyValue(idx);\n  if (fragment.keyModel) fragment.keyModel.applyValue(key);\n  if (fragment.pathModel) {\n    fragment.pathModel.context = model;\n    fragment.pathModel.applyValue(model.getKeypath());\n  }\n  if (fragment.rootModel) {\n    fragment.rootModel.context = model;\n    fragment.rootModel.applyValue(model.getKeypath(fragment.ractive.root));\n  }\n\n  // handle any aliases\n  const aliases = fragment.aliases;\n  section.aliases &&\n    section.aliases.forEach(a => {\n      if (a.x.r === '.') aliases[a.n] = model;\n      else if (a.x.r === '@index') aliases[a.n] = fragment.getIndex();\n      else if (a.x.r === '@key') aliases[a.n] = fragment.getKey();\n      else if (a.x.r === '@keypath') aliases[a.n] = fragment.getKeypath();\n      else if (a.x.r === '@rootpath') aliases[a.n] = fragment.getKeypath(true);\n    });\n}\n\nfunction shuffleValues(section, shuffler) {\n  if (shuffler === true) {\n    return section.context.get().slice();\n  } else {\n    return section.context.get().map(v => shuffler.reduce((a, c) => a && a[c], v));\n  }\n}\n\nfunction contextFor(section, fragment, key) {\n  if (section.source) {\n    let idx;\n    const source = section.source.model.get();\n    if (source.indexOf && ~(idx = source.indexOf(section.context.joinKey(key).get())))\n      return section.source.model.joinKey(idx);\n  }\n\n  return section.context.joinKey(key);\n}\n","import {\n  SECTION_EACH,\n  SECTION_IF,\n  SECTION_IF_WITH,\n  SECTION_UNLESS,\n  SECTION_WITH\n} from 'config/types';\nimport { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject, isObjectLike } from 'utils/is';\nimport { keep } from 'shared/set';\nimport runloop from 'src/global/runloop';\nimport Fragment from '../Fragment';\nimport RepeatedFragment from '../RepeatedFragment';\nimport { MustacheContainer } from './shared/Mustache';\nimport { keys } from 'utils/object';\nimport Context from 'src/shared/Context';\n\nfunction isEmpty(value) {\n  return (\n    !value ||\n    (isArray(value) && value.length === 0) ||\n    (isObject(value) && keys(value).length === 0)\n  );\n}\n\nfunction getType(value, hasIndexRef) {\n  if (hasIndexRef || isArray(value)) return SECTION_EACH;\n  if (isObjectLike(value)) return SECTION_IF_WITH;\n  if (value === undefined) return null;\n  return SECTION_IF;\n}\n\nexport default class Section extends MustacheContainer {\n  constructor(options) {\n    super(options);\n\n    this.sectionType = options.template.n || null;\n    this.templateSectionType = this.sectionType;\n    this.subordinate = options.template.l === 1;\n    this.fragment = null;\n  }\n\n  bind() {\n    super.bind();\n\n    if (this.subordinate) {\n      this.sibling = this.up.items[this.up.items.indexOf(this) - 1];\n      this.sibling.nextSibling = this;\n    }\n\n    // if we managed to bind, we need to create children\n    if (this.model) {\n      this.dirty = true;\n      this.update();\n    } else if (\n      this.sectionType &&\n      this.sectionType === SECTION_UNLESS &&\n      (!this.sibling || !this.sibling.isTruthy())\n    ) {\n      this.fragment = new Fragment({\n        owner: this,\n        template: this.template.f\n      }).bind();\n    }\n  }\n\n  bubble() {\n    if (!this.dirty && this.yield) {\n      this.dirty = true;\n      this.containerFragment.bubble();\n    } else super.bubble();\n  }\n\n  detach() {\n    const frag = this.fragment || this.detached;\n    return frag ? frag.detach() : super.detach();\n  }\n\n  isTruthy() {\n    if (this.subordinate && this.sibling.isTruthy()) return true;\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    return !!value && (this.templateSectionType === SECTION_IF_WITH || !isEmpty(value));\n  }\n\n  rebind(next, previous, safe) {\n    if (super.rebind(next, previous, safe)) {\n      if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n        this.fragment.rebind(next);\n      }\n    }\n  }\n\n  rebound(update) {\n    if (this.model) {\n      if (this.model.rebound) this.model.rebound(update);\n      else {\n        super.unbind();\n        super.bind();\n        if (\n          this.sectionType === SECTION_WITH ||\n          this.sectionType === SECTION_IF_WITH ||\n          this.sectionType === SECTION_EACH\n        ) {\n          if (this.fragment) this.fragment.rebind(this.model);\n        }\n\n        if (update) this.bubble();\n      }\n    }\n    if (this.fragment) this.fragment.rebound(update);\n  }\n\n  render(target, occupants) {\n    this.rendered = true;\n    if (this.fragment) this.fragment.render(target, occupants);\n  }\n\n  shuffle(newIndices) {\n    if (this.fragment && this.sectionType === SECTION_EACH) {\n      this.fragment.shuffle(newIndices);\n    }\n  }\n\n  unbind(view) {\n    super.unbind(view);\n    if (this.fragment) this.fragment.unbind(view);\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (!this.dirty) return;\n\n    if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n      this.fragment.context = this.model;\n    }\n\n    if (!this.model && this.sectionType !== SECTION_UNLESS) return;\n\n    this.dirty = false;\n\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    const siblingFalsey = !this.subordinate || !this.sibling.isTruthy();\n    const lastType = this.sectionType;\n\n    if (this.yield && this.yield !== value) {\n      this.up = this.containerFragment;\n      this.container = null;\n      this.yield = null;\n      if (this.rendered) this.fragment.unbind().unrender(true);\n      this.fragment = null;\n    } else if (this.rendered && !this.yield && value instanceof Context) {\n      if (this.rendered && this.fragment) this.fragment.unbind().unrender(true);\n      this.fragment = null;\n    }\n\n    // watch for switching section types\n    if (this.sectionType === null || this.templateSectionType === null)\n      this.sectionType = getType(value, this.template.i);\n    if (lastType && lastType !== this.sectionType && this.fragment) {\n      if (this.rendered) {\n        this.fragment.unbind().unrender(true);\n      }\n\n      this.fragment = null;\n    }\n\n    let newFragment;\n\n    const fragmentShouldExist =\n      this.sectionType === SECTION_EACH || // each always gets a fragment, which may have no iterations\n      this.sectionType === SECTION_WITH || // with (partial context) always gets a fragment\n      (siblingFalsey && (this.sectionType === SECTION_UNLESS ? !this.isTruthy() : this.isTruthy())); // if, unless, and if-with depend on siblings and the condition\n\n    if (fragmentShouldExist) {\n      if (!this.fragment) this.fragment = this.detached;\n\n      if (this.fragment) {\n        // check for detached fragment\n        if (this.detached) {\n          attach(this, this.fragment);\n          this.detached = false;\n          this.rendered = true;\n        }\n\n        if (!this.fragment.bound) this.fragment.bind(this.model);\n        this.fragment.update();\n      } else {\n        if (this.sectionType === SECTION_EACH) {\n          newFragment = new RepeatedFragment({\n            owner: this,\n            template: this.template.f,\n            indexRef: this.template.i\n          }).bind(this.model);\n        } else {\n          // only with and if-with provide context - if and unless do not\n          let context =\n            this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS\n              ? this.model\n              : null;\n\n          if (value instanceof Context) {\n            this.yield = value;\n            this.containerFragment = this.up;\n            this.up = value.fragment;\n            this.container = value.ractive;\n            context = undefined;\n          }\n\n          newFragment = new Fragment({\n            owner: this,\n            template: this.template.f\n          }).bind(context);\n        }\n      }\n    } else {\n      if (this.fragment && this.rendered) {\n        if (keep !== true) {\n          this.fragment.unbind().unrender(true);\n        } else {\n          this.unrender(false);\n          this.detached = this.fragment;\n          runloop.promise().then(() => {\n            if (this.detached) this.detach();\n          });\n        }\n      } else if (this.fragment) {\n        this.fragment.unbind();\n      }\n\n      this.fragment = null;\n    }\n\n    if (newFragment) {\n      if (this.rendered) {\n        attach(this, newFragment);\n      }\n\n      this.fragment = newFragment;\n    }\n\n    if (this.nextSibling) {\n      this.nextSibling.dirty = true;\n      this.nextSibling.update();\n    }\n  }\n}\n\nfunction attach(section, fragment) {\n  const anchor = (section.containerFragment || section.up).findNextNode(section);\n\n  if (anchor) {\n    const docFrag = createDocumentFragment();\n    fragment.render(docFrag);\n\n    anchor.parentNode.insertBefore(docFrag, anchor);\n  } else {\n    fragment.render(section.up.findParentNode());\n  }\n}\n","import { toArray } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Element from '../../Element';\nimport { isArray, isFunction } from 'utils/is';\n\nexport default class Select extends Element {\n  constructor(options) {\n    super(options);\n    this.options = [];\n  }\n\n  foundNode(node) {\n    if (this.binding) {\n      const selectedOptions = getSelectedOptions(node);\n\n      if (selectedOptions.length > 0) {\n        this.selectedOptions = selectedOptions;\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.sync();\n\n    const node = this.node;\n\n    let i = node.options.length;\n    while (i--) {\n      node.options[i].defaultSelected = node.options[i].selected;\n    }\n\n    this.rendered = true;\n  }\n\n  sync() {\n    const selectNode = this.node;\n\n    if (!selectNode) return;\n\n    const options = toArray(selectNode.options);\n\n    if (this.selectedOptions) {\n      options.forEach(o => {\n        if (this.selectedOptions.indexOf(o) >= 0) o.selected = true;\n        else o.selected = false;\n      });\n      this.binding.setFromNode(selectNode);\n      delete this.selectedOptions;\n      return;\n    }\n\n    const selectValue = this.getAttribute('value');\n    const isMultiple = this.getAttribute('multiple');\n    const array = isMultiple && isArray(selectValue);\n\n    // If the <select> has a specified value, that should override\n    // these options\n    if (selectValue !== undefined) {\n      let optionWasSelected;\n\n      options.forEach(o => {\n        const optionValue = o._ractive ? o._ractive.value : o.value;\n        const shouldSelect = isMultiple\n          ? array && this.valueContains(selectValue, optionValue)\n          : this.compare(selectValue, optionValue);\n\n        if (shouldSelect) {\n          optionWasSelected = true;\n        }\n\n        o.selected = shouldSelect;\n      });\n\n      if (!optionWasSelected && !isMultiple) {\n        if (this.binding) {\n          this.binding.forceUpdate();\n        }\n      }\n    } else if (this.binding && this.binding.forceUpdate) {\n      // Otherwise the value should be initialised according to which\n      // <option> element is selected, if twoway binding is in effect\n      this.binding.forceUpdate();\n    }\n  }\n  valueContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.compare(optionValue, selectValue[i])) return true;\n    }\n  }\n  compare(optionValue, selectValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(selectValue, optionValue);\n      }\n      if (selectValue && optionValue) {\n        return selectValue[comparator] == optionValue[comparator];\n      }\n    }\n    return selectValue == optionValue;\n  }\n  update() {\n    const dirty = this.dirty;\n    super.update();\n    if (dirty) {\n      this.sync();\n    }\n  }\n}\n","import { ATTRIBUTE } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport Input from './Input';\nimport { isBindable } from '../binding/selectBinding';\nimport createItem from '../../createItem';\nimport Fragment from '../../../Fragment';\n\nexport default class Textarea extends Input {\n  constructor(options) {\n    const template = options.template;\n\n    options.deferContent = true;\n\n    super(options);\n\n    // check for single interpolator binding\n    if (!this.attributeByName.value) {\n      if (template.f && isBindable({ template })) {\n        (this.attributes || (this.attributes = [])).push(\n          createItem({\n            owner: this,\n            template: { t: ATTRIBUTE, f: template.f, n: 'value' },\n            up: this.up\n          })\n        );\n      } else {\n        this.fragment = new Fragment({\n          owner: this,\n          cssIds: null,\n          template: template.f\n        });\n      }\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.rendered && !this.binding && this.fragment) {\n        runloop.scheduleTask(() => {\n          this.dirty = false;\n          this.node.value = this.fragment.toString();\n        });\n      }\n\n      this.up.bubble(); // default behaviour\n    }\n  }\n}\n","import { TEXT } from 'config/types';\nimport { escapeHtml } from 'utils/html';\nimport { detachNode } from 'utils/dom';\nimport noop from 'utils/noop';\nimport Item from './shared/Item';\nimport progressiveText from './shared/progressiveText';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Text extends Item {\n  constructor(options) {\n    super(options);\n    this.type = TEXT;\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, this.template);\n  }\n\n  toString(escape) {\n    return escape ? escapeHtml(this.template) : this.template;\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  valueOf() {\n    return this.template;\n  }\n}\n\nconst proto = Text.prototype;\nproto.bind = proto.unbind = proto.update = noop;\n","import { win, doc, vendors } from './environment';\n\nexport let visible;\nlet hidden = 'hidden';\n\nif (doc) {\n  let prefix;\n\n  /* istanbul ignore next */\n  if (hidden in doc) {\n    prefix = '';\n  } else {\n    let i = vendors.length;\n    while (i--) {\n      const vendor = vendors[i];\n      hidden = vendor + 'Hidden';\n\n      if (hidden in doc) {\n        prefix = vendor;\n        break;\n      }\n    }\n  }\n\n  /* istanbul ignore else */\n  if (prefix !== undefined) {\n    doc.addEventListener(prefix + 'visibilitychange', onChange);\n    onChange();\n  } else {\n    // gah, we're in an old browser\n    if ('onfocusout' in doc) {\n      doc.addEventListener('focusout', onHide);\n      doc.addEventListener('focusin', onShow);\n    } else {\n      win.addEventListener('pagehide', onHide);\n      win.addEventListener('blur', onHide);\n\n      win.addEventListener('pageshow', onShow);\n      win.addEventListener('focus', onShow);\n    }\n\n    visible = true; // until proven otherwise. Not ideal but hey\n  }\n}\n\nfunction onChange() {\n  visible = !doc[hidden];\n}\n\n/* istanbul ignore next */\nfunction onHide() {\n  visible = false;\n}\n\n/* istanbul ignore next */\nfunction onShow() {\n  visible = true;\n}\n","import { isClient, vendors } from 'config/environment';\nimport { createElement } from 'utils/dom';\nimport hyphenateCamel from 'utils/hyphenateCamel';\n\nlet prefix;\n\n/* istanbul ignore next */\nif (!isClient) {\n  prefix = null;\n} else {\n  const prefixCache = {};\n  const testStyle = createElement('div').style;\n\n  // technically this also normalizes on hyphenated styles as well\n  prefix = function(prop) {\n    if (!prefixCache[prop]) {\n      const name = hyphenateCamel(prop);\n\n      if (testStyle[prop] !== undefined) {\n        prefixCache[prop] = name;\n      } else {\n        /* istanbul ignore next */\n        // test vendors...\n        let i = vendors.length;\n        while (i--) {\n          const vendor = `-${vendors[i]}-${name}`;\n          if (testStyle[vendor] !== undefined) {\n            prefixCache[prop] = vendor;\n            break;\n          }\n        }\n      }\n    }\n\n    return prefixCache[prop];\n  };\n}\n\nexport default prefix;\n","import { missingPlugin } from 'config/errors';\nimport { isClient } from 'config/environment';\nimport { warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { createElement } from 'utils/dom';\nimport interpolate from 'shared/interpolate';\nimport Ticker from 'shared/Ticker';\nimport hyphenate from './hyphenate';\nimport { isFunction, isString } from 'utils/is';\n\nlet createTransitions;\n\nif (!isClient) {\n  createTransitions = null;\n} else {\n  const testStyle = createElement('div').style;\n  const linear = x => x;\n\n  const canUseCssTransitions = {};\n  const cannotUseCssTransitions = {};\n\n  // determine some facts about our environment\n  let TRANSITION;\n  let TRANSITIONEND;\n  let CSS_TRANSITIONS_ENABLED;\n  let TRANSITION_DURATION;\n  let TRANSITION_PROPERTY;\n  let TRANSITION_TIMING_FUNCTION;\n\n  if (testStyle.transition !== undefined) {\n    TRANSITION = 'transition';\n    TRANSITIONEND = 'transitionend';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else if (testStyle.webkitTransition !== undefined) {\n    TRANSITION = 'webkitTransition';\n    TRANSITIONEND = 'webkitTransitionEnd';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else {\n    CSS_TRANSITIONS_ENABLED = false;\n  }\n\n  if (TRANSITION) {\n    TRANSITION_DURATION = TRANSITION + 'Duration';\n    TRANSITION_PROPERTY = TRANSITION + 'Property';\n    TRANSITION_TIMING_FUNCTION = TRANSITION + 'TimingFunction';\n  }\n\n  createTransitions = function(t, to, options, changedProperties, resolve) {\n    // Wait a beat (otherwise the target styles will be applied immediately)\n    // TODO use a fastdom-style mechanism?\n    setTimeout(() => {\n      let jsTransitionsComplete;\n      let cssTransitionsComplete;\n      let cssTimeout; // eslint-disable-line prefer-const\n\n      function transitionDone() {\n        clearTimeout(cssTimeout);\n      }\n\n      function checkComplete() {\n        if (jsTransitionsComplete && cssTransitionsComplete) {\n          t.unregisterCompleteHandler(transitionDone);\n          // will changes to events and fire have an unexpected consequence here?\n          t.ractive.fire(t.name + ':end', t.node, t.isIntro);\n          resolve();\n        }\n      }\n\n      // this is used to keep track of which elements can use CSS to animate\n      // which properties\n      const hashPrefix = (t.node.namespaceURI || '') + t.node.tagName;\n\n      // need to reset transition properties\n      const style = t.node.style;\n      const previous = {\n        property: style[TRANSITION_PROPERTY],\n        timing: style[TRANSITION_TIMING_FUNCTION],\n        duration: style[TRANSITION_DURATION]\n      };\n\n      function transitionEndHandler(event) {\n        if (event.target !== t.node) return;\n        const index = changedProperties.indexOf(event.propertyName);\n\n        if (index !== -1) {\n          changedProperties.splice(index, 1);\n        }\n\n        if (changedProperties.length) {\n          // still transitioning...\n          return;\n        }\n\n        clearTimeout(cssTimeout);\n        cssTransitionsDone();\n      }\n\n      function cssTransitionsDone() {\n        style[TRANSITION_PROPERTY] = previous.property;\n        style[TRANSITION_TIMING_FUNCTION] = previous.duration;\n        style[TRANSITION_DURATION] = previous.timing;\n\n        t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n        cssTransitionsComplete = true;\n        checkComplete();\n      }\n\n      t.node.addEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n      // safety net in case transitionend never fires\n      cssTimeout = setTimeout(() => {\n        changedProperties = [];\n        cssTransitionsDone();\n      }, options.duration + (options.delay || 0) + 50);\n      t.registerCompleteHandler(transitionDone);\n\n      style[TRANSITION_PROPERTY] = changedProperties.join(',');\n      const easingName = hyphenate(options.easing || 'linear');\n      style[TRANSITION_TIMING_FUNCTION] = easingName;\n      const cssTiming = style[TRANSITION_TIMING_FUNCTION] === easingName;\n      style[TRANSITION_DURATION] = options.duration / 1000 + 's';\n\n      setTimeout(() => {\n        let i = changedProperties.length;\n        let hash;\n        let originalValue = null;\n        let index;\n        const propertiesToTransitionInJs = [];\n        let prop;\n        let suffix;\n        let interpolator;\n\n        while (i--) {\n          prop = changedProperties[i];\n          hash = hashPrefix + prop;\n\n          if (cssTiming && CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[hash]) {\n            const initial = style[prop];\n            style[prop] = to[prop];\n\n            // If we're not sure if CSS transitions are supported for\n            // this tag/property combo, find out now\n            if (!(hash in canUseCssTransitions)) {\n              originalValue = t.getStyle(prop);\n\n              // if this property is transitionable in this browser,\n              // the current style will be different from the target style\n              canUseCssTransitions[hash] = t.getStyle(prop) != to[prop];\n              cannotUseCssTransitions[hash] = !canUseCssTransitions[hash];\n\n              // Reset, if we're going to use timers after all\n              if (cannotUseCssTransitions[hash]) {\n                style[prop] = initial;\n              }\n            }\n          }\n\n          if (!cssTiming || !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[hash]) {\n            // we need to fall back to timer-based stuff\n            if (originalValue === null) originalValue = t.getStyle(prop);\n\n            // need to remove this from changedProperties, otherwise transitionEndHandler\n            // will get confused\n            index = changedProperties.indexOf(prop);\n            if (index === -1) {\n              warnIfDebug(\n                'Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!',\n                { node: t.node }\n              );\n            } else {\n              changedProperties.splice(index, 1);\n            }\n\n            // TODO Determine whether this property is animatable at all\n\n            suffix = /[^\\d]*$/.exec(originalValue)[0];\n            interpolator = interpolate(parseFloat(originalValue), parseFloat(to[prop]));\n\n            // ...then kick off a timer-based transition\n            if (interpolator) {\n              propertiesToTransitionInJs.push({\n                name: prop,\n                interpolator,\n                suffix\n              });\n            } else {\n              style[prop] = to[prop];\n            }\n\n            originalValue = null;\n          }\n        }\n\n        // javascript transitions\n        if (propertiesToTransitionInJs.length) {\n          let easing;\n\n          if (isString(options.easing)) {\n            easing = t.ractive.easing[options.easing];\n\n            if (!easing) {\n              warnOnceIfDebug(missingPlugin(options.easing, 'easing'));\n              easing = linear;\n            }\n          } else if (isFunction(options.easing)) {\n            easing = options.easing;\n          } else {\n            easing = linear;\n          }\n\n          new Ticker({\n            duration: options.duration,\n            easing,\n            step(pos) {\n              let i = propertiesToTransitionInJs.length;\n              while (i--) {\n                const prop = propertiesToTransitionInJs[i];\n                style[prop.name] = prop.interpolator(pos) + prop.suffix;\n              }\n            },\n            complete() {\n              jsTransitionsComplete = true;\n              checkComplete();\n            }\n          });\n        } else {\n          jsTransitionsComplete = true;\n        }\n\n        if (changedProperties.length) {\n          style[TRANSITION_PROPERTY] = changedProperties.join(',');\n        } else {\n          style[TRANSITION_PROPERTY] = 'none';\n\n          // We need to cancel the transitionEndHandler, and deal with\n          // the fact that it will never fire\n          t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n          cssTransitionsComplete = true;\n          checkComplete();\n        }\n      }, 0);\n    }, options.delay || 0);\n  };\n}\n\nexport default createTransitions;\n","import { vendors } from 'config/environment';\n\nconst vendorPattern = new RegExp('^(?:' + vendors.join('|') + ')([A-Z])');\n\nexport default function(str) {\n  /* istanbul ignore next */\n  if (!str) return ''; // edge case\n\n  /* istanbul ignore next */\n  if (vendorPattern.test(str)) str = '-' + str;\n\n  return str.replace(/[A-Z]/g, match => '-' + match.toLowerCase());\n}\n","import { win } from 'config/environment';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isFunction, isNumber, isString } from 'utils/is';\nimport noop from 'utils/noop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { findInViewHierarchy } from 'shared/registry';\nimport { visible } from 'config/visibility';\nimport findElement from '../shared/findElement';\nimport prefix from './transitions/prefix';\nimport createTransitions from './transitions/createTransitions';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport { assign, hasOwn, keys } from 'utils/object';\n\nconst getComputedStyle = win && win.getComputedStyle;\nconst resolved = Promise.resolve();\n\nconst names = {\n  t0: 'intro-outro',\n  t1: 'intro',\n  t2: 'outro'\n};\n\nexport default class Transition {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.ractive = this.owner.ractive;\n    this.template = options.template;\n    this.up = options.up;\n    this.options = options;\n    this.onComplete = [];\n  }\n\n  animateStyle(style, value, options) {\n    if (arguments.length === 4) {\n      throw new Error(\n        't.animateStyle() returns a promise - use .then() instead of passing a callback'\n      );\n    }\n\n    // Special case - page isn't visible. Don't animate anything, because\n    // that way you'll never get CSS transitionend events\n    if (!visible) {\n      this.setStyle(style, value);\n      return resolved;\n    }\n\n    let to;\n\n    if (isString(style)) {\n      to = {};\n      to[style] = value;\n    } else {\n      to = style;\n\n      // shuffle arguments\n      options = value;\n    }\n\n    return new Promise(fulfil => {\n      // Edge case - if duration is zero, set style synchronously and complete\n      if (!options.duration) {\n        this.setStyle(to);\n        fulfil();\n        return;\n      }\n\n      // Get a list of the properties we're animating\n      const propertyNames = keys(to);\n      const changedProperties = [];\n\n      // Store the current styles\n      const computedStyle = getComputedStyle(this.node);\n\n      let i = propertyNames.length;\n      while (i--) {\n        const prop = propertyNames[i];\n        const name = prefix(prop);\n\n        const current = computedStyle[prefix(prop)];\n\n        // record the starting points\n        const init = this.node.style[name];\n        if (!(name in this.originals)) this.originals[name] = this.node.style[name];\n        this.node.style[name] = to[prop];\n        this.targets[name] = this.node.style[name];\n        this.node.style[name] = init;\n\n        // we need to know if we're actually changing anything\n        if (current != to[prop]) {\n          // use != instead of !==, so we can compare strings with numbers\n          changedProperties.push(name);\n\n          // if we happened to prefix, make sure there is a properly prefixed value\n          to[name] = to[prop];\n\n          // make the computed style explicit, so we can animate where\n          // e.g. height='auto'\n          this.node.style[name] = current;\n        }\n      }\n\n      // If we're not actually changing anything, the transitionend event\n      // will never fire! So we complete early\n      if (!changedProperties.length) {\n        fulfil();\n        return;\n      }\n\n      createTransitions(this, to, options, changedProperties, fulfil);\n    });\n  }\n\n  bind() {\n    const options = this.options;\n    const type = options.template && options.template.v;\n    if (type) {\n      if (type === 't0' || type === 't1') this.element.intro = this;\n      if (type === 't0' || type === 't2') this.element.outro = this;\n      this.eventName = names[type];\n    }\n\n    const ractive = this.owner.ractive;\n\n    this.name = options.name || options.template.n;\n\n    if (options.params) {\n      this.params = options.params;\n    }\n\n    if (isFunction(this.name)) {\n      this._fn = this.name;\n      this.name = this._fn.name;\n    } else {\n      this._fn = findInViewHierarchy('transitions', ractive, this.name);\n    }\n\n    if (!this._fn) {\n      warnOnceIfDebug(missingPlugin(this.name, 'transition'), { ractive });\n    }\n\n    setupArgsFn(this, options.template);\n  }\n\n  getParams() {\n    if (this.params) return this.params;\n\n    // get expression args if supplied\n    if (this.fn) {\n      const values = resolveArgs(this, this.template, this.up).map(model => {\n        if (!model) return undefined;\n\n        return model.get();\n      });\n      return this.fn.apply(this.ractive, values);\n    }\n  }\n\n  getStyle(props) {\n    const computedStyle = getComputedStyle(this.node);\n\n    if (isString(props)) {\n      return computedStyle[prefix(props)];\n    }\n\n    if (!isArray(props)) {\n      throw new Error(\n        'Transition$getStyle must be passed a string, or an array of strings representing CSS properties'\n      );\n    }\n\n    const styles = {};\n\n    let i = props.length;\n    while (i--) {\n      const prop = props[i];\n      let value = computedStyle[prefix(prop)];\n\n      if (value === '0px') value = 0;\n      styles[prop] = value;\n    }\n\n    return styles;\n  }\n\n  processParams(params, defaults) {\n    if (isNumber(params)) {\n      params = { duration: params };\n    } else if (isString(params)) {\n      if (params === 'slow') {\n        params = { duration: 600 };\n      } else if (params === 'fast') {\n        params = { duration: 200 };\n      } else {\n        params = { duration: 400 };\n      }\n    } else if (!params) {\n      params = {};\n    }\n\n    return assign({}, defaults, params);\n  }\n\n  registerCompleteHandler(fn) {\n    addToArray(this.onComplete, fn);\n  }\n\n  setStyle(style, value) {\n    if (isString(style)) {\n      const name = prefix(style);\n      if (!hasOwn(this.originals, name)) this.originals[name] = this.node.style[name];\n      this.node.style[name] = value;\n      this.targets[name] = this.node.style[name];\n    } else {\n      let prop;\n      for (prop in style) {\n        if (hasOwn(style, prop)) {\n          this.setStyle(prop, style[prop]);\n        }\n      }\n    }\n\n    return this;\n  }\n\n  shouldFire(type) {\n    if (!this.ractive.transitionsEnabled) return false;\n\n    // check for noIntro and noOutro cases, which only apply when the owner ractive is rendering and unrendering, respectively\n    if (type === 'intro' && this.ractive.rendering && nearestProp('noIntro', this.ractive, true))\n      return false;\n    if (type === 'outro' && this.ractive.unrendering && nearestProp('noOutro', this.ractive, false))\n      return false;\n\n    const params = this.getParams(); // this is an array, the params object should be the first member\n    // if there's not a parent element, this can't be nested, so roll on\n    if (!this.element.parent) return true;\n\n    // if there is a local param, it takes precedent\n    if (params && params[0] && isObject(params[0]) && 'nested' in params[0]) {\n      if (params[0].nested !== false) return true;\n    } else {\n      // use the nearest instance setting\n      // find the nearest instance that actually has a nested setting\n      if (nearestProp('nestedTransitions', this.ractive) !== false) return true;\n    }\n\n    // check to see if this is actually a nested transition\n    let el = this.element.parent;\n    while (el) {\n      if (el[type] && el[type].starting) return false;\n      el = el.parent;\n    }\n\n    return true;\n  }\n\n  start() {\n    const node = (this.node = this.element.node);\n    const originals = (this.originals = {}); //= node.getAttribute( 'style' );\n    const targets = (this.targets = {});\n\n    let completed;\n    const args = this.getParams();\n\n    // create t.complete() - we don't want this on the prototype,\n    // because we don't want `this` silliness when passing it as\n    // an argument\n    this.complete = noReset => {\n      this.starting = false;\n      if (completed) {\n        return;\n      }\n\n      this.onComplete.forEach(fn => fn());\n      if (!noReset && this.isIntro) {\n        for (const k in targets) {\n          if (node.style[k] === targets[k]) node.style[k] = originals[k];\n        }\n      }\n\n      this._manager.remove(this);\n\n      completed = true;\n    };\n\n    // If the transition function doesn't exist, abort\n    if (!this._fn) {\n      this.complete();\n      return;\n    }\n\n    const promise = this._fn.apply(this.ractive, [this].concat(args));\n    if (promise) promise.then(this.complete);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    if (!this.element.attributes.unbinding) {\n      const type = this.options && this.options.template && this.options.template.v;\n      if (type === 't0' || type === 't1') this.element.intro = null;\n      if (type === 't0' || type === 't2') this.element.outro = null;\n    }\n  }\n\n  unregisterCompleteHandler(fn) {\n    removeFromArray(this.onComplete, fn);\n  }\n}\n\nconst proto = Transition.prototype;\nproto.destroyed = proto.firstNode = proto.rebound = proto.render = proto.unrender = proto.update = noop;\n\nfunction nearestProp(prop, ractive, rendering) {\n  let instance = ractive;\n  while (instance) {\n    if (\n      hasOwn(instance, prop) &&\n      (rendering === undefined || rendering ? instance.rendering : instance.unrendering)\n    )\n      return instance[prop];\n    instance = instance.component && instance.component.ractive;\n  }\n\n  return ractive[prop];\n}\n","import { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\n\nconst elementCache = {};\n\nlet ieBug;\nlet ieBlacklist;\n\ntry {\n  createElement('table').innerHTML = 'foo';\n} catch (/* istanbul ignore next */ err) {\n  ieBug = true;\n\n  ieBlacklist = {\n    TABLE: ['<table class=\"x\">', '</table>'],\n    THEAD: ['<table><thead class=\"x\">', '</thead></table>'],\n    TBODY: ['<table><tbody class=\"x\">', '</tbody></table>'],\n    TR: ['<table><tr class=\"x\">', '</tr></table>'],\n    SELECT: ['<select class=\"x\">', '</select>']\n  };\n}\n\nexport default function(html, node) {\n  const nodes = [];\n\n  // render 0 and false\n  if (html == null || html === '') return nodes;\n\n  let container;\n  let wrapper;\n  let selectedOption;\n\n  /* istanbul ignore if */\n  if (ieBug && (wrapper = ieBlacklist[node.tagName])) {\n    container = element('DIV');\n    container.innerHTML = wrapper[0] + html + wrapper[1];\n    container = container.querySelector('.x');\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  } else if (node.namespaceURI === svg) {\n    container = element('DIV');\n    container.innerHTML = '<svg class=\"x\">' + html + '</svg>';\n    container = container.querySelector('.x');\n  } else if (node.tagName === 'TEXTAREA') {\n    container = createElement('div');\n\n    if (typeof container.textContent !== 'undefined') {\n      container.textContent = html;\n    } else {\n      container.innerHTML = html;\n    }\n  } else {\n    container = element(node.tagName);\n    container.innerHTML = html;\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  }\n\n  let child;\n  while ((child = container.firstChild)) {\n    nodes.push(child);\n    container.removeChild(child);\n  }\n\n  // This is really annoying. Extracting <option> nodes from the\n  // temporary container <select> causes the remaining ones to\n  // become selected. So now we have to deselect them. IE8, you\n  // amaze me. You really do\n  // ...and now Chrome too\n  let i;\n  if (node.tagName === 'SELECT') {\n    i = nodes.length;\n    while (i--) {\n      if (nodes[i] !== selectedOption) {\n        nodes[i].selected = false;\n      }\n    }\n  }\n\n  return nodes;\n}\n\nfunction element(tagName) {\n  return elementCache[tagName] || (elementCache[tagName] = createElement(tagName));\n}\n","import { createDocumentFragment, matches } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport { decodeCharacterReferences } from 'utils/html';\nimport runloop from 'src/global/runloop';\nimport Mustache from './shared/Mustache';\nimport insertHtml from './triple/insertHtml';\nimport { inAttribute } from './element/Attribute';\n\nexport default class Triple extends Mustache {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    if (this.nodes) this.nodes.forEach(node => docFrag.appendChild(node));\n    return docFrag;\n  }\n\n  find(selector) {\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) return node;\n\n      const queryResult = node.querySelector(selector);\n      if (queryResult) return queryResult;\n    }\n\n    return null;\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) result.push(node);\n\n      const queryAllResult = node.querySelectorAll(selector);\n      if (queryAllResult) {\n        result.push.apply(result, queryAllResult);\n      }\n    }\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  firstNode() {\n    return this.rendered && this.nodes[0];\n  }\n\n  render(target, occupants, anchor) {\n    if (!this.nodes) {\n      const html = this.model ? this.model.get() : '';\n      this.nodes = insertHtml(html, target);\n    }\n\n    let nodes = this.nodes;\n\n    // progressive enhancement\n    if (occupants) {\n      let i = -1;\n      let next;\n\n      // start with the first node that should be rendered\n      while (occupants.length && (next = this.nodes[i + 1])) {\n        let n;\n        // look through the occupants until a matching node is found\n        while ((n = occupants.shift())) {\n          const t = n.nodeType;\n\n          if (\n            t === next.nodeType &&\n            ((t === 1 && n.outerHTML === next.outerHTML) ||\n              ((t === 3 || t === 8) && n.nodeValue === next.nodeValue))\n          ) {\n            this.nodes.splice(++i, 1, n); // replace the generated node with the existing one\n            break;\n          } else {\n            target.removeChild(n); // remove the non-matching existing node\n          }\n        }\n      }\n\n      if (i >= 0) {\n        // update the list of remaining nodes to attach, excluding any that were replaced by existing nodes\n        nodes = this.nodes.slice(i);\n      }\n\n      // update the anchor to be the next occupant\n      if (occupants.length) anchor = occupants[0];\n    }\n\n    // attach any remainging nodes to the parent\n    if (nodes.length) {\n      const frag = createDocumentFragment();\n      nodes.forEach(n => frag.appendChild(n));\n\n      if (anchor) {\n        target.insertBefore(frag, anchor);\n      } else {\n        target.appendChild(frag);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  toString() {\n    let value = this.model && this.model.get();\n    value = value != null ? '' + value : '';\n\n    return inAttribute() ? decodeCharacterReferences(value) : value;\n  }\n\n  unrender() {\n    if (this.nodes)\n      this.nodes.forEach(node => {\n        // defer detachment until all relevant outros are done\n        runloop.detachWhenReady({\n          node,\n          detach() {\n            detachNode(node);\n          }\n        });\n      });\n    this.rendered = false;\n    this.nodes = null;\n  }\n\n  update() {\n    if (this.rendered && this.dirty) {\n      this.dirty = false;\n\n      this.unrender();\n      this.render(this.up.findParentNode(), null, this.up.findNextNode(this));\n    } else {\n      // make sure to reset the dirty flag even if not rendered\n      this.dirty = false;\n    }\n  }\n}\n","import {\n  ALIAS,\n  ANCHOR,\n  AWAIT,\n  COMMENT,\n  COMPONENT,\n  DOCTYPE,\n  ELEMENT,\n  INTERPOLATOR,\n  PARTIAL,\n  SECTION,\n  TRIPLE,\n  YIELDER\n} from 'config/types';\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, EVENT, TRANSITION } from 'config/types';\nimport Alias from './Alias';\nimport Attribute from './element/Attribute';\nimport BindingFlag from './element/BindingFlag';\nimport Comment from './Comment';\nimport Component from './Component';\nimport Decorator from './element/Decorator';\nimport Doctype from './Doctype';\nimport Form from './element/specials/Form';\nimport Element from './Element';\nimport EventDirective from './shared/EventDirective';\nimport Interpolator from './Interpolator';\nimport Input from './element/specials/Input';\nimport Mapping from './component/Mapping';\nimport Option from './element/specials/Option';\nimport Partial from './Partial';\nimport Section from './Section';\nimport Select from './element/specials/Select';\nimport Textarea from './element/specials/Textarea';\nimport Text from './Text';\nimport Transition from './element/Transition';\nimport Triple from './Triple';\nimport getComponentConstructor from './component/getComponentConstructor';\nimport findElement from './shared/findElement';\nimport { findInstance } from 'shared/registry';\nimport asyncProxy from './asyncProxy';\nimport Await from './Await';\nimport { isString, isFunction } from 'utils/is';\n\nconst constructors = {};\nconstructors[ALIAS] = Alias;\nconstructors[ANCHOR] = Component;\nconstructors[AWAIT] = Await;\nconstructors[DOCTYPE] = Doctype;\nconstructors[INTERPOLATOR] = Interpolator;\nconstructors[PARTIAL] = Partial;\nconstructors[SECTION] = Section;\nconstructors[TRIPLE] = Triple;\nconstructors[YIELDER] = Partial;\n\nconstructors[ATTRIBUTE] = Attribute;\nconstructors[BINDING_FLAG] = BindingFlag;\nconstructors[DECORATOR] = Decorator;\nconstructors[EVENT] = EventDirective;\nconstructors[TRANSITION] = Transition;\nconstructors[COMMENT] = Comment;\n\nconst specialElements = {\n  doctype: Doctype,\n  form: Form,\n  input: Input,\n  option: Option,\n  select: Select,\n  textarea: Textarea\n};\n\nexport default function createItem(options) {\n  if (isString(options.template)) {\n    return new Text(options);\n  }\n\n  let ctor;\n  let name;\n  const type = options.template.t;\n\n  if (type === ELEMENT) {\n    name = options.template.e;\n\n    // could be a macro partial\n    ctor = findInstance('partials', options.up.ractive, name);\n    if (ctor) {\n      ctor = ctor.partials[name];\n      if (ctor.styleSet) {\n        options.macro = ctor;\n        return new Partial(options);\n      }\n    }\n\n    // could be component or element\n    ctor = getComponentConstructor(options.up.ractive, name);\n    if (ctor) {\n      if (isFunction(ctor.then)) {\n        return asyncProxy(ctor, options);\n      } else if (isFunction(ctor)) {\n        return new Component(options, ctor);\n      }\n    }\n\n    ctor = specialElements[name.toLowerCase()] || Element;\n    return new ctor(options);\n  }\n\n  let Item;\n\n  // component mappings are a special case of attribute\n  if (type === ATTRIBUTE) {\n    let el = options.owner;\n    if (!el || (el.type !== ANCHOR && el.type !== COMPONENT && el.type !== ELEMENT)) {\n      el = findElement(options.up);\n    }\n    options.element = el;\n\n    Item = el.type === COMPONENT || el.type === ANCHOR ? Mapping : Attribute;\n  } else {\n    Item = constructors[type];\n  }\n\n  if (!Item) throw new Error(`Unrecognised item type ${type}`);\n\n  return new Item(options);\n}\n","import runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\nimport { bind, render as callRender, unbind, unrender, update } from 'shared/methodCallers';\nimport { teardown } from 'src/Ractive/prototype/teardown';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { warnIfDebug } from 'utils/log';\nimport { createDocumentFragment } from 'utils/dom';\nimport {\n  ANCHOR,\n  ATTRIBUTE,\n  BINDING_FLAG,\n  COMPONENT,\n  DECORATOR,\n  EVENT,\n  TRANSITION,\n  YIELDER\n} from 'config/types';\nimport construct from 'src/Ractive/construct';\nimport initialise from 'src/Ractive/initialise';\nimport render from 'src/Ractive/render';\nimport Item from './shared/Item';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { assign, create } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\n\nexport default class Component extends Item {\n  constructor(options, ComponentConstructor) {\n    super(options);\n    let template = options.template;\n    this.isAnchor = template.t === ANCHOR;\n    this.type = this.isAnchor ? ANCHOR : COMPONENT; // override ELEMENT from super\n    let attrs = template.m;\n\n    const partials = template.p || {};\n    if (!('content' in partials)) partials.content = template.f || [];\n    this._partials = partials; // TEMP\n\n    if (this.isAnchor) {\n      this.name = template.n;\n\n      this.addChild = addChild;\n      this.removeChild = removeChild;\n    } else {\n      const instance = create(ComponentConstructor.prototype);\n\n      this.instance = instance;\n      this.name = template.e;\n\n      if (instance.el || instance.target) {\n        warnIfDebug(\n          `The <${this.name}> component has a default '${\n            instance.el ? 'el' : 'target'\n          }' property; it has been disregarded`\n        );\n        instance.el = instance.target = null;\n      }\n\n      // find container\n      let fragment = options.up;\n      let container;\n      while (fragment) {\n        if (fragment.owner.type === YIELDER) {\n          container = fragment.owner.container;\n          break;\n        }\n\n        fragment = fragment.parent;\n      }\n\n      // add component-instance-specific properties\n      instance.parent = this.up.ractive;\n      instance.container = container || null;\n      instance.root = instance.parent.root;\n      instance.component = this;\n\n      construct(this.instance, { partials });\n\n      // these can be modified during construction\n      template = this.template;\n      attrs = template.m;\n\n      // allow components that are so inclined to add programmatic mappings\n      if (isArray(this.mappings)) {\n        attrs = (attrs || []).concat(this.mappings);\n      } else if (isString(this.mappings)) {\n        attrs = (attrs || []).concat(parser.parse(this.mappings, { attributes: true }).t);\n      }\n\n      // for hackability, this could be an open option\n      // for any ractive instance, but for now, just\n      // for components and just for ractive...\n      instance._inlinePartials = partials;\n    }\n\n    this.attributeByName = {};\n    this.attributes = [];\n\n    if (attrs) {\n      const leftovers = [];\n      attrs.forEach(template => {\n        switch (template.t) {\n          case ATTRIBUTE:\n          case EVENT:\n            this.attributes.push(\n              createItem({\n                owner: this,\n                up: this.up,\n                template\n              })\n            );\n            break;\n\n          case TRANSITION:\n          case BINDING_FLAG:\n          case DECORATOR:\n            break;\n\n          default:\n            leftovers.push(template);\n            break;\n        }\n      });\n\n      if (leftovers.length) {\n        this.attributes.push(\n          new ConditionalAttribute({\n            owner: this,\n            up: this.up,\n            template: leftovers\n          })\n        );\n      }\n    }\n\n    this.eventHandlers = [];\n  }\n\n  bind() {\n    if (!this.isAnchor) {\n      this.attributes.forEach(bind);\n      this.eventHandlers.forEach(bind);\n\n      initialise(\n        this.instance,\n        {\n          partials: this._partials\n        },\n        {\n          cssIds: this.up.cssIds\n        }\n      );\n\n      if (this.instance.target || this.instance.el) this.extern = true;\n\n      this.bound = true;\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (!this.isAnchor && this.instance.fragment) this.instance.fragment.destroyed();\n  }\n\n  detach() {\n    if (this.isAnchor) {\n      if (this.instance) return this.instance.fragment.detach();\n      return createDocumentFragment();\n    }\n\n    return this.instance.fragment.detach();\n  }\n\n  find(selector, options) {\n    if (this.instance) return this.instance.fragment.find(selector, options);\n  }\n\n  findAll(selector, options) {\n    if (this.instance) this.instance.fragment.findAll(selector, options);\n  }\n\n  findComponent(name, options) {\n    if (!name || this.name === name) return this.instance;\n\n    if (this.instance.fragment) {\n      return this.instance.fragment.findComponent(name, options);\n    }\n  }\n\n  findAllComponents(name, options) {\n    const { result } = options;\n\n    if (this.instance && (!name || this.name === name)) {\n      result.push(this.instance);\n    }\n\n    if (this.instance) this.instance.findAllComponents(name, options);\n  }\n\n  firstNode(skipParent) {\n    if (this.instance) return this.instance.fragment.firstNode(skipParent);\n  }\n\n  getContext(...assigns) {\n    assigns.unshift(this.instance);\n    return getRactiveContext.apply(null, assigns);\n  }\n\n  rebound(update) {\n    this.attributes.forEach(x => x.rebound(update));\n  }\n\n  render(target, occupants) {\n    if (this.isAnchor) {\n      this.rendered = true;\n      this.target = target;\n\n      if (!checking.length) {\n        checking.push(this.ractive);\n        if (occupants) {\n          this.occupants = occupants;\n          checkAnchors();\n          this.occupants = null;\n        } else {\n          runloop.scheduleTask(checkAnchors, true);\n        }\n      }\n    } else {\n      this.attributes.forEach(callRender);\n      this.eventHandlers.forEach(callRender);\n\n      if (this.extern) {\n        this.instance.delegate = false;\n        this.instance.render();\n      } else {\n        render(this.instance, target, null, occupants);\n      }\n\n      this.rendered = true;\n    }\n  }\n\n  shuffled() {\n    super.shuffled();\n    this.instance &&\n      !this.instance.isolated &&\n      this.instance.fragment &&\n      this.instance.fragment.shuffled();\n  }\n\n  toString() {\n    if (this.instance) return this.instance.toHTML();\n  }\n\n  unbind(view) {\n    if (!this.isAnchor) {\n      this.bound = false;\n\n      this.attributes.forEach(unbind);\n\n      if (view) this.instance.fragment.unbind();\n      else teardown(this.instance, () => runloop.promise());\n    }\n  }\n\n  unrender(shouldDestroy) {\n    this.shouldDestroy = shouldDestroy;\n\n    if (this.isAnchor) {\n      if (this.item) unrenderItem(this, this.item);\n      this.target = null;\n      if (!checking.length) {\n        checking.push(this.ractive);\n        runloop.scheduleTask(checkAnchors, true);\n      }\n    } else {\n      this.instance.unrender();\n      this.instance.el = this.instance.target = null;\n      this.attributes.forEach(unrender);\n      this.eventHandlers.forEach(unrender);\n    }\n\n    this.rendered = false;\n  }\n\n  update() {\n    this.dirty = false;\n    if (this.instance) {\n      this.instance.fragment.update();\n      this.attributes.forEach(update);\n      this.eventHandlers.forEach(update);\n    }\n  }\n}\n\nfunction addChild(meta) {\n  if (this.item) this.removeChild(this.item);\n\n  const child = meta.instance;\n  meta.anchor = this;\n\n  meta.up = this.up;\n  meta.name = meta.nameOption || this.name;\n  this.name = meta.name;\n\n  if (!child.isolated) child.viewmodel.attached(this.up);\n\n  // render as necessary\n  if (this.rendered) {\n    renderItem(this, meta);\n  }\n}\n\nfunction removeChild(meta) {\n  // unrender as necessary\n  if (this.item === meta) {\n    unrenderItem(this, meta);\n    this.name = this.template.n;\n  }\n}\n\nfunction renderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = false;\n  meta.up = anchor.up;\n\n  anchor.item = meta;\n  anchor.instance = meta.instance;\n  const nextNode = anchor.up.findNextNode(anchor);\n\n  if (meta.instance.fragment.rendered) {\n    meta.instance.unrender();\n  }\n\n  meta.partials = meta.instance.partials;\n  meta.instance.partials = assign(create(meta.partials), meta.partials, anchor._partials);\n\n  meta.instance.fragment.unbind(true);\n  meta.instance.fragment.componentParent = anchor.up;\n  meta.instance.fragment.bind(meta.instance.viewmodel);\n\n  anchor.attributes.forEach(bind);\n  anchor.eventHandlers.forEach(bind);\n  anchor.attributes.forEach(callRender);\n  anchor.eventHandlers.forEach(callRender);\n\n  const target = anchor.up.findParentNode();\n  render(meta.instance, target, target.contains(nextNode) ? nextNode : null, anchor.occupants);\n\n  if (meta.lastBound !== anchor) {\n    meta.lastBound = anchor;\n  }\n}\n\nfunction unrenderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = true;\n  meta.instance.unrender();\n\n  anchor.eventHandlers.forEach(unrender);\n  anchor.attributes.forEach(unrender);\n  anchor.eventHandlers.forEach(unbind);\n  anchor.attributes.forEach(unbind);\n\n  meta.instance.el = meta.instance.anchor = null;\n  meta.instance.fragment.componentParent = null;\n  meta.up = null;\n  meta.anchor = null;\n  anchor.item = null;\n  anchor.instance = null;\n}\n\nlet checking = [];\nexport function checkAnchors() {\n  const list = checking;\n  checking = [];\n\n  list.forEach(updateAnchors);\n}\n","import { findInViewHierarchy } from 'shared/registry';\nimport { warnOnce } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport noop from 'utils/noop';\nimport runloop from 'src/global/runloop';\nimport { rebindMatch } from 'src/shared/rebind';\nimport findElement from '../shared/findElement';\nimport { setupArgsFn, teardownArgsFn } from '../shared/directiveArgs';\nimport Fragment from '../../Fragment';\n\nconst missingDecorator = {\n  update: noop,\n  teardown: noop\n};\n\nexport default class Decorator {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.up = options.up || this.owner.up;\n    this.ractive = this.owner.ractive;\n    const template = (this.template = options.template);\n\n    this.name = template.n;\n\n    this.node = null;\n    this.handle = null;\n\n    this.element.decorators.push(this);\n  }\n\n  bind() {\n    // if the owner is the elment, make sure the context includes the element\n    const frag = this.element === this.owner ? new Fragment({ owner: this.owner }) : this.up;\n    setupArgsFn(this, this.template, frag, { register: true });\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      // decorators may be owned directly by an element or by a fragment if conditional\n      this.owner.bubble();\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n    this.shouldDestroy = true;\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebind(next, previous, safe) {\n    const idx = this.models.indexOf(previous);\n    if (!~idx) return;\n\n    next = rebindMatch(this.template.f.r[idx], next, previous);\n    if (next === previous) return;\n\n    previous.unregister(this);\n    this.models.splice(idx, 1, next);\n    if (next) next.addShuffleRegister(this, 'mark');\n\n    if (!safe) this.bubble();\n  }\n\n  rebound(update) {\n    teardownArgsFn(this, this.template);\n    setupArgsFn(this, this.template, this.up, { register: true });\n    if (update) this.bubble();\n  }\n\n  render() {\n    this.shouldDestroy = false;\n    if (this.handle) this.unrender();\n    runloop.scheduleTask(() => {\n      // bail if the host element has managed to become unrendered\n      if (!this.element.rendered) return;\n\n      const fn = findInViewHierarchy('decorators', this.ractive, this.name);\n\n      if (!fn) {\n        warnOnce(missingPlugin(this.name, 'decorator'));\n        this.handle = missingDecorator;\n        return;\n      }\n\n      this.node = this.element.node;\n\n      let args;\n      if (this.fn) {\n        args = this.models.map(model => {\n          if (!model) return undefined;\n\n          return model.get();\n        });\n        args = this.fn.apply(this.ractive, args);\n      }\n\n      this.handle = fn.apply(this.ractive, [this.node].concat(args));\n\n      if (!this.handle || !this.handle.teardown) {\n        throw new Error(\n          `The '${this.name}' decorator must return an object with a teardown method`\n        );\n      }\n\n      // watch out for decorators that cause their host element to be unrendered\n      if (this.shouldDestroy) this.destroyed();\n    }, true);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    teardownArgsFn(this, this.template);\n  }\n\n  unrender(shouldDestroy) {\n    if ((!shouldDestroy || this.element.rendered) && this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n  }\n\n  update() {\n    const instance = this.handle;\n\n    if (!this.dirty) {\n      if (instance && instance.invalidate) {\n        runloop.scheduleTask(() => instance.invalidate(), true);\n      }\n      return;\n    }\n\n    this.dirty = false;\n\n    if (instance) {\n      if (!instance.update) {\n        this.unrender();\n        this.render();\n      } else {\n        const args = this.models.map(model => model && model.get());\n        instance.update.apply(this.ractive, this.fn.apply(this.ractive, args));\n      }\n    }\n  }\n}\n\nDecorator.prototype.firstNode = noop;\n","import noop from 'utils/noop';\nimport Item from './shared/Item';\n\nexport default class Doctype extends Item {\n  toString() {\n    return '<!DOCTYPE' + this.template.a + '>';\n  }\n}\n\nconst proto = Doctype.prototype;\nproto.bind = proto.render = proto.teardown = proto.unbind = proto.unrender = proto.update = noop;\n","import runloop from 'src/global/runloop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport noop from 'utils/noop';\nimport findElement from '../../shared/findElement';\n\nexport default class Binding {\n  constructor(element, name = 'value') {\n    this.element = element;\n    this.ractive = element.ractive;\n    this.attribute = element.attributeByName[name];\n\n    const interpolator = this.attribute.interpolator;\n    interpolator.twowayBinding = this;\n\n    const model = interpolator.model;\n\n    if (model.isReadonly && !model.setRoot) {\n      const keypath = model.getKeypath().replace(/^@/, '');\n      warnOnceIfDebug(\n        `Cannot use two-way binding on <${\n          element.name\n        }> element: ${keypath} is read-only. To suppress this warning use <${\n          element.name\n        } twoway='false'...>`,\n        { ractive: this.ractive }\n      );\n      return false;\n    }\n\n    this.attribute.isTwoway = true;\n    this.model = model;\n\n    // initialise value, if it's undefined\n    let value = model.get();\n    this.wasUndefined = value === undefined;\n\n    if (value === undefined && this.getInitialValue) {\n      value = this.getInitialValue();\n      model.set(value);\n    }\n    this.lastVal(true, value);\n\n    const parentForm = findElement(this.element, false, 'form');\n    if (parentForm) {\n      this.resetValue = value;\n      parentForm.formBindings.push(this);\n    }\n  }\n\n  bind() {\n    this.model.registerTwowayBinding(this);\n  }\n\n  handleChange() {\n    const value = this.getValue();\n    if (this.lastVal() === value) return;\n\n    runloop.start();\n    this.attribute.locked = true;\n    this.model.set(value);\n    this.lastVal(true, value);\n\n    // if the value changes before observers fire, unlock to be updatable cause something weird and potentially freezy is up\n    if (this.model.get() !== value) this.attribute.locked = false;\n    else runloop.scheduleTask(() => (this.attribute.locked = false));\n\n    runloop.end();\n  }\n\n  lastVal(setting, value) {\n    if (setting) this.lastValue = value;\n    else return this.lastValue;\n  }\n\n  rebind(next, previous) {\n    if (this.model && this.model === previous) previous.unregisterTwowayBinding(this);\n    if (next) {\n      this.model = next;\n      runloop.scheduleTask(() => next.registerTwowayBinding(this));\n    }\n  }\n\n  rebound() {\n    if (this.model) this.model.unregisterTwowayBinding(this);\n    this.model = this.attribute.interpolator.model;\n    this.model.registerTwowayBinding(this);\n  }\n\n  render() {\n    this.node = this.element.node;\n    this.node._ractive.binding = this;\n    this.rendered = true; // TODO is this used anywhere?\n  }\n\n  setFromNode(node) {\n    this.model.set(node.value);\n  }\n\n  unbind() {\n    this.model.unregisterTwowayBinding(this);\n  }\n}\n\nBinding.prototype.unrender = noop;\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class CheckboxBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.off('click', handleDomEvent);\n    }\n  }\n\n  getInitialValue() {\n    return !!this.element.getAttribute('checked');\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\n\nexport default function getBindingGroup(group, model, getValue) {\n  const hash = `${group}-bindingGroup`;\n  return model[hash] || (model[hash] = new BindingGroup(hash, model, getValue));\n}\n\nclass BindingGroup {\n  constructor(hash, model, getValue) {\n    this.model = model;\n    this.hash = hash;\n    this.getValue = () => {\n      this.value = getValue.call(this);\n      return this.value;\n    };\n\n    this.bindings = [];\n  }\n\n  add(binding) {\n    this.bindings.push(binding);\n  }\n\n  bind() {\n    this.value = this.model.get();\n    this.model.registerTwowayBinding(this);\n    this.bound = true;\n  }\n\n  remove(binding) {\n    removeFromArray(this.bindings, binding);\n    if (!this.bindings.length) {\n      this.unbind();\n    }\n  }\n\n  unbind() {\n    this.model.unregisterTwowayBinding(this);\n    this.bound = false;\n    delete this.model[this.hash];\n  }\n}\n\nBindingGroup.prototype.rebind = Binding.prototype.rebind;\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\nimport { isArray } from 'utils/is';\n\nconst push = [].push;\n\nfunction getValue() {\n  const all = this.bindings\n    .filter(b => b.node && b.node.checked)\n    .map(b => b.element.getAttribute('value'));\n  const res = [];\n  all.forEach(v => {\n    if (!this.bindings[0].arrayContains(res, v)) res.push(v);\n  });\n  return res;\n}\n\nexport default class CheckboxNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n    // Each input has a reference to an array containing it and its\n    // group, as two-way binding depends on being able to ascertain\n    // the status of all inputs within the group\n    this.group = getBindingGroup('checkboxes', this.model, getValue);\n    this.group.add(this);\n\n    if (this.noInitialValue) {\n      this.group.noInitialValue = true;\n    }\n\n    // If no initial value was set, and this input is checked, we\n    // update the model\n    if (this.group.noInitialValue && this.element.getAttribute('checked')) {\n      const existingValue = this.model.get();\n      const bindingValue = this.element.getAttribute('value');\n\n      if (!this.arrayContains(existingValue, bindingValue)) {\n        push.call(existingValue, bindingValue); // to avoid triggering runloop with array adaptor\n      }\n    }\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n  }\n\n  getInitialValue() {\n    // This only gets called once per group (of inputs that\n    // share a name), because it only gets called if there\n    // isn't an initial value. By the same token, we can make\n    // a note of that fact that there was no initial value,\n    // and populate it using any `checked` attributes that\n    // exist (which users should avoid, but which we should\n    // support anyway to avoid breaking expectations)\n    this.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\n    return [];\n  }\n\n  getValue() {\n    return this.group.value;\n  }\n\n  handleChange() {\n    this.isChecked = this.element.node.checked;\n    this.group.value = this.model.get().slice();\n    const value = this.element.getAttribute('value');\n    if (this.isChecked && !this.arrayContains(this.group.value, value)) {\n      this.group.value.push(value);\n    } else if (!this.isChecked && this.arrayContains(this.group.value, value)) {\n      this.removeFromArray(this.group.value, value);\n    }\n    // make sure super knows there's a change\n    this.lastValue = null;\n    super.handleChange();\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    const existingValue = this.model.get();\n    const bindingValue = this.element.getAttribute('value');\n\n    if (isArray(existingValue)) {\n      this.isChecked = this.arrayContains(existingValue, bindingValue);\n    } else {\n      this.isChecked = this.element.compare(existingValue, bindingValue);\n    }\n    node.name = '{{' + this.model.getKeypath() + '}}';\n    node.checked = this.isChecked;\n\n    this.element.on('change', handleDomEvent);\n\n    // in case of IE emergency, bind to click event as well\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.group.bindings.forEach(binding => (binding.wasUndefined = true));\n\n    if (node.checked) {\n      const valueSoFar = this.group.getValue();\n      valueSoFar.push(this.element.getAttribute('value'));\n\n      this.group.model.set(valueSoFar);\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      el.off('click', handleDomEvent);\n    }\n  }\n\n  arrayContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.element.compare(optionValue, selectValue[i])) return true;\n    }\n    return false;\n  }\n\n  removeFromArray(array, item) {\n    if (!array) return;\n    let i = array.length;\n    while (i--) {\n      if (this.element.compare(item, array[i])) {\n        array.splice(i, 1);\n      }\n    }\n  }\n}\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class ContentEditableBinding extends Binding {\n  getInitialValue() {\n    return this.element.fragment ? this.element.fragment.toString() : '';\n  }\n\n  getValue() {\n    return this.element.node.innerHTML;\n  }\n\n  render() {\n    super.render();\n\n    const el = this.element;\n\n    el.on('change', handleDomEvent);\n    el.on('blur', handleDomEvent);\n\n    if (!this.ractive.lazy) {\n      el.on('input', handleDomEvent);\n\n      if (this.node.attachEvent) {\n        el.on('keyup', handleDomEvent);\n      }\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.innerHTML);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('blur', handleDomEvent);\n    el.off('change', handleDomEvent);\n    el.off('input', handleDomEvent);\n    el.off('keyup', handleDomEvent);\n  }\n}\n","import { isNumeric } from 'utils/is';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nfunction handleBlur() {\n  handleDomEvent.call(this);\n\n  const value = this._ractive.binding.model.get();\n  this.value = value == undefined ? '' : value;\n}\n\nfunction handleDelay(delay) {\n  let timeout;\n\n  return function() {\n    if (timeout) clearTimeout(timeout);\n\n    timeout = setTimeout(() => {\n      const binding = this._ractive.binding;\n      if (binding.rendered) handleDomEvent.call(this);\n      timeout = null;\n    }, delay);\n  };\n}\n\nexport default class GenericBinding extends Binding {\n  getInitialValue() {\n    return '';\n  }\n\n  getValue() {\n    return this.node.value;\n  }\n\n  render() {\n    super.render();\n\n    // any lazy setting for this element overrides the root\n    // if the value is a number, it's a timeout\n    let lazy = this.ractive.lazy;\n    let timeout = false;\n    const el = this.element;\n\n    if ('lazy' in this.element) {\n      lazy = this.element.lazy;\n    }\n\n    if (isNumeric(lazy)) {\n      timeout = +lazy;\n      lazy = false;\n    }\n\n    this.handler = timeout ? handleDelay(timeout) : handleDomEvent;\n\n    const node = this.node;\n\n    el.on('change', handleDomEvent);\n\n    if (node.type !== 'file') {\n      if (!lazy) {\n        el.on('input', this.handler);\n\n        // IE is a special snowflake\n        if (node.attachEvent) {\n          el.on('keyup', this.handler);\n        }\n      }\n\n      el.on('blur', handleBlur);\n    }\n  }\n\n  unrender() {\n    const el = this.element;\n    this.rendered = false;\n\n    el.off('change', handleDomEvent);\n    el.off('input', this.handler);\n    el.off('keyup', this.handler);\n    el.off('blur', handleBlur);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class FileBinding extends GenericBinding {\n  getInitialValue() {\n    /* istanbul ignore next */\n    return undefined;\n  }\n\n  getValue() {\n    /* istanbul ignore next */\n    return this.node.files;\n  }\n\n  render() {\n    /* istanbul ignore next */\n    this.element.lazy = false;\n    /* istanbul ignore next */\n    super.render();\n  }\n\n  setFromNode(node) {\n    /* istanbul ignore next */\n    this.model.set(node.files);\n  }\n}\n","import { arrayContentsMatch } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class MultipleSelectBinding extends Binding {\n  getInitialValue() {\n    return this.element.options\n      .filter(option => option.getAttribute('selected'))\n      .map(option => option.getAttribute('value'));\n  }\n\n  getValue() {\n    const options = this.element.node.options;\n    const len = options.length;\n\n    const selectedValues = [];\n\n    for (let i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (option.selected) {\n        const optionValue = option._ractive ? option._ractive.value : option.value;\n        selectedValues.push(optionValue);\n      }\n    }\n\n    return selectedValues;\n  }\n\n  handleChange() {\n    const attribute = this.attribute;\n    const previousValue = attribute.getValue();\n\n    const value = this.getValue();\n\n    if (previousValue === undefined || !arrayContentsMatch(value, previousValue)) {\n      super.handleChange();\n    }\n\n    return this;\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.model.get() === undefined) {\n      // get value from DOM, if possible\n      this.handleChange();\n    }\n  }\n\n  setFromNode(node) {\n    const selectedOptions = getSelectedOptions(node);\n    let i = selectedOptions.length;\n    const result = new Array(i);\n\n    while (i--) {\n      const option = selectedOptions[i];\n      result[i] = option._ractive ? option._ractive.value : option.value;\n    }\n\n    this.model.set(result);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class NumericBinding extends GenericBinding {\n  getInitialValue() {\n    return undefined;\n  }\n\n  getValue() {\n    const value = parseFloat(this.node.value);\n    return isNaN(value) ? undefined : value;\n  }\n\n  setFromNode(node) {\n    const value = parseFloat(node.value);\n    if (!isNaN(value)) this.model.set(value);\n  }\n}\n","import runloop from 'src/global/runloop';\nimport { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nconst siblings = {};\n\nfunction getSiblings(hash) {\n  return siblings[hash] || (siblings[hash] = []);\n}\n\nexport default class RadioBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n\n    this.siblings = getSiblings(this.ractive._guid + this.element.getAttribute('name'));\n    this.siblings.push(this);\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  handleChange() {\n    runloop.start();\n\n    this.siblings.forEach(binding => {\n      binding.model.set(binding.getValue());\n    });\n\n    runloop.end();\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n\n  unbind() {\n    removeFromArray(this.siblings, this);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.off('click', handleDomEvent);\n    }\n  }\n}\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\n\nfunction getValue() {\n  const checked = this.bindings.filter(b => b.node.checked);\n  if (checked.length > 0) {\n    return checked[0].element.getAttribute('value');\n  }\n}\n\nexport default class RadioNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.group = getBindingGroup('radioname', this.model, getValue);\n    this.group.add(this);\n\n    if (element.checked) {\n      this.group.value = this.getValue();\n    }\n\n    this.attribute.interpolator.pathChanged = () => this.updateName();\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('checked')) {\n      return this.element.getAttribute('value');\n    }\n  }\n\n  getValue() {\n    return this.element.getAttribute('value');\n  }\n\n  handleChange() {\n    // If this <input> is the one that's checked, then the value of its\n    // `name` model gets set to its value\n    if (this.node.checked) {\n      this.group.value = this.getValue();\n      super.handleChange();\n    }\n\n    this.updateName();\n  }\n\n  lastVal(setting, value) {\n    if (!this.group) return;\n    if (setting) this.group.lastValue = value;\n    else return this.group.lastValue;\n  }\n\n  rebind(next, previous) {\n    super.rebind(next, previous);\n    this.updateName();\n  }\n\n  rebound(update) {\n    super.rebound(update);\n    this.updateName();\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    this.updateName();\n    node.checked = this.element.compare(this.model.get(), this.element.getAttribute('value'));\n\n    this.element.on('change', handleDomEvent);\n\n    if (node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    if (node.checked) {\n      this.group.model.set(this.element.getAttribute('value'));\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      el.off('click', handleDomEvent);\n    }\n  }\n\n  updateName() {\n    if (this.node) this.node.name = `{{${this.model.getKeypath()}}}`;\n  }\n}\n","import runloop from 'src/global/runloop';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class SingleSelectBinding extends Binding {\n  forceUpdate() {\n    const value = this.getValue();\n\n    if (value !== undefined) {\n      this.attribute.locked = true;\n      runloop.scheduleTask(() => (this.attribute.locked = false));\n      this.model.set(value);\n    }\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('value') !== undefined) {\n      return;\n    }\n\n    const options = this.element.options;\n    const len = options.length;\n\n    if (!len) return;\n\n    let value;\n    let optionWasSelected;\n    let i = len;\n\n    // take the final selected option...\n    while (i--) {\n      const option = options[i];\n\n      if (option.getAttribute('selected')) {\n        if (!option.getAttribute('disabled')) {\n          value = option.getAttribute('value');\n        }\n\n        optionWasSelected = true;\n        break;\n      }\n    }\n\n    // or the first non-disabled option, if none are selected\n    if (!optionWasSelected) {\n      while (++i < len) {\n        if (!options[i].getAttribute('disabled')) {\n          value = options[i].getAttribute('value');\n          break;\n        }\n      }\n    }\n\n    // This is an optimisation (aka hack) that allows us to forgo some\n    // other more expensive work\n    // TODO does it still work? seems at odds with new architecture\n    if (value !== undefined) {\n      this.element.attributeByName.value.value = value;\n    }\n\n    return value;\n  }\n\n  getValue() {\n    const options = this.node.options;\n    const len = options.length;\n\n    let i;\n    for (i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (options[i].selected && !options[i].disabled) {\n        return option._ractive ? option._ractive.value : option.value;\n      }\n    }\n  }\n\n  render() {\n    super.render();\n    this.element.on('change', handleDomEvent);\n  }\n\n  setFromNode(node) {\n    const option = getSelectedOptions(node)[0];\n    this.model.set(option._ractive ? option._ractive.value : option.value);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import { ATTRIBUTE, BINDING_FLAG, DECORATOR, DELEGATE_FLAG, EVENT, TRANSITION } from 'config/types';\nimport { win } from 'config/environment';\nimport { html, svg } from 'config/namespaces';\nimport { toArray, addToArray, removeFromArray } from 'utils/array';\nimport { escapeHtml, voidElements } from 'utils/html';\nimport { createElement, detachNode, matches, safeAttributeString } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport Context from 'shared/Context';\nimport { destroyed } from 'shared/methodCallers';\nimport { ContainerItem } from './shared/Item';\nimport Fragment from '../Fragment';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport findElement from './shared/findElement';\nimport selectBinding from './element/binding/selectBinding';\nimport { assign, create, defineProperty, keys } from 'utils/object';\nimport { isString } from 'utils/is';\n\nconst endsWithSemi = /;\\s*$/;\n\nexport default class Element extends ContainerItem {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.e.toLowerCase();\n\n    // find parent element\n    this.parent = findElement(this.up, false);\n\n    if (this.parent && this.parent.name === 'option') {\n      throw new Error(\n        `An <option> element cannot contain other elements (encountered <${this.name}>)`\n      );\n    }\n\n    this.decorators = [];\n\n    // create attributes\n    this.attributeByName = {};\n\n    let attrs;\n    let n, attr, val, cls, name, template, leftovers;\n\n    const m = this.template.m;\n    const len = (m && m.length) || 0;\n\n    for (let i = 0; i < len; i++) {\n      template = m[i];\n      if (template.g) {\n        (this.statics || (this.statics = {}))[template.n] = isString(template.f)\n          ? template.f\n          : template.n;\n      } else {\n        switch (template.t) {\n          case ATTRIBUTE:\n          case BINDING_FLAG:\n          case DECORATOR:\n          case EVENT:\n          case TRANSITION:\n            attr = createItem({\n              owner: this,\n              up: this.up,\n              template\n            });\n\n            n = template.n;\n\n            attrs = attrs || (attrs = this.attributes = []);\n\n            if (n === 'value') val = attr;\n            else if (n === 'name') name = attr;\n            else if (n === 'class') cls = attr;\n            else attrs.push(attr);\n\n            break;\n\n          case DELEGATE_FLAG:\n            this.delegate = false;\n            break;\n\n          default:\n            (leftovers || (leftovers = [])).push(template);\n            break;\n        }\n      }\n    }\n\n    if (val) attrs.push(val);\n    if (name) attrs.push(name);\n    if (cls) attrs.unshift(cls);\n\n    if (leftovers) {\n      (attrs || (this.attributes = [])).push(\n        new ConditionalAttribute({\n          owner: this,\n          up: this.up,\n          template: leftovers\n        })\n      );\n\n      // empty leftovers array\n      leftovers = [];\n    }\n\n    // create children\n    if (options.template.f && !options.deferContent) {\n      this.fragment = new Fragment({\n        template: options.template.f,\n        owner: this,\n        cssIds: null\n      });\n    }\n\n    this.binding = null; // filled in later\n  }\n\n  bind() {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.binding = true;\n      const len = attrs.length;\n      for (let i = 0; i < len; i++) attrs[i].bind();\n      attrs.binding = false;\n    }\n\n    if (this.fragment) this.fragment.bind();\n\n    // create two-way binding if necessary\n    if (!this.binding) this.recreateTwowayBinding();\n    else this.binding.bind();\n  }\n\n  createTwowayBinding() {\n    if ('twoway' in this ? this.twoway : this.ractive.twoway) {\n      const Binding = selectBinding(this);\n      if (Binding) {\n        const binding = new Binding(this);\n        if (binding && binding.model) return binding;\n      }\n    }\n  }\n\n  destroyed() {\n    if (this.attributes) this.attributes.forEach(destroyed);\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  detach() {\n    // if this element is no longer rendered, the transitions are complete and the attributes can be torn down\n    if (!this.rendered) this.destroyed();\n\n    return detachNode(this.node);\n  }\n\n  find(selector, options) {\n    if (this.node && matches(this.node, selector)) return this.node;\n    if (this.fragment) {\n      return this.fragment.find(selector, options);\n    }\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n\n    if (matches(this.node, selector)) {\n      result.push(this.node);\n    }\n\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findNextNode() {\n    return null;\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getAttribute(name) {\n    if (this.statics && name in this.statics) return this.statics[name];\n    const attribute = this.attributeByName[name];\n    return attribute ? attribute.getValue() : undefined;\n  }\n\n  getContext(...assigns) {\n    if (this.fragment) return this.fragment.getContext(...assigns);\n\n    if (!this.ctx) this.ctx = new Context(this.up, this);\n    assigns.unshift(create(this.ctx));\n    return assign.apply(null, assigns);\n  }\n\n  off(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = this.listeners && this.listeners[event];\n\n    if (!ref) return;\n    removeFromArray(ref, callback);\n\n    if (delegate) {\n      const listeners =\n        (delegate.listeners || (delegate.listeners = [])) &&\n        (delegate.listeners[event] || (delegate.listeners[event] = []));\n      if (listeners.refs && !--listeners.refs) delegate.off(event, delegateHandler, true);\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        rem.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, true);\n        add.call(n, event, handler, false);\n      }\n    }\n  }\n\n  on(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = (this.listeners || (this.listeners = {}))[event] || (this.listeners[event] = []);\n\n    if (delegate) {\n      const listeners =\n        ((delegate.listeners || (delegate.listeners = [])) && delegate.listeners[event]) ||\n        (delegate.listeners[event] = []);\n      if (!listeners.refs) {\n        listeners.refs = 0;\n        delegate.on(event, delegateHandler, true);\n        listeners.refs++;\n      } else {\n        listeners.refs++;\n      }\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        add.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, false);\n        add.call(n, event, handler, true);\n      }\n    }\n\n    addToArray(this.listeners[event], callback);\n  }\n\n  recreateTwowayBinding() {\n    if (this.binding) {\n      this.binding.unbind();\n      this.binding.unrender();\n    }\n\n    if ((this.binding = this.createTwowayBinding())) {\n      this.binding.bind();\n      if (this.rendered) this.binding.render();\n    }\n  }\n\n  rebound(update) {\n    super.rebound(update);\n    if (this.attributes) this.attributes.forEach(x => x.rebound(update));\n    if (this.binding) this.binding.rebound(update);\n  }\n\n  render(target, occupants) {\n    // TODO determine correct namespace\n    this.namespace = getNamespace(this);\n\n    let node;\n    let existing = false;\n\n    if (occupants) {\n      let n;\n      while ((n = occupants.shift())) {\n        if (\n          n.nodeName.toUpperCase() === this.template.e.toUpperCase() &&\n          n.namespaceURI === this.namespace\n        ) {\n          this.node = node = n;\n          existing = true;\n          break;\n        } else {\n          detachNode(n);\n        }\n      }\n    }\n\n    if (!existing && this.node) {\n      node = this.node;\n      target.appendChild(node);\n      existing = true;\n    }\n\n    if (!node) {\n      const name = this.template.e;\n      node = createElement(\n        this.namespace === html ? name.toLowerCase() : name,\n        this.namespace,\n        this.getAttribute('is')\n      );\n      this.node = node;\n    }\n\n    // tie the node to this vdom element\n    defineProperty(node, '_ractive', {\n      value: {\n        proxy: this\n      },\n      configurable: true\n    });\n\n    if (this.statics) {\n      keys(this.statics).forEach(k => {\n        node.setAttribute(k, this.statics[k]);\n      });\n    }\n\n    if (existing && this.foundNode) this.foundNode(node);\n\n    // register intro before rendering content so children can find the intro\n    const intro = this.intro;\n    if (intro && intro.shouldFire('intro')) {\n      intro.isIntro = true;\n      intro.isOutro = false;\n      runloop.registerTransition(intro);\n    }\n\n    if (this.fragment) {\n      const children = existing ? toArray(node.childNodes) : undefined;\n\n      this.fragment.render(node, children);\n\n      // clean up leftover children\n      if (children) {\n        children.forEach(detachNode);\n      }\n    }\n\n    if (existing) {\n      // store initial values for two-way binding\n      if (this.binding && this.binding.wasUndefined) this.binding.setFromNode(node);\n      // remove unused attributes\n      let i = node.attributes.length;\n      while (i--) {\n        const name = node.attributes[i].name;\n        if (!(name in this.attributeByName) && (!this.statics || !(name in this.statics)))\n          node.removeAttribute(name);\n      }\n    }\n\n    // Is this a top-level node of a component? If so, we may need to add\n    // a data-ractive-css attribute, for CSS encapsulation\n    if (this.up.cssIds) {\n      node.setAttribute('data-ractive-css', this.up.cssIds.map(x => `{${x}}`).join(' '));\n    }\n\n    if (this.attributes) {\n      const len = this.attributes.length;\n      for (let i = 0; i < len; i++) this.attributes[i].render();\n    }\n    if (this.binding) this.binding.render();\n\n    if (!this.up.delegate && this.listeners) {\n      const ls = this.listeners;\n      for (const k in ls) {\n        if (ls[k] && ls[k].length) this.node.addEventListener(k, handler, !!ls[k].refs);\n      }\n    }\n\n    if (!existing) {\n      target.appendChild(node);\n    }\n\n    this.rendered = true;\n  }\n\n  toString() {\n    const tagName = this.template.e;\n\n    let attrs = (this.attributes && this.attributes.map(stringifyAttribute).join('')) || '';\n\n    if (this.statics)\n      keys(this.statics).forEach(\n        k => k !== 'class' && k !== 'style' && (attrs = ` ${k}=\"${this.statics[k]}\"` + attrs)\n      );\n\n    // Special case - selected options\n    if (this.name === 'option' && this.isSelected()) {\n      attrs += ' selected';\n    }\n\n    // Special case - two-way radio name bindings\n    if (this.name === 'input' && inputIsCheckedRadio(this)) {\n      attrs += ' checked';\n    }\n\n    // Special case style and class attributes and directives\n    let style = this.statics ? this.statics.style : undefined;\n    let cls = this.statics ? this.statics.class : undefined;\n    this.attributes &&\n      this.attributes.forEach(attr => {\n        if (attr.name === 'class') {\n          cls = (cls || '') + (cls ? ' ' : '') + safeAttributeString(attr.getString());\n        } else if (attr.name === 'style') {\n          style = (style || '') + (style ? ' ' : '') + safeAttributeString(attr.getString());\n          if (style && !endsWithSemi.test(style)) style += ';';\n        } else if (attr.style) {\n          style =\n            (style || '') +\n            (style ? ' ' : '') +\n            `${attr.style}: ${safeAttributeString(attr.getString())};`;\n        } else if (attr.inlineClass && attr.getValue()) {\n          cls = (cls || '') + (cls ? ' ' : '') + attr.inlineClass;\n        }\n      });\n    // put classes first, then inline style\n    if (style !== undefined) attrs = ' style' + (style ? `=\"${style}\"` : '') + attrs;\n    if (cls !== undefined) attrs = ' class' + (cls ? `=\"${cls}\"` : '') + attrs;\n\n    if (this.up.cssIds) {\n      attrs += ` data-ractive-css=\"${this.up.cssIds.map(x => `{${x}}`).join(' ')}\"`;\n    }\n\n    let str = `<${tagName}${attrs}>`;\n\n    if (voidElements[this.name.toLowerCase()]) return str;\n\n    // Special case - textarea\n    if (this.name === 'textarea' && this.getAttribute('value') !== undefined) {\n      str += escapeHtml(this.getAttribute('value'));\n    } else if (this.getAttribute('contenteditable') !== undefined) {\n      // Special case - contenteditable\n      str += this.getAttribute('value') || '';\n    }\n\n    if (this.fragment) {\n      str += this.fragment.toString(!/^(?:script|style)$/i.test(this.template.e)); // escape text unless script/style\n    }\n\n    str += `</${tagName}>`;\n    return str;\n  }\n\n  unbind(view) {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.unbinding = true;\n      const len = attrs.length;\n      for (let i = 0; i < len; i++) attrs[i].unbind(view);\n      attrs.unbinding = false;\n    }\n\n    if (this.binding) this.binding.unbind(view);\n    if (this.fragment) this.fragment.unbind(view);\n  }\n\n  unrender(shouldDestroy) {\n    if (!this.rendered) return;\n    this.rendered = false;\n\n    // unrendering before intro completed? complete it now\n    // TODO should be an API for aborting transitions\n    const transition = this.intro;\n    if (transition && transition.complete) transition.complete();\n\n    // Detach as soon as we can\n    if (this.name === 'option') {\n      // <option> elements detach immediately, so that\n      // their parent <select> element syncs correctly, and\n      // since option elements can't have transitions anyway\n      this.detach();\n    } else if (shouldDestroy) {\n      runloop.detachWhenReady(this);\n    }\n\n    // outro transition\n    const outro = this.outro;\n    if (outro && outro.shouldFire('outro')) {\n      outro.isIntro = false;\n      outro.isOutro = true;\n      runloop.registerTransition(outro);\n    }\n\n    if (this.fragment) this.fragment.unrender();\n\n    if (this.binding) this.binding.unrender();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n\n      const attrs = this.attributes;\n      if (attrs) {\n        const len = attrs.length;\n        for (let i = 0; i < len; i++) attrs[i].update();\n      }\n\n      if (this.fragment) this.fragment.update();\n    }\n  }\n}\n\nfunction inputIsCheckedRadio(element) {\n  const nameAttr = element.attributeByName.name;\n  return (\n    element.getAttribute('type') === 'radio' &&\n    (nameAttr || {}).interpolator &&\n    element.getAttribute('value') === nameAttr.interpolator.model.get()\n  );\n}\n\nfunction stringifyAttribute(attribute) {\n  const str = attribute.toString();\n  return str ? ' ' + str : '';\n}\n\nfunction getNamespace(element) {\n  // Use specified namespace...\n  const xmlns = element.getAttribute('xmlns');\n  if (xmlns) return xmlns;\n\n  // ...or SVG namespace, if this is an <svg> element\n  if (element.name === 'svg') return svg;\n\n  const parent = element.parent;\n\n  if (parent) {\n    // ...or HTML, if the parent is a <foreignObject>\n    if (parent.name === 'foreignobject') return html;\n\n    // ...or inherit from the parent node\n    return parent.node.namespaceURI;\n  }\n\n  return element.ractive.el.namespaceURI;\n}\n\nfunction delegateHandler(ev) {\n  const name = ev.type;\n  const end = ev.currentTarget;\n  const endEl = end._ractive && end._ractive.proxy;\n  let node = ev.target;\n  let bubble = true;\n  let listeners;\n\n  // starting with the origin node, walk up the DOM looking for ractive nodes with a matching event listener\n  while (bubble && node && node !== end) {\n    const proxy = node._ractive && node._ractive.proxy;\n    if (proxy && proxy.up.delegate === endEl && shouldFire(ev, node, end)) {\n      listeners = proxy.listeners && proxy.listeners[name];\n\n      if (listeners) {\n        const len = listeners.length;\n        for (let i = 0; i < len; i++) bubble = listeners[i].call(node, ev) !== false && bubble;\n      }\n    }\n\n    node = node.parentNode || node.correspondingUseElement; // SVG with a <use> element in certain environments\n  }\n\n  return bubble;\n}\n\nconst UIEvent = win !== null ? win.UIEvent : null;\nfunction shouldFire(event, start, end) {\n  if (UIEvent && event instanceof UIEvent) {\n    let node = start;\n    while (node && node !== end) {\n      if (node.disabled) return false;\n      node = node.parentNode || node.correspondingUseElement;\n    }\n  }\n\n  return true;\n}\n\nfunction handler(ev) {\n  const el = this._ractive.proxy;\n  let listeners;\n  if (el.listeners && (listeners = el.listeners[ev.type])) {\n    const len = listeners.length;\n    for (let i = 0; i < len; i++) listeners[i].call(this, ev);\n  }\n}\n","import runloop from 'src/global/runloop';\nimport Element from '../../Element';\n\nexport default class Form extends Element {\n  constructor(options) {\n    super(options);\n    this.formBindings = [];\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.on('reset', handleReset);\n  }\n\n  unrender(shouldDestroy) {\n    this.off('reset', handleReset);\n    super.unrender(shouldDestroy);\n  }\n}\n\nfunction handleReset() {\n  const element = this._ractive.proxy;\n\n  runloop.start();\n  element.formBindings.forEach(updateModel);\n  runloop.end();\n}\n\nfunction updateModel(binding) {\n  binding.model.set(binding.resetValue);\n}\n","import { fatal } from 'utils/log';\nimport runloop from 'src/global/runloop';\n\nclass DOMEvent {\n  constructor(name, owner) {\n    if (name.indexOf('*') !== -1) {\n      fatal(\n        `Only component proxy-events may contain \"*\" wildcards, <${\n          owner.name\n        } on-${name}=\"...\"/> is not valid`\n      );\n    }\n\n    this.name = name;\n    this.owner = owner;\n    this.handler = null;\n  }\n\n  bind() {}\n\n  render(directive) {\n    const name = this.name;\n\n    const register = () => {\n      const node = this.owner.node;\n\n      this.owner.on(\n        name,\n        (this.handler = event => {\n          return directive.fire({\n            node,\n            original: event,\n            event,\n            name\n          });\n        })\n      );\n    };\n\n    if (name !== 'load') {\n      // schedule events so that they take place after twoway binding\n      runloop.scheduleTask(register, true);\n    } else {\n      // unless its a load event\n      register();\n    }\n  }\n\n  unbind() {}\n\n  unrender() {\n    if (this.handler) this.owner.off(this.name, this.handler);\n  }\n}\n\nclass CustomEvent {\n  constructor(eventPlugin, owner, name, args) {\n    this.eventPlugin = eventPlugin;\n    this.owner = owner;\n    this.name = name;\n    this.handler = null;\n    this.args = args;\n  }\n\n  bind() {}\n\n  render(directive) {\n    runloop.scheduleTask(() => {\n      const node = this.owner.node;\n\n      this.handler = this.eventPlugin.apply(\n        this.owner.ractive,\n        [\n          node,\n          (event = {}) => {\n            if (event.original) event.event = event.original;\n            else event.original = event.event;\n\n            event.name = this.name;\n            event.node = event.node || node;\n            return directive.fire(event);\n          }\n        ].concat(this.args || [])\n      );\n    });\n  }\n\n  unbind() {}\n\n  unrender() {\n    this.handler.teardown();\n  }\n}\n\nexport { DOMEvent, CustomEvent };\n","import Context from '../../../shared/Context';\n\nexport default class RactiveEvent {\n  constructor(component, name) {\n    this.component = component;\n    this.name = name;\n    this.handler = null;\n  }\n\n  bind(directive) {\n    const ractive = this.component.instance;\n\n    this.handler = ractive.on(this.name, (...args) => {\n      // watch for reproxy\n      if (args[0] instanceof Context) {\n        const ctx = args.shift();\n        ctx.component = ractive;\n        directive.fire(ctx, args);\n      } else {\n        directive.fire({}, args);\n      }\n\n      // cancel bubbling\n      return false;\n    });\n  }\n\n  render() {}\n\n  unbind() {\n    this.handler.cancel();\n  }\n\n  unrender() {}\n}\n","import { ANCHOR, COMPONENT } from 'config/types';\nimport { warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport fireEvent from 'src/events/fireEvent';\nimport { splitKeypath } from 'shared/keypaths';\nimport { findInViewHierarchy } from 'shared/registry';\nimport findElement from './findElement';\nimport { DOMEvent, CustomEvent } from '../element/ElementEvents';\nimport RactiveEvent from '../component/RactiveEvent';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport Context from 'src/shared/Context';\nimport { isArray, isString } from 'utils/is';\nimport getFunction from 'shared/getFunction';\nimport resolveReference from '../../resolvers/resolveReference';\n\nconst specialPattern = /^(event|arguments|@node|@event|@context)(\\..+)?$/;\nconst dollarArgsPattern = /^\\$(\\d+)(\\..+)?$/;\n\nexport default class EventDirective {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up, true);\n    this.template = options.template;\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n    this.events = [];\n  }\n\n  bind() {\n    // sometimes anchors will cause an unbind without unrender\n    if (this.events.length) {\n      this.events.forEach(e => e.unrender());\n      this.events = [];\n    }\n\n    if (this.element.type === COMPONENT || this.element.type === ANCHOR) {\n      this.template.n.forEach(n => {\n        this.events.push(new RactiveEvent(this.element, n));\n      });\n    } else {\n      let args;\n      if ((args = this.template.a)) {\n        const rs = args.r.map(r => {\n          const model = resolveReference(this.up, r);\n          return model ? model.get() : undefined;\n        });\n        try {\n          args = getFunction(args.s, rs.length).apply(null, rs);\n        } catch (err) {\n          args = null;\n          warnIfDebug(\n            `Failed to compute args for event on-${this.template.n.join('- ')}: ${err.message ||\n              err}`\n          );\n        }\n      }\n\n      this.template.n.forEach(n => {\n        const fn = findInViewHierarchy('events', this.ractive, n);\n        if (fn) {\n          this.events.push(new CustomEvent(fn, this.element, n, args));\n        } else {\n          this.events.push(new DOMEvent(n, this.element));\n        }\n      });\n    }\n\n    // method calls\n    this.models = null;\n\n    addToArray(this.element.events || (this.element.events = []), this);\n\n    setupArgsFn(this, this.template);\n    if (!this.fn) this.action = this.template.f;\n\n    this.events.forEach(e => e.bind(this));\n  }\n\n  destroyed() {\n    this.events.forEach(e => e.unrender());\n  }\n\n  fire(event, args = []) {\n    const context =\n      event instanceof Context && event.refire ? event : this.element.getContext(event);\n\n    if (this.fn) {\n      const values = [];\n\n      const models = resolveArgs(this, this.template, this.up, {\n        specialRef(ref) {\n          const specialMatch = specialPattern.exec(ref);\n          if (specialMatch) {\n            // on-click=\"foo(event.node)\"\n            return {\n              special: specialMatch[1],\n              keys: specialMatch[2] ? splitKeypath(specialMatch[2].substr(1)) : []\n            };\n          }\n\n          const dollarMatch = dollarArgsPattern.exec(ref);\n          if (dollarMatch) {\n            // on-click=\"foo($1)\"\n            return {\n              special: 'arguments',\n              keys: [dollarMatch[1] - 1].concat(\n                dollarMatch[2] ? splitKeypath(dollarMatch[2].substr(1)) : []\n              )\n            };\n          }\n        }\n      });\n\n      if (models) {\n        models.forEach(model => {\n          if (!model) return values.push(undefined);\n\n          if (model.special) {\n            const which = model.special;\n            let obj;\n\n            if (which === '@node') {\n              obj = this.element.node;\n            } else if (which === '@event') {\n              obj = event && event.event;\n            } else if (which === 'event') {\n              warnOnceIfDebug(\n                `The event reference available to event directives is deprecated and should be replaced with @context and @event`\n              );\n              obj = context;\n            } else if (which === '@context') {\n              obj = context;\n            } else {\n              obj = args;\n            }\n\n            const keys = model.keys.slice();\n\n            while (obj && keys.length) obj = obj[keys.shift()];\n            return values.push(obj);\n          }\n\n          if (model.wrapper) {\n            return values.push(model.wrapperValue);\n          }\n\n          values.push(model.get());\n        });\n      }\n\n      // make event available as `this.event`\n      const ractive = this.ractive;\n      const oldEvent = ractive.event;\n\n      ractive.event = context;\n      const returned = this.fn.apply(ractive, values);\n      let result = returned.pop();\n\n      // Auto prevent and stop if return is explicitly false\n      if (result === false) {\n        const original = event ? event.original : undefined;\n        if (original) {\n          original.preventDefault && original.preventDefault();\n          original.stopPropagation && original.stopPropagation();\n        } else {\n          warnOnceIfDebug(\n            `handler '${this.template.n.join(\n              ' '\n            )}' returned false, but there is no event available to cancel`\n          );\n        }\n      } else if (!returned.length && isArray(result) && isString(result[0])) {\n        // watch for proxy events\n        result = fireEvent(this.ractive, result.shift(), context, result);\n      }\n\n      ractive.event = oldEvent;\n\n      return result;\n    } else {\n      return fireEvent(this.ractive, this.action, context, args);\n    }\n  }\n\n  handleChange() {}\n\n  render() {\n    this.events.forEach(e => e.render(this));\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind(view) {\n    removeFromArray(this.element.events, this);\n    this.events.forEach(e => e.unbind(view));\n  }\n\n  unrender() {\n    this.events.forEach(e => e.unrender());\n  }\n}\n\nconst proto = EventDirective.prototype;\nproto.firstNode = proto.rebound = proto.update = noop;\n","import { rebindMatch } from 'shared/rebind';\nimport Item, { ContainerItem } from './Item';\nimport resolve from '../../resolvers/resolve';\nimport { assign } from 'utils/object';\n\nexport default class Mustache extends Item {\n  constructor(options) {\n    super(options);\n\n    if (options.owner) this.parent = options.owner;\n\n    this.isStatic = !!options.template.s;\n\n    this.model = null;\n    this.dirty = false;\n  }\n\n  bind(pre) {\n    // yield mustaches and inner contexts should resolve in container context\n    const start = this.template.y\n      ? this.template.y.containerFragment\n      : this.containerFragment || this.up;\n    // try to find a model for this view\n    const model = pre || resolve(start, this.template);\n\n    if (model) {\n      const value = model.get();\n\n      if (this.isStatic) {\n        this.model = { get: () => value };\n        model.unreference();\n        return;\n      }\n\n      model.register(this);\n      this.model = model;\n    }\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebind(next, previous, safe) {\n    if (this.isStatic) return;\n\n    next = rebindMatch(this.template, next, previous, this.up);\n    if (next === this.model) return false;\n\n    if (this.model) {\n      this.model.unregister(this);\n    }\n    if (next) next.addShuffleRegister(this, 'mark');\n    this.model = next;\n    if (!safe) this.handleChange();\n    return true;\n  }\n\n  rebound(update) {\n    if (this.model) {\n      if (this.model.rebound) this.model.rebound(update);\n      else {\n        // check to see if the model actually changed...\n        // yield mustaches and inner contexts should resolve in container context\n        const start = this.template.y\n          ? this.template.y.containerFragment\n          : this.containerFragment || this.up;\n        // try to find a model for this view\n        const model = resolve(start, this.template);\n        if (model !== this.model) {\n          this.model.unregister(this);\n          this.bind(model);\n        }\n      }\n\n      if (update) this.bubble();\n    }\n    if (this.fragment) this.fragment.rebound(update);\n  }\n\n  unbind() {\n    if (!this.isStatic) {\n      this.model && this.model.unregister(this);\n      this.model = undefined;\n    }\n  }\n}\n\nexport function MustacheContainer(options) {\n  Mustache.call(this, options);\n}\n\nconst proto = (MustacheContainer.prototype = Object.create(ContainerItem.prototype));\n\nassign(proto, Mustache.prototype, { constructor: MustacheContainer });\n","import progressiveText from './shared/progressiveText';\nimport { escapeHtml } from 'utils/html';\nimport { safeToStringValue } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport Mustache from './shared/Mustache';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Interpolator extends Mustache {\n  bubble() {\n    if (this.owner) this.owner.bubble();\n    super.bubble();\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getString() {\n    return this.model ? safeToStringValue(this.model.get()) : '';\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    const value = (this.value = this.getString());\n\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, value);\n  }\n\n  toString(escape) {\n    const string = this.getString();\n    return escape ? escapeHtml(string) : string;\n  }\n\n  unrender(shouldDestroy) {\n    if (shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.rendered) {\n        const value = this.getString();\n        if (value !== this.value) this.node.data = this.value = value;\n      }\n    }\n  }\n\n  valueOf() {\n    return this.model ? this.model.get() : undefined;\n  }\n}\n","import Element from '../../Element';\nimport { isFunction } from 'utils/is';\n\nexport default class Input extends Element {\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.node.defaultValue = this.node.value;\n  }\n  compare(value, attrValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(value, attrValue);\n      }\n      if (value && attrValue) {\n        return value[comparator] == attrValue[comparator];\n      }\n    }\n    return value == attrValue;\n  }\n}\n","import { isClient, svg, vendors, win, doc } from 'config/environment';\nimport { html } from 'config/namespaces';\nimport { isString, isNumber } from 'utils/is';\n\nlet createElement, matches, div, methodNames, unprefixed, prefixed, i, j, makeFunction;\n\n// Test for SVG support\nif (!svg) {\n  /* istanbul ignore next */\n  createElement = (type, ns, extend) => {\n    if (ns && ns !== html) {\n      throw \"This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you're trying to render SVG in an older browser. See http://ractive.js.org/support/#svgs for more information\";\n    }\n\n    return extend ? doc.createElement(type, extend) : doc.createElement(type);\n  };\n} else {\n  createElement = (type, ns, extend) => {\n    if (!ns || ns === html) {\n      return extend ? doc.createElement(type, extend) : doc.createElement(type);\n    }\n\n    return extend ? doc.createElementNS(ns, type, extend) : doc.createElementNS(ns, type);\n  };\n}\n\nexport function createDocumentFragment() {\n  return doc.createDocumentFragment();\n}\n\nfunction getElement(input) {\n  let output;\n\n  if (!input || typeof input === 'boolean') {\n    return;\n  }\n\n  /* istanbul ignore next */\n  if (!win || !doc || !input) {\n    return null;\n  }\n\n  // We already have a DOM node - no work to do. (Duck typing alert!)\n  if (input.nodeType) {\n    return input;\n  }\n\n  // Get node from string\n  if (isString(input)) {\n    // try ID first\n    output = doc.getElementById(input);\n\n    // then as selector, if possible\n    if (!output && doc.querySelector) {\n      try {\n        output = doc.querySelector(input);\n      } catch (e) {\n        /* this space intentionally left blank */\n      }\n    }\n\n    // did it work?\n    if (output && output.nodeType) {\n      return output;\n    }\n  }\n\n  // If we've been given a collection (jQuery, Zepto etc), extract the first item\n  if (input[0] && input[0].nodeType) {\n    return input[0];\n  }\n\n  return null;\n}\n\nif (!isClient) {\n  matches = null;\n} else {\n  div = createElement('div');\n  methodNames = ['matches', 'matchesSelector'];\n\n  makeFunction = function(methodName) {\n    return function(node, selector) {\n      return node[methodName](selector);\n    };\n  };\n\n  i = methodNames.length;\n\n  while (i-- && !matches) {\n    unprefixed = methodNames[i];\n\n    if (div[unprefixed]) {\n      matches = makeFunction(unprefixed);\n    } else {\n      j = vendors.length;\n      while (j--) {\n        prefixed = vendors[i] + unprefixed.substr(0, 1).toUpperCase() + unprefixed.substring(1);\n\n        if (div[prefixed]) {\n          matches = makeFunction(prefixed);\n          break;\n        }\n      }\n    }\n  }\n\n  // IE8... and apparently phantom some?\n  /* istanbul ignore next */\n  if (!matches) {\n    matches = function(node, selector) {\n      let parentNode, i;\n\n      parentNode = node.parentNode;\n\n      if (!parentNode) {\n        // empty dummy <div>\n        div.innerHTML = '';\n\n        parentNode = div;\n        node = node.cloneNode();\n\n        div.appendChild(node);\n      }\n\n      const nodes = parentNode.querySelectorAll(selector);\n\n      i = nodes.length;\n      while (i--) {\n        if (nodes[i] === node) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  }\n}\n\nfunction detachNode(node) {\n  // stupid ie\n  // eslint-disable-next-line valid-typeof\n  if (node && typeof node.parentNode !== 'unknown' && node.parentNode) {\n    node.parentNode.removeChild(node);\n  }\n\n  return node;\n}\n\nfunction safeToStringValue(value) {\n  return value == null || (isNumber(value) && isNaN(value)) || !value.toString ? '' : '' + value;\n}\n\nfunction safeAttributeString(string) {\n  return safeToStringValue(string)\n    .replace(/&/g, '&amp;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\nexport { createElement, detachNode, getElement, matches, safeToStringValue, safeAttributeString };\n","import { isEqual, isFunction } from 'utils/is';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\nimport { rebindMatch } from 'shared/rebind';\nimport { create } from 'utils/object';\n\nexport default class Observer {\n  constructor(ractive, model, callback, options) {\n    this.context = options.context || ractive;\n    this.callback = callback;\n    this.ractive = ractive;\n    this.keypath = options.keypath;\n    this.options = options;\n\n    if (model) this.resolved(model);\n\n    if (isFunction(options.old)) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    if (options.init !== false) {\n      this.dirty = true;\n      this.dispatch();\n    } else {\n      updateOld(this);\n    }\n\n    this.dirty = false;\n  }\n\n  cancel() {\n    this.cancelled = true;\n    if (this.model) {\n      this.model.unregister(this);\n    } else {\n      this.resolver.unbind();\n    }\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    if (!this.cancelled) {\n      this.callback.call(this.context, this.newValue, this.oldValue, this.keypath);\n      updateOld(this, true);\n      this.dirty = false;\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty) {\n      const newValue = this.model.get();\n      if (isEqual(newValue, this.oldValue)) return;\n\n      this.newValue = newValue;\n\n      if (this.options.strict && this.newValue === this.oldValue) return;\n\n      runloop.addObserver(this, this.options.defer);\n      this.dirty = true;\n\n      if (this.options.once) runloop.scheduleTask(() => this.cancel());\n    } else {\n      // make sure the newValue stays updated in case this observer gets touched multiple times in one loop\n      this.newValue = this.model.get();\n    }\n  }\n\n  rebind(next, previous) {\n    next = rebindMatch(this.keypath, next, previous);\n    if (next === this.model) return false;\n\n    if (this.model) this.model.unregister(this);\n    if (next) next.addShuffleTask(() => this.resolved(next));\n  }\n\n  resolved(model) {\n    this.model = model;\n\n    this.oldValue = undefined;\n    this.newValue = model.get();\n\n    model.register(this);\n  }\n}\n\nfunction updateOld(observer, fresh) {\n  const next = fresh\n    ? observer.model\n      ? observer.model.get()\n      : observer.newValue\n    : observer.newValue;\n  observer.oldValue = observer.oldFn\n    ? observer.oldFn.call(observer.oldContext, undefined, next, observer.keypath)\n    : next;\n}\n","import { escapeKey } from 'shared/keypaths';\nimport { removeFromArray } from 'utils/array';\nimport { isArray, isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport { create, keys } from 'utils/object';\n\nconst star = /\\*+/g;\n\nexport default class PatternObserver {\n  constructor(ractive, baseModel, keys, callback, options) {\n    this.context = options.context || ractive;\n    this.ractive = ractive;\n    this.baseModel = baseModel;\n    this.keys = keys;\n    this.callback = callback;\n\n    const pattern = keys.join('\\\\.').replace(star, '(.+)');\n    const baseKeypath = (this.baseKeypath = baseModel.getKeypath(ractive));\n    this.pattern = new RegExp(`^${baseKeypath ? baseKeypath + '\\\\.' : ''}${pattern}$`);\n    this.recursive = keys.length === 1 && keys[0] === '**';\n    if (this.recursive) this.keys = ['*'];\n    if (options.old) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    this.oldValues = {};\n    this.newValues = {};\n\n    this.defer = options.defer;\n    this.once = options.once;\n    this.strict = options.strict;\n\n    this.dirty = false;\n    this.changed = [];\n    this.partial = false;\n    this.links = options.links;\n\n    const models = baseModel.findMatches(this.keys);\n\n    models.forEach(model => {\n      this.newValues[model.getKeypath(this.ractive)] = model.get();\n    });\n\n    if (options.init !== false) {\n      this.dispatch();\n    } else {\n      updateOld(this, this.newValues);\n    }\n\n    baseModel.registerPatternObserver(this);\n  }\n\n  cancel() {\n    this.baseModel.unregisterPatternObserver(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    const newValues = this.newValues;\n    this.newValues = {};\n    keys(newValues).forEach(keypath => {\n      const newValue = newValues[keypath];\n      const oldValue = this.oldValues[keypath];\n\n      if (this.strict && newValue === oldValue) return;\n      if (isEqual(newValue, oldValue)) return;\n\n      let args = [newValue, oldValue, keypath];\n      if (keypath) {\n        const wildcards = this.pattern.exec(keypath);\n        if (wildcards) {\n          args = args.concat(wildcards.slice(1));\n        }\n      }\n\n      this.callback.apply(this.context, args);\n    });\n\n    updateOld(this, newValues, this.partial);\n\n    this.dirty = false;\n  }\n\n  notify(key) {\n    this.changed.push(key);\n  }\n\n  shuffle(newIndices) {\n    if (!isArray(this.baseModel.value)) return;\n\n    const max = this.baseModel.value.length;\n\n    for (let i = 0; i < newIndices.length; i++) {\n      if (newIndices[i] === -1 || newIndices[i] === i) continue;\n      this.changed.push([i]);\n    }\n\n    for (let i = newIndices.touchedFrom; i < max; i++) {\n      this.changed.push([i]);\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty || this.changed.length) {\n      if (!this.dirty) this.newValues = {};\n\n      if (!this.changed.length) {\n        this.baseModel.findMatches(this.keys).forEach(model => {\n          const keypath = model.getKeypath(this.ractive);\n          this.newValues[keypath] = model.get();\n        });\n        this.partial = false;\n      } else {\n        let count = 0;\n\n        if (this.recursive) {\n          this.changed.forEach(keys => {\n            const model = this.baseModel.joinAll(keys);\n            if (model.isLink && !this.links) return;\n            count++;\n            this.newValues[model.getKeypath(this.ractive)] = model.get();\n          });\n        } else {\n          const ok = this.baseModel.isRoot\n            ? this.changed.map(keys => keys.map(escapeKey).join('.'))\n            : this.changed.map(keys => this.baseKeypath + '.' + keys.map(escapeKey).join('.'));\n\n          this.baseModel.findMatches(this.keys).forEach(model => {\n            const keypath = model.getKeypath(this.ractive);\n            const check = k => {\n              return (\n                (k.indexOf(keypath) === 0 &&\n                  (k.length === keypath.length || k[keypath.length] === '.')) ||\n                (keypath.indexOf(k) === 0 &&\n                  (k.length === keypath.length || keypath[k.length] === '.'))\n              );\n            };\n\n            // is this model on a changed keypath?\n            if (ok.filter(check).length) {\n              count++;\n              this.newValues[keypath] = model.get();\n            }\n          });\n        }\n\n        // no valid change triggered, so bail to avoid breakage\n        if (!count) return;\n\n        this.partial = true;\n      }\n\n      runloop.addObserver(this, this.defer);\n      this.dirty = true;\n      this.changed.length = 0;\n\n      if (this.once) this.cancel();\n    }\n  }\n}\n\nfunction updateOld(observer, vals, partial) {\n  const olds = observer.oldValues;\n\n  if (observer.oldFn) {\n    if (!partial) observer.oldValues = {};\n\n    keys(vals).forEach(k => {\n      const args = [olds[k], vals[k], k];\n      const parts = observer.pattern.exec(k);\n      if (parts) {\n        args.push.apply(args, parts.slice(1));\n      }\n      observer.oldValues[k] = observer.oldFn.apply(observer.oldContext, args);\n    });\n  } else {\n    if (partial) {\n      keys(vals).forEach(k => (olds[k] = vals[k]));\n    } else {\n      observer.oldValues = vals;\n    }\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport { isArray } from 'utils/is';\nimport runloop from 'src/global/runloop';\n\nfunction negativeOne() {\n  return -1;\n}\n\nexport default class ArrayObserver {\n  constructor(ractive, model, callback, options) {\n    this.ractive = ractive;\n    this.model = model;\n    this.keypath = model.getKeypath();\n    this.callback = callback;\n    this.options = options;\n\n    this.pending = null;\n\n    model.register(this);\n\n    if (options.init !== false) {\n      this.sliced = [];\n      this.shuffle([]);\n      this.dispatch();\n    } else {\n      this.sliced = this.slice();\n    }\n  }\n\n  cancel() {\n    this.model.unregister(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    this.callback(this.pending);\n    this.pending = null;\n    if (this.options.once) this.cancel();\n  }\n\n  handleChange(path) {\n    if (this.pending) {\n      // post-shuffle\n      runloop.addObserver(this, this.options.defer);\n    } else if (!path) {\n      // entire array changed\n      this.shuffle(this.sliced.map(negativeOne));\n      this.handleChange();\n    }\n  }\n\n  shuffle(newIndices) {\n    const newValue = this.slice();\n\n    const inserted = [];\n    const deleted = [];\n    let start;\n\n    const hadIndex = {};\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      hadIndex[newIndex] = true;\n\n      if (newIndex !== oldIndex && start === undefined) {\n        start = oldIndex;\n      }\n\n      if (newIndex === -1) {\n        deleted.push(this.sliced[oldIndex]);\n      }\n    });\n\n    if (start === undefined) start = newIndices.length;\n\n    const len = newValue.length;\n    for (let i = 0; i < len; i += 1) {\n      if (!hadIndex[i]) inserted.push(newValue[i]);\n    }\n\n    this.pending = { inserted, deleted, start };\n    this.sliced = newValue;\n  }\n\n  slice() {\n    const value = this.model.get();\n    return isArray(value) ? value.slice() : [];\n  }\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { assign } from 'utils/object';\n\nconst onceOptions = { init: false, once: true };\n\nexport default function observeOnce(keypath, callback, options) {\n  if (isObject(keypath) || isFunction(keypath)) {\n    options = assign(callback || {}, onceOptions);\n    return this.observe(keypath, options);\n  }\n\n  options = assign(options || {}, onceOptions);\n  return this.observe(keypath, callback, options);\n}\n","export default str => str.trim();\n","export default str => str !== '';\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('pop').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('push').path;\n","import { doc } from '../config/environment';\n\nconst PREFIX = '/* Ractive.js component styles */';\n\n// Holds current definitions of styles.\nconst styleDefinitions = [];\n\n// Flag to tell if we need to update the CSS\nlet isDirty = false;\n\n// These only make sense on the browser. See additional setup below.\nlet styleElement = null;\nlet useCssText = null;\n\nexport function addCSS(styleDefinition) {\n  styleDefinitions.push(styleDefinition);\n  isDirty = true;\n}\n\nexport function applyCSS(force) {\n  const styleElement = style();\n\n  // Apply only seems to make sense when we're in the DOM. Server-side renders\n  // can call toCSS to get the updated CSS.\n  if (!styleElement || (!force && !isDirty)) return;\n\n  if (useCssText) {\n    styleElement.styleSheet.cssText = getCSS(null);\n  } else {\n    styleElement.innerHTML = getCSS(null);\n  }\n\n  isDirty = false;\n}\n\nexport function getCSS(cssIds) {\n  const filteredStyleDefinitions = cssIds\n    ? styleDefinitions.filter(style => ~cssIds.indexOf(style.id))\n    : styleDefinitions;\n\n  filteredStyleDefinitions.forEach(d => (d.applied = true));\n\n  return filteredStyleDefinitions.reduce(\n    (styles, style) => `${styles ? `${styles}\\n\\n/* {${style.id}} */\\n${style.styles}` : ''}`,\n    PREFIX\n  );\n}\n\nfunction style() {\n  // If we're on the browser, additional setup needed.\n  if (doc && !styleElement) {\n    styleElement = doc.createElement('style');\n    styleElement.type = 'text/css';\n    styleElement.setAttribute('data-ractive-css', '');\n\n    doc.getElementsByTagName('head')[0].appendChild(styleElement);\n\n    useCssText = !!styleElement.styleSheet;\n  }\n\n  return styleElement;\n}\n","import { ensureArray, combine } from 'utils/array';\n\nexport default {\n  extend: (Parent, proto, options) => {\n    proto.adapt = combine(proto.adapt, ensureArray(options.adapt));\n  },\n\n  init() {}\n};\n","const remove = /\\/\\*(?:[\\s\\S]*?)\\*\\//g;\nconst escape = /url\\(\\s*(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\1\\s*\\)|url\\((?:\\\\[\\s\\S]|[^)])*\\)|(['\"])(?:\\\\[\\s\\S]|(?!\\2).)*\\2/gi;\nconst value = /\\0(\\d+)/g;\n\n// Removes comments and strings from the given CSS to make it easier to parse.\n// Callback receives the cleaned CSS and a function which can be used to put\n// the removed strings back in place after parsing is done.\nexport default function(css, callback, additionalReplaceRules = []) {\n  const values = [];\n  const reconstruct = css => css.replace(value, (match, n) => values[n]);\n  css = css.replace(escape, match => `\\0${values.push(match) - 1}`).replace(remove, '');\n\n  additionalReplaceRules.forEach(pattern => {\n    css = css.replace(pattern, match => `\\0${values.push(match) - 1}`);\n  });\n\n  return callback(css, reconstruct);\n}\n","import cleanCss from 'utils/cleanCss';\n\nconst selectorsPattern = /(?:^|\\}|\\{|\\x01)\\s*([^\\{\\}\\0\\x01]+)\\s*(?=\\{)/g;\nconst importPattern = /@import\\s*\\([^)]*\\)\\s*;?/gi;\nconst importEndPattern = /\\x01/g;\nconst keyframesDeclarationPattern = /@keyframes\\s+[^\\{\\}]+\\s*\\{(?:[^{}]+|\\{[^{}]+})*}/gi;\nconst selectorUnitPattern = /((?:(?:\\[[^\\]]+\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\nconst excludePattern = /^(?:@|\\d+%)/;\nconst dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\nfunction trim(str) {\n  return str.trim();\n}\n\nfunction extractString(unit) {\n  return unit.str;\n}\n\nfunction transformSelector(selector, parent) {\n  const selectorUnits = [];\n  let match;\n\n  while ((match = selectorUnitPattern.exec(selector))) {\n    selectorUnits.push({\n      str: match[0],\n      base: match[1],\n      modifiers: match[2]\n    });\n  }\n\n  // For each simple selector within the selector, we need to create a version\n  // that a) combines with the id, and b) is inside the id\n  const base = selectorUnits.map(extractString);\n\n  const transformed = [];\n  let i = selectorUnits.length;\n\n  while (i--) {\n    const appended = base.slice();\n\n    // Pseudo-selectors should go after the attribute selector\n    const unit = selectorUnits[i];\n    appended[i] = unit.base + parent + unit.modifiers || '';\n\n    const prepended = base.slice();\n    prepended[i] = parent + ' ' + prepended[i];\n\n    transformed.push(appended.join(' '), prepended.join(' '));\n  }\n\n  return transformed.join(', ');\n}\n\nexport default function transformCss(css, id) {\n  const dataAttr = `[data-ractive-css~=\"{${id}}\"]`;\n\n  let transformed;\n\n  if (dataRvcGuidPattern.test(css)) {\n    transformed = css.replace(dataRvcGuidPattern, dataAttr);\n  } else {\n    transformed = cleanCss(\n      css,\n      (css, reconstruct) => {\n        css = css\n          .replace(importPattern, '$&\\x01')\n          .replace(selectorsPattern, (match, $1) => {\n            // don't transform at-rules and keyframe declarations\n            if (excludePattern.test($1)) return match;\n\n            const selectors = $1.split(',').map(trim);\n            const transformed =\n              selectors.map(selector => transformSelector(selector, dataAttr)).join(', ') + ' ';\n\n            return match.replace($1, transformed);\n          })\n          .replace(importEndPattern, '');\n\n        return reconstruct(css);\n      },\n      [keyframesDeclarationPattern]\n    );\n  }\n\n  return transformed;\n}\n","import { SharedModel } from './SharedModel';\nimport { applyChanges } from '../../Ractive/static/styleSet';\n\nexport default class CSSModel extends SharedModel {\n  constructor(component) {\n    super(component.cssData, '@style');\n    this.component = component;\n  }\n\n  downstreamChanged(path, depth) {\n    if (this.locked) return;\n\n    const component = this.component;\n\n    component.extensions.forEach(e => {\n      const model = e._cssModel;\n      model.mark();\n      model.downstreamChanged(path, depth || 1);\n    });\n\n    if (!depth) {\n      applyChanges(component, true);\n    }\n  }\n}\n","import { addCSS, applyCSS } from 'src/global/css';\nimport transformCss from './transform';\nimport { uuid } from 'utils/id';\nimport { warnIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport { splitKeypath } from 'shared/keypaths';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperty } from 'utils/object';\nimport { isString, isFunction, isObjectType } from 'utils/is';\n\nconst hasCurly = /\\{/;\nexport default {\n  name: 'css',\n\n  // Called when creating a new component definition\n  extend: (Parent, proto, options, Child) => {\n    Child._cssIds = gatherIds(Parent);\n\n    defineProperty(Child, 'cssData', {\n      configurable: true,\n      value: assign(create(Parent.cssData), options.cssData || {})\n    });\n\n    defineProperty(Child, '_cssModel', {\n      configurable: true,\n      value: new CSSModel(Child)\n    });\n\n    if (options.css) initCSS(options, Child, proto);\n  },\n\n  // Called when creating a new component instance\n  init: (Parent, target, options) => {\n    if (!options.css) return;\n\n    warnIfDebug(`\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\n\nconst Component = Ractive.extend({\n\t...\n\tcss: '/* your css */',\n\t...\n});\n\nconst componentInstance = new Component({ ... })\n\t\t`);\n  }\n};\n\nfunction gatherIds(start) {\n  let cmp = start;\n  const ids = [];\n\n  while (cmp) {\n    if (cmp.prototype.cssId) ids.push(cmp.prototype.cssId);\n    cmp = cmp.Parent;\n  }\n\n  return ids;\n}\n\nexport function evalCSS(component, css) {\n  if (isString(css)) return css;\n\n  const cssData = component.cssData;\n  const model = component._cssModel;\n  const data = function data(path) {\n    return model.joinAll(splitKeypath(path)).get();\n  };\n  data.__proto__ = cssData;\n\n  const result = css.call(component, data);\n  return isString(result) ? result : '';\n}\n\nexport function initCSS(options, target, proto) {\n  let css =\n    options.css === true\n      ? ''\n      : isString(options.css) && !hasCurly.test(options.css)\n      ? getElement(options.css) || options.css\n      : options.css;\n  let cssProp = css;\n\n  const id = options.cssId || uuid();\n\n  if (isObjectType(css)) {\n    css = 'textContent' in css ? css.textContent : css.innerHTML;\n    cssProp = css;\n  } else if (isFunction(css)) {\n    cssProp = css;\n    css = evalCSS(target, css);\n  }\n\n  const def = {\n    transform: 'noCSSTransform' in options ? !options.noCSSTransform : !options.noCssTransform\n  };\n\n  defineProperty(target, '_cssDef', { configurable: true, value: def });\n\n  defineProperty(target, 'css', {\n    get() {\n      return cssProp;\n    },\n    set(next) {\n      cssProp = next;\n      const css = evalCSS(target, cssProp);\n      const styles = def.styles;\n      def.styles = def.transform ? transformCss(css, id) : css;\n      if (def.applied && styles !== def.styles) applyCSS(true);\n    }\n  });\n\n  def.styles = def.transform ? transformCss(css, id) : css;\n  def.id = proto.cssId = id;\n  target._cssIds.push(id);\n\n  addCSS(target._cssDef);\n}\n","import { fatal, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { isArray, isObject, isFunction, isObjectType } from 'utils/is';\nimport bind from 'utils/bind';\n\nfunction validate(data) {\n  // Warn if userOptions.data is a non-POJO\n  if (data && data.constructor !== Object) {\n    if (isFunction(data)) {\n      // TODO do we need to support this in the new Ractive() case?\n    } else if (!isObjectType(data)) {\n      fatal(`data option must be an object or a function, \\`${data}\\` is not valid`);\n    } else {\n      warnIfDebug(\n        'If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged'\n      );\n    }\n  }\n}\n\nexport default {\n  name: 'data',\n\n  extend: (Parent, proto, options) => {\n    let key;\n    let value;\n\n    // check for non-primitives, which could cause mutation-related bugs\n    if (options.data && isObject(options.data)) {\n      for (key in options.data) {\n        value = options.data[key];\n\n        if (value && isObjectType(value)) {\n          if (isObject(value) || isArray(value)) {\n            warnIfDebug(`Passing a \\`data\\` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }`);\n          }\n        }\n      }\n    }\n\n    proto.data = combine(proto.data, options.data);\n  },\n\n  init: (Parent, ractive, options) => {\n    let result = combine(Parent.prototype.data, options.data);\n\n    if (isFunction(result)) result = result.call(ractive);\n\n    // bind functions to the ractive instance at the top level,\n    // unless it's a non-POJO (in which case alarm bells should ring)\n    if (result && result.constructor === Object) {\n      for (const prop in result) {\n        if (isFunction(result[prop])) {\n          const value = result[prop];\n          result[prop] = bind(value, ractive);\n          result[prop]._r_unbound = value;\n        }\n      }\n    }\n\n    return result || {};\n  },\n\n  reset(ractive) {\n    const result = this.init(ractive.constructor, ractive, ractive.viewmodel);\n    ractive.viewmodel.root.set(result);\n    return true;\n  }\n};\n\nfunction emptyData() {\n  return {};\n}\n\nfunction combine(parentValue, childValue) {\n  validate(childValue);\n\n  const parentIsFn = isFunction(parentValue);\n\n  // Very important, otherwise child instance can become\n  // the default data object on Ractive or a component.\n  // then ractive.set() ends up setting on the prototype!\n  if (!childValue && !parentIsFn) {\n    // this needs to be a function so that it can still inherit parent defaults\n    childValue = emptyData;\n  }\n\n  const childIsFn = isFunction(childValue);\n\n  // Fast path, where we just need to copy properties from\n  // parent to child\n  if (!parentIsFn && !childIsFn) {\n    return fromProperties(childValue, parentValue);\n  }\n\n  return function() {\n    const child = childIsFn ? callDataFunction(childValue, this) : childValue;\n    const parent = parentIsFn ? callDataFunction(parentValue, this) : parentValue;\n\n    return fromProperties(child, parent);\n  };\n}\n\nfunction callDataFunction(fn, context) {\n  const data = fn.call(context);\n\n  if (!data) return;\n\n  if (!isObjectType(data)) {\n    fatal('Data function must return an object');\n  }\n\n  if (data.constructor !== Object) {\n    warnOnceIfDebug(\n      'Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged'\n    );\n  }\n\n  return data;\n}\n\nfunction fromProperties(primary, secondary) {\n  if (primary && secondary) {\n    for (const key in secondary) {\n      if (!(key in primary)) {\n        primary[key] = secondary[key];\n      }\n    }\n\n    return primary;\n  }\n\n  return primary || secondary;\n}\n","export const TEMPLATE_VERSION = 4;\n","import { TEMPLATE_VERSION } from 'config/template';\nimport { addFunctions } from 'shared/getFunction';\nimport parser from '../runtime-parser';\nimport { hasOwn } from 'utils/object';\nimport { isFunction, isNumber, isString } from 'utils/is';\n\nexport default {\n  name: 'template',\n\n  extend(Parent, proto, options) {\n    // only assign if exists\n    if ('template' in options) {\n      const template = options.template;\n\n      if (isFunction(template)) {\n        proto.template = template;\n      } else {\n        proto.template = parseTemplate(template, proto);\n      }\n    }\n  },\n\n  init(Parent, ractive, options) {\n    // TODO because of prototypal inheritance, we might just be able to use\n    // ractive.template, and not bother passing through the Parent object.\n    // At present that breaks the test mocks' expectations\n    let template = 'template' in options ? options.template : Parent.prototype.template;\n    template = template || { v: TEMPLATE_VERSION, t: [] };\n\n    if (isFunction(template)) {\n      const fn = template;\n      template = getDynamicTemplate(ractive, fn);\n\n      ractive._config.template = {\n        fn,\n        result: template\n      };\n    }\n\n    template = parseTemplate(template, ractive);\n\n    // TODO the naming of this is confusing - ractive.template refers to [...],\n    // but Component.prototype.template refers to {v:1,t:[],p:[]}...\n    // it's unnecessary, because the developer never needs to access\n    // ractive.template\n    ractive.template = template.t;\n\n    if (template.p) {\n      extendPartials(ractive.partials, template.p);\n    }\n  },\n\n  reset(ractive) {\n    const result = resetValue(ractive);\n\n    if (result) {\n      const parsed = parseTemplate(result, ractive);\n\n      ractive.template = parsed.t;\n      extendPartials(ractive.partials, parsed.p, true);\n\n      return true;\n    }\n  }\n};\n\nfunction resetValue(ractive) {\n  const initial = ractive._config.template;\n\n  // If this isn't a dynamic template, there's nothing to do\n  if (!initial || !initial.fn) {\n    return;\n  }\n\n  const result = getDynamicTemplate(ractive, initial.fn);\n\n  // TODO deep equality check to prevent unnecessary re-rendering\n  // in the case of already-parsed templates\n  if (result !== initial.result) {\n    initial.result = result;\n    return result;\n  }\n}\n\nfunction getDynamicTemplate(ractive, fn) {\n  return fn.call(ractive, {\n    fromId: parser.fromId,\n    isParsed: parser.isParsed,\n    parse(template, options = parser.getParseOptions(ractive)) {\n      return parser.parse(template, options);\n    }\n  });\n}\n\nfunction parseTemplate(template, ractive) {\n  if (isString(template)) {\n    // parse will validate and add expression functions\n    template = parseAsString(template, ractive);\n  } else {\n    // need to validate and add exp for already parsed template\n    validate(template);\n    addFunctions(template);\n  }\n\n  return template;\n}\n\nfunction parseAsString(template, ractive) {\n  // ID of an element containing the template?\n  if (template[0] === '#') {\n    template = parser.fromId(template);\n  }\n\n  return parser.parseFor(template, ractive);\n}\n\nfunction validate(template) {\n  // Check that the template even exists\n  if (template == undefined) {\n    throw new Error(`The template cannot be ${template}.`);\n  } else if (!isNumber(template.v)) {\n    // Check the parsed template has a version at all\n    throw new Error(\n      \"The template parser was passed a non-string template, but the template doesn't have a version.  Make sure you're passing in the template you think you are.\"\n    );\n  } else if (template.v !== TEMPLATE_VERSION) {\n    // Check we're using the correct version\n    throw new Error(\n      `Mismatched template version (expected ${TEMPLATE_VERSION}, got ${\n        template.v\n      }) Please ensure you are using the latest version of Ractive.js in your build process as well as in your app`\n    );\n  }\n}\n\nfunction extendPartials(existingPartials, newPartials, overwrite) {\n  if (!newPartials) return;\n\n  // TODO there's an ambiguity here - we need to overwrite in the `reset()`\n  // case, but not initially...\n\n  for (const key in newPartials) {\n    if (overwrite || !hasOwn(existingPartials, key)) {\n      existingPartials[key] = newPartials[key];\n    }\n  }\n}\n","import { assign, create, keys } from 'utils/object';\nimport { addFunctions } from 'shared/getFunction';\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'computed',\n  'decorators',\n  'easing',\n  'events',\n  'helpers',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nconst registriesOnDefaults = ['computed', 'helpers'];\n\nclass Registry {\n  constructor(name, useDefaults) {\n    this.name = name;\n    this.useDefaults = useDefaults;\n  }\n\n  extend(Parent, proto, options) {\n    const parent = this.useDefaults ? Parent.defaults : Parent;\n    const target = this.useDefaults ? proto : proto.constructor;\n    this.configure(parent, target, options);\n  }\n\n  init() {\n    // noop\n  }\n\n  configure(Parent, target, options) {\n    const name = this.name;\n    const option = options[name];\n\n    const registry = create(Parent[name]);\n\n    assign(registry, option);\n\n    target[name] = registry;\n\n    if (name === 'partials' && target[name]) {\n      keys(target[name]).forEach(key => {\n        addFunctions(target[name][key]);\n      });\n    }\n  }\n\n  reset(ractive) {\n    const registry = ractive[this.name];\n    let changed = false;\n\n    keys(registry).forEach(key => {\n      const item = registry[key];\n\n      if (item._fn) {\n        if (item._fn.isOwner) {\n          registry[key] = item._fn;\n        } else {\n          delete registry[key];\n        }\n        changed = true;\n      }\n    });\n\n    return changed;\n  }\n}\n\nconst registries = registryNames.map(name => {\n  const putInDefaults = registriesOnDefaults.indexOf(name) > -1;\n  return new Registry(name, putInDefaults);\n});\n\nexport default registries;\n","import { warnIfDebug } from 'utils/log';\nimport adaptConfigurator from './custom/adapt';\nimport cssConfigurator from './custom/css/css';\nimport dataConfigurator from './custom/data';\nimport templateConfigurator from './custom/template';\nimport defaults from './defaults';\nimport registries from './registries';\nimport wrapPrototype from './wrapPrototypeMethod';\nimport deprecate from './deprecate';\nimport RactiveProto from '../prototype';\nimport { hasOwn, keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\nimport hooks from 'src/events/Hook';\n\nconst config = {\n  extend: (Parent, proto, options, Child) => configure('extend', Parent, proto, options, Child),\n  init: (Parent, ractive, options) => configure('init', Parent, ractive, options),\n  reset: ractive => order.filter(c => c.reset && c.reset(ractive)).map(c => c.name)\n};\n\nconst custom = {\n  adapt: adaptConfigurator,\n  computed: config,\n  css: cssConfigurator,\n  data: dataConfigurator,\n  helpers: config,\n  template: templateConfigurator\n};\n\nconst defaultKeys = keys(defaults);\n\nconst isStandardKey = makeObj(defaultKeys.filter(key => !custom[key]));\n\n// blacklisted keys that we don't double extend\nconst isBlacklisted = makeObj(\n  defaultKeys.concat(registries.map(r => r.name), ['on', 'observe', 'attributes', 'cssData', 'use'])\n);\n\nconst order = [].concat(\n  defaultKeys.filter(key => !registries[key] && !custom[key]),\n  registries,\n  //custom.data,\n  custom.template,\n  custom.css\n);\n\nfunction configure(method, Parent, target, options, Child) {\n  deprecate(options);\n\n  for (const key in options) {\n    if (hasOwn(isStandardKey, key)) {\n      const value = options[key];\n\n      // warn the developer if they passed a function and ignore its value\n\n      // NOTE: we allow some functions on \"el\" because we duck type element lists\n      // and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n      // function object as the result of querySelector methods\n      if (key !== 'el' && isFunction(value)) {\n        warnIfDebug(\n          `${key} is a Ractive option that does not expect a function and will be ignored`,\n          method === 'init' ? target : null\n        );\n      } else {\n        target[key] = value;\n      }\n    }\n  }\n\n  // disallow combination of `append` and `enhance`\n  if (target.append && target.enhance) {\n    throw new Error('Cannot use append and enhance at the same time');\n  }\n\n  registries.forEach(registry => {\n    registry[method](Parent, target, options, Child);\n  });\n\n  adaptConfigurator[method](Parent, target, options, Child);\n  templateConfigurator[method](Parent, target, options, Child);\n  cssConfigurator[method](Parent, target, options, Child);\n\n  extendOtherMethods(Parent.prototype, target, options);\n}\n\nconst _super = /\\b_super\\b/;\nfunction extendOtherMethods(parent, target, options) {\n  for (const key in options) {\n    if (!isBlacklisted[key] && hasOwn(options, key)) {\n      let member = options[key];\n\n      // if this is a method that overwrites a method, wrap it:\n      if (isFunction(member)) {\n        if (\n          (key in RactiveProto ||\n            (key.slice(0, 2) === 'on' && key.slice(2) in hooks && key in target)) &&\n          !_super.test(member.toString())\n        ) {\n          warnIfDebug(\n            `Overriding Ractive prototype function '${key}' without calling the '${_super}' method can be very dangerous.`\n          );\n        }\n        member = wrapPrototype(parent, key, member);\n      }\n\n      target[key] = member;\n    }\n  }\n}\n\nfunction makeObj(array) {\n  const obj = {};\n  array.forEach(x => (obj[x] = true));\n  return obj;\n}\n\nexport default config;\n","import { createDocumentFragment } from 'utils/dom';\nimport noop from 'utils/noop';\n\nexport default class Item {\n  constructor(options) {\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n\n    this.template = options.template;\n    this.index = options.index;\n    this.type = options.template.t;\n\n    this.dirty = false;\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  find() {\n    return null;\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  findNextNode() {\n    return this.up.findNextNode(this);\n  }\n\n  rebound(update) {\n    if (this.fragment) this.fragment.rebound(update);\n  }\n\n  shuffled() {\n    if (this.fragment) this.fragment.shuffled();\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n}\n\nItem.prototype.findAll = noop;\nItem.prototype.findAllComponents = noop;\n\nexport class ContainerItem extends Item {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    return this.fragment ? this.fragment.detach() : createDocumentFragment();\n  }\n\n  find(selector) {\n    if (this.fragment) {\n      return this.fragment.find(selector);\n    }\n  }\n\n  findAll(selector, options) {\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findComponent(name) {\n    if (this.fragment) {\n      return this.fragment.findComponent(name);\n    }\n  }\n\n  findAllComponents(name, options) {\n    if (this.fragment) {\n      this.fragment.findAllComponents(name, options);\n    }\n  }\n\n  firstNode(skipParent) {\n    return this.fragment && this.fragment.firstNode(skipParent);\n  }\n\n  toString(escape) {\n    return this.fragment ? this.fragment.toString(escape) : '';\n  }\n}\n","import { capture } from 'src/global/capture';\nimport Model from './Model';\nimport { handleChange, mark, marked } from 'shared/methodCallers';\nimport { hasOwn } from 'utils/object';\n\nexport default class ComputationChild extends Model {\n  constructor(parent, key) {\n    super(parent, key);\n\n    this.isReadonly = !this.root.ractive.syncComputedChildren;\n    this.dirty = true;\n    this.isComputed = true;\n  }\n\n  get setRoot() {\n    return this.parent.setRoot;\n  }\n\n  applyValue(value) {\n    super.applyValue(value);\n\n    if (!this.isReadonly) {\n      let source = this.parent;\n      // computed models don't have a shuffle method\n      while (source && source.shuffle) {\n        source = source.parent;\n      }\n\n      if (source) {\n        source.dependencies.forEach(mark);\n      }\n    }\n\n    if (this.setRoot) {\n      this.setRoot.set(this.setRoot.value);\n    }\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      this.dirty = false;\n      const parentValue = this.parent.get();\n      this.value = parentValue ? parentValue[this.key] : undefined;\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    }\n\n    return (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n      ? this.wrapperValue\n      : this.value;\n  }\n\n  handleChange() {\n    if (this.dirty) return;\n    this.dirty = true;\n\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n    this.deps.forEach(handleChange);\n    this.children.forEach(handleChange);\n  }\n\n  joinKey(key) {\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new ComputationChild(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n}\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { capture, startCapturing, stopCapturing } from 'src/global/capture';\nimport { warnIfDebug } from 'utils/log';\nimport Model, { shared } from './Model';\nimport { maybeBind, noVirtual } from './ModelBase';\nimport ComputationChild from './ComputationChild';\nimport { hasConsole } from 'config/environment';\nimport { isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\n\nexport default class Computation extends Model {\n  constructor(parent, signature, key) {\n    super(parent, key);\n\n    this.signature = signature;\n\n    this.isReadonly = !this.signature.setter;\n    this.isComputed = true;\n\n    this.dependencies = [];\n\n    this.children = [];\n    this.childByKey = {};\n\n    this.deps = [];\n\n    this.dirty = true;\n\n    // TODO: is there a less hackish way to do this?\n    this.shuffle = undefined;\n  }\n\n  get setRoot() {\n    if (this.signature.setter) return this;\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      this.dirty = false;\n      const old = this.value;\n      this.value = this.getValue();\n      // this may cause a view somewhere to update, so it must be in a runloop\n      if (!runloop.active()) {\n        runloop.start();\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n        runloop.end();\n      } else {\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n      }\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    }\n\n    // if capturing, this value needs to be unwrapped because it's for external use\n    return maybeBind(\n      this,\n      // if unwrap is supplied, it overrides capture\n      this.wrapper && (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture)\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  getContext() {\n    return this.parent.isRoot ? this.root.ractive : this.parent.get(false, noVirtual);\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      result = this.signature.getter.call(this.root.ractive, this.getContext());\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n\n      // TODO this is all well and good in Chrome, but...\n      // ...also, should encapsulate this stuff better, and only\n      // show it if Ractive.DEBUG\n      if (hasConsole) {\n        if (console.groupCollapsed)\n          console.groupCollapsed(\n            '%cshow details',\n            'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n          );\n        const sig = this.signature;\n        console.error(\n          `${err.name}: ${err.message}\\n\\n${sig.getterString}${\n            sig.getterUseStack ? '\\n\\n' + err.stack : ''\n          }`\n        );\n        if (console.groupCollapsed) console.groupEnd();\n      }\n    }\n\n    const dependencies = stopCapturing();\n    this.setDependencies(dependencies);\n\n    return result;\n  }\n\n  mark() {\n    this.handleChange();\n  }\n\n  rebind(next, previous) {\n    // computations will grab all of their deps again automagically\n    if (next !== previous) this.handleChange();\n  }\n\n  set(value) {\n    if (this.isReadonly) {\n      throw new Error(`Cannot set read-only computed value '${this.key}'`);\n    }\n\n    this.signature.setter(value);\n    this.mark();\n  }\n\n  setDependencies(dependencies) {\n    // unregister any soft dependencies we no longer have\n    let i = this.dependencies.length;\n    while (i--) {\n      const model = this.dependencies[i];\n      if (!~dependencies.indexOf(model)) model.unregister(this);\n    }\n\n    // and add any new ones\n    i = dependencies.length;\n    while (i--) {\n      const model = dependencies[i];\n      if (!~this.dependencies.indexOf(model)) model.register(this);\n    }\n\n    this.dependencies = dependencies;\n  }\n\n  teardown() {\n    let i = this.dependencies.length;\n    while (i--) {\n      if (this.dependencies[i]) this.dependencies[i].unregister(this);\n    }\n    if (this.parent.computed[this.key] === this) delete this.parent.computed[this.key];\n    super.teardown();\n  }\n}\n\nconst prototype = Computation.prototype;\nconst child = ComputationChild.prototype;\nprototype.handleChange = child.handleChange;\nprototype.joinKey = child.joinKey;\n\nshared.Computation = Computation;\n","import { removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport { warnIfDebug } from 'utils/log';\nimport Model from 'src/model/Model';\nimport Computation from 'src/model/Computation';\nimport { startCapturing, stopCapturing } from 'src/global/capture';\nimport getFunction from 'shared/getFunction';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from './resolveReference';\n\nexport default class ExpressionProxy extends Model {\n  constructor(fragment, template) {\n    super(fragment.ractive.viewmodel, null);\n\n    this.fragment = fragment;\n    this.template = template;\n\n    this.isReadonly = true;\n    this.isComputed = true;\n    this.dirty = true;\n\n    this.fn =\n      fragment.ractive.allowExpressions === false\n        ? noop\n        : getFunction(template.s, template.r.length);\n\n    this.models = this.template.r.map(ref => {\n      return resolveReference(this.fragment, ref);\n    });\n    this.dependencies = [];\n\n    this.shuffle = undefined;\n\n    this.bubble();\n  }\n\n  bubble(actuallyChanged = true) {\n    // refresh the keypath\n    this.keypath = undefined;\n\n    if (actuallyChanged) {\n      this.handleChange();\n    }\n  }\n\n  getKeypath() {\n    if (!this.template) return '@undefined';\n    if (!this.keypath) {\n      this.keypath =\n        '@' +\n        this.template.s.replace(/_(\\d+)/g, (match, i) => {\n          if (i >= this.models.length) return match;\n\n          const model = this.models[i];\n          return model ? model.getKeypath() : '@undefined';\n        });\n    }\n\n    return this.keypath;\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      const params = this.models.map(m => (m ? m.get(true) : undefined));\n      result = this.fn.apply(this.fragment.ractive, params);\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n    }\n\n    const dependencies = stopCapturing();\n    // remove missing deps\n    this.dependencies\n      .filter(d => !~dependencies.indexOf(d))\n      .forEach(d => {\n        d.unregister(this);\n        removeFromArray(this.dependencies, d);\n      });\n    // register new deps\n    dependencies\n      .filter(d => !~this.dependencies.indexOf(d))\n      .forEach(d => {\n        d.register(this);\n        this.dependencies.push(d);\n      });\n\n    return result;\n  }\n\n  notifyUpstream() {}\n\n  rebind(next, previous, safe) {\n    const idx = this.models.indexOf(previous);\n\n    if (~idx) {\n      next = rebindMatch(this.template.r[idx], next, previous);\n      if (next !== previous) {\n        previous.unregister(this);\n        this.models.splice(idx, 1, next);\n        if (next) next.addShuffleRegister(this, 'mark');\n      }\n    }\n    this.bubble(!safe);\n  }\n\n  rebound(update) {\n    this.models = this.template.r.map(ref => resolveReference(this.fragment, ref));\n    if (update) this.bubble(true);\n  }\n\n  retrieve() {\n    return this.get();\n  }\n\n  teardown() {\n    this.fragment = undefined;\n    if (this.dependencies) this.dependencies.forEach(d => d.unregister(this));\n    super.teardown();\n  }\n\n  unreference() {\n    super.unreference();\n    collect(this);\n  }\n\n  unregister(dep) {\n    super.unregister(dep);\n    collect(this);\n  }\n\n  unregisterLink(link) {\n    super.unregisterLink(link);\n    collect(this);\n  }\n}\n\nconst prototype = ExpressionProxy.prototype;\nconst computation = Computation.prototype;\nprototype.get = computation.get;\nprototype.handleChange = computation.handleChange;\nprototype.joinKey = computation.joinKey;\nprototype.mark = computation.mark;\nprototype.unbind = noop;\n\nfunction collect(model) {\n  if (!model.deps.length && !model.refs && !model.links.length) model.teardown();\n}\n","import { fireShuffleTasks } from 'src/model/ModelBase';\nimport { REFERENCE } from 'config/types';\nimport { rebindMatch } from 'shared/rebind';\nimport { isArray, isString } from 'utils/is';\nimport { escapeKey } from 'shared/keypaths';\nimport ExpressionProxy from './ExpressionProxy';\nimport resolveReference from './resolveReference';\nimport resolve from './resolve';\n\nimport LinkModel, { Missing } from 'src/model/LinkModel';\n\nexport default class ReferenceExpressionProxy extends LinkModel {\n  constructor(fragment, template) {\n    super(null, null, null, '@undefined');\n    this.root = fragment.ractive.viewmodel;\n    this.template = template;\n    this.rootLink = true;\n    this.template = template;\n    this.fragment = fragment;\n\n    this.rebound();\n  }\n\n  getKeypath() {\n    return this.model ? this.model.getKeypath() : '@undefined';\n  }\n\n  rebound() {\n    const fragment = this.fragment;\n    const template = this.template;\n\n    let base = (this.base = resolve(fragment, template));\n    let idx;\n\n    if (this.proxy) {\n      teardown(this);\n    }\n\n    const proxy = (this.proxy = {\n      rebind: (next, previous) => {\n        if (previous === base) {\n          next = rebindMatch(template, next, previous);\n          if (next !== base) {\n            this.base = base = next;\n          }\n        } else if (~(idx = members.indexOf(previous))) {\n          next = rebindMatch(template.m[idx].n, next, previous);\n          if (next !== members[idx]) {\n            members.splice(idx, 1, next || Missing);\n          }\n        }\n\n        if (next !== previous) {\n          previous.unregister(proxy);\n          if (next) next.addShuffleTask(() => next.register(proxy));\n        }\n      },\n      handleChange: () => {\n        pathChanged();\n      }\n    });\n\n    base.register(proxy);\n\n    const members = (this.members = template.m.map(tpl => {\n      if (isString(tpl)) {\n        return { get: () => tpl };\n      }\n\n      let model;\n\n      if (tpl.t === REFERENCE) {\n        model = resolveReference(fragment, tpl.n);\n        model.register(proxy);\n\n        return model;\n      }\n\n      model = new ExpressionProxy(fragment, tpl);\n      model.register(proxy);\n      return model;\n    }));\n\n    const pathChanged = () => {\n      const model = base.joinAll(\n        members.reduce((list, m) => {\n          const k = m.get();\n          if (isArray(k)) return list.concat(k);\n          else list.push(escapeKey(String(k)));\n          return list;\n        }, [])\n      );\n\n      if (model !== this.model) {\n        this.model = model;\n        this.relinking(model);\n        fireShuffleTasks();\n        refreshPathDeps(this);\n      }\n    };\n\n    pathChanged();\n  }\n\n  teardown() {\n    teardown(this);\n    super.teardown();\n  }\n\n  unreference() {\n    super.unreference();\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n\n  unregister(dep) {\n    super.unregister(dep);\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n}\n\nfunction teardown(proxy) {\n  if (proxy.base) proxy.base.unregister(proxy.proxy);\n  if (proxy.models) {\n    proxy.models.forEach(m => {\n      if (m.unregister) m.unregister(proxy);\n    });\n  }\n}\n\nfunction refreshPathDeps(proxy) {\n  let len = proxy.deps.length;\n  let i, v;\n\n  for (i = 0; i < len; i++) {\n    v = proxy.deps[i];\n    if (v.pathChanged) v.pathChanged();\n    if (v.fragment && v.fragment.pathModel) v.fragment.pathModel.applyValue(proxy.getKeypath());\n  }\n\n  len = proxy.children.length;\n  for (i = 0; i < len; i++) {\n    refreshPathDeps(proxy.children[i]);\n  }\n}\n\nconst eproto = ExpressionProxy.prototype;\nconst proto = ReferenceExpressionProxy.prototype;\n\nproto.unreference = eproto.unreference;\nproto.unregister = eproto.unregister;\nproto.unregisterLink = eproto.unregisterLink;\n","import Fragment from '../Fragment';\nimport { ContainerItem } from './shared/Item';\nimport resolve from '../resolvers/resolve';\n\nexport function resolveAliases(aliases, fragment, dest = {}) {\n  for (let i = 0; i < aliases.length; i++) {\n    if (!dest[aliases[i].n]) {\n      const m = resolve(fragment, aliases[i].x);\n      dest[aliases[i].n] = m;\n      m.reference();\n    }\n  }\n\n  return dest;\n}\n\nexport default class Alias extends ContainerItem {\n  constructor(options) {\n    super(options);\n\n    this.fragment = null;\n  }\n\n  bind() {\n    this.fragment = new Fragment({\n      owner: this,\n      template: this.template.f\n    });\n\n    this.fragment.aliases = resolveAliases(this.template.z, this.up);\n    this.fragment.bind();\n  }\n\n  rebound(update) {\n    const aliases = this.fragment.aliases;\n    for (const k in aliases) {\n      if (aliases[k].rebound) aliases[k].rebound(update);\n      else {\n        aliases[k].unreference();\n        aliases[k] = 0;\n      }\n    }\n\n    resolveAliases(this.template.z, this.up, aliases);\n\n    if (this.fragment) this.fragment.rebound(update);\n  }\n\n  render(target, occupants) {\n    this.rendered = true;\n    if (this.fragment) this.fragment.render(target, occupants);\n  }\n\n  unbind(view) {\n    for (const k in this.fragment.aliases) {\n      this.fragment.aliases[k].unreference();\n    }\n\n    this.fragment.aliases = {};\n    if (this.fragment) this.fragment.unbind(view);\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      this.fragment.update();\n    }\n  }\n}\n","import { keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\n// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\n//export const booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\nexport const booleanAttributes = {\n  allowfullscreen: 1,\n  async: 1,\n  autofocus: 1,\n  autoplay: 1,\n  checked: 1,\n  compact: 1,\n  controls: 1,\n  declare: 1,\n  default: 1,\n  defaultchecked: 1,\n  defaultmuted: 1,\n  defaultselected: 1,\n  defer: 1,\n  disabled: 1,\n  enabled: 1,\n  formnovalidate: 1,\n  hidden: 1,\n  indeterminate: 1,\n  inert: 1,\n  ismap: 1,\n  itemscope: 1,\n  loop: 1,\n  multiple: 1,\n  muted: 1,\n  nohref: 1,\n  noresize: 1,\n  noshade: 1,\n  novalidate: 1,\n  nowrap: 1,\n  open: 1,\n  pauseonexit: 1,\n  readonly: 1,\n  required: 1,\n  reversed: 1,\n  scoped: 1,\n  seamless: 1,\n  selected: 1,\n  sortable: 1,\n  translate: 1,\n  truespeed: 1,\n  typemustmatch: 1,\n  visible: 1\n};\nexport const voidElements = {\n  area: 1,\n  base: 1,\n  br: 1,\n  col: 1,\n  command: 1,\n  doctype: 1,\n  embed: 1,\n  hr: 1,\n  img: 1,\n  input: 1,\n  keygen: 1,\n  link: 1,\n  meta: 1,\n  param: 1,\n  source: 1,\n  track: 1,\n  wbr: 1\n};\n\nconst htmlEntities = {\n  quot: 34,\n  amp: 38,\n  apos: 39,\n  lt: 60,\n  gt: 62,\n  nbsp: 160,\n  iexcl: 161,\n  cent: 162,\n  pound: 163,\n  curren: 164,\n  yen: 165,\n  brvbar: 166,\n  sect: 167,\n  uml: 168,\n  copy: 169,\n  ordf: 170,\n  laquo: 171,\n  not: 172,\n  shy: 173,\n  reg: 174,\n  macr: 175,\n  deg: 176,\n  plusmn: 177,\n  sup2: 178,\n  sup3: 179,\n  acute: 180,\n  micro: 181,\n  para: 182,\n  middot: 183,\n  cedil: 184,\n  sup1: 185,\n  ordm: 186,\n  raquo: 187,\n  frac14: 188,\n  frac12: 189,\n  frac34: 190,\n  iquest: 191,\n  Agrave: 192,\n  Aacute: 193,\n  Acirc: 194,\n  Atilde: 195,\n  Auml: 196,\n  Aring: 197,\n  AElig: 198,\n  Ccedil: 199,\n  Egrave: 200,\n  Eacute: 201,\n  Ecirc: 202,\n  Euml: 203,\n  Igrave: 204,\n  Iacute: 205,\n  Icirc: 206,\n  Iuml: 207,\n  ETH: 208,\n  Ntilde: 209,\n  Ograve: 210,\n  Oacute: 211,\n  Ocirc: 212,\n  Otilde: 213,\n  Ouml: 214,\n  times: 215,\n  Oslash: 216,\n  Ugrave: 217,\n  Uacute: 218,\n  Ucirc: 219,\n  Uuml: 220,\n  Yacute: 221,\n  THORN: 222,\n  szlig: 223,\n  agrave: 224,\n  aacute: 225,\n  acirc: 226,\n  atilde: 227,\n  auml: 228,\n  aring: 229,\n  aelig: 230,\n  ccedil: 231,\n  egrave: 232,\n  eacute: 233,\n  ecirc: 234,\n  euml: 235,\n  igrave: 236,\n  iacute: 237,\n  icirc: 238,\n  iuml: 239,\n  eth: 240,\n  ntilde: 241,\n  ograve: 242,\n  oacute: 243,\n  ocirc: 244,\n  otilde: 245,\n  ouml: 246,\n  divide: 247,\n  oslash: 248,\n  ugrave: 249,\n  uacute: 250,\n  ucirc: 251,\n  uuml: 252,\n  yacute: 253,\n  thorn: 254,\n  yuml: 255,\n  OElig: 338,\n  oelig: 339,\n  Scaron: 352,\n  scaron: 353,\n  Yuml: 376,\n  fnof: 402,\n  circ: 710,\n  tilde: 732,\n  Alpha: 913,\n  Beta: 914,\n  Gamma: 915,\n  Delta: 916,\n  Epsilon: 917,\n  Zeta: 918,\n  Eta: 919,\n  Theta: 920,\n  Iota: 921,\n  Kappa: 922,\n  Lambda: 923,\n  Mu: 924,\n  Nu: 925,\n  Xi: 926,\n  Omicron: 927,\n  Pi: 928,\n  Rho: 929,\n  Sigma: 931,\n  Tau: 932,\n  Upsilon: 933,\n  Phi: 934,\n  Chi: 935,\n  Psi: 936,\n  Omega: 937,\n  alpha: 945,\n  beta: 946,\n  gamma: 947,\n  delta: 948,\n  epsilon: 949,\n  zeta: 950,\n  eta: 951,\n  theta: 952,\n  iota: 953,\n  kappa: 954,\n  lambda: 955,\n  mu: 956,\n  nu: 957,\n  xi: 958,\n  omicron: 959,\n  pi: 960,\n  rho: 961,\n  sigmaf: 962,\n  sigma: 963,\n  tau: 964,\n  upsilon: 965,\n  phi: 966,\n  chi: 967,\n  psi: 968,\n  omega: 969,\n  thetasym: 977,\n  upsih: 978,\n  piv: 982,\n  ensp: 8194,\n  emsp: 8195,\n  thinsp: 8201,\n  zwnj: 8204,\n  zwj: 8205,\n  lrm: 8206,\n  rlm: 8207,\n  ndash: 8211,\n  mdash: 8212,\n  lsquo: 8216,\n  rsquo: 8217,\n  sbquo: 8218,\n  ldquo: 8220,\n  rdquo: 8221,\n  bdquo: 8222,\n  dagger: 8224,\n  Dagger: 8225,\n  bull: 8226,\n  hellip: 8230,\n  permil: 8240,\n  prime: 8242,\n  Prime: 8243,\n  lsaquo: 8249,\n  rsaquo: 8250,\n  oline: 8254,\n  frasl: 8260,\n  euro: 8364,\n  image: 8465,\n  weierp: 8472,\n  real: 8476,\n  trade: 8482,\n  alefsym: 8501,\n  larr: 8592,\n  uarr: 8593,\n  rarr: 8594,\n  darr: 8595,\n  harr: 8596,\n  crarr: 8629,\n  lArr: 8656,\n  uArr: 8657,\n  rArr: 8658,\n  dArr: 8659,\n  hArr: 8660,\n  forall: 8704,\n  part: 8706,\n  exist: 8707,\n  empty: 8709,\n  nabla: 8711,\n  isin: 8712,\n  notin: 8713,\n  ni: 8715,\n  prod: 8719,\n  sum: 8721,\n  minus: 8722,\n  lowast: 8727,\n  radic: 8730,\n  prop: 8733,\n  infin: 8734,\n  ang: 8736,\n  and: 8743,\n  or: 8744,\n  cap: 8745,\n  cup: 8746,\n  int: 8747,\n  there4: 8756,\n  sim: 8764,\n  cong: 8773,\n  asymp: 8776,\n  ne: 8800,\n  equiv: 8801,\n  le: 8804,\n  ge: 8805,\n  sub: 8834,\n  sup: 8835,\n  nsub: 8836,\n  sube: 8838,\n  supe: 8839,\n  oplus: 8853,\n  otimes: 8855,\n  perp: 8869,\n  sdot: 8901,\n  lceil: 8968,\n  rceil: 8969,\n  lfloor: 8970,\n  rfloor: 8971,\n  lang: 9001,\n  rang: 9002,\n  loz: 9674,\n  spades: 9824,\n  clubs: 9827,\n  hearts: 9829,\n  diams: 9830\n};\nconst controlCharacters = [\n  8364,\n  129,\n  8218,\n  402,\n  8222,\n  8230,\n  8224,\n  8225,\n  710,\n  8240,\n  352,\n  8249,\n  338,\n  141,\n  381,\n  143,\n  144,\n  8216,\n  8217,\n  8220,\n  8221,\n  8226,\n  8211,\n  8212,\n  732,\n  8482,\n  353,\n  8250,\n  339,\n  157,\n  382,\n  376\n];\nconst entityPattern = new RegExp(\n  '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + keys(htmlEntities).join('|') + '));?',\n  'g'\n);\nconst codePointSupport = isFunction(String.fromCodePoint);\nconst codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\n\nexport function decodeCharacterReferences(html) {\n  return html.replace(entityPattern, (match, entity) => {\n    let code;\n\n    // Handle named entities\n    if (entity[0] !== '#') {\n      code = htmlEntities[entity];\n    } else if (entity[1] === 'x') {\n      code = parseInt(entity.substring(2), 16);\n    } else {\n      code = parseInt(entity.substring(1), 10);\n    }\n\n    if (!code) {\n      return match;\n    }\n\n    return codeToChar(validateCode(code));\n  });\n}\n\nconst lessThan = /</g;\nconst greaterThan = />/g;\nconst amp = /&/g;\nconst invalid = 65533;\n\nexport function escapeHtml(str) {\n  return str\n    .replace(amp, '&amp;')\n    .replace(lessThan, '&lt;')\n    .replace(greaterThan, '&gt;');\n}\n\n// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n// to replace them ourselves\n//\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\n/* istanbul ignore next */\nfunction validateCode(code) {\n  if (!code) {\n    return invalid;\n  }\n\n  // line feed becomes generic whitespace\n  if (code === 10) {\n    return 32;\n  }\n\n  // ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n  if (code < 128) {\n    return code;\n  }\n\n  // code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n  // to correct the mistake or we'll end up with missing  signs and so on\n  if (code <= 159) {\n    return controlCharacters[code - 128];\n  }\n\n  // basic multilingual plane\n  if (code < 55296) {\n    return code;\n  }\n\n  // UTF-16 surrogate halves\n  if (code <= 57343) {\n    return invalid;\n  }\n\n  // rest of the basic multilingual plane\n  if (code <= 65535) {\n    return code;\n  } else if (!codePointSupport) {\n    return invalid;\n  }\n\n  // supplementary multilingual plane 0x10000 - 0x1ffff\n  if (code >= 65536 && code <= 131071) {\n    return code;\n  }\n\n  // supplementary ideographic plane 0x20000 - 0x2ffff\n  if (code >= 131072 && code <= 196607) {\n    return code;\n  }\n\n  return invalid;\n}\n","import cleanCss from 'utils/cleanCss';\nimport { isString } from 'utils/is';\n\nconst space = /\\s+/;\n\nexport function readStyle(css) {\n  if (!isString(css)) return {};\n\n  return cleanCss(css, (css, reconstruct) => {\n    return css\n      .split(';')\n      .filter(rule => !!rule.trim())\n      .map(reconstruct)\n      .reduce((rules, rule) => {\n        const i = rule.indexOf(':');\n        const name = rule.substr(0, i).trim();\n        rules[name] = rule.substr(i + 1).trim();\n        return rules;\n      }, {});\n  });\n}\n\nexport function readClass(str) {\n  const list = str.split(space);\n\n  // remove any empty entries\n  let i = list.length;\n  while (i--) {\n    if (!list[i]) list.splice(i, 1);\n  }\n\n  return list;\n}\n","import { html } from 'config/namespaces';\nimport { safeToStringValue } from 'utils/dom';\nimport { arrayContains } from 'utils/array';\nimport noop from 'utils/noop';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport { readStyle, readClass } from 'src/view/helpers/specialAttrs';\nimport { keys as objectKeys } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\n\nconst textTypes = [\n  undefined,\n  'text',\n  'search',\n  'url',\n  'email',\n  'hidden',\n  'password',\n  'search',\n  'reset',\n  'submit'\n];\n\nexport default function getUpdateDelegate(attribute) {\n  const { element, name } = attribute;\n\n  if (name === 'value') {\n    if (attribute.interpolator) attribute.interpolator.bound = true;\n\n    // special case - selects\n    if (element.name === 'select' && name === 'value') {\n      return element.getAttribute('multiple') ? updateMultipleSelectValue : updateSelectValue;\n    }\n\n    if (element.name === 'textarea') return updateStringValue;\n\n    // special case - contenteditable\n    if (element.getAttribute('contenteditable') != null) return updateContentEditableValue;\n\n    // special case - <input>\n    if (element.name === 'input') {\n      const type = element.getAttribute('type');\n\n      // type='file' value='{{fileList}}'>\n      if (type === 'file') return noop; // read-only\n\n      // type='radio' name='{{twoway}}'\n      if (type === 'radio' && element.binding && element.binding.attribute.name === 'name')\n        return updateRadioValue;\n\n      if (~textTypes.indexOf(type)) return updateStringValue;\n    }\n\n    return updateValue;\n  }\n\n  const node = element.node;\n\n  // special case - <input type='radio' name='{{twoway}}' value='foo'>\n  if (attribute.isTwoway && name === 'name') {\n    if (node.type === 'radio') return updateRadioName;\n    if (node.type === 'checkbox') return updateCheckboxName;\n  }\n\n  if (name === 'style') return updateStyleAttribute;\n\n  if (name.indexOf('style-') === 0) return updateInlineStyle;\n\n  // special case - class names. IE fucks things up, again\n  if (name === 'class' && (!node.namespaceURI || node.namespaceURI === html))\n    return updateClassName;\n\n  if (name.indexOf('class-') === 0) return updateInlineClass;\n\n  if (attribute.isBoolean) {\n    const type = element.getAttribute('type');\n    if (attribute.interpolator && name === 'checked' && (type === 'checkbox' || type === 'radio'))\n      attribute.interpolator.bound = true;\n    return updateBoolean;\n  }\n\n  if (attribute.namespace && attribute.namespace !== attribute.node.namespaceURI)\n    return updateNamespacedAttribute;\n\n  return updateAttribute;\n}\n\nfunction updateMultipleSelectValue(reset) {\n  let value = this.getValue();\n\n  if (!isArray(value)) value = [value];\n\n  const options = this.node.options;\n  let i = options.length;\n\n  if (reset) {\n    while (i--) options[i].selected = false;\n  } else {\n    while (i--) {\n      const option = options[i];\n      const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n\n      option.selected = arrayContains(value, optionValue);\n    }\n  }\n}\n\nfunction updateSelectValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    // TODO is locked still a thing?\n    this.node._ractive.value = value;\n\n    const options = this.node.options;\n    let i = options.length;\n    let wasSelected = false;\n\n    if (reset) {\n      while (i--) options[i].selected = false;\n    } else {\n      while (i--) {\n        const option = options[i];\n        const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n        if (option.disabled && option.selected) wasSelected = true;\n\n        if (optionValue == value) {\n          // double equals as we may be comparing numbers with strings\n          option.selected = true;\n          return;\n        }\n      }\n    }\n\n    if (!wasSelected) this.node.selectedIndex = -1;\n  }\n}\n\nfunction updateContentEditableValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    if (reset) this.node.innerHTML = '';\n    else this.node.innerHTML = value === undefined ? '' : value;\n  }\n}\n\nfunction updateRadioValue(reset) {\n  const node = this.node;\n  const wasChecked = node.checked;\n\n  const value = this.getValue();\n\n  if (reset) return (node.checked = false);\n\n  //node.value = this.element.getAttribute( 'value' );\n  node.value = this.node._ractive.value = value;\n  node.checked = this.element.compare(value, this.element.getAttribute('name'));\n\n  // This is a special case - if the input was checked, and the value\n  // changed so that it's no longer checked, the twoway binding is\n  // most likely out of date. To fix it we have to jump through some\n  // hoops... this is a little kludgy but it works\n  if (wasChecked && !node.checked && this.element.binding && this.element.binding.rendered) {\n    this.element.binding.group.model.set(this.element.binding.group.getValue());\n  }\n}\n\nfunction updateValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node.removeAttribute('value');\n      this.node.value = this.node._ractive.value = null;\n    } else {\n      const value = this.getValue();\n\n      this.node.value = this.node._ractive.value = value;\n      this.node.setAttribute('value', safeToStringValue(value));\n    }\n  }\n}\n\nfunction updateStringValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node._ractive.value = '';\n      this.node.removeAttribute('value');\n    } else {\n      const value = this.getValue();\n\n      this.node._ractive.value = value;\n\n      const safeValue = safeToStringValue(value);\n\n      // fixes #3281  Safari moves caret position when setting an input value to the same value\n      if (this.node.value !== safeValue) {\n        this.node.value = safeValue;\n      }\n\n      this.node.setAttribute('value', safeValue);\n    }\n  }\n}\n\nfunction updateRadioName(reset) {\n  if (reset) this.node.checked = false;\n  else this.node.checked = this.element.compare(this.getValue(), this.element.binding.getValue());\n}\n\nfunction updateCheckboxName(reset) {\n  const { element, node } = this;\n  const binding = element.binding;\n\n  const value = this.getValue();\n  const valueAttribute = element.getAttribute('value');\n\n  if (reset) {\n    // TODO: WAT?\n  }\n\n  if (!isArray(value)) {\n    binding.isChecked = node.checked = element.compare(value, valueAttribute);\n  } else {\n    let i = value.length;\n    while (i--) {\n      if (element.compare(valueAttribute, value[i])) {\n        binding.isChecked = node.checked = true;\n        return;\n      }\n    }\n    binding.isChecked = node.checked = false;\n  }\n}\n\nfunction updateStyleAttribute(reset) {\n  const props = reset ? {} : readStyle(this.getValue() || '');\n  const style = this.node.style;\n  const keys = objectKeys(props);\n  const prev = this.previous || [];\n\n  let i = 0;\n  while (i < keys.length) {\n    if (keys[i] in style) {\n      const safe = props[keys[i]].replace('!important', '');\n      style.setProperty(keys[i], safe, safe.length !== props[keys[i]].length ? 'important' : '');\n    }\n    i++;\n  }\n\n  // remove now-missing attrs\n  i = prev.length;\n  while (i--) {\n    if (!~keys.indexOf(prev[i]) && prev[i] in style) style.setProperty(prev[i], '', '');\n  }\n\n  this.previous = keys;\n}\n\nfunction updateInlineStyle(reset) {\n  if (!this.style) {\n    this.style = hyphenateCamel(this.name.substr(6));\n  }\n\n  if (reset && this.node.style.getPropertyValue(this.style) !== this.last) return;\n\n  const value = reset ? '' : safeToStringValue(this.getValue());\n  const safe = value.replace('!important', '');\n  this.node.style.setProperty(this.style, safe, safe.length !== value.length ? 'important' : '');\n  this.last = this.node.style.getPropertyValue(this.style);\n}\n\nfunction updateClassName(reset) {\n  const value = reset ? [] : readClass(safeToStringValue(this.getValue()));\n\n  // watch out for werdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const prev = this.previous || [];\n\n  const className = value.concat(attr.filter(c => !~prev.indexOf(c))).join(' ');\n\n  if (className !== cls) {\n    if (!isString(this.node.className)) {\n      this.node.className.baseVal = className;\n    } else {\n      this.node.className = className;\n    }\n  }\n\n  this.previous = value;\n}\n\nfunction updateInlineClass(reset) {\n  const name = this.name.substr(6);\n\n  // watch out for werdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const value = reset ? false : this.getValue();\n\n  if (!this.inlineClass) this.inlineClass = name;\n\n  if (value && !~attr.indexOf(name)) attr.push(name);\n  else if (!value && ~attr.indexOf(name)) attr.splice(attr.indexOf(name), 1);\n\n  if (!isString(this.node.className)) {\n    this.node.className.baseVal = attr.join(' ');\n  } else {\n    this.node.className = attr.join(' ');\n  }\n}\n\nfunction updateBoolean(reset) {\n  // with two-way binding, only update if the change wasn't initiated by the user\n  // otherwise the cursor will often be sent to the wrong place\n  if (!this.locked) {\n    if (reset) {\n      if (this.useProperty) this.node[this.propertyName] = false;\n      this.node.removeAttribute(this.propertyName);\n    } else {\n      if (this.useProperty) {\n        this.node[this.propertyName] = this.getValue();\n      } else {\n        const val = this.getValue();\n        if (val) {\n          this.node.setAttribute(this.propertyName, isString(val) ? val : '');\n        } else {\n          this.node.removeAttribute(this.propertyName);\n        }\n      }\n    }\n  }\n}\n\nexport function updateAttribute(reset) {\n  if (reset) {\n    if (this.node.getAttribute(this.name) === this.value) {\n      this.node.removeAttribute(this.name);\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttribute(this.name, this.value);\n  }\n}\n\nexport function updateNamespacedAttribute(reset) {\n  if (reset) {\n    if (\n      this.value ===\n      this.node.getAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1))\n    ) {\n      this.node.removeAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1));\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttributeNS(\n      this.namespace,\n      this.name.slice(this.name.indexOf(':') + 1),\n      this.value\n    );\n  }\n}\n","export default {\n  'accept-charset': 'acceptCharset',\n  accesskey: 'accessKey',\n  bgcolor: 'bgColor',\n  class: 'className',\n  codebase: 'codeBase',\n  colspan: 'colSpan',\n  contenteditable: 'contentEditable',\n  datetime: 'dateTime',\n  dirname: 'dirName',\n  for: 'htmlFor',\n  'http-equiv': 'httpEquiv',\n  ismap: 'isMap',\n  maxlength: 'maxLength',\n  novalidate: 'noValidate',\n  pubdate: 'pubDate',\n  readonly: 'readOnly',\n  rowspan: 'rowSpan',\n  tabindex: 'tabIndex',\n  usemap: 'useMap'\n};\n","import { doc } from 'config/environment';\nimport { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\n\nconst div = doc ? createElement('div') : null;\n\nlet attributes = false;\nexport function inAttributes() {\n  return attributes;\n}\n\nexport default class ConditionalAttribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.attributes = [];\n\n    this.owner = options.owner;\n\n    this.fragment = new Fragment({\n      ractive: this.ractive,\n      owner: this,\n      template: this.template\n    });\n\n    // this fragment can't participate in node-y things\n    this.fragment.findNextNode = noop;\n\n    this.dirty = false;\n  }\n\n  bind() {\n    this.fragment.bind();\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.owner.bubble();\n    }\n  }\n\n  destroyed() {\n    this.unrender();\n  }\n\n  render() {\n    this.node = this.owner.node;\n    if (this.node) {\n      this.isSvg = this.node.namespaceURI === svg;\n    }\n\n    attributes = true;\n    if (!this.rendered) this.fragment.render();\n\n    this.rendered = true;\n    this.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n    this.update();\n    attributes = false;\n  }\n\n  toString() {\n    return this.fragment.toString();\n  }\n\n  unbind(view) {\n    this.fragment.unbind(view);\n  }\n\n  unrender() {\n    this.rendered = false;\n    this.fragment.unrender();\n  }\n\n  update() {\n    let str;\n    let attrs;\n\n    if (this.dirty) {\n      this.dirty = false;\n\n      const current = attributes;\n      attributes = true;\n      this.fragment.update();\n\n      if (this.rendered && this.node) {\n        str = this.fragment.toString();\n\n        attrs = parseAttributes(str, this.isSvg);\n\n        // any attributes that previously existed but no longer do\n        // must be removed\n        this.attributes\n          .filter(a => notIn(attrs, a))\n          .forEach(a => {\n            this.node.removeAttribute(a.name);\n          });\n\n        attrs.forEach(a => {\n          this.node.setAttribute(a.name, a.value);\n        });\n\n        this.attributes = attrs;\n      }\n\n      attributes = current || false;\n    }\n  }\n}\n\nconst onlyWhitespace = /^\\s*$/;\nfunction parseAttributes(str, isSvg) {\n  if (onlyWhitespace.test(str)) return [];\n  const tagName = isSvg ? 'svg' : 'div';\n  return str\n    ? (div.innerHTML = `<${tagName} ${str}></${tagName}>`) && toArray(div.childNodes[0].attributes)\n    : [];\n}\n\nfunction notIn(haystack, needle) {\n  let i = haystack.length;\n\n  while (i--) {\n    if (haystack[i].name === needle.name) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import { INTERPOLATOR } from 'config/types';\nimport namespaces from 'config/namespaces';\nimport { safeAttributeString } from 'utils/dom';\nimport { booleanAttributes } from 'utils/html';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\nimport findElement from '../shared/findElement';\nimport getUpdateDelegate from './attribute/getUpdateDelegate';\nimport propertyNames from './attribute/propertyNames';\nimport { inAttributes } from './ConditionalAttribute';\nimport { isArray, isString } from 'utils/is';\n\nfunction lookupNamespace(node, prefix) {\n  const qualified = `xmlns:${prefix}`;\n\n  while (node) {\n    if (node.hasAttribute && node.hasAttribute(qualified)) return node.getAttribute(qualified);\n    node = node.parentNode;\n  }\n\n  return namespaces[prefix];\n}\n\nlet attribute = false;\nexport function inAttribute() {\n  return attribute;\n}\n\nexport default class Attribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n    this.namespace = null;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = options.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.rendered = false;\n    this.updateDelegate = null;\n    this.fragment = null;\n\n    this.element.attributeByName[this.name] = this;\n\n    if (!isArray(options.template.f)) {\n      this.value = options.template.f;\n      if (this.value === 0) {\n        this.value = '';\n      } else if (this.value === undefined) {\n        this.value = true;\n      }\n      return;\n    } else {\n      this.fragment = new Fragment({\n        owner: this,\n        template: options.template.f\n      });\n    }\n\n    this.interpolator =\n      this.fragment &&\n      this.fragment.items.length === 1 &&\n      this.fragment.items[0].type === INTERPOLATOR &&\n      this.fragment.items[0];\n\n    if (this.interpolator) this.interpolator.owner = this;\n  }\n\n  bind() {\n    if (this.fragment) {\n      this.fragment.bind();\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.up.bubble();\n      this.element.bubble();\n      this.dirty = true;\n    }\n  }\n\n  firstNode() {}\n\n  getString() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.toString()\n      : this.value != null\n      ? '' + this.value\n      : '';\n    attribute = false;\n    return value;\n  }\n\n  // TODO could getValue ever be called for a static attribute,\n  // or can we assume that this.fragment exists?\n  getValue() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.valueOf()\n      : booleanAttributes[this.name.toLowerCase()]\n      ? true\n      : this.value;\n    attribute = false;\n    return value;\n  }\n\n  render() {\n    const node = this.element.node;\n    this.node = node;\n\n    // should we use direct property access, or setAttribute?\n    if (!node.namespaceURI || node.namespaceURI === namespaces.html) {\n      this.propertyName = propertyNames[this.name] || this.name;\n\n      if (node[this.propertyName] !== undefined) {\n        this.useProperty = true;\n      }\n\n      // is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n      // node.selected = true rather than node.setAttribute( 'selected', '' )\n      if (booleanAttributes[this.name.toLowerCase()] || this.isTwoway) {\n        this.isBoolean = true;\n      }\n\n      if (this.propertyName === 'value') {\n        node._ractive.value = this.value;\n      }\n    }\n\n    if (node.namespaceURI) {\n      const index = this.name.indexOf(':');\n      if (index !== -1) {\n        this.namespace = lookupNamespace(node, this.name.slice(0, index));\n      } else {\n        this.namespace = node.namespaceURI;\n      }\n    }\n\n    this.rendered = true;\n    this.updateDelegate = getUpdateDelegate(this);\n    this.updateDelegate();\n  }\n\n  toString() {\n    if (inAttributes()) return '';\n    attribute = true;\n\n    const value = this.getValue();\n\n    // Special case - select and textarea values (should not be stringified)\n    if (\n      this.name === 'value' &&\n      (this.element.getAttribute('contenteditable') !== undefined ||\n        (this.element.name === 'select' || this.element.name === 'textarea'))\n    ) {\n      return;\n    }\n\n    // Special case  bound radio `name` attributes\n    if (\n      this.name === 'name' &&\n      this.element.name === 'input' &&\n      this.interpolator &&\n      this.element.getAttribute('type') === 'radio'\n    ) {\n      return `name=\"{{${this.interpolator.model.getKeypath()}}}\"`;\n    }\n\n    // Special case - style and class attributes and directives\n    if (\n      this.owner === this.element &&\n      (this.name === 'style' || this.name === 'class' || this.style || this.inlineClass)\n    ) {\n      return;\n    }\n\n    if (\n      !this.rendered &&\n      this.owner === this.element &&\n      (!this.name.indexOf('style-') || !this.name.indexOf('class-'))\n    ) {\n      if (!this.name.indexOf('style-')) {\n        this.style = hyphenateCamel(this.name.substr(6));\n      } else {\n        this.inlineClass = this.name.substr(6);\n      }\n\n      return;\n    }\n\n    if (booleanAttributes[this.name.toLowerCase()])\n      return value\n        ? isString(value)\n          ? `${this.name}=\"${safeAttributeString(value)}\"`\n          : this.name\n        : '';\n    if (value == null) return '';\n\n    const str = safeAttributeString(this.getString());\n    attribute = false;\n\n    return str ? `${this.name}=\"${str}\"` : this.name;\n  }\n\n  unbind(view) {\n    if (this.fragment) this.fragment.unbind(view);\n  }\n\n  unrender() {\n    this.updateDelegate(true);\n\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      let binding;\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      if (this.rendered) this.updateDelegate();\n      if (this.isTwoway && !this.locked) {\n        this.interpolator.twowayBinding.lastVal(true, this.interpolator.model.get());\n      } else if (this.name === 'value' && (binding = this.element.binding)) {\n        // special case: name bound element with dynamic value\n        const attr = binding.attribute;\n        if (attr && !attr.dirty && attr.rendered) {\n          this.element.binding.attribute.updateDelegate();\n        }\n      }\n    }\n  }\n}\n","import { INTERPOLATOR, ELEMENT } from 'config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport { isArray } from 'utils/is';\n\nexport default class BindingFlag extends Item {\n  constructor(options) {\n    super(options);\n\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.flag = options.template.v === 'l' ? 'lazy' : 'twoway';\n    this.bubbler = this.owner === this.element ? this.element : this.up;\n\n    if (this.element.type === ELEMENT) {\n      if (isArray(options.template.f)) {\n        this.fragment = new Fragment({\n          owner: this,\n          template: options.template.f\n        });\n      }\n\n      this.interpolator =\n        this.fragment &&\n        this.fragment.items.length === 1 &&\n        this.fragment.items[0].type === INTERPOLATOR &&\n        this.fragment.items[0];\n    }\n  }\n\n  bind() {\n    if (this.fragment) this.fragment.bind();\n    set(this, this.getValue(), true);\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.bubbler.bubble();\n      this.dirty = true;\n    }\n  }\n\n  getValue() {\n    if (this.fragment) return this.fragment.valueOf();\n    else if ('value' in this) return this.value;\n    else if ('f' in this.template) return this.template.f;\n    else return true;\n  }\n\n  render() {\n    set(this, this.getValue(), true);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind(view) {\n    if (this.fragment) this.fragment.unbind(view);\n\n    delete this.element[this.flag];\n  }\n\n  unrender() {\n    if (this.element.rendered) this.element.recreateTwowayBinding();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      set(this, this.getValue(), true);\n    }\n  }\n}\n\nfunction set(flag, value, update) {\n  if (value === 0) {\n    flag.value = true;\n  } else if (value === 'true') {\n    flag.value = true;\n  } else if (value === 'false' || value === '0') {\n    flag.value = false;\n  } else {\n    flag.value = value;\n  }\n\n  const current = flag.element[flag.flag];\n  flag.element[flag.flag] = flag.value;\n  if (update && !flag.element.attributes.binding && current !== flag.value) {\n    flag.element.recreateTwowayBinding();\n  }\n\n  return flag.value;\n}\n","import Item from './shared/Item';\nimport noop from 'utils/noop';\nimport { detachNode } from 'utils/dom';\nimport { doc } from 'config/environment';\nimport { assign, create } from 'utils/object';\n\nexport default function Comment(options) {\n  Item.call(this, options);\n}\n\nconst proto = create(Item.prototype);\n\nassign(proto, {\n  bind: noop,\n  unbind: noop,\n  update: noop,\n\n  detach() {\n    return detachNode(this.node);\n  },\n\n  firstNode() {\n    return this.node;\n  },\n\n  render(target) {\n    this.rendered = true;\n\n    this.node = doc.createComment(this.template.c);\n    target.appendChild(this.node);\n  },\n\n  toString() {\n    return `<!-- ${this.template.c} -->`;\n  },\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n});\n\nComment.prototype = proto;\n","import { SharedModel } from './SharedModel';\nimport { Missing } from '../LinkModel';\nimport { create } from 'utils/object';\n\nexport default class RactiveModel extends SharedModel {\n  constructor(ractive) {\n    super(ractive, '@this');\n    this.ractive = ractive;\n  }\n\n  joinKey(key) {\n    const model = super.joinKey(key);\n\n    if ((key === 'root' || key === 'parent') && !model.isLink) return initLink(model, key);\n    else if (key === 'data') return this.ractive.viewmodel;\n    else if (key === 'cssData') return this.ractive.constructor._cssModel;\n\n    return model;\n  }\n}\n\nfunction initLink(model, key) {\n  model.applyValue = function(value) {\n    this.parent.value[key] = value;\n    if (value && value.viewmodel) {\n      this.link(value.viewmodel.getRactiveModel(), key);\n      this._link.markedAll();\n    } else {\n      this.link(create(Missing), key);\n      this._link.markedAll();\n    }\n  };\n\n  if (key === 'root') {\n    const mark = model.mark;\n    model.mark = function(force) {\n      if (this._marking) return;\n      this._marking = true;\n      mark.apply(this, force);\n      this._marking = false;\n    };\n  }\n\n  model.applyValue(model.parent.ractive[key], key);\n  model._link.set = v => model.applyValue(v);\n  model._link.applyValue = v => model.applyValue(v);\n\n  return model._link;\n}\n","import { capture } from 'src/global/capture';\nimport Model from './Model';\nimport { handleChange, mark } from 'shared/methodCallers';\nimport RactiveModel from './specials/RactiveModel';\nimport SharedModel, { GlobalModel, SharedModel as SharedBase } from './specials/SharedModel';\nimport { splitKeypath, unescapeKey } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\n\nconst specialModels = {\n  '@this'(root) {\n    return root.getRactiveModel();\n  },\n  '@global'() {\n    return GlobalModel;\n  },\n  '@shared'() {\n    return SharedModel;\n  },\n  '@style'(root) {\n    return root.getRactiveModel().joinKey('cssData');\n  },\n  '@helpers'(root) {\n    return root.getHelpers();\n  }\n};\nspecialModels['@'] = specialModels['@this'];\n\nexport default class RootModel extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.ractive = options.ractive; // TODO sever this link\n\n    this.value = options.data;\n    this.adaptors = options.adapt;\n    this.adapt();\n  }\n\n  attached(fragment) {\n    attachImplicits(this, fragment);\n  }\n\n  createLink(keypath, target, targetPath, options) {\n    const keys = splitKeypath(keypath);\n\n    let model = this;\n    while (keys.length) {\n      const key = keys.shift();\n      model = model.childByKey[key] || model.joinKey(key);\n    }\n\n    return model.link(target, targetPath, options);\n  }\n\n  detached() {\n    detachImplicits(this);\n  }\n\n  get(shouldCapture, options) {\n    if (shouldCapture) capture(this);\n\n    if (!options || options.virtual !== false) {\n      return this.getVirtual();\n    } else {\n      return this.value;\n    }\n  }\n\n  getHelpers() {\n    if (!this.helpers) this.helpers = new SharedBase(this.ractive.helpers, 'helpers', this.ractive);\n    return this.helpers;\n  }\n\n  getKeypath() {\n    return '';\n  }\n\n  getRactiveModel() {\n    return this.ractiveModel || (this.ractiveModel = new RactiveModel(this.ractive));\n  }\n\n  getValueChildren() {\n    const children = super.getValueChildren(this.value);\n\n    this.children.forEach(child => {\n      if (child._link) {\n        const idx = children.indexOf(child);\n        if (~idx) children.splice(idx, 1, child._link);\n        else children.push(child._link);\n      }\n    });\n\n    return children;\n  }\n\n  has(key) {\n    if (key[0] === '~' && key[1] === '/') key = key.slice(2);\n    if (specialModels[key] || key === '') return true;\n\n    if (super.has(key)) {\n      return true;\n    } else {\n      const unescapedKey = unescapeKey(key);\n\n      // mappings/links and computations\n      if (this.childByKey[unescapedKey] && this.childByKey[unescapedKey]._link) return true;\n    }\n  }\n\n  joinKey(key, opts) {\n    if (key[0] === '~' && key[1] === '/') key = key.slice(2);\n\n    if (key[0] === '@') {\n      const fn = specialModels[key];\n      if (fn) return fn(this);\n    } else {\n      return super.joinKey(key, opts);\n    }\n  }\n\n  set(value) {\n    // TODO wrapping root node is a baaaad idea. We should prevent this\n    const wrapper = this.wrapper;\n    if (wrapper) {\n      const shouldTeardown = !wrapper.reset || wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        wrapper.teardown();\n        this.wrapper = null;\n        this.value = value;\n        this.adapt();\n      }\n    } else {\n      this.value = value;\n      this.adapt();\n    }\n\n    this.deps.forEach(handleChange);\n    this.children.forEach(mark);\n  }\n\n  retrieve() {\n    return this.wrapper ? this.wrapper.get() : this.value;\n  }\n\n  teardown() {\n    super.teardown();\n    this.ractiveModel && this.ractiveModel.teardown();\n  }\n}\nRootModel.prototype.update = noop;\n\nfunction attachImplicits(model, fragment) {\n  if (model._link && model._link.implicit && model._link.isDetached()) {\n    model.attach(fragment);\n  }\n\n  // look for virtual children to relink and cascade\n  for (const k in model.childByKey) {\n    if (model.value) {\n      if (k in model.value) {\n        attachImplicits(model.childByKey[k], fragment);\n      } else if (!model.childByKey[k]._link || model.childByKey[k]._link.isDetached()) {\n        const mdl = resolveReference(fragment, k);\n        if (mdl) {\n          model.childByKey[k].link(mdl, k, { implicit: true });\n        }\n      }\n    }\n  }\n}\n\nfunction detachImplicits(model) {\n  if (model._link && model._link.implicit) {\n    model.unlink();\n  }\n\n  for (const k in model.childByKey) {\n    detachImplicits(model.childByKey[k]);\n  }\n}\n","import { fatal, warnIfDebug, welcome } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { ensureArray, combine } from 'utils/array';\nimport { findInViewHierarchy } from 'shared/registry';\nimport dataConfigurator from './config/custom/data';\nimport RootModel from 'src/model/RootModel';\nimport hooks from 'src/events/Hook';\nimport subscribe from './helpers/subscribe';\nimport Ractive from '../Ractive';\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, INTERPOLATOR, TRANSITION } from 'config/types';\nimport { assign, create, hasOwn } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\nimport { compute } from 'src/Ractive/prototype/compute';\nimport getRactiveContext from '../shared/getRactiveContext';\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'decorators',\n  'easing',\n  'events',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nconst protoRegistries = ['computed', 'helpers'];\n\nlet uid = 0;\n\nexport default function construct(ractive, options) {\n  if (Ractive.DEBUG) welcome();\n\n  initialiseProperties(ractive);\n  handleAttributes(ractive);\n\n  // set up event subscribers\n  subscribe(ractive, options, 'on');\n\n  // if there's not a delegation setting, inherit from parent if it's not default\n  if (\n    !hasOwn(options, 'delegate') &&\n    ractive.parent &&\n    ractive.parent.delegate !== ractive.delegate\n  ) {\n    ractive.delegate = false;\n  }\n\n  // plugins that need to run at construct\n  if (isArray(options.use)) {\n    ractive.use.apply(ractive, options.use.filter(p => p.construct));\n  }\n\n  hooks.construct.fire(ractive, options);\n  if (options.onconstruct) options.onconstruct.call(ractive, getRactiveContext(ractive), options);\n\n  // Add registries\n  let i = registryNames.length;\n  while (i--) {\n    const name = registryNames[i];\n    ractive[name] = assign(create(ractive.constructor[name] || null), options[name]);\n  }\n\n  i = protoRegistries.length;\n  while (i--) {\n    const name = protoRegistries[i];\n    ractive[name] = assign(create(ractive.constructor.prototype[name]), options[name]);\n  }\n\n  if (ractive._attributePartial) {\n    ractive.partials['extra-attributes'] = ractive._attributePartial;\n    delete ractive._attributePartial;\n  }\n\n  // Create a viewmodel\n  const viewmodel = new RootModel({\n    adapt: getAdaptors(ractive, ractive.adapt, options),\n    data: dataConfigurator.init(ractive.constructor, ractive, options),\n    ractive\n  });\n\n  // once resolved, share the adaptors array between the root model and instance\n  ractive.adapt = viewmodel.adaptors;\n\n  ractive.viewmodel = viewmodel;\n\n  for (const k in ractive.computed) {\n    compute.call(ractive, k, ractive.computed[k]);\n  }\n}\n\nfunction getAdaptors(ractive, protoAdapt, options) {\n  protoAdapt = protoAdapt.map(lookup);\n  const adapt = ensureArray(options.adapt).map(lookup);\n\n  const srcs = [protoAdapt, adapt];\n  if (ractive.parent && !ractive.isolated) {\n    srcs.push(ractive.parent.viewmodel.adaptors);\n  }\n\n  return combine.apply(null, srcs);\n\n  function lookup(adaptor) {\n    if (isString(adaptor)) {\n      adaptor = findInViewHierarchy('adaptors', ractive, adaptor);\n\n      if (!adaptor) {\n        fatal(missingPlugin(adaptor, 'adaptor'));\n      }\n    }\n\n    return adaptor;\n  }\n}\n\nfunction initialiseProperties(ractive) {\n  // Generate a unique identifier, for places where you'd use a weak map if it\n  // existed\n  ractive._guid = 'r-' + uid++;\n\n  // events\n  ractive._subs = create(null);\n  ractive._nsSubs = 0;\n\n  // storage for item configuration from instantiation to reset,\n  // like dynamic functions or original values\n  ractive._config = {};\n\n  // events\n  ractive.event = null;\n  ractive._eventQueue = [];\n\n  // observers\n  ractive._observers = [];\n\n  // external children\n  ractive._children = [];\n  ractive._children.byName = {};\n  ractive.children = ractive._children;\n\n  if (!ractive.component) {\n    ractive.root = ractive;\n    ractive.parent = ractive.container = null; // TODO container still applicable?\n  }\n}\n\nfunction handleAttributes(ractive) {\n  const component = ractive.component;\n  const attributes = ractive.constructor.attributes;\n\n  if (attributes && component) {\n    const tpl = component.template;\n    const attrs = tpl.m ? tpl.m.slice() : [];\n\n    // grab all of the passed attribute names\n    const props = attrs.filter(a => a.t === ATTRIBUTE).map(a => a.n);\n\n    // warn about missing requireds\n    attributes.required.forEach(p => {\n      if (!~props.indexOf(p)) {\n        warnIfDebug(`Component '${component.name}' requires attribute '${p}' to be provided`);\n      }\n    });\n\n    // set up a partial containing non-property attributes\n    const all = attributes.optional.concat(attributes.required);\n    const partial = [];\n    let i = attrs.length;\n    while (i--) {\n      const a = attrs[i];\n      if (a.t === ATTRIBUTE && !~all.indexOf(a.n)) {\n        if (attributes.mapAll) {\n          // map the attribute if requested and make the extra attribute in the partial refer to the mapping\n          partial.unshift({\n            t: ATTRIBUTE,\n            n: a.n,\n            f: [{ t: INTERPOLATOR, r: `~/${a.n}` }]\n          });\n        } else {\n          // transfer the attribute to the extra attributes partal\n          partial.unshift(attrs.splice(i, 1)[0]);\n        }\n      } else if (\n        !attributes.mapAll &&\n        (a.t === DECORATOR || a.t === TRANSITION || a.t === BINDING_FLAG)\n      ) {\n        partial.unshift(attrs.splice(i, 1)[0]);\n      }\n    }\n\n    if (partial.length) component.template = { t: tpl.t, e: tpl.e, f: tpl.f, m: attrs, p: tpl.p };\n    ractive._attributePartial = partial;\n  }\n}\n","export default function use(...plugins) {\n  plugins.forEach(p => {\n    p({\n      proto: this,\n      Ractive: this.constructor.Ractive,\n      instance: this\n    });\n  });\n  return this;\n}\n","export default function isInstance(object) {\n  return object && object instanceof this;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function styleGet(keypath, opts) {\n  return this._cssModel.joinAll(splitKeypath(keypath)).get(true, opts);\n}\n","import { build, set } from '../../shared/set';\nimport SharedModel from '../../model/specials/SharedModel';\nimport { isObjectType } from 'utils/is';\n\nexport default function sharedSet(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = SharedModel;\n\n  return set(build({ viewmodel: model }, keypath, value, true), opts);\n}\n","import SharedModel from '../../model/specials/SharedModel';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function sharedGet(keypath, opts) {\n  return SharedModel.joinAll(splitKeypath(keypath)).get(true, opts);\n}\n","import { isFunction } from 'utils/is';\n\nexport default function use(...plugins) {\n  plugins.forEach(p => {\n    isFunction(p) &&\n      p({\n        proto: this.prototype,\n        Ractive: this.Ractive,\n        instance: this\n      });\n  });\n  return this;\n}\n","import styleGet from '../Ractive/static/styleGet';\nimport styleSet from '../Ractive/static/styleSet';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperties, defineProperty } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nimport { initCSS } from 'src/Ractive/config/custom/css/css';\n\nexport default function macro(fn, opts) {\n  if (!isFunction(fn)) throw new Error(`The macro must be a function`);\n\n  assign(fn, opts);\n\n  defineProperties(fn, {\n    extensions: { value: [] },\n    _cssIds: { value: [] },\n    cssData: { value: assign(create(this.cssData), fn.cssData || {}) },\n\n    styleGet: { value: styleGet.bind(fn) },\n    styleSet: { value: styleSet.bind(fn) }\n  });\n\n  defineProperty(fn, '_cssModel', { value: new CSSModel(fn) });\n\n  if (fn.css) initCSS(fn, fn, fn);\n\n  this.extensions.push(fn);\n\n  return fn;\n}\n","import { escapeKey, splitKeypath as splitKeypathI, unescapeKey } from 'shared/keypaths';\n\nexport function joinKeys(...keys) {\n  return keys.map(escapeKey).join('.');\n}\n\nexport function splitKeypath(keypath) {\n  return splitKeypathI(keypath).map(unescapeKey);\n}\n","import { findInViewHierarchy } from 'shared/registry';\n\nexport function findPlugin(name, type, instance) {\n  return findInViewHierarchy(type, instance, name);\n}\n","/* istanbul ignore if */\nif (!Object.assign) {\n  Object.assign = function(target, ...sources) {\n    if (target == null) throw new TypeError('Cannot convert undefined or null to object');\n\n    const to = Object(target);\n    const sourcesLength = sources.length;\n\n    for (let index = 0; index < sourcesLength; index++) {\n      const nextSource = sources[index];\n      for (const nextKey in nextSource) {\n        if (!Object.prototype.hasOwnProperty.call(nextSource, nextKey)) continue;\n        to[nextKey] = nextSource[nextKey];\n      }\n    }\n\n    return to;\n  };\n}\n","export function hasOwn(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function fillGaps(target, ...sources) {\n  for (let i = 0; i < sources.length; i++) {\n    const source = sources[i];\n    for (const key in source) {\n      // Source can be a prototype-less object.\n      if (key in target || !hasOwn(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nexport function toPairs(obj = {}) {\n  const pairs = [];\n  for (const key in obj) {\n    // Source can be a prototype-less object.\n    if (!hasOwn(obj, key)) continue;\n    pairs.push([key, obj[key]]);\n  }\n  return pairs;\n}\n\nconst obj = Object;\n\nexport const assign = obj.assign;\n\nexport const create = obj.create;\n\nexport const defineProperty = obj.defineProperty;\n\nexport const defineProperties = obj.defineProperties;\n\nexport const keys = obj.keys;\n","const toString = Object.prototype.toString;\nconst arrayLikePattern = /^\\[object (?:Array|FileList)\\]$/;\n\nexport function isArrayLike(obj) {\n  return arrayLikePattern.test(toString.call(obj));\n}\n\nexport const isArray = Array.isArray;\n\nexport function isEqual(a, b) {\n  if (a === null && b === null) {\n    return true;\n  }\n\n  if (isObjectType(a) || isObjectType(b)) {\n    return false;\n  }\n\n  return a === b;\n}\n\n// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\nexport function isNumeric(thing) {\n  return !isNaN(parseFloat(thing)) && isFinite(thing);\n}\n\nexport function isObject(thing) {\n  return thing && toString.call(thing) === '[object Object]';\n}\n\nexport function isObjectLike(thing) {\n  return !!(thing && (isObjectType(thing) || isFunction(thing)));\n}\n\nexport function isObjectType(thing) {\n  return typeof thing === 'object';\n}\n\nexport function isFunction(thing) {\n  return typeof thing === 'function';\n}\n\nexport function isString(thing) {\n  return typeof thing === 'string';\n}\n\nexport function isNumber(thing) {\n  return typeof thing === 'number';\n}\n","/* istanbul ignore if */\nif (typeof window !== 'undefined' && window.performance && !window.performance.now) {\n  window.performance = window.performance || {};\n\n  const nowOffset = Date.now();\n\n  window.performance.now = function() {\n    return Date.now() - nowOffset;\n  };\n}\n","import { hasOwn, defineProperty } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\n/* istanbul ignore if */\nif (!Array.prototype.find) {\n  defineProperty(Array.prototype, 'find', {\n    value(callback, thisArg) {\n      if (this === null || this === undefined)\n        throw new TypeError('Array.prototype.find called on null or undefined');\n\n      if (!isFunction(callback)) throw new TypeError(`${callback} is not a function`);\n\n      const array = Object(this);\n      const arrayLength = array.length >>> 0;\n\n      for (let index = 0; index < arrayLength; index++) {\n        if (!hasOwn(array, index)) continue;\n        if (!callback.call(thisArg, array[index], index, array)) continue;\n        return array[index];\n      }\n\n      return undefined;\n    },\n    configurable: true,\n    writable: true\n  });\n}\n","// NOTE: Node doesn't exist in IE8. Nothing can be done.\n/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  window.Node &&\n  window.Node.prototype &&\n  !window.Node.prototype.contains\n) {\n  Node.prototype.contains = function(node) {\n    if (!node) throw new TypeError('node required');\n\n    do {\n      if (this === node) return true;\n    } while ((node = node && node.parentNode));\n\n    return false;\n  };\n}\n","/* eslint no-console:\"off\" */\nimport { isFunction } from 'utils/is';\n\nconst win = typeof window !== 'undefined' ? window : null;\nconst doc = win ? document : null;\nconst isClient = !!doc;\nconst base = typeof global !== 'undefined' ? global : win;\nconst hasConsole =\n  typeof console !== 'undefined' && isFunction(console.warn) && isFunction(console.warn.apply);\n\nconst svg = doc\n  ? doc.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1')\n  : false;\n\nconst vendors = ['o', 'ms', 'moz', 'webkit'];\n\nexport { win, doc, isClient, hasConsole, svg, vendors, base };\n","import { isFunction, isObjectType } from 'utils/is';\nimport { base } from 'config/environment';\n\n/* istanbul ignore if */\nif (!base.Promise) {\n  const PENDING = {};\n  const FULFILLED = {};\n  const REJECTED = {};\n\n  const Promise = (base.Promise = function(callback) {\n    const fulfilledHandlers = [];\n    const rejectedHandlers = [];\n    let state = PENDING;\n    let result;\n    let dispatchHandlers;\n\n    const makeResolver = newState => {\n      return function(value) {\n        if (state !== PENDING) return;\n        result = value;\n        state = newState;\n        dispatchHandlers = makeDispatcher(\n          state === FULFILLED ? fulfilledHandlers : rejectedHandlers,\n          result\n        );\n        wait(dispatchHandlers);\n      };\n    };\n\n    const fulfill = makeResolver(FULFILLED);\n    const reject = makeResolver(REJECTED);\n\n    try {\n      callback(fulfill, reject);\n    } catch (err) {\n      reject(err);\n    }\n\n    return {\n      // `then()` returns a Promise - 2.2.7\n      then(onFulfilled, onRejected) {\n        const promise2 = new Promise((fulfill, reject) => {\n          const processResolutionHandler = (handler, handlers, forward) => {\n            if (isFunction(handler)) {\n              handlers.push(p1result => {\n                try {\n                  resolve(promise2, handler(p1result), fulfill, reject);\n                } catch (err) {\n                  reject(err);\n                }\n              });\n            } else {\n              handlers.push(forward);\n            }\n          };\n\n          processResolutionHandler(onFulfilled, fulfilledHandlers, fulfill);\n          processResolutionHandler(onRejected, rejectedHandlers, reject);\n\n          if (state !== PENDING) {\n            wait(dispatchHandlers);\n          }\n        });\n        return promise2;\n      },\n      catch(onRejected) {\n        return this.then(null, onRejected);\n      },\n      finally(callback) {\n        return this.then(\n          v => {\n            callback();\n            return v;\n          },\n          e => {\n            callback();\n            throw e;\n          }\n        );\n      }\n    };\n  });\n\n  Promise.all = function(promises) {\n    return new Promise((fulfill, reject) => {\n      const result = [];\n      let pending;\n      let i;\n\n      if (!promises.length) {\n        fulfill(result);\n        return;\n      }\n\n      const processPromise = (promise, i) => {\n        if (promise && isFunction(promise.then)) {\n          promise.then(value => {\n            result[i] = value;\n            --pending || fulfill(result);\n          }, reject);\n        } else {\n          result[i] = promise;\n          --pending || fulfill(result);\n        }\n      };\n\n      pending = i = promises.length;\n\n      while (i--) {\n        processPromise(promises[i], i);\n      }\n    });\n  };\n\n  Promise.race = function(promises) {\n    return new Promise((fulfill, reject) => {\n      let pending = true;\n      function ok(v) {\n        if (!pending) return;\n        pending = false;\n        fulfill(v);\n      }\n      function fail(e) {\n        if (!pending) return;\n        pending = false;\n        reject(e);\n      }\n      for (let i = 0; i < promises.length; i++) {\n        if (promises[i] && isFunction(promises[i].then)) {\n          promises[i].then(ok, fail);\n        }\n      }\n    });\n  };\n\n  Promise.resolve = function(value) {\n    if (value && isFunction(value.then)) return value;\n    return new Promise(fulfill => {\n      fulfill(value);\n    });\n  };\n\n  Promise.reject = function(reason) {\n    if (reason && isFunction(reason.then)) return reason;\n    return new Promise((fulfill, reject) => {\n      reject(reason);\n    });\n  };\n\n  // TODO use MutationObservers or something to simulate setImmediate\n  const wait = function(callback) {\n    setTimeout(callback, 0);\n  };\n\n  const makeDispatcher = function(handlers, result) {\n    return function() {\n      for (let handler; (handler = handlers.shift()); ) {\n        handler(result);\n      }\n    };\n  };\n\n  const resolve = function(promise, x, fulfil, reject) {\n    let then;\n    if (x === promise) {\n      throw new TypeError(`A promise's fulfillment handler cannot return the same promise`);\n    }\n    if (x instanceof Promise) {\n      x.then(fulfil, reject);\n    } else if (x && (isObjectType(x) || isFunction(x))) {\n      try {\n        then = x.then;\n      } catch (e) {\n        reject(e);\n        return;\n      }\n      if (isFunction(then)) {\n        let called;\n\n        const resolvePromise = function(y) {\n          if (called) return;\n          called = true;\n          resolve(promise, y, fulfil, reject);\n        };\n        const rejectPromise = function(r) {\n          if (called) return;\n          called = true;\n          reject(r);\n        };\n\n        try {\n          then.call(x, resolvePromise, rejectPromise);\n        } catch (e) {\n          if (!called) {\n            reject(e);\n            called = true;\n            return;\n          }\n        }\n      } else {\n        fulfil(x);\n      }\n    } else {\n      fulfil(x);\n    }\n  };\n}\n","/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  !(window.requestAnimationFrame && window.cancelAnimationFrame)\n) {\n  let lastTime = 0;\n  window.requestAnimationFrame = function(callback) {\n    const currentTime = Date.now();\n    const timeToNextCall = Math.max(0, 16 - (currentTime - lastTime));\n    const id = window.setTimeout(() => {\n      callback(currentTime + timeToNextCall);\n    }, timeToNextCall);\n    lastTime = currentTime + timeToNextCall;\n    return id;\n  };\n  window.cancelAnimationFrame = function(id) {\n    clearTimeout(id);\n  };\n}\n","import { create } from 'utils/object';\n\nexport default {\n  // render placement:\n  el: void 0,\n  append: false,\n  delegate: true,\n  enhance: false,\n\n  // template:\n  template: null,\n\n  // parse:\n  allowExpressions: true,\n  delimiters: ['{{', '}}'],\n  tripleDelimiters: ['{{{', '}}}'],\n  staticDelimiters: ['[[', ']]'],\n  staticTripleDelimiters: ['[[[', ']]]'],\n  csp: true,\n  interpolate: false,\n  preserveWhitespace: false,\n  sanitize: false,\n  stripComments: true,\n  contextLines: 0,\n\n  // data & binding:\n  data: create(null),\n  helpers: create(null),\n  computed: create(null),\n  syncComputedChildren: false,\n  resolveInstanceMembers: false,\n  warnAboutAmbiguity: false,\n  adapt: [],\n  isolated: true,\n  twoway: true,\n  lazy: false,\n\n  // transitions:\n  noIntro: false,\n  noOutro: false,\n  transitionsEnabled: true,\n  complete: void 0,\n  nestedTransitions: true,\n\n  // css:\n  css: null,\n  noCSSTransform: false\n};\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { hasConsole } from '../config/environment';\nimport Ractive from '../Ractive';\nimport noop from './noop';\nimport { isObjectType } from 'utils/is';\n\nconst alreadyWarned = {};\nlet log, printWarning, welcome;\n\nif (hasConsole) {\n  const welcomeIntro = [\n    `%cRactive.js %cBUILD_PLACEHOLDER_VERSION %cin debug mode, %cmore...`,\n    'color: rgb(114, 157, 52); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n  ];\n  const welcomeMessage = `You're running Ractive BUILD_PLACEHOLDER_VERSION in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://ractive.js.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n`;\n\n  welcome = () => {\n    if (Ractive.WELCOME_MESSAGE === false) {\n      welcome = noop;\n      return;\n    }\n    const message = 'WELCOME_MESSAGE' in Ractive ? Ractive.WELCOME_MESSAGE : welcomeMessage;\n    const hasGroup = !!console.groupCollapsed;\n    if (hasGroup) console.groupCollapsed.apply(console, welcomeIntro);\n    console.log(message);\n    if (hasGroup) {\n      console.groupEnd(welcomeIntro);\n    }\n\n    welcome = noop;\n  };\n\n  printWarning = (message, args) => {\n    welcome();\n\n    // extract information about the instance this message pertains to, if applicable\n    if (isObjectType(args[args.length - 1])) {\n      const options = args.pop();\n      const ractive = options ? options.ractive : null;\n\n      if (ractive) {\n        // if this is an instance of a component that we know the name of, add\n        // it to the message\n        let name;\n        if (ractive.component && (name = ractive.component.name)) {\n          message = `<${name}> ${message}`;\n        }\n\n        let node;\n        if (\n          (node =\n            options.node || (ractive.fragment && ractive.fragment.rendered && ractive.find('*')))\n        ) {\n          args.push(node);\n        }\n      }\n    }\n\n    console.warn.apply(\n      console,\n      ['%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);'].concat(\n        args\n      )\n    );\n  };\n\n  log = function() {\n    console.log.apply(console, arguments);\n  };\n} else {\n  printWarning = log = welcome = noop;\n}\n\nfunction format(message, args) {\n  return message.replace(/%s/g, () => args.shift());\n}\n\nfunction fatal(message, ...args) {\n  message = format(message, args);\n  throw new Error(message);\n}\n\nfunction logIfDebug() {\n  if (Ractive.DEBUG) {\n    log.apply(null, arguments);\n  }\n}\n\nfunction warn(message, ...args) {\n  message = format(message, args);\n  printWarning(message, args);\n}\n\nfunction warnOnce(message, ...args) {\n  message = format(message, args);\n\n  if (alreadyWarned[message]) {\n    return;\n  }\n\n  alreadyWarned[message] = true;\n  printWarning(message, args);\n}\n\nfunction warnIfDebug() {\n  if (Ractive.DEBUG) {\n    warn.apply(null, arguments);\n  }\n}\n\nfunction warnOnceIfDebug() {\n  if (Ractive.DEBUG) {\n    warnOnce.apply(null, arguments);\n  }\n}\n\nexport { fatal, log, logIfDebug, warn, warnOnce, warnIfDebug, warnOnceIfDebug, welcome };\n","// These are a subset of the easing equations found at\n// https://raw.github.com/danro/easing-js - license info\n// follows:\n\n// --------------------------------------------------\n// easing.js v0.5.4\n// Generic set of easing functions with AMD support\n// https://github.com/danro/easing-js\n// This code may be freely distributed under the MIT license\n// http://danro.mit-license.org/\n// --------------------------------------------------\n// All functions adapted from Thomas Fuchs & Jeremy Kahn\n// Easing Equations (c) 2003 Robert Penner, BSD license\n// https://raw.github.com/danro/easing-js/master/LICENSE\n// --------------------------------------------------\n\n// In that library, the functions named easeIn, easeOut, and\n// easeInOut below are named easeInCubic, easeOutCubic, and\n// (you guessed it) easeInOutCubic.\n//\n// You can add additional easing functions to this list, and they\n// will be globally available.\n\nexport default {\n  linear(pos) {\n    return pos;\n  },\n  easeIn(pos) {\n    /* istanbul ignore next */\n    return Math.pow(pos, 3);\n  },\n  easeOut(pos) {\n    return Math.pow(pos - 1, 3) + 1;\n  },\n  easeInOut(pos) {\n    /* istanbul ignore next */\n    if ((pos /= 0.5) < 1) {\n      return 0.5 * Math.pow(pos, 3);\n    }\n    /* istanbul ignore next */\n    return 0.5 * (Math.pow(pos - 2, 3) + 2);\n  }\n};\n","// Error messages that are used (or could be) in multiple places\nexport const badArguments = 'Bad arguments';\nexport const noRegistryFunctionReturn =\n  'A function was specified for \"%s\" %s, but no %s was returned';\nexport const missingPlugin = (name, type) =>\n  `Missing \"${name}\" ${type} plugin. You may need to download a plugin via http://ractive.js.org/integrations/#${type}s`;\n","import { isArray, isObject, isNumeric } from 'utils/is';\nimport interpolate from 'shared/interpolate';\nimport { hasOwn } from 'utils/object';\n\nconst interpolators = {\n  number(from, to) {\n    if (!isNumeric(from) || !isNumeric(to)) {\n      return null;\n    }\n\n    from = +from;\n    to = +to;\n\n    const delta = to - from;\n\n    if (!delta) {\n      return function() {\n        return from;\n      };\n    }\n\n    return function(t) {\n      return from + t * delta;\n    };\n  },\n\n  array(from, to) {\n    let len, i;\n\n    if (!isArray(from) || !isArray(to)) {\n      return null;\n    }\n\n    const intermediate = [];\n    const interpolators = [];\n\n    i = len = Math.min(from.length, to.length);\n    while (i--) {\n      interpolators[i] = interpolate(from[i], to[i]);\n    }\n\n    // surplus values - don't interpolate, but don't exclude them either\n    for (i = len; i < from.length; i += 1) {\n      intermediate[i] = from[i];\n    }\n\n    for (i = len; i < to.length; i += 1) {\n      intermediate[i] = to[i];\n    }\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        intermediate[i] = interpolators[i](t);\n      }\n\n      return intermediate;\n    };\n  },\n\n  object(from, to) {\n    if (!isObject(from) || !isObject(to)) {\n      return null;\n    }\n\n    const properties = [];\n    const intermediate = {};\n    const interpolators = {};\n\n    for (const prop in from) {\n      if (hasOwn(from, prop)) {\n        if (hasOwn(to, prop)) {\n          properties.push(prop);\n          interpolators[prop] = interpolate(from[prop], to[prop]) || (() => to[prop]);\n        } else {\n          intermediate[prop] = from[prop];\n        }\n      }\n    }\n\n    for (const prop in to) {\n      if (hasOwn(to, prop) && !hasOwn(from, prop)) {\n        intermediate[prop] = to[prop];\n      }\n    }\n\n    const len = properties.length;\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        const prop = properties[i];\n\n        intermediate[prop] = interpolators[prop](t);\n      }\n\n      return intermediate;\n    };\n  }\n};\n\nexport default interpolators;\n","import { isString } from 'utils/is';\n\nconst refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\nconst splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\nconst escapeKeyPattern = /\\\\|\\./g;\nconst unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\n\nexport function escapeKey(key) {\n  if (isString(key)) {\n    return key.replace(escapeKeyPattern, '\\\\$&');\n  }\n\n  return key;\n}\n\nexport function normalise(ref) {\n  return ref ? ref.replace(refPattern, '.$1') : '';\n}\n\nexport function splitKeypath(keypath) {\n  const result = [];\n  let match;\n\n  keypath = normalise(keypath);\n\n  while ((match = splitPattern.exec(keypath))) {\n    const index = match.index + match[1].length;\n    result.push(keypath.substr(0, index));\n    keypath = keypath.substr(index + 1);\n  }\n\n  result.push(keypath);\n\n  return result;\n}\n\nexport function unescapeKey(key) {\n  if (isString(key)) {\n    return key.replace(unescapeKeyPattern, '$1$2');\n  }\n\n  return key;\n}\n","const fnBind = Function.prototype.bind;\n\nexport default function bind(fn, context) {\n  if (!/this/.test(fn.toString())) return fn;\n\n  const bound = fnBind.call(fn, context);\n  for (const prop in fn) bound[prop] = fn[prop];\n\n  return bound;\n}\n","import { escapeKey, unescapeKey } from 'shared/keypaths';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isFunction } from 'utils/is';\nimport bind from 'utils/bind';\nimport { create, keys as objectKeys } from 'utils/object';\n\nconst shuffleTasks = { early: [], mark: [] };\nconst registerQueue = { early: [], mark: [] };\nexport const noVirtual = { virtual: false };\n\nexport default class ModelBase {\n  constructor(parent) {\n    this.deps = [];\n\n    this.children = [];\n    this.childByKey = {};\n    this.links = [];\n\n    this.bindings = [];\n\n    if (parent) {\n      this.parent = parent;\n      this.root = parent.root;\n    }\n  }\n\n  addShuffleTask(task, stage = 'early') {\n    shuffleTasks[stage].push(task);\n  }\n  addShuffleRegister(item, stage = 'early') {\n    registerQueue[stage].push({ model: this, item });\n  }\n\n  downstreamChanged() {}\n\n  findMatches(keys) {\n    const len = keys.length;\n\n    let existingMatches = [this];\n    let matches;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const key = keys[i];\n\n      if (key === '*') {\n        matches = [];\n        existingMatches.forEach(model => {\n          matches.push.apply(matches, model.getValueChildren(model.get()));\n        });\n      } else {\n        matches = existingMatches.map(model => model.joinKey(key));\n      }\n\n      existingMatches = matches;\n    }\n\n    return matches;\n  }\n\n  getKeypath(ractive) {\n    if (ractive !== this.ractive && this._link) return this._link.target.getKeypath(ractive);\n\n    if (!this.keypath) {\n      const parent = this.parent && this.parent.getKeypath(ractive);\n      this.keypath = parent\n        ? `${this.parent.getKeypath(ractive)}.${escapeKey(this.key)}`\n        : escapeKey(this.key);\n    }\n\n    return this.keypath;\n  }\n\n  getValueChildren(value) {\n    let children;\n    if (isArray(value)) {\n      children = [];\n      if ('length' in this && this.length !== value.length) {\n        children.push(this.joinKey('length'));\n      }\n      value.forEach((m, i) => {\n        children.push(this.joinKey(i));\n      });\n    } else if (isObject(value) || isFunction(value)) {\n      children = objectKeys(value).map(key => this.joinKey(key));\n    } else if (value != null) {\n      children = [];\n    }\n\n    const computed = this.computed;\n    if (computed) {\n      children.push.apply(children, objectKeys(computed).map(k => this.joinKey(k)));\n    }\n\n    return children;\n  }\n\n  getVirtual(shouldCapture) {\n    const value = this.get(shouldCapture, { virtual: false });\n    if (isObject(value)) {\n      const result = isArray(value) ? [] : create(null);\n\n      let keys = objectKeys(value);\n      let i = keys.length;\n      while (i--) {\n        const child = this.childByKey[keys[i]];\n        if (!child) result[keys[i]] = value[keys[i]];\n        else if (child._link) result[keys[i]] = child._link.getVirtual();\n        else result[keys[i]] = child.getVirtual();\n      }\n\n      i = this.children.length;\n      while (i--) {\n        const child = this.children[i];\n        if (!(child.key in result) && child._link) {\n          result[child.key] = child._link.getVirtual();\n        }\n      }\n\n      if (this.computed) {\n        keys = objectKeys(this.computed);\n        i = keys.length;\n        while (i--) {\n          result[keys[i]] = this.computed[keys[i]].get();\n        }\n      }\n\n      return result;\n    } else return value;\n  }\n\n  has(key) {\n    if (this._link) return this._link.has(key);\n\n    const value = this.get(false, noVirtual);\n    if (!value) return false;\n\n    key = unescapeKey(key);\n    if ((isFunction(value) || isObject(value)) && key in value) return true;\n\n    let computed = this.computed;\n    if (computed && key in this.computed) return true;\n\n    computed = this.root.ractive && this.root.ractive.computed;\n    if (computed) {\n      objectKeys(computed).forEach(k => {\n        if (computed[k].pattern && computed[k].pattern.test(this.getKeypath())) return true;\n      });\n    }\n\n    return false;\n  }\n\n  joinAll(keys, opts) {\n    let model = this;\n    for (let i = 0; i < keys.length; i += 1) {\n      if (\n        opts &&\n        opts.lastLink === false &&\n        i + 1 === keys.length &&\n        model.childByKey[keys[i]] &&\n        model.childByKey[keys[i]]._link\n      )\n        return model.childByKey[keys[i]];\n      model = model.joinKey(keys[i], opts);\n    }\n\n    return model;\n  }\n\n  notifyUpstream(startPath) {\n    let parent = this.parent;\n    const path = startPath || [this.key];\n    while (parent) {\n      if (parent.patterns) parent.patterns.forEach(o => o.notify(path.slice()));\n      path.unshift(parent.key);\n      parent.links.forEach(l => l.notifiedUpstream(path, this.root));\n      parent.deps.forEach(d => d.handleChange(path));\n      parent.downstreamChanged(startPath);\n      parent = parent.parent;\n    }\n  }\n\n  rebind(next, previous, safe) {\n    if (this._link) {\n      this._link.rebind(next, previous, false);\n    }\n\n    // tell the deps to move to the new target\n    let i = this.deps.length;\n    while (i--) {\n      if (this.deps[i].rebind) this.deps[i].rebind(next, previous, safe);\n    }\n\n    i = this.links.length;\n    while (i--) {\n      const link = this.links[i];\n      // only relink the root of the link tree\n      if (link.owner && link.owner._link) link.relinking(next, safe);\n    }\n\n    i = this.children.length;\n    while (i--) {\n      const child = this.children[i];\n      child.rebind(next ? next.joinKey(child.key) : undefined, child, safe);\n    }\n\n    i = this.bindings.length;\n    while (i--) {\n      this.bindings[i].rebind(next, previous, safe);\n    }\n  }\n\n  reference() {\n    'refs' in this ? this.refs++ : (this.refs = 1);\n  }\n\n  register(dep) {\n    this.deps.push(dep);\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  registerPatternObserver(observer) {\n    (this.patterns || (this.patterns = [])).push(observer);\n    this.register(observer);\n  }\n\n  registerTwowayBinding(binding) {\n    this.bindings.push(binding);\n  }\n\n  unreference() {\n    if ('refs' in this) this.refs--;\n  }\n\n  unregister(dep) {\n    removeFromArray(this.deps, dep);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n\n  unregisterPatternObserver(observer) {\n    removeFromArray(this.patterns, observer);\n    this.unregister(observer);\n  }\n\n  unregisterTwowayBinding(binding) {\n    removeFromArray(this.bindings, binding);\n  }\n\n  updateFromBindings(cascade) {\n    let i = this.bindings.length;\n    while (i--) {\n      const value = this.bindings[i].getValue();\n      if (value !== this.value) this.set(value);\n    }\n\n    // check for one-way bindings if there are no two-ways\n    if (!this.bindings.length) {\n      const oneway = findBoundValue(this.deps);\n      if (oneway && oneway.value !== this.value) this.set(oneway.value);\n    }\n\n    if (cascade) {\n      this.children.forEach(updateFromBindings);\n      this.links.forEach(updateFromBindings);\n      if (this._link) this._link.updateFromBindings(cascade);\n    }\n  }\n}\n\n// TODO: this may be better handled by overriding `get` on models with a parent that isRoot\nexport function maybeBind(model, value, shouldBind) {\n  if (shouldBind && isFunction(value) && model.parent && model.parent.isRoot) {\n    if (!model.boundValue) {\n      model.boundValue = bind(value._r_unbound || value, model.parent.ractive);\n    }\n\n    return model.boundValue;\n  }\n\n  return value;\n}\n\nfunction updateFromBindings(model) {\n  model.updateFromBindings(true);\n}\n\nexport function findBoundValue(list) {\n  let i = list.length;\n  while (i--) {\n    if (list[i].bound) {\n      const owner = list[i].owner;\n      if (owner) {\n        const value = owner.name === 'checked' ? owner.node.checked : owner.node.value;\n        return { value };\n      }\n    }\n  }\n}\n\nexport function fireShuffleTasks(stage) {\n  if (!stage) {\n    fireShuffleTasks('early');\n    fireShuffleTasks('mark');\n  } else {\n    const tasks = shuffleTasks[stage];\n    shuffleTasks[stage] = [];\n    let i = tasks.length;\n    while (i--) tasks[i]();\n\n    const register = registerQueue[stage];\n    registerQueue[stage] = [];\n    i = register.length;\n    while (i--) register[i].model.register(register[i].item);\n  }\n}\n\nexport function shuffle(model, newIndices, link, unsafe) {\n  model.shuffling = true;\n\n  let i = newIndices.length;\n  while (i--) {\n    const idx = newIndices[i];\n    // nothing is actually changing, so move in the index and roll on\n    if (i === idx) {\n      continue;\n    }\n\n    // rebind the children on i to idx\n    if (i in model.childByKey)\n      model.childByKey[i].rebind(\n        !~idx ? undefined : model.joinKey(idx),\n        model.childByKey[i],\n        !unsafe\n      );\n  }\n\n  const upstream = model.source().length !== model.source().value.length;\n\n  model.links.forEach(l => l.shuffle(newIndices));\n  if (!link) fireShuffleTasks('early');\n\n  i = model.deps.length;\n  while (i--) {\n    if (model.deps[i].shuffle) model.deps[i].shuffle(newIndices);\n  }\n\n  model[link ? 'marked' : 'mark']();\n  if (!link) fireShuffleTasks('mark');\n\n  if (upstream) model.notifyUpstream();\n\n  model.shuffling = false;\n}\n","const stack = [];\nlet captureGroup;\n\nexport function startCapturing() {\n  stack.push((captureGroup = []));\n}\n\nexport function stopCapturing() {\n  const dependencies = stack.pop();\n  captureGroup = stack[stack.length - 1];\n  return dependencies;\n}\n\nexport function capture(model) {\n  if (captureGroup) {\n    captureGroup.push(model);\n  }\n}\n","import ModelBase, { fireShuffleTasks, maybeBind, shuffle } from './ModelBase';\nimport { capture } from '../global/capture';\nimport { handleChange, marked, markedAll, teardown } from 'shared/methodCallers';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\nimport { hasOwn } from 'utils/object';\n\n// temporary placeholder target for detached implicit links\nexport const Missing = {\n  key: '@missing',\n  animate: noop,\n  applyValue: noop,\n  get: noop,\n  getKeypath() {\n    return this.key;\n  },\n  joinAll() {\n    return this;\n  },\n  joinKey() {\n    return this;\n  },\n  mark: noop,\n  registerLink: noop,\n  shufle: noop,\n  set: noop,\n  unregisterLink: noop\n};\nMissing.parent = Missing;\n\nexport default class LinkModel extends ModelBase {\n  constructor(parent, owner, target, key) {\n    super(parent);\n\n    this.owner = owner;\n    this.target = target;\n    this.key = key === undefined ? owner.key : key;\n    if (owner && owner.isLink) this.sourcePath = `${owner.sourcePath}.${this.key}`;\n\n    if (target) target.registerLink(this);\n\n    if (parent) this.isReadonly = parent.isReadonly;\n\n    this.isLink = true;\n  }\n\n  animate(from, to, options, interpolator) {\n    return this.target.animate(from, to, options, interpolator);\n  }\n\n  applyValue(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.applyValue(value);\n  }\n\n  attach(fragment) {\n    const model = resolveReference(fragment, this.key);\n    if (model) {\n      this.relinking(model, false);\n    } else {\n      // if there is no link available, move everything here to real models\n      this.owner.unlink();\n    }\n  }\n\n  detach() {\n    this.relinking(Missing, false);\n  }\n\n  get(shouldCapture, opts = {}) {\n    if (shouldCapture) {\n      capture(this);\n\n      // may need to tell the target to unwrap\n      opts.unwrap = 'unwrap' in opts ? opts.unwrap : true;\n    }\n\n    const bind = 'shouldBind' in opts ? opts.shouldBind : true;\n    opts.shouldBind = this.mapping && this.target.parent && this.target.parent.isRoot;\n\n    return maybeBind(this, this.target.get(false, opts), bind);\n  }\n\n  getKeypath(ractive) {\n    if (ractive && ractive !== this.root.ractive) return this.target.getKeypath(ractive);\n\n    return super.getKeypath(ractive);\n  }\n\n  handleChange() {\n    this.deps.forEach(handleChange);\n    this.links.forEach(handleChange);\n    this.notifyUpstream();\n  }\n\n  isDetached() {\n    return this.virtual && this.target === Missing;\n  }\n\n  joinKey(key) {\n    // TODO: handle nested links\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new LinkModel(this, this, this.target.joinKey(key), key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n\n  mark(force) {\n    this.target.mark(force);\n  }\n\n  marked() {\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n\n    this.deps.forEach(handleChange);\n  }\n\n  markedAll() {\n    this.children.forEach(markedAll);\n    this.marked();\n  }\n\n  notifiedUpstream(startPath, root) {\n    this.links.forEach(l => l.notifiedUpstream(startPath, this.root));\n    this.deps.forEach(handleChange);\n    if (startPath && this.rootLink && this.root !== root) {\n      const path = startPath.slice(1);\n      path.unshift(this.key);\n      this.notifyUpstream(path);\n    }\n  }\n\n  relinked() {\n    this.target.registerLink(this);\n    this.children.forEach(c => c.relinked());\n  }\n\n  relinking(target, safe) {\n    if (this.rootLink && this.sourcePath)\n      target = rebindMatch(this.sourcePath, target, this.target);\n    if (!target || this.target === target) return;\n\n    this.target && this.target.unregisterLink(this);\n\n    this.target = target;\n    this.children.forEach(c => {\n      c.relinking(target.joinKey(c.key), safe);\n    });\n\n    if (this.rootLink)\n      this.addShuffleTask(() => {\n        this.relinked();\n        if (!safe) {\n          this.markedAll();\n          this.notifyUpstream();\n        }\n      });\n  }\n\n  set(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.set(value);\n  }\n\n  shuffle(newIndices) {\n    // watch for extra shuffles caused by a shuffle in a downstream link\n    if (this.shuffling) return;\n\n    // let the real model handle firing off shuffles\n    if (!this.target.shuffling) {\n      if (this.target.shuffle) {\n        this.target.shuffle(newIndices);\n      } else {\n        // the target is a computation, which can't shuffle\n        this.target.mark();\n      }\n    } else {\n      shuffle(this, newIndices, true);\n    }\n  }\n\n  source() {\n    if (this.target.source) return this.target.source();\n    else return this.target;\n  }\n\n  teardown() {\n    if (this._link) this._link.teardown();\n    this.target.unregisterLink(this);\n    this.children.forEach(teardown);\n  }\n}\n\nModelBase.prototype.link = function link(model, keypath, options) {\n  const lnk = this._link || new LinkModel(this.parent, this, model, this.key);\n  lnk.implicit = options && options.implicit;\n  lnk.mapping = options && options.mapping;\n  lnk.sourcePath = keypath;\n  lnk.rootLink = true;\n  if (this._link) this._link.relinking(model, false);\n  this.rebind(lnk, this, false);\n  fireShuffleTasks();\n\n  this._link = lnk;\n  lnk.markedAll();\n\n  this.notifyUpstream();\n  return lnk;\n};\n\nModelBase.prototype.unlink = function unlink() {\n  if (this._link) {\n    const ln = this._link;\n    this._link = undefined;\n    ln.rebind(this, ln, false);\n    fireShuffleTasks();\n    ln.teardown();\n    this.notifyUpstream();\n  }\n};\n","import { createFunction } from '../Ractive/config/runtime-parser';\nimport { create, keys } from 'utils/object';\n\nconst functions = create(null);\n\nexport default function getFunction(str, i) {\n  if (functions[str]) return functions[str];\n  return (functions[str] = createFunction(str, i));\n}\n\nexport function addFunctions(template) {\n  if (!template) return;\n\n  const exp = template.e;\n\n  if (!exp) return;\n\n  keys(exp).forEach(str => {\n    if (functions[str]) return;\n    functions[str] = exp[str];\n  });\n}\n","import { TEMPLATE_VERSION } from 'config/template';\nimport Parser from './Parser';\nimport readMustache from './converters/readMustache';\nimport readTriple from './converters/mustache/readTriple';\nimport readUnescaped from './converters/mustache/readUnescaped';\nimport readPartial from './converters/mustache/readPartial';\nimport readMustacheComment from './converters/mustache/readMustacheComment';\nimport readInterpolator from './converters/mustache/readInterpolator';\nimport readSection from './converters/mustache/readSection';\nimport readHtmlComment from './converters/readHtmlComment';\nimport readElement from './converters/readElement';\nimport readText from './converters/readText';\nimport readPartialDefinitionSection from './converters/readPartialDefinitionSection';\nimport readTemplate from './converters/readTemplate';\nimport readExpression from './converters/readExpression';\nimport { fromExpression } from './utils/createFunction';\nimport cleanup from './utils/cleanup';\nimport insertExpressions from './utils/insertExpressions';\nimport flattenExpression from './utils/flattenExpression';\nimport shared from '../Ractive/shared';\nimport { assign, keys } from 'utils/object';\nimport { isObjectType } from 'utils/is';\n\n// See https://github.com/ractivejs/template-spec for information\n// about the Ractive template specification\n\nconst STANDARD_READERS = [\n  readPartial,\n  readUnescaped,\n  readSection,\n  readInterpolator,\n  readMustacheComment\n];\nconst TRIPLE_READERS = [readTriple];\n\nexport const READERS = [readMustache, readHtmlComment, readElement, readText];\nexport const PARTIAL_READERS = [readPartialDefinitionSection];\n\nconst preserveWhitespaceElements = { pre: 1, script: 1, style: 1, textarea: 1 };\n\nconst defaultInterpolate = { textarea: true, script: true, style: true, template: true };\n\nconst StandardParser = Parser.extend({\n  init(str, options) {\n    const tripleDelimiters = options.tripleDelimiters || shared.defaults.tripleDelimiters;\n    const staticDelimiters = options.staticDelimiters || shared.defaults.staticDelimiters;\n    const staticTripleDelimiters =\n      options.staticTripleDelimiters || shared.defaults.staticTripleDelimiters;\n\n    this.standardDelimiters = options.delimiters || shared.defaults.delimiters;\n\n    this.tags = [\n      {\n        isStatic: false,\n        isTriple: false,\n        open: this.standardDelimiters[0],\n        close: this.standardDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: false,\n        isTriple: true,\n        open: tripleDelimiters[0],\n        close: tripleDelimiters[1],\n        readers: TRIPLE_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: false,\n        open: staticDelimiters[0],\n        close: staticDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: true,\n        open: staticTripleDelimiters[0],\n        close: staticTripleDelimiters[1],\n        readers: TRIPLE_READERS\n      }\n    ];\n\n    this.contextLines = options.contextLines || shared.defaults.contextLines;\n\n    this.sortMustacheTags();\n\n    this.sectionDepth = 0;\n    this.elementStack = [];\n\n    this.interpolate = assign(\n      {},\n      defaultInterpolate,\n      shared.defaults.interpolate,\n      options.interpolate\n    );\n\n    if (options.sanitize === true) {\n      options.sanitize = {\n        // blacklist from https://code.google.com/p/google-caja/source/browse/trunk/src/com/google/caja/lang/html/html4-elements-whitelist.json\n        elements: 'applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title'.split(\n          ' '\n        ),\n        eventAttributes: true\n      };\n    }\n\n    this.stripComments = options.stripComments !== false;\n    this.preserveWhitespace = isObjectType(options.preserveWhitespace)\n      ? false\n      : options.preserveWhitespace;\n    this.sanitizeElements = options.sanitize && options.sanitize.elements;\n    this.sanitizeEventAttributes = options.sanitize && options.sanitize.eventAttributes;\n    this.includeLinePositions = options.includeLinePositions;\n    this.textOnlyMode = options.textOnlyMode;\n    this.csp = options.csp;\n    this.allowExpressions = options.allowExpressions;\n\n    if (options.expression) this.converters = [readExpression];\n\n    if (options.attributes) this.inTag = true;\n\n    // special whitespace handling requested for certain elements\n    this.whiteSpaceElements = assign({}, options.preserveWhitespace, preserveWhitespaceElements);\n  },\n\n  postProcess(result, options) {\n    const [parserResult] = result;\n\n    if (options.expression) {\n      const expr = flattenExpression(parserResult);\n      expr.e = fromExpression(expr.s, expr.r.length);\n      return expr;\n    } else {\n      // special case - empty string\n      if (!result.length) {\n        return { t: [], v: TEMPLATE_VERSION };\n      }\n\n      if (this.sectionDepth > 0) {\n        this.error('A section was left open');\n      }\n\n      cleanup(\n        parserResult.t,\n        this.stripComments,\n        this.preserveWhitespace,\n        !this.preserveWhitespace,\n        !this.preserveWhitespace,\n        this.whiteSpaceElements\n      );\n\n      if (this.csp !== false) {\n        const expr = {};\n\n        insertExpressions(parserResult.t, expr);\n        insertExpressions(parserResult.p || {}, expr);\n\n        if (keys(expr).length) parserResult.e = expr;\n      }\n\n      return parserResult;\n    }\n  },\n\n  converters: [readTemplate],\n\n  sortMustacheTags() {\n    // Sort in order of descending opening delimiter length (longer first),\n    // to protect against opening delimiters being substrings of each other\n    this.tags.sort((a, b) => {\n      return b.open.length - a.open.length;\n    });\n  }\n});\n\nexport default function parse(template, options) {\n  return new StandardParser(template, options || {}).result;\n}\n","import { fromExpression } from 'parse/utils/createFunction';\nimport { doc } from 'config/environment';\nimport { fatal } from 'utils/log';\nimport { addFunctions } from 'shared/getFunction';\nimport parse from 'parse/_parse';\nimport { isString } from 'utils/is';\n\nconst parseOptions = [\n  'delimiters',\n  'tripleDelimiters',\n  'staticDelimiters',\n  'staticTripleDelimiters',\n  'csp',\n  'interpolate',\n  'preserveWhitespace',\n  'sanitize',\n  'stripComments',\n  'contextLines',\n  'allowExpressions',\n  'attributes'\n];\n\nconst TEMPLATE_INSTRUCTIONS = `Either preparse or use a ractive runtime source that includes the parser. `;\n\nconst COMPUTATION_INSTRUCTIONS = `Either include a version of Ractive that can parse or convert your computation strings to functions.`;\n\nfunction throwNoParse(method, error, instructions) {\n  if (!method) {\n    fatal(`Missing Ractive.parse - cannot parse ${error}. ${instructions}`);\n  }\n}\n\nexport function createFunction(body, length) {\n  throwNoParse(fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS);\n  return fromExpression(body, length);\n}\n\nexport function createFunctionFromString(str, bindTo) {\n  throwNoParse(parse, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS);\n  const tpl = parse(str, { expression: true });\n  return function() {\n    return tpl.e.apply(bindTo, tpl.r.map(r => bindTo.get(r)));\n  };\n}\n\nconst parser = {\n  fromId(id, options) {\n    if (!doc) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Cannot retrieve template #${id} as Ractive is not running in a browser.`);\n    }\n\n    if (id) id = id.replace(/^#/, '');\n\n    let template;\n\n    if (!(template = doc.getElementById(id))) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Could not find template element with id #${id}`);\n    }\n\n    if (template.tagName.toUpperCase() !== 'SCRIPT') {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Template element with id #${id}, must be a <script> element`);\n    }\n\n    return 'textContent' in template ? template.textContent : template.innerHTML;\n  },\n\n  isParsed(template) {\n    return !isString(template);\n  },\n\n  getParseOptions(ractive) {\n    // Could be Ractive or a Component\n    if (ractive.defaults) {\n      ractive = ractive.defaults;\n    }\n\n    return parseOptions.reduce((val, key) => {\n      val[key] = ractive[key];\n      return val;\n    }, {});\n  },\n\n  parse(template, options) {\n    throwNoParse(parse, 'template', TEMPLATE_INSTRUCTIONS);\n    const parsed = parse(template, options);\n    addFunctions(parsed);\n    return parsed;\n  },\n\n  parseFor(template, ractive) {\n    return this.parse(template, this.getParseOptions(ractive));\n  }\n};\n\nexport default parser;\n","import { removeFromArray } from 'utils/array';\nimport { isFunction } from 'utils/is';\n\nlet id = 0;\n\nexport default class TransitionManager {\n  constructor(callback, parent) {\n    this.callback = callback;\n    this.parent = parent;\n\n    this.intros = [];\n    this.outros = [];\n\n    this.children = [];\n    this.totalChildren = this.outroChildren = 0;\n\n    this.detachQueue = [];\n    this.outrosComplete = false;\n\n    this.id = id++;\n\n    if (parent) {\n      parent.addChild(this);\n    }\n  }\n\n  add(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    transition.starting = true;\n    list.push(transition);\n  }\n\n  addChild(child) {\n    this.children.push(child);\n\n    this.totalChildren += 1;\n    this.outroChildren += 1;\n  }\n\n  checkStart() {\n    if (this.parent && this.parent.started) this.start();\n  }\n\n  decrementOutros() {\n    this.outroChildren -= 1;\n    check(this);\n  }\n\n  decrementTotal() {\n    this.totalChildren -= 1;\n    check(this);\n  }\n\n  detachNodes() {\n    let len = this.detachQueue.length;\n    for (let i = 0; i < len; i++) this.detachQueue[i].detach();\n    len = this.children.length;\n    for (let i = 0; i < len; i++) this.children[i].detachNodes();\n    this.detachQueue = [];\n  }\n\n  ready() {\n    if (this.detachQueue.length) detachImmediate(this);\n  }\n\n  remove(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    removeFromArray(list, transition);\n    check(this);\n  }\n\n  start() {\n    this.started = true;\n    this.children.forEach(c => c.start());\n    this.intros.concat(this.outros).forEach(t => t.start());\n    check(this);\n  }\n}\n\nfunction check(tm) {\n  if (!tm.started || tm.outros.length || tm.outroChildren) return;\n\n  // If all outros are complete, and we haven't already done this,\n  // we notify the parent if there is one, otherwise\n  // start detaching nodes\n  if (!tm.outrosComplete) {\n    tm.outrosComplete = true;\n\n    if (tm.parent) tm.parent.decrementOutros(tm);\n\n    if (!tm.parent || tm.parent.outrosComplete) {\n      tm.detachNodes();\n    }\n  }\n\n  // Once everything is done, we can notify parent transition\n  // manager and call the callback\n  if (!tm.intros.length && !tm.totalChildren) {\n    if (isFunction(tm.callback)) {\n      tm.callback();\n    }\n\n    if (tm.parent && !tm.notifiedTotal) {\n      tm.notifiedTotal = true;\n      tm.parent.decrementTotal();\n    }\n  }\n}\n\n// check through the detach queue to see if a node is up or downstream from a\n// transition and if not, go ahead and detach it\nfunction detachImmediate(manager) {\n  const queue = manager.detachQueue;\n  const outros = collectAllOutros(manager);\n\n  if (!outros.length) {\n    manager.detachNodes();\n  } else {\n    let i = queue.length;\n    let j = 0;\n    let node, trans;\n    const nqueue = (manager.detachQueue = []);\n\n    start: while (i--) {\n      node = queue[i].node;\n      j = outros.length;\n      while (j--) {\n        trans = outros[j].element.node;\n        // check to see if the node is, contains, or is contained by the transitioning node\n        if (trans === node || trans.contains(node) || node.contains(trans)) {\n          nqueue.push(queue[i]);\n          continue start;\n        }\n      }\n\n      // no match, we can drop it\n      queue[i].detach();\n    }\n  }\n}\n\nfunction collectAllOutros(manager, _list) {\n  let list = _list;\n\n  // if there's no list, we're starting at the root to build one\n  if (!list) {\n    list = [];\n    let parent = manager;\n    while (parent.parent) parent = parent.parent;\n    return collectAllOutros(parent, list);\n  } else {\n    // grab all outros from child managers\n    let i = manager.children.length;\n    while (i--) {\n      list = collectAllOutros(manager.children[i], list);\n    }\n\n    // grab any from this manager if there are any\n    if (manager.outros.length) list = list.concat(manager.outros);\n\n    return list;\n  }\n}\n","import { addToArray } from 'utils/array';\nimport TransitionManager from './TransitionManager';\n\nlet batch;\n\nconst runloop = {\n  active() {\n    return !!batch;\n  },\n\n  start() {\n    let fulfilPromise;\n    const promise = new Promise(f => (fulfilPromise = f));\n\n    batch = {\n      previousBatch: batch,\n      transitionManager: new TransitionManager(fulfilPromise, batch && batch.transitionManager),\n      fragments: [],\n      tasks: [],\n      immediateObservers: [],\n      deferredObservers: [],\n      promise\n    };\n\n    return promise;\n  },\n\n  end() {\n    flushChanges();\n\n    if (!batch.previousBatch) batch.transitionManager.start();\n    else batch.transitionManager.checkStart();\n\n    batch = batch.previousBatch;\n  },\n\n  addFragment(fragment) {\n    addToArray(batch.fragments, fragment);\n  },\n\n  // TODO: come up with a better way to handle fragments that trigger their own update\n  addFragmentToRoot(fragment) {\n    if (!batch) return;\n\n    let b = batch;\n    while (b.previousBatch) {\n      b = b.previousBatch;\n    }\n\n    addToArray(b.fragments, fragment);\n  },\n\n  addObserver(observer, defer) {\n    if (!batch) {\n      observer.dispatch();\n    } else {\n      addToArray(defer ? batch.deferredObservers : batch.immediateObservers, observer);\n    }\n  },\n\n  registerTransition(transition) {\n    transition._manager = batch.transitionManager;\n    batch.transitionManager.add(transition);\n  },\n\n  // synchronise node detachments with transition ends\n  detachWhenReady(thing) {\n    batch.transitionManager.detachQueue.push(thing);\n  },\n\n  scheduleTask(task, postRender) {\n    let _batch;\n\n    if (!batch) {\n      task();\n    } else {\n      _batch = batch;\n      while (postRender && _batch.previousBatch) {\n        // this can't happen until the DOM has been fully updated\n        // otherwise in some situations (with components inside elements)\n        // transitions and decorators will initialise prematurely\n        _batch = _batch.previousBatch;\n      }\n\n      _batch.tasks.push(task);\n    }\n  },\n\n  promise() {\n    if (!batch) return Promise.resolve();\n\n    let target = batch;\n    while (target.previousBatch) {\n      target = target.previousBatch;\n    }\n\n    return target.promise || Promise.resolve();\n  }\n};\n\nexport default runloop;\n\nfunction dispatch(observer) {\n  observer.dispatch();\n}\n\nfunction flushChanges() {\n  let which = batch.immediateObservers;\n  batch.immediateObservers = [];\n  which.forEach(dispatch);\n\n  // Now that changes have been fully propagated, we can update the DOM\n  // and complete other tasks\n  let i = batch.fragments.length;\n  let fragment;\n\n  which = batch.fragments;\n  batch.fragments = [];\n\n  while (i--) {\n    fragment = which[i];\n    fragment.update();\n  }\n\n  batch.transitionManager.ready();\n\n  which = batch.deferredObservers;\n  batch.deferredObservers = [];\n  which.forEach(dispatch);\n\n  const tasks = batch.tasks;\n  batch.tasks = [];\n\n  for (i = 0; i < tasks.length; i += 1) {\n    tasks[i]();\n  }\n\n  // If updating the view caused some model blowback - e.g. a triple\n  // containing <option> elements caused the binding on the <select>\n  // to update - then we start over\n  if (\n    batch.fragments.length ||\n    batch.immediateObservers.length ||\n    batch.deferredObservers.length ||\n    batch.tasks.length\n  )\n    return flushChanges();\n}\n","import runloop from 'src/global/runloop';\n\n// TODO what happens if a transition is aborted?\n\nconst tickers = [];\nlet running = false;\n\nfunction tick() {\n  runloop.start();\n\n  const now = performance.now();\n\n  let i;\n  let ticker;\n\n  for (i = 0; i < tickers.length; i += 1) {\n    ticker = tickers[i];\n\n    if (!ticker.tick(now)) {\n      // ticker is complete, remove it from the stack, and decrement i so we don't miss one\n      tickers.splice(i--, 1);\n    }\n  }\n\n  runloop.end();\n\n  if (tickers.length) {\n    requestAnimationFrame(tick);\n  } else {\n    running = false;\n  }\n}\n\nexport default class Ticker {\n  constructor(options) {\n    this.duration = options.duration;\n    this.step = options.step;\n    this.complete = options.complete;\n    this.easing = options.easing;\n\n    this.start = performance.now();\n    this.end = this.start + this.duration;\n\n    this.running = true;\n\n    tickers.push(this);\n    if (!running) requestAnimationFrame(tick);\n  }\n\n  tick(now) {\n    if (!this.running) return false;\n\n    if (now > this.end) {\n      if (this.step) this.step(1);\n      if (this.complete) this.complete(1);\n\n      return false;\n    }\n\n    const elapsed = now - this.start;\n    const eased = this.easing(elapsed / this.duration);\n\n    if (this.step) this.step(eased);\n\n    return true;\n  }\n\n  stop() {\n    if (this.abort) this.abort();\n    this.running = false;\n  }\n}\n","import { hasOwn } from 'utils/object';\nimport { isString, isObjectType } from 'utils/is';\n\nconst prefixers = {};\n\n// TODO this is legacy. sooner we can replace the old adaptor API the better\n/* istanbul ignore next */\nfunction prefixKeypath(obj, prefix) {\n  const prefixed = {};\n\n  if (!prefix) {\n    return obj;\n  }\n\n  prefix += '.';\n\n  for (const key in obj) {\n    if (hasOwn(obj, key)) {\n      prefixed[prefix + key] = obj[key];\n    }\n  }\n\n  return prefixed;\n}\n\nexport default function getPrefixer(rootKeypath) {\n  let rootDot;\n\n  if (!prefixers[rootKeypath]) {\n    rootDot = rootKeypath ? rootKeypath + '.' : '';\n\n    /* istanbul ignore next */\n    prefixers[rootKeypath] = function(relativeKeypath, value) {\n      let obj;\n\n      if (isString(relativeKeypath)) {\n        obj = {};\n        obj[rootDot + relativeKeypath] = value;\n        return obj;\n      }\n\n      if (isObjectType(relativeKeypath)) {\n        // 'relativeKeypath' is in fact a hash, not a keypath\n        return rootDot ? prefixKeypath(relativeKeypath, rootKeypath) : relativeKeypath;\n      }\n    };\n  }\n\n  return prefixers[rootKeypath];\n}\n","import ModelBase, { maybeBind, shuffle } from './ModelBase';\nimport LinkModel from './LinkModel'; // eslint-disable-line no-unused-vars\nimport getComputationSignature from 'src/Ractive/helpers/getComputationSignature';\nimport { capture } from 'src/global/capture';\nimport { isArray, isEqual, isNumeric, isObjectLike } from 'utils/is';\nimport { handleChange, mark, markForce, marked, teardown } from 'shared/methodCallers';\nimport Ticker from 'shared/Ticker';\nimport getPrefixer from './helpers/getPrefixer';\nimport { unescapeKey } from 'shared/keypaths';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn, keys } from 'utils/object';\nimport { buildNewIndices } from 'utils/array';\n\nexport const shared = {};\n\nexport default class Model extends ModelBase {\n  constructor(parent, key) {\n    super(parent);\n\n    this.ticker = null;\n\n    if (parent) {\n      this.key = unescapeKey(key);\n      this.isReadonly = parent.isReadonly;\n\n      if (parent.value) {\n        this.value = parent.value[this.key];\n        if (isArray(this.value)) this.length = this.value.length;\n        this.adapt();\n      }\n    }\n  }\n\n  adapt() {\n    const adaptors = this.root.adaptors;\n    const len = adaptors.length;\n\n    this.rewrap = false;\n\n    // Exit early if no adaptors\n    if (len === 0) return;\n\n    const value = this.wrapper\n      ? 'newWrapperValue' in this\n        ? this.newWrapperValue\n        : this.wrapperValue\n      : this.value;\n\n    // TODO remove this legacy nonsense\n    const ractive = this.root.ractive;\n    const keypath = this.getKeypath();\n\n    // tear previous adaptor down if present\n    if (this.wrapper) {\n      const shouldTeardown =\n        this.wrapperValue === value\n          ? false\n          : !this.wrapper.reset || this.wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        this.wrapper.teardown();\n        delete this.wrapper;\n        delete this.wrapperValue;\n        delete this.newWrapperValue;\n\n        // don't branch for undefined values\n        if (this.value !== undefined) {\n          const parentValue = this.parent.value || this.parent.createBranch(this.key);\n          if (parentValue[this.key] !== value) parentValue[this.key] = value;\n          this.value = value;\n        }\n      } else {\n        delete this.newWrapperValue;\n        this.value = this.wrapper.get();\n        return;\n      }\n    }\n\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const adaptor = adaptors[i];\n      if (adaptor.filter(value, keypath, ractive)) {\n        this.wrapper = adaptor.wrap(ractive, value, keypath, getPrefixer(keypath));\n        this.wrapperValue = value;\n        this.wrapper.__model = this; // massive temporary hack to enable array adaptor\n\n        this.value = this.wrapper.get();\n\n        break;\n      }\n    }\n  }\n\n  animate(from, to, options, interpolator) {\n    if (this.ticker) this.ticker.stop();\n\n    let fulfilPromise;\n    const promise = new Promise(fulfil => (fulfilPromise = fulfil));\n\n    this.ticker = new Ticker({\n      duration: options.duration,\n      easing: options.easing,\n      step: t => {\n        const value = interpolator(t);\n        this.applyValue(value);\n        if (options.step) options.step(t, value);\n      },\n      complete: () => {\n        this.applyValue(to);\n        if (options.complete) options.complete(to);\n\n        this.ticker = null;\n        fulfilPromise(to);\n      }\n    });\n\n    promise.stop = this.ticker.stop;\n    return promise;\n  }\n\n  applyValue(value, notify = true) {\n    if (isEqual(value, this.value)) return;\n    if (this.boundValue) this.boundValue = null;\n\n    if (this.parent.wrapper && this.parent.wrapper.set) {\n      this.parent.wrapper.set(this.key, value);\n      this.parent.value = this.parent.wrapper.get();\n\n      this.value = this.parent.value[this.key];\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    } else if (this.wrapper) {\n      this.newWrapperValue = value;\n      this.adapt();\n    } else {\n      const parentValue = this.parent.value || this.parent.createBranch(this.key);\n      if (isObjectLike(parentValue)) {\n        parentValue[this.key] = value;\n      } else {\n        warnIfDebug(`Attempted to set a property of a non-object '${this.getKeypath()}'`);\n        return;\n      }\n\n      this.value = value;\n      this.adapt();\n    }\n\n    // keep track of array stuff\n    if (isArray(value)) {\n      this.length = value.length;\n      this.isArray = true;\n    } else {\n      this.isArray = false;\n    }\n\n    // notify dependants\n    this.links.forEach(handleChange);\n    this.children.forEach(mark);\n    this.deps.forEach(handleChange);\n\n    if (notify) this.notifyUpstream();\n\n    if (this.parent.isArray) {\n      if (this.key === 'length') this.parent.length = value;\n      else this.parent.joinKey('length').mark();\n    }\n  }\n\n  compute(key, computed) {\n    const registry = this.computed || (this.computed = {});\n\n    if (registry[key]) {\n      registry[key].signature = getComputationSignature(this.root.ractive, key, computed);\n      registry[key].mark();\n    } else {\n      registry[key] = new shared.Computation(\n        this,\n        getComputationSignature(this.root.ractive, key, computed),\n        key\n      );\n    }\n\n    return registry[key];\n  }\n\n  createBranch(key) {\n    const branch = isNumeric(key) ? [] : {};\n    this.applyValue(branch, false);\n\n    return branch;\n  }\n\n  get(shouldCapture, opts) {\n    if (this._link) return this._link.get(shouldCapture, opts);\n    if (shouldCapture) capture(this);\n    // if capturing, this value needs to be unwrapped because it's for external use\n    if (opts && opts.virtual) return this.getVirtual(false);\n    return maybeBind(\n      this,\n      (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  joinKey(key, opts) {\n    if (this._link) {\n      if (opts && opts.lastLink !== false && (key === undefined || key === '')) return this;\n      return this._link.joinKey(key);\n    }\n\n    if (key === undefined || key === '') return this;\n\n    let child;\n    if (hasOwn(this.childByKey, key)) child = this.childByKey[key];\n    else child = this.computed && this.computed[key];\n\n    if (!child) {\n      let computed;\n      if (this.isRoot && this.ractive && (computed = this.ractive.computed[key])) {\n        child = this.compute(key, computed);\n      } else if (!this.isRoot && this.root.ractive) {\n        const registry = this.root.ractive.computed;\n        for (const k in registry) {\n          computed = registry[k];\n          if (computed.pattern && computed.pattern.test(this.getKeypath() + '.' + key)) {\n            child = this.compute(key, computed);\n          }\n        }\n      }\n    }\n\n    if (!child) {\n      child = new Model(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    if (child._link && (!opts || opts.lastLink !== false)) return child._link;\n\n    return child;\n  }\n\n  mark(force) {\n    if (this._link) return this._link.mark(force);\n\n    const old = this.value;\n    const value = this.retrieve();\n\n    if (force || !isEqual(value, old)) {\n      this.value = value;\n      if (this.boundValue) this.boundValue = null;\n\n      // make sure the wrapper stays in sync\n      if (old !== value || this.rewrap) {\n        if (this.wrapper) this.newWrapperValue = value;\n        this.adapt();\n      }\n\n      // keep track of array stuff\n      if (isArray(value)) {\n        this.length = value.length;\n        this.isArray = true;\n      } else {\n        this.isArray = false;\n      }\n\n      this.children.forEach(force ? markForce : mark);\n      this.links.forEach(marked);\n\n      this.deps.forEach(handleChange);\n    }\n  }\n\n  merge(array, comparator) {\n    const newIndices = buildNewIndices(\n      this.value === array ? recreateArray(this) : this.value,\n      array,\n      comparator\n    );\n    this.parent.value[this.key] = array;\n    this.shuffle(newIndices, true);\n  }\n\n  retrieve() {\n    return this.parent.value ? this.parent.value[this.key] : undefined;\n  }\n\n  set(value) {\n    if (this.ticker) this.ticker.stop();\n    this.applyValue(value);\n  }\n\n  shuffle(newIndices, unsafe) {\n    shuffle(this, newIndices, false, unsafe);\n  }\n\n  source() {\n    return this;\n  }\n\n  teardown() {\n    if (this._link) {\n      this._link.teardown();\n      this._link = null;\n    }\n    this.children.forEach(teardown);\n    if (this.wrapper) this.wrapper.teardown();\n    if (this.computed) keys(this.computed).forEach(k => this.computed[k].teardown());\n  }\n}\n\nfunction recreateArray(model) {\n  const array = [];\n\n  for (let i = 0; i < model.length; i++) {\n    array[i] = (model.childByKey[i] || {}).value;\n  }\n\n  return array;\n}\n","/* global global */\nimport Model from '../Model';\nimport { base } from 'config/environment';\n\nexport const data = {};\n\nexport class SharedModel extends Model {\n  constructor(value, name, ractive) {\n    super(null, `@${name}`);\n    this.key = `@${name}`;\n    this.value = value;\n    this.isRoot = true;\n    this.root = this;\n    this.adaptors = [];\n    this.ractive = ractive;\n  }\n\n  getKeypath() {\n    return this.key;\n  }\n\n  retrieve() {\n    return this.value;\n  }\n}\n\nexport default new SharedModel(data, 'shared');\n\nexport const GlobalModel = new SharedModel(base, 'global');\n","import noop from 'utils/noop';\nimport { assign, create } from 'utils/object';\n\nexport const extern = {};\n\nexport default function getRactiveContext(ractive, ...assigns) {\n  const fragment =\n    ractive.fragment ||\n    ractive._fakeFragment ||\n    (ractive._fakeFragment = new FakeFragment(ractive));\n  return fragment.getContext.apply(fragment, assigns);\n}\n\nexport function getContext(...assigns) {\n  if (!this.ctx) this.ctx = new extern.Context(this);\n  assigns.unshift(create(this.ctx));\n  return assign.apply(null, assigns);\n}\n\nexport class FakeFragment {\n  constructor(ractive) {\n    this.ractive = ractive;\n  }\n\n  findContext() {\n    return this.ractive.viewmodel;\n  }\n}\nconst proto = FakeFragment.prototype;\nproto.getContext = getContext;\nproto.find = proto.findComponent = proto.findAll = proto.findAllComponents = noop;\n\nexport function findParentWithContext(fragment) {\n  let frag = fragment;\n  while (frag && !frag.context) frag = frag.parent;\n  if (!frag) return fragment && fragment.ractive.fragment;\n  else return frag;\n}\n","import { isArray, isObject, isObjectType, isFunction, isString } from 'utils/is';\nimport { warnIfDebug } from 'utils/log';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from '../global/runloop';\nimport { splitKeypath } from './keypaths';\nimport { FakeFragment } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\n\nexport let keep = false;\n\nexport function set(pairs, options) {\n  const k = keep;\n\n  const deep = options && options.deep;\n  const shuffle = options && options.shuffle;\n  const promise = runloop.start();\n  if (options && 'keep' in options) keep = options.keep;\n\n  let i = pairs.length;\n  while (i--) {\n    const model = pairs[i][0];\n    const value = pairs[i][1];\n    const keypath = pairs[i][2];\n\n    if (!model) {\n      runloop.end();\n      throw new Error(`Failed to set invalid keypath '${keypath}'`);\n    }\n\n    if (deep) deepSet(model, value);\n    else if (shuffle) {\n      let array = value;\n      const target = model.get();\n      // shuffle target array with itself\n      if (!array) array = target;\n\n      // if there's not an array there yet, go ahead and set\n      if (target === undefined) {\n        model.set(array);\n      } else {\n        if (!isArray(target) || !isArray(array)) {\n          runloop.end();\n          throw new Error('You cannot merge an array with a non-array');\n        }\n\n        const comparator = getComparator(shuffle);\n        model.merge(array, comparator);\n      }\n    } else model.set(value);\n  }\n\n  runloop.end();\n\n  keep = k;\n\n  return promise;\n}\n\nconst star = /\\*/;\nexport function gather(ractive, keypath, base, isolated) {\n  if (!base && (keypath[0] === '.' || keypath[1] === '^')) {\n    warnIfDebug(\n      `Attempted to set a relative keypath from a non-relative context. You can use a context object to set relative keypaths.`\n    );\n    return [];\n  }\n\n  const keys = splitKeypath(keypath);\n  const model = base || ractive.viewmodel;\n\n  if (star.test(keypath)) {\n    return model.findMatches(keys);\n  } else {\n    if (model === ractive.viewmodel) {\n      // allow implicit mappings\n      if (\n        ractive.component &&\n        !ractive.isolated &&\n        !model.has(keys[0]) &&\n        keypath[0] !== '@' &&\n        keypath[0] &&\n        !isolated\n      ) {\n        return [resolveReference(ractive.fragment || new FakeFragment(ractive), keypath)];\n      } else {\n        return [model.joinAll(keys)];\n      }\n    } else {\n      return [model.joinAll(keys)];\n    }\n  }\n}\n\nexport function build(ractive, keypath, value, isolated) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push.apply(sets, gather(ractive, k, null, isolated).map(m => [m, keypath[k], k]));\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push.apply(sets, gather(ractive, keypath, null, isolated).map(m => [m, value, keypath]));\n  }\n\n  return sets;\n}\n\nconst deepOpts = { virtual: false };\nfunction deepSet(model, value) {\n  const dest = model.get(false, deepOpts);\n\n  // if dest doesn't exist, just set it\n  if (dest == null || !isObjectType(value)) return model.set(value);\n  if (!isObjectType(dest)) return model.set(value);\n\n  for (const k in value) {\n    if (hasOwn(value, k)) {\n      deepSet(model.joinKey(k), value[k]);\n    }\n  }\n}\n\nconst comparators = {};\nfunction getComparator(option) {\n  if (option === true) return null; // use existing arrays\n  if (isFunction(option)) return option;\n\n  if (isString(option)) {\n    return comparators[option] || (comparators[option] = thing => thing[option]);\n  }\n\n  throw new Error('If supplied, options.compare must be a string, function, or true'); // TODO link to docs\n}\n","import { isNumeric, isString } from 'utils/is';\nimport { build, set } from 'shared/set';\n\nconst errorMessage = 'Cannot add to a non-numeric value';\n\nexport default function add(ractive, keypath, d, options) {\n  if (!isString(keypath) || !isNumeric(d)) {\n    throw new Error('Bad arguments');\n  }\n\n  const sets = build(ractive, keypath, d, options && options.isolated);\n\n  return set(\n    sets.map(pair => {\n      const [model, add] = pair;\n      const value = model.get();\n      if (!isNumeric(add) || !isNumeric(value)) throw new Error(errorMessage);\n      return [model, value + add];\n    })\n  );\n}\n","import runloop from 'src/global/runloop';\nimport easing from 'src/Ractive/static/easing';\nimport interpolate from 'shared/interpolate';\nimport { isEqual, isFunction, isObjectType } from 'utils/is';\nimport noop from 'utils/noop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { defineProperty, keys as objectKeys } from 'utils/object';\n\nfunction immediate(value) {\n  const result = Promise.resolve(value);\n  defineProperty(result, 'stop', { value: noop });\n  return result;\n}\n\nconst linear = easing.linear;\n\nfunction getOptions(options, instance) {\n  options = options || {};\n\n  let easing;\n  if (options.easing) {\n    easing = isFunction(options.easing) ? options.easing : instance.easing[options.easing];\n  }\n\n  return {\n    easing: easing || linear,\n    duration: 'duration' in options ? options.duration : 400,\n    complete: options.complete || noop,\n    step: options.step || noop,\n    interpolator: options.interpolator\n  };\n}\n\nexport function animate(ractive, model, to, options) {\n  options = getOptions(options, ractive);\n  const from = model.get();\n\n  // don't bother animating values that stay the same\n  if (isEqual(from, to)) {\n    options.complete(options.to);\n    return immediate(to);\n  }\n\n  const interpolator = interpolate(from, to, ractive, options.interpolator);\n\n  // if we can't interpolate the value, set it immediately\n  if (!interpolator) {\n    runloop.start();\n    model.set(to);\n    runloop.end();\n\n    return immediate(to);\n  }\n\n  return model.animate(from, to, options, interpolator);\n}\n\nexport default function Ractive$animate(keypath, to, options) {\n  if (isObjectType(keypath)) {\n    const keys = objectKeys(keypath);\n\n    throw new Error(`ractive.animate(...) no longer supports objects. Instead of ractive.animate({\n  ${keys.map(key => `'${key}': ${keypath[key]}`).join('\\n  ')}\n}, {...}), do\n\n${keys.map(key => `ractive.animate('${key}', ${keypath[key]}, {...});`).join('\\n')}\n`);\n  }\n\n  return animate(this, this.viewmodel.joinAll(splitKeypath(keypath)), to, options);\n}\n","import { enqueue, dequeue } from './eventStack';\n\nconst initStars = {};\nconst bubbleStars = {};\n\n// cartesian product of name parts and stars\n// adjusted appropriately for special cases\nfunction variants(name, initial) {\n  const map = initial ? initStars : bubbleStars;\n  if (map[name]) return map[name];\n\n  const parts = name.split('.');\n  const result = [];\n  let base = false;\n\n  // initial events the implicit namespace of 'this'\n  if (initial) {\n    parts.unshift('this');\n    base = true;\n  }\n\n  // use max - 1 bits as a bitmap to pick a part or a *\n  // need to skip the full star case if the namespace is synthetic\n  const max = Math.pow(2, parts.length) - (initial ? 1 : 0);\n  for (let i = 0; i < max; i++) {\n    const join = [];\n    for (let j = 0; j < parts.length; j++) {\n      join.push(1 & (i >> j) ? '*' : parts[j]);\n    }\n    result.unshift(join.join('.'));\n  }\n\n  if (base) {\n    // include non-this-namespaced versions\n    if (parts.length > 2) {\n      result.push.apply(result, variants(name, false));\n    } else {\n      result.push('*');\n      result.push(name);\n    }\n  }\n\n  map[name] = result;\n  return result;\n}\n\nexport default function fireEvent(ractive, eventName, context, args = []) {\n  if (!eventName) {\n    return;\n  }\n\n  context.name = eventName;\n  args.unshift(context);\n\n  const eventNames = ractive._nsSubs ? variants(eventName, true) : ['*', eventName];\n\n  return fireEventAs(ractive, eventNames, context, args, true);\n}\n\nfunction fireEventAs(ractive, eventNames, context, args, initialFire = false) {\n  let bubble = true;\n\n  if (initialFire || ractive._nsSubs) {\n    enqueue(ractive, context);\n\n    let i = eventNames.length;\n    while (i--) {\n      if (eventNames[i] in ractive._subs) {\n        bubble = notifySubscribers(ractive, ractive._subs[eventNames[i]], context, args) && bubble;\n      }\n    }\n\n    dequeue(ractive);\n  }\n\n  if (ractive.parent && bubble) {\n    if (initialFire && ractive.component) {\n      const fullName = ractive.component.name + '.' + eventNames[eventNames.length - 1];\n      eventNames = variants(fullName, false);\n\n      if (context && !context.component) {\n        context.component = ractive;\n      }\n    }\n\n    bubble = fireEventAs(ractive.parent, eventNames, context, args);\n  }\n\n  return bubble;\n}\n\nfunction notifySubscribers(ractive, subscribers, context, args) {\n  let originalEvent = null;\n  let stopEvent = false;\n\n  // subscribers can be modified inflight, e.g. \"once\" functionality\n  // so we need to copy to make sure everyone gets called\n  subscribers = subscribers.slice();\n\n  for (let i = 0, len = subscribers.length; i < len; i += 1) {\n    if (!subscribers[i].off && subscribers[i].handler.apply(ractive, args) === false) {\n      stopEvent = true;\n    }\n  }\n\n  if (context && stopEvent && (originalEvent = context.event)) {\n    originalEvent.preventDefault && originalEvent.preventDefault();\n    originalEvent.stopPropagation && originalEvent.stopPropagation();\n  }\n\n  return !stopEvent;\n}\n","import fireEvent from './fireEvent';\nimport getRactiveContext from '../shared/getRactiveContext';\n\nexport class Hook {\n  constructor(event) {\n    this.event = event;\n    this.method = 'on' + event;\n  }\n\n  fire(ractive, arg) {\n    const context = getRactiveContext(ractive);\n    const method = this.method;\n\n    if (ractive[method]) {\n      arg ? ractive[method](context, arg) : ractive[method](context);\n    }\n\n    fireEvent(ractive, this.event, context, arg ? [arg, ractive] : [ractive]);\n  }\n}\n\nfunction getChildQueue(queue, ractive) {\n  return queue[ractive._guid] || (queue[ractive._guid] = []);\n}\n\nfunction fire(hookQueue, ractive) {\n  const childQueue = getChildQueue(hookQueue.queue, ractive);\n\n  hookQueue.hook.fire(ractive);\n\n  // queue is \"live\" because components can end up being\n  // added while hooks fire on parents that modify data values.\n  while (childQueue.length) {\n    fire(hookQueue, childQueue.shift());\n  }\n\n  delete hookQueue.queue[ractive._guid];\n}\n\nexport class HookQueue {\n  constructor(event) {\n    this.hook = new Hook(event);\n    this.inProcess = {};\n    this.queue = {};\n  }\n\n  begin(ractive) {\n    this.inProcess[ractive._guid] = true;\n  }\n\n  end(ractive) {\n    const parent = ractive.parent;\n\n    // If this is *isn't* a child of a component that's in process,\n    // it should call methods or fire at this point\n    if (!parent || !this.inProcess[parent._guid]) {\n      fire(this, ractive);\n    } else {\n      // elsewise, handoff to parent to fire when ready\n      getChildQueue(this.queue, parent).push(ractive);\n    }\n\n    delete this.inProcess[ractive._guid];\n  }\n}\n\nconst hooks = {};\n[\n  'construct',\n  'config',\n  'attachchild',\n  'detach',\n  'detachchild',\n  'insert',\n  'complete',\n  'reset',\n  'render',\n  'unrendering',\n  'unrender',\n  'teardown',\n  'destruct',\n  'update'\n].forEach(hook => {\n  hooks[hook] = new Hook(hook);\n});\nhooks.init = new HookQueue('init');\n\nexport default hooks;\n","export const TEXT = 1;\nexport const INTERPOLATOR = 2;\nexport const TRIPLE = 3;\nexport const SECTION = 4;\nexport const INVERTED = 5;\nexport const CLOSING = 6;\nexport const ELEMENT = 7;\nexport const PARTIAL = 8;\nexport const COMMENT = 9;\nexport const DELIMCHANGE = 10;\nexport const ANCHOR = 11;\nexport const ATTRIBUTE = 13;\nexport const CLOSING_TAG = 14;\nexport const COMPONENT = 15;\nexport const YIELDER = 16;\nexport const INLINE_PARTIAL = 17;\nexport const DOCTYPE = 18;\nexport const ALIAS = 19;\n\nexport const AWAIT = 55;\n\nexport const NUMBER_LITERAL = 20;\nexport const STRING_LITERAL = 21;\nexport const ARRAY_LITERAL = 22;\nexport const OBJECT_LITERAL = 23;\nexport const BOOLEAN_LITERAL = 24;\nexport const REGEXP_LITERAL = 25;\n\nexport const GLOBAL = 26;\nexport const KEY_VALUE_PAIR = 27;\n\nexport const REFERENCE = 30;\nexport const REFINEMENT = 31;\nexport const MEMBER = 32;\nexport const PREFIX_OPERATOR = 33;\nexport const BRACKETED = 34;\nexport const CONDITIONAL = 35;\nexport const INFIX_OPERATOR = 36;\n\nexport const INVOCATION = 40;\n\nexport const SECTION_IF = 50;\nexport const SECTION_UNLESS = 51;\nexport const SECTION_EACH = 52;\nexport const SECTION_WITH = 53;\nexport const SECTION_IF_WITH = 54;\n\nexport const ELSE = 60;\nexport const ELSEIF = 61;\nexport const THEN = 62;\nexport const CATCH = 63;\n\nexport const EVENT = 70;\nexport const DECORATOR = 71;\nexport const TRANSITION = 72;\nexport const BINDING_FLAG = 73;\nexport const DELEGATE_FLAG = 74;\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\nimport getNewIndices from 'shared/getNewIndices';\nimport { isArray } from 'utils/is';\n\nconst arrayProto = Array.prototype;\n\nexport default function(methodName) {\n  function path(keypath, ...args) {\n    return model(this.viewmodel.joinAll(splitKeypath(keypath)), args);\n  }\n\n  function model(mdl, args) {\n    let array = mdl.get();\n\n    if (!isArray(array)) {\n      if (array === undefined) {\n        array = [];\n        const result = arrayProto[methodName].apply(array, args);\n        const promise = runloop.start().then(() => result);\n        mdl.set(array);\n        runloop.end();\n        return promise;\n      } else {\n        throw new Error(\n          `shuffle array method ${methodName} called on non-array at ${mdl.getKeypath()}`\n        );\n      }\n    }\n\n    const newIndices = getNewIndices(array.length, methodName, args);\n    const result = arrayProto[methodName].apply(array, args);\n\n    const promise = runloop.start().then(() => result);\n    promise.result = result;\n\n    if (newIndices) {\n      if (mdl.shuffle) {\n        mdl.shuffle(newIndices);\n      } else {\n        // it's a computation, which don't have a shuffle, so just invalidate\n        mdl.mark();\n      }\n    } else {\n      mdl.set(result);\n    }\n\n    runloop.end();\n\n    return promise;\n  }\n\n  return { path, model };\n}\n","import resolveReference from 'src/view/resolvers/resolveReference';\nimport Model from 'src/model/Model';\nimport { isNumeric, isObject, isNumber, isObjectType, isString } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport findElement from 'src/view/items/shared/findElement';\nimport { set as sharedSet } from './set';\nimport makeArrayMethod from '../Ractive/prototype/shared/makeArrayMethod';\nimport { animate as protoAnimate } from '../Ractive/prototype/animate';\nimport { update as protoUpdate } from '../Ractive/prototype/update';\nimport getRactiveContext, { extern, findParentWithContext } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\nimport { ELEMENT } from 'config/types';\n\nconst modelPush = makeArrayMethod('push').model;\nconst modelPop = makeArrayMethod('pop').model;\nconst modelShift = makeArrayMethod('shift').model;\nconst modelUnshift = makeArrayMethod('unshift').model;\nconst modelSort = makeArrayMethod('sort').model;\nconst modelSplice = makeArrayMethod('splice').model;\nconst modelReverse = makeArrayMethod('reverse').model;\n\nclass ContextData extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.value = {};\n    this.ractive = options.ractive;\n    this.adaptors = [];\n    this.context = options.context;\n  }\n\n  getKeypath() {\n    return '@context.data';\n  }\n\n  rebound() {}\n}\n\nexport default class Context {\n  constructor(fragment, element) {\n    this.fragment = fragment;\n    this.element = element || findElement(fragment);\n    this.node = this.element && this.element.node;\n    this.ractive = fragment.ractive;\n    this.root = this;\n  }\n\n  get decorators() {\n    const items = {};\n    if (!this.element) return items;\n    this.element.decorators.forEach(d => (items[d.name] = d.handle));\n    return items;\n  }\n\n  get _data() {\n    return (\n      this.model ||\n      (this.root.model = new ContextData({\n        ractive: this.ractive,\n        context: this.root\n      }))\n    );\n  }\n\n  // the usual mutation suspects\n  add(keypath, d, options) {\n    const num = isNumber(d) ? +d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value + val];\n      }),\n      opts\n    );\n  }\n\n  animate(keypath, value, options) {\n    const model = findModel(this, keypath).model;\n    return protoAnimate(this.ractive, model, value, options);\n  }\n\n  find(selector) {\n    return this.fragment.find(selector);\n  }\n\n  findAll(selector) {\n    const result = [];\n    this.fragment.findAll(selector, { result });\n    return result;\n  }\n\n  findAllComponents(selector) {\n    const result = [];\n    this.fragment.findAllComponents(selector, { result });\n    return result;\n  }\n\n  findComponent(selector) {\n    return this.fragment.findComponent(selector);\n  }\n\n  // get relative keypaths and values\n  get(keypath) {\n    if (!keypath) return this.fragment.findContext().get(true);\n\n    const { model } = findModel(this, keypath);\n\n    return model ? model.get(true) : undefined;\n  }\n\n  getParent(component) {\n    let fragment = this.fragment;\n\n    if (fragment.context)\n      fragment = findParentWithContext(fragment.parent || (component && fragment.componentParent));\n    else {\n      fragment = findParentWithContext(fragment.parent || (component && fragment.componentParent));\n      if (fragment)\n        fragment = findParentWithContext(\n          fragment.parent || (component && fragment.componentParent)\n        );\n    }\n\n    if (!fragment || fragment === this.fragment) return;\n    else return fragment.getContext();\n  }\n\n  hasListener(name, bubble) {\n    // if the owner is a component, start there because the nearest element\n    // may exist outside of the immediate context (yield)\n    let el = this.fragment.owner.component\n      ? this.fragment.owner\n      : this.element || this.fragment.owner;\n    let base;\n\n    do {\n      base = el.component || el;\n      if (base.template.t === ELEMENT) {\n        if (findEvent(base, name)) return true;\n      }\n      el = el.up && el.up.owner;\n      if (el && el.component) el = el.component;\n    } while (el && bubble);\n  }\n\n  link(source, dest) {\n    const there = findModel(this, source).model;\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    here.link(there, source);\n    runloop.end();\n    return promise;\n  }\n\n  listen(event, handler) {\n    const el = this.element;\n    el.on(event, handler);\n    return {\n      cancel() {\n        el.off(event, handler);\n      }\n    };\n  }\n\n  observe(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observe(keypath, callback, options);\n  }\n\n  observeOnce(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observeOnce(keypath, callback, options);\n  }\n\n  pop(keypath) {\n    return modelPop(findModel(this, keypath).model, []);\n  }\n\n  push(keypath, ...values) {\n    return modelPush(findModel(this, keypath).model, values);\n  }\n\n  raise(name, event, ...args) {\n    let el = this.element;\n    let ev;\n\n    while (el) {\n      if (el.component) el = el.component;\n      ev = findEvent(el, name);\n      if (ev) {\n        return ev.fire(\n          ev.element.getContext(\n            event || {},\n            event && !('original' in event) ? { original: {} } : {}\n          ),\n          args\n        );\n      }\n\n      el = el.up && el.up.owner;\n    }\n  }\n\n  readLink(keypath, options) {\n    return this.ractive.readLink(this.resolve(keypath), options);\n  }\n\n  resolve(path, ractive) {\n    const { model, instance } = findModel(this, path);\n    return model ? model.getKeypath(ractive || instance) : path;\n  }\n\n  reverse(keypath) {\n    return modelReverse(findModel(this, keypath).model, []);\n  }\n\n  set(keypath, value, options) {\n    return sharedSet(build(this, keypath, value), options);\n  }\n\n  shift(keypath) {\n    return modelShift(findModel(this, keypath).model, []);\n  }\n\n  splice(keypath, index, drop, ...add) {\n    add.unshift(index, drop);\n    return modelSplice(findModel(this, keypath).model, add);\n  }\n\n  sort(keypath) {\n    return modelSort(findModel(this, keypath).model, []);\n  }\n\n  subtract(keypath, d, options) {\n    const num = isNumber(d) ? d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value - val];\n      }),\n      opts\n    );\n  }\n\n  toggle(keypath, options) {\n    const { model } = findModel(this, keypath);\n    return sharedSet([[model, !model.get()]], options);\n  }\n\n  unlink(dest) {\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    if (here.owner && here.owner._link) here.owner.unlink();\n    runloop.end();\n    return promise;\n  }\n\n  unlisten(event, handler) {\n    this.element.off(event, handler);\n  }\n\n  unshift(keypath, ...add) {\n    return modelUnshift(findModel(this, keypath).model, add);\n  }\n\n  update(keypath, options) {\n    return protoUpdate(this.ractive, findModel(this, keypath).model, options);\n  }\n\n  updateModel(keypath, cascade) {\n    const { model } = findModel(this, keypath);\n    const promise = runloop.start();\n    model.updateFromBindings(cascade);\n    runloop.end();\n    return promise;\n  }\n\n  // two-way binding related helpers\n  isBound() {\n    const { model } = this.getBindingModel(this);\n    return !!model;\n  }\n\n  getBindingPath(ractive) {\n    const { model, instance } = this.getBindingModel(this);\n    if (model) return model.getKeypath(ractive || instance);\n  }\n\n  getBinding() {\n    const { model } = this.getBindingModel(this);\n    if (model) return model.get(true);\n  }\n\n  getBindingModel(ctx) {\n    const el = ctx.element;\n    return { model: el.binding && el.binding.model, instance: el.up.ractive };\n  }\n\n  setBinding(value) {\n    const { model } = this.getBindingModel(this);\n    return sharedSet([[model, value]]);\n  }\n}\n\nContext.forRactive = getRactiveContext;\n// circular deps are fun\nextern.Context = Context;\n\n// TODO: at some point perhaps this could support relative * keypaths?\nfunction build(ctx, keypath, value) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push([findModel(ctx, k).model, keypath[k]]);\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push([findModel(ctx, keypath).model, value]);\n  }\n\n  return sets;\n}\n\nfunction findModel(ctx, path) {\n  const frag = ctx.fragment;\n\n  if (!isString(path)) {\n    return { model: frag.findContext(), instance: path };\n  }\n\n  return { model: resolveReference(frag, path), instance: frag.ractive };\n}\n\nfunction findEvent(el, name) {\n  return el.events && el.events.find && el.events.find(e => ~e.template.n.indexOf(name));\n}\n","import { doc } from 'config/environment';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { isString } from 'utils/is';\n\nconst query = doc && doc.querySelector;\n\nexport default function getContext(node) {\n  if (isString(node) && query) {\n    node = query.call(document, node);\n  }\n\n  let instances;\n  if (node) {\n    if (node._ractive) {\n      return node._ractive.proxy.getContext();\n    } else if ((instances = node.__ractive_instances__)) {\n      if (instances.length === 1) return getRactiveContext(instances[0]);\n    } else return getContext(node.parentNode);\n  }\n}\n","export const html = 'http://www.w3.org/1999/xhtml';\nexport const mathml = 'http://www.w3.org/1998/Math/MathML';\nexport const svg = 'http://www.w3.org/2000/svg';\nexport const xlink = 'http://www.w3.org/1999/xlink';\nexport const xml = 'http://www.w3.org/XML/1998/namespace';\nexport const xmlns = 'http://www.w3.org/2000/xmlns';\n\nexport default { html, mathml, svg, xlink, xml, xmlns };\n","import noop from 'utils/noop';\nimport { isFunction } from 'utils/is';\n\nexport default function wrap(parent, name, method) {\n  if (!/_super/.test(method)) return method;\n\n  function wrapper() {\n    const superMethod = getSuperMethod(wrapper._parent, name);\n    const hasSuper = '_super' in this;\n    const oldSuper = this._super;\n\n    this._super = superMethod;\n\n    const result = method.apply(this, arguments);\n\n    if (hasSuper) {\n      this._super = oldSuper;\n    } else {\n      delete this._super;\n    }\n\n    return result;\n  }\n\n  wrapper._parent = parent;\n  wrapper._method = method;\n\n  return wrapper;\n}\n\nfunction getSuperMethod(parent, name) {\n  if (name in parent) {\n    const value = parent[name];\n\n    return isFunction(value) ? value : () => value;\n  }\n\n  return noop;\n}\n","import { warnIfDebug } from 'utils/log';\nimport { isArray } from 'utils/is';\n\nfunction getMessage(deprecated, correct, isError) {\n  return (\n    `options.${deprecated} has been deprecated in favour of options.${correct}.` +\n    (isError ? ` You cannot specify both options, please use options.${correct}.` : '')\n  );\n}\n\nfunction deprecateOption(options, deprecatedOption, correct) {\n  if (deprecatedOption in options) {\n    if (!(correct in options)) {\n      warnIfDebug(getMessage(deprecatedOption, correct));\n      options[correct] = options[deprecatedOption];\n    } else {\n      throw new Error(getMessage(deprecatedOption, correct, true));\n    }\n  }\n}\n\nexport default function deprecate(options) {\n  deprecateOption(options, 'beforeInit', 'onconstruct');\n  deprecateOption(options, 'init', 'onrender');\n  deprecateOption(options, 'complete', 'oncomplete');\n  deprecateOption(options, 'eventDefinitions', 'events');\n\n  // Using extend with Component instead of options,\n  // like Human.extend( Spider ) means adaptors as a registry\n  // gets copied to options. So we have to check if actually an array\n  if (isArray(options.adaptors)) {\n    deprecateOption(options, 'adaptors', 'adapt');\n  }\n}\n","import resolveReference from './resolveReference';\nimport ExpressionProxy from './ExpressionProxy';\nimport ReferenceExpressionProxy from './ReferenceExpressionProxy';\n\nexport default function resolve(fragment, template) {\n  if (template.r) {\n    return resolveReference(fragment, template.r);\n  } else if (template.x) {\n    return new ExpressionProxy(fragment, template.x);\n  } else if (template.rx) {\n    return new ReferenceExpressionProxy(fragment, template.rx);\n  }\n}\n","export default function(camelCaseStr) {\n  return camelCaseStr.replace(/([A-Z])/g, (match, $1) => {\n    return '-' + $1.toLowerCase();\n  });\n}\n","import hooks from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\nimport { cancel } from 'shared/methodCallers';\nimport { warnIfDebug } from 'utils/log';\n\n// Teardown. This goes through the root fragment and all its children, removing observers\n// and generally cleaning up after itself\n\nexport default function Ractive$teardown() {\n  if (this.torndown) {\n    warnIfDebug('ractive.teardown() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  this.shouldDestroy = true;\n  return teardown(this, () => (this.fragment.rendered ? this.unrender() : Promise.resolve()));\n}\n\nexport function teardown(instance, getPromise) {\n  instance.torndown = true;\n  instance.fragment.unbind();\n  instance._observers.slice().forEach(cancel);\n\n  if (instance.el && instance.el.__ractive_instances__) {\n    removeFromArray(instance.el.__ractive_instances__, instance);\n  }\n\n  const promise = getPromise();\n\n  hooks.teardown.fire(instance);\n\n  promise.then(() => {\n    hooks.destruct.fire(instance);\n    instance.viewmodel.teardown();\n  });\n\n  return promise;\n}\n","import { create, toPairs } from 'utils/object';\nimport { isFunction, isObjectType } from 'utils/is';\n\nexport default function subscribe(instance, options, type) {\n  const subs = (instance.constructor[`_${type}`] || []).concat(toPairs(options[type] || []));\n  const single = type === 'on' ? 'once' : `${type}Once`;\n\n  subs.forEach(([target, config]) => {\n    if (isFunction(config)) {\n      instance[type](target, config);\n    } else if (isObjectType(config) && isFunction(config.handler)) {\n      instance[config.once ? single : type](target, config.handler, create(config));\n    }\n  });\n}\n","import getFunction from 'shared/getFunction';\nimport resolveReference from '../../resolvers/resolveReference';\n\nexport function setupArgsFn(item, template, fragment, opts = {}) {\n  if (template && template.f && template.f.s) {\n    item.fn = getFunction(template.f.s, template.f.r.length);\n    if (opts.register === true) {\n      item.models = resolveArgs(item, template, fragment, opts);\n    }\n  }\n}\n\nexport function resolveArgs(item, template, fragment, opts = {}) {\n  return template.f.r.map((ref, i) => {\n    let model;\n\n    if (opts.specialRef && (model = opts.specialRef(ref, i))) return model;\n\n    model = resolveReference(fragment, ref);\n    if (opts.register === true) {\n      model.register(item);\n    }\n\n    return model;\n  });\n}\n\nexport function teardownArgsFn(item, template) {\n  if (template && template.f && template.f.s) {\n    if (item.models)\n      item.models.forEach(m => {\n        if (m && m.unregister) m.unregister(item);\n      });\n    item.models = null;\n  }\n}\n","// This is the handler for DOM events that would lead to a change in the model\n// (i.e. change, sometimes, input, and occasionally click and keyup)\nexport default function handleDomEvent() {\n  this._ractive.binding.handleChange();\n}\n","import { toArray } from './array';\n\nexport default function getSelectedOptions(select) {\n  /* istanbul ignore next */\n  return select.selectedOptions\n    ? toArray(select.selectedOptions)\n    : select.options\n    ? toArray(select.options).filter(option => option.selected)\n    : [];\n}\n","import { INTERPOLATOR, TRIPLE } from 'config/types';\nimport { warnIfDebug } from 'utils/log';\nimport CheckboxBinding from './CheckboxBinding';\nimport CheckboxNameBinding from './CheckboxNameBinding';\nimport ContentEditableBinding from './ContentEditableBinding';\nimport FileBinding from './FileBinding';\nimport GenericBinding from './GenericBinding';\nimport MultipleSelectBinding from './MultipleSelectBinding';\nimport NumericBinding from './NumericBinding';\nimport RadioBinding from './RadioBinding';\nimport RadioNameBinding from './RadioNameBinding';\nimport SingleSelectBinding from './SingleSelectBinding';\n\nexport function isBindable(attribute) {\n  // The fragment must be a single non-string fragment\n  if (\n    !attribute ||\n    !attribute.template.f ||\n    attribute.template.f.length !== 1 ||\n    attribute.template.f[0].s\n  )\n    return false;\n\n  // A binding is an interpolator `{{ }}`, yey.\n  if (attribute.template.f[0].t === INTERPOLATOR) return true;\n\n  // The above is probably the only true case. For the rest, show an appropriate\n  // warning before returning false.\n\n  // You can't bind a triple curly. HTML values on an attribute makes no sense.\n  if (attribute.template.f[0].t === TRIPLE)\n    warnIfDebug('It is not possible create a binding using a triple mustache.');\n\n  return false;\n}\n\nexport default function selectBinding(element) {\n  const name = element.name;\n  const attributes = element.attributeByName;\n  if (name !== 'input' && name !== 'textarea' && name !== 'select' && !attributes.contenteditable)\n    return;\n  const isBindableByValue = isBindable(attributes.value);\n  const isBindableByContentEditable = isBindable(attributes.contenteditable);\n  const isContentEditable = element.getAttribute('contenteditable');\n\n  // contenteditable\n  // Bind if the contenteditable is true or a binding that may become true.\n  if ((isContentEditable || isBindableByContentEditable) && isBindableByValue)\n    return ContentEditableBinding;\n\n  // <input>\n  if (name === 'input') {\n    const type = element.getAttribute('type');\n\n    if (type === 'radio') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // For radios we can either bind the name or checked, but not both.\n      // Name binding is handed instead.\n      if (isBindableByName && isBindableByChecked) {\n        warnIfDebug(\n          'A radio input can have two-way binding on its name attribute, or its checked attribute - not both',\n          { ractive: element.root }\n        );\n        return RadioNameBinding;\n      }\n\n      if (isBindableByName) return RadioNameBinding;\n\n      if (isBindableByChecked) return RadioBinding;\n\n      // Dead end. Unknown binding on radio input.\n      return null;\n    }\n\n    if (type === 'checkbox') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // A checkbox with bindings for both name and checked. Checked treated as\n      // the checkbox value, name is treated as a regular binding.\n      //\n      // See https://github.com/ractivejs/ractive/issues/1749\n      if (isBindableByName && isBindableByChecked) return CheckboxBinding;\n\n      if (isBindableByName) return CheckboxNameBinding;\n\n      if (isBindableByChecked) return CheckboxBinding;\n\n      // Dead end. Unknown binding on checkbox input.\n      return null;\n    }\n\n    if (type === 'file' && isBindableByValue) return FileBinding;\n\n    if (type === 'number' && isBindableByValue) return NumericBinding;\n\n    if (type === 'range' && isBindableByValue) return NumericBinding;\n\n    // Some input of unknown type (browser usually falls back to text).\n    if (isBindableByValue) return GenericBinding;\n\n    // Dead end. Some unknown input and an unbindable.\n    return null;\n  }\n\n  // <select>\n  if (name === 'select' && isBindableByValue) {\n    return element.getAttribute('multiple') ? MultipleSelectBinding : SingleSelectBinding;\n  }\n\n  // <textarea>\n  if (name === 'textarea' && isBindableByValue) return GenericBinding;\n\n  // Dead end. Some unbindable element.\n  return null;\n}\n","import { doc } from 'config/environment';\n\nexport default function progressiveText(item, target, occupants, text) {\n  if (occupants) {\n    let n = occupants[0];\n    if (n && n.nodeType === 3) {\n      const idx = n.nodeValue.indexOf(text);\n      occupants.shift();\n\n      if (idx === 0) {\n        if (n.nodeValue.length !== text.length) {\n          occupants.unshift(n.splitText(text.length));\n        }\n      } else {\n        n.nodeValue = text;\n      }\n    } else {\n      n = item.node = doc.createTextNode(text);\n      if (occupants[0]) {\n        target.insertBefore(n, occupants[0]);\n      } else {\n        target.appendChild(n);\n      }\n    }\n\n    item.node = n;\n  } else {\n    if (!item.node) item.node = doc.createTextNode(text);\n    target.appendChild(item.node);\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { fillGaps, hasOwn } from 'utils/object';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { findInstance } from 'shared/registry';\nimport { isArray, isFunction } from 'utils/is';\nimport { addFunctions } from 'shared/getFunction';\n\nexport default function getPartialTemplate(ractive, name, up) {\n  // If the partial in instance or view heirarchy instances, great\n  let partial = getPartialFromRegistry(ractive, name, up || {});\n  if (partial) return partial;\n\n  // Does it exist on the page as a script tag?\n  partial = parser.fromId(name, { noThrow: true });\n  if (partial) {\n    // parse and register to this ractive instance\n    const parsed = parser.parseFor(partial, ractive);\n\n    // register extra partials on the ractive instance if they don't already exist\n    if (parsed.p) fillGaps(ractive.partials, parsed.p);\n\n    // register (and return main partial if there are others in the template)\n    return (ractive.partials[name] = parsed.t);\n  }\n}\n\nfunction getPartialFromRegistry(ractive, name, up) {\n  // if there was an instance up-hierarchy, cool\n  let partial = findParentPartial(name, up.owner);\n  if (partial) return partial;\n\n  // find first instance in the ractive or view hierarchy that has this partial\n  const instance = findInstance('partials', ractive, name);\n\n  if (!instance) {\n    return;\n  }\n\n  partial = instance.partials[name];\n\n  // partial is a function?\n  let fn;\n  if (isFunction(partial)) {\n    fn = partial;\n    // super partial\n    if (fn.styleSet) return fn;\n\n    fn = partial.bind(instance);\n    fn.isOwner = hasOwn(instance.partials, name);\n    partial = fn.call(ractive, parser);\n  }\n\n  if (!partial && partial !== '') {\n    warnIfDebug(noRegistryFunctionReturn, name, 'partial', 'partial', {\n      ractive\n    });\n    return;\n  }\n\n  // If this was added manually to the registry,\n  // but hasn't been parsed, parse it now\n  if (!parser.isParsed(partial)) {\n    // use the parseOptions of the ractive instance on which it was found\n    const parsed = parser.parseFor(partial, instance);\n\n    // Partials cannot contain nested partials!\n    // TODO add a test for this\n    if (parsed.p) {\n      warnIfDebug('Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive });\n    }\n\n    // if fn, use instance to store result, otherwise needs to go\n    // in the correct point in prototype chain on instance or constructor\n    const target = fn ? instance : findOwner(instance, name);\n\n    // may be a template with partials, which need to be registered and main template extracted\n    target.partials[name] = partial = parsed.t;\n  }\n\n  // store for reset\n  if (fn) partial._fn = fn;\n\n  // if the partial is a pre-parsed template object, import any expressions and update the registry\n  if (partial.v) {\n    addFunctions(partial);\n    return (instance.partials[name] = partial.t);\n  } else {\n    return partial;\n  }\n}\n\nfunction findOwner(ractive, key) {\n  return hasOwn(ractive.partials, key) ? ractive : findConstructor(ractive.constructor, key);\n}\n\nfunction findConstructor(constructor, key) {\n  if (!constructor) {\n    return;\n  }\n  return hasOwn(constructor.partials, key) ? constructor : findConstructor(constructor.Parent, key);\n}\n\nfunction findParentPartial(name, parent) {\n  if (parent) {\n    if (\n      parent.template &&\n      parent.template.p &&\n      !isArray(parent.template.p) &&\n      hasOwn(parent.template.p, name)\n    ) {\n      return parent.template.p[name];\n    } else if (parent.up && parent.up.owner) {\n      return findParentPartial(name, parent.up.owner);\n    }\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { findInstance } from 'shared/registry';\nimport { hasOwn } from 'utils/object';\nimport { isFunction, isString } from 'utils/is';\n\n// finds the component constructor in the registry or view hierarchy registries\nexport default function getComponentConstructor(ractive, name) {\n  const instance = findInstance('components', ractive, name);\n  let Component;\n\n  if (instance) {\n    Component = instance.components[name];\n\n    if (Component && !Component.isInstance) {\n      if (Component.default && Component.default.isInstance) Component = Component.default;\n      else if (!Component.then && isFunction(Component)) {\n        // function option, execute and store for reset\n        const fn = Component.bind(instance);\n        fn.isOwner = hasOwn(instance.components, name);\n        Component = fn();\n\n        if (!Component) {\n          warnIfDebug(noRegistryFunctionReturn, name, 'component', 'component', {\n            ractive\n          });\n          return;\n        }\n\n        if (isString(Component)) {\n          // allow string lookup\n          Component = getComponentConstructor(ractive, Component);\n        }\n\n        Component._fn = fn;\n        instance.components[name] = Component;\n      }\n    }\n  }\n\n  return Component;\n}\n","import Partial from './Partial';\nimport { ELEMENT } from 'config/types';\nimport { assign } from 'utils/object';\n\nexport default function asyncProxy(promise, options) {\n  const partials = options.template.p || {};\n  const name = options.template.e;\n\n  const opts = assign({}, options, {\n    template: { t: ELEMENT, e: name },\n    macro(handle) {\n      handle.setTemplate(partials['async-loading'] || []);\n      promise.then(\n        cmp => {\n          options.up.ractive.components[name] = cmp;\n          if (partials['async-loaded']) {\n            handle.partials.component = [options.template];\n            handle.setTemplate(partials['async-loaded']);\n          } else {\n            handle.setTemplate([options.template]);\n          }\n        },\n        err => {\n          if (partials['async-failed']) {\n            handle.aliasLocal('error', 'error');\n            handle.set('@local.error', err);\n            handle.setTemplate(partials['async-failed']);\n          } else {\n            handle.setTemplate([]);\n          }\n        }\n      );\n    }\n  });\n  return new Partial(opts);\n}\n","import { ATTRIBUTE, CATCH, ELEMENT, ELSE, INTERPOLATOR, SECTION, THEN } from 'src/config/types';\nimport Partial from './Partial';\nimport { assign } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nfunction extract(tpl, type, name) {\n  const p = tpl.f.find(s => s.t === type);\n  if (p) {\n    if (p.n)\n      return [\n        {\n          t: 19,\n          n: 54,\n          f: p.f || [],\n          z: [{ n: p.n, x: { r: `__await.${name}` } }]\n        }\n      ];\n    else return p.f || [];\n  } else return [];\n}\n\nexport default function Await(options) {\n  const tpl = options.template;\n\n  const success = extract(tpl, THEN, 'value');\n  const error = extract(tpl, CATCH, 'error');\n  const pending = extract(tpl, SECTION);\n  const undef = extract(tpl, ELSE);\n\n  const opts = assign({}, options, {\n    template: {\n      t: ELEMENT,\n      m: [\n        {\n          t: ATTRIBUTE,\n          n: 'for',\n          f: [{ t: INTERPOLATOR, r: tpl.r, rx: tpl.rx, x: tpl.x }]\n        }\n      ]\n    },\n    macro(handle, attrs) {\n      handle.aliasLocal('__await');\n\n      function update(attrs) {\n        if (attrs.for && isFunction(attrs.for.then)) {\n          handle.setTemplate(pending);\n\n          attrs.for.then(\n            v => {\n              handle.set('@local.value', v);\n              handle.setTemplate(success);\n            },\n            e => {\n              handle.set('@local.error', e);\n              handle.setTemplate(error);\n            }\n          );\n        } else if (attrs.for === undefined) {\n          handle.setTemplate(undef);\n        } else {\n          handle.set('@local.value', attrs.for);\n          handle.setTemplate(success);\n        }\n      }\n\n      update(attrs);\n\n      return {\n        update\n      };\n    }\n  });\n\n  opts.macro.attributes = ['for'];\n\n  return new Partial(opts);\n}\n","import { TEXT } from 'config/types';\n\n// TODO all this code needs to die\nexport default function processItems(items, values, guid, counter = 0) {\n  return items\n    .map(item => {\n      if (item.type === TEXT) {\n        return item.template;\n      }\n\n      if (item.fragment) {\n        if (item.fragment.iterations) {\n          return item.fragment.iterations\n            .map(fragment => {\n              return processItems(fragment.items, values, guid, counter);\n            })\n            .join('');\n        } else {\n          return processItems(item.fragment.items, values, guid, counter);\n        }\n      }\n\n      const placeholderId = `${guid}-${counter++}`;\n      const model = item.model || item.newModel;\n\n      values[placeholderId] = model\n        ? model.wrapper\n          ? model.wrapperValue\n          : model.get()\n        : undefined;\n\n      return '${' + placeholderId + '}';\n    })\n    .join('');\n}\n","import { logIfDebug, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport { isArray } from 'utils/is';\nimport config from './config/config';\nimport Fragment from 'src/view/Fragment';\nimport hooks from 'src/events/Hook';\nimport Ractive from '../Ractive';\nimport subscribe from './helpers/subscribe';\n\nexport default function initialise(ractive, userOptions, options) {\n  // initialize settable computeds\n  const computed = ractive.viewmodel.computed;\n  if (computed) {\n    for (const k in computed) {\n      if (k in ractive.viewmodel.value && computed[k] && !computed[k].isReadonly) {\n        computed[k].set(ractive.viewmodel.value[k]);\n      }\n    }\n  }\n\n  // init config from Parent and options\n  config.init(ractive.constructor, ractive, userOptions);\n\n  // call any passed in plugins\n  if (isArray(userOptions.use))\n    ractive.use.apply(ractive, userOptions.use.filter(p => !p.construct));\n\n  hooks.config.fire(ractive);\n\n  hooks.init.begin(ractive);\n\n  const fragment = (ractive.fragment = createFragment(ractive, options));\n  if (fragment) fragment.bind(ractive.viewmodel);\n\n  hooks.init.end(ractive);\n\n  // general config done, set up observers\n  subscribe(ractive, userOptions, 'observe');\n\n  if (fragment) {\n    // render automatically ( if `el` is specified )\n    const el = (ractive.el = ractive.target = getElement(ractive.el || ractive.target));\n    if (el && !ractive.component) {\n      const promise = ractive.render(el, ractive.append);\n\n      if (Ractive.DEBUG_PROMISES) {\n        promise.catch(err => {\n          warnOnceIfDebug(\n            'Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;'\n          );\n          warnIfDebug('An error happened during rendering', { ractive });\n          logIfDebug(err);\n\n          throw err;\n        });\n      }\n    }\n  }\n}\n\nexport function createFragment(ractive, options = {}) {\n  if (ractive.template) {\n    const cssIds = [].concat(ractive.constructor._cssIds || [], options.cssIds || []);\n\n    return new Fragment({\n      owner: ractive,\n      template: ractive.template,\n      cssIds\n    });\n  }\n}\n","import { doc } from 'config/environment';\nimport { applyCSS } from 'src/global/css';\nimport hooks from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport { createFragment } from './initialise';\n\nexport default function render(ractive, target, anchor, occupants) {\n  // set a flag to let any transitions know that this instance is currently rendering\n  ractive.rendering = true;\n\n  const promise = runloop.start();\n  runloop.scheduleTask(() => hooks.render.fire(ractive), true);\n\n  if (ractive.fragment.rendered) {\n    throw new Error(\n      'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first'\n    );\n  }\n\n  if (ractive.destroyed) {\n    ractive.destroyed = false;\n    ractive.fragment = createFragment(ractive).bind(ractive.viewmodel);\n  }\n\n  anchor = getElement(anchor) || ractive.anchor;\n\n  ractive.el = ractive.target = target;\n  ractive.anchor = anchor;\n\n  // ensure encapsulated CSS is up-to-date\n  if (ractive.cssId) applyCSS();\n\n  if (target) {\n    (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(ractive);\n\n    if (anchor) {\n      const docFrag = doc.createDocumentFragment();\n      ractive.fragment.render(docFrag);\n      target.insertBefore(docFrag, anchor);\n    } else {\n      ractive.fragment.render(target, occupants);\n    }\n  }\n\n  runloop.end();\n  ractive.rendering = false;\n\n  return promise.then(() => {\n    if (ractive.torndown) return;\n\n    hooks.complete.fire(ractive);\n  });\n}\n","import { getElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport { warnIfDebug } from 'utils/log';\nimport render from '../render';\nimport { teardown } from 'shared/methodCallers';\n\nexport default function Ractive$render(target, anchor) {\n  if (this.torndown) {\n    warnIfDebug('ractive.render() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  target = getElement(target) || this.el;\n\n  if (!this.append && target) {\n    // Teardown any existing instances *before* trying to set up the new one -\n    // avoids certain weird bugs\n    const others = target.__ractive_instances__;\n    if (others) others.forEach(teardown);\n\n    // make sure we are the only occupants\n    if (!this.enhance) {\n      target.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n    }\n  }\n\n  const occupants = this.enhance ? toArray(target.childNodes) : null;\n  const promise = render(this, target, anchor, occupants);\n\n  if (occupants) {\n    while (occupants.length) target.removeChild(occupants.pop());\n  }\n\n  return promise;\n}\n","import runloop from 'src/global/runloop';\nimport { PARTIAL, COMPONENT, ELEMENT } from 'config/types';\nimport { isArray } from 'utils/is';\nimport { handleChange } from 'shared/methodCallers';\n\nfunction collect(source, name, attr, dest) {\n  source.forEach(item => {\n    // queue to rerender if the item is a partial and the current name matches\n    if (item.type === PARTIAL && (item.refName === name || item.name === name)) {\n      item.inAttribute = attr;\n      dest.push(item);\n      return; // go no further\n    }\n\n    // if it has a fragment, process its items\n    if (item.fragment) {\n      collect(item.fragment.iterations || item.fragment.items, name, attr, dest);\n    } else if (isArray(item.items)) {\n      // or if it is itself a fragment, process its items\n      collect(item.items, name, attr, dest);\n    } else if (item.type === COMPONENT && item.instance) {\n      // or if it is a component, step in and process its items\n      // ...unless the partial is shadowed\n      if (item.instance.partials[name]) return;\n      collect(item.instance.fragment.items, name, attr, dest);\n    }\n\n    // if the item is an element, process its attributes too\n    if (item.type === ELEMENT) {\n      if (isArray(item.attributes)) {\n        collect(item.attributes, name, true, dest);\n      }\n    }\n  });\n}\n\nexport default function(name, partial) {\n  const collection = [];\n  collect(this.fragment.items, name, false, collection);\n\n  const promise = runloop.start();\n\n  this.partials[name] = partial;\n  collection.forEach(handleChange);\n\n  runloop.end();\n\n  return promise;\n}\n","import { createDocumentFragment } from 'utils/dom';\nimport Fragment from 'src/view/Fragment';\nimport runloop from 'src/global/runloop';\nimport { default as templateConfigurator } from '../config/custom/template';\n\n// TODO should resetTemplate be asynchronous? i.e. should it be a case\n// of outro, update template, intro? I reckon probably not, since that\n// could be achieved with unrender-resetTemplate-render. Also, it should\n// conceptually be similar to resetPartial, which couldn't be async\n\nexport default function Ractive$resetTemplate(template) {\n  templateConfigurator.init(null, this, { template });\n\n  const transitionsEnabled = this.transitionsEnabled;\n  this.transitionsEnabled = false;\n\n  // Is this is a component, we need to set the `shouldDestroy`\n  // flag, otherwise it will assume by default that a parent node\n  // will be detached, and therefore it doesn't need to bother\n  // detaching its own nodes\n  const component = this.component;\n  if (component) component.shouldDestroy = true;\n  this.unrender();\n  if (component) component.shouldDestroy = false;\n\n  const promise = runloop.start();\n\n  // remove existing fragment and create new one\n  this.fragment.unbind().unrender(true);\n\n  this.fragment = new Fragment({\n    template: this.template,\n    root: this,\n    owner: this\n  });\n\n  const docFrag = createDocumentFragment();\n  this.fragment.bind(this.viewmodel).render(docFrag);\n\n  // if this is a component, its el may not be valid, so find a\n  // target based on the component container\n  if (component && !component.external) {\n    this.fragment.findParentNode().insertBefore(docFrag, component.findNextNode());\n  } else {\n    this.el.insertBefore(docFrag, this.anchor);\n  }\n\n  runloop.end();\n\n  this.transitionsEnabled = transitionsEnabled;\n\n  return promise;\n}\n","import { build, set } from 'shared/set';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$set(keypath, value, options) {\n  const ractive = this;\n\n  const opts = isObjectType(keypath) ? value : options;\n\n  return set(build(ractive, keypath, value, opts && opts.isolated), opts);\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$subtract(keypath, d, options) {\n  const num = isNumber(d) ? -d : -1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","import { badArguments } from 'config/errors';\nimport { gather, set } from 'shared/set';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$toggle(keypath, options) {\n  if (!isString(keypath)) {\n    throw new TypeError(badArguments);\n  }\n\n  return set(\n    gather(this, keypath, null, options && options.isolated).map(m => [m, !m.get()]),\n    options\n  );\n}\n","import { getCSS } from 'src/global/css';\nimport { keys } from 'utils/object';\n\nexport default function Ractive$toCSS() {\n  const cssIds = [this.cssId, ...this.findAllComponents().map(c => c.cssId)];\n  const uniqueCssIds = keys(cssIds.reduce((ids, id) => ((ids[id] = true), ids), {}));\n  return getCSS(uniqueCssIds);\n}\n","export default function Ractive$toHTML() {\n  return this.fragment.toString(true);\n}\n","export default function toText() {\n  return this.fragment.toString(false);\n}\n","import runloop from 'src/global/runloop';\nimport Transition from '../../view/items/element/Transition';\nimport { fatal } from 'utils/log';\nimport { isObject } from 'utils/is';\n\nexport default function Ractive$transition(name, node, params) {\n  if (node instanceof HTMLElement) {\n    // good to go\n  } else if (isObject(node)) {\n    // omitted, use event node\n    params = node;\n  }\n\n  // if we allow query selector, then it won't work\n  // simple params like \"fast\"\n\n  // else if ( typeof node === 'string' ) {\n  // \t// query selector\n  // \tnode = this.find( node )\n  // }\n\n  node = node || this.event.node;\n\n  if (!node || !node._ractive) {\n    fatal(`No node was supplied for transition ${name}`);\n  }\n\n  params = params || {};\n  const owner = node._ractive.proxy;\n  const transition = new Transition({ owner, up: owner.up, name, params });\n  transition.bind();\n\n  const promise = runloop.start();\n  runloop.registerTransition(transition);\n  runloop.end();\n\n  promise.then(() => transition.unbind());\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function unlink(here) {\n  const promise = runloop.start();\n  this.viewmodel.joinAll(splitKeypath(here), { lastLink: false }).unlink();\n  runloop.end();\n  return promise;\n}\n","import hooks from 'src/events/Hook';\nimport { warnIfDebug } from 'utils/log';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\n\nexport default function Ractive$unrender() {\n  if (!this.fragment.rendered) {\n    warnIfDebug('ractive.unrender() was called on a Ractive instance that was not rendered');\n    return Promise.resolve();\n  }\n\n  this.unrendering = true;\n  const promise = runloop.start();\n\n  hooks.unrendering.fire(this);\n\n  // If this is a component, and the component isn't marked for destruction,\n  // don't detach nodes from the DOM unnecessarily\n  const shouldDestroy =\n    !this.component ||\n    (this.component.anchor || {}).shouldDestroy ||\n    this.component.shouldDestroy ||\n    this.shouldDestroy;\n  this.fragment.unrender(shouldDestroy);\n  if (shouldDestroy) this.destroyed = true;\n\n  removeFromArray(this.el.__ractive_instances__, this);\n\n  hooks.unrender.fire(this);\n\n  runloop.end();\n  this.unrendering = false;\n\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function Ractive$updateModel(keypath, cascade) {\n  const promise = runloop.start();\n\n  if (!keypath) {\n    this.viewmodel.updateFromBindings(true);\n  } else {\n    this.viewmodel.joinAll(splitKeypath(keypath)).updateFromBindings(cascade !== false);\n  }\n\n  runloop.end();\n\n  return promise;\n}\n","export default function() {}\n","export function findInViewHierarchy(registryName, ractive, name) {\n  const instance = findInstance(registryName, ractive, name);\n  return instance ? instance[registryName][name] : null;\n}\n\nexport function findInstance(registryName, ractive, name) {\n  while (ractive) {\n    if (name in ractive[registryName]) {\n      return ractive;\n    }\n\n    if (ractive.isolated) {\n      return null;\n    }\n\n    ractive = ractive.parent;\n  }\n}\n","import { fatal } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport interpolators from '../Ractive/static/interpolators';\nimport { findInViewHierarchy } from './registry';\n\nexport default function interpolate(from, to, ractive, type) {\n  if (from === to) return null;\n\n  if (type) {\n    const interpol = findInViewHierarchy('interpolators', ractive, type);\n    if (interpol) return interpol(from, to) || null;\n\n    fatal(missingPlugin(type, 'interpolator'));\n  }\n\n  return (\n    interpolators.number(from, to) ||\n    interpolators.array(from, to) ||\n    interpolators.object(from, to) ||\n    null\n  );\n}\n","import { isArray, isString } from './is';\n\nexport function addToArray(array, value) {\n  const index = array.indexOf(value);\n\n  if (index === -1) {\n    array.push(value);\n  }\n}\n\nexport function arrayContains(array, value) {\n  for (let i = 0, c = array.length; i < c; i++) {\n    if (array[i] == value) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function arrayContentsMatch(a, b) {\n  let i;\n\n  if (!isArray(a) || !isArray(b)) {\n    return false;\n  }\n\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  i = a.length;\n  while (i--) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function ensureArray(x) {\n  if (isString(x)) {\n    return [x];\n  }\n\n  if (x === undefined) {\n    return [];\n  }\n\n  return x;\n}\n\nexport function lastItem(array) {\n  return array[array.length - 1];\n}\n\nexport function removeFromArray(array, member) {\n  if (!array) {\n    return;\n  }\n\n  const index = array.indexOf(member);\n\n  if (index !== -1) {\n    array.splice(index, 1);\n  }\n}\n\nexport function combine(...arrays) {\n  const res = arrays.concat.apply([], arrays);\n  let i = res.length;\n  while (i--) {\n    const idx = res.indexOf(res[i]);\n    if (~idx && idx < i) res.splice(i, 1);\n  }\n\n  return res;\n}\n\nexport function toArray(arrayLike) {\n  const array = [];\n  let i = arrayLike.length;\n  while (i--) {\n    array[i] = arrayLike[i];\n  }\n\n  return array;\n}\n\nexport function findMap(array, fn) {\n  const len = array.length;\n  for (let i = 0; i < len; i++) {\n    const result = fn(array[i]);\n    if (result) return result;\n  }\n}\n\nexport function buildNewIndices(one, two, comparator) {\n  let oldArray = one;\n  let newArray = two;\n  if (comparator) {\n    oldArray = oldArray.map(comparator);\n    newArray = newArray.map(comparator);\n  }\n\n  const oldLength = oldArray.length;\n\n  const usedIndices = {};\n  let firstUnusedIndex = 0;\n\n  return oldArray.map(item => {\n    let index;\n    let start = firstUnusedIndex;\n\n    do {\n      index = newArray.indexOf(item, start);\n\n      if (index === -1) {\n        return -1;\n      }\n\n      start = index + 1;\n    } while (usedIndices[index] === true && start < oldLength);\n\n    // keep track of the first unused index, so we don't search\n    // the whole of newArray for each item in oldArray unnecessarily\n    if (index === firstUnusedIndex) {\n      firstUnusedIndex += 1;\n    }\n    // allow next instance of next \"equal\" to be found item\n    usedIndices[index] = true;\n    return index;\n  });\n}\n","export function bind(x) {\n  x.bind();\n}\nexport function cancel(x) {\n  x.cancel();\n}\nexport function destroyed(x) {\n  x.destroyed();\n}\nexport function handleChange(x) {\n  x.handleChange();\n}\nexport function mark(x) {\n  x.mark();\n}\nexport function markForce(x) {\n  x.mark(true);\n}\nexport function marked(x) {\n  x.marked();\n}\nexport function markedAll(x) {\n  x.markedAll();\n}\nexport function render(x) {\n  x.render();\n}\nexport function shuffled(x) {\n  x.shuffled();\n}\nexport function teardown(x) {\n  x.teardown();\n}\nexport function unbind(x) {\n  x.unbind();\n}\nexport function unrender(x) {\n  x.unrender();\n}\nexport function unrenderAndDestroy(x) {\n  x.unrender(true);\n}\nexport function update(x) {\n  x.update();\n}\nexport function toString(x) {\n  return x.toString();\n}\nexport function toEscapedString(x) {\n  return x.toString(true);\n}\n","import { splitKeypath } from './keypaths';\nimport { isString } from 'utils/is';\n\n// this is the dry method of checking to see if a rebind applies to\n// a particular keypath because in some cases, a dep may be bound\n// directly to a particular keypath e.g. foo.bars.0.baz and need\n// to avoid getting kicked to foo.bars.1.baz if foo.bars is unshifted\nexport function rebindMatch(template, next, previous, fragment) {\n  const keypath = template.r || template;\n\n  // no valid keypath, go with next\n  if (!keypath || !isString(keypath)) return next;\n\n  // completely contextual ref, go with next\n  if (\n    keypath === '.' ||\n    keypath[0] === '@' ||\n    (next || previous).isKey ||\n    (next || previous).isKeypath\n  )\n    return next;\n\n  const parts = keypath.split('/');\n  let keys = splitKeypath(parts[parts.length - 1]);\n  const last = keys[keys.length - 1];\n\n  // check the keypath against the model keypath to see if it matches\n  let model = next || previous;\n\n  // check to see if this was an alias\n  if (model && keys.length === 1 && last !== model.key && fragment) {\n    keys = findAlias(last, fragment) || keys;\n  }\n\n  let i = keys.length;\n  let match = true;\n  let shuffling = false;\n\n  while (model && i--) {\n    if (model.shuffling) shuffling = true;\n    // non-strict comparison to account for indices in keypaths\n    if (keys[i] != model.key) match = false;\n    model = model.parent;\n  }\n\n  // next is undefined, but keypath is shuffling and previous matches\n  if (!next && match && shuffling) return previous;\n  else if (next && !match && shuffling)\n    // next is defined, but doesn't match the keypath\n    return previous;\n  else return next;\n}\n\nfunction findAlias(name, fragment) {\n  while (fragment) {\n    const z = fragment.aliases;\n    if (z && z[name]) {\n      const aliases = (fragment.owner.iterations ? fragment.owner : fragment).owner.template.z;\n      for (let i = 0; i < aliases.length; i++) {\n        if (aliases[i].n === name) {\n          const alias = aliases[i].x;\n          if (!alias.r) return false;\n          const parts = alias.r.split('/');\n          return splitKeypath(parts[parts.length - 1]);\n        }\n      }\n      return;\n    }\n\n    fragment = fragment.componentParent || fragment.parent;\n  }\n}\n","export function fromExpression(body, length = 0) {\n  const args = new Array(length);\n\n  while (length--) {\n    args[length] = `_${length}`;\n  }\n\n  // Functions created directly with new Function() look like this:\n  //     function anonymous (_0 /**/) { return _0*2 }\n  //\n  // With this workaround, we get a little more compact:\n  //     function (_0){return _0*2}\n  return new Function([], `return function (${args.join(',')}){return(${body});};`)();\n}\n","import { fatal } from 'utils/log';\nimport bind from 'utils/bind';\nimport { createFunctionFromString } from '../config/runtime-parser';\nimport { isFunction, isString, isObjectType } from 'utils/is';\n\nexport default function getComputationSignature(ractive, key, signature) {\n  let getter;\n  let setter;\n\n  // useful for debugging\n  let getterString;\n  let getterUseStack;\n  let setterString;\n\n  if (isFunction(signature)) {\n    getter = bind(signature, ractive);\n    getterString = signature.toString();\n    getterUseStack = true;\n  }\n\n  if (isString(signature)) {\n    getter = createFunctionFromString(signature, ractive);\n    getterString = signature;\n  }\n\n  if (isObjectType(signature)) {\n    if (isString(signature.get)) {\n      getter = createFunctionFromString(signature.get, ractive);\n      getterString = signature.get;\n    } else if (isFunction(signature.get)) {\n      getter = bind(signature.get, ractive);\n      getterString = signature.get.toString();\n      getterUseStack = true;\n    } else {\n      fatal('`%s` computation must have a `get()` method', key);\n    }\n\n    if (isFunction(signature.set)) {\n      setter = bind(signature.set, ractive);\n      setterString = signature.set.toString();\n    }\n  }\n\n  return {\n    getter,\n    setter,\n    getterString,\n    setterString,\n    getterUseStack\n  };\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport SharedModel, {\n  GlobalModel,\n  SharedModel as ContextModel\n} from 'src/model/specials/SharedModel';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nfunction findContext(fragment) {\n  let frag = fragment;\n  while (frag && !frag.context && !frag.aliases) frag = frag.parent;\n  return frag;\n}\n\nexport default function resolveReference(fragment, ref) {\n  const initialFragment = fragment;\n  // current context ref\n  if (ref === '.') return fragment.findContext();\n\n  // ancestor references\n  if (ref[0] === '~') return fragment.ractive.viewmodel.joinAll(splitKeypath(ref.slice(2)));\n\n  // scoped references\n  if (ref[0] === '.' || ref[0] === '^') {\n    let frag = fragment;\n    const parts = ref.split('/');\n    const explicitContext = parts[0] === '^^';\n\n    // find nearest context node\n    while (frag && !frag.context) {\n      frag = up(frag);\n    }\n    let context = frag && frag.context;\n\n    // walk up the context chain\n    while (frag && parts[0] === '^^') {\n      parts.shift();\n\n      // the current fragment should always be a context,\n      // and if it happens to be an iteration, jump above the each block\n      if (frag.isIteration) {\n        frag = frag.parent.parent;\n      } else {\n        // otherwise jump above the current fragment\n        frag = up(frag);\n      }\n\n      // walk to the next contexted fragment\n      while (frag && !frag.context) {\n        frag = up(frag);\n      }\n      context = frag && frag.context;\n    }\n\n    if (!context && explicitContext) {\n      throw new Error(\n        `Invalid context parent reference ('${ref}'). There is not context at that level.`\n      );\n    }\n\n    // walk up the context path\n    while (parts[0] === '.' || parts[0] === '..') {\n      const part = parts.shift();\n\n      if (part === '..') {\n        context = context.parent;\n      }\n    }\n\n    ref = parts.join('/');\n\n    // special case - `{{.foo}}` means the same as `{{./foo}}`\n    if (ref[0] === '.') ref = ref.slice(1);\n    return context.joinAll(splitKeypath(ref));\n  }\n\n  const keys = splitKeypath(ref);\n  if (!keys.length) return;\n  const base = keys.shift();\n\n  // special refs\n  if (base[0] === '@') {\n    // shorthand from outside the template\n    // @this referring to local ractive instance\n    if (base === '@this' || base === '@') {\n      return fragment.ractive.viewmodel.getRactiveModel().joinAll(keys);\n    } else if (base === '@index' || base === '@key') {\n      // @index or @key referring to the nearest repeating index or key\n      if (keys.length) badReference(base);\n      const repeater = findIter(fragment);\n      return repeater && repeater[`get${base[1] === 'i' ? 'Index' : 'Key'}`]();\n    } else if (base === '@last') {\n      const repeater = findIter(fragment);\n      return repeater && repeater.parent.getLast();\n    } else if (base === '@global') {\n      // @global referring to window or global\n      return GlobalModel.joinAll(keys);\n    } else if (base === '@shared') {\n      // @global referring to window or global\n      return SharedModel.joinAll(keys);\n    } else if (base === '@keypath' || base === '@rootpath') {\n      // @keypath or @rootpath, the current keypath string\n      const root = ref[1] === 'r' ? fragment.ractive.root : null;\n      let f = fragment;\n\n      while (\n        f &&\n        (!f.context || (f.isRoot && f.ractive.component && (root || !f.ractive.isolated)))\n      ) {\n        f = f.isRoot ? f.componentParent : f.parent;\n      }\n\n      return f.getKeypath(root);\n    } else if (base === '@context') {\n      return new ContextModel(fragment.getContext(), 'context').joinAll(keys);\n    } else if (base === '@local') {\n      // @context-local data\n      return fragment.getContext()._data.joinAll(keys);\n    } else if (base === '@style') {\n      // @style shared model\n      return fragment.ractive.constructor._cssModel.joinAll(keys);\n    } else if (base === '@helpers') {\n      // @helpers instance model\n      return fragment.ractive.viewmodel.getHelpers().joinAll(keys);\n    } else if (base === '@macro') {\n      const handle = findMacro(fragment);\n      if (handle) return new ContextModel(handle, 'macro').joinAll(keys);\n      else return;\n    } else {\n      // nope\n      throw new Error(`Invalid special reference '${base}'`);\n    }\n  }\n\n  // helpers\n  if (base && !keys.length) {\n    const helpers = fragment.ractive.viewmodel.getHelpers();\n    if (helpers.has(base)) return helpers.joinKey(base);\n  }\n\n  let context = findContext(fragment);\n\n  // check immediate context for a match\n  if (context) {\n    if (context.context) {\n      context = context.context;\n      if (context.has(base)) return context.joinKey(base).joinAll(keys);\n    } else {\n      // alias block, so get next full context for later\n      context = fragment.findContext();\n    }\n  } else {\n    context = fragment.findContext();\n  }\n\n  // walk up the fragment hierarchy looking for a matching ref, alias, or key in a context\n  let createMapping = false;\n  const shouldWarn = fragment.ractive.warnAboutAmbiguity;\n  let crossed = 0;\n  let model;\n\n  while (fragment) {\n    // repeated fragments\n    if (fragment.isIteration) {\n      if (base === fragment.parent.keyRef) {\n        model = fragment.getKey();\n      } else if (base === fragment.parent.indexRef) {\n        model = fragment.getIndex();\n      }\n\n      if (model && keys.length) badReference(base);\n    }\n\n    // alias node or iteration\n    if (!model && fragment.aliases && hasOwn(fragment.aliases, base)) {\n      model = fragment.aliases[base];\n    }\n\n    // check fragment context to see if it has the key we need\n    if (!model && fragment.context && fragment.context.has(base)) {\n      model = fragment.context.joinKey(base);\n\n      // this is an implicit mapping\n      if (createMapping) {\n        if (shouldWarn)\n          warnIfDebug(\n            `'${ref}' resolved but is ambiguous and will create a mapping to a parent component.`\n          );\n      } else if (shouldWarn && crossed) warnIfDebug(`'${ref}' resolved but is ambiguous.`);\n    }\n\n    if (model) {\n      if (createMapping) {\n        model = initialFragment.ractive.viewmodel.createLink(base, model, base, { implicit: true });\n      }\n\n      if (keys.length > 0 && isFunction(model.joinAll)) {\n        model = model.joinAll(keys);\n      }\n\n      return model;\n    }\n\n    // don't consider alias blocks when checking for ambiguity\n    if (fragment.context && !fragment.aliases) crossed = 1;\n\n    if (\n      (fragment.componentParent || (!fragment.parent && fragment.ractive.component)) &&\n      !fragment.ractive.isolated\n    ) {\n      // ascend through component boundary\n      fragment = fragment.componentParent || fragment.ractive.component.up;\n      createMapping = true;\n    } else {\n      fragment = fragment.parent;\n    }\n  }\n\n  // if enabled, check the instance for a match\n  const instance = initialFragment.ractive;\n  if (instance.resolveInstanceMembers && base !== 'data' && base in instance) {\n    return instance.viewmodel\n      .getRactiveModel()\n      .joinKey(base)\n      .joinAll(keys);\n  }\n\n  if (shouldWarn) {\n    warnIfDebug(`'${ref}' is ambiguous and did not resolve.`);\n  }\n\n  // didn't find anything, so go ahead and create the key on the local model\n  return context.joinKey(base).joinAll(keys);\n}\n\nfunction up(fragment) {\n  return fragment && ((!fragment.ractive.isolated && fragment.componentParent) || fragment.parent);\n}\n\nfunction findIter(start) {\n  let fragment = start;\n  let next;\n  while (!fragment.isIteration && (next = up(fragment))) {\n    fragment = next;\n  }\n\n  return fragment.isIteration && fragment;\n}\n\nfunction findMacro(start) {\n  let fragment = start;\n  while (fragment) {\n    if (fragment.owner.handle) return fragment.owner.handle;\n    fragment = up(fragment);\n  }\n}\n\nfunction badReference(key) {\n  throw new Error(`An index or key reference (${key}) cannot have child properties`);\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$add(keypath, d, options) {\n  const num = isNumber(d) ? d : 1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","export function enqueue(ractive, event) {\n  if (ractive.event) {\n    ractive._eventQueue.push(ractive.event);\n  }\n\n  ractive.event = event;\n}\n\nexport function dequeue(ractive) {\n  if (ractive._eventQueue.length) {\n    ractive.event = ractive._eventQueue.pop();\n  } else {\n    ractive.event = null;\n  }\n}\n","export function findAnchors(fragment, name = null) {\n  const res = [];\n\n  findAnchorsIn(fragment, name, res);\n\n  return res;\n}\n\nfunction findAnchorsIn(item, name, result) {\n  if (item.isAnchor) {\n    if (!name || item.name === name) {\n      result.push(item);\n    }\n  } else if (item.items) {\n    item.items.forEach(i => findAnchorsIn(i, name, result));\n  } else if (item.iterations) {\n    item.iterations.forEach(i => findAnchorsIn(i, name, result));\n  } else if (item.fragment && !item.component) {\n    findAnchorsIn(item.fragment, name, result);\n  }\n}\n\nexport function updateAnchors(instance, name = null) {\n  const anchors = findAnchors(instance.fragment, name);\n  const idxs = {};\n  const children = instance._children.byName;\n\n  anchors.forEach(a => {\n    const name = a.name;\n    if (!(name in idxs)) idxs[name] = 0;\n    const idx = idxs[name];\n    const child = (children[name] || [])[idx];\n\n    if (child && child.lastBound !== a) {\n      if (child.lastBound) child.lastBound.removeChild(child);\n      a.addChild(child);\n    }\n\n    idxs[name]++;\n  });\n}\n\nexport function unrenderChild(meta) {\n  if (meta.instance.fragment.rendered) {\n    meta.shouldDestroy = true;\n    meta.instance.unrender();\n  }\n  meta.instance.el = null;\n}\n","import hooks from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { unrenderChild, updateAnchors } from 'shared/anchors';\n\nexport default function attachChild(child, options = {}) {\n  const children = this._children;\n  let idx;\n\n  if (child.parent && child.parent !== this)\n    throw new Error(\n      `Instance ${child._guid} is already attached to a different instance ${\n        child.parent._guid\n      }. Please detach it from the other instance using detachChild first.`\n    );\n  else if (child.parent)\n    throw new Error(`Instance ${child._guid} is already attached to this instance.`);\n\n  const meta = {\n    instance: child,\n    ractive: this,\n    name: options.name || child.constructor.name || 'Ractive',\n    target: options.target || false,\n    bubble,\n    findNextNode\n  };\n  meta.nameOption = options.name;\n\n  // child is managing itself\n  if (!meta.target) {\n    meta.up = this.fragment;\n    meta.external = true;\n  } else {\n    let list;\n    if (!(list = children.byName[meta.target])) {\n      list = [];\n      this.set(`@this.children.byName.${meta.target}`, list);\n    }\n    idx = options.prepend ? 0 : options.insertAt !== undefined ? options.insertAt : list.length;\n  }\n\n  child.parent = this;\n  child.root = this.root;\n  child.component = meta;\n  children.push(meta);\n\n  const promise = runloop.start();\n\n  const rm = child.viewmodel.getRactiveModel();\n  rm.joinKey('parent', { lastLink: false }).link(this.viewmodel.getRactiveModel());\n  rm.joinKey('root', { lastLink: false }).link(this.root.viewmodel.getRactiveModel());\n\n  hooks.attachchild.fire(child);\n\n  if (meta.target) {\n    unrenderChild(meta);\n    this.splice(`@this.children.byName.${meta.target}`, idx, 0, meta);\n    updateAnchors(this, meta.target);\n  } else {\n    if (!child.isolated) child.viewmodel.attached(this.fragment);\n  }\n\n  runloop.end();\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n\nfunction bubble() {\n  runloop.addFragment(this.instance.fragment);\n}\n\nfunction findNextNode() {\n  if (this.anchor) return this.anchor.findNextNode();\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport { isString, isFunction } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport { fireShuffleTasks } from 'src/model/ModelBase';\n\nexport function compute(path, computed) {\n  this.computed[path] = computed;\n  if (isString(computed) || isFunction(computed))\n    computed = this.computed[path] = { get: computed };\n\n  const keys = splitKeypath(path);\n  if (!~path.indexOf('*')) {\n    const last = keys.pop();\n    return this.viewmodel.joinAll(keys).compute(last, computed);\n  } else {\n    computed.pattern = new RegExp(\n      '^' +\n        keys\n          .map(k => k.replace(/\\*\\*/g, '(.+)').replace(/\\*/g, '((?:\\\\\\\\.|[^\\\\.])+)'))\n          .join('\\\\.') +\n        '$'\n    );\n  }\n}\n\nexport default function Ractive$compute(path, computed) {\n  const promise = runloop.start();\n  const comp = compute.call(this, path, computed);\n\n  if (comp) {\n    const keys = splitKeypath(path);\n    if (keys.length === 1 && !comp.isReadonly) {\n      comp.set(this.viewmodel.value[keys[0]]);\n    }\n\n    const first = keys.reduce((a, c) => a && a.childByKey[c], this.viewmodel);\n    if (first) {\n      first.rebind(comp, first, false);\n      if (first.parent) delete first.parent.childByKey[first.key];\n      fireShuffleTasks();\n    }\n  }\n\n  runloop.end();\n\n  return promise;\n}\n","import hooks from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\n\nexport default function Ractive$detach() {\n  if (this.isDetached) {\n    return this.el;\n  }\n\n  if (this.el) {\n    removeFromArray(this.el.__ractive_instances__, this);\n  }\n\n  this.el = this.fragment.detach();\n  this.isDetached = true;\n\n  hooks.detach.fire(this);\n  return this.el;\n}\n","import hooks from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\n\nexport default function detachChild(child) {\n  const children = this._children;\n  let meta, index;\n\n  let i = children.length;\n  while (i--) {\n    if (children[i].instance === child) {\n      index = i;\n      meta = children[i];\n      break;\n    }\n  }\n\n  if (!meta || child.parent !== this)\n    throw new Error(`Instance ${child._guid} is not attached to this instance.`);\n\n  const promise = runloop.start();\n\n  if (meta.anchor) meta.anchor.removeChild(meta);\n  if (!child.isolated) child.viewmodel.detached();\n\n  children.splice(index, 1);\n  if (meta.target) {\n    this.splice(\n      `@this.children.byName.${meta.target}`,\n      children.byName[meta.target].indexOf(meta),\n      1\n    );\n    updateAnchors(this, meta.target);\n  }\n  const rm = child.viewmodel.getRactiveModel();\n  rm.joinKey('parent', { lastLink: false }).unlink();\n  rm.joinKey('root', { lastLink: false }).link(rm);\n  child.root = child;\n  child.parent = null;\n  child.component = null;\n\n  hooks.detachchild.fire(child);\n\n  runloop.end();\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n","export default function Ractive$find(selector, options = {}) {\n  if (!this.rendered)\n    throw new Error(\n      `Cannot call ractive.find('${selector}') unless instance is rendered to the DOM`\n    );\n\n  let node = this.fragment.find(selector, options);\n  if (node) return node;\n\n  if (options.remote) {\n    for (let i = 0; i < this._children.length; i++) {\n      if (!this._children[i].instance.fragment.rendered) continue;\n      node = this._children[i].instance.find(selector, options);\n      if (node) return node;\n    }\n  }\n}\n","import { isArray } from 'utils/is';\n\nexport default function Ractive$findAll(selector, options = {}) {\n  if (!this.rendered)\n    throw new Error(\n      `Cannot call ractive.findAll('${selector}', ...) unless instance is rendered to the DOM`\n    );\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAll(selector, options);\n\n  if (options.remote) {\n    // seach non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        c.instance.findAll(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isArray, isObjectType } from 'utils/is';\n\nexport default function Ractive$findAllComponents(selector, options) {\n  if (!options && isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  options = options || {};\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAllComponents(selector, options);\n\n  if (options.remote) {\n    // search non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        if (!selector || c.name === selector) {\n          options.result.push(c.instance);\n        }\n\n        c.instance.findAllComponents(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isObjectType } from 'utils/is';\n\nexport default function Ractive$findComponent(selector, options = {}) {\n  if (isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  let child = this.fragment.findComponent(selector, options);\n  if (child) return child;\n\n  if (options.remote) {\n    if (!selector && this._children.length) return this._children[0].instance;\n    for (let i = 0; i < this._children.length; i++) {\n      // skip children that are or should be in an anchor\n      if (this._children[i].target) continue;\n      if (this._children[i].name === selector) return this._children[i].instance;\n      child = this._children[i].instance.findComponent(selector, options);\n      if (child) return child;\n    }\n  }\n}\n","export default function Ractive$findContainer(selector) {\n  if (this.container) {\n    if (this.container.component && this.container.component.name === selector) {\n      return this.container;\n    } else {\n      return this.container.findContainer(selector);\n    }\n  }\n\n  return null;\n}\n","export default function Ractive$findParent(selector) {\n  if (this.parent) {\n    if (this.parent.component && this.parent.component.name === selector) {\n      return this.parent;\n    } else {\n      return this.parent.findParent(selector);\n    }\n  }\n\n  return null;\n}\n","import { ANCHOR, COMPONENT, ELEMENT } from 'config/types';\n\nexport default function findElement(start, orComponent = true, name) {\n  while (\n    start &&\n    (start.type !== ELEMENT || (name && start.name !== name)) &&\n    (!orComponent || (start.type !== COMPONENT && start.type !== ANCHOR))\n  ) {\n    // start is a fragment - look at the owner\n    if (start.owner) start = start.owner;\n    else if (start.component || start.yield)\n      // start is a component or yielder - look at the container\n      start = start.containerFragment || start.component.up;\n    else if (start.parent)\n      // start is an item - look at the parent\n      start = start.parent;\n    else if (start.up)\n      // start is an item without a parent - look at the parent fragment\n      start = start.up;\n    else start = undefined;\n  }\n\n  return start;\n}\n","import { isNumber } from 'utils/is';\n\n// This function takes an array, the name of a mutator method, and the\n// arguments to call that mutator method with, and returns an array that\n// maps the old indices to their new indices.\n\n// So if you had something like this...\n//\n//     array = [ 'a', 'b', 'c', 'd' ];\n//     array.push( 'e' );\n//\n// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n// have changed. If you then did this...\n//\n//     array.unshift( 'z' );\n//\n// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n// one higher to make room for the 'z'. If you removed an item, the new index\n// would be -1...\n//\n//     array.splice( 2, 2 );\n//\n// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n//\n// This information is used to enable fast, non-destructive shuffling of list\n// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\nexport default function getNewIndices(length, methodName, args) {\n  const newIndices = [];\n\n  const spliceArguments = getSpliceEquivalent(length, methodName, args);\n\n  if (!spliceArguments) {\n    return null; // TODO support reverse and sort?\n  }\n\n  const balance = spliceArguments.length - 2 - spliceArguments[1];\n\n  const removeStart = Math.min(length, spliceArguments[0]);\n  const removeEnd = removeStart + spliceArguments[1];\n  newIndices.startIndex = removeStart;\n\n  let i;\n  for (i = 0; i < removeStart; i += 1) {\n    newIndices.push(i);\n  }\n\n  for (; i < removeEnd; i += 1) {\n    newIndices.push(-1);\n  }\n\n  for (; i < length; i += 1) {\n    newIndices.push(i + balance);\n  }\n\n  // there is a net shift for the rest of the array starting with index + balance\n  if (balance !== 0) {\n    newIndices.touchedFrom = spliceArguments[0];\n  } else {\n    newIndices.touchedFrom = length;\n  }\n\n  return newIndices;\n}\n\n// The pop, push, shift an unshift methods can all be represented\n// as an equivalent splice\nfunction getSpliceEquivalent(length, methodName, args) {\n  switch (methodName) {\n    case 'splice':\n      if (args[0] !== undefined && args[0] < 0) {\n        args[0] = length + Math.max(args[0], -length);\n      }\n\n      if (args[0] === undefined) args[0] = 0;\n\n      while (args.length < 2) {\n        args.push(length - args[0]);\n      }\n\n      if (!isNumber(args[1])) {\n        args[1] = length - args[0];\n      }\n\n      // ensure we only remove elements that exist\n      args[1] = Math.min(args[1], length - args[0]);\n\n      return args;\n\n    case 'sort':\n    case 'reverse':\n      return null;\n\n    case 'pop':\n      if (length) {\n        return [length - 1, 1];\n      }\n      return [0, 0];\n\n    case 'push':\n      return [length, 0].concat(args);\n\n    case 'shift':\n      return [0, length ? 1 : 0];\n\n    case 'unshift':\n      return [0, 0].concat(args);\n  }\n}\n","import hooks from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isString } from 'utils/is';\n\nexport function update(ractive, model, options) {\n  // if the parent is wrapped, the adaptor will need to be updated before\n  // updating on this keypath\n  if (model.parent && model.parent.wrapper) {\n    model.parent.adapt();\n  }\n\n  const promise = runloop.start();\n\n  model.mark(options && options.force);\n\n  // notify upstream of changes\n  model.notifyUpstream();\n\n  runloop.end();\n\n  hooks.update.fire(ractive, model);\n\n  return promise;\n}\n\nexport default function Ractive$update(keypath, options) {\n  let opts, path;\n\n  if (isString(keypath)) {\n    path = splitKeypath(keypath);\n    opts = options;\n  } else {\n    opts = keypath;\n  }\n\n  return update(this, path ? this.viewmodel.joinAll(path) : this.viewmodel, opts);\n}\n","import fireEvent from 'src/events/fireEvent';\nimport Context from 'shared/Context';\nimport { assign, create } from 'utils/object';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$fire(eventName, ...args) {\n  let ctx;\n\n  // watch for reproxy\n  if (args[0] instanceof Context) {\n    const proto = args.shift();\n    ctx = create(proto);\n    assign(ctx, proto);\n  } else if (isObjectType(args[0]) && (args[0] === null || args[0].constructor === Object)) {\n    ctx = Context.forRactive(this, args.shift());\n  } else {\n    ctx = Context.forRactive(this);\n  }\n\n  return fireEvent(this, eventName, ctx, args);\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport { FakeFragment } from 'shared/getRactiveContext';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$get(keypath, opts) {\n  if (!isString(keypath)) return this.viewmodel.get(true, keypath);\n\n  const keys = splitKeypath(keypath);\n  const key = keys[0];\n\n  let model;\n\n  if (!this.viewmodel.has(key)) {\n    // if this is an inline component, we may need to create\n    // an implicit mapping\n    if (this.component && !this.isolated) {\n      model = resolveReference(this.fragment || new FakeFragment(this), key);\n    }\n  }\n\n  model = this.viewmodel.joinAll(keys);\n  return model.get(true, opts);\n}\n","import staticContext from '../static/getContext';\nimport getRactiveContext from 'src/shared/getRactiveContext';\nimport { isString } from 'utils/is';\n\nexport default function getContext(node, options) {\n  if (!node) return getRactiveContext(this);\n\n  if (isString(node)) {\n    node = this.find(node, options);\n  }\n\n  return staticContext(node);\n}\n","import hooks from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\n\nexport default function Ractive$insert(target, anchor) {\n  if (!this.fragment.rendered) {\n    // TODO create, and link to, documentation explaining this\n    throw new Error(\n      'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.'\n    );\n  }\n\n  target = getElement(target);\n  anchor = getElement(anchor) || null;\n\n  if (!target) {\n    throw new Error('You must specify a valid target to insert into');\n  }\n\n  target.insertBefore(this.detach(), anchor);\n  this.el = target;\n\n  (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(this);\n  this.isDetached = false;\n\n  fireInsertHook(this);\n}\n\nfunction fireInsertHook(ractive) {\n  hooks.insert.fire(ractive);\n\n  ractive.findAllComponents('*').forEach(child => {\n    fireInsertHook(child.instance);\n  });\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from 'src/global/runloop';\n\nexport default function link(there, here, options) {\n  let model;\n  const target = (options && (options.ractive || options.instance)) || this;\n\n  // may need to allow a mapping to resolve implicitly\n  const sourcePath = splitKeypath(there);\n  if (!target.viewmodel.has(sourcePath[0]) && target.component) {\n    model = resolveReference(target.component.up, sourcePath[0]);\n    model = model.joinAll(sourcePath.slice(1));\n  }\n\n  const src = model || target.viewmodel.joinAll(sourcePath);\n  const dest = this.viewmodel.joinAll(splitKeypath(here), { lastLink: false });\n\n  if (isUpstream(src, dest) || isUpstream(dest, src)) {\n    throw new Error('A keypath cannot be linked to itself.');\n  }\n\n  const promise = runloop.start();\n\n  dest.link(src, (options && options.keypath) || there);\n\n  runloop.end();\n\n  return promise;\n}\n\nfunction isUpstream(check, start) {\n  let model = start;\n  while (model) {\n    if (model === check || model.owner === check) return true;\n    model = model.target || model.parent;\n  }\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport Observer from './observe/Observer';\nimport PatternObserver from './observe/Pattern';\nimport ArrayObserver from './observe/Array';\nimport { keys } from 'utils/object';\n\nexport default function observe(keypath, callback, options) {\n  const observers = [];\n  let map;\n  let opts;\n\n  if (isObject(keypath)) {\n    map = keypath;\n    opts = callback || {};\n  } else {\n    if (isFunction(keypath)) {\n      map = { '': keypath };\n      opts = callback || {};\n    } else {\n      map = {};\n      map[keypath] = callback;\n      opts = options || {};\n    }\n  }\n\n  let silent = false;\n  keys(map).forEach(keypath => {\n    const callback = map[keypath];\n    const caller = function(...args) {\n      if (silent) return;\n      return callback.apply(this, args);\n    };\n\n    let keypaths = keypath.split(' ');\n    if (keypaths.length > 1) keypaths = keypaths.filter(k => k);\n\n    keypaths.forEach(keypath => {\n      opts.keypath = keypath;\n      const observer = createObserver(this, keypath, caller, opts);\n      if (observer) observers.push(observer);\n    });\n  });\n\n  // add observers to the Ractive instance, so they can be\n  // cancelled on ractive.teardown()\n  this._observers.push.apply(this._observers, observers);\n\n  return {\n    cancel: () => observers.forEach(o => o.cancel()),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n\nfunction createObserver(ractive, keypath, callback, options) {\n  const keys = splitKeypath(keypath);\n  let wildcardIndex = keys.indexOf('*');\n  if (!~wildcardIndex) wildcardIndex = keys.indexOf('**');\n\n  options.fragment = options.fragment || ractive.fragment;\n\n  let model;\n  if (!options.fragment) {\n    model = ractive.viewmodel.joinKey(keys[0]);\n  } else {\n    // .*.whatever relative wildcard is a special case because splitkeypath doesn't handle the leading .\n    if (~keys[0].indexOf('.*')) {\n      model = options.fragment.findContext();\n      wildcardIndex = 0;\n      keys[0] = keys[0].slice(1);\n    } else {\n      model =\n        wildcardIndex === 0\n          ? options.fragment.findContext()\n          : resolveReference(options.fragment, keys[0]);\n    }\n  }\n\n  // the model may not exist key\n  if (!model) model = ractive.viewmodel.joinKey(keys[0]);\n\n  if (!~wildcardIndex) {\n    model = model.joinAll(keys.slice(1));\n    if (options.array) {\n      return new ArrayObserver(ractive, model, callback, options);\n    } else {\n      return new Observer(ractive, model, callback, options);\n    }\n  } else {\n    const double = keys.indexOf('**');\n    if (~double) {\n      if (double + 1 !== keys.length || ~keys.indexOf('*')) {\n        warnOnceIfDebug(\n          `Recursive observers may only specify a single '**' at the end of the path.`\n        );\n        return;\n      }\n    }\n\n    model = model.joinAll(keys.slice(1, wildcardIndex));\n\n    return new PatternObserver(ractive, model, keys.slice(wildcardIndex), callback, options);\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\n\nexport default function Ractive$off(eventName, callback) {\n  // if no event is specified, remove _all_ event listeners\n  if (!eventName) {\n    this._subs = {};\n  } else {\n    // Handle multiple space-separated event names\n    const eventNames = eventName\n      .split(' ')\n      .map(trim)\n      .filter(notEmptyString);\n\n    eventNames.forEach(event => {\n      const subs = this._subs[event];\n      // if given a specific callback to remove, remove only it\n      if (subs && callback) {\n        const entry = subs.find(s => s.callback === callback);\n        if (entry) {\n          removeFromArray(subs, entry);\n          entry.off = true;\n\n          if (event.indexOf('.')) this._nsSubs--;\n        }\n      } else if (subs) {\n        // otherwise, remove all listeners for this event\n        if (event.indexOf('.')) this._nsSubs -= subs.length;\n        subs.length = 0;\n      }\n    });\n  }\n\n  return this;\n}\n","import trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\nimport { hasOwn } from 'utils/object';\nimport { isObjectType, isString } from 'utils/is';\n\nexport default function Ractive$on(eventName, callback) {\n  // eventName may already be a map\n  const map = isObjectType(eventName) ? eventName : {};\n  // or it may be a string along with a callback\n  if (isString(eventName)) map[eventName] = callback;\n\n  let silent = false;\n  const events = [];\n\n  for (const k in map) {\n    const callback = map[k];\n    const caller = function(...args) {\n      if (!silent) return callback.apply(this, args);\n    };\n    const entry = {\n      callback,\n      handler: caller\n    };\n\n    if (hasOwn(map, k)) {\n      const names = k\n        .split(' ')\n        .map(trim)\n        .filter(notEmptyString);\n      names.forEach(n => {\n        (this._subs[n] || (this._subs[n] = [])).push(entry);\n        if (n.indexOf('.')) this._nsSubs++;\n        events.push([n, entry]);\n      });\n    }\n  }\n\n  return {\n    cancel: () => events.forEach(e => this.off(e[0], e[1].callback)),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n","export default function Ractive$once(eventName, handler) {\n  const listener = this.on(eventName, function() {\n    handler.apply(this, arguments);\n    listener.cancel();\n  });\n\n  // so we can still do listener.cancel() manually\n  return listener;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function readLink(keypath, options = {}) {\n  const path = splitKeypath(keypath);\n\n  if (this.viewmodel.has(path[0])) {\n    let model = this.viewmodel.joinAll(path);\n\n    if (!model.isLink) return;\n\n    while ((model = model.target) && options.canonical !== false) {\n      if (!model.isLink) break;\n    }\n\n    if (model) return { ractive: model.root.ractive, keypath: model.getKeypath() };\n  }\n}\n","function s4() {\n  return Math.floor((1 + Math.random()) * 0x10000)\n    .toString(16)\n    .substring(1);\n}\n\nexport function uuid() {\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\n","import { applyCSS } from '../../global/css';\nimport transformCSS from '../config/custom/css/transform';\nimport { evalCSS } from '../config/custom/css/css';\nimport { build, set } from '../../shared/set';\nimport runloop from '../../global/runloop';\nimport { isObjectType, isFunction } from 'utils/is';\n\nexport default function setCSSData(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = this._cssModel;\n\n  model.locked = true;\n  const promise = set(build({ viewmodel: model }, keypath, value, true), opts);\n  model.locked = false;\n\n  const cascade = runloop.start();\n  this.extensions.forEach(e => {\n    const model = e._cssModel;\n    model.mark();\n    model.downstreamChanged('', 1);\n  });\n  runloop.end();\n\n  applyChanges(this, !opts || opts.apply !== false);\n\n  return promise.then(() => cascade);\n}\n\nexport function applyChanges(component, apply) {\n  const local = recomputeCSS(component);\n  const child = component.extensions\n    .map(e => applyChanges(e, false))\n    .reduce((a, c) => c || a, false);\n\n  if (apply && (local || child)) {\n    const def = component._cssDef;\n    if (!def || (def && def.applied)) applyCSS(true);\n  }\n\n  return local || child;\n}\n\nexport function recomputeCSS(component) {\n  const css = component.css;\n\n  if (!isFunction(css)) return;\n\n  const def = component._cssDef;\n  const result = evalCSS(component, css);\n  const styles = def.transform ? transformCSS(result, def.id) : result;\n\n  if (def.styles === styles) return;\n\n  def.styles = styles;\n\n  return true;\n}\n"],"names":["this","bound","dirty","update","Fragment__proto__","bubble","dirtyValue","isRoot","ractive","component","runloop","addFragment","owner","index","createItems","max","template","length","items","let","i","this$1","createItem","up","destroyed","len","pathModel","rootModel","detach","docFrag","createDocumentFragment","xs","appendChild","find","selector","options","findMap","findAll","forEach","findComponent","name","findAllComponents","findContext","base","findParentWithContext","context","viewmodel","findNextNode","item","it","firstNode","node","parent","findParentNode","fragment","type","ELEMENT","el","YIELDER","containerFragment","componentParent","Error","skipParent","getKey","keyModel","KeyModel","key","getIndex","idxModel","rebind","next","rebound","x","applyValue","getKeypath","root","render","target","occupants","rendered","resetTemplate","wasBound","wasRendered","unrender","unbind","bind","parentNode","anchor","insertBefore","shuffled","toString","escape","map","toEscapedString","join","view","shouldDestroy","updating","addFragmentToRoot","valueOf","values","source","processItems","_guid","parsed","parseJSON","value","Fragment","prototype","getContext","const","shouldRerender","reverse","makeArrayMethod","path","shift","sort","splice","unshift","proto","add","animate","attachChild","compute","detachChild","findContainer","findParent","fire","get","insert","link","observe","observeOnce","off","on","once","pop","push","readLink","reset","resetPartial","set","subtract","teardown","toggle","toCSS","toCss","toHTML","toHtml","toText","transition","unlink","updateModel","use","styles","callsSuper","defineProperties","Ractive","sharedGet","sharedSet","styleGet","configurable","styleSet","addCSS","addStyle","hasCSS","hasStyle","win","opts","script","document","currentScript","querySelector","getAttribute","indexOf","warn","assign","defaults","constructor","DEBUG","writable","DEBUG_PROMISES","extend","extendWith","escapeKey","evalObjectString","findPlugin","getCSS","isInstance","joinKeys","macro","normaliseKeypath","normalise","parse","splitKeypath","unescapeKey","enhance","svg","VERSION","adaptors","components","decorators","easing","events","extensions","helpers","interpolators","partials","transitions","cssData","sharedData","Context","extern","defineProperty","CSSModel","str","substring","pos","nextChar","charAt","message","msg","getContextMessage","warnIfDebug","Parser","Parent","Child","call","create","hasOwn","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","singleMatcher","makeQuotedStringMatcher","doubleMatcher","numberPattern","identifier","specials","true","false","null","undefined","specialsPattern","RegExp","keys","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","JsonParser","init","sp","postProcess","result","test","leftover","v","converters","parser","placeholder","matchPattern","special","number","stringLiteral","readStringLiteral","replace","match","$1","matchString","pair","getKeyValuePair","valueToken","read","Mapping","Item","super","n","element","findElement","attributeByName","f","Mapping__proto__","instance","joinKey","isString","isArray","createMapping","boundFragment","model","resolve","joinAll","mapping","unregister","Option","Element","a","select","Option__proto__","selectedAttribute","selected","attributes","_ractive","attribute","getValue","isSelected","optionValue","selectValue","compare","removeFromArray","Partial","MustacheContainer","yielder","container","r","rx","refName","fn","partialFromValue","partial","warnOnceIfDebug","createFragment","initMacro","handleChange","dirtyTemplate","externalChange","aliases","k","unreference","z","resolveAliases","_attrs","refreshAttrs","handle","proxy","last","fnTemplate","isFunction","getPartialTemplate","contextifyTemplate","unbindAttrs","scheduleTask","_cssDef","applied","applyCSS","dirtyAttrs","invalidate","extras","isReadonly","isKey","deps","links","children","KeyModel__proto__","c","upstream","unregisterChild","shouldCapture","capture","has","previous","relinking","register","dependant","registerChild","child","addToArray","registerLink","unregisterLink","reference","noop","keypathString","RepeatedFragment","delegate","findDelegate","cssIds","iterations","indexRef","keyRef","pendingNewIndices","previousIterations","RepeatedFragment__proto__","slice","shuffler","s","shuffleValues","isComputed","createIteration","isObject","refs","split","ks","bubbled","rebounding","isIteration","swizzleFragment","iteration","getLast","lastModel","contextFor","shuffle","newIndices","merge","newIndex","oldIndex","shouldRebind","updatePostShuffle","buildNewIndices","toRemove","oldKeys","wasArray","lastValue","i$1","newLength","updateLast","fragment$1","nextNode","indices","idx","dest","prev","iters","stash","Array","e","nextRendered","isObjectType","plen","Section","sectionType","templateSectionType","subordinate","l","Section__proto__","sibling","nextSibling","SECTION_UNLESS","isTruthy","frag","detached","SECTION_IF_WITH","isEmpty","safe","SECTION_IF","SECTION_WITH","SECTION_EACH","siblingFalsey","lastType","getType","newFragment","fragmentShouldExist","attach","keep","promise","then","Select","Select__proto__","foundNode","binding","selectedOptions","getSelectedOptions","sync","defaultSelected","selectNode","toArray","o","setFromNode","isMultiple","array","optionWasSelected","shouldSelect","valueContains","forceUpdate","comparator","Textarea","Input","deferContent","isBindable","t","ATTRIBUTE","Textarea__proto__","Text","TEXT","Text__proto__","detachNode","inAttributes","progressiveText","escapeHtml","visible","hidden","doc","prefix","vendors","vendor","addEventListener","onChange","onHide","onShow","isClient","prefixCache","testStyle","createElement","style","prop","hyphenateCamel","createTransitions","prefix$1","vendorPattern","TRANSITION","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","linear","canUseCssTransitions","cannotUseCssTransitions","webkitTransition","to","changedProperties","setTimeout","transitionDone","clearTimeout","cssTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","unregisterCompleteHandler","isIntro","transitionEndHandler","event","propertyName","cssTransitionsDone","property","duration","timing","removeEventListener","hashPrefix","namespaceURI","tagName","delay","registerCompleteHandler","easingName","hyphenate","cssTiming","hash","suffix","interpolator","originalValue","propertiesToTransitionInJs","initial","getStyle","exec","interpolate","parseFloat","missingPlugin","Ticker","step","complete","createTransitions$1","getComputedStyle","resolved","Promise","names","t0","t1","t2","Transition","onComplete","Transition__proto__","animateStyle","arguments","setStyle","fulfil","propertyNames","computedStyle","current","originals","targets","intro","outro","eventName","params","_fn","findInViewHierarchy","setupArgsFn","getParams","resolveArgs","apply","props","processParams","isNumber","shouldFire","transitionsEnabled","rendering","nearestProp","unrendering","nested","starting","start","completed","args","noReset","_manager","remove","concat","unbinding","ieBug","ieBlacklist","elementCache","innerHTML","err","TABLE","THEAD","TBODY","TR","SELECT","Triple","Mustache","Triple__proto__","nodes","nodeType","matches","queryResult","queryAllResult","querySelectorAll","html","insertHtml","outerHTML","nodeValue","removeChild","inAttribute","decodeCharacterReferences","detachWhenReady","constructors","ALIAS","Alias","ANCHOR","Component","AWAIT","Await","DOCTYPE","Doctype","INTERPOLATOR","Interpolator","PARTIAL","SECTION","TRIPLE","Attribute","BINDING_FLAG","BindingFlag","DECORATOR","Decorator","EVENT","EventDirective","COMMENT","Comment","specialElements","doctype","form","Form","input","option","textarea","attrs","leftovers","ConditionalAttribute","eventHandlers","Component__proto__","isAnchor","initialise","_partials","assigns","getRactiveContext","checking","checkAnchors","callRender","isolated","unrenderItem","missingDecorator","Decorator__proto__","models","rebindMatch","addShuffleRegister","teardownArgsFn","warnOnce","Doctype__proto__","Binding","twowayBinding","setRoot","keypath","isTwoway","wasUndefined","getInitialValue","lastVal","parentForm","resetValue","formBindings","Binding__proto__","registerTwowayBinding","locked","end","setting","unregisterTwowayBinding","CheckboxBinding","CheckboxBinding__proto__","handleDomEvent","attachEvent","checked","BindingGroup","bindings","BindingGroup__proto__","CheckboxNameBinding","checkboxName","group","getBindingGroup","noInitialValue","existingValue","bindingValue","arrayContains","CheckboxNameBinding__proto__","isChecked","valueSoFar","ContentEditableBinding","ContentEditableBinding__proto__","lazy","GenericBinding","GenericBinding__proto__","timeout","isNumeric","handler","handleDelay","handleBlur","FileBinding","FileBinding__proto__","files","MultipleSelectBinding","MultipleSelectBinding__proto__","filter","selectedValues","previousValue","arrayContentsMatch","NumericBinding","NumericBinding__proto__","isNaN","siblings","RadioBinding","getSiblings","RadioBinding__proto__","RadioNameBinding","pathChanged","updateName","RadioNameBinding__proto__","SingleSelectBinding","SingleSelectBinding__proto__","disabled","endsWithSemi","ContainerItem","toLowerCase","attr","val","cls","m","g","statics","DELEGATE_FLAG","Element__proto__","recreateTwowayBinding","createTwowayBinding","twoway","selectBinding","ref","ctx","callback","listeners","delegateHandler","rem","namespace","getNamespace","existing","nodeName","toUpperCase","setAttribute","isOutro","registerTransition","childNodes","removeAttribute","ls","stringifyAttribute","inputIsCheckedRadio","safeAttributeString","getString","inlineClass","voidElements","UIEvent","Form__proto__","handleReset","DOMEvent","fatal","DOMEvent__proto__","directive","original","CustomEvent","eventPlugin","CustomEvent__proto__","RactiveEvent","RactiveEvent__proto__","cancel","specialPattern","dollarArgsPattern","EventDirective__proto__","COMPONENT","rs","resolveReference","getFunction","action","refire","specialRef","specialMatch","substr","dollarMatch","obj","which","wrapper","wrapperValue","oldEvent","returned","preventDefault","stopPropagation","fireEvent","isStatic","Mustache__proto__","pre","y","Object","Interpolator__proto__","safeToStringValue","string","data","Input__proto__","defaultValue","attrValue","leadingWhitespace","ParseError","stack","lineStart","lines","lineEnds","line","lineEnd","remaining","getLinePos","lineNum","columnNum","contextLines","contextUp","contextDown","numTabs","annotation","char","error","character","shortMessage","pattern","ns","div","methodNames","makeFunction","methodName","unprefixed","j","prefixed","cloneNode","Observer","old","oldContext","oldFn","dispatch","updateOld","Observer__proto__","cancelled","resolver","_observers","newValue","oldValue","isEqual","strict","addObserver","defer","addShuffleTask","star","PatternObserver","baseModel","baseKeypath","recursive","oldValues","newValues","changed","findMatches","registerPatternObserver","PatternObserver__proto__","unregisterPatternObserver","wildcards","notify","touchedFrom","count","isLink","ok","check","ArrayObserver","pending","sliced","ArrayObserver__proto__","negativeOne","inserted","deleted","hadIndex","onceOptions","trim","notEmptyString","PREFIX","styleDefinitions","isDirty","styleElement","useCssText","adaptConfigurator","adapt","combine","ensureArray","selectorsPattern","importPattern","importEndPattern","keyframesDeclarationPattern","selectorUnitPattern","excludePattern","dataRvcGuidPattern","SharedModel","CSSModel__proto__","downstreamChanged","depth","_cssModel","mark","applyChanges","hasCurly","cssConfigurator","_cssIds","gatherIds","css","initCSS","dataConfigurator","_r_unbound","TEMPLATE_VERSION","templateConfigurator","parseTemplate","getDynamicTemplate","_config","p","extendPartials","registryNames","registriesOnDefaults","Registry","useDefaults","Registry__proto__","configure","registry","addFunctions","isOwner","registries","putInDefaults","config","order","custom","computed","defaultKeys","isStandardKey","makeObj","isBlacklisted","_super","Item__proto__","ContainerItem__proto__","ComputationChild","Model","syncComputedChildren","prototypeAccessors$1","ComputationChild__proto__","dependencies","parentValue","newWrapperValue","unwrap","boundValue","marked","childByKey","Computation","signature","setter","prototypeAccessors$2","Computation__proto__","active","notifyUpstream","maybeBind","shouldBind","noVirtual","startCapturing","getter","hasConsole","console","groupCollapsed","sig","getterUseStack","groupEnd","stopCapturing","setDependencies","shared","ExpressionProxy","allowExpressions","ExpressionProxy__proto__","actuallyChanged","d","retrieve","collect","dep","computation","ReferenceExpressionProxy","LinkModel","rootLink","ReferenceExpressionProxy__proto__","members","Missing","tpl","REFERENCE","reduce","list","String","fireShuffleTasks","refreshPathDeps","eproto","Alias__proto__","booleanAttributes","allowfullscreen","async","autofocus","autoplay","compact","controls","declare","default","defaultchecked","defaultmuted","defaultselected","enabled","formnovalidate","indeterminate","inert","ismap","itemscope","loop","multiple","muted","nohref","noresize","noshade","novalidate","nowrap","open","pauseonexit","readonly","required","reversed","scoped","seamless","sortable","translate","truespeed","typemustmatch","area","br","col","command","embed","hr","img","keygen","meta","param","track","wbr","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","codePointSupport","fromCodePoint","codeToChar","fromCharCode","lessThan","greaterThan","invalid","space","textTypes","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","maxlength","pubdate","rowspan","tabindex","usemap","ConditionalAttribute__proto__","isSvg","parseAttributes","notIn","updateDelegate","Attribute__proto__","namespaces","useProperty","isBoolean","lookupNamespace","getUpdateDelegate","flag","bubbler","BindingFlag__proto__","createComment","RactiveModel","RactiveModel__proto__","initLink","specialModels","@this","getRactiveModel","@global","GlobalModel","@shared","@style","@helpers","getHelpers","RootModel","RootModel__proto__","attached","attachImplicits","createLink","targetPath","detachImplicits","virtual","getVirtual","SharedBase","ractiveModel","getValueChildren","_link","unescapedKey","shouldTeardown","protoRegistries","uid","ComponentConstructor","content","addChild","construct","mappings","_inlinePartials","object","id","buildCSS","transform","recomputeCSS","build","plugins","extendOne","Class","Target","_on","toPairs","_observe","optional","splitKeypathI","TypeError","sourcesLength","sources","nextSource","nextKey","hasOwnProperty","thisArg","arrayLength","window","Node","contains","performance","now","nowOffset","Date","global","implementation","hasFeature","PENDING","FULFILLED","REJECTED","dispatchHandlers","fulfilledHandlers","rejectedHandlers","state","makeResolver","newState","makeDispatcher","wait","fulfill","reject","onFulfilled","onRejected","promise2","processResolutionHandler","handlers","forward","p1result","catch","finally","all","promises","processPromise","race","fail","reason","called","resolvePromise","rejectPromise","requestAnimationFrame","cancelAnimationFrame","lastTime","currentTime","timeToNextCall","Math","log","printWarning","welcome","append","delimiters","tripleDelimiters","staticDelimiters","staticTripleDelimiters","csp","preserveWhitespace","sanitize","stripComments","resolveInstanceMembers","warnAboutAmbiguity","noIntro","noOutro","nestedTransitions","noCSSTransform","easeIn","pow","easeOut","easeInOut","alreadyWarned","welcomeIntro","welcomeMessage","WELCOME_MESSAGE","hasGroup","badArguments","noRegistryFunctionReturn","from","intermediate","min","properties","refPattern","splitPattern","escapeKeyPattern","unescapeKeyPattern","fnBind","Function","shuffleTasks","early","registerQueue","ModelBase","ModelBase__proto__","task","stage","existingMatches","objectKeys","lastLink","startPath","patterns","notifiedUpstream","observer","updateFromBindings","cascade","oneway","findBoundValue","captureGroup","shufle","sourcePath","LinkModel__proto__","isDetached","force","markedAll","relinked","shuffling","lnk","implicit","ln","functions","parseOptions","TEMPLATE_INSTRUCTIONS","COMPUTATION_INSTRUCTIONS","fromId","noThrow","getElementById","textContent","isParsed","getParseOptions","throwNoParse","parseFor","TransitionManager","intros","outros","totalChildren","outroChildren","detachQueue","outrosComplete","TransitionManager__proto__","checkStart","started","decrementOutros","decrementTotal","detachNodes","ready","detachImmediate","batch","fulfilPromise","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","flushChanges","b","thing","postRender","_batch","tickers","running","tick","Ticker__proto__","elapsed","eased","stop","abort","prefixers","ticker","Model__proto__","rewrap","createBranch","adaptor","wrap","getPrefixer","__model","isObjectLike","getComputationSignature","branch","markForce","recreateArray","unsafe","SharedModel__proto__","SharedModel$1","FakeFragment","deepOpts","comparators","errorMessage","initStars","bubbleStars","Hook","method","arg","HookQueue","hook","inProcess","queue","HookQueue__proto__","begin","getChildQueue","hooks","NUMBER_LITERAL","STRING_LITERAL","ELSE","THEN","CATCH","arrayProto","modelPush","modelPop","modelShift","modelUnshift","modelSort","modelSplice","modelReverse","ContextData","ContextData__proto__","prototypeAccessors","_data","Context__proto__","num","findModel","protoAnimate","getParent","hasListener","findEvent","there","here","listen","raise","ev","drop","unlisten","protoUpdate","isBound","getBindingModel","getBindingPath","getBinding","setBinding","forRactive","query","mathml","xlink","xml","xmlns","createElementNS","superMethod","getSuperMethod","_parent","hasSuper","oldSuper","_method","getMessage","deprecated","correct","isError","deprecateOption","deprecatedOption","deprecate","extendOtherMethods","member","RactiveProto","wrapPrototype","entity","code","parseInt","validateCode","camelCaseStr","readStyle","cleanCss","reconstruct","rule","rules","readClass","updateMultipleSelectValue","updateSelectValue","updateStringValue","updateContentEditableValue","updateRadioValue","updateValue","updateRadioName","updateCheckboxName","updateStyleAttribute","updateInlineStyle","updateClassName","updateInlineClass","updateBoolean","updateNamespacedAttribute","updateAttribute","wasSelected","selectedIndex","wasChecked","safeValue","valueAttribute","setProperty","getPropertyValue","className","baseVal","getAttributeNS","removeAttributeNS","setAttributeNS","haystack","needle","qualified","hasAttribute","Ractive$teardown","torndown","getPromise","__ractive_instances__","destruct","_marking","mdl","subscribe","subs","single","initialiseProperties","handleAttributes","onconstruct","_attributePartial","getAdaptors","protoAdapt","lookup","srcs","_subs","_nsSubs","_eventQueue","_children","byName","mapAll","nameOption","renderItem","lastBound","updateAnchors","res","isBindableByValue","isBindableByContentEditable","isContentEditable","isBindableByName","isBindableByChecked","nameAttr","currentTarget","endEl","correspondingUseElement","text","splitText","createTextNode","okQuote","literal","done","charCodeAt","JSON","quote","readNumberLiteral","readKey","token","namePattern","childData","getPartialFromRegistry","fillGaps","findParentPartial","findInstance","findOwner","findConstructor","self","okToParse","parsePartial","setTemplate","initing","aliasLocal","findFirstNode","out","frags","section","hasIndexRef","selectedOption","firstChild","getComponentConstructor","asyncProxy","cmp","extract","success","undef","ctor","guid","counter","placeholderId","newModel","userOptions","getElement","logIfDebug","cssId","Ractive$render","others","Ractive$reset","rerender","changes","collection","Ractive$resetTemplate","external","Ractive$set","Ractive$subtract","Ractive$toggle","gather","Ractive$toCSS","uniqueCssIds","ids","Ractive$toHTML","Ractive$transition","HTMLElement","Ractive$unrender","Ractive$updateModel","pairs","isFinite","format","registryName","interpol","arrays","arrayLike","one","two","oldArray","newArray","oldLength","usedIndices","firstUnusedIndex","isKeypath","parts","findAlias","alias","fromExpression","body","createFunction","exp","instructions","createFunctionFromString","bindTo","expression","getterString","setterString","tm","notifiedTotal","manager","collectAllOutros","trans","nqueue","_list","prefixKeypath","rootKeypath","rootDot","relativeKeypath","initialFragment","explicitContext","badReference","repeater","findIter","ContextModel","findMacro","shouldWarn","crossed","_fakeFragment","deep","deepSet","getComparator","sets","Ractive$add","immediate","getOptions","Ractive$animate","enqueue","dequeue","variants","eventNames","fireEventAs","initialFire","notifySubscribers","fullName","subscribers","originalEvent","stopEvent","hookQueue","childQueue","findAnchors","findAnchorsIn","anchors","idxs","unrenderChild","prepend","insertAt","rm","attachchild","Ractive$compute","comp","first","Ractive$detach","detachchild","Ractive$find","remote","Ractive$findAll","Ractive$findAllComponents","Ractive$findComponent","Ractive$findContainer","Ractive$findParent","orComponent","getNewIndices","spliceArguments","getSpliceEquivalent","balance","removeStart","removeEnd","startIndex","Ractive$update","Ractive$fire","Ractive$get","instances","staticContext","output","Ractive$insert","fireInsertHook","src","isUpstream","fresh","vals","olds","observers","silent","caller","keypaths","createObserver","isSilenced","silence","resume","wildcardIndex","double","Ractive$off","entry","Ractive$on","Ractive$once","listener","canonical","styleDefinition","styleSheet","cssText","filteredStyleDefinitions","getElementsByTagName","additionalReplaceRules","extractString","unit","transformSelector","selectorUnits","modifiers","transformed","appended","prepended","transformCss","dataAttr","selectors","s4","floor","random","uuid","setCSSData","local","def","evalCSS","transformCSS","__proto__","cssProp","noCssTransform","validate","emptyData","childValue","parentIsFn","childIsFn","callDataFunction","fromProperties","primary","secondary","parseAsString","existingPartials","newPartials","overwrite"],"mappings":"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"}