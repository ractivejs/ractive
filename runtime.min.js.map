{"version":3,"file":"runtime.min.js","sources":["../src/view/items/Triple.js","../src/view/items/createItem.js","../src/view/Fragment.js","../src/Ractive/prototype/reset.js","../src/Ractive/prototype/reverse.js","../src/Ractive/prototype/shift.js","../src/Ractive/prototype/sort.js","../src/Ractive/prototype/splice.js","../src/Ractive/prototype/unshift.js","../src/Ractive/prototype.js","../src/Ractive/static/styles.js","../src/extend/_extend.js","../src/Ractive.js","../src/view/items/element/specials/Input.js","../src/parse/Parser.js","../src/parse/converters/expressions/primary/literal/stringLiteral/makeQuotedStringMatcher.js","../src/parse/converters/expressions/primary/literal/readStringLiteral.js","../src/parse/converters/expressions/primary/literal/readNumberLiteral.js","../src/parse/converters/expressions/shared/patterns.js","../src/parse/converters/expressions/shared/readKey.js","../src/utils/parseJSON.js","../src/view/items/component/Mapping.js","../src/view/items/element/specials/Option.js","../src/view/items/Partial.js","../src/model/specials/KeyModel.js","../src/view/RepeatedFragment.js","../src/view/items/Section.js","../src/view/items/element/specials/Select.js","../src/view/items/element/specials/Textarea.js","../src/view/items/Text.js","../src/config/visibility.js","../src/view/items/element/transitions/prefix.js","../src/view/items/element/transitions/createTransitions.js","../src/view/items/element/transitions/hyphenate.js","../src/view/items/element/Transition.js","../src/view/items/triple/insertHtml.js","../src/model/Computation.js","../src/view/resolvers/ExpressionProxy.js","../src/view/items/element/Decorator.js","../src/view/items/Doctype.js","../src/view/items/element/binding/Binding.js","../src/view/items/element/binding/CheckboxBinding.js","../src/view/items/element/binding/getBindingGroup.js","../src/view/items/element/binding/CheckboxNameBinding.js","../src/view/items/element/binding/ContentEditableBinding.js","../src/view/items/element/binding/GenericBinding.js","../src/view/items/element/binding/FileBinding.js","../src/view/items/element/binding/MultipleSelectBinding.js","../src/view/items/element/binding/NumericBinding.js","../src/view/items/element/binding/RadioBinding.js","../src/view/items/element/binding/RadioNameBinding.js","../src/view/items/element/binding/SingleSelectBinding.js","../src/view/items/Element.js","../src/view/items/element/specials/Form.js","../src/view/items/element/ElementEvents.js","../src/view/items/component/RactiveEvent.js","../src/view/items/shared/EventDirective.js","../src/view/resolvers/ReferenceExpressionProxy.js","../src/view/items/shared/Mustache.js","../src/view/items/Interpolator.js","../src/shared/Context.js","../src/Ractive/static/getContext.js","../src/utils/dom.js","../src/config/namespaces.js","../src/Ractive/prototype/observe/Observer.js","../src/Ractive/prototype/observe/Pattern.js","../src/Ractive/prototype/observe/Array.js","../src/Ractive/prototype/observeOnce.js","../src/Ractive/prototype/shared/trim.js","../src/Ractive/prototype/shared/notEmptyString.js","../src/Ractive/prototype/pop.js","../src/Ractive/prototype/push.js","../src/global/css.js","../src/Ractive/config/custom/adapt.js","../src/utils/cleanCss.js","../src/Ractive/config/custom/css/transform.js","../src/model/specials/CSSModel.js","../src/Ractive/config/custom/css/css.js","../src/Ractive/config/custom/data.js","../src/config/template.js","../src/Ractive/config/custom/template.js","../src/Ractive/config/registries.js","../src/Ractive/config/config.js","../src/utils/html.js","../src/view/items/shared/Item.js","../src/view/helpers/specialAttrs.js","../src/view/items/element/attribute/getUpdateDelegate.js","../src/view/items/element/attribute/propertyNames.js","../src/view/items/element/ConditionalAttribute.js","../src/view/items/element/Attribute.js","../src/view/items/element/BindingFlag.js","../src/view/items/Comment.js","../src/model/specials/RactiveModel.js","../src/model/RootModel.js","../src/Ractive/construct.js","../src/view/items/Component.js","../src/model/ComputationChild.js","../src/Ractive/prototype/toggle.js","../src/Ractive/prototype/toCSS.js","../src/Ractive/prototype/toHTML.js","../src/Ractive/prototype/toText.js","../src/Ractive/prototype/transition.js","../src/Ractive/prototype/unlink.js","../src/Ractive/prototype/unrender.js","../src/Ractive/prototype/updateModel.js","../src/Ractive/prototype/use.js","../src/Ractive/static/isInstance.js","../src/Ractive/static/styleGet.js","../src/Ractive/static/sharedSet.js","../src/Ractive/static/sharedGet.js","../src/Ractive/static/use.js","../src/extend/_macro.js","../src/Ractive/static/findPlugin.js","../src/polyfills/Object.assign.js","../src/utils/object.js","../src/utils/is.js","../src/polyfills/performance.now.js","../src/polyfills/array.find.js","../src/polyfills/node.contains.js","../src/config/environment.js","../src/polyfills/Promise.js","../src/polyfills/requestAnimationFrame.js","../src/Ractive/config/defaults.js","../src/utils/log.js","../src/Ractive/static/easing.js","../src/config/errors.js","../src/Ractive/static/interpolators.js","../src/shared/keypaths.js","../src/utils/bind.js","../src/model/ModelBase.js","../src/global/capture.js","../src/model/LinkModel.js","../src/shared/getFunction.js","../src/parse/_parse.js","../src/Ractive/config/runtime-parser.js","../src/global/TransitionManager.js","../src/global/runloop.js","../src/shared/Ticker.js","../src/model/helpers/getPrefixer.js","../src/model/Model.js","../src/model/specials/SharedModel.js","../src/shared/getRactiveContext.js","../src/shared/set.js","../src/Ractive/prototype/shared/add.js","../src/Ractive/prototype/animate.js","../src/events/fireEvent.js","../src/events/Hook.js","../src/config/types.js","../src/Ractive/prototype/shared/makeArrayMethod.js","../src/Ractive/config/wrapPrototypeMethod.js","../src/Ractive/config/deprecate.js","../src/utils/hyphenateCamel.js","../src/Ractive/prototype/teardown.js","../src/Ractive/helpers/subscribe.js","../src/view/items/shared/directiveArgs.js","../src/view/items/element/binding/handleDomEvent.js","../src/utils/getSelectedOptions.js","../src/view/items/element/binding/selectBinding.js","../src/view/items/shared/progressiveText.js","../src/view/resolvers/resolve.js","../src/view/items/partial/getPartialTemplate.js","../src/view/items/component/getComponentConstructor.js","../src/view/items/asyncProxy.js","../src/view/items/Await.js","../src/view/helpers/processItems.js","../src/Ractive/initialise.js","../src/Ractive/render.js","../src/Ractive/prototype/render.js","../src/Ractive/prototype/resetPartial.js","../src/Ractive/prototype/resetTemplate.js","../src/Ractive/prototype/set.js","../src/Ractive/prototype/subtract.js","../src/utils/noop.js","../src/shared/registry.js","../src/shared/interpolate.js","../src/utils/array.js","../src/shared/methodCallers.js","../src/shared/rebind.js","../src/parse/utils/createFunction.js","../src/Ractive/helpers/getComputationSignature.js","../src/view/resolvers/resolveReference.js","../src/Ractive/prototype/add.js","../src/events/eventStack.js","../src/shared/anchors.js","../src/Ractive/prototype/attachChild.js","../src/Ractive/prototype/compute.js","../src/Ractive/prototype/detach.js","../src/Ractive/prototype/detachChild.js","../src/Ractive/prototype/find.js","../src/Ractive/prototype/findAll.js","../src/Ractive/prototype/findAllComponents.js","../src/Ractive/prototype/findComponent.js","../src/Ractive/prototype/findContainer.js","../src/Ractive/prototype/findParent.js","../src/view/items/shared/findElement.js","../src/shared/getNewIndices.js","../src/Ractive/prototype/update.js","../src/Ractive/prototype/fire.js","../src/Ractive/prototype/get.js","../src/Ractive/prototype/getLocalContext.js","../src/Ractive/prototype/getContext.js","../src/Ractive/prototype/insert.js","../src/Ractive/prototype/link.js","../src/Ractive/static/keypaths.js","../src/Ractive/prototype/observe.js","../src/Ractive/prototype/off.js","../src/Ractive/prototype/on.js","../src/Ractive/prototype/once.js","../src/Ractive/prototype/readLink.js","../src/utils/id.js","../src/Ractive/static/styleSet.js"],"sourcesContent":["import { createDocumentFragment, matches } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport { decodeCharacterReferences } from 'utils/html';\nimport runloop from 'src/global/runloop';\nimport Mustache from './shared/Mustache';\nimport insertHtml from './triple/insertHtml';\nimport { inAttribute } from './element/Attribute';\n\nexport default class Triple extends Mustache {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    if (this.nodes) this.nodes.forEach(node => docFrag.appendChild(node));\n    return docFrag;\n  }\n\n  find(selector) {\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) return node;\n\n      const queryResult = node.querySelector(selector);\n      if (queryResult) return queryResult;\n    }\n\n    return null;\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) result.push(node);\n\n      const queryAllResult = node.querySelectorAll(selector);\n      if (queryAllResult) {\n        result.push.apply(result, queryAllResult);\n      }\n    }\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  firstNode() {\n    return this.rendered && this.nodes[0];\n  }\n\n  render(target, occupants, anchor) {\n    if (!this.nodes) {\n      const html = this.model ? this.model.get() : '';\n      this.nodes = insertHtml(html, target);\n    }\n\n    let nodes = this.nodes;\n\n    // progressive enhancement\n    if (occupants) {\n      let i = -1;\n      let next;\n\n      // start with the first node that should be rendered\n      while (occupants.length && (next = this.nodes[i + 1])) {\n        let n;\n        // look through the occupants until a matching node is found\n        while ((n = occupants.shift())) {\n          const t = n.nodeType;\n\n          if (\n            t === next.nodeType &&\n            ((t === 1 && n.outerHTML === next.outerHTML) ||\n              ((t === 3 || t === 8) && n.nodeValue === next.nodeValue))\n          ) {\n            this.nodes.splice(++i, 1, n); // replace the generated node with the existing one\n            break;\n          } else {\n            target.removeChild(n); // remove the non-matching existing node\n          }\n        }\n      }\n\n      if (i >= 0) {\n        // update the list of remaining nodes to attach, excluding any that were replaced by existing nodes\n        nodes = this.nodes.slice(i);\n      }\n\n      // update the anchor to be the next occupant\n      if (occupants.length) anchor = occupants[0];\n    }\n\n    // attach any remainging nodes to the parent\n    if (nodes.length) {\n      const frag = createDocumentFragment();\n      nodes.forEach(n => frag.appendChild(n));\n\n      if (anchor) {\n        target.insertBefore(frag, anchor);\n      } else {\n        target.appendChild(frag);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  toString() {\n    let value = this.model && this.model.get();\n    value = value != null ? '' + value : '';\n\n    return inAttribute() ? decodeCharacterReferences(value) : value;\n  }\n\n  unrender() {\n    if (this.nodes)\n      this.nodes.forEach(node => {\n        // defer detachment until all relevant outros are done\n        runloop.detachWhenReady({\n          node,\n          detach() {\n            detachNode(node);\n          }\n        });\n      });\n    this.rendered = false;\n    this.nodes = null;\n  }\n\n  update() {\n    if (this.rendered && this.dirty) {\n      this.dirty = false;\n\n      this.unrender();\n      this.render(this.up.findParentNode(), null, this.up.findNextNode(this));\n    } else {\n      // make sure to reset the dirty flag even if not rendered\n      this.dirty = false;\n    }\n  }\n}\n","import {\n  ALIAS,\n  ANCHOR,\n  AWAIT,\n  COMMENT,\n  COMPONENT,\n  DOCTYPE,\n  ELEMENT,\n  INTERPOLATOR,\n  PARTIAL,\n  SECTION,\n  TRIPLE,\n  YIELDER\n} from 'config/types';\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, EVENT, TRANSITION } from 'config/types';\nimport Attribute from './element/Attribute';\nimport BindingFlag from './element/BindingFlag';\nimport Comment from './Comment';\nimport Component from './Component';\nimport Decorator from './element/Decorator';\nimport Doctype from './Doctype';\nimport Form from './element/specials/Form';\nimport Element from './Element';\nimport EventDirective from './shared/EventDirective';\nimport Interpolator from './Interpolator';\nimport Input from './element/specials/Input';\nimport Mapping from './component/Mapping';\nimport Option from './element/specials/Option';\nimport Partial from './Partial';\nimport Section from './Section';\nimport Select from './element/specials/Select';\nimport Textarea from './element/specials/Textarea';\nimport Text from './Text';\nimport Transition from './element/Transition';\nimport Triple from './Triple';\nimport getComponentConstructor from './component/getComponentConstructor';\nimport findElement from './shared/findElement';\nimport { findInstance } from 'shared/registry';\nimport asyncProxy from './asyncProxy';\nimport Await from './Await';\nimport { isString, isFunction } from 'utils/is';\n\nconst constructors = {};\nconstructors[ALIAS] = Section;\nconstructors[ANCHOR] = Component;\nconstructors[AWAIT] = Await;\nconstructors[DOCTYPE] = Doctype;\nconstructors[INTERPOLATOR] = Interpolator;\nconstructors[PARTIAL] = Partial;\nconstructors[SECTION] = Section;\nconstructors[TRIPLE] = Triple;\nconstructors[YIELDER] = Partial;\n\nconstructors[ATTRIBUTE] = Attribute;\nconstructors[BINDING_FLAG] = BindingFlag;\nconstructors[DECORATOR] = Decorator;\nconstructors[EVENT] = EventDirective;\nconstructors[TRANSITION] = Transition;\nconstructors[COMMENT] = Comment;\n\nconst specialElements = {\n  doctype: Doctype,\n  form: Form,\n  input: Input,\n  option: Option,\n  select: Select,\n  textarea: Textarea\n};\n\nexport default function createItem(options) {\n  if (isString(options.template)) {\n    return new Text(options);\n  }\n\n  let ctor;\n  let name;\n  const type = options.template.t;\n\n  if (type === ELEMENT) {\n    name = options.template.e;\n\n    // could be a macro partial\n    ctor = findInstance('partials', options.up.ractive, name);\n    if (ctor) {\n      ctor = ctor.partials[name];\n      if (ctor.styleSet) {\n        options.macro = ctor;\n        return new Partial(options);\n      }\n    }\n\n    // could be component or element\n    ctor = getComponentConstructor(options.up.ractive, name);\n    if (ctor) {\n      if (isFunction(ctor.then)) {\n        return asyncProxy(ctor, options);\n      } else if (isFunction(ctor)) {\n        return new Component(options, ctor);\n      }\n    }\n\n    ctor = specialElements[name.toLowerCase()] || Element;\n    return new ctor(options);\n  }\n\n  let Item;\n\n  // component mappings are a special case of attribute\n  if (type === ATTRIBUTE) {\n    let el = options.owner;\n    if (!el || (el.type !== ANCHOR && el.type !== COMPONENT && el.type !== ELEMENT)) {\n      el = findElement(options.up);\n    }\n    options.element = el;\n\n    Item = el.type === COMPONENT || el.type === ANCHOR ? Mapping : Attribute;\n  } else {\n    Item = constructors[type];\n  }\n\n  if (!Item) throw new Error(`Unrecognised item type ${type}`);\n\n  return new Item(options);\n}\n","import { ELEMENT, YIELDER } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport { findMap } from 'utils/array';\nimport { getContext, findParentWithContext } from 'shared/getRactiveContext';\nimport { shuffled, toEscapedString, toString } from 'shared/methodCallers';\nimport createItem from './items/createItem';\nimport processItems from './helpers/processItems';\nimport parseJSON from 'utils/parseJSON';\nimport { createDocumentFragment } from 'utils/dom';\nimport KeyModel from 'src/model/specials/KeyModel';\nimport resolve from './resolvers/resolve';\n\nfunction resolveAliases(aliases, fragment, dest = {}) {\n  for (let i = 0; i < aliases.length; i++) {\n    if (!dest[aliases[i].n]) {\n      const m = resolve(fragment, aliases[i].x);\n      dest[aliases[i].n] = m;\n      m.reference();\n    }\n  }\n\n  return dest;\n}\n\nexport default class Fragment {\n  constructor(options) {\n    this.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n    this.isRoot = !options.owner.up;\n    this.parent = this.isRoot ? null : this.owner.up;\n    this.ractive = options.ractive || (this.isRoot ? options.owner : this.parent.ractive);\n\n    this.componentParent =\n      this.isRoot && this.ractive.component\n        ? this.ractive.component.up\n        : this.owner.containerFragment || null;\n    if (!this.isRoot || this.ractive.delegate) {\n      this.delegate = this.owner.containerFragment\n        ? this.owner.containerFragment && this.owner.containerFragment.delegate\n        : (this.componentParent && this.componentParent.delegate) ||\n          (this.parent && this.parent.delegate);\n    } else {\n      this.delegate = false;\n    }\n\n    this.context = null;\n    this.rendered = false;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    if ('cssIds' in options) {\n      this.cssIds = options.cssIds && options.cssIds.length && options.cssIds;\n    } else {\n      this.cssIds = this.parent ? this.parent.cssIds : null;\n    }\n\n    this.dirty = false;\n    this.dirtyValue = true; // used for attribute values\n\n    this.template = options.template || [];\n    this.createItems();\n  }\n\n  bind(context) {\n    this.context = context;\n\n    if (this.owner.template.z) {\n      this.aliases = resolveAliases(\n        this.owner.template.z,\n        this.owner.containerFragment || this.parent\n      );\n    }\n\n    const len = this.items.length;\n    for (let i = 0; i < len; i++) this.items[i].bind();\n    this.bound = true;\n\n    // in rare cases, a forced resolution (or similar) will cause the\n    // fragment to be dirty before it's even finished binding. In those\n    // cases we update immediately\n    if (this.dirty) this.update();\n\n    return this;\n  }\n\n  bubble() {\n    this.dirtyValue = true;\n\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.isRoot) {\n        // TODO encapsulate 'is component root, but not overall root' check?\n        if (this.ractive.component) {\n          this.ractive.component.bubble();\n        } else if (this.bound) {\n          runloop.addFragment(this);\n        }\n      } else {\n        this.owner.bubble(this.index);\n      }\n    }\n  }\n\n  createItems() {\n    // this is a hot code path\n    const max = this.template.length;\n    this.items = [];\n    for (let i = 0; i < max; i++) {\n      this.items[i] = createItem({\n        up: this,\n        template: this.template[i],\n        index: i\n      });\n    }\n  }\n\n  destroyed() {\n    const len = this.items.length;\n    for (let i = 0; i < len; i++) this.items[i].destroyed();\n    if (this.pathModel) this.pathModel.destroyed();\n    if (this.rootModel) this.rootModel.destroyed();\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      docFrag.appendChild(xs[i].detach());\n    }\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.items, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAll && i.findAll(selector, options));\n    }\n  }\n\n  findComponent(name, options) {\n    return findMap(this.items, i => i.findComponent(name, options));\n  }\n\n  findAllComponents(name, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAllComponents && i.findAllComponents(name, options));\n    }\n  }\n\n  findContext() {\n    const base = findParentWithContext(this);\n    if (!base || !base.context) return this.ractive.viewmodel;\n    else return base.context;\n  }\n\n  findNextNode(item) {\n    // search for the next node going forward\n    if (item) {\n      let it;\n      for (let i = item.index + 1; i < this.items.length; i++) {\n        it = this.items[i];\n        if (!it || !it.firstNode) continue;\n\n        const node = it.firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    // if this is the root fragment, and there are no more items,\n    // it means we're at the end...\n    if (this.isRoot) {\n      if (this.ractive.component) {\n        return this.ractive.component.up.findNextNode(this.ractive.component);\n      }\n\n      // TODO possible edge case with other content\n      // appended to this.ractive.el?\n      return null;\n    }\n\n    if (this.parent) return this.owner.findNextNode(this); // the argument is in case the parent is a RepeatedFragment\n  }\n\n  findParentNode() {\n    let fragment = this;\n\n    do {\n      if (fragment.owner.type === ELEMENT) {\n        return fragment.owner.node;\n      }\n\n      if (fragment.isRoot && !fragment.ractive.component) {\n        // TODO encapsulate check\n        return fragment.ractive.el;\n      }\n\n      if (fragment.owner.type === YIELDER) {\n        fragment = fragment.owner.containerFragment;\n      } else {\n        fragment = fragment.componentParent || fragment.parent; // TODO ugh\n      }\n    } while (fragment);\n\n    throw new Error('Could not find parent node'); // TODO link to issue tracker\n  }\n\n  firstNode(skipParent) {\n    const node = findMap(this.items, i => i.firstNode(true));\n    if (node) return node;\n    if (skipParent) return null;\n\n    return this.parent.findNextNode(this.owner);\n  }\n\n  getKey() {\n    return this.keyModel || (this.keyModel = new KeyModel(this.key));\n  }\n\n  getIndex() {\n    return this.idxModel || (this.idxModel = new KeyModel(this.index));\n  }\n\n  rebind(next) {\n    this.context = next;\n    if (this.rootModel) this.rootModel.context = this.context;\n    if (this.pathModel) this.pathModel.context = this.context;\n  }\n\n  rebound(update) {\n    if (this.owner.template.z) {\n      const aliases = this.aliases;\n      for (const k in aliases) {\n        if (aliases[k].rebound) aliases[k].rebound(update);\n        else {\n          aliases[k].unreference();\n          aliases[k] = 0;\n        }\n      }\n\n      resolveAliases(this.owner.template.z, this.owner.containerFragment || this.parent, aliases);\n    }\n\n    this.items.forEach(x => x.rebound(update));\n    if (update) {\n      if (this.rootModel) this.rootModel.applyValue(this.context.getKeypath(this.ractive.root));\n      if (this.pathModel) this.pathModel.applyValue(this.context.getKeypath());\n    }\n  }\n\n  render(target, occupants) {\n    if (this.rendered) throw new Error('Fragment is already rendered!');\n    this.rendered = true;\n\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      xs[i].render(target, occupants);\n    }\n  }\n\n  resetTemplate(template) {\n    const wasBound = this.bound;\n    const wasRendered = this.rendered;\n\n    // TODO ensure transitions are disabled globally during reset\n\n    if (wasBound) {\n      if (wasRendered) this.unrender(true);\n      this.unbind();\n    }\n\n    this.template = template;\n    this.createItems();\n\n    if (wasBound) {\n      this.bind(this.context);\n\n      if (wasRendered) {\n        const parentNode = this.findParentNode();\n        const anchor = this.findNextNode();\n\n        if (anchor) {\n          const docFrag = createDocumentFragment();\n          this.render(docFrag);\n          parentNode.insertBefore(docFrag, anchor);\n        } else {\n          this.render(parentNode);\n        }\n      }\n    }\n  }\n\n  shuffled() {\n    this.items.forEach(shuffled);\n    if (this.rootModel) this.rootModel.applyValue(this.context.getKeypath(this.ractive.root));\n    if (this.pathModel) this.pathModel.applyValue(this.context.getKeypath());\n  }\n\n  toString(escape) {\n    return this.items.map(escape ? toEscapedString : toString).join('');\n  }\n\n  unbind(view) {\n    if (this.owner.template.z && !this.owner.yielder) {\n      for (const k in this.aliases) {\n        this.aliases[k].unreference();\n      }\n\n      this.aliases = {};\n    }\n\n    this.context = null;\n    const len = this.items.length;\n    for (let i = 0; i < len; i++) this.items[i].unbind(view);\n    this.bound = false;\n\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    const len = this.items.length;\n    for (let i = 0; i < len; i++) this.items[i].unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      if (!this.updating) {\n        this.dirty = false;\n        this.updating = true;\n        const len = this.items.length;\n        for (let i = 0; i < len; i++) this.items[i].update();\n        this.updating = false;\n      } else if (this.isRoot) {\n        runloop.addFragmentToRoot(this);\n      }\n    }\n  }\n\n  valueOf() {\n    if (this.items.length === 1) {\n      return this.items[0].valueOf();\n    }\n\n    if (this.dirtyValue) {\n      const values = {};\n      const source = processItems(this.items, values, this.ractive._guid);\n      const parsed = parseJSON(source, values);\n\n      this.value = parsed ? parsed.value : this.toString();\n\n      this.dirtyValue = false;\n    }\n\n    return this.value;\n  }\n}\nFragment.prototype.getContext = getContext;\nFragment.prototype.getKeypath = getKeypath;\n\nexport function getKeypath(root) {\n  const base = findParentWithContext(this);\n  let model;\n  if (root) {\n    if (!this.rootModel) {\n      this.rootModel = new KeyModel(\n        this.context.getKeypath(this.ractive.root),\n        this.context,\n        this.ractive.root\n      );\n      model = this.rootModel;\n    } else return this.rootModel;\n  } else {\n    if (!this.pathModel) {\n      this.pathModel = new KeyModel(this.context.getKeypath(), this.context);\n      model = this.pathModel;\n    } else return this.pathModel;\n  }\n\n  if (base && base.context) base.getKeypath(root).registerChild(model);\n\n  return model;\n}\n","import runloop from 'src/global/runloop';\nimport config from '../config/config';\nimport hooks from '../../events/Hook';\nimport dataConfigurator from '../config/custom/data';\nimport { isObjectType } from 'utils/is';\n\nconst shouldRerender = ['template', 'partials', 'components', 'decorators', 'events'];\n\nexport default function Ractive$reset(data) {\n  data = data || {};\n\n  if (!isObjectType(data)) {\n    throw new Error('The reset method takes either no arguments, or an object containing new data');\n  }\n\n  // TEMP need to tidy this up\n  data = dataConfigurator.init(this.constructor, this, { data });\n\n  const promise = runloop.start();\n\n  // If the root object is wrapped, try and use the wrapper's reset value\n  const wrapper = this.viewmodel.wrapper;\n  if (wrapper && wrapper.reset) {\n    if (wrapper.reset(data) === false) {\n      // reset was rejected, we need to replace the object\n      this.viewmodel.set(data);\n    }\n  } else {\n    this.viewmodel.set(data);\n  }\n\n  // reset config items and track if need to rerender\n  const changes = config.reset(this);\n  let rerender;\n\n  let i = changes.length;\n  while (i--) {\n    if (shouldRerender.indexOf(changes[i]) > -1) {\n      rerender = true;\n      break;\n    }\n  }\n\n  if (rerender) {\n    hooks.unrender.fire(this);\n    this.fragment.resetTemplate(this.template);\n    hooks.render.fire(this);\n    hooks.complete.fire(this);\n  }\n\n  runloop.end();\n\n  hooks.reset.fire(this, data);\n\n  return promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('reverse').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('shift').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('sort').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('splice').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('unshift').path;\n","import add from './prototype/add';\nimport animate from './prototype/animate';\nimport attachChild from './prototype/attachChild';\nimport compute from './prototype/compute';\nimport detach from './prototype/detach';\nimport detachChild from './prototype/detachChild';\nimport find from './prototype/find';\nimport findAll from './prototype/findAll';\nimport findAllComponents from './prototype/findAllComponents';\nimport findComponent from './prototype/findComponent';\nimport findContainer from './prototype/findContainer';\nimport findParent from './prototype/findParent';\nimport fire from './prototype/fire';\nimport get from './prototype/get';\nimport getLocalContext from './prototype/getLocalContext';\nimport getContext from './prototype/getContext';\nimport insert from './prototype/insert';\nimport link from './prototype/link';\nimport observe from './prototype/observe';\nimport observeOnce from './prototype/observeOnce';\nimport off from './prototype/off';\nimport on from './prototype/on';\nimport once from './prototype/once';\nimport pop from './prototype/pop';\nimport push from './prototype/push';\nimport readLink from './prototype/readLink';\nimport render from './prototype/render';\nimport reset from './prototype/reset';\nimport resetPartial from './prototype/resetPartial';\nimport resetTemplate from './prototype/resetTemplate';\nimport reverse from './prototype/reverse';\nimport set from './prototype/set';\nimport shift from './prototype/shift';\nimport sort from './prototype/sort';\nimport splice from './prototype/splice';\nimport subtract from './prototype/subtract';\nimport teardown from './prototype/teardown';\nimport toggle from './prototype/toggle';\nimport toCSS from './prototype/toCSS';\nimport toHTML from './prototype/toHTML';\nimport toText from './prototype/toText';\nimport transition from './prototype/transition';\nimport unlink from './prototype/unlink';\nimport unrender from './prototype/unrender';\nimport unshift from './prototype/unshift';\nimport update from './prototype/update';\nimport updateModel from './prototype/updateModel';\nimport use from './prototype/use';\n\nconst proto = {\n  add,\n  animate,\n  attachChild,\n  compute,\n  detach,\n  detachChild,\n  find,\n  findAll,\n  findAllComponents,\n  findComponent,\n  findContainer,\n  findParent,\n  fire,\n  get,\n  getLocalContext,\n  getContext,\n  insert,\n  link,\n  observe,\n  observeOnce,\n  off,\n  on,\n  once,\n  pop,\n  push,\n  readLink,\n  render,\n  reset,\n  resetPartial,\n  resetTemplate,\n  reverse,\n  set,\n  shift,\n  sort,\n  splice,\n  subtract,\n  teardown,\n  toggle,\n  toCSS,\n  toCss: toCSS,\n  toHTML,\n  toHtml: toHTML,\n  toText,\n  transition,\n  unlink,\n  unrender,\n  unshift,\n  update,\n  updateModel,\n  use\n};\n\nexport default proto;\n","import { isFunction } from 'utils/is';\nimport { addCSS, applyCSS } from 'src/global/css';\nimport { recomputeCSS } from './styleSet';\n\nconst styles = [];\n\nexport function addStyle(id, css) {\n  if (styles.find(s => s.id === id))\n    throw new Error(`Extra styles with the id '${id}' have already been added.`);\n  styles.push({ id, css });\n\n  if (!this.css) {\n    Object.defineProperty(this, 'css', { configurable: false, writable: false, value: buildCSS });\n  }\n\n  if (!this._cssDef) {\n    Object.defineProperty(this, '_cssDef', {\n      configurable: true,\n      writable: false,\n      value: {\n        transform: false,\n        id: 'Ractive.addStyle'\n      }\n    });\n\n    addCSS(this._cssDef);\n  }\n\n  recomputeCSS(this);\n  applyCSS(true);\n}\n\nfunction buildCSS(data) {\n  return styles\n    .map(s => `\\n/* ---- extra style ${s.id} */\\n` + (isFunction(s.css) ? s.css(data) : s.css))\n    .join('');\n}\n\nexport function hasStyle(id) {\n  return !!styles.find(s => s.id === id);\n}\n","import config from '../Ractive/config/config';\nimport dataConfigurator from '../Ractive/config/custom/data';\nimport construct from '../Ractive/construct';\nimport initialise from '../Ractive/initialise';\nimport Ractive from '../Ractive';\nimport isInstance from '../Ractive/static/isInstance';\nimport styleSet from '../Ractive/static/styleSet';\nimport styleGet from '../Ractive/static/styleGet';\nimport { addStyle, hasStyle } from '../Ractive/static/styles';\nimport sharedSet from '../Ractive/static/sharedSet';\nimport sharedGet from '../Ractive/static/sharedGet';\nimport use from '../Ractive/static/use';\nimport { create, defineProperties, toPairs, defineProperty } from 'utils/object';\nimport { isArray, isFunction } from 'utils/is';\n\nconst callsSuper = /super\\s*\\(|\\.call\\s*\\(\\s*this/;\n\nexport function extend(...options) {\n  if (!options.length) {\n    return extendOne(this);\n  } else {\n    return options.reduce(extendOne, this);\n  }\n}\n\nexport function extendWith(Class, options = {}) {\n  return extendOne(this, options, Class);\n}\n\nfunction extendOne(Parent, options = {}, Target) {\n  let proto;\n  let Child = isFunction(Target) && Target;\n\n  if (options.prototype instanceof Ractive) {\n    throw new Error(`Ractive no longer supports multiple inheritance.`);\n  }\n\n  if (Child) {\n    if (!(Child.prototype instanceof Parent)) {\n      throw new Error(\n        `Only classes that inherit the appropriate prototype may be used with extend`\n      );\n    }\n    if (!callsSuper.test(Child.toString())) {\n      throw new Error(`Only classes that call super in their constructor may be used with extend`);\n    }\n\n    proto = Child.prototype;\n  } else {\n    Child = function(options) {\n      if (!(this instanceof Child)) return new Child(options);\n      if (options && options.component === true) return;\n\n      construct(this, options || {});\n      initialise(this, options || {}, {});\n    };\n\n    proto = create(Parent.prototype);\n    proto.constructor = Child;\n\n    Child.prototype = proto;\n  }\n\n  // Static properties\n  defineProperties(Child, {\n    // alias prototype as defaults\n    defaults: { value: proto },\n\n    extend: { value: extend, writable: true, configurable: true },\n    extendWith: { value: extendWith, writable: true, configurable: true },\n    extensions: { value: [] },\n    use: { value: use },\n\n    isInstance: { value: isInstance },\n\n    Parent: { value: Parent },\n    Ractive: { value: Ractive },\n\n    styleGet: { value: styleGet.bind(Child), configurable: true },\n    styleSet: { value: styleSet.bind(Child), configurable: true }\n  });\n\n  // extend configuration\n  config.extend(Parent, proto, options, Child);\n\n  // store event and observer registries on the constructor when extending\n  Child._on = (Parent._on || []).concat(toPairs(options.on));\n  Child._observe = (Parent._observe || []).concat(toPairs(options.observe));\n\n  Parent.extensions.push(Child);\n\n  // attribute defs are not inherited, but they need to be stored\n  if (options.attributes) {\n    let attrs;\n\n    // allow an array of optional props or an object with arrays for optional and required props\n    if (isArray(options.attributes)) {\n      attrs = { optional: options.attributes, required: [] };\n    } else {\n      attrs = options.attributes;\n    }\n\n    // make sure the requisite keys actually store arrays\n    if (!isArray(attrs.required)) attrs.required = [];\n    if (!isArray(attrs.optional)) attrs.optional = [];\n\n    Child.attributes = attrs;\n  }\n\n  dataConfigurator.extend(Parent, proto, options, Child);\n\n  defineProperty(Child, 'helpers', { writable: true, value: proto.helpers });\n\n  if (isArray(options.use)) Child.use.apply(Child, options.use);\n\n  return Child;\n}\n\ndefineProperties(Ractive, {\n  sharedGet: { value: sharedGet },\n  sharedSet: { value: sharedSet },\n  styleGet: { configurable: true, value: styleGet.bind(Ractive) },\n  styleSet: { configurable: true, value: styleSet.bind(Ractive) },\n  addCSS: { configurable: false, value: addStyle.bind(Ractive) },\n  hasCSS: { configurable: false, value: hasStyle.bind(Ractive) }\n});\n","import './polyfills/Object.assign';\nimport './polyfills/array.find';\nimport './polyfills/node.contains';\nimport './polyfills/performance.now';\nimport './polyfills/Promise';\nimport './polyfills/requestAnimationFrame';\n\nimport defaults from './Ractive/config/defaults';\nimport easing from './Ractive/static/easing';\nimport interpolators from './Ractive/static/interpolators';\nimport { svg, win } from './config/environment';\nimport proto from './Ractive/prototype';\nimport { extend, extendWith } from './extend/_extend';\nimport macro from './extend/_macro';\nimport parse from './parse/_parse';\nimport getContext from './Ractive/static/getContext';\nimport isInstance from './Ractive/static/isInstance';\nimport use from './Ractive/static/use';\nimport construct from './Ractive/construct';\nimport initialise from './Ractive/initialise';\nimport { getCSS, splitTag } from './global/css';\nimport { escapeKey, unescapeKey, normalise } from './shared/keypaths';\nimport { joinKeys, splitKeypath } from './Ractive/static/keypaths';\nimport shared from './Ractive/shared';\nimport { findPlugin } from './Ractive/static/findPlugin';\nimport parseJSON from './utils/parseJSON';\nimport CSSModel from './model/specials/CSSModel';\nimport { data as sharedData } from './model/specials/SharedModel';\nimport { extern } from './shared/getRactiveContext';\nimport { warn } from 'utils/log';\n\nimport { batch } from './global/runloop';\n\nimport { assign, defineProperty, defineProperties } from 'utils/object';\n\nexport default function Ractive(options) {\n  if (!(this instanceof Ractive)) return new Ractive(options);\n  if (options && options.component) return;\n\n  construct(this, options || {});\n  initialise(this, options || {}, {});\n}\n\n// check to see if we're being asked to force Ractive as a global for some weird environments\nif (win && !win.Ractive) {\n  let opts = '';\n  const script =\n    document.currentScript ||\n    /* istanbul ignore next */ document.querySelector('script[data-ractive-options]');\n\n  if (script) opts = script.getAttribute('data-ractive-options') || '';\n\n  /* istanbul ignore next */\n  if (~opts.indexOf('ForceGlobal')) win.Ractive = Ractive;\n} else if (win) {\n  warn(`Ractive already appears to be loaded while loading BUILD_PLACEHOLDER_VERSION.`);\n}\n\nassign(Ractive.prototype, proto, defaults);\nRactive.prototype.constructor = Ractive;\n\n// alias prototype as `defaults`\nRactive.defaults = Ractive.prototype;\n\n// share defaults with the parser\nshared.defaults = Ractive.defaults;\nshared.Ractive = Ractive;\n\n// static properties\ndefineProperties(Ractive, {\n  // debug flag\n  DEBUG: { writable: true, value: true },\n  DEBUG_PROMISES: { writable: true, value: true },\n\n  // static methods:\n  extend: { value: extend },\n  extendWith: { value: extendWith },\n  escapeKey: { value: escapeKey },\n  evalObjectString: { value: parseJSON },\n  findPlugin: { value: findPlugin },\n  getContext: { value: getContext },\n  getCSS: { value: getCSS },\n  isInstance: { value: isInstance },\n  joinKeys: { value: joinKeys },\n  macro: { value: macro },\n  normaliseKeypath: { value: normalise },\n  parse: { value: parse },\n  splitKeypath: { value: splitKeypath },\n  // sharedSet and styleSet are in _extend because circular refs\n  unescapeKey: { value: unescapeKey },\n  use: { value: use },\n\n  // support\n  enhance: { writable: true, value: false },\n  svg: { value: svg },\n  tick: {\n    get() {\n      return batch && batch.promise;\n    }\n  },\n\n  // version\n  VERSION: { value: 'BUILD_PLACEHOLDER_VERSION' },\n\n  // plugins\n  adaptors: { writable: true, value: {} },\n  components: { writable: true, value: {} },\n  decorators: { writable: true, value: {} },\n  easing: { writable: true, value: easing },\n  events: { writable: true, value: {} },\n  extensions: { value: [] },\n  helpers: { writable: true, value: defaults.helpers },\n  interpolators: { writable: true, value: interpolators },\n  partials: { writable: true, value: {} },\n  transitions: { writable: true, value: {} },\n\n  // CSS variables\n  cssData: { configurable: true, value: {} },\n  perComponentStyleElements: { get: splitTag, set: splitTag },\n\n  // access to @shared without an instance\n  sharedData: { value: sharedData },\n\n  // for getting the source Ractive lib from a constructor\n  Ractive: { value: Ractive },\n\n  // to allow extending contexts\n  Context: { value: extern.Context.prototype }\n});\n\n// cssData must already be in place\ndefineProperty(Ractive, '_cssModel', {\n  configurable: true,\n  value: new CSSModel(Ractive)\n});\n\ndefineProperty(Ractive.prototype, 'rendered', {\n  get() {\n    return this.fragment && this.fragment.rendered;\n  }\n});\n","import Element from '../../Element';\nimport { isFunction } from 'utils/is';\n\nexport default class Input extends Element {\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.node.defaultValue = this.node.value;\n  }\n  compare(value, attrValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(value, attrValue);\n      }\n      if (value && attrValue) {\n        return value[comparator] == attrValue[comparator];\n      }\n    }\n    return value == attrValue;\n  }\n}\n","import { warnIfDebug } from 'utils/log';\nimport { create, hasOwn } from 'utils/object';\n\nconst leadingWhitespace = /^\\s+/;\n\nconst ParseError = function(message) {\n  this.name = 'ParseError';\n  this.message = message;\n  try {\n    throw new Error(message);\n  } catch (e) {\n    this.stack = e.stack;\n  }\n};\n\nParseError.prototype = Error.prototype;\n\nconst Parser = function(str, options) {\n  let item;\n  let lineStart = 0;\n\n  this.str = str;\n  this.options = options || {};\n  this.pos = 0;\n\n  this.lines = this.str.split('\\n');\n  this.lineEnds = this.lines.map(line => {\n    const lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n    lineStart = lineEnd;\n    return lineEnd;\n  }, 0);\n\n  // Custom init logic\n  if (this.init) this.init(str, options);\n\n  const items = [];\n\n  while (this.pos < this.str.length && (item = this.read())) {\n    items.push(item);\n  }\n\n  this.leftover = this.remaining();\n  this.result = this.postProcess ? this.postProcess(items, options) : items;\n};\n\nParser.prototype = {\n  read(converters) {\n    let i, item;\n\n    if (!converters) converters = this.converters;\n\n    const pos = this.pos;\n\n    const len = converters.length;\n    for (i = 0; i < len; i += 1) {\n      this.pos = pos; // reset for each attempt\n\n      if ((item = converters[i](this))) {\n        return item;\n      }\n    }\n\n    return null;\n  },\n\n  getContextMessage(pos, message) {\n    const [lineNum, columnNum] = this.getLinePos(pos);\n    if (this.options.contextLines === -1) {\n      return [lineNum, columnNum, `${message} at line ${lineNum} character ${columnNum}`];\n    }\n\n    const line = this.lines[lineNum - 1];\n\n    let contextUp = '';\n    let contextDown = '';\n    if (this.options.contextLines) {\n      const start =\n        lineNum - 1 - this.options.contextLines < 0 ? 0 : lineNum - 1 - this.options.contextLines;\n      contextUp = this.lines\n        .slice(start, lineNum - 1 - start)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      contextDown = this.lines\n        .slice(lineNum, lineNum + this.options.contextLines)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      if (contextUp) {\n        contextUp += '\\n';\n      }\n      if (contextDown) {\n        contextDown = '\\n' + contextDown;\n      }\n    }\n\n    let numTabs = 0;\n    const annotation =\n      contextUp +\n      line.replace(/\\t/g, (match, char) => {\n        if (char < columnNum) {\n          numTabs += 1;\n        }\n\n        return '  ';\n      }) +\n      '\\n' +\n      new Array(columnNum + numTabs).join(' ') +\n      '^----' +\n      contextDown;\n\n    return [\n      lineNum,\n      columnNum,\n      `${message} at line ${lineNum} character ${columnNum}:\\n${annotation}`\n    ];\n  },\n\n  getLinePos(char) {\n    let lineNum = 0;\n    let lineStart = 0;\n\n    while (char >= this.lineEnds[lineNum]) {\n      lineStart = this.lineEnds[lineNum];\n      lineNum += 1;\n    }\n\n    const columnNum = char - lineStart;\n    return [lineNum + 1, columnNum + 1, char]; // line/col should be one-based, not zero-based!\n  },\n\n  error(message) {\n    const [lineNum, columnNum, msg] = this.getContextMessage(this.pos, message);\n\n    const error = new ParseError(msg);\n\n    error.line = lineNum;\n    error.character = columnNum;\n    error.shortMessage = message;\n\n    throw error;\n  },\n\n  matchString(string) {\n    if (this.str.substr(this.pos, string.length) === string) {\n      this.pos += string.length;\n      return string;\n    }\n  },\n\n  matchPattern(pattern) {\n    let match;\n\n    if ((match = pattern.exec(this.remaining()))) {\n      this.pos += match[0].length;\n      return match[1] || match[0];\n    }\n  },\n\n  sp() {\n    this.matchPattern(leadingWhitespace);\n  },\n\n  remaining() {\n    return this.str.substring(this.pos);\n  },\n\n  nextChar() {\n    return this.str.charAt(this.pos);\n  },\n\n  warn(message) {\n    const msg = this.getContextMessage(this.pos, message)[2];\n\n    warnIfDebug(msg);\n  }\n};\n\nParser.extend = function(proto) {\n  const Parent = this;\n  const Child = function(str, options) {\n    Parser.call(this, str, options);\n  };\n\n  Child.prototype = create(Parent.prototype);\n\n  for (const key in proto) {\n    if (hasOwn(proto, key)) {\n      Child.prototype[key] = proto[key];\n    }\n  }\n\n  Child.extend = Parser.extend;\n  return Child;\n};\n\nexport default Parser;\n","// Match one or more characters until: \", ', \\, or EOL/EOF.\n// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\nconst stringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n// Match one escape sequence, including the backslash.\nexport const escapeSequencePattern = /^\\\\(?:[`'\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n// Match one ES5 line continuation (backslash + line terminator).\nexport const lineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n// Helper for defining getDoubleQuotedString and getSingleQuotedString.\nexport default function(okQuote) {\n  return function(parser) {\n    let literal = '\"';\n    let done = false;\n    let next;\n\n    while (!done) {\n      next =\n        parser.matchPattern(stringMiddlePattern) ||\n        parser.matchPattern(escapeSequencePattern) ||\n        parser.matchString(okQuote);\n      if (next) {\n        if (next === `\"`) {\n          literal += `\\\\\"`;\n        } else if (next === `\\\\'`) {\n          literal += `'`;\n        } else {\n          literal += next;\n        }\n      } else {\n        next = parser.matchPattern(lineContinuationPattern);\n        if (next) {\n          // convert \\(newline-like) into a \\u escape, which is allowed in JSON\n          literal += '\\\\u' + ('000' + next.charCodeAt(1).toString(16)).slice(-4);\n        } else {\n          done = true;\n        }\n      }\n    }\n\n    literal += '\"';\n\n    // use JSON.parse to interpret escapes\n    return JSON.parse(literal);\n  };\n}\n","import { STRING_LITERAL } from '../../../../../config/types';\nimport makeQuotedStringMatcher from './stringLiteral/makeQuotedStringMatcher';\n\nconst singleMatcher = makeQuotedStringMatcher(`\"`);\nconst doubleMatcher = makeQuotedStringMatcher(`'`);\n\nexport default function(parser) {\n  const start = parser.pos;\n  const quote = parser.matchString(`'`) || parser.matchString(`\"`);\n\n  if (quote) {\n    const string = (quote === `'` ? singleMatcher : doubleMatcher)(parser);\n\n    if (!parser.matchString(quote)) {\n      parser.pos = start;\n      return null;\n    }\n\n    return {\n      t: STRING_LITERAL,\n      v: string\n    };\n  }\n\n  return null;\n}\n","import { NUMBER_LITERAL } from '../../../../../config/types';\n\n// bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\nconst numberPattern = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\nexport default function readNumberLiteral(parser) {\n  let result;\n\n  if ((result = parser.matchPattern(numberPattern))) {\n    return {\n      t: NUMBER_LITERAL,\n      v: result\n    };\n  }\n\n  return null;\n}\n","export const name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\nexport const spreadPattern = /^\\s*\\.{3}/;\nexport const legalReference = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:\\.(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nexport const relaxedName = /^[a-zA-Z_$][-\\/a-zA-Z_$0-9]*(?:\\.(?:[a-zA-Z_$][-\\/a-zA-Z_$0-9]*))*/;\n","import readStringLiteral from '../primary/literal/readStringLiteral';\nimport readNumberLiteral from '../primary/literal/readNumberLiteral';\nimport { name as namePattern } from './patterns';\n\nconst identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n// http://mathiasbynens.be/notes/javascript-properties\n// can be any name, string literal, or number literal\nexport default function readKey(parser) {\n  let token;\n\n  if ((token = readStringLiteral(parser))) {\n    return identifier.test(token.v) ? token.v : '\"' + token.v.replace(/\"/g, '\\\\\"') + '\"';\n  }\n\n  if ((token = readNumberLiteral(parser))) {\n    return token.v;\n  }\n\n  if ((token = parser.matchPattern(namePattern))) {\n    return token;\n  }\n\n  return null;\n}\n","import Parser from 'parse/Parser';\nimport readStringLiteral from 'parse/converters/expressions/primary/literal/readStringLiteral';\nimport readKey from 'parse/converters/expressions/shared/readKey';\nimport { hasOwn, keys } from 'utils/object';\n\n// simple JSON parser, without the restrictions of JSON parse\n// (i.e. having to double-quote keys).\n//\n// If passed a hash of values as the second argument, ${placeholders}\n// will be replaced with those values\n\nconst specials = {\n  true: true,\n  false: false,\n  null: null,\n  undefined\n};\n\nconst specialsPattern = new RegExp('^(?:' + keys(specials).join('|') + ')');\nconst numberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\nconst placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\nconst placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\nconst onlyWhitespace = /^\\s*$/;\n\nconst JsonParser = Parser.extend({\n  init(str, options) {\n    this.values = options.values;\n    this.sp();\n  },\n\n  postProcess(result) {\n    if (result.length !== 1 || !onlyWhitespace.test(this.leftover)) {\n      return null;\n    }\n\n    return { value: result[0].v };\n  },\n\n  converters: [\n    function getPlaceholder(parser) {\n      if (!parser.values) return null;\n\n      const placeholder = parser.matchPattern(placeholderAtStartPattern);\n\n      if (placeholder && hasOwn(parser.values, placeholder)) {\n        return { v: parser.values[placeholder] };\n      }\n    },\n\n    function getSpecial(parser) {\n      const special = parser.matchPattern(specialsPattern);\n      if (special) return { v: specials[special] };\n    },\n\n    function getNumber(parser) {\n      const number = parser.matchPattern(numberPattern);\n      if (number) return { v: +number };\n    },\n\n    function getString(parser) {\n      const stringLiteral = readStringLiteral(parser);\n      const values = parser.values;\n\n      if (stringLiteral && values) {\n        return {\n          v: stringLiteral.v.replace(placeholderPattern, (match, $1) =>\n            $1 in values ? values[$1] : $1\n          )\n        };\n      }\n\n      return stringLiteral;\n    },\n\n    function getObject(parser) {\n      if (!parser.matchString('{')) return null;\n\n      const result = {};\n\n      parser.sp();\n\n      if (parser.matchString('}')) {\n        return { v: result };\n      }\n\n      let pair;\n      while ((pair = getKeyValuePair(parser))) {\n        result[pair.key] = pair.value;\n\n        parser.sp();\n\n        if (parser.matchString('}')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n      }\n\n      return null;\n    },\n\n    function getArray(parser) {\n      if (!parser.matchString('[')) return null;\n\n      const result = [];\n\n      parser.sp();\n\n      if (parser.matchString(']')) {\n        return { v: result };\n      }\n\n      let valueToken;\n      while ((valueToken = parser.read())) {\n        result.push(valueToken.v);\n\n        parser.sp();\n\n        if (parser.matchString(']')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n\n        parser.sp();\n      }\n\n      return null;\n    }\n  ]\n});\n\nfunction getKeyValuePair(parser) {\n  parser.sp();\n\n  const key = readKey(parser);\n\n  if (!key) return null;\n\n  const pair = { key };\n\n  parser.sp();\n  if (!parser.matchString(':')) {\n    return null;\n  }\n  parser.sp();\n\n  const valueToken = parser.read();\n\n  if (!valueToken) return null;\n\n  pair.value = valueToken.v;\n  return pair;\n}\n\nexport default function(str, values) {\n  const parser = new JsonParser(str, { values });\n  return parser.result;\n}\n","import { INTERPOLATOR } from '../../../config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport parseJSON from '../../../utils/parseJSON';\nimport resolve from '../../resolvers/resolve';\nimport runloop from '../../../global/runloop';\nimport { warnIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isArray, isObjectType, isString, isUndefined } from 'utils/is';\n\nexport default class Mapping extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = this.element.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.element.attributeByName[this.name] = this;\n\n    this.value = options.template.f;\n  }\n\n  bind() {\n    const template = this.template.f;\n    const viewmodel = this.element.instance.viewmodel;\n\n    if (template === 0) {\n      // empty attributes are `true`\n      viewmodel.joinKey(this.name).set(true);\n    } else if (isString(template)) {\n      const parsed = parseJSON(template);\n      viewmodel.joinKey(this.name).set(parsed ? parsed.value : template);\n    } else if (isArray(template)) {\n      createMapping(this, true);\n    }\n  }\n\n  rebound(update) {\n    if (this.boundFragment) this.boundFragment.rebound(update);\n    if (this.link) {\n      this.model = resolve(this.up, this.template.f[0]);\n      const model = this.element.instance.viewmodel.joinAll(splitKeypath(this.name));\n      model.link(this.model, this.name, { mapping: true });\n    }\n  }\n\n  render() {}\n\n  unbind(view) {\n    if (this.model) this.model.unregister(this);\n    if (this.boundFragment) this.boundFragment.unbind(view);\n\n    if (this.element.bound) {\n      if (this.link.target === this.model) this.link.owner.unlink();\n    }\n  }\n\n  unrender() {}\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.boundFragment) this.boundFragment.update();\n    }\n  }\n}\n\nfunction createMapping(item) {\n  const template = item.template.f;\n  const viewmodel = item.element.instance.viewmodel;\n  const childData = viewmodel.value;\n\n  if (template.length === 1 && template[0].t === INTERPOLATOR) {\n    const model = resolve(item.up, template[0]);\n    const val = model.get(false);\n\n    // if the interpolator is not static\n    if (!template[0].s) {\n      item.model = model;\n      item.link = viewmodel.createLink(item.name, model, template[0].r, {\n        mapping: true\n      });\n\n      // initialize parent side of the mapping from child data\n      if (isUndefined(val) && !model.isReadonly && item.name in childData) {\n        model.set(childData[item.name]);\n      }\n    } else if (!isObjectType(val) || template[0].x) {\n      // copy non-object, non-computed vals through\n      viewmodel.joinKey(splitKeypath(item.name)).set(val);\n    } else {\n      // warn about trying to copy an object\n      warnIfDebug(`Cannot copy non-computed object value from static mapping '${item.name}'`);\n    }\n\n    // if the item isn't going to manage the model, give it a change to tear down if it's computed\n    if (model !== item.model) model.unregister();\n  } else {\n    item.boundFragment = new Fragment({\n      owner: item,\n      template\n    }).bind();\n\n    item.model = viewmodel.joinKey(splitKeypath(item.name));\n    item.model.set(item.boundFragment.valueOf());\n\n    // item is a *bit* of a hack\n    item.boundFragment.bubble = () => {\n      Fragment.prototype.bubble.call(item.boundFragment);\n      // defer this to avoid mucking around model deps if there happens to be an expression involved\n      runloop.scheduleTask(() => {\n        item.boundFragment.update();\n        item.model.set(item.boundFragment.valueOf());\n      });\n    };\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport Element from '../../Element';\nimport findElement from '../../shared/findElement';\nimport { isArray, isUndefined } from 'utils/is';\n\nexport default class Option extends Element {\n  constructor(options) {\n    const template = options.template;\n    if (!template.a) template.a = {};\n\n    // If the value attribute is missing, use the element's content,\n    // as long as it isn't disabled\n    if (isUndefined(template.a.value) && !('disabled' in template.a)) {\n      template.a.value = template.f || '';\n    }\n\n    super(options);\n\n    this.select = findElement(this.parent || this.up, false, 'select');\n  }\n\n  bind() {\n    if (!this.select) {\n      super.bind();\n      return;\n    }\n\n    // If the select has a value, it overrides the `selected` attribute on\n    // this option - so we delete the attribute\n    const selectedAttribute = this.attributeByName.selected;\n    if (selectedAttribute && this.select.getAttribute('value') !== undefined) {\n      const index = this.attributes.indexOf(selectedAttribute);\n      this.attributes.splice(index, 1);\n      delete this.attributeByName.selected;\n    }\n\n    super.bind();\n    this.select.options.push(this);\n  }\n\n  bubble() {\n    // if we're using content as value, may need to update here\n    const value = this.getAttribute('value');\n    if (this.node && this.node.value !== value) {\n      this.node._ractive.value = value;\n    }\n    super.bubble();\n  }\n\n  getAttribute(name) {\n    const attribute = this.attributeByName[name];\n    return attribute\n      ? attribute.getValue()\n      : name === 'value' && this.fragment\n      ? this.fragment.valueOf()\n      : undefined;\n  }\n\n  isSelected() {\n    const optionValue = this.getAttribute('value');\n\n    if (isUndefined(optionValue) || !this.select) {\n      return false;\n    }\n\n    const selectValue = this.select.getAttribute('value');\n\n    if (this.select.compare(selectValue, optionValue)) {\n      return true;\n    }\n\n    if (this.select.getAttribute('multiple') && isArray(selectValue)) {\n      let i = selectValue.length;\n      while (i--) {\n        if (this.select.compare(selectValue[i], optionValue)) {\n          return true;\n        }\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n\n    if (!this.attributeByName.value) {\n      this.node._ractive.value = this.getAttribute('value');\n    }\n  }\n\n  unbind(view) {\n    super.unbind(view);\n\n    if (this.select) {\n      removeFromArray(this.select.options, this);\n    }\n  }\n}\n","import { ELEMENT, PARTIAL, SECTION, SECTION_WITH, YIELDER } from 'config/types';\nimport { assign, create, hasOwn, keys } from 'utils/object';\nimport { isArray, isFunction, isObjectType, isString } from 'utils/is';\nimport noop from 'utils/noop';\nimport { MustacheContainer } from './shared/Mustache';\nimport Fragment from '../Fragment';\nimport getPartialTemplate from './partial/getPartialTemplate';\nimport { warnOnceIfDebug, warnIfDebug } from 'utils/log';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport runloop from 'src/global/runloop';\nimport { applyCSS } from 'src/global/css';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function Partial(options) {\n  MustacheContainer.call(this, options);\n\n  const tpl = options.template;\n\n  // yielder is a special form of partial that will later require special handling\n  if (tpl.t === YIELDER) {\n    this.yielder = 1;\n  } else if (tpl.t === ELEMENT) {\n    // this is a macro partial, complete with macro constructor\n    // leaving this as an element will confuse up-template searches\n    this.type = PARTIAL;\n    this.macro = options.macro;\n  }\n}\n\nconst proto = (Partial.prototype = create(MustacheContainer.prototype));\n\nassign(proto, {\n  constructor: Partial,\n\n  bind() {\n    const template = this.template;\n\n    if (this.yielder) {\n      // the container is the instance that owns this node\n      this.container = this.up.ractive;\n      this.component = this.container.component;\n      this.containerFragment = this.up;\n\n      // normal component\n      if (this.component) {\n        // yields skip the owning instance and go straight to the surrounding context\n        this.up = this.component.up;\n\n        // {{yield}} is equivalent to {{yield content}}\n        if (!template.r && !template.x && !template.rx) this.refName = 'content';\n      } else {\n        // plain-ish instance that may be attached to a parent later\n        this.fragment = new Fragment({\n          owner: this,\n          template: []\n        });\n        this.fragment.bind();\n        return;\n      }\n    }\n\n    // this is a macro/super partial\n    if (this.macro) {\n      this.fn = this.macro;\n    } else {\n      // this is a plain partial or yielder\n      if (!this.refName) this.refName = template.r;\n\n      // if the refName exists as a partial, this is a plain old partial reference where no model binding will happen\n      if (this.refName) {\n        partialFromValue(this, this.refName);\n      }\n\n      // this is a dynamic/inline partial\n      if (!this.partial && !this.fn) {\n        MustacheContainer.prototype.bind.call(this);\n        if (this.model) partialFromValue(this, this.model.get());\n      }\n    }\n\n    if (!this.partial && !this.fn) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    createFragment(this, this.partial || []);\n\n    // macro/super partial\n    if (this.fn) initMacro(this);\n\n    this.fragment.bind();\n  },\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.yielder) {\n        this.containerFragment.bubble();\n      } else {\n        this.up.bubble();\n      }\n    }\n  },\n\n  findNextNode() {\n    return (this.containerFragment || this.up).findNextNode(this);\n  },\n\n  handleChange() {\n    this.dirtyTemplate = true;\n    this.externalChange = true;\n    this.bubble();\n  },\n\n  rebound(update) {\n    if (this._attrs) {\n      keys(this._attrs).forEach(k => this._attrs[k].rebound(update));\n    }\n    MustacheContainer.prototype.rebound.call(this, update);\n  },\n\n  refreshAttrs() {\n    keys(this._attrs).forEach(k => {\n      this.handle.attributes[k] = !this._attrs[k].items.length || this._attrs[k].valueOf();\n    });\n  },\n\n  resetTemplate() {\n    if (this.fn && this.proxy) {\n      this.last = 0;\n      if (this.externalChange) {\n        if (isFunction(this.proxy.teardown)) this.proxy.teardown();\n        this.fn = this.proxy = null;\n      } else {\n        this.partial = this.fnTemplate;\n        return true;\n      }\n    }\n\n    this.partial = null;\n\n    if (this.refName) {\n      this.partial = getPartialTemplate(this.ractive, this.refName, this.up);\n    }\n\n    if (!this.partial && this.model) {\n      partialFromValue(this, this.model.get());\n    }\n\n    if (!this.fn) {\n      if (this.last && this.partial === this.last) return false;\n      else if (this.partial) {\n        this.last = this.partial;\n        contextifyTemplate(this);\n      }\n    }\n\n    this.unbindAttrs();\n\n    if (this.fn) {\n      initMacro(this);\n      if (isFunction(this.proxy.render)) runloop.scheduleTask(() => this.proxy.render());\n    } else if (!this.partial) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    return true;\n  },\n\n  render(target, occupants) {\n    if (this.fn && this.fn._cssDef && !this.fn._cssDef.applied) applyCSS();\n\n    this.fragment.render(target, occupants);\n\n    if (this.proxy && isFunction(this.proxy.render)) this.proxy.render();\n  },\n\n  unbind(view) {\n    this.fragment.unbind(view);\n\n    this.unbindAttrs(view);\n\n    MustacheContainer.prototype.unbind.call(this, view);\n  },\n\n  unbindAttrs(view) {\n    if (this._attrs) {\n      keys(this._attrs).forEach(k => {\n        this._attrs[k].unbind(view);\n      });\n    }\n  },\n\n  unrender(shouldDestroy) {\n    if (this.proxy && isFunction(this.proxy.teardown)) this.proxy.teardown();\n\n    this.fragment.unrender(shouldDestroy);\n  },\n\n  update() {\n    const proxy = this.proxy;\n    this.updating = 1;\n\n    if (this.dirtyAttrs) {\n      this.dirtyAttrs = false;\n      keys(this._attrs).forEach(k => this._attrs[k].update());\n      this.refreshAttrs();\n      if (isFunction(proxy.update)) proxy.update(this.handle.attributes);\n    }\n\n    if (this.dirtyTemplate) {\n      this.dirtyTemplate = false;\n      this.resetTemplate() && this.fragment.resetTemplate(this.partial || []);\n    }\n\n    if (this.dirty) {\n      this.dirty = false;\n      if (proxy && isFunction(proxy.invalidate)) proxy.invalidate();\n      this.fragment.update();\n    }\n\n    this.externalChange = false;\n    this.updating = 0;\n  }\n});\n\nfunction createFragment(self, partial) {\n  self.partial = self.last = partial;\n  contextifyTemplate(self);\n\n  const options = {\n    owner: self,\n    template: self.partial\n  };\n\n  if (self.yielder) options.ractive = self.container.parent;\n\n  if (self.fn) options.cssIds = self.fn._cssIds;\n\n  self.fragment = new Fragment(options);\n}\n\nfunction contextifyTemplate(self) {\n  if (self.template.c) {\n    self.partial = [{ t: SECTION, n: SECTION_WITH, f: self.partial }];\n    assign(self.partial[0], self.template.c);\n    if (self.yielder) self.partial[0].y = self;\n    else self.partial[0].z = self.template.z;\n  }\n}\n\nfunction partialFromValue(self, value, okToParse) {\n  let tpl = value;\n\n  if (isArray(tpl)) {\n    self.partial = tpl;\n  } else if (tpl && isObjectType(tpl)) {\n    if (isArray(tpl.t)) self.partial = tpl.t;\n    else if (isString(tpl.template))\n      self.partial = parsePartial(tpl.template, tpl.template, self.ractive).t;\n  } else if (isFunction(tpl) && tpl.styleSet) {\n    self.fn = tpl;\n    if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n  } else if (tpl != null) {\n    tpl = getPartialTemplate(self.ractive, '' + tpl, self.containerFragment || self.up);\n    if (tpl) {\n      self.name = value;\n      if (tpl.styleSet) {\n        self.fn = tpl;\n        if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n      } else self.partial = tpl;\n    } else if (okToParse) {\n      self.partial = parsePartial('' + value, '' + value, self.ractive).t;\n    } else {\n      self.name = value;\n    }\n  }\n\n  return self.partial;\n}\n\nfunction setTemplate(template) {\n  partialFromValue(this, template, true);\n\n  if (!this.initing) {\n    this.dirtyTemplate = true;\n    this.fnTemplate = this.partial;\n\n    if (this.updating) {\n      this.bubble();\n      runloop.promise();\n    } else {\n      const promise = runloop.start();\n\n      this.bubble();\n      runloop.end();\n\n      return promise;\n    }\n  }\n}\n\nfunction aliasLocal(ref, name) {\n  const aliases = this.fragment.aliases || (this.fragment.aliases = {});\n  if (!name) {\n    aliases[ref] = this._data;\n  } else {\n    aliases[name] = this._data.joinAll(splitKeypath(ref));\n  }\n}\n\nconst extras = 'extra-attributes';\n\nfunction initMacro(self) {\n  const fn = self.fn;\n  const fragment = self.fragment;\n\n  // defensively copy the template in case it changes\n  const template = (self.template = assign({}, self.template));\n  const handle = (self.handle = fragment.getContext({\n    proxy: self,\n    aliasLocal,\n    name: self.template.e || self.name,\n    attributes: {},\n    setTemplate: setTemplate.bind(self),\n    template,\n    macro: fn\n  }));\n\n  if (!template.p) template.p = {};\n  template.p = handle.partials = assign({}, template.p);\n  if (!hasOwn(template.p, 'content')) template.p.content = template.f || [];\n\n  if (isArray(fn.attributes)) {\n    self._attrs = {};\n\n    const invalidate = function() {\n      this.dirty = true;\n      self.dirtyAttrs = true;\n      self.bubble();\n    };\n\n    if (isArray(template.m)) {\n      const attrs = template.m;\n      template.p[extras] = template.m = attrs.filter(a => !~fn.attributes.indexOf(a.n));\n      attrs\n        .filter(a => ~fn.attributes.indexOf(a.n))\n        .forEach(a => {\n          const fragment = new Fragment({\n            template: a.f,\n            owner: self\n          });\n          fragment.bubble = invalidate;\n          fragment.findFirstNode = noop;\n          self._attrs[a.n] = fragment;\n        });\n    } else {\n      template.p[extras] = [];\n    }\n  } else {\n    template.p[extras] = template.m;\n  }\n\n  if (self._attrs) {\n    keys(self._attrs).forEach(k => {\n      self._attrs[k].bind();\n    });\n    self.refreshAttrs();\n  }\n\n  self.initing = 1;\n  self.proxy = fn.call(self.ractive, handle, handle.attributes) || {};\n  if (!self.partial) self.partial = [];\n  self.fnTemplate = self.partial;\n  self.initing = 0;\n\n  contextifyTemplate(self);\n  fragment.resetTemplate(self.partial);\n}\n\nfunction parsePartial(name, partial, ractive) {\n  let parsed;\n\n  try {\n    parsed = parser.parse(partial, parser.getParseOptions(ractive));\n  } catch (e) {\n    warnIfDebug(`Could not parse partial from expression '${name}'\\n${e.message}`);\n  }\n\n  return parsed || { t: [] };\n}\n","import { addToArray, removeFromArray } from 'utils/array';\nimport { unescapeKey } from 'shared/keypaths';\nimport { capture } from 'src/global/capture';\nimport { handleChange } from 'src/shared/methodCallers';\nimport noop from 'utils/noop';\n\nexport default class KeyModel {\n  constructor(value, context, instance) {\n    this.value = this.key = value;\n    this.context = context;\n    this.isReadonly = this.isKey = true;\n    this.deps = [];\n    this.links = [];\n    this.children = [];\n    this.instance = instance;\n  }\n\n  applyValue(value) {\n    if (value !== this.value) {\n      this.value = this.key = value;\n      this.deps.forEach(handleChange);\n      this.links.forEach(handleChange);\n      this.children.forEach(c => {\n        c.applyValue(c.context.getKeypath(c.instance));\n      });\n    }\n  }\n\n  destroyed() {\n    if (this.upstream) this.upstream.unregisterChild(this);\n  }\n\n  get(shouldCapture) {\n    if (shouldCapture) capture(this);\n    return unescapeKey(this.value);\n  }\n\n  getKeypath() {\n    return unescapeKey(this.value);\n  }\n\n  has() {\n    return false;\n  }\n\n  rebind(next, previous) {\n    let i = this.deps.length;\n    while (i--) this.deps[i].rebind(next, previous, false);\n\n    i = this.links.length;\n    while (i--) this.links[i].relinking(next, false);\n  }\n\n  register(dependant) {\n    this.deps.push(dependant);\n  }\n\n  registerChild(child) {\n    addToArray(this.children, child);\n    child.upstream = this;\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  unregister(dependant) {\n    removeFromArray(this.deps, dependant);\n  }\n\n  unregisterChild(child) {\n    removeFromArray(this.children, child);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n}\n\nKeyModel.prototype.reference = noop;\nKeyModel.prototype.unreference = noop;\n","import { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject, isObjectType, isUndefined } from 'utils/is';\nimport { findMap, buildNewIndices } from 'utils/array';\nimport { toEscapedString, toString, shuffled, update } from 'shared/methodCallers';\nimport Fragment, { getKeypath } from './Fragment';\nimport { ELEMENT } from 'config/types';\nimport { getContext } from 'shared/getRactiveContext';\nimport { keys } from 'utils/object';\nimport KeyModel from 'src/model/specials/KeyModel';\nimport { splitKeypath } from '../shared/keypaths';\nimport resolve from './resolvers/resolve';\n\nconst keypathString = /^\"(\\\\\"|[^\"])+\"$/;\n\nexport default class RepeatedFragment {\n  constructor(options) {\n    this.parent = options.owner.up;\n\n    // bit of a hack, so reference resolution works without another\n    // layer of indirection\n    this.up = this;\n    this.owner = options.owner;\n    this.ractive = this.parent.ractive;\n    this.delegate =\n      this.ractive.delegate !== false && (this.parent.delegate || findDelegate(this.parent));\n    // delegation disabled by directive\n    if (this.delegate && this.delegate.delegate === false) this.delegate = false;\n    // let the element know it's a delegate handler\n    if (this.delegate) this.delegate.delegate = this.delegate;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    this.cssIds = 'cssIds' in options ? options.cssIds : this.parent ? this.parent.cssIds : null;\n\n    this.context = null;\n    this.rendered = false;\n    this.iterations = [];\n\n    this.template = options.template;\n\n    this.indexRef = options.indexRef;\n    this.keyRef = options.keyRef;\n\n    this.pendingNewIndices = null;\n    this.previousIterations = null;\n\n    // track array versus object so updates of type rest\n    this.isArray = false;\n  }\n\n  bind(context) {\n    this.context = context;\n    this.bound = true;\n    const value = context.get();\n\n    const aliases = (this.aliases = this.owner.template.z && this.owner.template.z.slice());\n\n    const shuffler = aliases && aliases.find(a => a.n === 'shuffle');\n    if (shuffler && shuffler.x && shuffler.x.x) {\n      if (shuffler.x.x.s === 'true') this.shuffler = true;\n      else if (keypathString.test(shuffler.x.x.s))\n        this.shuffler = splitKeypath(shuffler.x.x.s.slice(1, -1));\n    }\n\n    if (this.shuffler) this.values = shuffleValues(this, this.shuffler);\n\n    if (this.source) this.source.model.unbind(this.source);\n    const source = context.isComputed && aliases && aliases.find(a => a.n === 'source');\n    if (source && source.x && source.x.r) {\n      const model = resolve(this, source.x);\n      this.source = {\n        handleChange() {},\n        rebind(next) {\n          this.model.unregister(this);\n          this.model = next;\n          next.register(this);\n        }\n      };\n      this.source.model = model;\n      model.register(this.source);\n    }\n\n    // {{#each array}}...\n    if ((this.isArray = isArray(value))) {\n      // we can't use map, because of sparse arrays\n      this.iterations = [];\n      const max = (this.length = value.length);\n      for (let i = 0; i < max; i += 1) {\n        this.iterations[i] = this.createIteration(i, i);\n      }\n    } else if (isObject(value)) {\n      // {{#each object}}...\n      this.isArray = false;\n\n      // TODO this is a dreadful hack. There must be a neater way\n      if (this.indexRef) {\n        const refs = this.indexRef.split(',');\n        this.keyRef = refs[0];\n        this.indexRef = refs[1];\n      }\n\n      const ks = keys(value);\n      this.length = ks.length;\n\n      this.iterations = ks.map((key, index) => {\n        return this.createIteration(key, index);\n      });\n    }\n\n    return this;\n  }\n\n  bubble(index) {\n    if (!this.bubbled) this.bubbled = [];\n    this.bubbled.push(index);\n\n    if (!this.rebounding) this.owner.bubble();\n  }\n\n  createIteration(key, index) {\n    const fragment = new Fragment({\n      owner: this,\n      template: this.template\n    });\n\n    fragment.isIteration = true;\n    fragment.delegate = this.delegate;\n\n    if (this.aliases) fragment.aliases = {};\n    swizzleFragment(this, fragment, key, index);\n\n    return fragment.bind(fragment.context);\n  }\n\n  destroyed() {\n    const len = this.iterations.length;\n    for (let i = 0; i < len; i++) this.iterations[i].destroyed();\n    if (this.pathModel) this.pathModel.destroyed();\n    if (this.rootModel) this.rootModel.destroyed();\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    this.iterations.forEach(fragment => docFrag.appendChild(fragment.detach()));\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.iterations, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    return this.iterations.forEach(i => i.findAll(selector, options));\n  }\n\n  findAllComponents(name, options) {\n    return this.iterations.forEach(i => i.findAllComponents(name, options));\n  }\n\n  findComponent(name, options) {\n    return findMap(this.iterations, i => i.findComponent(name, options));\n  }\n\n  findContext() {\n    return this.context;\n  }\n\n  findNextNode(iteration) {\n    if (iteration.index < this.iterations.length - 1) {\n      for (let i = iteration.index + 1; i < this.iterations.length; i++) {\n        const node = this.iterations[i].firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    return this.owner.findNextNode();\n  }\n\n  firstNode(skipParent) {\n    return this.iterations[0] ? this.iterations[0].firstNode(skipParent) : null;\n  }\n\n  getLast() {\n    return this.lastModel || (this.lastModel = new KeyModel(this.length - 1));\n  }\n\n  rebind(next) {\n    this.context = next;\n    if (this.source) return;\n    if (next) {\n      this.iterations.forEach(fragment => {\n        swizzleFragment(this, fragment, fragment.key, fragment.index);\n      });\n    }\n  }\n\n  rebound(update) {\n    this.context = this.owner.model;\n    this.iterations.forEach((f, i) => {\n      f.context = contextFor(this, f, i);\n      f.rebound(update);\n    });\n  }\n\n  render(target, occupants) {\n    const xs = this.iterations;\n    if (xs) {\n      const len = xs.length;\n      for (let i = 0; i < len; i++) {\n        xs[i].render(target, occupants);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  shuffle(newIndices, merge) {\n    if (!this.pendingNewIndices) this.previousIterations = this.iterations.slice();\n\n    if (!this.pendingNewIndices) this.pendingNewIndices = [];\n\n    this.pendingNewIndices.push(newIndices);\n\n    const iterations = [];\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      if (newIndex === -1) return;\n\n      const fragment = this.iterations[oldIndex];\n      iterations[newIndex] = fragment;\n\n      if (newIndex !== oldIndex && fragment) {\n        fragment.dirty = true;\n        if (merge) fragment.shouldRebind = 1;\n      }\n    });\n\n    this.iterations = iterations;\n\n    // if merging, we're in the midst of an update already\n    if (!merge) this.bubble();\n  }\n\n  shuffled() {\n    this.iterations.forEach(shuffled);\n  }\n\n  toString(escape) {\n    return this.iterations ? this.iterations.map(escape ? toEscapedString : toString).join('') : '';\n  }\n\n  unbind(view) {\n    this.bound = false;\n    if (this.source) this.source.model.unregister(this.source);\n    const iterations = this.pendingNewIndices ? this.previousIterations : this.iterations;\n    const len = iterations.length;\n    for (let i = 0; i < len; i++) iterations[i].unbind(view);\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    let len = this.iterations.length;\n    for (let i = 0; i < len; i++) this.iterations[i].unrender(shouldDestroy);\n    if (this.pendingNewIndices && this.previousIterations) {\n      len = this.previousIterations.length;\n      for (let i = 0; i < len; i++) this.previousIterations[i].unrender(shouldDestroy);\n    }\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.pendingNewIndices) {\n      this.bubbled.length = 0;\n      this.updatePostShuffle();\n      return;\n    }\n\n    if (this.updating) return;\n    this.updating = true;\n\n    if (this.shuffler) {\n      const values = shuffleValues(this, this.shuffler);\n      const newIndices = buildNewIndices(this.values, values);\n      if (!newIndices.same) {\n        this.shuffle(newIndices, true);\n        this.updatePostShuffle();\n      } else {\n        this.iterations.forEach(update);\n      }\n    } else {\n      let len = this.iterations.length;\n      for (let i = 0; i < len; i++) {\n        const f = this.iterations[i];\n        f && f.idxModel && f.idxModel.applyValue(i);\n      }\n\n      const value = this.context.get();\n      const wasArray = this.isArray;\n\n      let toRemove;\n      let oldKeys;\n      let reset = true;\n      let i;\n\n      if ((this.isArray = isArray(value))) {\n        // if there's a source to map back to, make sure everything stays bound correctly\n        if (this.source) {\n          this.rebounding = 1;\n          const source = this.source.model.get();\n          this.iterations.forEach((f, c) => {\n            if (c < value.length && f.lastValue !== value[c] && ~(i = source.indexOf(value[c]))) {\n              swizzleFragment(this, f, c, c);\n              f.rebound(true);\n            }\n          });\n          this.rebounding = 0;\n        }\n\n        if (wasArray) {\n          reset = false;\n          if (this.iterations.length > value.length) {\n            toRemove = this.iterations.splice(value.length);\n          }\n        }\n      } else if (isObject(value) && !wasArray) {\n        reset = false;\n        toRemove = [];\n        oldKeys = {};\n        i = this.iterations.length;\n\n        while (i--) {\n          const fragment = this.iterations[i];\n          if (fragment.key in value) {\n            oldKeys[fragment.key] = true;\n          } else {\n            this.iterations.splice(i, 1);\n            toRemove.push(fragment);\n          }\n        }\n      }\n\n      const newLength = isArray(value) ? value.length : isObject(value) ? keys(value).length : 0;\n      this.length = newLength;\n      this.updateLast();\n\n      if (reset) {\n        toRemove = this.iterations;\n        this.iterations = [];\n      }\n\n      if (toRemove) {\n        len = toRemove.length;\n        for (let i = 0; i < len; i++) toRemove[i].unbind().unrender(true);\n      }\n\n      // update the remaining ones\n      if (!reset && this.isArray && this.bubbled && this.bubbled.length) {\n        const bubbled = this.bubbled;\n        this.bubbled = [];\n        len = bubbled.length;\n        for (let i = 0; i < len; i++)\n          this.iterations[bubbled[i]] && this.iterations[bubbled[i]].update();\n      } else {\n        len = this.iterations.length;\n        for (let i = 0; i < len; i++) this.iterations[i].update();\n      }\n\n      // add new iterations\n      let docFrag;\n      let fragment;\n\n      if (newLength > this.iterations.length) {\n        docFrag = this.rendered ? createDocumentFragment() : null;\n        i = this.iterations.length;\n\n        if (isArray(value)) {\n          while (i < value.length) {\n            fragment = this.createIteration(i, i);\n\n            this.iterations.push(fragment);\n            if (this.rendered) fragment.render(docFrag);\n\n            i += 1;\n          }\n        } else if (isObject(value)) {\n          // TODO this is a dreadful hack. There must be a neater way\n          if (this.indexRef && !this.keyRef) {\n            const refs = this.indexRef.split(',');\n            this.keyRef = refs[0];\n            this.indexRef = refs[1];\n          }\n\n          keys(value).forEach(key => {\n            if (!oldKeys || !(key in oldKeys)) {\n              fragment = this.createIteration(key, i);\n\n              this.iterations.push(fragment);\n              if (this.rendered) fragment.render(docFrag);\n\n              i += 1;\n            }\n          });\n        }\n\n        if (this.rendered) {\n          const parentNode = this.parent.findParentNode();\n          const anchor = this.parent.findNextNode(this.owner);\n\n          parentNode.insertBefore(docFrag, anchor);\n        }\n      }\n    }\n\n    this.updating = false;\n  }\n\n  updateLast() {\n    if (this.lastModel) this.lastModel.applyValue(this.length - 1);\n  }\n\n  updatePostShuffle() {\n    const newIndices = this.pendingNewIndices[0];\n    const parentNode = this.rendered ? this.parent.findParentNode() : null;\n    const nextNode = parentNode && this.owner.findNextNode();\n    const docFrag = parentNode ? createDocumentFragment() : null;\n\n    // map first shuffle through\n    this.pendingNewIndices.slice(1).forEach(indices => {\n      newIndices.forEach((newIndex, oldIndex) => {\n        newIndices[oldIndex] = indices[newIndex];\n      });\n    });\n\n    const len = (this.length = this.context.get().length);\n    const prev = this.previousIterations;\n    const iters = this.iterations;\n    const value = this.context.get();\n    const stash = {};\n    let idx, dest, pos, next, anchor, rebound;\n\n    const map = new Array(newIndices.length);\n    newIndices.forEach((e, i) => (map[e] = i));\n\n    this.updateLast();\n\n    idx = pos = 0;\n    while (idx < len) {\n      // if there's not an existing thing to shuffle, handle that\n      if (isUndefined(map[idx])) {\n        next = iters[idx] = this.createIteration(idx, idx);\n        if (parentNode) {\n          anchor = prev[pos];\n          anchor = (anchor && parentNode && anchor.firstNode()) || nextNode;\n\n          next.render(docFrag);\n          parentNode.insertBefore(docFrag, anchor);\n        }\n\n        idx++;\n      } else {\n        dest = newIndices[pos];\n\n        if (dest === -1) {\n          // if it needs to be dropped, drop it\n          prev[pos] && prev[pos].unbind().unrender(true);\n          prev[pos++] = 0;\n        } else if (dest > idx) {\n          // if it needs to move down, stash it\n          stash[dest] = prev[pos];\n          prev[pos++] = null;\n        } else {\n          // get the fragment that goes for this idx\n          iters[idx] = next = iters[idx] || stash[idx] || this.createIteration(idx, idx);\n\n          // if it's an existing fragment, swizzle\n          if (stash[idx] || pos !== idx) {\n            rebound = this.source && next.lastValue !== value[idx];\n            swizzleFragment(this, next, idx, idx);\n          }\n\n          // does next need to be moved?\n          if (parentNode && (stash[idx] || !prev[pos])) {\n            anchor = prev[pos + 1];\n            anchor = (anchor && parentNode && anchor.firstNode()) || nextNode;\n\n            if (stash[idx]) {\n              parentNode.insertBefore(next.detach(), anchor);\n            } else {\n              next.render(docFrag);\n              parentNode.insertBefore(docFrag, anchor);\n            }\n          }\n\n          prev[pos++] = 0;\n          idx++;\n        }\n\n        if (next && isObjectType(next)) {\n          if (next.shouldRebind || rebound) {\n            next.rebound(rebound);\n            next.shouldRebind = 0;\n          }\n          next.update();\n          next.shuffled();\n        }\n      }\n    }\n\n    // clean up any stragglers\n    const plen = prev.length;\n    for (let i = 0; i < plen; i++) prev[i] && prev[i].unbind().unrender(true);\n\n    if (this.shuffler) this.values = shuffleValues(this, this.shuffler);\n\n    this.pendingNewIndices = null;\n    this.previousIterations = null;\n  }\n}\n\nRepeatedFragment.prototype.getContext = getContext;\nRepeatedFragment.prototype.getKeypath = getKeypath;\n\n// find the topmost delegate\nfunction findDelegate(start) {\n  let frag = start;\n  let delegate, el;\n\n  out: while (frag) {\n    // find next element\n    el = 0;\n    while (!el && frag) {\n      if (frag.owner.type === ELEMENT) el = frag.owner;\n      if (frag.owner.ractive && frag.owner.ractive.delegate === false) break out;\n      frag = frag.parent || frag.componentParent;\n    }\n\n    if (el.delegate === false) break out;\n    delegate = el.delegate || el;\n\n    // find next repeated fragment\n    while (frag) {\n      if (frag.iterations) break;\n      if (frag.owner.ractive && frag.owner.ractive.delegate === false) break out;\n      frag = frag.parent || frag.componentParent;\n    }\n  }\n\n  return delegate;\n}\n\nfunction swizzleFragment(section, fragment, key, idx) {\n  const model = section.context ? contextFor(section, fragment, key) : undefined;\n\n  fragment.key = key;\n  fragment.index = idx;\n  fragment.context = model;\n  if (section.source) fragment.lastValue = model && model.get();\n\n  if (fragment.idxModel) fragment.idxModel.applyValue(idx);\n  if (fragment.keyModel) fragment.keyModel.applyValue(key);\n  if (fragment.pathModel) {\n    fragment.pathModel.context = model;\n    fragment.pathModel.applyValue(model.getKeypath());\n  }\n  if (fragment.rootModel) {\n    fragment.rootModel.context = model;\n    fragment.rootModel.applyValue(model.getKeypath(fragment.ractive.root));\n  }\n\n  // handle any aliases\n  const aliases = fragment.aliases;\n  section.aliases &&\n    section.aliases.forEach(a => {\n      if (a.x.r === '.') aliases[a.n] = model;\n      else if (a.x.r === '@index') aliases[a.n] = fragment.getIndex();\n      else if (a.x.r === '@key') aliases[a.n] = fragment.getKey();\n      else if (a.x.r === '@keypath') aliases[a.n] = fragment.getKeypath();\n      else if (a.x.r === '@rootpath') aliases[a.n] = fragment.getKeypath(true);\n    });\n}\n\nfunction shuffleValues(section, shuffler) {\n  const array = section.context.get() || [];\n  if (shuffler === true) {\n    return array.slice();\n  } else {\n    return array.map(v => shuffler.reduce((a, c) => a && a[c], v));\n  }\n}\n\nfunction contextFor(section, fragment, key) {\n  if (section.source) {\n    let idx;\n    const source = section.source.model.get();\n    if (source.indexOf && ~(idx = source.indexOf(section.context.joinKey(key).get())))\n      return section.source.model.joinKey(idx);\n  }\n\n  return section.context.joinKey(key);\n}\n","import {\n  ALIAS,\n  SECTION_EACH,\n  SECTION_IF,\n  SECTION_IF_WITH,\n  SECTION_UNLESS,\n  SECTION_WITH\n} from 'config/types';\nimport { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject, isObjectLike, isUndefined } from 'utils/is';\nimport { keep } from 'shared/set';\nimport runloop from 'src/global/runloop';\nimport Fragment from '../Fragment';\nimport RepeatedFragment from '../RepeatedFragment';\nimport { MustacheContainer } from './shared/Mustache';\nimport { keys } from 'utils/object';\nimport Context from 'src/shared/Context';\n\nfunction isEmpty(value) {\n  return (\n    !value ||\n    (isArray(value) && value.length === 0) ||\n    (isObject(value) && keys(value).length === 0)\n  );\n}\n\nfunction getType(value, hasIndexRef) {\n  if (hasIndexRef || isArray(value)) return SECTION_EACH;\n  if (isObjectLike(value)) return SECTION_IF_WITH;\n  if (isUndefined(value)) return null;\n  return SECTION_IF;\n}\n\nexport default class Section extends MustacheContainer {\n  constructor(options) {\n    super(options);\n\n    this.isAlias = options.template.t === ALIAS;\n    this.sectionType = options.template.n || (this.isAlias && SECTION_WITH) || null;\n    this.templateSectionType = this.sectionType;\n    this.subordinate = options.template.l === 1;\n    this.fragment = null;\n  }\n\n  bind() {\n    super.bind();\n\n    if (this.subordinate) {\n      this.sibling = this.up.items[this.up.items.indexOf(this) - 1];\n      this.sibling.nextSibling = this;\n    }\n\n    // if we managed to bind, we need to create children\n    if (this.model || this.isAlias) {\n      this.dirty = true;\n      this.update();\n    } else if (\n      this.sectionType &&\n      this.sectionType === SECTION_UNLESS &&\n      (!this.sibling || !this.sibling.isTruthy())\n    ) {\n      this.fragment = new Fragment({\n        owner: this,\n        template: this.template.f\n      }).bind();\n    }\n  }\n\n  bubble() {\n    if (!this.dirty && this.yield) {\n      this.dirty = true;\n      this.containerFragment.bubble();\n    } else super.bubble();\n  }\n\n  detach() {\n    const frag = this.fragment || this.detached;\n    return frag ? frag.detach() : super.detach();\n  }\n\n  findNextNode() {\n    return (this.containerFragment || this.up).findNextNode(this);\n  }\n\n  isTruthy() {\n    if (this.subordinate && this.sibling.isTruthy()) return true;\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    return !!value && (this.templateSectionType === SECTION_IF_WITH || !isEmpty(value));\n  }\n\n  rebind(next, previous, safe) {\n    if (super.rebind(next, previous, safe)) {\n      if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n        this.fragment.rebind(next);\n      }\n    }\n  }\n\n  rebound(update) {\n    if (this.model) {\n      if (this.model.rebound) this.model.rebound(update);\n      else {\n        super.unbind();\n        super.bind();\n        if (\n          this.sectionType === SECTION_WITH ||\n          this.sectionType === SECTION_IF_WITH ||\n          this.sectionType === SECTION_EACH\n        ) {\n          if (this.fragment) this.fragment.rebind(this.model);\n        }\n\n        if (update) this.bubble();\n      }\n    }\n    if (this.fragment) this.fragment.rebound(update);\n  }\n\n  render(target, occupants) {\n    this.rendered = true;\n    if (this.fragment) this.fragment.render(target, occupants);\n  }\n\n  shuffle(newIndices) {\n    if (this.fragment && this.sectionType === SECTION_EACH) {\n      this.fragment.shuffle(newIndices);\n    }\n  }\n\n  unbind(view) {\n    super.unbind(view);\n    if (this.fragment) this.fragment.unbind(view);\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (!this.dirty) return;\n\n    if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n      this.fragment.context = this.model;\n    }\n\n    if (!this.model && this.sectionType !== SECTION_UNLESS && !this.isAlias) return;\n\n    this.dirty = false;\n\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    const siblingFalsey = !this.subordinate || !this.sibling.isTruthy();\n    const lastType = this.sectionType;\n\n    if (this.yield && this.yield !== value) {\n      this.up = this.containerFragment;\n      this.container = null;\n      this.yield = null;\n      if (this.rendered) this.fragment.unbind().unrender(true);\n      this.fragment = null;\n    } else if (this.rendered && !this.yield && value instanceof Context) {\n      if (this.rendered && this.fragment) this.fragment.unbind().unrender(true);\n      this.fragment = null;\n    }\n\n    // watch for switching section types\n    if (this.sectionType === null || this.templateSectionType === null)\n      this.sectionType = getType(value, this.template.i);\n    if (lastType && lastType !== this.sectionType && this.fragment) {\n      if (this.rendered) {\n        this.fragment.unbind().unrender(true);\n      }\n\n      this.fragment = null;\n    }\n\n    let newFragment;\n\n    const fragmentShouldExist =\n      this.sectionType === SECTION_EACH || // each always gets a fragment, which may have no iterations\n      this.sectionType === SECTION_WITH || // with (partial context) always gets a fragment\n      (siblingFalsey &&\n        (this.sectionType === SECTION_UNLESS ? !this.isTruthy() : this.isTruthy())) || // if, unless, and if-with depend on siblings and the condition\n      this.isAlias;\n\n    if (fragmentShouldExist) {\n      if (!this.fragment) this.fragment = this.detached;\n\n      if (this.fragment) {\n        // check for detached fragment\n        if (this.detached) {\n          attach(this, this.fragment);\n          this.detached = false;\n          this.rendered = true;\n        }\n\n        if (!this.fragment.bound) this.fragment.bind(this.model);\n        this.fragment.update();\n      } else {\n        if (this.sectionType === SECTION_EACH) {\n          newFragment = new RepeatedFragment({\n            owner: this,\n            template: this.template.f,\n            indexRef: this.template.i\n          }).bind(this.model);\n        } else {\n          // only with and if-with provide context - if and unless do not\n          let context =\n            this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS\n              ? this.model\n              : null;\n\n          if (value instanceof Context) {\n            this.yield = value;\n            this.containerFragment = this.up;\n            this.up = value.fragment;\n            this.container = value.ractive;\n            context = undefined;\n          }\n\n          newFragment = new Fragment({\n            owner: this,\n            template: this.template.f\n          }).bind(context);\n        }\n      }\n    } else {\n      if (this.fragment && this.rendered) {\n        if (keep !== true) {\n          this.fragment.unbind().unrender(true);\n        } else {\n          this.unrender(false);\n          this.detached = this.fragment;\n          runloop.promise().then(() => {\n            if (this.detached) this.detach();\n          });\n        }\n      } else if (this.fragment) {\n        this.fragment.unbind();\n      }\n\n      this.fragment = null;\n    }\n\n    if (newFragment) {\n      if (this.rendered) {\n        attach(this, newFragment);\n      }\n\n      this.fragment = newFragment;\n    }\n\n    if (this.nextSibling) {\n      this.nextSibling.dirty = true;\n      this.nextSibling.update();\n    }\n  }\n}\n\nfunction attach(section, fragment) {\n  const anchor = (section.containerFragment || section.up).findNextNode(section);\n\n  if (anchor) {\n    const docFrag = createDocumentFragment();\n    fragment.render(docFrag);\n\n    anchor.parentNode.insertBefore(docFrag, anchor);\n  } else {\n    fragment.render(section.up.findParentNode());\n  }\n}\n","import { toArray } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Element from '../../Element';\nimport { isArray, isFunction } from 'utils/is';\n\nexport default class Select extends Element {\n  constructor(options) {\n    super(options);\n    this.options = [];\n  }\n\n  foundNode(node) {\n    if (this.binding) {\n      const selectedOptions = getSelectedOptions(node);\n\n      if (selectedOptions.length > 0) {\n        this.selectedOptions = selectedOptions;\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.sync();\n\n    const node = this.node;\n\n    let i = node.options.length;\n    while (i--) {\n      node.options[i].defaultSelected = node.options[i].selected;\n    }\n\n    this.rendered = true;\n  }\n\n  sync() {\n    const selectNode = this.node;\n\n    if (!selectNode) return;\n\n    const options = toArray(selectNode.options);\n\n    if (this.selectedOptions) {\n      options.forEach(o => {\n        if (this.selectedOptions.indexOf(o) >= 0) o.selected = true;\n        else o.selected = false;\n      });\n      this.binding.setFromNode(selectNode);\n      delete this.selectedOptions;\n      return;\n    }\n\n    const selectValue = this.getAttribute('value');\n    const isMultiple = this.getAttribute('multiple');\n    const array = isMultiple && isArray(selectValue);\n\n    // If the <select> has a specified value, that should override\n    // these options\n    if (selectValue !== undefined) {\n      let optionWasSelected;\n\n      options.forEach(o => {\n        const optionValue = o._ractive ? o._ractive.value : o.value;\n        const shouldSelect = isMultiple\n          ? array && this.valueContains(selectValue, optionValue)\n          : this.compare(selectValue, optionValue);\n\n        if (shouldSelect) {\n          optionWasSelected = true;\n        }\n\n        o.selected = shouldSelect;\n      });\n\n      if (!optionWasSelected && !isMultiple) {\n        if (this.binding) {\n          this.binding.forceUpdate();\n        }\n      }\n    } else if (this.binding && this.binding.forceUpdate) {\n      // Otherwise the value should be initialised according to which\n      // <option> element is selected, if twoway binding is in effect\n      this.binding.forceUpdate();\n    }\n  }\n  valueContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.compare(optionValue, selectValue[i])) return true;\n    }\n  }\n  compare(optionValue, selectValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(selectValue, optionValue);\n      }\n      if (selectValue && optionValue) {\n        return selectValue[comparator] == optionValue[comparator];\n      }\n    }\n    return selectValue == optionValue;\n  }\n  update() {\n    const dirty = this.dirty;\n    super.update();\n    if (dirty) {\n      this.sync();\n    }\n  }\n}\n","import { ATTRIBUTE } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport Input from './Input';\nimport { isBindable } from '../binding/selectBinding';\nimport createItem from '../../createItem';\nimport Fragment from '../../../Fragment';\n\nexport default class Textarea extends Input {\n  constructor(options) {\n    const template = options.template;\n\n    options.deferContent = true;\n\n    super(options);\n\n    // check for single interpolator binding\n    if (!this.attributeByName.value) {\n      if (template.f && isBindable({ template })) {\n        (this.attributes || (this.attributes = [])).push(\n          createItem({\n            owner: this,\n            template: { t: ATTRIBUTE, f: template.f, n: 'value' },\n            up: this.up\n          })\n        );\n      } else {\n        this.fragment = new Fragment({\n          owner: this,\n          cssIds: null,\n          template: template.f\n        });\n      }\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.rendered && !this.binding && this.fragment) {\n        runloop.scheduleTask(() => {\n          this.dirty = false;\n          this.node.value = this.fragment.toString();\n        });\n      }\n\n      this.up.bubble(); // default behaviour\n    }\n  }\n}\n","import { TEXT } from 'config/types';\nimport { escapeHtml } from 'utils/html';\nimport { detachNode } from 'utils/dom';\nimport noop from 'utils/noop';\nimport Item from './shared/Item';\nimport progressiveText from './shared/progressiveText';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Text extends Item {\n  constructor(options) {\n    super(options);\n    this.type = TEXT;\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, this.template);\n  }\n\n  toString(escape) {\n    return escape ? escapeHtml(this.template) : this.template;\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  valueOf() {\n    return this.template;\n  }\n}\n\nconst proto = Text.prototype;\nproto.bind = proto.unbind = proto.update = noop;\n","import { win, doc, vendors } from './environment';\n\nexport let visible;\nlet hidden = 'hidden';\n\nif (doc) {\n  let prefix;\n\n  /* istanbul ignore next */\n  if (hidden in doc) {\n    prefix = '';\n  } else {\n    let i = vendors.length;\n    while (i--) {\n      const vendor = vendors[i];\n      hidden = vendor + 'Hidden';\n\n      if (hidden in doc) {\n        prefix = vendor;\n        break;\n      }\n    }\n  }\n\n  /* istanbul ignore else */\n  if (prefix !== undefined) {\n    doc.addEventListener(prefix + 'visibilitychange', onChange);\n    onChange();\n  } else {\n    // gah, we're in an old browser\n    if ('onfocusout' in doc) {\n      doc.addEventListener('focusout', onHide);\n      doc.addEventListener('focusin', onShow);\n    } else {\n      win.addEventListener('pagehide', onHide);\n      win.addEventListener('blur', onHide);\n\n      win.addEventListener('pageshow', onShow);\n      win.addEventListener('focus', onShow);\n    }\n\n    visible = true; // until proven otherwise. Not ideal but hey\n  }\n}\n\nfunction onChange() {\n  visible = !doc[hidden];\n}\n\n/* istanbul ignore next */\nfunction onHide() {\n  visible = false;\n}\n\n/* istanbul ignore next */\nfunction onShow() {\n  visible = true;\n}\n","import { isClient, vendors } from 'config/environment';\nimport { createElement } from 'utils/dom';\nimport hyphenateCamel from 'utils/hyphenateCamel';\n\nlet prefix;\n\n/* istanbul ignore next */\nif (!isClient) {\n  prefix = null;\n} else {\n  const prefixCache = {};\n  const testStyle = createElement('div').style;\n\n  // technically this also normalizes on hyphenated styles as well\n  prefix = function(prop) {\n    if (!prefixCache[prop]) {\n      const name = hyphenateCamel(prop);\n\n      if (testStyle[prop] !== undefined) {\n        prefixCache[prop] = name;\n      } else {\n        /* istanbul ignore next */\n        // test vendors...\n        let i = vendors.length;\n        while (i--) {\n          const vendor = `-${vendors[i]}-${name}`;\n          if (testStyle[vendor] !== undefined) {\n            prefixCache[prop] = vendor;\n            break;\n          }\n        }\n      }\n    }\n\n    return prefixCache[prop];\n  };\n}\n\nexport default prefix;\n","import { missingPlugin } from 'config/errors';\nimport { isClient } from 'config/environment';\nimport { warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { createElement } from 'utils/dom';\nimport interpolate from 'shared/interpolate';\nimport Ticker from 'shared/Ticker';\nimport hyphenate from './hyphenate';\nimport { isFunction, isString } from 'utils/is';\n\nlet createTransitions;\n\nif (!isClient) {\n  createTransitions = null;\n} else {\n  const testStyle = createElement('div').style;\n  const linear = x => x;\n\n  const canUseCssTransitions = {};\n  const cannotUseCssTransitions = {};\n\n  // determine some facts about our environment\n  let TRANSITION;\n  let TRANSITIONEND;\n  let CSS_TRANSITIONS_ENABLED;\n  let TRANSITION_DURATION;\n  let TRANSITION_PROPERTY;\n  let TRANSITION_TIMING_FUNCTION;\n\n  if (testStyle.transition !== undefined) {\n    TRANSITION = 'transition';\n    TRANSITIONEND = 'transitionend';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else if (testStyle.webkitTransition !== undefined) {\n    TRANSITION = 'webkitTransition';\n    TRANSITIONEND = 'webkitTransitionEnd';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else {\n    CSS_TRANSITIONS_ENABLED = false;\n  }\n\n  if (TRANSITION) {\n    TRANSITION_DURATION = TRANSITION + 'Duration';\n    TRANSITION_PROPERTY = TRANSITION + 'Property';\n    TRANSITION_TIMING_FUNCTION = TRANSITION + 'TimingFunction';\n  }\n\n  createTransitions = function(t, to, options, changedProperties, resolve) {\n    // Wait a beat (otherwise the target styles will be applied immediately)\n    // TODO use a fastdom-style mechanism?\n    setTimeout(() => {\n      let jsTransitionsComplete;\n      let cssTransitionsComplete;\n      let cssTimeout; // eslint-disable-line prefer-const\n\n      function transitionDone() {\n        clearTimeout(cssTimeout);\n      }\n\n      function checkComplete() {\n        if (jsTransitionsComplete && cssTransitionsComplete) {\n          t.unregisterCompleteHandler(transitionDone);\n          // will changes to events and fire have an unexpected consequence here?\n          t.ractive.fire(t.name + ':end', t.node, t.isIntro);\n          resolve();\n        }\n      }\n\n      // this is used to keep track of which elements can use CSS to animate\n      // which properties\n      const hashPrefix = (t.node.namespaceURI || '') + t.node.tagName;\n\n      // need to reset transition properties\n      const style = t.node.style;\n      const previous = {\n        property: style[TRANSITION_PROPERTY],\n        timing: style[TRANSITION_TIMING_FUNCTION],\n        duration: style[TRANSITION_DURATION]\n      };\n\n      function transitionEndHandler(event) {\n        if (event.target !== t.node) return;\n        const index = changedProperties.indexOf(event.propertyName);\n\n        if (index !== -1) {\n          changedProperties.splice(index, 1);\n        }\n\n        if (changedProperties.length) {\n          // still transitioning...\n          return;\n        }\n\n        clearTimeout(cssTimeout);\n        cssTransitionsDone();\n      }\n\n      function cssTransitionsDone() {\n        style[TRANSITION_PROPERTY] = previous.property;\n        style[TRANSITION_TIMING_FUNCTION] = previous.duration;\n        style[TRANSITION_DURATION] = previous.timing;\n\n        t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n        cssTransitionsComplete = true;\n        checkComplete();\n      }\n\n      t.node.addEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n      // safety net in case transitionend never fires\n      cssTimeout = setTimeout(() => {\n        changedProperties = [];\n        cssTransitionsDone();\n      }, options.duration + (options.delay || 0) + 50);\n      t.registerCompleteHandler(transitionDone);\n\n      style[TRANSITION_PROPERTY] = changedProperties.join(',');\n      const easingName = hyphenate(options.easing || 'linear');\n      style[TRANSITION_TIMING_FUNCTION] = easingName;\n      const cssTiming = style[TRANSITION_TIMING_FUNCTION] === easingName;\n      style[TRANSITION_DURATION] = options.duration / 1000 + 's';\n\n      setTimeout(() => {\n        let i = changedProperties.length;\n        let hash;\n        let originalValue = null;\n        let index;\n        const propertiesToTransitionInJs = [];\n        let prop;\n        let suffix;\n        let interpolator;\n\n        while (i--) {\n          prop = changedProperties[i];\n          hash = hashPrefix + prop;\n\n          if (cssTiming && CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[hash]) {\n            const initial = style[prop];\n            style[prop] = to[prop];\n\n            // If we're not sure if CSS transitions are supported for\n            // this tag/property combo, find out now\n            if (!(hash in canUseCssTransitions)) {\n              originalValue = t.getStyle(prop);\n\n              // if this property is transitionable in this browser,\n              // the current style will be different from the target style\n              canUseCssTransitions[hash] = t.getStyle(prop) != to[prop];\n              cannotUseCssTransitions[hash] = !canUseCssTransitions[hash];\n\n              // Reset, if we're going to use timers after all\n              if (cannotUseCssTransitions[hash]) {\n                style[prop] = initial;\n              }\n            }\n          }\n\n          if (!cssTiming || !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[hash]) {\n            // we need to fall back to timer-based stuff\n            if (originalValue === null) originalValue = t.getStyle(prop);\n\n            // need to remove this from changedProperties, otherwise transitionEndHandler\n            // will get confused\n            index = changedProperties.indexOf(prop);\n            if (index === -1) {\n              warnIfDebug(\n                'Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!',\n                { node: t.node }\n              );\n            } else {\n              changedProperties.splice(index, 1);\n            }\n\n            // TODO Determine whether this property is animatable at all\n\n            suffix = /[^\\d]*$/.exec(originalValue)[0];\n            interpolator = interpolate(parseFloat(originalValue), parseFloat(to[prop]));\n\n            // ...then kick off a timer-based transition\n            if (interpolator) {\n              propertiesToTransitionInJs.push({\n                name: prop,\n                interpolator,\n                suffix\n              });\n            } else {\n              style[prop] = to[prop];\n            }\n\n            originalValue = null;\n          }\n        }\n\n        // javascript transitions\n        if (propertiesToTransitionInJs.length) {\n          let easing;\n\n          if (isString(options.easing)) {\n            easing = t.ractive.easing[options.easing];\n\n            if (!easing) {\n              warnOnceIfDebug(missingPlugin(options.easing, 'easing'));\n              easing = linear;\n            }\n          } else if (isFunction(options.easing)) {\n            easing = options.easing;\n          } else {\n            easing = linear;\n          }\n\n          new Ticker({\n            duration: options.duration,\n            easing,\n            step(pos) {\n              let i = propertiesToTransitionInJs.length;\n              while (i--) {\n                const prop = propertiesToTransitionInJs[i];\n                style[prop.name] = prop.interpolator(pos) + prop.suffix;\n              }\n            },\n            complete() {\n              jsTransitionsComplete = true;\n              checkComplete();\n            }\n          });\n        } else {\n          jsTransitionsComplete = true;\n        }\n\n        if (changedProperties.length) {\n          style[TRANSITION_PROPERTY] = changedProperties.join(',');\n        } else {\n          style[TRANSITION_PROPERTY] = 'none';\n\n          // We need to cancel the transitionEndHandler, and deal with\n          // the fact that it will never fire\n          t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n          cssTransitionsComplete = true;\n          checkComplete();\n        }\n      }, 0);\n    }, options.delay || 0);\n  };\n}\n\nexport default createTransitions;\n","import { vendors } from 'config/environment';\n\nconst vendorPattern = new RegExp('^(?:' + vendors.join('|') + ')([A-Z])');\n\nexport default function(str) {\n  /* istanbul ignore next */\n  if (!str) return ''; // edge case\n\n  /* istanbul ignore next */\n  if (vendorPattern.test(str)) str = '-' + str;\n\n  return str.replace(/[A-Z]/g, match => '-' + match.toLowerCase());\n}\n","import { win } from 'config/environment';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isFunction, isNumber, isString, isUndefined } from 'utils/is';\nimport noop from 'utils/noop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { findInViewHierarchy } from 'shared/registry';\nimport { visible } from 'config/visibility';\nimport findElement from '../shared/findElement';\nimport prefix from './transitions/prefix';\nimport createTransitions from './transitions/createTransitions';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport { assign, hasOwn, keys } from 'utils/object';\n\nconst getComputedStyle = win && win.getComputedStyle;\nconst resolved = Promise.resolve();\n\nconst names = {\n  t0: 'intro-outro',\n  t1: 'intro',\n  t2: 'outro'\n};\n\nexport default class Transition {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.ractive = this.owner.ractive;\n    this.template = options.template;\n    this.up = options.up;\n    this.options = options;\n    this.onComplete = [];\n  }\n\n  animateStyle(style, value, options) {\n    if (arguments.length === 4) {\n      throw new Error(\n        't.animateStyle() returns a promise - use .then() instead of passing a callback'\n      );\n    }\n\n    // Special case - page isn't visible. Don't animate anything, because\n    // that way you'll never get CSS transitionend events\n    if (!visible) {\n      this.setStyle(style, value);\n      return resolved;\n    }\n\n    let to;\n\n    if (isString(style)) {\n      to = {};\n      to[style] = value;\n    } else {\n      to = style;\n\n      // shuffle arguments\n      options = value;\n    }\n\n    return new Promise(fulfil => {\n      // Edge case - if duration is zero, set style synchronously and complete\n      if (!options.duration) {\n        this.setStyle(to);\n        fulfil();\n        return;\n      }\n\n      // Get a list of the properties we're animating\n      const propertyNames = keys(to);\n      const changedProperties = [];\n\n      // Store the current styles\n      const computedStyle = getComputedStyle(this.node);\n\n      let i = propertyNames.length;\n      while (i--) {\n        const prop = propertyNames[i];\n        const name = prefix(prop);\n\n        const current = computedStyle[prefix(prop)];\n\n        // record the starting points\n        const init = this.node.style[name];\n        if (!(name in this.originals)) this.originals[name] = this.node.style[name];\n        this.node.style[name] = to[prop];\n        this.targets[name] = this.node.style[name];\n        this.node.style[name] = init;\n\n        // we need to know if we're actually changing anything\n        if (current != to[prop]) {\n          // use != instead of !==, so we can compare strings with numbers\n          changedProperties.push(name);\n\n          // if we happened to prefix, make sure there is a properly prefixed value\n          to[name] = to[prop];\n\n          // make the computed style explicit, so we can animate where\n          // e.g. height='auto'\n          this.node.style[name] = current;\n        }\n      }\n\n      // If we're not actually changing anything, the transitionend event\n      // will never fire! So we complete early\n      if (!changedProperties.length) {\n        fulfil();\n        return;\n      }\n\n      createTransitions(this, to, options, changedProperties, fulfil);\n    });\n  }\n\n  bind() {\n    const options = this.options;\n    const type = options.template && options.template.v;\n    if (type) {\n      if (type === 't0' || type === 't1') this.element.intro = this;\n      if (type === 't0' || type === 't2') this.element.outro = this;\n      this.eventName = names[type];\n    }\n\n    const ractive = this.owner.ractive;\n\n    this.name = options.name || options.template.n;\n\n    if (options.params) {\n      this.params = options.params;\n    }\n\n    if (isFunction(this.name)) {\n      this._fn = this.name;\n      this.name = this._fn.name;\n    } else {\n      this._fn = findInViewHierarchy('transitions', ractive, this.name);\n    }\n\n    if (!this._fn) {\n      warnOnceIfDebug(missingPlugin(this.name, 'transition'), { ractive });\n    }\n\n    setupArgsFn(this, options.template);\n  }\n\n  getParams() {\n    if (this.params) return this.params;\n\n    // get expression args if supplied\n    if (this.fn) {\n      const values = resolveArgs(this, this.template, this.up).map(model => {\n        if (!model) return undefined;\n\n        return model.get();\n      });\n      return this.fn.apply(this.ractive, values);\n    }\n  }\n\n  getStyle(props) {\n    const computedStyle = getComputedStyle(this.node);\n\n    if (isString(props)) {\n      return computedStyle[prefix(props)];\n    }\n\n    if (!isArray(props)) {\n      throw new Error(\n        'Transition$getStyle must be passed a string, or an array of strings representing CSS properties'\n      );\n    }\n\n    const styles = {};\n\n    let i = props.length;\n    while (i--) {\n      const prop = props[i];\n      let value = computedStyle[prefix(prop)];\n\n      if (value === '0px') value = 0;\n      styles[prop] = value;\n    }\n\n    return styles;\n  }\n\n  processParams(params, defaults) {\n    if (isNumber(params)) {\n      params = { duration: params };\n    } else if (isString(params)) {\n      if (params === 'slow') {\n        params = { duration: 600 };\n      } else if (params === 'fast') {\n        params = { duration: 200 };\n      } else {\n        params = { duration: 400 };\n      }\n    } else if (!params) {\n      params = {};\n    }\n\n    return assign({}, defaults, params);\n  }\n\n  registerCompleteHandler(fn) {\n    addToArray(this.onComplete, fn);\n  }\n\n  setStyle(style, value) {\n    if (isString(style)) {\n      const name = prefix(style);\n      if (!hasOwn(this.originals, name)) this.originals[name] = this.node.style[name];\n      this.node.style[name] = value;\n      this.targets[name] = this.node.style[name];\n    } else {\n      let prop;\n      for (prop in style) {\n        if (hasOwn(style, prop)) {\n          this.setStyle(prop, style[prop]);\n        }\n      }\n    }\n\n    return this;\n  }\n\n  shouldFire(type) {\n    if (!this.ractive.transitionsEnabled) return false;\n\n    // check for noIntro and noOutro cases, which only apply when the owner ractive is rendering and unrendering, respectively\n    if (type === 'intro' && this.ractive.rendering && nearestProp('noIntro', this.ractive, true))\n      return false;\n    if (type === 'outro' && this.ractive.unrendering && nearestProp('noOutro', this.ractive, false))\n      return false;\n\n    const params = this.getParams(); // this is an array, the params object should be the first member\n    // if there's not a parent element, this can't be nested, so roll on\n    if (!this.element.parent) return true;\n\n    // if there is a local param, it takes precedent\n    if (params && params[0] && isObject(params[0]) && 'nested' in params[0]) {\n      if (params[0].nested !== false) return true;\n    } else {\n      // use the nearest instance setting\n      // find the nearest instance that actually has a nested setting\n      if (nearestProp('nestedTransitions', this.ractive) !== false) return true;\n    }\n\n    // check to see if this is actually a nested transition\n    let el = this.element.parent;\n    while (el) {\n      if (el[type] && el[type].starting) return false;\n      el = el.parent;\n    }\n\n    return true;\n  }\n\n  start() {\n    const node = (this.node = this.element.node);\n    const originals = (this.originals = {}); //= node.getAttribute( 'style' );\n    const targets = (this.targets = {});\n\n    let completed;\n    const args = this.getParams();\n\n    // create t.complete() - we don't want this on the prototype,\n    // because we don't want `this` silliness when passing it as\n    // an argument\n    this.complete = noReset => {\n      this.starting = false;\n      if (completed) {\n        return;\n      }\n\n      this.onComplete.forEach(fn => fn());\n      if (!noReset && this.isIntro) {\n        for (const k in targets) {\n          if (node.style[k] === targets[k]) node.style[k] = originals[k];\n        }\n      }\n\n      this._manager.remove(this);\n\n      completed = true;\n    };\n\n    // If the transition function doesn't exist, abort\n    if (!this._fn) {\n      this.complete();\n      return;\n    }\n\n    const promise = this._fn.apply(this.ractive, [this].concat(args));\n    if (promise) promise.then(this.complete);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    if (!this.element.attributes || !this.element.attributes.unbinding) {\n      const type = this.options && this.options.template && this.options.template.v;\n      if (type === 't0' || type === 't1') this.element.intro = null;\n      if (type === 't0' || type === 't2') this.element.outro = null;\n    }\n  }\n\n  unregisterCompleteHandler(fn) {\n    removeFromArray(this.onComplete, fn);\n  }\n}\n\nconst proto = Transition.prototype;\nproto.destroyed = proto.firstNode = proto.rebound = proto.render = proto.unrender = proto.update = noop;\n\nfunction nearestProp(prop, ractive, rendering) {\n  let instance = ractive;\n  while (instance) {\n    if (\n      hasOwn(instance, prop) &&\n      (isUndefined(rendering) || rendering ? instance.rendering : instance.unrendering)\n    )\n      return instance[prop];\n    instance = instance.component && instance.component.ractive;\n  }\n\n  return ractive[prop];\n}\n","import { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\n\nconst elementCache = {};\n\nlet ieBug;\nlet ieBlacklist;\n\ntry {\n  createElement('table').innerHTML = 'foo';\n} catch (/* istanbul ignore next */ err) {\n  ieBug = true;\n\n  ieBlacklist = {\n    TABLE: ['<table class=\"x\">', '</table>'],\n    THEAD: ['<table><thead class=\"x\">', '</thead></table>'],\n    TBODY: ['<table><tbody class=\"x\">', '</tbody></table>'],\n    TR: ['<table><tr class=\"x\">', '</tr></table>'],\n    SELECT: ['<select class=\"x\">', '</select>']\n  };\n}\n\nexport default function(html, node) {\n  const nodes = [];\n\n  // render 0 and false\n  if (html == null || html === '') return nodes;\n\n  let container;\n  let wrapper;\n  let selectedOption;\n\n  /* istanbul ignore if */\n  if (ieBug && (wrapper = ieBlacklist[node.tagName])) {\n    container = element('DIV');\n    container.innerHTML = wrapper[0] + html + wrapper[1];\n    container = container.querySelector('.x');\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  } else if (node.namespaceURI === svg) {\n    container = element('DIV');\n    container.innerHTML = '<svg class=\"x\">' + html + '</svg>';\n    container = container.querySelector('.x');\n  } else if (node.tagName === 'TEXTAREA') {\n    container = createElement('div');\n\n    if (typeof container.textContent !== 'undefined') {\n      container.textContent = html;\n    } else {\n      container.innerHTML = html;\n    }\n  } else {\n    container = element(node.tagName);\n    container.innerHTML = html;\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  }\n\n  let child;\n  while ((child = container.firstChild)) {\n    nodes.push(child);\n    container.removeChild(child);\n  }\n\n  // This is really annoying. Extracting <option> nodes from the\n  // temporary container <select> causes the remaining ones to\n  // become selected. So now we have to deselect them. IE8, you\n  // amaze me. You really do\n  // ...and now Chrome too\n  let i;\n  if (node.tagName === 'SELECT') {\n    i = nodes.length;\n    while (i--) {\n      if (nodes[i] !== selectedOption) {\n        nodes[i].selected = false;\n      }\n    }\n  }\n\n  return nodes;\n}\n\nfunction element(tagName) {\n  return elementCache[tagName] || (elementCache[tagName] = createElement(tagName));\n}\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { capture, startCapturing, stopCapturing } from 'src/global/capture';\nimport { warnIfDebug } from 'utils/log';\nimport Model, { shared } from './Model';\nimport { maybeBind, noVirtual } from './ModelBase';\nimport ComputationChild from './ComputationChild';\nimport { hasConsole } from 'config/environment';\nimport { isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\n\nexport default class Computation extends Model {\n  constructor(parent, signature, key) {\n    super(parent, key);\n\n    this.signature = signature;\n\n    this.isReadonly = !this.signature.setter;\n    this.isComputed = true;\n\n    this.dependencies = [];\n\n    this.children = [];\n    this.childByKey = {};\n\n    this.deps = [];\n\n    this.dirty = true;\n\n    // TODO: is there a less hackish way to do this?\n    this.shuffle = undefined;\n  }\n\n  get setRoot() {\n    if (this.signature.setter) return this;\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      const old = this.value;\n      this.value = this.getValue();\n      // this may cause a view somewhere to update, so it must be in a runloop\n      if (!runloop.active()) {\n        runloop.start();\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n        runloop.end();\n      } else {\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n      }\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n      this.dirty = false;\n    }\n\n    // if capturing, this value needs to be unwrapped because it's for external use\n    return maybeBind(\n      this,\n      // if unwrap is supplied, it overrides capture\n      this.wrapper && (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture)\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  getContext() {\n    return this.parent.isRoot ? this.root.ractive : this.parent.get(false, noVirtual);\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      result = this.signature.getter.call(this.root.ractive, this.getContext(), this.getKeypath());\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n\n      // TODO this is all well and good in Chrome, but...\n      // ...also, should encapsulate this stuff better, and only\n      // show it if Ractive.DEBUG\n      if (hasConsole) {\n        if (console.groupCollapsed)\n          console.groupCollapsed(\n            '%cshow details',\n            'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n          );\n        const sig = this.signature;\n        console.error(\n          `${err.name}: ${err.message}\\n\\n${sig.getterString}${\n            sig.getterUseStack ? '\\n\\n' + err.stack : ''\n          }`\n        );\n        if (console.groupCollapsed) console.groupEnd();\n      }\n    }\n\n    const dependencies = stopCapturing();\n    if (this.parent.keypath && !~dependencies.indexOf(this.parent)) dependencies.push(this.parent);\n    this.setDependencies(dependencies);\n\n    return result;\n  }\n\n  mark() {\n    this.handleChange();\n  }\n\n  rebind(next, previous) {\n    // computations will grab all of their deps again automagically\n    if (next !== previous) this.handleChange();\n  }\n\n  set(value) {\n    if (this.isReadonly) {\n      throw new Error(`Cannot set read-only computed value '${this.key}'`);\n    }\n\n    this.signature.setter(value, this.getContext(), this.getKeypath());\n    this.mark();\n  }\n\n  setDependencies(dependencies) {\n    // unregister any soft dependencies we no longer have\n    let i = this.dependencies.length;\n    while (i--) {\n      const model = this.dependencies[i];\n      if (!~dependencies.indexOf(model)) model.unregister(this);\n    }\n\n    // and add any new ones\n    i = dependencies.length;\n    while (i--) {\n      const model = dependencies[i];\n      if (!~this.dependencies.indexOf(model)) model.register(this);\n    }\n\n    this.dependencies = dependencies;\n  }\n\n  teardown() {\n    let i = this.dependencies.length;\n    while (i--) {\n      if (this.dependencies[i]) this.dependencies[i].unregister(this);\n    }\n    if (this.parent.computed[this.key] === this) delete this.parent.computed[this.key];\n    super.teardown();\n  }\n}\n\nconst prototype = Computation.prototype;\nconst child = ComputationChild.prototype;\nprototype.handleChange = child.handleChange;\nprototype.joinKey = child.joinKey;\n\nshared.Computation = Computation;\n","import { removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport { warnIfDebug } from 'utils/log';\nimport Model from 'src/model/Model';\nimport Computation from 'src/model/Computation';\nimport { startCapturing, stopCapturing } from 'src/global/capture';\nimport getFunction from 'shared/getFunction';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from './resolveReference';\n\nexport default class ExpressionProxy extends Model {\n  constructor(fragment, template) {\n    super(fragment.ractive.viewmodel, null);\n\n    this.fragment = fragment;\n    this.template = template;\n\n    this.isReadonly = true;\n    this.isComputed = true;\n    this.dirty = true;\n\n    this.fn =\n      fragment.ractive.allowExpressions === false\n        ? noop\n        : getFunction(template.s, template.r.length);\n\n    this.models = this.template.r.map(ref => {\n      return resolveReference(this.fragment, ref);\n    });\n    this.dependencies = [];\n\n    this.shuffle = undefined;\n\n    this.bubble();\n  }\n\n  bubble(actuallyChanged = true) {\n    // refresh the keypath\n    this.keypath = undefined;\n\n    if (actuallyChanged) {\n      this.handleChange();\n    }\n  }\n\n  getKeypath() {\n    if (!this.template) return '@undefined';\n    if (!this.keypath) {\n      this.keypath =\n        '@' +\n        this.template.s.replace(/_(\\d+)/g, (match, i) => {\n          if (i >= this.models.length) return match;\n\n          const model = this.models[i];\n          return model ? model.getKeypath() : '@undefined';\n        });\n    }\n\n    return this.keypath;\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      const params = this.models.map(m => (m ? m.get(true) : undefined));\n      result = this.fn.apply(this.fragment.ractive, params);\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n    }\n\n    const dependencies = stopCapturing();\n    // remove missing deps\n    this.dependencies\n      .filter(d => !~dependencies.indexOf(d))\n      .forEach(d => {\n        d.unregister(this);\n        removeFromArray(this.dependencies, d);\n      });\n    // register new deps\n    dependencies\n      .filter(d => !~this.dependencies.indexOf(d))\n      .forEach(d => {\n        d.register(this);\n        this.dependencies.push(d);\n      });\n\n    return result;\n  }\n\n  notifyUpstream() {}\n\n  rebind(next, previous, safe) {\n    const idx = this.models.indexOf(previous);\n\n    if (~idx) {\n      next = rebindMatch(this.template.r[idx], next, previous);\n      if (next !== previous) {\n        previous.unregister(this);\n        this.models.splice(idx, 1, next);\n        if (next) next.addShuffleRegister(this, 'mark');\n      }\n    }\n    this.bubble(!safe);\n  }\n\n  rebound(update) {\n    this.models = this.template.r.map(ref => resolveReference(this.fragment, ref));\n    if (update) this.bubble(true);\n  }\n\n  retrieve() {\n    return this.get();\n  }\n\n  teardown() {\n    this.fragment = undefined;\n    if (this.dependencies) this.dependencies.forEach(d => d.unregister(this));\n    super.teardown();\n  }\n\n  unreference() {\n    super.unreference();\n    collect(this);\n  }\n\n  unregister(dep) {\n    super.unregister(dep);\n    collect(this);\n  }\n\n  unregisterLink(link) {\n    super.unregisterLink(link);\n    collect(this);\n  }\n}\n\nconst prototype = ExpressionProxy.prototype;\nconst computation = Computation.prototype;\nprototype.get = computation.get;\nprototype.handleChange = computation.handleChange;\nprototype.joinKey = computation.joinKey;\nprototype.mark = computation.mark;\nprototype.unbind = noop;\n\nfunction collect(model) {\n  if (!model.deps.length && !model.refs && !model.links.length) model.teardown();\n}\n","import { findInViewHierarchy } from 'shared/registry';\nimport { warnOnce } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport noop from 'utils/noop';\nimport runloop from 'src/global/runloop';\nimport findElement from '../shared/findElement';\nimport { setupArgsFn, teardownArgsFn } from '../shared/directiveArgs';\nimport Fragment from '../../Fragment';\nimport { localFragment } from 'src/shared/Context';\n\nconst missingDecorator = {\n  update: noop,\n  teardown: noop\n};\n\nexport default class Decorator {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.up = options.up || this.owner.up;\n    this.ractive = this.up.ractive || this.owner.ractive;\n    const template = (this.template = options.template);\n\n    this.name = template.n;\n\n    this.node = null;\n    this.handle = null;\n\n    this.element.decorators.push(this);\n  }\n\n  bind() {\n    // if the owner is the elment, make sure the context includes the element\n    const frag = this.element === this.owner ? new Fragment({ owner: this.owner }) : this.up;\n    setupArgsFn(this, this.template, frag, { register: true });\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      // decorators may be owned directly by an element or by a fragment if conditional\n      this.owner.bubble();\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n    this.shouldDestroy = true;\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebound(update) {\n    if (this.model) this.model.rebound(update);\n  }\n\n  render() {\n    this.shouldDestroy = false;\n    if (this.handle) this.unrender();\n    const ractive = this.ractive;\n    runloop.scheduleTask(() => {\n      // bail if the host element has managed to become unrendered\n      if (!this.element.rendered) return;\n\n      const fn = findInViewHierarchy('decorators', ractive, this.name);\n\n      if (!fn) {\n        warnOnce(missingPlugin(this.name, 'decorator'));\n        this.handle = missingDecorator;\n        return;\n      }\n\n      this.node = this.element.node;\n\n      const args = this.model ? this.model.get() : [];\n      localFragment.f = this.up;\n      this.handle = fn.apply(ractive, [this.node].concat(args));\n      localFragment.f = null;\n\n      if (!this.handle || !this.handle.teardown) {\n        throw new Error(\n          `The '${this.name}' decorator must return an object with a teardown method`\n        );\n      }\n\n      // watch out for decorators that cause their host element to be unrendered\n      if (this.shouldDestroy) this.destroyed();\n    }, true);\n  }\n\n  shuffled() {\n    if (this.handle && this.handle.shuffled) this.handle.shuffled();\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    teardownArgsFn(this, this.template);\n  }\n\n  unrender(shouldDestroy) {\n    if ((!shouldDestroy || this.element.rendered) && this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n  }\n\n  update() {\n    const instance = this.handle;\n\n    if (!this.dirty) {\n      if (instance && instance.invalidate) {\n        runloop.scheduleTask(() => instance.invalidate(), true);\n      }\n      return;\n    }\n\n    this.dirty = false;\n\n    if (instance) {\n      if (!instance.update) {\n        this.unrender();\n        this.render();\n      } else {\n        const args = this.model ? this.model.get() : [];\n        instance.update.apply(this.ractive, args);\n      }\n    }\n  }\n}\n\nDecorator.prototype.firstNode = noop;\n","import noop from 'utils/noop';\nimport Item from './shared/Item';\n\nexport default class Doctype extends Item {\n  toString() {\n    return '<!DOCTYPE' + this.template.a + '>';\n  }\n}\n\nconst proto = Doctype.prototype;\nproto.bind = proto.render = proto.teardown = proto.unbind = proto.unrender = proto.update = noop;\n","import runloop from 'src/global/runloop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport noop from 'utils/noop';\nimport findElement from '../../shared/findElement';\nimport { isUndefined } from 'utils/is';\n\nexport default class Binding {\n  constructor(element, name = 'value') {\n    this.element = element;\n    this.ractive = element.ractive;\n    this.attribute = element.attributeByName[name];\n\n    const interpolator = this.attribute.interpolator;\n    interpolator.twowayBinding = this;\n\n    const model = interpolator.model;\n\n    if (model.isReadonly && !model.setRoot) {\n      const keypath = model.getKeypath().replace(/^@/, '');\n      warnOnceIfDebug(\n        `Cannot use two-way binding on <${\n          element.name\n        }> element: ${keypath} is read-only. To suppress this warning use <${\n          element.name\n        } twoway='false'...>`,\n        { ractive: this.ractive }\n      );\n      return false;\n    }\n\n    this.attribute.isTwoway = true;\n    this.model = model;\n\n    // initialise value, if it's undefined\n    let value = model.get();\n    this.wasUndefined = isUndefined(value);\n\n    if (isUndefined(value) && this.getInitialValue) {\n      value = this.getInitialValue();\n      model.set(value);\n    }\n    this.lastVal(true, value);\n\n    const parentForm = findElement(this.element, false, 'form');\n    if (parentForm) {\n      this.resetValue = value;\n      parentForm.formBindings.push(this);\n    }\n  }\n\n  bind() {\n    this.model.registerTwowayBinding(this);\n  }\n\n  handleChange() {\n    const value = this.getValue();\n    if (this.lastVal() === value) return;\n\n    runloop.start();\n    this.attribute.locked = true;\n    this.model.set(value);\n    this.lastVal(true, value);\n\n    // if the value changes before observers fire, unlock to be updatable cause something weird and potentially freezy is up\n    if (this.model.get() !== value) this.attribute.locked = false;\n    else runloop.scheduleTask(() => (this.attribute.locked = false));\n\n    runloop.end();\n  }\n\n  lastVal(setting, value) {\n    if (setting) this.lastValue = value;\n    else return this.lastValue;\n  }\n\n  rebind(next, previous) {\n    if (this.model && this.model === previous) previous.unregisterTwowayBinding(this);\n    if (next) {\n      this.model = next;\n      runloop.scheduleTask(() => next.registerTwowayBinding(this));\n    }\n  }\n\n  rebound() {\n    if (this.model) this.model.unregisterTwowayBinding(this);\n    this.model = this.attribute.interpolator.model;\n    this.model && this.model.registerTwowayBinding(this);\n  }\n\n  render() {\n    this.node = this.element.node;\n    this.node._ractive.binding = this;\n    this.rendered = true; // TODO is this used anywhere?\n  }\n\n  setFromNode(node) {\n    this.model.set(node.value);\n  }\n\n  unbind() {\n    this.model && this.model.unregisterTwowayBinding(this);\n  }\n}\n\nBinding.prototype.unrender = noop;\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class CheckboxBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.off('click', handleDomEvent);\n    }\n  }\n\n  getInitialValue() {\n    return !!this.element.getAttribute('checked');\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\n\nexport default function getBindingGroup(group, model, getValue) {\n  const hash = `${group}-bindingGroup`;\n  return model[hash] || (model[hash] = new BindingGroup(hash, model, getValue));\n}\n\nclass BindingGroup {\n  constructor(hash, model, getValue) {\n    this.model = model;\n    this.hash = hash;\n    this.getValue = () => {\n      this.value = getValue.call(this);\n      return this.value;\n    };\n\n    this.bindings = [];\n  }\n\n  add(binding) {\n    this.bindings.push(binding);\n  }\n\n  bind() {\n    this.value = this.model.get();\n    this.bindings.forEach(b => b.lastVal(true, this.value));\n    this.model.registerTwowayBinding(this);\n    this.bound = true;\n  }\n\n  remove(binding) {\n    removeFromArray(this.bindings, binding);\n    if (!this.bindings.length) {\n      this.unbind();\n    }\n  }\n\n  unbind() {\n    this.model.unregisterTwowayBinding(this);\n    this.bound = false;\n    delete this.model[this.hash];\n  }\n}\n\nBindingGroup.prototype.rebind = Binding.prototype.rebind;\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\nimport { isArray } from 'utils/is';\n\nconst push = [].push;\n\nfunction getValue() {\n  const all = this.bindings\n    .filter(b => b.node && b.node.checked)\n    .map(b => b.element.getAttribute('value'));\n  const res = [];\n  all.forEach(v => {\n    if (!this.bindings[0].arrayContains(res, v)) res.push(v);\n  });\n  return res;\n}\n\nexport default class CheckboxNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n    // Each input has a reference to an array containing it and its\n    // group, as two-way binding depends on being able to ascertain\n    // the status of all inputs within the group\n    this.group = getBindingGroup('checkboxes', this.model, getValue);\n    this.group.add(this);\n\n    if (this.noInitialValue) {\n      this.group.noInitialValue = true;\n    }\n\n    // If no initial value was set, and this input is checked, we\n    // update the model\n    if (this.group.noInitialValue && this.element.getAttribute('checked')) {\n      const existingValue = this.model.get();\n      const bindingValue = this.element.getAttribute('value');\n\n      if (!this.arrayContains(existingValue, bindingValue)) {\n        push.call(existingValue, bindingValue); // to avoid triggering runloop with array adaptor\n      }\n    }\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n  }\n\n  getInitialValue() {\n    // This only gets called once per group (of inputs that\n    // share a name), because it only gets called if there\n    // isn't an initial value. By the same token, we can make\n    // a note of that fact that there was no initial value,\n    // and populate it using any `checked` attributes that\n    // exist (which users should avoid, but which we should\n    // support anyway to avoid breaking expectations)\n    this.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\n    return [];\n  }\n\n  getValue() {\n    return this.group.value;\n  }\n\n  handleChange() {\n    this.isChecked = this.element.node.checked;\n    const mval = this.model.get();\n    this.group.value = mval === undefined ? [] : mval.slice();\n    const value = this.element.getAttribute('value');\n    if (this.isChecked && !this.arrayContains(this.group.value, value)) {\n      this.group.value.push(value);\n    } else if (!this.isChecked && this.arrayContains(this.group.value, value)) {\n      this.removeFromArray(this.group.value, value);\n    }\n    // make sure super knows there's a change\n    this.lastValue = null;\n    super.handleChange();\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    const existingValue = this.model.get();\n    const bindingValue = this.element.getAttribute('value');\n\n    if (isArray(existingValue)) {\n      this.isChecked = this.arrayContains(existingValue, bindingValue);\n    } else {\n      this.isChecked = this.element.compare(existingValue, bindingValue);\n    }\n    node.name = '{{' + this.model.getKeypath() + '}}';\n    node.checked = this.isChecked;\n\n    this.element.on('change', handleDomEvent);\n\n    // in case of IE emergency, bind to click event as well\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.group.bindings.forEach(binding => (binding.wasUndefined = true));\n\n    if (node.checked) {\n      const valueSoFar = this.group.getValue();\n      valueSoFar.push(this.element.getAttribute('value'));\n\n      this.group.model.set(valueSoFar);\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      el.off('click', handleDomEvent);\n    }\n  }\n\n  arrayContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.element.compare(optionValue, selectValue[i])) return true;\n    }\n    return false;\n  }\n\n  removeFromArray(array, item) {\n    if (!array) return;\n    let i = array.length;\n    while (i--) {\n      if (this.element.compare(item, array[i])) {\n        array.splice(i, 1);\n      }\n    }\n  }\n}\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class ContentEditableBinding extends Binding {\n  getInitialValue() {\n    return this.element.fragment ? this.element.fragment.toString() : '';\n  }\n\n  getValue() {\n    return this.element.node.innerHTML;\n  }\n\n  render() {\n    super.render();\n\n    const el = this.element;\n\n    el.on('change', handleDomEvent);\n    el.on('blur', handleDomEvent);\n\n    if (!this.ractive.lazy) {\n      el.on('input', handleDomEvent);\n\n      if (this.node.attachEvent) {\n        el.on('keyup', handleDomEvent);\n      }\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.innerHTML);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('blur', handleDomEvent);\n    el.off('change', handleDomEvent);\n    el.off('input', handleDomEvent);\n    el.off('keyup', handleDomEvent);\n  }\n}\n","import { isNumeric } from 'utils/is';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nfunction handleBlur() {\n  handleDomEvent.call(this);\n\n  const value = this._ractive.binding.model.get();\n  this.value = value == undefined ? '' : value;\n}\n\nfunction handleDelay(delay) {\n  let timeout;\n\n  return function() {\n    if (timeout) clearTimeout(timeout);\n\n    timeout = setTimeout(() => {\n      const binding = this._ractive.binding;\n      if (binding.rendered) handleDomEvent.call(this);\n      timeout = null;\n    }, delay);\n  };\n}\n\nexport default class GenericBinding extends Binding {\n  getInitialValue() {\n    return '';\n  }\n\n  getValue() {\n    return this.node.value;\n  }\n\n  render() {\n    super.render();\n\n    // any lazy setting for this element overrides the root\n    // if the value is a number, it's a timeout\n    let lazy = this.ractive.lazy;\n    let timeout = false;\n    const el = this.element;\n\n    if ('lazy' in this.element) {\n      lazy = this.element.lazy;\n    }\n\n    if (isNumeric(lazy)) {\n      timeout = +lazy;\n      lazy = false;\n    }\n\n    this.handler = timeout ? handleDelay(timeout) : handleDomEvent;\n\n    const node = this.node;\n\n    el.on('change', handleDomEvent);\n\n    if (node.type !== 'file') {\n      if (!lazy) {\n        el.on('input', this.handler);\n\n        // IE is a special snowflake\n        if (node.attachEvent) {\n          el.on('keyup', this.handler);\n        }\n      }\n\n      el.on('blur', handleBlur);\n    }\n  }\n\n  unrender() {\n    const el = this.element;\n    this.rendered = false;\n\n    el.off('change', handleDomEvent);\n    el.off('input', this.handler);\n    el.off('keyup', this.handler);\n    el.off('blur', handleBlur);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class FileBinding extends GenericBinding {\n  getInitialValue() {\n    /* istanbul ignore next */\n    return undefined;\n  }\n\n  getValue() {\n    /* istanbul ignore next */\n    return this.node.files;\n  }\n\n  render() {\n    /* istanbul ignore next */\n    this.element.lazy = false;\n    /* istanbul ignore next */\n    super.render();\n  }\n\n  setFromNode(node) {\n    /* istanbul ignore next */\n    this.model.set(node.files);\n  }\n}\n","import { arrayContentsMatch } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\nimport { isUndefined } from 'utils/is';\n\nexport default class MultipleSelectBinding extends Binding {\n  getInitialValue() {\n    return this.element.options\n      .filter(option => option.getAttribute('selected'))\n      .map(option => option.getAttribute('value'));\n  }\n\n  getValue() {\n    const options = this.element.node.options;\n    const len = options.length;\n\n    const selectedValues = [];\n\n    for (let i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (option.selected) {\n        const optionValue = option._ractive ? option._ractive.value : option.value;\n        selectedValues.push(optionValue);\n      }\n    }\n\n    return selectedValues;\n  }\n\n  handleChange() {\n    const attribute = this.attribute;\n    const previousValue = attribute.getValue();\n\n    const value = this.getValue();\n\n    if (isUndefined(previousValue) || !arrayContentsMatch(value, previousValue)) {\n      super.handleChange();\n    }\n\n    return this;\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (isUndefined(this.model.get())) {\n      // get value from DOM, if possible\n      this.handleChange();\n    }\n  }\n\n  setFromNode(node) {\n    const selectedOptions = getSelectedOptions(node);\n    let i = selectedOptions.length;\n    const result = new Array(i);\n\n    while (i--) {\n      const option = selectedOptions[i];\n      result[i] = option._ractive ? option._ractive.value : option.value;\n    }\n\n    this.model.set(result);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class NumericBinding extends GenericBinding {\n  getInitialValue() {\n    return undefined;\n  }\n\n  getValue() {\n    const value = parseFloat(this.node.value);\n    return isNaN(value) ? undefined : value;\n  }\n\n  setFromNode(node) {\n    const value = parseFloat(node.value);\n    if (!isNaN(value)) this.model.set(value);\n  }\n}\n","import runloop from 'src/global/runloop';\nimport { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nconst siblings = {};\n\nfunction getSiblings(hash) {\n  return siblings[hash] || (siblings[hash] = []);\n}\n\nexport default class RadioBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n\n    this.siblings = getSiblings(this.ractive._guid + this.element.getAttribute('name'));\n    this.siblings.push(this);\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  handleChange() {\n    runloop.start();\n\n    this.siblings.forEach(binding => {\n      binding.model.set(binding.getValue());\n    });\n\n    runloop.end();\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n\n  unbind() {\n    removeFromArray(this.siblings, this);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.off('click', handleDomEvent);\n    }\n  }\n}\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\n\nfunction getValue() {\n  const checked = this.bindings.filter(b => b.node.checked);\n  if (checked.length > 0) {\n    return checked[0].element.getAttribute('value');\n  }\n}\n\nexport default class RadioNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.group = getBindingGroup('radioname', this.model, getValue);\n    this.group.add(this);\n\n    if (element.checked) {\n      this.group.value = this.getValue();\n    }\n\n    this.attribute.interpolator.pathChanged = () => this.updateName();\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('checked')) {\n      return this.element.getAttribute('value');\n    }\n  }\n\n  getValue() {\n    return this.element.getAttribute('value');\n  }\n\n  handleChange() {\n    // If this <input> is the one that's checked, then the value of its\n    // `name` model gets set to its value\n    if (this.node.checked) {\n      this.group.value = this.getValue();\n      super.handleChange();\n    }\n\n    this.updateName();\n  }\n\n  lastVal(setting, value) {\n    if (!this.group) return;\n    if (setting) this.group.lastValue = value;\n    else return this.group.lastValue;\n  }\n\n  rebind(next, previous) {\n    super.rebind(next, previous);\n    this.updateName();\n  }\n\n  rebound(update) {\n    super.rebound(update);\n    this.updateName();\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    this.updateName();\n    node.checked = this.element.compare(this.model.get(), this.element.getAttribute('value'));\n\n    this.element.on('change', handleDomEvent);\n\n    if (node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    if (node.checked) {\n      this.group.model.set(this.element.getAttribute('value'));\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      el.off('click', handleDomEvent);\n    }\n  }\n\n  updateName() {\n    if (this.node) this.node.name = `{{${this.model.getKeypath()}}}`;\n  }\n}\n","import runloop from 'src/global/runloop';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class SingleSelectBinding extends Binding {\n  forceUpdate() {\n    const value = this.getValue();\n\n    if (value !== undefined) {\n      this.attribute.locked = true;\n      runloop.scheduleTask(() => (this.attribute.locked = false));\n      this.model.set(value);\n    }\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('value') !== undefined) {\n      return;\n    }\n\n    const options = this.element.options;\n    const len = options.length;\n\n    if (!len) return;\n\n    let value;\n    let optionWasSelected;\n    let i = len;\n\n    // take the final selected option...\n    while (i--) {\n      const option = options[i];\n\n      if (option.getAttribute('selected')) {\n        if (!option.getAttribute('disabled')) {\n          value = option.getAttribute('value');\n        }\n\n        optionWasSelected = true;\n        break;\n      }\n    }\n\n    // or the first non-disabled option, if none are selected\n    if (!optionWasSelected) {\n      while (++i < len) {\n        if (!options[i].getAttribute('disabled')) {\n          value = options[i].getAttribute('value');\n          break;\n        }\n      }\n    }\n\n    // This is an optimisation (aka hack) that allows us to forgo some\n    // other more expensive work\n    // TODO does it still work? seems at odds with new architecture\n    if (value !== undefined) {\n      this.element.attributeByName.value.value = value;\n    }\n\n    return value;\n  }\n\n  getValue() {\n    const options = this.node.options;\n    const len = options.length;\n\n    let i;\n    for (i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (options[i].selected && !options[i].disabled) {\n        return option._ractive ? option._ractive.value : option.value;\n      }\n    }\n  }\n\n  render() {\n    super.render();\n    this.element.on('change', handleDomEvent);\n  }\n\n  setFromNode(node) {\n    const option = getSelectedOptions(node)[0];\n    this.model.set(option._ractive ? option._ractive.value : option.value);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import { ATTRIBUTE, BINDING_FLAG, DECORATOR, DELEGATE_FLAG, EVENT, TRANSITION } from 'config/types';\nimport { win } from 'config/environment';\nimport { html, svg } from 'config/namespaces';\nimport { toArray, addToArray, removeFromArray } from 'utils/array';\nimport { escapeHtml, voidElements } from 'utils/html';\nimport { createElement, detachNode, matches, safeAttributeString } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport Context from 'shared/Context';\nimport { destroyed, shuffled } from 'shared/methodCallers';\nimport { ContainerItem } from './shared/Item';\nimport Fragment from '../Fragment';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport findElement from './shared/findElement';\nimport selectBinding from './element/binding/selectBinding';\nimport { assign, create, defineProperty, keys } from 'utils/object';\nimport { isString } from 'utils/is';\n\nconst endsWithSemi = /;\\s*$/;\n\nexport default class Element extends ContainerItem {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.e.toLowerCase();\n\n    // find parent element\n    this.parent = findElement(this.up, false);\n\n    if (this.parent && this.parent.name === 'option') {\n      throw new Error(\n        `An <option> element cannot contain other elements (encountered <${this.name}>)`\n      );\n    }\n\n    this.decorators = [];\n\n    // create attributes\n    this.attributeByName = {};\n\n    let attrs;\n    let n, attr, val, cls, name, template, leftovers;\n\n    const m = this.template.m;\n    const len = (m && m.length) || 0;\n\n    for (let i = 0; i < len; i++) {\n      template = m[i];\n      if (template.g) {\n        (this.statics || (this.statics = {}))[template.n] = isString(template.f)\n          ? template.f\n          : template.n;\n      } else {\n        switch (template.t) {\n          case ATTRIBUTE:\n          case BINDING_FLAG:\n          case DECORATOR:\n          case EVENT:\n          case TRANSITION:\n            attr = createItem({\n              owner: this,\n              up: this.up,\n              template\n            });\n\n            n = template.n;\n\n            attrs = attrs || (attrs = this.attributes = []);\n\n            if (n === 'value') val = attr;\n            else if (n === 'name') name = attr;\n            else if (n === 'class') cls = attr;\n            else attrs.push(attr);\n\n            break;\n\n          case DELEGATE_FLAG:\n            this.delegate = false;\n            break;\n\n          default:\n            (leftovers || (leftovers = [])).push(template);\n            break;\n        }\n      }\n    }\n\n    if (val) attrs.push(val);\n    if (name) attrs.push(name);\n    if (cls) attrs.unshift(cls);\n\n    if (leftovers) {\n      (attrs || (this.attributes = [])).push(\n        new ConditionalAttribute({\n          owner: this,\n          up: this.up,\n          template: leftovers\n        })\n      );\n\n      // empty leftovers array\n      leftovers = [];\n    }\n\n    // create children\n    if (options.template.f && !options.deferContent) {\n      this.fragment = new Fragment({\n        template: options.template.f,\n        owner: this,\n        cssIds: null\n      });\n    }\n\n    this.binding = null; // filled in later\n  }\n\n  bind() {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.binding = true;\n      const len = attrs.length;\n      for (let i = 0; i < len; i++) attrs[i].bind();\n      attrs.binding = false;\n    }\n\n    if (this.fragment) this.fragment.bind();\n\n    // create two-way binding if necessary\n    if (!this.binding) this.recreateTwowayBinding();\n    else this.binding.bind();\n  }\n\n  createTwowayBinding() {\n    if ('twoway' in this ? this.twoway : this.ractive.twoway) {\n      const Binding = selectBinding(this);\n      if (Binding) {\n        const binding = new Binding(this);\n        if (binding && binding.model) return binding;\n      }\n    }\n  }\n\n  destroyed() {\n    if (this.attributes) this.attributes.forEach(destroyed);\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  detach() {\n    // if this element is no longer rendered, the transitions are complete and the attributes can be torn down\n    if (!this.rendered) this.destroyed();\n\n    return detachNode(this.node);\n  }\n\n  find(selector, options) {\n    if (this.node && matches(this.node, selector)) return this.node;\n    if (this.fragment) {\n      return this.fragment.find(selector, options);\n    }\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n\n    if (matches(this.node, selector)) {\n      result.push(this.node);\n    }\n\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findNextNode() {\n    return null;\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getAttribute(name) {\n    if (this.statics && name in this.statics) return this.statics[name];\n    const attribute = this.attributeByName[name];\n    return attribute ? attribute.getValue() : undefined;\n  }\n\n  getContext(...assigns) {\n    if (this.fragment) return this.fragment.getContext(...assigns);\n\n    if (!this.ctx) this.ctx = new Context(this.up, this);\n    assigns.unshift(create(this.ctx));\n    return assign.apply(null, assigns);\n  }\n\n  off(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = this.listeners && this.listeners[event];\n\n    if (!ref) return;\n    removeFromArray(ref, callback);\n\n    if (delegate) {\n      const listeners =\n        (delegate.listeners || (delegate.listeners = [])) &&\n        (delegate.listeners[event] || (delegate.listeners[event] = []));\n      if (listeners.refs && !--listeners.refs) delegate.off(event, delegateHandler, true);\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        rem.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, true);\n        add.call(n, event, handler, false);\n      }\n    }\n  }\n\n  on(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = (this.listeners || (this.listeners = {}))[event] || (this.listeners[event] = []);\n\n    if (delegate) {\n      const listeners =\n        ((delegate.listeners || (delegate.listeners = [])) && delegate.listeners[event]) ||\n        (delegate.listeners[event] = []);\n      if (!listeners.refs) {\n        listeners.refs = 0;\n        delegate.on(event, delegateHandler, true);\n        listeners.refs++;\n      } else {\n        listeners.refs++;\n      }\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        add.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, false);\n        add.call(n, event, handler, true);\n      }\n    }\n\n    addToArray(this.listeners[event], callback);\n  }\n\n  recreateTwowayBinding() {\n    if (this.binding) {\n      this.binding.unbind();\n      this.binding.unrender();\n    }\n\n    if ((this.binding = this.createTwowayBinding())) {\n      this.binding.bind();\n      if (this.rendered) this.binding.render();\n    }\n  }\n\n  rebound(update) {\n    super.rebound(update);\n    if (this.attributes) this.attributes.forEach(x => x.rebound(update));\n    if (this.binding) this.binding.rebound(update);\n  }\n\n  render(target, occupants) {\n    // TODO determine correct namespace\n    this.namespace = getNamespace(this);\n\n    let node;\n    let existing = false;\n\n    if (occupants) {\n      let n;\n      while ((n = occupants.shift())) {\n        if (\n          n.nodeName.toUpperCase() === this.template.e.toUpperCase() &&\n          n.namespaceURI === this.namespace\n        ) {\n          this.node = node = n;\n          existing = true;\n          break;\n        } else {\n          detachNode(n);\n        }\n      }\n    }\n\n    if (!existing && this.node) {\n      node = this.node;\n      target.appendChild(node);\n      existing = true;\n    }\n\n    if (!node) {\n      const name = this.template.e;\n      node = createElement(\n        this.namespace === html ? name.toLowerCase() : name,\n        this.namespace,\n        this.getAttribute('is')\n      );\n      this.node = node;\n    }\n\n    // tie the node to this vdom element\n    defineProperty(node, '_ractive', {\n      value: {\n        proxy: this\n      },\n      configurable: true\n    });\n\n    if (this.statics) {\n      keys(this.statics).forEach(k => {\n        node.setAttribute(k, this.statics[k]);\n      });\n    }\n\n    if (existing && this.foundNode) this.foundNode(node);\n\n    // register intro before rendering content so children can find the intro\n    const intro = this.intro;\n    if (intro && intro.shouldFire('intro')) {\n      intro.isIntro = true;\n      intro.isOutro = false;\n      runloop.registerTransition(intro);\n    }\n\n    if (this.fragment) {\n      const children = existing ? toArray(node.childNodes) : undefined;\n\n      this.fragment.render(node, children);\n\n      // clean up leftover children\n      if (children) {\n        children.forEach(detachNode);\n      }\n    }\n\n    if (existing) {\n      // store initial values for two-way binding\n      if (this.binding && this.binding.wasUndefined) this.binding.setFromNode(node);\n      // remove unused attributes\n      let i = node.attributes.length;\n      while (i--) {\n        const name = node.attributes[i].name;\n        if (!(name in this.attributeByName) && (!this.statics || !(name in this.statics)))\n          node.removeAttribute(name);\n      }\n    }\n\n    // Is this a top-level node of a component? If so, we may need to add\n    // a data-ractive-css attribute, for CSS encapsulation\n    if (this.up.cssIds) {\n      node.setAttribute('data-ractive-css', this.up.cssIds.map(x => `{${x}}`).join(' '));\n    }\n\n    if (this.attributes) {\n      const len = this.attributes.length;\n      for (let i = 0; i < len; i++) this.attributes[i].render();\n    }\n    if (this.binding) this.binding.render();\n\n    if (!this.up.delegate && this.listeners) {\n      const ls = this.listeners;\n      for (const k in ls) {\n        if (ls[k] && ls[k].length) this.node.addEventListener(k, handler, !!ls[k].refs);\n      }\n    }\n\n    if (!existing) {\n      target.appendChild(node);\n    }\n\n    this.rendered = true;\n  }\n\n  shuffled() {\n    super.shuffled();\n    this.decorators.forEach(shuffled);\n  }\n\n  toString() {\n    const tagName = this.template.e;\n\n    let attrs = (this.attributes && this.attributes.map(stringifyAttribute).join('')) || '';\n\n    if (this.statics)\n      keys(this.statics).forEach(\n        k =>\n          k !== 'class' &&\n          k !== 'style' &&\n          (attrs = ` ${k}=\"${safeAttributeString(this.statics[k])}\"` + attrs)\n      );\n\n    // Special case - selected options\n    if (this.name === 'option' && this.isSelected()) {\n      attrs += ' selected';\n    }\n\n    // Special case - two-way radio name bindings\n    if (this.name === 'input' && inputIsCheckedRadio(this)) {\n      attrs += ' checked';\n    }\n\n    // Special case style and class attributes and directives\n    let style = this.statics ? this.statics.style : undefined;\n    let cls = this.statics ? this.statics.class : undefined;\n    this.attributes &&\n      this.attributes.forEach(attr => {\n        if (attr.name === 'class') {\n          cls = (cls || '') + (cls ? ' ' : '') + safeAttributeString(attr.getString());\n        } else if (attr.name === 'style') {\n          style = (style || '') + (style ? ' ' : '') + safeAttributeString(attr.getString());\n          if (style && !endsWithSemi.test(style)) style += ';';\n        } else if (attr.style) {\n          style =\n            (style || '') +\n            (style ? ' ' : '') +\n            `${attr.style}: ${safeAttributeString(attr.getString())};`;\n        } else if (attr.inlineClass && attr.getValue()) {\n          cls = (cls || '') + (cls ? ' ' : '') + attr.inlineClass;\n        }\n      });\n    // put classes first, then inline style\n    if (style !== undefined) attrs = ' style' + (style ? `=\"${style}\"` : '') + attrs;\n    if (cls !== undefined) attrs = ' class' + (cls ? `=\"${cls}\"` : '') + attrs;\n\n    if (this.up.cssIds) {\n      attrs += ` data-ractive-css=\"${this.up.cssIds.map(x => `{${x}}`).join(' ')}\"`;\n    }\n\n    let str = `<${tagName}${attrs}>`;\n\n    if (voidElements[this.name.toLowerCase()]) return str;\n\n    // Special case - textarea\n    if (this.name === 'textarea' && this.getAttribute('value') !== undefined) {\n      str += escapeHtml(this.getAttribute('value'));\n    } else if (this.getAttribute('contenteditable') !== undefined) {\n      // Special case - contenteditable\n      str += this.getAttribute('value') || '';\n    }\n\n    if (this.fragment) {\n      str += this.fragment.toString(!/^(?:script|style)$/i.test(this.template.e)); // escape text unless script/style\n    }\n\n    str += `</${tagName}>`;\n    return str;\n  }\n\n  unbind(view) {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.unbinding = true;\n      const len = attrs.length;\n      for (let i = 0; i < len; i++) attrs[i].unbind(view);\n      attrs.unbinding = false;\n    }\n\n    if (this.binding) this.binding.unbind(view);\n    if (this.fragment) this.fragment.unbind(view);\n  }\n\n  unrender(shouldDestroy) {\n    if (!this.rendered) return;\n    this.rendered = false;\n\n    // unrendering before intro completed? complete it now\n    // TODO should be an API for aborting transitions\n    const transition = this.intro;\n    if (transition && transition.complete) transition.complete();\n\n    // Detach as soon as we can\n    if (this.name === 'option') {\n      // <option> elements detach immediately, so that\n      // their parent <select> element syncs correctly, and\n      // since option elements can't have transitions anyway\n      this.detach();\n    } else if (shouldDestroy) {\n      runloop.detachWhenReady(this);\n    }\n\n    // outro transition\n    const outro = this.outro;\n    if (outro && outro.shouldFire('outro')) {\n      outro.isIntro = false;\n      outro.isOutro = true;\n      runloop.registerTransition(outro);\n    }\n\n    if (this.fragment) this.fragment.unrender();\n\n    if (this.binding) this.binding.unrender();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n\n      const attrs = this.attributes;\n      if (attrs) {\n        const len = attrs.length;\n        for (let i = 0; i < len; i++) attrs[i].update();\n      }\n\n      if (this.fragment) this.fragment.update();\n    }\n  }\n}\n\nfunction inputIsCheckedRadio(element) {\n  const nameAttr = element.attributeByName.name;\n  return (\n    element.getAttribute('type') === 'radio' &&\n    (nameAttr || {}).interpolator &&\n    element.getAttribute('value') === nameAttr.interpolator.model.get()\n  );\n}\n\nfunction stringifyAttribute(attribute) {\n  const str = attribute.toString();\n  return str ? ' ' + str : '';\n}\n\nfunction getNamespace(element) {\n  // Use specified namespace...\n  const xmlns = element.getAttribute('xmlns');\n  if (xmlns) return xmlns;\n\n  // ...or SVG namespace, if this is an <svg> element\n  if (element.name === 'svg') return svg;\n\n  const parent = element.parent;\n\n  if (parent) {\n    // ...or HTML, if the parent is a <foreignObject>\n    if (parent.name === 'foreignobject') return html;\n\n    // ...or inherit from the parent node\n    return parent.node.namespaceURI;\n  }\n\n  return element.ractive.el.namespaceURI;\n}\n\nlet stop = false;\nfunction stopPropagation() {\n  stop = true;\n}\nlet immediate = false;\nfunction stopImmediatePropagation() {\n  immediate = true;\n}\nlet prevent = false;\nfunction preventDefault() {\n  prevent = true;\n}\n\nfunction delegateHandler(ev) {\n  const name = ev.type;\n  const end = ev.currentTarget;\n  const endEl = end._ractive && end._ractive.proxy;\n  let node = ev.target;\n  let bubble = true;\n  let listeners;\n  let prevented = false;\n\n  stop = immediate = prevent = false;\n  const oldStop = ev.stopPropagation;\n  const oldImmediate = ev.stopImmediatePropagation;\n  const oldPrevent = ev.preventDefault;\n  ev.stopPropagation = stopPropagation;\n  ev.stopImmediatePropagation = stopImmediatePropagation;\n  ev.preventDefault = preventDefault;\n\n  // starting with the origin node, walk up the DOM looking for ractive nodes with a matching event listener\n  while (bubble && node && node !== end) {\n    const proxy = node._ractive && node._ractive.proxy;\n    if (proxy && proxy.up.delegate === endEl && shouldFire(ev, node, end)) {\n      listeners = proxy.listeners && proxy.listeners[name];\n\n      if (listeners) {\n        const len = listeners.length;\n        for (let i = 0; i < len; i++) {\n          bubble = listeners[i].call(node, ev) !== false && bubble;\n          if (immediate) {\n            bubble = false;\n            break;\n          }\n          if (stop) bubble = false;\n          if (prevent && !prevented) {\n            prevented = true;\n            oldPrevent.call(ev);\n          }\n        }\n      }\n    }\n\n    node = node.parentNode || node.correspondingUseElement; // SVG with a <use> element in certain environments\n  }\n\n  if (bubble) bubble = !stop && !immediate;\n\n  if (stop) oldStop.call(ev);\n  if (immediate) oldImmediate.call(ev);\n\n  ev.stopPropagation = oldStop;\n  ev.stopImmediaitePropagation = oldImmediate;\n  ev.preventDefault = oldPrevent;\n\n  return bubble;\n}\n\nconst UIEvent = win !== null ? win.UIEvent : null;\nfunction shouldFire(event, start, end) {\n  if (UIEvent && event instanceof UIEvent) {\n    let node = start;\n    while (node && node !== end) {\n      if (node.disabled) return false;\n      node = node.parentNode || node.correspondingUseElement;\n    }\n  }\n\n  return true;\n}\n\nfunction handler(ev) {\n  const el = this._ractive.proxy;\n  let listeners;\n  if (el.listeners && (listeners = el.listeners[ev.type])) {\n    const len = listeners.length;\n    for (let i = 0; i < len; i++) listeners[i] && listeners[i].call(this, ev);\n  }\n}\n","import runloop from 'src/global/runloop';\nimport Element from '../../Element';\n\nexport default class Form extends Element {\n  constructor(options) {\n    super(options);\n    this.formBindings = [];\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.on('reset', handleReset);\n  }\n\n  unrender(shouldDestroy) {\n    this.off('reset', handleReset);\n    super.unrender(shouldDestroy);\n  }\n}\n\nfunction handleReset() {\n  const element = this._ractive.proxy;\n\n  runloop.start();\n  element.formBindings.forEach(updateModel);\n  runloop.end();\n}\n\nfunction updateModel(binding) {\n  binding.model.set(binding.resetValue);\n}\n","import { fatal } from 'utils/log';\nimport runloop from 'src/global/runloop';\nimport { localFragment } from 'src/shared/Context';\n\nclass DOMEvent {\n  constructor(name, owner) {\n    if (name.indexOf('*') !== -1) {\n      fatal(\n        `Only component proxy-events may contain \"*\" wildcards, <${\n          owner.name\n        } on-${name}=\"...\"/> is not valid`\n      );\n    }\n\n    this.name = name;\n    this.owner = owner;\n    this.handler = null;\n  }\n\n  bind() {}\n\n  render(directive) {\n    const name = this.name;\n\n    const register = () => {\n      const node = this.owner.node;\n\n      this.owner.on(\n        name,\n        (this.handler = event => {\n          return directive.fire({\n            node,\n            original: event,\n            event,\n            name\n          });\n        })\n      );\n    };\n\n    if (name !== 'load') {\n      // schedule events so that they take place after twoway binding\n      runloop.scheduleTask(register, true);\n    } else {\n      // unless its a load event\n      register();\n    }\n  }\n\n  unbind() {}\n\n  unrender() {\n    if (this.handler) this.owner.off(this.name, this.handler);\n  }\n}\n\nclass CustomEvent {\n  constructor(eventPlugin, owner, name, args) {\n    this.eventPlugin = eventPlugin;\n    this.owner = owner;\n    this.name = name;\n    this.handler = null;\n    this.args = args;\n  }\n\n  bind() {}\n\n  render(directive) {\n    runloop.scheduleTask(() => {\n      const node = this.owner.node;\n\n      localFragment.f = directive.up;\n      this.handler = this.eventPlugin.apply(\n        this.owner.ractive,\n        [\n          node,\n          (event = {}) => {\n            if (event.original) event.event = event.original;\n            else event.original = event.event;\n\n            event.name = this.name;\n            event.node = event.node || node;\n            return directive.fire(event);\n          }\n        ].concat(this.args || [])\n      );\n      localFragment.f = null;\n    });\n  }\n\n  unbind() {}\n\n  unrender() {\n    if (this.handler) this.handler.teardown();\n    else runloop.scheduleTask(() => this.handler && this.handler.teardown());\n  }\n}\n\nexport { DOMEvent, CustomEvent };\n","import Context from '../../../shared/Context';\n\nexport default class RactiveEvent {\n  constructor(component, name) {\n    this.component = component;\n    this.name = name;\n    this.handler = null;\n  }\n\n  bind(directive) {\n    const ractive = this.component.instance;\n\n    this.handler = ractive.on(this.name, (...args) => {\n      // watch for reproxy\n      if (args[0] instanceof Context) {\n        const ctx = args.shift();\n        ctx.component = ractive;\n        directive.fire(ctx, args);\n      } else {\n        directive.fire({}, args);\n      }\n\n      // cancel bubbling\n      return false;\n    });\n  }\n\n  render() {}\n\n  unbind() {\n    this.handler.cancel();\n  }\n\n  unrender() {}\n}\n","import { ANCHOR, COMPONENT } from 'config/types';\nimport { warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport fireEvent from 'src/events/fireEvent';\nimport { splitKeypath } from 'shared/keypaths';\nimport { findInViewHierarchy } from 'shared/registry';\nimport findElement from './findElement';\nimport { DOMEvent, CustomEvent } from '../element/ElementEvents';\nimport RactiveEvent from '../component/RactiveEvent';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport Context from 'src/shared/Context';\nimport { isArray, isString } from 'utils/is';\nimport getFunction from 'shared/getFunction';\nimport resolveReference from '../../resolvers/resolveReference';\n\nconst specialPattern = /^(event|arguments|@node|@event|@context)(\\..+)?$/;\nconst dollarArgsPattern = /^\\$(\\d+)(\\..+)?$/;\n\nexport default class EventDirective {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up, true);\n    this.template = options.template;\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n    this.events = [];\n  }\n\n  bind() {\n    // sometimes anchors will cause an unbind without unrender\n    if (this.events.length) {\n      this.events.forEach(e => e.unrender());\n      this.events = [];\n    }\n\n    if (this.element.type === COMPONENT || this.element.type === ANCHOR) {\n      this.template.n.forEach(n => {\n        this.events.push(new RactiveEvent(this.element, n));\n      });\n    } else {\n      let args;\n      if ((args = this.template.a)) {\n        const rs = args.r.map(r => {\n          const model = resolveReference(this.up, r);\n          return model ? model.get() : undefined;\n        });\n        try {\n          args = getFunction(args.s, rs.length).apply(null, rs);\n        } catch (err) {\n          args = null;\n          warnIfDebug(\n            `Failed to compute args for event on-${this.template.n.join('- ')}: ${err.message ||\n              err}`\n          );\n        }\n      }\n\n      this.template.n.forEach(n => {\n        const fn = findInViewHierarchy('events', this.ractive, n);\n        if (fn) {\n          this.events.push(new CustomEvent(fn, this.element, n, args));\n        } else {\n          this.events.push(new DOMEvent(n, this.element));\n        }\n      });\n    }\n\n    // method calls\n    this.models = null;\n\n    addToArray(this.element.events || (this.element.events = []), this);\n\n    setupArgsFn(this, this.template);\n    if (!this.fn) this.action = this.template.f;\n\n    this.events.forEach(e => e.bind(this));\n  }\n\n  destroyed() {\n    this.events.forEach(e => e.unrender());\n  }\n\n  fire(event, args = []) {\n    const context =\n      event instanceof Context && event.refire ? event : this.element.getContext(event);\n\n    if (this.fn) {\n      const values = [];\n\n      const models = resolveArgs(this, this.template, this.up, {\n        specialRef(ref) {\n          const specialMatch = specialPattern.exec(ref);\n          if (specialMatch) {\n            // on-click=\"foo(event.node)\"\n            return {\n              special: specialMatch[1],\n              keys: specialMatch[2] ? splitKeypath(specialMatch[2].substr(1)) : []\n            };\n          }\n\n          const dollarMatch = dollarArgsPattern.exec(ref);\n          if (dollarMatch) {\n            // on-click=\"foo($1)\"\n            return {\n              special: 'arguments',\n              keys: [dollarMatch[1] - 1].concat(\n                dollarMatch[2] ? splitKeypath(dollarMatch[2].substr(1)) : []\n              )\n            };\n          }\n        }\n      });\n\n      if (models) {\n        models.forEach(model => {\n          if (!model) return values.push(undefined);\n\n          if (model.special) {\n            const which = model.special;\n            let obj;\n\n            if (which === '@node') {\n              obj = this.element.node;\n            } else if (which === '@event') {\n              obj = event && event.event;\n            } else if (which === 'event') {\n              warnOnceIfDebug(\n                `The event reference available to event directives is deprecated and should be replaced with @context and @event`\n              );\n              obj = context;\n            } else if (which === '@context') {\n              obj = context;\n            } else {\n              obj = args;\n            }\n\n            const keys = model.keys.slice();\n\n            while (obj && keys.length) obj = obj[keys.shift()];\n            return values.push(obj);\n          }\n\n          if (model.wrapper) {\n            return values.push(model.wrapperValue);\n          }\n\n          values.push(model.get());\n        });\n      }\n\n      // make event available as `this.event`\n      const ractive = this.ractive;\n      const oldEvent = ractive.event;\n\n      ractive.event = context;\n      const returned = this.fn.apply(ractive, values);\n      let result = returned.pop();\n\n      // Auto prevent and stop if return is explicitly false\n      if (result === false) {\n        const original = event ? event.original : undefined;\n        if (original) {\n          original.preventDefault && original.preventDefault();\n          original.stopPropagation && original.stopPropagation();\n        } else {\n          warnOnceIfDebug(\n            `handler '${this.template.n.join(\n              ' '\n            )}' returned false, but there is no event available to cancel`\n          );\n        }\n      } else if (!returned.length && isArray(result) && isString(result[0])) {\n        // watch for proxy events\n        result = fireEvent(this.ractive, result.shift(), context, result);\n      }\n\n      ractive.event = oldEvent;\n\n      return result;\n    } else {\n      return fireEvent(this.ractive, this.action, context, args);\n    }\n  }\n\n  handleChange() {}\n\n  render() {\n    this.events.forEach(e => e.render(this));\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind(view) {\n    removeFromArray(this.element.events, this);\n    this.events.forEach(e => e.unbind(view));\n  }\n\n  unrender() {\n    this.events.forEach(e => e.unrender());\n  }\n}\n\nconst proto = EventDirective.prototype;\nproto.firstNode = proto.rebound = proto.update = noop;\n","import { fireShuffleTasks } from 'src/model/ModelBase';\nimport { REFERENCE } from 'config/types';\nimport { rebindMatch } from 'shared/rebind';\nimport { isArray, isString } from 'utils/is';\nimport { escapeKey } from 'shared/keypaths';\nimport ExpressionProxy from './ExpressionProxy';\nimport resolveReference from './resolveReference';\nimport resolve from './resolve';\n\nimport LinkModel, { Missing } from 'src/model/LinkModel';\n\nexport default class ReferenceExpressionProxy extends LinkModel {\n  constructor(fragment, template) {\n    super(null, null, null, '@undefined');\n    this.root = fragment.ractive.viewmodel;\n    this.template = template;\n    this.rootLink = true;\n    this.template = template;\n    this.fragment = fragment;\n\n    this.rebound();\n  }\n\n  getKeypath() {\n    return this.model ? this.model.getKeypath() : '@undefined';\n  }\n\n  rebound() {\n    const fragment = this.fragment;\n    const template = this.template;\n\n    let base = (this.base = resolve(fragment, template));\n    let idx;\n\n    if (this.proxy) {\n      teardown(this);\n    }\n\n    const proxy = (this.proxy = {\n      rebind: (next, previous) => {\n        if (previous === base) {\n          next = rebindMatch(template, next, previous);\n          if (next !== base) {\n            this.base = base = next;\n          }\n        } else if (~(idx = members.indexOf(previous))) {\n          next = rebindMatch(template.m[idx].n, next, previous);\n          if (next !== members[idx]) {\n            members.splice(idx, 1, next || Missing);\n          }\n        }\n\n        if (next !== previous) {\n          previous.unregister(proxy);\n          if (next) next.addShuffleTask(() => next.register(proxy));\n        }\n      },\n      handleChange: () => {\n        pathChanged();\n      }\n    });\n\n    base.register(proxy);\n\n    const members = (this.members = template.m.map(tpl => {\n      if (isString(tpl)) {\n        return { get: () => tpl };\n      }\n\n      let model;\n\n      if (tpl.t === REFERENCE) {\n        model = resolveReference(fragment, tpl.n);\n        model.register(proxy);\n\n        return model;\n      }\n\n      model = new ExpressionProxy(fragment, tpl);\n      model.register(proxy);\n      return model;\n    }));\n\n    const pathChanged = () => {\n      const model =\n        base &&\n        base.joinAll(\n          members.reduce((list, m) => {\n            const k = m.get();\n            if (isArray(k)) return list.concat(k);\n            else list.push(escapeKey(String(k)));\n            return list;\n          }, [])\n        );\n\n      if (model !== this.model) {\n        this.model = model;\n        this.relinking(model);\n        fireShuffleTasks();\n        refreshPathDeps(this);\n        this.fragment.shuffled();\n      }\n    };\n\n    pathChanged();\n  }\n\n  teardown() {\n    teardown(this);\n    super.teardown();\n  }\n\n  unreference() {\n    super.unreference();\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n\n  unregister(dep) {\n    super.unregister(dep);\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n}\n\nfunction teardown(proxy) {\n  if (proxy.base) proxy.base.unregister(proxy.proxy);\n  if (proxy.models) {\n    proxy.models.forEach(m => {\n      if (m.unregister) m.unregister(proxy);\n    });\n  }\n}\n\nfunction refreshPathDeps(proxy) {\n  let len = proxy.deps.length;\n  let i, v;\n\n  for (i = 0; i < len; i++) {\n    v = proxy.deps[i];\n    if (v.pathChanged) v.pathChanged();\n    if (v.fragment && v.fragment.pathModel) v.fragment.pathModel.applyValue(proxy.getKeypath());\n  }\n\n  len = proxy.children.length;\n  for (i = 0; i < len; i++) {\n    refreshPathDeps(proxy.children[i]);\n  }\n}\n\nconst eproto = ExpressionProxy.prototype;\nconst proto = ReferenceExpressionProxy.prototype;\n\nproto.unreference = eproto.unreference;\nproto.unregister = eproto.unregister;\nproto.unregisterLink = eproto.unregisterLink;\n","import { rebindMatch } from 'shared/rebind';\nimport Item, { ContainerItem } from './Item';\nimport resolve from '../../resolvers/resolve';\nimport { assign } from 'utils/object';\n\nexport default class Mustache extends Item {\n  constructor(options) {\n    super(options);\n\n    if (options.owner) this.parent = options.owner;\n\n    this.isStatic = !!options.template.s;\n\n    this.model = null;\n    this.dirty = false;\n  }\n\n  bind(pre) {\n    // yield mustaches and inner contexts should resolve in container context\n    const start = this.template.y\n      ? this.template.y.containerFragment\n      : this.containerFragment || this.up;\n    // try to find a model for this view\n    const model = pre || resolve(start, this.template);\n\n    if (model) {\n      const value = model.get();\n\n      if (this.isStatic) {\n        this.model = { get: () => value };\n        model.unreference();\n        return;\n      }\n\n      model.register(this);\n      this.model = model;\n    }\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebind(next, previous, safe) {\n    if (this.isStatic) return;\n\n    next = rebindMatch(this.template, next, previous, this.up);\n    if (next === this.model) return false;\n\n    if (this.model) {\n      this.model.unregister(this);\n    }\n    if (next) next.addShuffleRegister(this, 'mark');\n    this.model = next;\n    if (!safe) this.handleChange();\n    return true;\n  }\n\n  rebound(update) {\n    if (this.model) {\n      if (this.model.rebound) this.model.rebound(update);\n      else {\n        // check to see if the model actually changed...\n        // yield mustaches and inner contexts should resolve in container context\n        const start = this.template.y\n          ? this.template.y.containerFragment\n          : this.containerFragment || this.up;\n        // try to find a model for this view\n        const model = resolve(start, this.template);\n        if (model !== this.model) {\n          this.model.unregister(this);\n          this.bind(model);\n        }\n      }\n\n      if (update) this.bubble();\n    }\n    if (this.fragment) this.fragment.rebound(update);\n  }\n\n  unbind() {\n    if (!this.isStatic) {\n      this.model && this.model.unregister(this);\n      this.model = undefined;\n    }\n  }\n}\n\nexport function MustacheContainer(options) {\n  Mustache.call(this, options);\n}\n\nconst proto = (MustacheContainer.prototype = Object.create(ContainerItem.prototype));\n\nassign(proto, Mustache.prototype, { constructor: MustacheContainer });\n","import progressiveText from './shared/progressiveText';\nimport { escapeHtml } from 'utils/html';\nimport { safeToStringValue } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport Mustache from './shared/Mustache';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Interpolator extends Mustache {\n  bubble() {\n    if (this.owner) this.owner.bubble();\n    super.bubble();\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getString() {\n    return this.model ? safeToStringValue(this.model.get()) : '';\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    const value = (this.value = this.getString());\n\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, value);\n  }\n\n  toString(escape) {\n    const string = this.getString();\n    return escape ? escapeHtml(string) : string;\n  }\n\n  unrender(shouldDestroy) {\n    if (shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.rendered) {\n        const value = this.getString();\n        if (value !== this.value) this.node.data = this.value = value;\n      }\n    }\n  }\n\n  valueOf() {\n    return this.model ? this.model.get() : undefined;\n  }\n}\n","import resolveReference from 'src/view/resolvers/resolveReference';\nimport Model from 'src/model/Model';\nimport { isNumeric, isObject, isNumber, isObjectType, isString } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport findElement from 'src/view/items/shared/findElement';\nimport { set as sharedSet } from './set';\nimport makeArrayMethod from '../Ractive/prototype/shared/makeArrayMethod';\nimport { animate as protoAnimate } from '../Ractive/prototype/animate';\nimport { update as protoUpdate } from '../Ractive/prototype/update';\nimport getRactiveContext, { extern, findParentWithContext } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\nimport { ELEMENT } from 'config/types';\n\nconst modelPush = makeArrayMethod('push').model;\nconst modelPop = makeArrayMethod('pop').model;\nconst modelShift = makeArrayMethod('shift').model;\nconst modelUnshift = makeArrayMethod('unshift').model;\nconst modelSort = makeArrayMethod('sort').model;\nconst modelSplice = makeArrayMethod('splice').model;\nconst modelReverse = makeArrayMethod('reverse').model;\n\nexport const localFragment = {};\n\nclass ContextData extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.value = {};\n    this.ractive = options.ractive;\n    this.adaptors = [];\n    this.context = options.context;\n  }\n\n  getKeypath() {\n    return '@context.data';\n  }\n\n  rebound() {}\n}\n\nexport default class Context {\n  constructor(fragment, element) {\n    this.fragment = fragment;\n    this.element = element || findElement(fragment);\n    this.node = this.element && this.element.node;\n    this.ractive = fragment.ractive;\n    this.root = this;\n  }\n\n  get decorators() {\n    const items = {};\n    if (!this.element) return items;\n    this.element.decorators.forEach(d => (items[d.name] = d.handle));\n    return items;\n  }\n\n  get _data() {\n    return (\n      this.model ||\n      (this.root.model = new ContextData({\n        ractive: this.ractive,\n        context: this.root\n      }))\n    );\n  }\n\n  // the usual mutation suspects\n  add(keypath, d, options) {\n    const num = isNumber(d) ? +d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value + val];\n      }),\n      opts\n    );\n  }\n\n  animate(keypath, value, options) {\n    const model = findModel(this, keypath).model;\n    return protoAnimate(this.ractive, model, value, options);\n  }\n\n  find(selector, opts) {\n    return this.fragment.find(selector, opts);\n  }\n\n  findAll(selector, opts) {\n    const result = [];\n    opts = opts || {};\n    opts.result = result;\n    this.fragment.findAll(selector, opts);\n    return result;\n  }\n\n  findAllComponents(selector, opts) {\n    const result = [];\n    opts = opts || {};\n    opts.result = result;\n    this.fragment.findAllComponents(selector, opts);\n    return result;\n  }\n\n  findComponent(selector, opts) {\n    return this.fragment.findComponent(selector, opts);\n  }\n\n  // get relative keypaths and values\n  get(keypath) {\n    if (!keypath) return this.fragment.findContext().get(true);\n\n    const { model } = findModel(this, keypath);\n\n    return model ? model.get(true) : undefined;\n  }\n\n  getParent(component) {\n    let fragment = this.fragment;\n\n    if (!fragment.parent && component) fragment = fragment.componentParent;\n    else {\n      if (fragment.context) fragment = findParentWithContext(fragment.parent);\n      else {\n        fragment = findParentWithContext(fragment.parent);\n        if (fragment) {\n          if (!fragment.parent && component) fragment = fragment.componentParent;\n          else fragment = findParentWithContext(fragment.parent);\n        }\n      }\n    }\n\n    if (!fragment || fragment === this.fragment) return;\n    else return fragment.getContext();\n  }\n\n  hasListener(name, bubble) {\n    // if the owner is a component, start there because the nearest element\n    // may exist outside of the immediate context (yield)\n    let el = this.fragment.owner.component\n      ? this.fragment.owner\n      : this.element || this.fragment.owner;\n    let base;\n\n    do {\n      base = el.component || el;\n      if (base.template.t === ELEMENT) {\n        if (findEvent(base, name)) return true;\n      }\n      el = el.up && el.up.owner;\n      if (el && el.component) el = el.component;\n    } while (el && bubble);\n  }\n\n  link(source, dest) {\n    const there = findModel(this, source).model;\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    here.link(there, source);\n    runloop.end();\n    return promise;\n  }\n\n  listen(event, handler) {\n    const el = this.element;\n    el.on(event, handler);\n    return {\n      cancel() {\n        el.off(event, handler);\n      }\n    };\n  }\n\n  observe(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observe(keypath, callback, options);\n  }\n\n  observeOnce(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observeOnce(keypath, callback, options);\n  }\n\n  pop(keypath) {\n    return modelPop(findModel(this, keypath).model, []);\n  }\n\n  push(keypath, ...values) {\n    return modelPush(findModel(this, keypath).model, values);\n  }\n\n  raise(name, event, ...args) {\n    let el = this.element;\n    let ev;\n\n    while (el) {\n      if (el.component) el = el.component;\n      ev = findEvent(el, name);\n      if (ev) {\n        return ev.fire(\n          ev.element.getContext(\n            event || {},\n            event && !('original' in event) ? { original: {} } : {}\n          ),\n          args\n        );\n      }\n\n      el = el.up && el.up.owner;\n    }\n  }\n\n  readLink(keypath, options) {\n    return this.ractive.readLink(this.resolve(keypath), options);\n  }\n\n  resolve(path, ractive) {\n    const { model, instance } = findModel(this, path);\n    return model ? model.getKeypath(ractive || instance) : path;\n  }\n\n  reverse(keypath) {\n    return modelReverse(findModel(this, keypath).model, []);\n  }\n\n  set(keypath, value, options) {\n    return sharedSet(build(this, keypath, value), options);\n  }\n\n  shift(keypath) {\n    return modelShift(findModel(this, keypath).model, []);\n  }\n\n  splice(keypath, index, drop, ...add) {\n    add.unshift(index, drop);\n    return modelSplice(findModel(this, keypath).model, add);\n  }\n\n  sort(keypath) {\n    return modelSort(findModel(this, keypath).model, []);\n  }\n\n  subtract(keypath, d, options) {\n    const num = isNumber(d) ? d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value - val];\n      }),\n      opts\n    );\n  }\n\n  toggle(keypath, options) {\n    const { model } = findModel(this, keypath);\n    return sharedSet([[model, !model.get()]], options);\n  }\n\n  unlink(dest) {\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    if (here.owner && here.owner._link) here.owner.unlink();\n    runloop.end();\n    return promise;\n  }\n\n  unlisten(event, handler) {\n    this.element.off(event, handler);\n  }\n\n  unshift(keypath, ...add) {\n    return modelUnshift(findModel(this, keypath).model, add);\n  }\n\n  update(keypath, options) {\n    return protoUpdate(this.ractive, findModel(this, keypath).model, options);\n  }\n\n  updateModel(keypath, cascade) {\n    const { model } = findModel(this, keypath);\n    const promise = runloop.start();\n    model.updateFromBindings(cascade);\n    runloop.end();\n    return promise;\n  }\n\n  // two-way binding related helpers\n  isBound() {\n    const { model } = this.getBindingModel(this);\n    return !!model;\n  }\n\n  getBindingPath(ractive) {\n    const { model, instance } = this.getBindingModel(this);\n    if (model) return model.getKeypath(ractive || instance);\n  }\n\n  getBinding() {\n    const { model } = this.getBindingModel(this);\n    if (model) return model.get(true);\n  }\n\n  getBindingModel(ctx) {\n    const el = ctx.element;\n    return { model: el.binding && el.binding.model, instance: el.up.ractive };\n  }\n\n  setBinding(value) {\n    const { model } = this.getBindingModel(this);\n    return sharedSet([[model, value]]);\n  }\n}\n\nContext.forRactive = getRactiveContext;\n// circular deps are fun\nextern.Context = Context;\n\n// TODO: at some point perhaps this could support relative * keypaths?\nfunction build(ctx, keypath, value) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push([findModel(ctx, k).model, keypath[k]]);\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push([findModel(ctx, keypath).model, value]);\n  }\n\n  return sets;\n}\n\nfunction findModel(ctx, path) {\n  const frag = ctx.fragment;\n\n  if (!isString(path)) {\n    return { model: frag.findContext(), instance: path };\n  }\n\n  return { model: resolveReference(frag, path), instance: frag.ractive };\n}\n\nfunction findEvent(el, name) {\n  return el.events && el.events.find && el.events.find(e => ~e.template.n.indexOf(name));\n}\n","import { doc } from 'config/environment';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { isString } from 'utils/is';\n\nconst query = doc && doc.querySelector;\n\nexport default function getContext(node) {\n  if (isString(node) && query) {\n    node = query.call(document, node);\n  }\n\n  let instances;\n  if (node) {\n    if (node._ractive) {\n      return node._ractive.proxy.getContext();\n    } else if ((instances = node.__ractive_instances__)) {\n      if (instances.length === 1) return getRactiveContext(instances[0]);\n    } else return getContext(node.parentNode);\n  }\n}\n","import { isClient, svg, vendors, win, doc } from 'config/environment';\nimport { html } from 'config/namespaces';\nimport { isString, isNumber } from 'utils/is';\n\nlet createElement, matches, div, methodNames, unprefixed, prefixed, i, j, makeFunction;\n\nconst customStr = isClient && 'registerElement' in doc;\nfunction wrap(is) {\n  return customStr ? is : { is };\n}\n\n// Test for SVG support\nif (!svg) {\n  /* istanbul ignore next */\n  createElement = (type, ns, is) => {\n    if (ns && ns !== html) {\n      throw \"This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you're trying to render SVG in an older browser. See http://ractive.js.org/support/#svgs for more information\";\n    }\n\n    return is ? doc.createElement(type, wrap(is)) : doc.createElement(type);\n  };\n} else {\n  createElement = (type, ns, is) => {\n    if (!ns || ns === html) {\n      return is ? doc.createElement(type, wrap(is)) : doc.createElement(type);\n    }\n\n    return is ? doc.createElementNS(ns, type, wrap(is)) : doc.createElementNS(ns, type);\n  };\n}\n\nexport function createDocumentFragment() {\n  return doc.createDocumentFragment();\n}\n\nfunction getElement(input) {\n  let output;\n\n  if (!input || typeof input === 'boolean') {\n    return;\n  }\n\n  /* istanbul ignore next */\n  if (!win || !doc || !input) {\n    return null;\n  }\n\n  // We already have a DOM node - no work to do. (Duck typing alert!)\n  if (input.nodeType) {\n    return input;\n  }\n\n  // Get node from string\n  if (isString(input)) {\n    // try ID first\n    output = doc.getElementById(input);\n\n    // then as selector, if possible\n    if (!output && doc.querySelector) {\n      try {\n        output = doc.querySelector(input);\n      } catch (e) {\n        /* this space intentionally left blank */\n      }\n    }\n\n    // did it work?\n    if (output && output.nodeType) {\n      return output;\n    }\n  }\n\n  // If we've been given a collection (jQuery, Zepto etc), extract the first item\n  if (input[0] && input[0].nodeType) {\n    return input[0];\n  }\n\n  return null;\n}\n\nif (!isClient) {\n  matches = null;\n} else {\n  div = createElement('div');\n  methodNames = ['matches', 'matchesSelector'];\n\n  makeFunction = function(methodName) {\n    return function(node, selector) {\n      return node[methodName](selector);\n    };\n  };\n\n  i = methodNames.length;\n\n  while (i-- && !matches) {\n    unprefixed = methodNames[i];\n\n    if (div[unprefixed]) {\n      matches = makeFunction(unprefixed);\n    } else {\n      j = vendors.length;\n      while (j--) {\n        prefixed = vendors[i] + unprefixed.substr(0, 1).toUpperCase() + unprefixed.substring(1);\n\n        if (div[prefixed]) {\n          matches = makeFunction(prefixed);\n          break;\n        }\n      }\n    }\n  }\n\n  // IE8... and apparently phantom some?\n  /* istanbul ignore next */\n  if (!matches) {\n    matches = function(node, selector) {\n      let parentNode, i;\n\n      parentNode = node.parentNode;\n\n      if (!parentNode) {\n        // empty dummy <div>\n        div.innerHTML = '';\n\n        parentNode = div;\n        node = node.cloneNode();\n\n        div.appendChild(node);\n      }\n\n      const nodes = parentNode.querySelectorAll(selector);\n\n      i = nodes.length;\n      while (i--) {\n        if (nodes[i] === node) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  }\n}\n\nfunction detachNode(node) {\n  // stupid ie\n  // eslint-disable-next-line valid-typeof\n  if (node && typeof node.parentNode !== 'unknown' && node.parentNode) {\n    node.parentNode.removeChild(node);\n  }\n\n  return node;\n}\n\nfunction safeToStringValue(value) {\n  return value == null || (isNumber(value) && isNaN(value)) || !value.toString ? '' : '' + value;\n}\n\nfunction safeAttributeString(string) {\n  return safeToStringValue(string)\n    .replace(/&/g, '&amp;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\nexport { createElement, detachNode, getElement, matches, safeToStringValue, safeAttributeString };\n","export const html = 'http://www.w3.org/1999/xhtml';\nexport const mathml = 'http://www.w3.org/1998/Math/MathML';\nexport const svg = 'http://www.w3.org/2000/svg';\nexport const xlink = 'http://www.w3.org/1999/xlink';\nexport const xml = 'http://www.w3.org/XML/1998/namespace';\nexport const xmlns = 'http://www.w3.org/2000/xmlns';\n\nexport default { html, mathml, svg, xlink, xml, xmlns };\n","import { isEqual, isFunction } from 'utils/is';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\nimport { rebindMatch } from 'shared/rebind';\nimport { create } from 'utils/object';\nimport { warnIfDebug } from 'utils/log';\n\nexport default class Observer {\n  constructor(ractive, model, callback, options) {\n    this.context = options.context || ractive;\n    this.callback = callback;\n    this.ractive = ractive;\n    this.keypath = options.keypath;\n    this.options = options;\n\n    if (model) this.resolved(model);\n\n    if (isFunction(options.old)) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    if (options.init !== false) {\n      this.dirty = true;\n      this.dispatch();\n    } else {\n      updateOld(this);\n    }\n\n    this.dirty = false;\n  }\n\n  cancel() {\n    this.cancelled = true;\n    if (this.model) {\n      this.model.unregister(this);\n    } else {\n      this.resolver.unbind();\n    }\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    if (!this.cancelled) {\n      try {\n        this.callback.call(this.context, this.newValue, this.oldValue, this.keypath);\n      } catch (err) {\n        warnIfDebug(\n          `Failed to execute observer callback for '${this.keypath}': ${err.message || err}`\n        );\n      }\n      updateOld(this, true);\n      this.dirty = false;\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty) {\n      const newValue = this.model.get();\n      if (isEqual(newValue, this.oldValue)) return;\n\n      this.newValue = newValue;\n\n      if (this.options.strict && this.newValue === this.oldValue) return;\n\n      runloop.addObserver(this, this.options.defer);\n      this.dirty = true;\n\n      if (this.options.once) runloop.scheduleTask(() => this.cancel());\n    } else {\n      // make sure the newValue stays updated in case this observer gets touched multiple times in one loop\n      this.newValue = this.model.get();\n    }\n  }\n\n  rebind(next, previous) {\n    next = rebindMatch(this.keypath, next, previous);\n    if (next === this.model) return false;\n\n    if (this.model) this.model.unregister(this);\n    if (next) next.addShuffleTask(() => this.resolved(next));\n  }\n\n  resolved(model) {\n    this.model = model;\n\n    this.oldValue = undefined;\n    this.newValue = model.get();\n\n    model.register(this);\n  }\n}\n\nfunction updateOld(observer, fresh) {\n  const next = fresh\n    ? observer.model\n      ? observer.model.get()\n      : observer.newValue\n    : observer.newValue;\n  try {\n    observer.oldValue = observer.oldFn\n      ? observer.oldFn.call(observer.oldContext, undefined, next, observer.keypath)\n      : next;\n  } catch (err) {\n    warnIfDebug(\n      `Failed to execute observer oldValue callback for '${this.keypath}': ${err.message || err}`\n    );\n    observer.oldValue = next;\n  }\n}\n","import { escapeKey } from 'shared/keypaths';\nimport { removeFromArray } from 'utils/array';\nimport { isArray, isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport { create, keys } from 'utils/object';\nimport { warnIfDebug } from 'utils/log';\nimport { joinKeys } from 'src/Ractive/static/keypaths';\n\nconst star = /\\*+/g;\n\nexport default class PatternObserver {\n  constructor(ractive, baseModel, keys, callback, options) {\n    this.context = options.context || ractive;\n    this.ractive = ractive;\n    this.baseModel = baseModel;\n    this.keys = keys;\n    this.callback = callback;\n\n    const pattern = keys.join('\\\\.').replace(star, '(.+)');\n    const baseKeypath = (this.baseKeypath = baseModel.getKeypath(ractive));\n    this.pattern = new RegExp(`^${baseKeypath ? baseKeypath + '\\\\.' : ''}${pattern}$`);\n    this.recursive = keys.length === 1 && keys[0] === '**';\n    if (this.recursive) this.keys = ['*'];\n    if (options.old) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    this.oldValues = {};\n    this.newValues = {};\n\n    this.defer = options.defer;\n    this.once = options.once;\n    this.strict = options.strict;\n\n    this.dirty = false;\n    this.changed = [];\n    this.cache = [];\n    this.partial = false;\n    this.links = options.links;\n\n    const models = baseModel.findMatches(this.keys);\n\n    models.forEach(model => {\n      this.newValues[model.getKeypath(this.ractive)] = model.get();\n    });\n\n    if (options.init !== false) {\n      this.dispatch();\n    } else {\n      updateOld(this, this.newValues);\n    }\n\n    baseModel.registerPatternObserver(this);\n  }\n\n  cancel() {\n    this.baseModel.unregisterPatternObserver(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    const newValues = this.newValues;\n    this.newValues = {};\n    keys(newValues).forEach(keypath => {\n      const newValue = newValues[keypath];\n      const oldValue = this.oldValues[keypath];\n\n      if (this.strict && newValue === oldValue) return;\n      if (isEqual(newValue, oldValue)) return;\n\n      let args = [newValue, oldValue, keypath];\n      if (keypath) {\n        const wildcards = this.pattern.exec(keypath);\n        if (wildcards) {\n          args = args.concat(wildcards.slice(1));\n        }\n      }\n\n      try {\n        this.callback.apply(this.context, args);\n      } catch (err) {\n        warnIfDebug(\n          `Failed to execute pattern observer callback for '${this.keypath}': ${err.message || err}`\n        );\n      }\n    });\n\n    updateOld(this, newValues, this.partial);\n\n    this.dirty = false;\n  }\n\n  notify(keys) {\n    const path = joinKeys(keys);\n    if (!~this.cache.indexOf(path)) {\n      this.cache.push(path);\n      this.changed.push(keys);\n    }\n  }\n\n  shuffle(newIndices) {\n    if (!isArray(this.baseModel.value)) return;\n\n    const max = this.baseModel.value.length;\n\n    for (let i = 0; i < newIndices.length; i++) {\n      if (newIndices[i] === -1 || newIndices[i] === i) continue;\n      this.changed.push([i]);\n    }\n\n    for (let i = newIndices.touchedFrom; i < max; i++) {\n      this.changed.push([i]);\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty || this.changed.length) {\n      if (!this.dirty) this.newValues = {};\n\n      if (!this.changed.length) {\n        this.baseModel.findMatches(this.keys).forEach(model => {\n          const keypath = model.getKeypath(this.ractive);\n          this.newValues[keypath] = model.get();\n        });\n        this.partial = false;\n      } else {\n        let count = 0;\n\n        if (this.recursive) {\n          const changed = this.changed.slice();\n          this.changed.length = 0;\n          this.dirty = true;\n          changed.forEach(keys => {\n            const model = this.baseModel.joinAll(keys);\n            if (model.isLink && !this.links) return;\n            count++;\n            this.newValues[model.getKeypath(this.ractive)] = model.get();\n          });\n          this.dirty = false;\n        } else {\n          const ok = this.baseModel.isRoot\n            ? this.changed.map(keys => keys.map(escapeKey).join('.'))\n            : this.changed.map(keys => this.baseKeypath + '.' + keys.map(escapeKey).join('.'));\n\n          this.baseModel.findMatches(this.keys).forEach(model => {\n            const keypath = model.getKeypath(this.ractive);\n            const check = k => {\n              return (\n                (k.indexOf(keypath) === 0 &&\n                  (k.length === keypath.length || k[keypath.length] === '.')) ||\n                (keypath.indexOf(k) === 0 &&\n                  (k.length === keypath.length || keypath[k.length] === '.'))\n              );\n            };\n\n            // is this model on a changed keypath?\n            if (ok.filter(check).length) {\n              count++;\n              this.newValues[keypath] = model.get();\n            }\n          });\n        }\n\n        // no valid change triggered, so bail to avoid breakage\n        if (!count) return;\n\n        this.partial = true;\n      }\n\n      runloop.addObserver(this, this.defer);\n      this.dirty = true;\n      this.changed.length = 0;\n      this.cache = [];\n\n      if (this.once) this.cancel();\n    }\n  }\n}\n\nfunction updateOld(observer, vals, partial) {\n  const olds = observer.oldValues;\n\n  if (observer.oldFn) {\n    if (!partial) observer.oldValues = {};\n\n    keys(vals).forEach(k => {\n      const args = [olds[k], vals[k], k];\n      const parts = observer.pattern.exec(k);\n      if (parts) {\n        args.push.apply(args, parts.slice(1));\n      }\n      observer.oldValues[k] = observer.oldFn.apply(observer.oldContext, args);\n    });\n  } else {\n    if (partial) {\n      keys(vals).forEach(k => (olds[k] = vals[k]));\n    } else {\n      observer.oldValues = vals;\n    }\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport { isArray, isUndefined } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport { warnIfDebug } from 'utils/log';\n\nfunction negativeOne() {\n  return -1;\n}\n\nexport default class ArrayObserver {\n  constructor(ractive, model, callback, options) {\n    this.ractive = ractive;\n    this.model = model;\n    this.keypath = model.getKeypath();\n    this.callback = callback;\n    this.options = options;\n\n    this.pending = null;\n\n    model.register(this);\n\n    if (options.init !== false) {\n      this.sliced = [];\n      this.shuffle([]);\n      this.dispatch();\n    } else {\n      this.sliced = this.slice();\n    }\n  }\n\n  cancel() {\n    this.model.unregister(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    try {\n      this.callback(this.pending);\n    } catch (err) {\n      warnIfDebug(\n        `Failed to execute array observer callback for '${this.keypath}': ${err.message || err}`\n      );\n    }\n    this.pending = null;\n    if (this.options.once) this.cancel();\n  }\n\n  handleChange(path) {\n    if (this.pending) {\n      // post-shuffle\n      runloop.addObserver(this, this.options.defer);\n    } else if (!path) {\n      // entire array changed\n      this.shuffle(this.sliced.map(negativeOne));\n      this.handleChange();\n    }\n  }\n\n  shuffle(newIndices) {\n    const newValue = this.slice();\n\n    const inserted = [];\n    const deleted = [];\n    let start;\n\n    const hadIndex = {};\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      hadIndex[newIndex] = true;\n\n      if (newIndex !== oldIndex && isUndefined(start)) {\n        start = oldIndex;\n      }\n\n      if (newIndex === -1) {\n        deleted.push(this.sliced[oldIndex]);\n      }\n    });\n\n    if (isUndefined(start)) start = newIndices.length;\n\n    const len = newValue.length;\n    for (let i = 0; i < len; i += 1) {\n      if (!hadIndex[i]) inserted.push(newValue[i]);\n    }\n\n    this.pending = { inserted, deleted, start };\n    this.sliced = newValue;\n  }\n\n  slice() {\n    const value = this.model.get();\n    return isArray(value) ? value.slice() : [];\n  }\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { assign } from 'utils/object';\n\nconst onceOptions = { init: false, once: true };\n\nexport default function observeOnce(keypath, callback, options) {\n  if (isObject(keypath) || isFunction(keypath)) {\n    options = assign(callback || {}, onceOptions);\n    return this.observe(keypath, options);\n  }\n\n  options = assign(options || {}, onceOptions);\n  return this.observe(keypath, callback, options);\n}\n","export default str => str.trim();\n","export default str => str !== '';\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('pop').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('push').path;\n","import { doc } from '../config/environment';\nimport { isArray } from '../utils/is';\n\nconst PREFIX = '/* Ractive.js component styles */';\n\n// Holds current definitions of styles.\nconst styleDefinitions = [];\n\n// Flag to tell if we need to update the CSS\nlet isDirty = false;\n\n// These only make sense on the browser. See additional setup below.\nlet styleElement = null;\nlet useCssText = null;\n\n// flag to use multiple style tags\nlet _splitTag = false;\nexport function splitTag(v) {\n  return v === undefined ? _splitTag : (_splitTag = v);\n}\n\nexport function addCSS(styleDefinition) {\n  styleDefinitions.push(styleDefinition);\n  isDirty = true;\n}\n\nexport function applyCSS(force) {\n  const styleElement = style();\n\n  // Apply only seems to make sense when we're in the DOM. Server-side renders\n  // can call toCSS to get the updated CSS.\n  if (!styleElement || (!force && !isDirty)) return;\n\n  if (_splitTag) {\n    styleDefinitions.forEach(s => {\n      const el = getStyle(s.id);\n      if (el) {\n        const css = getCSS(s.id);\n        if (useCssText) {\n          el.styleSheet.cssText !== css && (el.styleSheet.cssText = css);\n        } else {\n          el.innerHTML !== css && (el.innerHTML = css);\n        }\n      }\n    });\n  } else {\n    if (useCssText) {\n      styleElement.styleSheet.cssText = getCSS(null);\n    } else {\n      styleElement.innerHTML = getCSS(null);\n    }\n  }\n\n  isDirty = false;\n}\n\nexport function getCSS(cssIds) {\n  if (cssIds && !isArray(cssIds)) cssIds = [cssIds];\n  const filteredStyleDefinitions = cssIds\n    ? styleDefinitions.filter(style => ~cssIds.indexOf(style.id))\n    : styleDefinitions;\n\n  filteredStyleDefinitions.forEach(d => (d.applied = true));\n\n  return filteredStyleDefinitions.reduce(\n    (styles, style) => `${styles ? `${styles}\\n\\n/* {${style.id}} */\\n${style.styles}` : ''}`,\n    PREFIX\n  );\n}\n\nfunction getStyle(id) {\n  return doc && (doc.querySelector(`[data-ractive-css=\"${id}\"]`) || makeStyle(id));\n}\n\nfunction makeStyle(id) {\n  if (doc) {\n    const el = doc.createElement('style');\n    el.type = 'text/css';\n    el.setAttribute('data-ractive-css', id || '');\n\n    doc.getElementsByTagName('head')[0].appendChild(el);\n\n    if (useCssText === null) useCssText = !!el.styleSheet;\n\n    return el;\n  }\n}\n\nfunction style() {\n  if (!styleElement) styleElement = makeStyle();\n\n  return styleElement;\n}\n","import { ensureArray, combine } from 'utils/array';\n\nexport default {\n  extend: (Parent, proto, options) => {\n    proto.adapt = combine(proto.adapt, ensureArray(options.adapt));\n  },\n\n  init() {}\n};\n","const remove = /\\/\\*(?:[\\s\\S]*?)\\*\\//g;\nconst escape = /url\\(\\s*(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\1\\s*\\)|url\\((?:\\\\[\\s\\S]|[^)])*\\)|(['\"])(?:\\\\[\\s\\S]|(?!\\2).)*\\2/gi;\nconst value = /\\0(\\d+)/g;\n\n// Removes comments and strings from the given CSS to make it easier to parse.\n// Callback receives the cleaned CSS and a function which can be used to put\n// the removed strings back in place after parsing is done.\nexport default function(css, callback, additionalReplaceRules = []) {\n  const values = [];\n  const reconstruct = css => css.replace(value, (match, n) => values[n]);\n  css = css.replace(escape, match => `\\0${values.push(match) - 1}`).replace(remove, '');\n\n  additionalReplaceRules.forEach(pattern => {\n    css = css.replace(pattern, match => `\\0${values.push(match) - 1}`);\n  });\n\n  return callback(css, reconstruct);\n}\n","import cleanCss from 'utils/cleanCss';\n\nconst selectorsPattern = /(?:^|\\}|\\{|\\x01)\\s*([^\\{\\}\\0\\x01]+)\\s*(?=\\{)/g;\nconst importPattern = /@import\\s*\\([^)]*\\)\\s*;?/gi;\nconst importEndPattern = /\\x01/g;\nconst keyframesDeclarationPattern = /@keyframes\\s+[^\\{\\}]+\\s*\\{(?:[^{}]+|\\{[^{}]+})*}/gi;\nconst selectorUnitPattern = /((?:(?:\\[[^\\]]+\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\nconst excludePattern = /^(?:@|\\d+%)/;\nconst dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\nfunction trim(str) {\n  return str.trim();\n}\n\nfunction extractString(unit) {\n  return unit.str;\n}\n\nfunction transformSelector(selector, parent) {\n  const selectorUnits = [];\n  let match;\n\n  while ((match = selectorUnitPattern.exec(selector))) {\n    selectorUnits.push({\n      str: match[0],\n      base: match[1],\n      modifiers: match[2]\n    });\n  }\n\n  // For each simple selector within the selector, we need to create a version\n  // that a) combines with the id, and b) is inside the id\n  const base = selectorUnits.map(extractString);\n\n  const transformed = [];\n  let i = selectorUnits.length;\n\n  while (i--) {\n    const appended = base.slice();\n\n    // Pseudo-selectors should go after the attribute selector\n    const unit = selectorUnits[i];\n    appended[i] = unit.base + parent + unit.modifiers || '';\n\n    const prepended = base.slice();\n    prepended[i] = parent + ' ' + prepended[i];\n\n    transformed.push(appended.join(' '), prepended.join(' '));\n  }\n\n  return transformed.join(', ');\n}\n\nexport default function transformCss(css, id) {\n  const dataAttr = `[data-ractive-css~=\"{${id}}\"]`;\n\n  let transformed;\n\n  if (dataRvcGuidPattern.test(css)) {\n    transformed = css.replace(dataRvcGuidPattern, dataAttr);\n  } else {\n    transformed = cleanCss(\n      css,\n      (css, reconstruct) => {\n        css = css\n          .replace(importPattern, '$&\\x01')\n          .replace(selectorsPattern, (match, $1) => {\n            // don't transform at-rules and keyframe declarations\n            if (excludePattern.test($1)) return match;\n\n            const selectors = $1.split(',').map(trim);\n            const transformed =\n              selectors.map(selector => transformSelector(selector, dataAttr)).join(', ') + ' ';\n\n            return match.replace($1, transformed);\n          })\n          .replace(importEndPattern, '');\n\n        return reconstruct(css);\n      },\n      [keyframesDeclarationPattern]\n    );\n  }\n\n  return transformed;\n}\n","import { SharedModel } from './SharedModel';\nimport { applyChanges } from '../../Ractive/static/styleSet';\n\nexport default class CSSModel extends SharedModel {\n  constructor(component) {\n    super(component.cssData, '@style');\n    this.component = component;\n  }\n\n  downstreamChanged(path, depth) {\n    if (this.locked) return;\n\n    const component = this.component;\n\n    component.extensions.forEach(e => {\n      const model = e._cssModel;\n      model.mark();\n      model.downstreamChanged(path, depth || 1);\n    });\n\n    if (!depth) {\n      applyChanges(component, true);\n    }\n  }\n}\n","import { addCSS, applyCSS } from 'src/global/css';\nimport transformCss from './transform';\nimport { uuid } from 'utils/id';\nimport { warnIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport { splitKeypath } from 'shared/keypaths';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperty } from 'utils/object';\nimport { isString, isFunction, isObjectType } from 'utils/is';\n\nconst hasCurly = /\\{/;\nexport default {\n  name: 'css',\n\n  // Called when creating a new component definition\n  extend: (Parent, proto, options, Child) => {\n    Child._cssIds = gatherIds(Parent);\n\n    defineProperty(Child, 'cssData', {\n      configurable: true,\n      value: assign(create(Parent.cssData), options.cssData || {})\n    });\n\n    defineProperty(Child, '_cssModel', {\n      configurable: true,\n      value: new CSSModel(Child)\n    });\n\n    if (options.css) initCSS(options, Child, proto);\n  },\n\n  // Called when creating a new component instance\n  init: (Parent, target, options) => {\n    if (!options.css) return;\n\n    warnIfDebug(`\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\n\nconst Component = Ractive.extend({\n\t...\n\tcss: '/* your css */',\n\t...\n});\n\nconst componentInstance = new Component({ ... })\n\t\t`);\n  }\n};\n\nfunction gatherIds(start) {\n  let cmp = start;\n  const ids = [];\n\n  while (cmp) {\n    if (cmp.prototype.cssId) ids.push(cmp.prototype.cssId);\n    cmp = cmp.Parent;\n  }\n\n  return ids;\n}\n\nexport function evalCSS(component, css) {\n  if (isString(css)) return css;\n\n  const cssData = component.cssData;\n  const model = component._cssModel;\n  const data = function data(path) {\n    return model.joinAll(splitKeypath(path)).get();\n  };\n  data.__proto__ = cssData;\n\n  const result = css.call(component, data);\n  return isString(result) ? result : '';\n}\n\nexport function initCSS(options, target, proto) {\n  let css =\n    options.css === true\n      ? ''\n      : isString(options.css) && !hasCurly.test(options.css)\n      ? getElement(options.css) || options.css\n      : options.css;\n  let cssProp = css;\n\n  const id = options.cssId || uuid();\n\n  if (isObjectType(css)) {\n    css = 'textContent' in css ? css.textContent : css.innerHTML;\n    cssProp = css;\n  } else if (isFunction(css)) {\n    cssProp = css;\n    css = evalCSS(target, css);\n  }\n\n  const def = {\n    transform: 'noCSSTransform' in options ? !options.noCSSTransform : !options.noCssTransform\n  };\n\n  defineProperty(target, '_cssDef', { configurable: true, value: def });\n\n  defineProperty(target, 'css', {\n    get() {\n      return cssProp;\n    },\n    set(next) {\n      cssProp = next;\n      const css = evalCSS(target, cssProp);\n      const styles = def.styles;\n      def.styles = def.transform ? transformCss(css, id) : css;\n      if (def.applied && styles !== def.styles) applyCSS(true);\n    }\n  });\n\n  def.styles = def.transform ? transformCss(css, id) : css;\n  def.id = proto.cssId = id;\n  target._cssIds.push(id);\n\n  addCSS(target._cssDef);\n}\n","import { fatal, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { isArray, isObject, isFunction, isObjectType } from 'utils/is';\nimport bind from 'utils/bind';\n\nfunction validate(data) {\n  // Warn if userOptions.data is a non-POJO\n  if (data && data.constructor !== Object) {\n    if (isFunction(data)) {\n      // TODO do we need to support this in the new Ractive() case?\n    } else if (!isObjectType(data)) {\n      fatal(`data option must be an object or a function, \\`${data}\\` is not valid`);\n    } else {\n      warnIfDebug(\n        'If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged'\n      );\n    }\n  }\n}\n\nexport default {\n  name: 'data',\n\n  extend: (Parent, proto, options) => {\n    let key;\n    let value;\n\n    // check for non-primitives, which could cause mutation-related bugs\n    if (options.data && isObject(options.data)) {\n      for (key in options.data) {\n        value = options.data[key];\n\n        if (value && isObjectType(value)) {\n          if (isObject(value) || isArray(value)) {\n            warnIfDebug(`Passing a \\`data\\` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }`);\n          }\n        }\n      }\n    }\n\n    proto.data = combine(proto.data, options.data);\n  },\n\n  init: (Parent, ractive, options) => {\n    let result = combine(Parent.prototype.data, options.data);\n\n    if (isFunction(result)) result = result.call(ractive);\n\n    // bind functions to the ractive instance at the top level,\n    // unless it's a non-POJO (in which case alarm bells should ring)\n    if (result && result.constructor === Object) {\n      for (const prop in result) {\n        if (isFunction(result[prop])) {\n          const value = result[prop];\n          result[prop] = bind(value, ractive);\n          result[prop]._r_unbound = value;\n        }\n      }\n    }\n\n    return result || {};\n  },\n\n  reset(ractive) {\n    const result = this.init(ractive.constructor, ractive, ractive.viewmodel);\n    ractive.viewmodel.root.set(result);\n    return true;\n  }\n};\n\nfunction emptyData() {\n  return {};\n}\n\nfunction combine(parentValue, childValue) {\n  validate(childValue);\n\n  const parentIsFn = isFunction(parentValue);\n\n  // Very important, otherwise child instance can become\n  // the default data object on Ractive or a component.\n  // then ractive.set() ends up setting on the prototype!\n  if (!childValue && !parentIsFn) {\n    // this needs to be a function so that it can still inherit parent defaults\n    childValue = emptyData;\n  }\n\n  const childIsFn = isFunction(childValue);\n\n  // Fast path, where we just need to copy properties from\n  // parent to child\n  if (!parentIsFn && !childIsFn) {\n    return fromProperties(childValue, parentValue);\n  }\n\n  return function() {\n    const child = childIsFn ? callDataFunction(childValue, this) : childValue;\n    const parent = parentIsFn ? callDataFunction(parentValue, this) : parentValue;\n\n    return fromProperties(child, parent);\n  };\n}\n\nfunction callDataFunction(fn, context) {\n  const data = fn.call(context);\n\n  if (!data) return;\n\n  if (!isObjectType(data)) {\n    fatal('Data function must return an object');\n  }\n\n  if (data.constructor !== Object) {\n    warnOnceIfDebug(\n      'Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged'\n    );\n  }\n\n  return data;\n}\n\nfunction fromProperties(primary, secondary) {\n  if (primary && secondary) {\n    for (const key in secondary) {\n      if (!(key in primary)) {\n        primary[key] = secondary[key];\n      }\n    }\n\n    return primary;\n  }\n\n  return primary || secondary;\n}\n","export const TEMPLATE_VERSION = 4;\n","import { TEMPLATE_VERSION } from 'config/template';\nimport { addFunctions } from 'shared/getFunction';\nimport parser from '../runtime-parser';\nimport { hasOwn } from 'utils/object';\nimport { isFunction, isNumber, isString } from 'utils/is';\n\nexport default {\n  name: 'template',\n\n  extend(Parent, proto, options) {\n    // only assign if exists\n    if ('template' in options) {\n      const template = options.template;\n\n      if (isFunction(template)) {\n        proto.template = template;\n      } else {\n        proto.template = parseTemplate(template, proto);\n      }\n    }\n  },\n\n  init(Parent, ractive, options) {\n    // TODO because of prototypal inheritance, we might just be able to use\n    // ractive.template, and not bother passing through the Parent object.\n    // At present that breaks the test mocks' expectations\n    let template = 'template' in options ? options.template : Parent.prototype.template;\n    template = template || { v: TEMPLATE_VERSION, t: [] };\n\n    if (isFunction(template)) {\n      const fn = template;\n      template = getDynamicTemplate(ractive, fn);\n\n      ractive._config.template = {\n        fn,\n        result: template\n      };\n    }\n\n    template = parseTemplate(template, ractive);\n\n    // TODO the naming of this is confusing - ractive.template refers to [...],\n    // but Component.prototype.template refers to {v:1,t:[],p:[]}...\n    // it's unnecessary, because the developer never needs to access\n    // ractive.template\n    ractive.template = template.t;\n\n    if (template.p) {\n      extendPartials(ractive.partials, template.p);\n    }\n  },\n\n  reset(ractive) {\n    const result = resetValue(ractive);\n\n    if (result) {\n      const parsed = parseTemplate(result, ractive);\n\n      ractive.template = parsed.t;\n      extendPartials(ractive.partials, parsed.p, true);\n\n      return true;\n    }\n  }\n};\n\nfunction resetValue(ractive) {\n  const initial = ractive._config.template;\n\n  // If this isn't a dynamic template, there's nothing to do\n  if (!initial || !initial.fn) {\n    return;\n  }\n\n  const result = getDynamicTemplate(ractive, initial.fn);\n\n  // TODO deep equality check to prevent unnecessary re-rendering\n  // in the case of already-parsed templates\n  if (result !== initial.result) {\n    initial.result = result;\n    return result;\n  }\n}\n\nfunction getDynamicTemplate(ractive, fn) {\n  return fn.call(ractive, {\n    fromId: parser.fromId,\n    isParsed: parser.isParsed,\n    parse(template, options = parser.getParseOptions(ractive)) {\n      return parser.parse(template, options);\n    }\n  });\n}\n\nfunction parseTemplate(template, ractive) {\n  if (isString(template)) {\n    // parse will validate and add expression functions\n    template = parseAsString(template, ractive);\n  } else {\n    // need to validate and add exp for already parsed template\n    validate(template);\n    addFunctions(template);\n  }\n\n  return template;\n}\n\nfunction parseAsString(template, ractive) {\n  // ID of an element containing the template?\n  if (template[0] === '#') {\n    template = parser.fromId(template);\n  }\n\n  return parser.parseFor(template, ractive);\n}\n\nfunction validate(template) {\n  // Check that the template even exists\n  if (template == undefined) {\n    throw new Error(`The template cannot be ${template}.`);\n  } else if (!isNumber(template.v)) {\n    // Check the parsed template has a version at all\n    throw new Error(\n      \"The template parser was passed a non-string template, but the template doesn't have a version.  Make sure you're passing in the template you think you are.\"\n    );\n  } else if (template.v !== TEMPLATE_VERSION) {\n    // Check we're using the correct version\n    throw new Error(\n      `Mismatched template version (expected ${TEMPLATE_VERSION}, got ${\n        template.v\n      }) Please ensure you are using the latest version of Ractive.js in your build process as well as in your app`\n    );\n  }\n}\n\nfunction extendPartials(existingPartials, newPartials, overwrite) {\n  if (!newPartials) return;\n\n  // TODO there's an ambiguity here - we need to overwrite in the `reset()`\n  // case, but not initially...\n\n  for (const key in newPartials) {\n    if (overwrite || !hasOwn(existingPartials, key)) {\n      existingPartials[key] = newPartials[key];\n    }\n  }\n}\n","import { assign, create, keys } from 'utils/object';\nimport { addFunctions } from 'shared/getFunction';\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'computed',\n  'decorators',\n  'easing',\n  'events',\n  'helpers',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nconst registriesOnDefaults = ['computed', 'helpers'];\n\nclass Registry {\n  constructor(name, useDefaults) {\n    this.name = name;\n    this.useDefaults = useDefaults;\n  }\n\n  extend(Parent, proto, options) {\n    const parent = this.useDefaults ? Parent.defaults : Parent;\n    const target = this.useDefaults ? proto : proto.constructor;\n    this.configure(parent, target, options);\n  }\n\n  init() {\n    // noop\n  }\n\n  configure(Parent, target, options) {\n    const name = this.name;\n    const option = options[name];\n\n    const registry = create(Parent[name]);\n\n    assign(registry, option);\n\n    target[name] = registry;\n\n    if (name === 'partials' && target[name]) {\n      keys(target[name]).forEach(key => {\n        addFunctions(target[name][key]);\n      });\n    }\n  }\n\n  reset(ractive) {\n    const registry = ractive[this.name];\n    let changed = false;\n\n    keys(registry).forEach(key => {\n      const item = registry[key];\n\n      if (item._fn) {\n        if (item._fn.isOwner) {\n          registry[key] = item._fn;\n        } else {\n          delete registry[key];\n        }\n        changed = true;\n      }\n    });\n\n    return changed;\n  }\n}\n\nconst registries = registryNames.map(name => {\n  const putInDefaults = registriesOnDefaults.indexOf(name) > -1;\n  return new Registry(name, putInDefaults);\n});\n\nexport default registries;\n","import { warnIfDebug } from 'utils/log';\nimport adaptConfigurator from './custom/adapt';\nimport cssConfigurator from './custom/css/css';\nimport dataConfigurator from './custom/data';\nimport templateConfigurator from './custom/template';\nimport defaults from './defaults';\nimport registries from './registries';\nimport wrapPrototype from './wrapPrototypeMethod';\nimport deprecate from './deprecate';\nimport RactiveProto from '../prototype';\nimport { hasOwn, keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\nimport hooks from 'src/events/Hook';\n\nconst config = {\n  extend: (Parent, proto, options, Child) => configure('extend', Parent, proto, options, Child),\n  init: (Parent, ractive, options) => configure('init', Parent, ractive, options),\n  reset: ractive => order.filter(c => c.reset && c.reset(ractive)).map(c => c.name)\n};\n\nconst custom = {\n  adapt: adaptConfigurator,\n  computed: config,\n  css: cssConfigurator,\n  data: dataConfigurator,\n  helpers: config,\n  template: templateConfigurator\n};\n\nconst defaultKeys = keys(defaults);\n\nconst isStandardKey = makeObj(defaultKeys.filter(key => !custom[key]));\n\n// blacklisted keys that we don't double extend\nconst isBlacklisted = makeObj(\n  defaultKeys.concat(registries.map(r => r.name), ['on', 'observe', 'attributes', 'cssData', 'use'])\n);\n\nconst order = [].concat(\n  defaultKeys.filter(key => !registries[key] && !custom[key]),\n  registries,\n  //custom.data,\n  custom.template,\n  custom.css\n);\n\nfunction configure(method, Parent, target, options, Child) {\n  deprecate(options);\n\n  for (const key in options) {\n    if (hasOwn(isStandardKey, key)) {\n      const value = options[key];\n\n      // warn the developer if they passed a function and ignore its value\n\n      // NOTE: we allow some functions on \"el\" because we duck type element lists\n      // and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n      // function object as the result of querySelector methods\n      if (key !== 'el' && isFunction(value)) {\n        warnIfDebug(\n          `${key} is a Ractive option that does not expect a function and will be ignored`,\n          method === 'init' ? target : null\n        );\n      } else {\n        target[key] = value;\n      }\n    }\n  }\n\n  // disallow combination of `append` and `enhance`\n  if (target.append && target.enhance) {\n    throw new Error('Cannot use append and enhance at the same time');\n  }\n\n  registries.forEach(registry => {\n    registry[method](Parent, target, options, Child);\n  });\n\n  adaptConfigurator[method](Parent, target, options, Child);\n  templateConfigurator[method](Parent, target, options, Child);\n  cssConfigurator[method](Parent, target, options, Child);\n\n  extendOtherMethods(Parent.prototype, target, options);\n}\n\nconst _super = /\\b_super\\b/;\nfunction extendOtherMethods(parent, target, options) {\n  for (const key in options) {\n    if (!isBlacklisted[key] && hasOwn(options, key)) {\n      let member = options[key];\n\n      // if this is a method that overwrites a method, wrap it:\n      if (isFunction(member)) {\n        if (\n          (key in RactiveProto ||\n            (key.slice(0, 2) === 'on' && key.slice(2) in hooks && key in target)) &&\n          !_super.test(member.toString())\n        ) {\n          warnIfDebug(\n            `Overriding Ractive prototype function '${key}' without calling the '${_super}' method can be very dangerous.`\n          );\n        }\n        member = wrapPrototype(parent, key, member);\n      }\n\n      target[key] = member;\n    }\n  }\n}\n\nfunction makeObj(array) {\n  const obj = {};\n  array.forEach(x => (obj[x] = true));\n  return obj;\n}\n\nexport default config;\n","import { keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\n// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\n//export const booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\nexport const booleanAttributes = {\n  allowfullscreen: 1,\n  async: 1,\n  autofocus: 1,\n  autoplay: 1,\n  checked: 1,\n  compact: 1,\n  controls: 1,\n  declare: 1,\n  default: 1,\n  defaultchecked: 1,\n  defaultmuted: 1,\n  defaultselected: 1,\n  defer: 1,\n  disabled: 1,\n  enabled: 1,\n  formnovalidate: 1,\n  hidden: 1,\n  indeterminate: 1,\n  inert: 1,\n  ismap: 1,\n  itemscope: 1,\n  loop: 1,\n  multiple: 1,\n  muted: 1,\n  nohref: 1,\n  noresize: 1,\n  noshade: 1,\n  novalidate: 1,\n  nowrap: 1,\n  open: 1,\n  pauseonexit: 1,\n  readonly: 1,\n  required: 1,\n  reversed: 1,\n  scoped: 1,\n  seamless: 1,\n  selected: 1,\n  sortable: 1,\n  translate: 1,\n  truespeed: 1,\n  typemustmatch: 1,\n  visible: 1\n};\nexport const voidElements = {\n  area: 1,\n  base: 1,\n  br: 1,\n  col: 1,\n  command: 1,\n  doctype: 1,\n  embed: 1,\n  hr: 1,\n  img: 1,\n  input: 1,\n  keygen: 1,\n  link: 1,\n  meta: 1,\n  param: 1,\n  source: 1,\n  track: 1,\n  wbr: 1\n};\n\nconst htmlEntities = {\n  quot: 34,\n  amp: 38,\n  apos: 39,\n  lt: 60,\n  gt: 62,\n  nbsp: 160,\n  iexcl: 161,\n  cent: 162,\n  pound: 163,\n  curren: 164,\n  yen: 165,\n  brvbar: 166,\n  sect: 167,\n  uml: 168,\n  copy: 169,\n  ordf: 170,\n  laquo: 171,\n  not: 172,\n  shy: 173,\n  reg: 174,\n  macr: 175,\n  deg: 176,\n  plusmn: 177,\n  sup2: 178,\n  sup3: 179,\n  acute: 180,\n  micro: 181,\n  para: 182,\n  middot: 183,\n  cedil: 184,\n  sup1: 185,\n  ordm: 186,\n  raquo: 187,\n  frac14: 188,\n  frac12: 189,\n  frac34: 190,\n  iquest: 191,\n  Agrave: 192,\n  Aacute: 193,\n  Acirc: 194,\n  Atilde: 195,\n  Auml: 196,\n  Aring: 197,\n  AElig: 198,\n  Ccedil: 199,\n  Egrave: 200,\n  Eacute: 201,\n  Ecirc: 202,\n  Euml: 203,\n  Igrave: 204,\n  Iacute: 205,\n  Icirc: 206,\n  Iuml: 207,\n  ETH: 208,\n  Ntilde: 209,\n  Ograve: 210,\n  Oacute: 211,\n  Ocirc: 212,\n  Otilde: 213,\n  Ouml: 214,\n  times: 215,\n  Oslash: 216,\n  Ugrave: 217,\n  Uacute: 218,\n  Ucirc: 219,\n  Uuml: 220,\n  Yacute: 221,\n  THORN: 222,\n  szlig: 223,\n  agrave: 224,\n  aacute: 225,\n  acirc: 226,\n  atilde: 227,\n  auml: 228,\n  aring: 229,\n  aelig: 230,\n  ccedil: 231,\n  egrave: 232,\n  eacute: 233,\n  ecirc: 234,\n  euml: 235,\n  igrave: 236,\n  iacute: 237,\n  icirc: 238,\n  iuml: 239,\n  eth: 240,\n  ntilde: 241,\n  ograve: 242,\n  oacute: 243,\n  ocirc: 244,\n  otilde: 245,\n  ouml: 246,\n  divide: 247,\n  oslash: 248,\n  ugrave: 249,\n  uacute: 250,\n  ucirc: 251,\n  uuml: 252,\n  yacute: 253,\n  thorn: 254,\n  yuml: 255,\n  OElig: 338,\n  oelig: 339,\n  Scaron: 352,\n  scaron: 353,\n  Yuml: 376,\n  fnof: 402,\n  circ: 710,\n  tilde: 732,\n  Alpha: 913,\n  Beta: 914,\n  Gamma: 915,\n  Delta: 916,\n  Epsilon: 917,\n  Zeta: 918,\n  Eta: 919,\n  Theta: 920,\n  Iota: 921,\n  Kappa: 922,\n  Lambda: 923,\n  Mu: 924,\n  Nu: 925,\n  Xi: 926,\n  Omicron: 927,\n  Pi: 928,\n  Rho: 929,\n  Sigma: 931,\n  Tau: 932,\n  Upsilon: 933,\n  Phi: 934,\n  Chi: 935,\n  Psi: 936,\n  Omega: 937,\n  alpha: 945,\n  beta: 946,\n  gamma: 947,\n  delta: 948,\n  epsilon: 949,\n  zeta: 950,\n  eta: 951,\n  theta: 952,\n  iota: 953,\n  kappa: 954,\n  lambda: 955,\n  mu: 956,\n  nu: 957,\n  xi: 958,\n  omicron: 959,\n  pi: 960,\n  rho: 961,\n  sigmaf: 962,\n  sigma: 963,\n  tau: 964,\n  upsilon: 965,\n  phi: 966,\n  chi: 967,\n  psi: 968,\n  omega: 969,\n  thetasym: 977,\n  upsih: 978,\n  piv: 982,\n  ensp: 8194,\n  emsp: 8195,\n  thinsp: 8201,\n  zwnj: 8204,\n  zwj: 8205,\n  lrm: 8206,\n  rlm: 8207,\n  ndash: 8211,\n  mdash: 8212,\n  lsquo: 8216,\n  rsquo: 8217,\n  sbquo: 8218,\n  ldquo: 8220,\n  rdquo: 8221,\n  bdquo: 8222,\n  dagger: 8224,\n  Dagger: 8225,\n  bull: 8226,\n  hellip: 8230,\n  permil: 8240,\n  prime: 8242,\n  Prime: 8243,\n  lsaquo: 8249,\n  rsaquo: 8250,\n  oline: 8254,\n  frasl: 8260,\n  euro: 8364,\n  image: 8465,\n  weierp: 8472,\n  real: 8476,\n  trade: 8482,\n  alefsym: 8501,\n  larr: 8592,\n  uarr: 8593,\n  rarr: 8594,\n  darr: 8595,\n  harr: 8596,\n  crarr: 8629,\n  lArr: 8656,\n  uArr: 8657,\n  rArr: 8658,\n  dArr: 8659,\n  hArr: 8660,\n  forall: 8704,\n  part: 8706,\n  exist: 8707,\n  empty: 8709,\n  nabla: 8711,\n  isin: 8712,\n  notin: 8713,\n  ni: 8715,\n  prod: 8719,\n  sum: 8721,\n  minus: 8722,\n  lowast: 8727,\n  radic: 8730,\n  prop: 8733,\n  infin: 8734,\n  ang: 8736,\n  and: 8743,\n  or: 8744,\n  cap: 8745,\n  cup: 8746,\n  int: 8747,\n  there4: 8756,\n  sim: 8764,\n  cong: 8773,\n  asymp: 8776,\n  ne: 8800,\n  equiv: 8801,\n  le: 8804,\n  ge: 8805,\n  sub: 8834,\n  sup: 8835,\n  nsub: 8836,\n  sube: 8838,\n  supe: 8839,\n  oplus: 8853,\n  otimes: 8855,\n  perp: 8869,\n  sdot: 8901,\n  lceil: 8968,\n  rceil: 8969,\n  lfloor: 8970,\n  rfloor: 8971,\n  lang: 9001,\n  rang: 9002,\n  loz: 9674,\n  spades: 9824,\n  clubs: 9827,\n  hearts: 9829,\n  diams: 9830\n};\nconst controlCharacters = [\n  8364,\n  129,\n  8218,\n  402,\n  8222,\n  8230,\n  8224,\n  8225,\n  710,\n  8240,\n  352,\n  8249,\n  338,\n  141,\n  381,\n  143,\n  144,\n  8216,\n  8217,\n  8220,\n  8221,\n  8226,\n  8211,\n  8212,\n  732,\n  8482,\n  353,\n  8250,\n  339,\n  157,\n  382,\n  376\n];\nconst entityPattern = new RegExp(\n  '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + keys(htmlEntities).join('|') + '));?',\n  'g'\n);\nconst codePointSupport = isFunction(String.fromCodePoint);\nconst codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\n\nexport function decodeCharacterReferences(html) {\n  return html.replace(entityPattern, (match, entity) => {\n    let code;\n\n    // Handle named entities\n    if (entity[0] !== '#') {\n      code = htmlEntities[entity];\n    } else if (entity[1] === 'x') {\n      code = parseInt(entity.substring(2), 16);\n    } else {\n      code = parseInt(entity.substring(1), 10);\n    }\n\n    if (!code) {\n      return match;\n    }\n\n    return codeToChar(validateCode(code));\n  });\n}\n\nconst lessThan = /</g;\nconst greaterThan = />/g;\nconst amp = /&/g;\nconst invalid = 65533;\n\nexport function escapeHtml(str) {\n  return str\n    .replace(amp, '&amp;')\n    .replace(lessThan, '&lt;')\n    .replace(greaterThan, '&gt;');\n}\n\n// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n// to replace them ourselves\n//\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\n/* istanbul ignore next */\nfunction validateCode(code) {\n  if (!code) {\n    return invalid;\n  }\n\n  // line feed becomes generic whitespace\n  if (code === 10) {\n    return 32;\n  }\n\n  // ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n  if (code < 128) {\n    return code;\n  }\n\n  // code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n  // to correct the mistake or we'll end up with missing € signs and so on\n  if (code <= 159) {\n    return controlCharacters[code - 128];\n  }\n\n  // basic multilingual plane\n  if (code < 55296) {\n    return code;\n  }\n\n  // UTF-16 surrogate halves\n  if (code <= 57343) {\n    return invalid;\n  }\n\n  // rest of the basic multilingual plane\n  if (code <= 65535) {\n    return code;\n  } else if (!codePointSupport) {\n    return invalid;\n  }\n\n  // supplementary multilingual plane 0x10000 - 0x1ffff\n  if (code >= 65536 && code <= 131071) {\n    return code;\n  }\n\n  // supplementary ideographic plane 0x20000 - 0x2ffff\n  if (code >= 131072 && code <= 196607) {\n    return code;\n  }\n\n  return invalid;\n}\n","import { createDocumentFragment } from 'utils/dom';\nimport noop from 'utils/noop';\n\nexport default class Item {\n  constructor(options) {\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n\n    this.template = options.template;\n    this.index = options.index;\n    this.type = options.template.t;\n\n    this.dirty = false;\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  find() {\n    return null;\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  findNextNode() {\n    return this.up.findNextNode(this);\n  }\n\n  rebound(update) {\n    if (this.fragment) this.fragment.rebound(update);\n  }\n\n  shuffled() {\n    if (this.fragment) this.fragment.shuffled();\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n}\n\nItem.prototype.findAll = noop;\nItem.prototype.findAllComponents = noop;\n\nexport class ContainerItem extends Item {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    return this.fragment ? this.fragment.detach() : createDocumentFragment();\n  }\n\n  find(selector) {\n    if (this.fragment) {\n      return this.fragment.find(selector);\n    }\n  }\n\n  findAll(selector, options) {\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findComponent(name) {\n    if (this.fragment) {\n      return this.fragment.findComponent(name);\n    }\n  }\n\n  findAllComponents(name, options) {\n    if (this.fragment) {\n      this.fragment.findAllComponents(name, options);\n    }\n  }\n\n  firstNode(skipParent) {\n    return this.fragment && this.fragment.firstNode(skipParent);\n  }\n\n  toString(escape) {\n    return this.fragment ? this.fragment.toString(escape) : '';\n  }\n}\n","import cleanCss from 'utils/cleanCss';\nimport { isString } from 'utils/is';\n\nconst space = /\\s+/;\n\nexport function readStyle(css) {\n  if (!isString(css)) return {};\n\n  return cleanCss(css, (css, reconstruct) => {\n    return css\n      .split(';')\n      .filter(rule => !!rule.trim())\n      .map(reconstruct)\n      .reduce((rules, rule) => {\n        const i = rule.indexOf(':');\n        const name = rule.substr(0, i).trim();\n        rules[name] = rule.substr(i + 1).trim();\n        return rules;\n      }, {});\n  });\n}\n\nexport function readClass(str) {\n  const list = str.split(space);\n\n  // remove any empty entries\n  let i = list.length;\n  while (i--) {\n    if (!list[i]) list.splice(i, 1);\n  }\n\n  return list;\n}\n","import { html } from 'config/namespaces';\nimport { safeToStringValue } from 'utils/dom';\nimport { arrayContains } from 'utils/array';\nimport noop from 'utils/noop';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport { readStyle, readClass } from 'src/view/helpers/specialAttrs';\nimport { keys as objectKeys } from 'utils/object';\nimport { isArray, isString, isUndefined } from 'utils/is';\n\nconst textTypes = [\n  undefined,\n  'text',\n  'search',\n  'url',\n  'email',\n  'hidden',\n  'password',\n  'search',\n  'reset',\n  'submit'\n];\n\nexport default function getUpdateDelegate(attribute) {\n  const { element, name } = attribute;\n\n  if (name === 'value') {\n    if (attribute.interpolator) attribute.interpolator.bound = true;\n\n    // special case - selects\n    if (element.name === 'select' && name === 'value') {\n      return element.getAttribute('multiple') ? updateMultipleSelectValue : updateSelectValue;\n    }\n\n    if (element.name === 'textarea') return updateStringValue;\n\n    // special case - contenteditable\n    if (element.getAttribute('contenteditable') != null) return updateContentEditableValue;\n\n    // special case - <input>\n    if (element.name === 'input') {\n      const type = element.getAttribute('type');\n\n      // type='file' value='{{fileList}}'>\n      if (type === 'file') return noop; // read-only\n\n      // type='radio' name='{{twoway}}'\n      if (type === 'radio' && element.binding && element.binding.attribute.name === 'name')\n        return updateRadioValue;\n\n      if (~textTypes.indexOf(type)) return updateStringValue;\n    }\n\n    return updateValue;\n  }\n\n  const node = element.node;\n\n  // special case - <input type='radio' name='{{twoway}}' value='foo'>\n  if (attribute.isTwoway && name === 'name') {\n    if (node.type === 'radio') return updateRadioName;\n    if (node.type === 'checkbox') return updateCheckboxName;\n  }\n\n  if (name === 'style') return updateStyleAttribute;\n\n  if (name.indexOf('style-') === 0) return updateInlineStyle;\n\n  // special case - class names. IE fucks things up, again\n  if (name === 'class' && (!node.namespaceURI || node.namespaceURI === html))\n    return updateClassName;\n\n  if (name.indexOf('class-') === 0) return updateInlineClass;\n\n  if (attribute.isBoolean) {\n    const type = element.getAttribute('type');\n    if (attribute.interpolator && name === 'checked' && (type === 'checkbox' || type === 'radio'))\n      attribute.interpolator.bound = true;\n    return updateBoolean;\n  }\n\n  if (attribute.namespace && attribute.namespace !== attribute.node.namespaceURI)\n    return updateNamespacedAttribute;\n\n  return updateAttribute;\n}\n\nfunction updateMultipleSelectValue(reset) {\n  let value = this.getValue();\n\n  if (!isArray(value)) value = [value];\n\n  const options = this.node.options;\n  let i = options.length;\n\n  if (reset) {\n    while (i--) options[i].selected = false;\n  } else {\n    while (i--) {\n      const option = options[i];\n      const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n\n      option.selected = arrayContains(value, optionValue);\n    }\n  }\n}\n\nfunction updateSelectValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    // TODO is locked still a thing?\n    this.node._ractive.value = value;\n\n    const options = this.node.options;\n    let i = options.length;\n    let wasSelected = false;\n\n    if (reset) {\n      while (i--) options[i].selected = false;\n    } else {\n      while (i--) {\n        const option = options[i];\n        const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n        if (option.disabled && option.selected) wasSelected = true;\n\n        if (optionValue == value) {\n          // double equals as we may be comparing numbers with strings\n          option.selected = true;\n          return;\n        }\n      }\n    }\n\n    if (!wasSelected) this.node.selectedIndex = -1;\n  }\n}\n\nfunction updateContentEditableValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    if (reset) this.node.innerHTML = '';\n    else this.node.innerHTML = isUndefined(value) ? '' : value;\n  }\n}\n\nfunction updateRadioValue(reset) {\n  const node = this.node;\n  const wasChecked = node.checked;\n\n  const value = this.getValue();\n\n  if (reset) return (node.checked = false);\n\n  //node.value = this.element.getAttribute( 'value' );\n  node.value = this.node._ractive.value = value;\n  node.checked = this.element.compare(value, this.element.getAttribute('name'));\n\n  // This is a special case - if the input was checked, and the value\n  // changed so that it's no longer checked, the twoway binding is\n  // most likely out of date. To fix it we have to jump through some\n  // hoops... this is a little kludgy but it works\n  if (wasChecked && !node.checked && this.element.binding && this.element.binding.rendered) {\n    this.element.binding.group.model.set(this.element.binding.group.getValue());\n  }\n}\n\nfunction updateValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node.removeAttribute('value');\n      this.node.value = this.node._ractive.value = null;\n    } else {\n      const value = this.getValue();\n\n      this.node.value = this.node._ractive.value = value;\n      this.node.setAttribute('value', safeToStringValue(value));\n    }\n  }\n}\n\nfunction updateStringValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node._ractive.value = '';\n      this.node.removeAttribute('value');\n    } else {\n      const value = this.getValue();\n\n      this.node._ractive.value = value;\n\n      const safeValue = safeToStringValue(value);\n\n      // fixes #3281 – Safari moves caret position when setting an input value to the same value\n      if (this.node.value !== safeValue) {\n        this.node.value = safeValue;\n      }\n\n      this.node.setAttribute('value', safeValue);\n    }\n  }\n}\n\nfunction updateRadioName(reset) {\n  if (reset) this.node.checked = false;\n  else this.node.checked = this.element.compare(this.getValue(), this.element.binding.getValue());\n}\n\nfunction updateCheckboxName(reset) {\n  const { element, node } = this;\n  const binding = element.binding;\n\n  const value = this.getValue();\n  const valueAttribute = element.getAttribute('value');\n\n  if (reset) {\n    // TODO: WAT?\n  }\n\n  if (!isArray(value)) {\n    binding.isChecked = node.checked = element.compare(value, valueAttribute);\n  } else {\n    let i = value.length;\n    while (i--) {\n      if (element.compare(valueAttribute, value[i])) {\n        binding.isChecked = node.checked = true;\n        return;\n      }\n    }\n    binding.isChecked = node.checked = false;\n  }\n}\n\nfunction updateStyleAttribute(reset) {\n  const props = reset ? {} : readStyle(this.getValue() || '');\n  const style = this.node.style;\n  const keys = objectKeys(props);\n  const prev = this.previous || [];\n\n  let i = 0;\n  while (i < keys.length) {\n    if (keys[i] in style) {\n      const safe = props[keys[i]].replace('!important', '');\n      style.setProperty(keys[i], safe, safe.length !== props[keys[i]].length ? 'important' : '');\n    }\n    i++;\n  }\n\n  // remove now-missing attrs\n  i = prev.length;\n  while (i--) {\n    if (!~keys.indexOf(prev[i]) && prev[i] in style) style.setProperty(prev[i], '', '');\n  }\n\n  this.previous = keys;\n}\n\nfunction updateInlineStyle(reset) {\n  if (!this.style) {\n    this.style = hyphenateCamel(this.name.substr(6));\n  }\n\n  if (reset && this.node.style.getPropertyValue(this.style) !== this.last) return;\n\n  const value = reset ? '' : safeToStringValue(this.getValue());\n  const safe = value.replace('!important', '');\n  this.node.style.setProperty(this.style, safe, safe.length !== value.length ? 'important' : '');\n  this.last = this.node.style.getPropertyValue(this.style);\n}\n\nfunction updateClassName(reset) {\n  const value = reset ? [] : readClass(safeToStringValue(this.getValue()));\n\n  // watch out for weirdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const prev = this.previous || [];\n\n  const className = value.concat(attr.filter(c => !~prev.indexOf(c))).join(' ');\n\n  if (className !== cls) {\n    if (!isString(this.node.className)) {\n      this.node.className.baseVal = className;\n    } else {\n      this.node.className = className;\n    }\n  }\n\n  this.previous = value;\n}\n\nfunction updateInlineClass(reset) {\n  const name = this.name.substr(6);\n\n  // watch out for weirdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const value = reset ? false : this.getValue();\n\n  if (!this.inlineClass) this.inlineClass = name;\n\n  if (value && !~attr.indexOf(name)) attr.push(name);\n  else if (!value && ~attr.indexOf(name)) attr.splice(attr.indexOf(name), 1);\n\n  if (!isString(this.node.className)) {\n    this.node.className.baseVal = attr.join(' ');\n  } else {\n    this.node.className = attr.join(' ');\n  }\n}\n\nfunction updateBoolean(reset) {\n  // with two-way binding, only update if the change wasn't initiated by the user\n  // otherwise the cursor will often be sent to the wrong place\n  if (!this.locked) {\n    if (reset) {\n      if (this.useProperty) this.node[this.propertyName] = false;\n      this.node.removeAttribute(this.propertyName);\n    } else {\n      if (this.useProperty) {\n        this.node[this.propertyName] = this.getValue();\n      } else {\n        const val = this.getValue();\n        if (val) {\n          this.node.setAttribute(this.propertyName, isString(val) ? val : '');\n        } else {\n          this.node.removeAttribute(this.propertyName);\n        }\n      }\n    }\n  }\n}\n\nexport function updateAttribute(reset) {\n  if (reset) {\n    if (this.node.getAttribute(this.name) === this.value) {\n      this.node.removeAttribute(this.name);\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttribute(this.name, this.value);\n  }\n}\n\nexport function updateNamespacedAttribute(reset) {\n  if (reset) {\n    if (\n      this.value ===\n      this.node.getAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1))\n    ) {\n      this.node.removeAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1));\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttributeNS(\n      this.namespace,\n      this.name.slice(this.name.indexOf(':') + 1),\n      this.value\n    );\n  }\n}\n","export default {\n  'accept-charset': 'acceptCharset',\n  accesskey: 'accessKey',\n  bgcolor: 'bgColor',\n  class: 'className',\n  codebase: 'codeBase',\n  colspan: 'colSpan',\n  contenteditable: 'contentEditable',\n  datetime: 'dateTime',\n  dirname: 'dirName',\n  for: 'htmlFor',\n  'http-equiv': 'httpEquiv',\n  ismap: 'isMap',\n  maxlength: 'maxLength',\n  novalidate: 'noValidate',\n  pubdate: 'pubDate',\n  readonly: 'readOnly',\n  rowspan: 'rowSpan',\n  tabindex: 'tabIndex',\n  usemap: 'useMap'\n};\n","import { doc } from 'config/environment';\nimport { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\n\nconst div = doc ? createElement('div') : null;\n\nlet attributes = false;\nexport function inAttributes() {\n  return attributes;\n}\n\nexport default class ConditionalAttribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.attributes = [];\n\n    this.owner = options.owner;\n\n    this.fragment = new Fragment({\n      ractive: this.ractive,\n      owner: this,\n      template: this.template\n    });\n\n    // this fragment can't participate in node-y things\n    this.fragment.findNextNode = noop;\n\n    this.dirty = false;\n  }\n\n  bind() {\n    this.fragment.bind();\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.owner.bubble();\n    }\n  }\n\n  destroyed() {\n    this.unrender();\n  }\n\n  render() {\n    this.node = this.owner.node;\n    if (this.node) {\n      this.isSvg = this.node.namespaceURI === svg;\n    }\n\n    attributes = true;\n    if (!this.rendered) this.fragment.render();\n\n    this.rendered = true;\n    this.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n    this.update();\n    attributes = false;\n  }\n\n  toString() {\n    return this.fragment.toString();\n  }\n\n  unbind(view) {\n    this.fragment.unbind(view);\n  }\n\n  unrender() {\n    this.rendered = false;\n    this.fragment.unrender();\n  }\n\n  update() {\n    let str;\n    let attrs;\n\n    if (this.dirty) {\n      this.dirty = false;\n\n      const current = attributes;\n      attributes = true;\n      this.fragment.update();\n\n      if (this.rendered && this.node) {\n        str = this.fragment.toString();\n\n        attrs = parseAttributes(str, this.isSvg);\n\n        // any attributes that previously existed but no longer do\n        // must be removed\n        this.attributes\n          .filter(a => notIn(attrs, a))\n          .forEach(a => {\n            this.node.removeAttribute(a.name);\n          });\n\n        attrs.forEach(a => {\n          this.node.setAttribute(a.name, a.value);\n        });\n\n        this.attributes = attrs;\n      }\n\n      attributes = current || false;\n    }\n  }\n}\n\nconst onlyWhitespace = /^\\s*$/;\nfunction parseAttributes(str, isSvg) {\n  if (onlyWhitespace.test(str)) return [];\n  const tagName = isSvg ? 'svg' : 'div';\n  return str\n    ? (div.innerHTML = `<${tagName} ${str}></${tagName}>`) && toArray(div.childNodes[0].attributes)\n    : [];\n}\n\nfunction notIn(haystack, needle) {\n  let i = haystack.length;\n\n  while (i--) {\n    if (haystack[i].name === needle.name) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import { INTERPOLATOR } from 'config/types';\nimport namespaces from 'config/namespaces';\nimport { safeAttributeString } from 'utils/dom';\nimport { booleanAttributes } from 'utils/html';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\nimport findElement from '../shared/findElement';\nimport getUpdateDelegate from './attribute/getUpdateDelegate';\nimport propertyNames from './attribute/propertyNames';\nimport { inAttributes } from './ConditionalAttribute';\nimport { isArray, isString, isUndefined } from 'utils/is';\n\nfunction lookupNamespace(node, prefix) {\n  const qualified = `xmlns:${prefix}`;\n\n  while (node) {\n    if (node.hasAttribute && node.hasAttribute(qualified)) return node.getAttribute(qualified);\n    node = node.parentNode;\n  }\n\n  return namespaces[prefix];\n}\n\nlet attribute = false;\nexport function inAttribute() {\n  return attribute;\n}\n\nexport default class Attribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n    this.namespace = null;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = options.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.rendered = false;\n    this.updateDelegate = null;\n    this.fragment = null;\n\n    this.element.attributeByName[this.name] = this;\n\n    if (!isArray(options.template.f)) {\n      this.value = options.template.f;\n      if (this.value === 0) {\n        this.value = '';\n      } else if (isUndefined(this.value)) {\n        this.value = true;\n      }\n      return;\n    } else {\n      this.fragment = new Fragment({\n        owner: this,\n        template: options.template.f\n      });\n    }\n\n    this.interpolator =\n      this.fragment &&\n      this.fragment.items.length === 1 &&\n      this.fragment.items[0].type === INTERPOLATOR &&\n      this.fragment.items[0];\n\n    if (this.interpolator) this.interpolator.owner = this;\n  }\n\n  bind() {\n    if (this.fragment) {\n      this.fragment.bind();\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.up.bubble();\n      this.element.bubble();\n      this.dirty = true;\n    }\n  }\n\n  firstNode() {}\n\n  getString() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.toString()\n      : this.value != null\n      ? '' + this.value\n      : '';\n    attribute = false;\n    return value;\n  }\n\n  // TODO could getValue ever be called for a static attribute,\n  // or can we assume that this.fragment exists?\n  getValue() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.valueOf()\n      : booleanAttributes[this.name.toLowerCase()]\n      ? true\n      : this.value;\n    attribute = false;\n    return value;\n  }\n\n  render() {\n    const node = this.element.node;\n    this.node = node;\n\n    // should we use direct property access, or setAttribute?\n    if (!node.namespaceURI || node.namespaceURI === namespaces.html) {\n      this.propertyName = propertyNames[this.name] || this.name;\n\n      if (node[this.propertyName] !== undefined) {\n        this.useProperty = true;\n      }\n\n      // is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n      // node.selected = true rather than node.setAttribute( 'selected', '' )\n      if (booleanAttributes[this.name.toLowerCase()] || this.isTwoway) {\n        this.isBoolean = true;\n      }\n\n      if (this.propertyName === 'value') {\n        node._ractive.value = this.value;\n      }\n    }\n\n    if (node.namespaceURI) {\n      const index = this.name.indexOf(':');\n      if (index !== -1) {\n        this.namespace = lookupNamespace(node, this.name.slice(0, index));\n      } else {\n        this.namespace = node.namespaceURI;\n      }\n    }\n\n    this.rendered = true;\n    this.updateDelegate = getUpdateDelegate(this);\n    this.updateDelegate();\n  }\n\n  toString() {\n    if (inAttributes()) return '';\n    attribute = true;\n\n    const value = this.getValue();\n\n    // Special case - select and textarea values (should not be stringified)\n    if (\n      this.name === 'value' &&\n      (this.element.getAttribute('contenteditable') !== undefined ||\n        (this.element.name === 'select' || this.element.name === 'textarea'))\n    ) {\n      return;\n    }\n\n    // Special case – bound radio `name` attributes\n    if (\n      this.name === 'name' &&\n      this.element.name === 'input' &&\n      this.interpolator &&\n      this.element.getAttribute('type') === 'radio'\n    ) {\n      return `name=\"{{${this.interpolator.model.getKeypath()}}}\"`;\n    }\n\n    // Special case - style and class attributes and directives\n    if (\n      this.owner === this.element &&\n      (this.name === 'style' || this.name === 'class' || this.style || this.inlineClass)\n    ) {\n      return;\n    }\n\n    if (\n      !this.rendered &&\n      this.owner === this.element &&\n      (!this.name.indexOf('style-') || !this.name.indexOf('class-'))\n    ) {\n      if (!this.name.indexOf('style-')) {\n        this.style = hyphenateCamel(this.name.substr(6));\n      } else {\n        this.inlineClass = this.name.substr(6);\n      }\n\n      return;\n    }\n\n    if (booleanAttributes[this.name.toLowerCase()])\n      return value\n        ? isString(value)\n          ? `${this.name}=\"${safeAttributeString(value)}\"`\n          : this.name\n        : '';\n    if (value == null) return '';\n\n    const str = safeAttributeString(this.getString());\n    attribute = false;\n\n    return str ? `${this.name}=\"${str}\"` : this.name;\n  }\n\n  unbind(view) {\n    if (this.fragment) this.fragment.unbind(view);\n  }\n\n  unrender() {\n    this.updateDelegate(true);\n\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      let binding;\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      if (this.rendered) this.updateDelegate();\n      if (this.isTwoway && !this.locked) {\n        this.interpolator.twowayBinding.lastVal(true, this.interpolator.model.get());\n      } else if (this.name === 'value' && (binding = this.element.binding)) {\n        // special case: name bound element with dynamic value\n        const attr = binding.attribute;\n        if (attr && !attr.dirty && attr.rendered) {\n          this.element.binding.attribute.updateDelegate();\n        }\n      }\n    }\n  }\n}\n","import { INTERPOLATOR, ELEMENT } from 'config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport { isArray } from 'utils/is';\n\nexport default class BindingFlag extends Item {\n  constructor(options) {\n    super(options);\n\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.flag = options.template.v === 'l' ? 'lazy' : 'twoway';\n    this.bubbler = this.owner === this.element ? this.element : this.up;\n\n    if (this.element.type === ELEMENT) {\n      if (isArray(options.template.f)) {\n        this.fragment = new Fragment({\n          owner: this,\n          template: options.template.f\n        });\n      }\n\n      this.interpolator =\n        this.fragment &&\n        this.fragment.items.length === 1 &&\n        this.fragment.items[0].type === INTERPOLATOR &&\n        this.fragment.items[0];\n    }\n  }\n\n  bind() {\n    if (this.fragment) this.fragment.bind();\n    set(this, this.getValue(), true);\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.bubbler.bubble();\n      this.dirty = true;\n    }\n  }\n\n  getValue() {\n    if (this.fragment) return this.fragment.valueOf();\n    else if ('value' in this) return this.value;\n    else if ('f' in this.template) return this.template.f;\n    else return true;\n  }\n\n  render() {\n    set(this, this.getValue(), true);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind(view) {\n    if (this.fragment) this.fragment.unbind(view);\n\n    delete this.element[this.flag];\n  }\n\n  unrender() {\n    if (this.element.rendered) this.element.recreateTwowayBinding();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      set(this, this.getValue(), true);\n    }\n  }\n}\n\nfunction set(flag, value, update) {\n  if (value === 0) {\n    flag.value = true;\n  } else if (value === 'true') {\n    flag.value = true;\n  } else if (value === 'false' || value === '0') {\n    flag.value = false;\n  } else {\n    flag.value = value;\n  }\n\n  const current = flag.element[flag.flag];\n  flag.element[flag.flag] = flag.value;\n  if (update && !flag.element.attributes.binding && current !== flag.value) {\n    flag.element.recreateTwowayBinding();\n  }\n\n  return flag.value;\n}\n","import Item from './shared/Item';\nimport noop from 'utils/noop';\nimport { detachNode } from 'utils/dom';\nimport { doc } from 'config/environment';\nimport { assign, create } from 'utils/object';\n\nexport default function Comment(options) {\n  Item.call(this, options);\n}\n\nconst proto = create(Item.prototype);\n\nassign(proto, {\n  bind: noop,\n  unbind: noop,\n  update: noop,\n\n  detach() {\n    return detachNode(this.node);\n  },\n\n  firstNode() {\n    return this.node;\n  },\n\n  render(target) {\n    this.rendered = true;\n\n    this.node = doc.createComment(this.template.c);\n    target.appendChild(this.node);\n  },\n\n  toString() {\n    return `<!-- ${this.template.c} -->`;\n  },\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n});\n\nComment.prototype = proto;\n","import { SharedModel } from './SharedModel';\nimport { Missing } from '../LinkModel';\nimport { create } from 'utils/object';\n\nexport default class RactiveModel extends SharedModel {\n  constructor(ractive) {\n    super(ractive, '@this');\n    this.ractive = ractive;\n  }\n\n  joinKey(key) {\n    const model = super.joinKey(key);\n\n    if ((key === 'root' || key === 'parent') && !model.isLink) return initLink(model, key);\n    else if (key === 'data') return this.ractive.viewmodel;\n    else if (key === 'cssData') return this.ractive.constructor._cssModel;\n\n    return model;\n  }\n}\n\nfunction initLink(model, key) {\n  model.applyValue = function(value) {\n    this.parent.value[key] = value;\n    if (value && value.viewmodel) {\n      this.link(value.viewmodel.getRactiveModel(), key);\n      this._link.markedAll();\n    } else {\n      this.link(create(Missing), key);\n      this._link.markedAll();\n    }\n  };\n\n  if (key === 'root') {\n    const mark = model.mark;\n    model.mark = function(force) {\n      if (this._marking) return;\n      this._marking = true;\n      mark.apply(this, force);\n      this._marking = false;\n    };\n  }\n\n  model.applyValue(model.parent.ractive[key], key);\n  model._link.set = v => model.applyValue(v);\n  model._link.applyValue = v => model.applyValue(v);\n\n  return model._link;\n}\n","import { capture } from 'src/global/capture';\nimport Model from './Model';\nimport { handleChange, mark } from 'shared/methodCallers';\nimport RactiveModel from './specials/RactiveModel';\nimport SharedModel, { GlobalModel, SharedModel as SharedBase } from './specials/SharedModel';\nimport { splitKeypath, unescapeKey } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\n\nconst specialModels = {\n  '@this'(root) {\n    return root.getRactiveModel();\n  },\n  '@global'() {\n    return GlobalModel;\n  },\n  '@shared'() {\n    return SharedModel;\n  },\n  '@style'(root) {\n    return root.getRactiveModel().joinKey('cssData');\n  },\n  '@helpers'(root) {\n    return root.getHelpers();\n  }\n};\nspecialModels['@'] = specialModels['@this'];\n\nexport default class RootModel extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.ractive = options.ractive; // TODO sever this link\n\n    this.value = options.data;\n    this.adaptors = options.adapt;\n    this.adapt();\n  }\n\n  attached(fragment) {\n    attachImplicits(this, fragment);\n  }\n\n  createLink(keypath, target, targetPath, options) {\n    const keys = splitKeypath(keypath);\n\n    let model = this;\n    while (keys.length) {\n      const key = keys.shift();\n      model = model.childByKey[key] || model.joinKey(key);\n    }\n\n    return model.link(target, targetPath, options);\n  }\n\n  detached() {\n    detachImplicits(this);\n  }\n\n  get(shouldCapture, options) {\n    if (shouldCapture) capture(this);\n\n    if (!options || options.virtual !== false) {\n      return this.getVirtual();\n    } else {\n      return this.value;\n    }\n  }\n\n  getHelpers() {\n    if (!this.helpers) this.helpers = new SharedBase(this.ractive.helpers, 'helpers', this.ractive);\n    return this.helpers;\n  }\n\n  getKeypath() {\n    return '';\n  }\n\n  getRactiveModel() {\n    return this.ractiveModel || (this.ractiveModel = new RactiveModel(this.ractive));\n  }\n\n  getValueChildren() {\n    const children = super.getValueChildren(this.value);\n\n    this.children.forEach(child => {\n      if (child._link) {\n        const idx = children.indexOf(child);\n        if (~idx) children.splice(idx, 1, child._link);\n        else children.push(child._link);\n      }\n    });\n\n    return children;\n  }\n\n  has(key) {\n    if (key[0] === '~' && key[1] === '/') key = key.slice(2);\n    if (specialModels[key] || key === '') return true;\n\n    if (super.has(key)) {\n      return true;\n    } else {\n      const unescapedKey = unescapeKey(key);\n\n      // mappings/links and computations\n      if (this.childByKey[unescapedKey] && this.childByKey[unescapedKey]._link) return true;\n    }\n  }\n\n  joinKey(key, opts) {\n    if (key[0] === '~' && key[1] === '/') key = key.slice(2);\n\n    if (key[0] === '@') {\n      const fn = specialModels[key];\n      if (fn) return fn(this);\n    } else {\n      return super.joinKey(key, opts);\n    }\n  }\n\n  set(value) {\n    // TODO wrapping root node is a baaaad idea. We should prevent this\n    const wrapper = this.wrapper;\n    if (wrapper) {\n      const shouldTeardown = !wrapper.reset || wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        wrapper.teardown();\n        this.wrapper = null;\n        this.value = value;\n        this.adapt();\n      }\n    } else {\n      this.value = value;\n      this.adapt();\n    }\n\n    this.deps.forEach(handleChange);\n    this.children.forEach(mark);\n  }\n\n  retrieve() {\n    return this.wrapper ? this.wrapper.get() : this.value;\n  }\n\n  teardown() {\n    super.teardown();\n    this.ractiveModel && this.ractiveModel.teardown();\n  }\n}\nRootModel.prototype.update = noop;\n\nfunction attachImplicits(model, fragment) {\n  if (model._link && model._link.implicit && model._link.isDetached()) {\n    model.attach(fragment);\n  }\n\n  // look for virtual children to relink and cascade\n  for (const k in model.childByKey) {\n    if (model.value) {\n      if (k in model.value) {\n        attachImplicits(model.childByKey[k], fragment);\n      } else if (!model.childByKey[k]._link || model.childByKey[k]._link.isDetached()) {\n        const mdl = resolveReference(fragment, k);\n        if (mdl) {\n          model.childByKey[k].link(mdl, k, { implicit: true });\n        }\n      }\n    }\n  }\n}\n\nfunction detachImplicits(model) {\n  if (model._link && model._link.implicit) {\n    model.unlink();\n  }\n\n  for (const k in model.childByKey) {\n    detachImplicits(model.childByKey[k]);\n  }\n}\n","import { fatal, warnIfDebug, welcome } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { ensureArray, combine } from 'utils/array';\nimport { findInViewHierarchy } from 'shared/registry';\nimport dataConfigurator from './config/custom/data';\nimport RootModel from 'src/model/RootModel';\nimport hooks from 'src/events/Hook';\nimport subscribe from './helpers/subscribe';\nimport Ractive from '../Ractive';\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, INTERPOLATOR, TRANSITION } from 'config/types';\nimport { assign, create, hasOwn } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\nimport { compute } from 'src/Ractive/prototype/compute';\nimport getRactiveContext from '../shared/getRactiveContext';\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'decorators',\n  'easing',\n  'events',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nconst protoRegistries = ['computed', 'helpers'];\n\nlet uid = 0;\n\nexport default function construct(ractive, options) {\n  if (Ractive.DEBUG) welcome();\n\n  initialiseProperties(ractive);\n  handleAttributes(ractive);\n\n  // set up event subscribers\n  subscribe(ractive, options, 'on');\n\n  // if there's not a delegation setting, inherit from parent if it's not default\n  if (\n    !hasOwn(options, 'delegate') &&\n    ractive.parent &&\n    ractive.parent.delegate !== ractive.delegate\n  ) {\n    ractive.delegate = false;\n  }\n\n  // plugins that need to run at construct\n  if (isArray(options.use)) {\n    ractive.use.apply(ractive, options.use.filter(p => p.construct));\n  }\n\n  hooks.construct.fire(ractive, options);\n  if (options.onconstruct) options.onconstruct.call(ractive, getRactiveContext(ractive), options);\n\n  // Add registries\n  let i = registryNames.length;\n  while (i--) {\n    const name = registryNames[i];\n    ractive[name] = assign(create(ractive.constructor[name] || null), options[name]);\n  }\n\n  i = protoRegistries.length;\n  while (i--) {\n    const name = protoRegistries[i];\n    ractive[name] = assign(create(ractive.constructor.prototype[name]), options[name]);\n  }\n\n  if (ractive._attributePartial) {\n    ractive.partials['extra-attributes'] = ractive._attributePartial;\n    delete ractive._attributePartial;\n  }\n\n  // Create a viewmodel\n  const viewmodel = new RootModel({\n    adapt: getAdaptors(ractive, ractive.adapt, options),\n    data: dataConfigurator.init(ractive.constructor, ractive, options),\n    ractive\n  });\n\n  // once resolved, share the adaptors array between the root model and instance\n  ractive.adapt = viewmodel.adaptors;\n\n  ractive.viewmodel = viewmodel;\n\n  for (const k in ractive.computed) {\n    compute.call(ractive, k, ractive.computed[k]);\n  }\n}\n\nfunction getAdaptors(ractive, protoAdapt, options) {\n  protoAdapt = protoAdapt.map(lookup);\n  const adapt = ensureArray(options.adapt).map(lookup);\n\n  const srcs = [protoAdapt, adapt];\n  if (ractive.parent && !ractive.isolated) {\n    srcs.push(ractive.parent.viewmodel.adaptors);\n  }\n\n  return combine.apply(null, srcs);\n\n  function lookup(adaptor) {\n    if (isString(adaptor)) {\n      adaptor = findInViewHierarchy('adaptors', ractive, adaptor);\n\n      if (!adaptor) {\n        fatal(missingPlugin(adaptor, 'adaptor'));\n      }\n    }\n\n    return adaptor;\n  }\n}\n\nfunction initialiseProperties(ractive) {\n  // Generate a unique identifier, for places where you'd use a weak map if it\n  // existed\n  ractive._guid = 'r-' + uid++;\n\n  // events\n  ractive._subs = create(null);\n  ractive._nsSubs = 0;\n\n  // storage for item configuration from instantiation to reset,\n  // like dynamic functions or original values\n  ractive._config = {};\n\n  // events\n  ractive.event = null;\n  ractive._eventQueue = [];\n\n  // observers\n  ractive._observers = [];\n\n  // external children\n  ractive._children = [];\n  ractive._children.byName = {};\n  ractive.children = ractive._children;\n\n  if (!ractive.component) {\n    ractive.root = ractive;\n    ractive.parent = ractive.container = null; // TODO container still applicable?\n  }\n}\n\nfunction handleAttributes(ractive) {\n  const component = ractive.component;\n  const attributes = ractive.constructor.attributes;\n\n  if (attributes && component) {\n    const tpl = component.template;\n    const attrs = tpl.m ? tpl.m.slice() : [];\n\n    // grab all of the passed attribute names\n    const props = attrs.filter(a => a.t === ATTRIBUTE).map(a => a.n);\n\n    // warn about missing requireds\n    attributes.required.forEach(p => {\n      if (!~props.indexOf(p)) {\n        warnIfDebug(`Component '${component.name}' requires attribute '${p}' to be provided`);\n      }\n    });\n\n    // set up a partial containing non-property attributes\n    const all = attributes.optional.concat(attributes.required);\n    const partial = [];\n    let i = attrs.length;\n    while (i--) {\n      const a = attrs[i];\n      if (a.t === ATTRIBUTE && !~all.indexOf(a.n)) {\n        if (attributes.mapAll) {\n          // map the attribute if requested and make the extra attribute in the partial refer to the mapping\n          partial.unshift({\n            t: ATTRIBUTE,\n            n: a.n,\n            f: [{ t: INTERPOLATOR, r: `~/${a.n}` }]\n          });\n        } else {\n          // transfer the attribute to the extra attributes partal\n          partial.unshift(attrs.splice(i, 1)[0]);\n        }\n      } else if (\n        !attributes.mapAll &&\n        (a.t === DECORATOR || a.t === TRANSITION || a.t === BINDING_FLAG)\n      ) {\n        partial.unshift(attrs.splice(i, 1)[0]);\n      }\n    }\n\n    if (partial.length) component.template = { t: tpl.t, e: tpl.e, f: tpl.f, m: attrs, p: tpl.p };\n    ractive._attributePartial = partial;\n  }\n}\n","import runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\nimport { bind, render as callRender, unbind, unrender, update } from 'shared/methodCallers';\nimport { teardown } from 'src/Ractive/prototype/teardown';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { warnIfDebug } from 'utils/log';\nimport { createDocumentFragment } from 'utils/dom';\nimport {\n  ANCHOR,\n  ATTRIBUTE,\n  BINDING_FLAG,\n  COMPONENT,\n  DECORATOR,\n  EVENT,\n  TRANSITION,\n  YIELDER\n} from 'config/types';\nimport construct from 'src/Ractive/construct';\nimport initialise from 'src/Ractive/initialise';\nimport render from 'src/Ractive/render';\nimport Item from './shared/Item';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { assign, create } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\n\nexport default class Component extends Item {\n  constructor(options, ComponentConstructor) {\n    super(options);\n    let template = options.template;\n    this.isAnchor = template.t === ANCHOR;\n    this.type = this.isAnchor ? ANCHOR : COMPONENT; // override ELEMENT from super\n    let attrs = template.m;\n\n    const partials = template.p || {};\n    if (!('content' in partials)) partials.content = template.f || [];\n    this._partials = partials; // TEMP\n\n    if (this.isAnchor) {\n      this.name = template.n;\n\n      this.addChild = addChild;\n      this.removeChild = removeChild;\n    } else {\n      const instance = new ComponentConstructor({ component: true });\n\n      this.instance = instance;\n      this.name = template.e;\n\n      if (instance.el || instance.target) {\n        warnIfDebug(\n          `The <${this.name}> component has a default '${\n            instance.el ? 'el' : 'target'\n          }' property; it has been disregarded`\n        );\n        instance.el = instance.target = null;\n      }\n\n      // find container\n      let fragment = options.up;\n      let container;\n      while (fragment) {\n        if (fragment.owner.type === YIELDER) {\n          container = fragment.owner.container;\n          break;\n        }\n\n        fragment = fragment.parent;\n      }\n\n      // add component-instance-specific properties\n      instance.parent = this.up.ractive;\n      instance.container = container || null;\n      instance.root = instance.parent.root;\n      instance.component = this;\n\n      construct(this.instance, { partials }, ComponentConstructor);\n\n      // these can be modified during construction\n      template = this.template;\n      attrs = template.m;\n\n      // allow components that are so inclined to add programmatic mappings\n      if (isArray(this.mappings)) {\n        attrs = (attrs || []).concat(this.mappings);\n      } else if (isString(this.mappings)) {\n        attrs = (attrs || []).concat(parser.parse(this.mappings, { attributes: true }).t);\n      }\n\n      // for hackability, this could be an open option\n      // for any ractive instance, but for now, just\n      // for components and just for ractive...\n      instance._inlinePartials = partials;\n    }\n\n    this.attributeByName = {};\n    this.attributes = [];\n\n    if (attrs) {\n      const leftovers = [];\n      attrs.forEach(template => {\n        switch (template.t) {\n          case ATTRIBUTE:\n          case EVENT:\n            this.attributes.push(\n              createItem({\n                owner: this,\n                up: this.up,\n                template\n              })\n            );\n            break;\n\n          case TRANSITION:\n          case BINDING_FLAG:\n          case DECORATOR:\n            break;\n\n          default:\n            leftovers.push(template);\n            break;\n        }\n      });\n\n      if (leftovers.length) {\n        this.attributes.push(\n          new ConditionalAttribute({\n            owner: this,\n            up: this.up,\n            template: leftovers\n          })\n        );\n      }\n    }\n\n    this.eventHandlers = [];\n  }\n\n  bind() {\n    if (!this.isAnchor) {\n      this.attributes.forEach(bind);\n      this.eventHandlers.forEach(bind);\n\n      initialise(\n        this.instance,\n        {\n          partials: this._partials\n        },\n        {\n          cssIds: this.up.cssIds\n        }\n      );\n\n      if (this.instance.target || this.instance.el) this.extern = true;\n\n      this.bound = true;\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (!this.isAnchor && this.instance.fragment) this.instance.fragment.destroyed();\n  }\n\n  detach() {\n    if (this.isAnchor) {\n      if (this.instance) return this.instance.fragment.detach();\n      return createDocumentFragment();\n    }\n\n    return this.instance.fragment.detach();\n  }\n\n  find(selector, options) {\n    if (this.instance) return this.instance.fragment.find(selector, options);\n  }\n\n  findAll(selector, options) {\n    if (this.instance) this.instance.fragment.findAll(selector, options);\n  }\n\n  findComponent(name, options) {\n    if (!name || this.name === name) return this.instance;\n\n    if (this.instance.fragment) {\n      return this.instance.fragment.findComponent(name, options);\n    }\n  }\n\n  findAllComponents(name, options) {\n    const { result } = options;\n\n    if (this.instance && (!name || this.name === name)) {\n      result.push(this.instance);\n    }\n\n    if (this.instance) this.instance.findAllComponents(name, options);\n  }\n\n  firstNode(skipParent) {\n    if (this.instance) return this.instance.fragment.firstNode(skipParent);\n  }\n\n  getContext(...assigns) {\n    assigns.unshift(this.instance);\n    return getRactiveContext.apply(null, assigns);\n  }\n\n  rebound(update) {\n    this.attributes.forEach(x => x.rebound(update));\n  }\n\n  render(target, occupants) {\n    if (this.isAnchor) {\n      this.rendered = true;\n      this.target = target;\n\n      if (!checking.length) {\n        checking.push(this.ractive);\n        if (occupants) {\n          this.occupants = occupants;\n          checkAnchors();\n          this.occupants = null;\n        } else {\n          runloop.scheduleTask(checkAnchors, true);\n        }\n      }\n    } else {\n      this.attributes.forEach(callRender);\n      this.eventHandlers.forEach(callRender);\n\n      if (this.extern) {\n        this.instance.delegate = false;\n        this.instance.render();\n      } else {\n        render(this.instance, target, null, occupants);\n      }\n\n      this.rendered = true;\n    }\n  }\n\n  shuffled() {\n    super.shuffled();\n    this.instance &&\n      !this.instance.isolated &&\n      this.instance.fragment &&\n      this.instance.fragment.shuffled();\n  }\n\n  toString() {\n    if (this.instance) return this.instance.toHTML();\n  }\n\n  unbind(view) {\n    if (!this.isAnchor) {\n      this.bound = false;\n\n      this.attributes.forEach(unbind);\n\n      if (view) this.instance.fragment.unbind();\n      else teardown(this.instance, () => runloop.promise());\n    }\n  }\n\n  unrender(shouldDestroy) {\n    this.shouldDestroy = shouldDestroy;\n\n    if (this.isAnchor) {\n      if (this.item) unrenderItem(this, this.item);\n      this.target = null;\n      if (!checking.length) {\n        checking.push(this.ractive);\n        runloop.scheduleTask(checkAnchors, true);\n      }\n    } else {\n      this.instance.unrender();\n      this.instance.el = this.instance.target = null;\n      this.attributes.forEach(unrender);\n      this.eventHandlers.forEach(unrender);\n    }\n\n    this.rendered = false;\n  }\n\n  update() {\n    this.dirty = false;\n    if (this.instance) {\n      this.instance.fragment.update();\n      this.attributes.forEach(update);\n      this.eventHandlers.forEach(update);\n    }\n  }\n}\n\nfunction addChild(meta) {\n  if (this.item) this.removeChild(this.item);\n\n  const child = meta.instance;\n  meta.anchor = this;\n\n  meta.up = this.up;\n  meta.name = meta.nameOption || this.name;\n  this.name = meta.name;\n\n  if (!child.isolated) child.viewmodel.attached(this.up);\n\n  // render as necessary\n  if (this.rendered) {\n    renderItem(this, meta);\n  }\n}\n\nfunction removeChild(meta) {\n  // unrender as necessary\n  if (this.item === meta) {\n    unrenderItem(this, meta);\n    this.name = this.template.n;\n  }\n}\n\nfunction renderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = false;\n  meta.up = anchor.up;\n\n  anchor.item = meta;\n  anchor.instance = meta.instance;\n  const nextNode = anchor.up.findNextNode(anchor);\n\n  if (meta.instance.fragment.rendered) {\n    meta.instance.unrender();\n  }\n\n  meta.partials = meta.instance.partials;\n  meta.instance.partials = assign(create(meta.partials), meta.partials, anchor._partials);\n\n  meta.instance.fragment.unbind(true);\n  meta.instance.fragment.componentParent = anchor.up;\n  meta.instance.fragment.bind(meta.instance.viewmodel);\n\n  anchor.attributes.forEach(bind);\n  anchor.eventHandlers.forEach(bind);\n  anchor.attributes.forEach(callRender);\n  anchor.eventHandlers.forEach(callRender);\n\n  const target = anchor.up.findParentNode();\n  render(meta.instance, target, target.contains(nextNode) ? nextNode : null, anchor.occupants);\n\n  if (meta.lastBound !== anchor) {\n    meta.lastBound = anchor;\n  }\n}\n\nfunction unrenderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = true;\n  meta.instance.unrender();\n\n  anchor.eventHandlers.forEach(unrender);\n  anchor.attributes.forEach(unrender);\n  anchor.eventHandlers.forEach(unbind);\n  anchor.attributes.forEach(unbind);\n\n  meta.instance.el = meta.instance.anchor = null;\n  meta.instance.fragment.componentParent = null;\n  meta.up = null;\n  meta.anchor = null;\n  anchor.item = null;\n  anchor.instance = null;\n}\n\nlet checking = [];\nexport function checkAnchors() {\n  const list = checking;\n  checking = [];\n\n  list.forEach(updateAnchors);\n}\n","import { capture } from 'src/global/capture';\nimport Model from './Model';\nimport { handleChange, mark, marked } from 'shared/methodCallers';\nimport { hasOwn } from 'utils/object';\nimport { isUndefined } from 'utils/is';\n\nexport default class ComputationChild extends Model {\n  constructor(parent, key) {\n    super(parent, key);\n\n    this.isReadonly = !this.root.ractive.syncComputedChildren;\n    this.dirty = true;\n    this.isComputed = true;\n  }\n\n  get setRoot() {\n    return this.parent.setRoot;\n  }\n\n  applyValue(value) {\n    super.applyValue(value);\n\n    if (!this.isReadonly) {\n      let source = this.parent;\n      // computed models don't have a shuffle method\n      while (source && source.shuffle) {\n        source = source.parent;\n      }\n\n      if (source) {\n        source.dependencies.forEach(mark);\n      }\n    }\n\n    if (this.setRoot) {\n      this.setRoot.set(this.setRoot.value);\n    }\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      const parentValue = this.parent.get();\n      this.value = parentValue ? parentValue[this.key] : undefined;\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    }\n\n    this.dirty = false;\n\n    return (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n      ? this.wrapperValue\n      : this.value;\n  }\n\n  handleChange() {\n    if (this.dirty) {\n      this.deps.forEach(handleChange);\n      return;\n    }\n\n    this.dirty = true;\n\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n    this.deps.forEach(handleChange);\n    this.children.forEach(handleChange);\n  }\n\n  joinKey(key) {\n    if (isUndefined(key) || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new ComputationChild(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n}\n","import { badArguments } from 'config/errors';\nimport { gather, set } from 'shared/set';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$toggle(keypath, options) {\n  if (!isString(keypath)) {\n    throw new TypeError(badArguments);\n  }\n\n  return set(\n    gather(this, keypath, null, options && options.isolated).map(m => [m, !m.get()]),\n    options\n  );\n}\n","import { getCSS } from 'src/global/css';\nimport { keys } from 'utils/object';\n\nexport default function Ractive$toCSS() {\n  const cssIds = [this.cssId, ...this.findAllComponents().map(c => c.cssId)];\n  const uniqueCssIds = keys(cssIds.reduce((ids, id) => ((ids[id] = true), ids), {}));\n  return getCSS(uniqueCssIds);\n}\n","export default function Ractive$toHTML() {\n  return this.fragment.toString(true);\n}\n","export default function toText() {\n  return this.fragment.toString(false);\n}\n","import runloop from 'src/global/runloop';\nimport Transition from '../../view/items/element/Transition';\nimport { fatal } from 'utils/log';\nimport { isObject } from 'utils/is';\n\nexport default function Ractive$transition(name, node, params) {\n  if (node instanceof HTMLElement) {\n    // good to go\n  } else if (isObject(node)) {\n    // omitted, use event node\n    params = node;\n  }\n\n  // if we allow query selector, then it won't work\n  // simple params like \"fast\"\n\n  // else if ( typeof node === 'string' ) {\n  // \t// query selector\n  // \tnode = this.find( node )\n  // }\n\n  node = node || this.event.node;\n\n  if (!node || !node._ractive) {\n    fatal(`No node was supplied for transition ${name}`);\n  }\n\n  params = params || {};\n  const owner = node._ractive.proxy;\n  const transition = new Transition({ owner, up: owner.up, name, params });\n  transition.bind();\n\n  const promise = runloop.start();\n  runloop.registerTransition(transition);\n  runloop.end();\n\n  promise.then(() => transition.unbind());\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function unlink(here) {\n  const promise = runloop.start();\n  this.viewmodel.joinAll(splitKeypath(here), { lastLink: false }).unlink();\n  runloop.end();\n  return promise;\n}\n","import hooks from 'src/events/Hook';\nimport { warnIfDebug } from 'utils/log';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\n\nexport default function Ractive$unrender() {\n  if (!this.fragment.rendered) {\n    warnIfDebug('ractive.unrender() was called on a Ractive instance that was not rendered');\n    return Promise.resolve();\n  }\n\n  this.unrendering = true;\n  const promise = runloop.start();\n\n  hooks.unrendering.fire(this);\n\n  // If this is a component, and the component isn't marked for destruction,\n  // don't detach nodes from the DOM unnecessarily\n  const shouldDestroy =\n    !this.component ||\n    (this.component.anchor || {}).shouldDestroy ||\n    this.component.shouldDestroy ||\n    this.shouldDestroy;\n  this.fragment.unrender(shouldDestroy);\n  if (shouldDestroy) this.destroyed = true;\n\n  removeFromArray(this.el.__ractive_instances__, this);\n\n  hooks.unrender.fire(this);\n\n  runloop.end();\n  this.unrendering = false;\n\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function Ractive$updateModel(keypath, cascade) {\n  const promise = runloop.start();\n\n  if (!keypath) {\n    this.viewmodel.updateFromBindings(true);\n  } else {\n    this.viewmodel.joinAll(splitKeypath(keypath)).updateFromBindings(cascade !== false);\n  }\n\n  runloop.end();\n\n  return promise;\n}\n","export default function use(...plugins) {\n  plugins.forEach(p => {\n    p({\n      proto: this,\n      Ractive: this.constructor.Ractive,\n      instance: this\n    });\n  });\n  return this;\n}\n","export default function isInstance(object) {\n  return object && object instanceof this;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function styleGet(keypath, opts) {\n  return this._cssModel.joinAll(splitKeypath(keypath)).get(true, opts);\n}\n","import { build, set } from '../../shared/set';\nimport SharedModel from '../../model/specials/SharedModel';\nimport { isObjectType } from 'utils/is';\n\nexport default function sharedSet(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = SharedModel;\n\n  return set(build({ viewmodel: model }, keypath, value, true), opts);\n}\n","import SharedModel from '../../model/specials/SharedModel';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function sharedGet(keypath, opts) {\n  return SharedModel.joinAll(splitKeypath(keypath)).get(true, opts);\n}\n","import { isFunction } from 'utils/is';\n\nexport default function use(...plugins) {\n  plugins.forEach(p => {\n    isFunction(p) &&\n      p({\n        proto: this.prototype,\n        Ractive: this.Ractive,\n        instance: this\n      });\n  });\n  return this;\n}\n","import styleGet from '../Ractive/static/styleGet';\nimport styleSet from '../Ractive/static/styleSet';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperties, defineProperty } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nimport { initCSS } from 'src/Ractive/config/custom/css/css';\n\nexport default function macro(fn, opts) {\n  if (!isFunction(fn)) throw new Error(`The macro must be a function`);\n\n  assign(fn, opts);\n\n  defineProperties(fn, {\n    extensions: { value: [] },\n    _cssIds: { value: [] },\n    cssData: { value: assign(create(this.cssData), fn.cssData || {}) },\n\n    styleGet: { value: styleGet.bind(fn) },\n    styleSet: { value: styleSet.bind(fn) }\n  });\n\n  defineProperty(fn, '_cssModel', { value: new CSSModel(fn) });\n\n  if (fn.css) initCSS(fn, fn, fn);\n\n  this.extensions.push(fn);\n\n  return fn;\n}\n","import { findInViewHierarchy } from 'shared/registry';\n\nexport function findPlugin(name, type, instance) {\n  return findInViewHierarchy(type, instance, name);\n}\n","/* istanbul ignore if */\nif (!Object.assign) {\n  Object.assign = function(target, ...sources) {\n    if (target == null) throw new TypeError('Cannot convert undefined or null to object');\n\n    const to = Object(target);\n    const sourcesLength = sources.length;\n\n    for (let index = 0; index < sourcesLength; index++) {\n      const nextSource = sources[index];\n      for (const nextKey in nextSource) {\n        if (!Object.prototype.hasOwnProperty.call(nextSource, nextKey)) continue;\n        to[nextKey] = nextSource[nextKey];\n      }\n    }\n\n    return to;\n  };\n}\n","export function hasOwn(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function fillGaps(target, ...sources) {\n  for (let i = 0; i < sources.length; i++) {\n    const source = sources[i];\n    for (const key in source) {\n      // Source can be a prototype-less object.\n      if (key in target || !hasOwn(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nexport function toPairs(obj = {}) {\n  const pairs = [];\n  for (const key in obj) {\n    // Source can be a prototype-less object.\n    if (!hasOwn(obj, key)) continue;\n    pairs.push([key, obj[key]]);\n  }\n  return pairs;\n}\n\nconst obj = Object;\n\nexport const assign = obj.assign;\n\nexport const create = obj.create;\n\nexport const defineProperty = obj.defineProperty;\n\nexport const defineProperties = obj.defineProperties;\n\nexport const keys = obj.keys;\n","const toString = Object.prototype.toString;\nconst arrayLikePattern = /^\\[object (?:Array|FileList)\\]$/;\n\nexport function isArrayLike(obj) {\n  return arrayLikePattern.test(toString.call(obj));\n}\n\nexport const isArray = Array.isArray;\n\nexport function isEqual(a, b) {\n  if (a === null && b === null) {\n    return true;\n  }\n\n  if (isObjectType(a) || isObjectType(b)) {\n    return false;\n  }\n\n  return a === b;\n}\n\n// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\nexport function isNumeric(thing) {\n  return !isNaN(parseFloat(thing)) && isFinite(thing);\n}\n\nexport function isObject(thing) {\n  return thing && toString.call(thing) === '[object Object]';\n}\n\nexport function isObjectLike(thing) {\n  return !!(thing && (isObjectType(thing) || isFunction(thing))) && !isDate(thing);\n}\n\nexport function isDate(thing) {\n  return thing instanceof Date;\n}\n\nexport function isObjectType(thing) {\n  return typeof thing === 'object';\n}\n\nexport function isFunction(thing) {\n  return typeof thing === 'function';\n}\n\nexport function isString(thing) {\n  return typeof thing === 'string';\n}\n\nexport function isNumber(thing) {\n  return typeof thing === 'number';\n}\n\nexport function isUndefined(thing) {\n  return thing === undefined;\n}\n","/* istanbul ignore if */\nif (typeof window !== 'undefined' && window.performance && !window.performance.now) {\n  window.performance = window.performance || {};\n\n  const nowOffset = Date.now();\n\n  window.performance.now = function() {\n    return Date.now() - nowOffset;\n  };\n}\n","import { hasOwn, defineProperty } from 'utils/object';\nimport { isFunction, isUndefined } from 'utils/is';\n\n/* istanbul ignore if */\nif (!Array.prototype.find) {\n  defineProperty(Array.prototype, 'find', {\n    value(callback, thisArg) {\n      if (this === null || isUndefined(this))\n        throw new TypeError('Array.prototype.find called on null or undefined');\n\n      if (!isFunction(callback)) throw new TypeError(`${callback} is not a function`);\n\n      const array = Object(this);\n      const arrayLength = array.length >>> 0;\n\n      for (let index = 0; index < arrayLength; index++) {\n        if (!hasOwn(array, index)) continue;\n        if (!callback.call(thisArg, array[index], index, array)) continue;\n        return array[index];\n      }\n\n      return undefined;\n    },\n    configurable: true,\n    writable: true\n  });\n}\n","// NOTE: Node doesn't exist in IE8. Nothing can be done.\n/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  window.Node &&\n  window.Node.prototype &&\n  !window.Node.prototype.contains\n) {\n  Node.prototype.contains = function(node) {\n    if (!node) throw new TypeError('node required');\n\n    do {\n      if (this === node) return true;\n    } while ((node = node && node.parentNode));\n\n    return false;\n  };\n}\n","/* eslint no-console:\"off\" */\nimport { isFunction } from 'utils/is';\n\nconst win = typeof window !== 'undefined' ? window : null;\nconst doc = win ? document : null;\nconst isClient = !!doc;\nconst base = typeof global !== 'undefined' ? global : win;\nconst hasConsole =\n  typeof console !== 'undefined' && isFunction(console.warn) && isFunction(console.warn.apply);\n\nconst svg = doc\n  ? doc.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1')\n  : false;\n\nconst vendors = ['o', 'ms', 'moz', 'webkit'];\n\nexport { win, doc, isClient, hasConsole, svg, vendors, base };\n","import { isFunction, isObjectType } from 'utils/is';\nimport { base } from 'config/environment';\n\n/* istanbul ignore if */\nif (!base.Promise) {\n  const PENDING = {};\n  const FULFILLED = {};\n  const REJECTED = {};\n\n  const Promise = (base.Promise = function(callback) {\n    const fulfilledHandlers = [];\n    const rejectedHandlers = [];\n    let state = PENDING;\n    let result;\n    let dispatchHandlers;\n\n    const makeResolver = newState => {\n      return function(value) {\n        if (state !== PENDING) return;\n        result = value;\n        state = newState;\n        dispatchHandlers = makeDispatcher(\n          state === FULFILLED ? fulfilledHandlers : rejectedHandlers,\n          result\n        );\n        wait(dispatchHandlers);\n      };\n    };\n\n    const fulfill = makeResolver(FULFILLED);\n    const reject = makeResolver(REJECTED);\n\n    try {\n      callback(fulfill, reject);\n    } catch (err) {\n      reject(err);\n    }\n\n    return {\n      // `then()` returns a Promise - 2.2.7\n      then(onFulfilled, onRejected) {\n        const promise2 = new Promise((fulfill, reject) => {\n          const processResolutionHandler = (handler, handlers, forward) => {\n            if (isFunction(handler)) {\n              handlers.push(p1result => {\n                try {\n                  resolve(promise2, handler(p1result), fulfill, reject);\n                } catch (err) {\n                  reject(err);\n                }\n              });\n            } else {\n              handlers.push(forward);\n            }\n          };\n\n          processResolutionHandler(onFulfilled, fulfilledHandlers, fulfill);\n          processResolutionHandler(onRejected, rejectedHandlers, reject);\n\n          if (state !== PENDING) {\n            wait(dispatchHandlers);\n          }\n        });\n        return promise2;\n      },\n      catch(onRejected) {\n        return this.then(null, onRejected);\n      },\n      finally(callback) {\n        return this.then(\n          v => {\n            callback();\n            return v;\n          },\n          e => {\n            callback();\n            throw e;\n          }\n        );\n      }\n    };\n  });\n\n  Promise.all = function(promises) {\n    return new Promise((fulfill, reject) => {\n      const result = [];\n      let pending;\n      let i;\n\n      if (!promises.length) {\n        fulfill(result);\n        return;\n      }\n\n      const processPromise = (promise, i) => {\n        if (promise && isFunction(promise.then)) {\n          promise.then(value => {\n            result[i] = value;\n            --pending || fulfill(result);\n          }, reject);\n        } else {\n          result[i] = promise;\n          --pending || fulfill(result);\n        }\n      };\n\n      pending = i = promises.length;\n\n      while (i--) {\n        processPromise(promises[i], i);\n      }\n    });\n  };\n\n  Promise.race = function(promises) {\n    return new Promise((fulfill, reject) => {\n      let pending = true;\n      function ok(v) {\n        if (!pending) return;\n        pending = false;\n        fulfill(v);\n      }\n      function fail(e) {\n        if (!pending) return;\n        pending = false;\n        reject(e);\n      }\n      for (let i = 0; i < promises.length; i++) {\n        if (promises[i] && isFunction(promises[i].then)) {\n          promises[i].then(ok, fail);\n        }\n      }\n    });\n  };\n\n  Promise.resolve = function(value) {\n    if (value && isFunction(value.then)) return value;\n    return new Promise(fulfill => {\n      fulfill(value);\n    });\n  };\n\n  Promise.reject = function(reason) {\n    if (reason && isFunction(reason.then)) return reason;\n    return new Promise((fulfill, reject) => {\n      reject(reason);\n    });\n  };\n\n  // TODO use MutationObservers or something to simulate setImmediate\n  const wait = function(callback) {\n    setTimeout(callback, 0);\n  };\n\n  const makeDispatcher = function(handlers, result) {\n    return function() {\n      for (let handler; (handler = handlers.shift()); ) {\n        handler(result);\n      }\n    };\n  };\n\n  const resolve = function(promise, x, fulfil, reject) {\n    let then;\n    if (x === promise) {\n      throw new TypeError(`A promise's fulfillment handler cannot return the same promise`);\n    }\n    if (x instanceof Promise) {\n      x.then(fulfil, reject);\n    } else if (x && (isObjectType(x) || isFunction(x))) {\n      try {\n        then = x.then;\n      } catch (e) {\n        reject(e);\n        return;\n      }\n      if (isFunction(then)) {\n        let called;\n\n        const resolvePromise = function(y) {\n          if (called) return;\n          called = true;\n          resolve(promise, y, fulfil, reject);\n        };\n        const rejectPromise = function(r) {\n          if (called) return;\n          called = true;\n          reject(r);\n        };\n\n        try {\n          then.call(x, resolvePromise, rejectPromise);\n        } catch (e) {\n          if (!called) {\n            reject(e);\n            called = true;\n            return;\n          }\n        }\n      } else {\n        fulfil(x);\n      }\n    } else {\n      fulfil(x);\n    }\n  };\n}\n","/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  !(window.requestAnimationFrame && window.cancelAnimationFrame)\n) {\n  let lastTime = 0;\n  window.requestAnimationFrame = function(callback) {\n    const currentTime = Date.now();\n    const timeToNextCall = Math.max(0, 16 - (currentTime - lastTime));\n    const id = window.setTimeout(() => {\n      callback(currentTime + timeToNextCall);\n    }, timeToNextCall);\n    lastTime = currentTime + timeToNextCall;\n    return id;\n  };\n  window.cancelAnimationFrame = function(id) {\n    clearTimeout(id);\n  };\n}\n","import { create } from 'utils/object';\n\nexport default {\n  // render placement:\n  el: void 0,\n  append: false,\n  delegate: true,\n  enhance: false,\n\n  // template:\n  template: null,\n\n  // parse:\n  allowExpressions: true,\n  delimiters: ['{{', '}}'],\n  tripleDelimiters: ['{{{', '}}}'],\n  staticDelimiters: ['[[', ']]'],\n  staticTripleDelimiters: ['[[[', ']]]'],\n  csp: true,\n  interpolate: false,\n  preserveWhitespace: false,\n  preserveStandaloneSections: false,\n  sanitize: false,\n  stripComments: true,\n  contextLines: 0,\n\n  // data & binding:\n  data: create(null),\n  helpers: create(null),\n  computed: create(null),\n  syncComputedChildren: false,\n  resolveInstanceMembers: false,\n  warnAboutAmbiguity: false,\n  adapt: [],\n  isolated: true,\n  twoway: true,\n  lazy: false,\n\n  // transitions:\n  noIntro: false,\n  noOutro: false,\n  transitionsEnabled: true,\n  complete: void 0,\n  nestedTransitions: true,\n\n  // css:\n  css: null,\n  noCSSTransform: false\n};\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { hasConsole } from '../config/environment';\nimport Ractive from '../Ractive';\nimport noop from './noop';\nimport { isObjectType } from 'utils/is';\n\nconst alreadyWarned = {};\nlet log, printWarning, welcome;\n\nif (hasConsole) {\n  const welcomeIntro = [\n    `%cRactive.js %cBUILD_PLACEHOLDER_VERSION %cin debug mode, %cmore...`,\n    'color: rgb(114, 157, 52); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n  ];\n  const welcomeMessage = `You're running Ractive BUILD_PLACEHOLDER_VERSION in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://ractive.js.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n`;\n\n  welcome = () => {\n    if (Ractive.WELCOME_MESSAGE === false) {\n      welcome = noop;\n      return;\n    }\n    const message = 'WELCOME_MESSAGE' in Ractive ? Ractive.WELCOME_MESSAGE : welcomeMessage;\n    const hasGroup = !!console.groupCollapsed;\n    if (hasGroup) console.groupCollapsed.apply(console, welcomeIntro);\n    console.log(message);\n    if (hasGroup) {\n      console.groupEnd(welcomeIntro);\n    }\n\n    welcome = noop;\n  };\n\n  printWarning = (message, args) => {\n    welcome();\n\n    // extract information about the instance this message pertains to, if applicable\n    if (isObjectType(args[args.length - 1])) {\n      const options = args.pop();\n      const ractive = options ? options.ractive : null;\n\n      if (ractive) {\n        // if this is an instance of a component that we know the name of, add\n        // it to the message\n        let name;\n        if (ractive.component && (name = ractive.component.name)) {\n          message = `<${name}> ${message}`;\n        }\n\n        let node;\n        if (\n          (node =\n            options.node || (ractive.fragment && ractive.fragment.rendered && ractive.find('*')))\n        ) {\n          args.push(node);\n        }\n      }\n    }\n\n    console.warn.apply(\n      console,\n      ['%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);'].concat(\n        args\n      )\n    );\n  };\n\n  log = function() {\n    console.log.apply(console, arguments);\n  };\n} else {\n  printWarning = log = welcome = noop;\n}\n\nfunction format(message, args) {\n  return message.replace(/%s/g, () => args.shift());\n}\n\nfunction fatal(message, ...args) {\n  message = format(message, args);\n  throw new Error(message);\n}\n\nfunction logIfDebug() {\n  if (Ractive.DEBUG) {\n    log.apply(null, arguments);\n  }\n}\n\nfunction warn(message, ...args) {\n  message = format(message, args);\n  printWarning(message, args);\n}\n\nfunction warnOnce(message, ...args) {\n  message = format(message, args);\n\n  if (alreadyWarned[message]) {\n    return;\n  }\n\n  alreadyWarned[message] = true;\n  printWarning(message, args);\n}\n\nfunction warnIfDebug() {\n  if (Ractive.DEBUG) {\n    warn.apply(null, arguments);\n  }\n}\n\nfunction warnOnceIfDebug() {\n  if (Ractive.DEBUG) {\n    warnOnce.apply(null, arguments);\n  }\n}\n\nexport { fatal, log, logIfDebug, warn, warnOnce, warnIfDebug, warnOnceIfDebug, welcome };\n","// These are a subset of the easing equations found at\n// https://raw.github.com/danro/easing-js - license info\n// follows:\n\n// --------------------------------------------------\n// easing.js v0.5.4\n// Generic set of easing functions with AMD support\n// https://github.com/danro/easing-js\n// This code may be freely distributed under the MIT license\n// http://danro.mit-license.org/\n// --------------------------------------------------\n// All functions adapted from Thomas Fuchs & Jeremy Kahn\n// Easing Equations (c) 2003 Robert Penner, BSD license\n// https://raw.github.com/danro/easing-js/master/LICENSE\n// --------------------------------------------------\n\n// In that library, the functions named easeIn, easeOut, and\n// easeInOut below are named easeInCubic, easeOutCubic, and\n// (you guessed it) easeInOutCubic.\n//\n// You can add additional easing functions to this list, and they\n// will be globally available.\n\nexport default {\n  linear(pos) {\n    return pos;\n  },\n  easeIn(pos) {\n    /* istanbul ignore next */\n    return Math.pow(pos, 3);\n  },\n  easeOut(pos) {\n    return Math.pow(pos - 1, 3) + 1;\n  },\n  easeInOut(pos) {\n    /* istanbul ignore next */\n    if ((pos /= 0.5) < 1) {\n      return 0.5 * Math.pow(pos, 3);\n    }\n    /* istanbul ignore next */\n    return 0.5 * (Math.pow(pos - 2, 3) + 2);\n  }\n};\n","// Error messages that are used (or could be) in multiple places\nexport const badArguments = 'Bad arguments';\nexport const noRegistryFunctionReturn =\n  'A function was specified for \"%s\" %s, but no %s was returned';\nexport const missingPlugin = (name, type) =>\n  `Missing \"${name}\" ${type} plugin. You may need to download a plugin via http://ractive.js.org/integrations/#${type}s`;\n","import { isArray, isObject, isNumeric } from 'utils/is';\nimport interpolate from 'shared/interpolate';\nimport { hasOwn } from 'utils/object';\n\nconst interpolators = {\n  number(from, to) {\n    if (!isNumeric(from) || !isNumeric(to)) {\n      return null;\n    }\n\n    from = +from;\n    to = +to;\n\n    const delta = to - from;\n\n    if (!delta) {\n      return function() {\n        return from;\n      };\n    }\n\n    return function(t) {\n      return from + t * delta;\n    };\n  },\n\n  array(from, to) {\n    let len, i;\n\n    if (!isArray(from) || !isArray(to)) {\n      return null;\n    }\n\n    const intermediate = [];\n    const interpolators = [];\n\n    i = len = Math.min(from.length, to.length);\n    while (i--) {\n      interpolators[i] = interpolate(from[i], to[i]);\n    }\n\n    // surplus values - don't interpolate, but don't exclude them either\n    for (i = len; i < from.length; i += 1) {\n      intermediate[i] = from[i];\n    }\n\n    for (i = len; i < to.length; i += 1) {\n      intermediate[i] = to[i];\n    }\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        intermediate[i] = interpolators[i](t);\n      }\n\n      return intermediate;\n    };\n  },\n\n  object(from, to) {\n    if (!isObject(from) || !isObject(to)) {\n      return null;\n    }\n\n    const properties = [];\n    const intermediate = {};\n    const interpolators = {};\n\n    for (const prop in from) {\n      if (hasOwn(from, prop)) {\n        if (hasOwn(to, prop)) {\n          properties.push(prop);\n          interpolators[prop] = interpolate(from[prop], to[prop]) || (() => to[prop]);\n        } else {\n          intermediate[prop] = from[prop];\n        }\n      }\n    }\n\n    for (const prop in to) {\n      if (hasOwn(to, prop) && !hasOwn(from, prop)) {\n        intermediate[prop] = to[prop];\n      }\n    }\n\n    const len = properties.length;\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        const prop = properties[i];\n\n        intermediate[prop] = interpolators[prop](t);\n      }\n\n      return intermediate;\n    };\n  }\n};\n\nexport default interpolators;\n","import { isString } from 'utils/is';\n\nconst refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\nconst splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\nconst escapeKeyPattern = /\\\\|\\./g;\nconst unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\n\nexport function escapeKey(key) {\n  if (isString(key)) {\n    return key.replace(escapeKeyPattern, '\\\\$&');\n  }\n\n  return key;\n}\n\nexport function normalise(ref) {\n  return ref ? ref.replace(refPattern, '.$1') : '';\n}\n\nexport function splitKeypath(keypath) {\n  const result = [];\n  let match;\n\n  keypath = normalise(keypath);\n\n  while ((match = splitPattern.exec(keypath))) {\n    const index = match.index + match[1].length;\n    result.push(keypath.substr(0, index));\n    keypath = keypath.substr(index + 1);\n  }\n\n  result.push(keypath);\n\n  return result;\n}\n\nexport function unescapeKey(key) {\n  if (isString(key)) {\n    return key.replace(unescapeKeyPattern, '$1$2');\n  }\n\n  return key;\n}\n","const fnBind = Function.prototype.bind;\n\nexport default function bind(fn, context) {\n  if (!/this/.test(fn.toString())) return fn;\n\n  const bound = fnBind.call(fn, context);\n  for (const prop in fn) bound[prop] = fn[prop];\n\n  return bound;\n}\n","import { escapeKey, unescapeKey } from 'shared/keypaths';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isObjectLike, isFunction } from 'utils/is';\nimport bind from 'utils/bind';\nimport { create, keys as objectKeys } from 'utils/object';\n\nconst shuffleTasks = { early: [], mark: [] };\nconst registerQueue = { early: [], mark: [] };\nexport const noVirtual = { virtual: false };\n\nexport default class ModelBase {\n  constructor(parent) {\n    this.deps = [];\n\n    this.children = [];\n    this.childByKey = {};\n    this.links = [];\n\n    this.bindings = [];\n\n    if (parent) {\n      this.parent = parent;\n      this.root = parent.root;\n    }\n  }\n\n  addShuffleTask(task, stage = 'early') {\n    shuffleTasks[stage].push(task);\n  }\n  addShuffleRegister(item, stage = 'early') {\n    registerQueue[stage].push({ model: this, item });\n  }\n\n  downstreamChanged() {}\n\n  findMatches(keys) {\n    const len = keys.length;\n\n    let existingMatches = [this];\n    let matches;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const key = keys[i];\n\n      if (key === '*') {\n        matches = [];\n        existingMatches.forEach(model => {\n          matches.push.apply(matches, model.getValueChildren(model.get()));\n        });\n      } else {\n        matches = existingMatches.map(model => model.joinKey(key));\n      }\n\n      existingMatches = matches;\n    }\n\n    return matches;\n  }\n\n  getKeypath(ractive) {\n    if (ractive !== this.ractive && this._link) return this._link.target.getKeypath(ractive);\n\n    if (!this.keypath) {\n      const parent = this.parent && this.parent.getKeypath(ractive);\n      this.keypath = parent\n        ? `${this.parent.getKeypath(ractive)}.${escapeKey(this.key)}`\n        : escapeKey(this.key);\n    }\n\n    return this.keypath;\n  }\n\n  getValueChildren(value) {\n    let children;\n    if (isArray(value)) {\n      children = [];\n      if ('length' in this && this.length !== value.length) {\n        children.push(this.joinKey('length'));\n      }\n      value.forEach((m, i) => {\n        children.push(this.joinKey(i));\n      });\n    } else if (isObject(value) || isFunction(value)) {\n      children = objectKeys(value).map(key => this.joinKey(escapeKey(key)));\n    } else if (value != null) {\n      children = [];\n    }\n\n    const computed = this.computed;\n    if (computed) {\n      children.push.apply(children, objectKeys(computed).map(k => this.joinKey(k)));\n    }\n\n    return children;\n  }\n\n  getVirtual(shouldCapture) {\n    const value = this.get(shouldCapture, { virtual: false });\n    if (isObjectLike(value)) {\n      const result = isArray(value) ? [] : create(null);\n\n      let keys = objectKeys(value);\n      let i = keys.length;\n      while (i--) {\n        const child = this.childByKey[keys[i]];\n        if (!child) result[keys[i]] = value[keys[i]];\n        else if (child._link) result[keys[i]] = child._link.getVirtual();\n        else result[keys[i]] = child.getVirtual();\n      }\n\n      i = this.children.length;\n      while (i--) {\n        const child = this.children[i];\n        if (!(child.key in result) && child._link) {\n          result[child.key] = child._link.getVirtual();\n        }\n      }\n\n      if (this.computed) {\n        keys = objectKeys(this.computed);\n        i = keys.length;\n        while (i--) {\n          result[keys[i]] = this.computed[keys[i]].get();\n        }\n      }\n\n      return result;\n    } else return value;\n  }\n\n  has(key) {\n    if (this._link) return this._link.has(key);\n\n    const value = this.get(false, noVirtual);\n    if (!value) return false;\n\n    key = unescapeKey(key);\n    if ((isFunction(value) || isObject(value)) && key in value) return true;\n\n    let computed = this.computed;\n    if (computed && key in this.computed) return true;\n\n    computed = this.root.ractive && this.root.ractive.computed;\n    if (computed) {\n      objectKeys(computed).forEach(k => {\n        if (computed[k].pattern && computed[k].pattern.test(this.getKeypath())) return true;\n      });\n    }\n\n    return false;\n  }\n\n  joinAll(keys, opts) {\n    let model = this;\n    for (let i = 0; i < keys.length; i += 1) {\n      if (\n        opts &&\n        opts.lastLink === false &&\n        i + 1 === keys.length &&\n        model.childByKey[keys[i]] &&\n        model.childByKey[keys[i]]._link\n      )\n        return model.childByKey[keys[i]];\n      model = model.joinKey(keys[i], opts);\n    }\n\n    return model;\n  }\n\n  notifyUpstream(startPath) {\n    let parent = this.parent;\n    const path = startPath || [this.key];\n    while (parent) {\n      if (parent.patterns) parent.patterns.forEach(o => o.notify(path.slice()));\n      path.unshift(parent.key);\n      parent.links.forEach(l => l.notifiedUpstream(path, this.root));\n      parent.deps.forEach(d => d.handleChange(path));\n      parent.downstreamChanged(startPath);\n      parent = parent.parent;\n    }\n  }\n\n  rebind(next, previous, safe) {\n    if (this._link) {\n      this._link.rebind(next, previous, false);\n    }\n\n    if (next === this) return;\n\n    // tell the deps to move to the new target\n    let i = this.deps.length;\n    while (i--) {\n      if (this.deps[i].rebind) this.deps[i].rebind(next, previous, safe);\n    }\n\n    i = this.links.length;\n    while (i--) {\n      const link = this.links[i];\n      // only relink the root of the link tree\n      if (link.owner && link.owner._link) link.relinking(next, safe);\n    }\n\n    i = this.children.length;\n    while (i--) {\n      const child = this.children[i];\n      child.rebind(next ? next.joinKey(child.key) : undefined, child._link || child, safe);\n      if (this.dataModel) {\n        this.addShuffleTask(() => checkDataLink(this, this.retrieve()), 'early');\n      }\n    }\n\n    i = this.bindings.length;\n    while (i--) {\n      this.bindings[i].rebind(next, previous, safe);\n    }\n  }\n\n  reference() {\n    'refs' in this ? this.refs++ : (this.refs = 1);\n  }\n\n  register(dep) {\n    this.deps.push(dep);\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  registerPatternObserver(observer) {\n    (this.patterns || (this.patterns = [])).push(observer);\n    this.register(observer);\n  }\n\n  registerTwowayBinding(binding) {\n    this.bindings.push(binding);\n  }\n\n  unreference() {\n    if ('refs' in this) this.refs--;\n  }\n\n  unregister(dep) {\n    removeFromArray(this.deps, dep);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n\n  unregisterPatternObserver(observer) {\n    removeFromArray(this.patterns, observer);\n    this.unregister(observer);\n  }\n\n  unregisterTwowayBinding(binding) {\n    removeFromArray(this.bindings, binding);\n  }\n\n  updateFromBindings(cascade) {\n    let i = this.bindings.length;\n    while (i--) {\n      const value = this.bindings[i].getValue();\n      if (value !== this.value) this.set(value);\n    }\n\n    // check for one-way bindings if there are no two-ways\n    if (!this.bindings.length) {\n      const oneway = findBoundValue(this.deps);\n      if (oneway && oneway.value !== this.value) this.set(oneway.value);\n    }\n\n    if (cascade) {\n      this.children.forEach(updateFromBindings);\n      this.links.forEach(updateFromBindings);\n      if (this._link) this._link.updateFromBindings(cascade);\n    }\n  }\n}\n\n// TODO: this may be better handled by overriding `get` on models with a parent that isRoot\nexport function maybeBind(model, value, shouldBind) {\n  if (shouldBind && isFunction(value) && model.parent && model.parent.isRoot) {\n    if (!model.boundValue) {\n      model.boundValue = bind(value._r_unbound || value, model.parent.ractive);\n    }\n\n    return model.boundValue;\n  }\n\n  return value;\n}\n\nfunction updateFromBindings(model) {\n  model.updateFromBindings(true);\n}\n\nexport function findBoundValue(list) {\n  let i = list.length;\n  while (i--) {\n    if (list[i].bound) {\n      const owner = list[i].owner;\n      if (owner) {\n        const value = owner.name === 'checked' ? owner.node.checked : owner.node.value;\n        return { value };\n      }\n    }\n  }\n}\n\nexport function fireShuffleTasks(stage) {\n  if (!stage) {\n    fireShuffleTasks('early');\n    fireShuffleTasks('mark');\n  } else {\n    const tasks = shuffleTasks[stage];\n    shuffleTasks[stage] = [];\n    let i = tasks.length;\n    while (i--) tasks[i]();\n\n    const register = registerQueue[stage];\n    registerQueue[stage] = [];\n    i = register.length;\n    while (i--) register[i].model.register(register[i].item);\n  }\n}\n\nexport function shuffle(model, newIndices, link, unsafe) {\n  model.shuffling = true;\n\n  let upstream = model.source().length !== model.source().value.length;\n  let i = newIndices.length;\n  while (i--) {\n    const idx = newIndices[i];\n    // nothing is actually changing, so move in the index and roll on\n    if (i === idx) {\n      continue;\n    }\n\n    upstream = true;\n\n    // rebind the children on i to idx\n    if (i in model.childByKey)\n      model.childByKey[i].rebind(\n        !~idx ? undefined : model.joinKey(idx),\n        model.childByKey[i],\n        !unsafe\n      );\n  }\n\n  model.links.forEach(l => l.shuffle(newIndices));\n  if (!link) fireShuffleTasks('early');\n\n  i = model.deps.length;\n  while (i--) {\n    if (model.deps[i].shuffle) model.deps[i].shuffle(newIndices);\n  }\n\n  model[link ? 'marked' : 'mark']();\n  if (!link) fireShuffleTasks('mark');\n\n  if (upstream) model.notifyUpstream();\n\n  model.shuffling = false;\n}\n\nexport function checkDataLink(model, value) {\n  if (value !== model.dataModel) {\n    if (value && value.viewmodel && value.viewmodel.isRoot && model.childByKey.data) {\n      model.childByKey.data.link(value.viewmodel, 'data');\n      model.dataModel = value;\n    } else if (model.dataModel) {\n      model.childByKey.data.unlink();\n      model.dataModel = true;\n    }\n  }\n}\n","import { addToArray } from '../utils/array';\n\nconst stack = [];\nlet captureGroup;\n\nexport function startCapturing() {\n  stack.push((captureGroup = []));\n}\n\nexport function stopCapturing() {\n  const dependencies = stack.pop();\n  captureGroup = stack[stack.length - 1];\n  return dependencies;\n}\n\nexport function capture(model) {\n  if (captureGroup) {\n    addToArray(captureGroup, model);\n  }\n}\n","import ModelBase, { fireShuffleTasks, maybeBind, shuffle } from './ModelBase';\nimport { capture } from '../global/capture';\nimport { handleChange, marked, markedAll, teardown } from 'shared/methodCallers';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\nimport { hasOwn } from 'utils/object';\nimport { isUndefined } from 'utils/is';\n\n// temporary placeholder target for detached implicit links\nexport const Missing = {\n  key: '@missing',\n  animate: noop,\n  applyValue: noop,\n  get: noop,\n  getKeypath() {\n    return this.key;\n  },\n  joinAll() {\n    return this;\n  },\n  joinKey() {\n    return this;\n  },\n  mark: noop,\n  registerLink: noop,\n  shufle: noop,\n  set: noop,\n  unregisterLink: noop\n};\nMissing.parent = Missing;\n\nexport default class LinkModel extends ModelBase {\n  constructor(parent, owner, target, key) {\n    super(parent);\n\n    this.owner = owner;\n    this.target = target;\n    this.key = isUndefined(key) ? owner.key : key;\n    if (owner && owner.isLink) this.sourcePath = `${owner.sourcePath}.${this.key}`;\n\n    if (target) target.registerLink(this);\n\n    if (parent) this.isReadonly = parent.isReadonly;\n\n    this.isLink = true;\n  }\n\n  animate(from, to, options, interpolator) {\n    return this.target.animate(from, to, options, interpolator);\n  }\n\n  applyValue(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.applyValue(value);\n  }\n\n  attach(fragment) {\n    const model = resolveReference(fragment, this.key);\n    if (model) {\n      this.relinking(model, false);\n    } else {\n      // if there is no link available, move everything here to real models\n      this.owner.unlink();\n    }\n  }\n\n  detach() {\n    this.relinking(Missing, false);\n  }\n\n  get(shouldCapture, opts = {}) {\n    if (shouldCapture) {\n      capture(this);\n\n      // may need to tell the target to unwrap\n      opts.unwrap = 'unwrap' in opts ? opts.unwrap : true;\n    }\n\n    const bind = 'shouldBind' in opts ? opts.shouldBind : true;\n    opts.shouldBind = this.mapping && this.target.parent && this.target.parent.isRoot;\n\n    return maybeBind(this, this.target.get(false, opts), bind);\n  }\n\n  getKeypath(ractive) {\n    if (ractive && ractive !== this.root.ractive) return this.target.getKeypath(ractive);\n\n    return super.getKeypath(ractive);\n  }\n\n  handleChange() {\n    this.deps.forEach(handleChange);\n    this.links.forEach(handleChange);\n    this.notifyUpstream();\n  }\n\n  isDetached() {\n    return this.virtual && this.target === Missing;\n  }\n\n  joinKey(key) {\n    // TODO: handle nested links\n    if (isUndefined(key) || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new LinkModel(this, this, this.target.joinKey(key), key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n\n  mark(force) {\n    this.target.mark(force);\n  }\n\n  marked() {\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n\n    this.deps.forEach(handleChange);\n  }\n\n  markedAll() {\n    this.children.forEach(markedAll);\n    this.marked();\n  }\n\n  notifiedUpstream(startPath, root) {\n    this.links.forEach(l => l.notifiedUpstream(startPath, this.root));\n    this.deps.forEach(handleChange);\n    if (startPath && this.rootLink) {\n      const parent = this.parent;\n      if (this.root !== root) {\n        const path = startPath.slice(1);\n        path.unshift(this.key);\n        this.notifyUpstream(path);\n      } else if (parent && parent !== this.target) {\n        const path = [parent.key, this.key];\n        parent.links.forEach(l => l.notifiedUpstream(path, parent.root));\n        parent.deps.forEach(d => d.handleChange(path));\n        parent.notifyUpstream(path);\n      }\n    }\n  }\n\n  relinked() {\n    this.target.registerLink(this);\n    this.children.forEach(c => c.relinked());\n  }\n\n  relinking(target, safe) {\n    if (this.rootLink && this.sourcePath)\n      target = rebindMatch(this.sourcePath, target, this.target);\n    if (!target || this.target === target) return;\n\n    this.target && this.target.unregisterLink(this);\n\n    this.target = target;\n    this.children.forEach(c => {\n      c.relinking(target.joinKey(c.key), safe);\n    });\n\n    if (!safe) this.keypath = undefined;\n\n    if (this.rootLink)\n      this.addShuffleTask(() => {\n        this.relinked();\n        if (!safe) {\n          this.markedAll();\n          this.notifyUpstream();\n        }\n      });\n  }\n\n  set(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.set(value);\n  }\n\n  shuffle(newIndices) {\n    // watch for extra shuffles caused by a shuffle in a downstream link\n    if (this.shuffling) return;\n\n    // let the real model handle firing off shuffles\n    if (!this.target.shuffling) {\n      if (this.target.shuffle) {\n        this.target.shuffle(newIndices);\n      } else {\n        // the target is a computation, which can't shuffle\n        this.target.mark();\n      }\n    } else {\n      shuffle(this, newIndices, true);\n    }\n  }\n\n  source() {\n    if (this.target.source) return this.target.source();\n    else return this.target;\n  }\n\n  teardown() {\n    if (this._link) this._link.teardown();\n    this.target.unregisterLink(this);\n    this.children.forEach(teardown);\n  }\n}\n\nModelBase.prototype.link = function link(model, keypath, options) {\n  const lnk = this._link || new LinkModel(this.parent, this, model, this.key);\n  lnk.implicit = options && options.implicit;\n  lnk.mapping = options && options.mapping;\n  lnk.sourcePath = keypath;\n  lnk.rootLink = true;\n  if (this._link) this._link.relinking(model, false);\n  this._link = lnk;\n  this.rebind(lnk, this, false);\n  fireShuffleTasks();\n\n  lnk.markedAll();\n\n  this.notifyUpstream();\n  return lnk;\n};\n\nModelBase.prototype.unlink = function unlink() {\n  if (this._link) {\n    const ln = this._link;\n    this._link = undefined;\n    ln.rebind(this, ln, false);\n    fireShuffleTasks();\n    ln.teardown();\n    this.notifyUpstream();\n  }\n};\n","import { createFunction } from '../Ractive/config/runtime-parser';\nimport { create, keys } from 'utils/object';\n\nconst functions = create(null);\n\nexport default function getFunction(str, i) {\n  if (functions[str]) return functions[str];\n  return (functions[str] = createFunction(str, i));\n}\n\nexport function addFunctions(template) {\n  if (!template) return;\n\n  const exp = template.e;\n\n  if (!exp) return;\n\n  keys(exp).forEach(str => {\n    if (functions[str]) return;\n    functions[str] = exp[str];\n  });\n}\n","import { TEMPLATE_VERSION } from 'config/template';\nimport Parser from './Parser';\nimport readMustache from './converters/readMustache';\nimport readTriple from './converters/mustache/readTriple';\nimport readUnescaped from './converters/mustache/readUnescaped';\nimport readPartial from './converters/mustache/readPartial';\nimport readMustacheComment from './converters/mustache/readMustacheComment';\nimport readInterpolator from './converters/mustache/readInterpolator';\nimport readSection from './converters/mustache/readSection';\nimport readHtmlComment from './converters/readHtmlComment';\nimport readElement from './converters/readElement';\nimport readText from './converters/readText';\nimport readPartialDefinitionSection from './converters/readPartialDefinitionSection';\nimport readTemplate from './converters/readTemplate';\nimport readExpression from './converters/readExpression';\nimport { fromExpression } from './utils/createFunction';\nimport cleanup from './utils/cleanup';\nimport insertExpressions from './utils/insertExpressions';\nimport flattenExpression from './utils/flattenExpression';\nimport shared from '../Ractive/shared';\nimport { assign, keys } from 'utils/object';\nimport { isObjectType } from 'utils/is';\n\n// See https://github.com/ractivejs/template-spec for information\n// about the Ractive template specification\n\nconst STANDARD_READERS = [\n  readPartial,\n  readUnescaped,\n  readSection,\n  readInterpolator,\n  readMustacheComment\n];\nconst TRIPLE_READERS = [readTriple];\n\nexport const READERS = [readMustache, readHtmlComment, readElement, readText];\nexport const PARTIAL_READERS = [readPartialDefinitionSection];\n\nconst preserveWhitespaceElements = { pre: 1, script: 1, style: 1, textarea: 1 };\n\nconst defaultInterpolate = { textarea: true, script: true, style: true, template: true };\n\nconst StandardParser = Parser.extend({\n  init(str, options) {\n    const tripleDelimiters = options.tripleDelimiters || shared.defaults.tripleDelimiters;\n    const staticDelimiters = options.staticDelimiters || shared.defaults.staticDelimiters;\n    const staticTripleDelimiters =\n      options.staticTripleDelimiters || shared.defaults.staticTripleDelimiters;\n\n    this.standardDelimiters = options.delimiters || shared.defaults.delimiters;\n\n    this.tags = [\n      {\n        isStatic: false,\n        isTriple: false,\n        open: this.standardDelimiters[0],\n        close: this.standardDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: false,\n        isTriple: true,\n        open: tripleDelimiters[0],\n        close: tripleDelimiters[1],\n        readers: TRIPLE_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: false,\n        open: staticDelimiters[0],\n        close: staticDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: true,\n        open: staticTripleDelimiters[0],\n        close: staticTripleDelimiters[1],\n        readers: TRIPLE_READERS\n      }\n    ];\n\n    this.contextLines = options.contextLines || shared.defaults.contextLines;\n\n    this.sortMustacheTags();\n\n    this.sectionDepth = 0;\n    this.elementStack = [];\n\n    this.interpolate = assign(\n      {},\n      defaultInterpolate,\n      shared.defaults.interpolate,\n      options.interpolate\n    );\n\n    if (options.sanitize === true) {\n      options.sanitize = {\n        // blacklist from https://code.google.com/p/google-caja/source/browse/trunk/src/com/google/caja/lang/html/html4-elements-whitelist.json\n        elements: 'applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title'.split(\n          ' '\n        ),\n        eventAttributes: true\n      };\n    }\n\n    this.stripComments = options.stripComments !== false;\n    this.preserveWhitespace = isObjectType(options.preserveWhitespace)\n      ? false\n      : options.preserveWhitespace;\n    this.sanitizeElements = options.sanitize && options.sanitize.elements;\n    this.sanitizeEventAttributes = options.sanitize && options.sanitize.eventAttributes;\n    this.includeLinePositions = options.includeLinePositions;\n    this.textOnlyMode = options.textOnlyMode;\n    this.csp = options.csp;\n    this.allowExpressions = options.allowExpressions;\n\n    this.preserveStandaloneSections = this.preserveWhitespace && options.preserveStandaloneSections;\n\n    if (options.expression) this.converters = [readExpression];\n\n    if (options.attributes) this.inTag = true;\n\n    // special whitespace handling requested for certain elements\n    this.whiteSpaceElements = assign({}, options.preserveWhitespace, preserveWhitespaceElements);\n  },\n\n  postProcess(result, options) {\n    const [parserResult] = result;\n\n    if (options.expression) {\n      const expr = flattenExpression(parserResult);\n      expr.e = fromExpression(expr.s, expr.r.length);\n      return expr;\n    } else {\n      // special case - empty string\n      if (!result.length) {\n        return { t: [], v: TEMPLATE_VERSION };\n      }\n\n      if (this.sectionDepth > 0) {\n        this.error('A section was left open');\n      }\n\n      cleanup(\n        parserResult.t,\n        this.stripComments,\n        this.preserveWhitespace,\n        !this.preserveWhitespace,\n        !this.preserveWhitespace,\n        this.whiteSpaceElements,\n        this.preserveStandaloneSections\n      );\n\n      if (this.csp !== false) {\n        const expr = {};\n\n        insertExpressions(parserResult.t, expr);\n        insertExpressions(parserResult.p || {}, expr);\n\n        if (keys(expr).length) parserResult.e = expr;\n      }\n\n      return parserResult;\n    }\n  },\n\n  converters: [readTemplate],\n\n  sortMustacheTags() {\n    // Sort in order of descending opening delimiter length (longer first),\n    // to protect against opening delimiters being substrings of each other\n    this.tags.sort((a, b) => {\n      return b.open.length - a.open.length;\n    });\n  }\n});\n\nexport default function parse(template, options) {\n  return new StandardParser(template, options || {}).result;\n}\n","import { fromExpression } from 'parse/utils/createFunction';\nimport { doc } from 'config/environment';\nimport { fatal } from 'utils/log';\nimport { addFunctions } from 'shared/getFunction';\nimport parse from 'parse/_parse';\nimport { isString } from 'utils/is';\n\nconst parseOptions = [\n  'delimiters',\n  'tripleDelimiters',\n  'staticDelimiters',\n  'staticTripleDelimiters',\n  'csp',\n  'interpolate',\n  'preserveWhitespace',\n  'preserveStandaloneSections',\n  'sanitize',\n  'stripComments',\n  'contextLines',\n  'allowExpressions',\n  'attributes'\n];\n\nconst TEMPLATE_INSTRUCTIONS = `Either preparse or use a ractive runtime source that includes the parser. `;\n\nconst COMPUTATION_INSTRUCTIONS = `Either include a version of Ractive that can parse or convert your computation strings to functions.`;\n\nfunction throwNoParse(method, error, instructions) {\n  if (!method) {\n    fatal(`Missing Ractive.parse - cannot parse ${error}. ${instructions}`);\n  }\n}\n\nexport function createFunction(body, length) {\n  throwNoParse(fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS);\n  return fromExpression(body, length);\n}\n\nexport function createFunctionFromString(str, bindTo) {\n  throwNoParse(parse, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS);\n  const tpl = parse(str, { expression: true });\n  return function() {\n    return tpl.e.apply(bindTo, tpl.r.map(r => bindTo.get(r)));\n  };\n}\n\nconst parser = {\n  fromId(id, options) {\n    if (!doc) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Cannot retrieve template #${id} as Ractive is not running in a browser.`);\n    }\n\n    if (id) id = id.replace(/^#/, '');\n\n    let template;\n\n    if (!(template = doc.getElementById(id))) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Could not find template element with id #${id}`);\n    }\n\n    if (template.tagName.toUpperCase() !== 'SCRIPT') {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Template element with id #${id}, must be a <script> element`);\n    }\n\n    return 'textContent' in template ? template.textContent : template.innerHTML;\n  },\n\n  isParsed(template) {\n    return !isString(template);\n  },\n\n  getParseOptions(ractive) {\n    // Could be Ractive or a Component\n    if (ractive.defaults) {\n      ractive = ractive.defaults;\n    }\n\n    return parseOptions.reduce((val, key) => {\n      val[key] = ractive[key];\n      return val;\n    }, {});\n  },\n\n  parse(template, options) {\n    throwNoParse(parse, 'template', TEMPLATE_INSTRUCTIONS);\n    const parsed = parse(template, options);\n    addFunctions(parsed);\n    return parsed;\n  },\n\n  parseFor(template, ractive) {\n    return this.parse(template, this.getParseOptions(ractive));\n  }\n};\n\nexport default parser;\n","import { removeFromArray } from 'utils/array';\nimport { isFunction } from 'utils/is';\n\nlet id = 0;\n\nexport default class TransitionManager {\n  constructor(callback, parent) {\n    this.callback = callback;\n    this.parent = parent;\n\n    this.intros = [];\n    this.outros = [];\n\n    this.children = [];\n    this.totalChildren = this.outroChildren = 0;\n\n    this.detachQueue = [];\n    this.outrosComplete = false;\n\n    this.id = id++;\n\n    if (parent) {\n      parent.addChild(this);\n    }\n  }\n\n  add(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    transition.starting = true;\n    list.push(transition);\n  }\n\n  addChild(child) {\n    this.children.push(child);\n\n    this.totalChildren += 1;\n    this.outroChildren += 1;\n  }\n\n  checkStart() {\n    if (this.parent && this.parent.started) this.start();\n  }\n\n  decrementOutros() {\n    this.outroChildren -= 1;\n    check(this);\n  }\n\n  decrementTotal() {\n    this.totalChildren -= 1;\n    check(this);\n  }\n\n  detachNodes() {\n    let len = this.detachQueue.length;\n    for (let i = 0; i < len; i++) this.detachQueue[i].detach();\n    len = this.children.length;\n    for (let i = 0; i < len; i++) this.children[i].detachNodes();\n    this.detachQueue = [];\n  }\n\n  ready() {\n    if (this.detachQueue.length) detachImmediate(this);\n  }\n\n  remove(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    removeFromArray(list, transition);\n    check(this);\n  }\n\n  start() {\n    this.started = true;\n    this.children.forEach(c => c.start());\n    this.intros.concat(this.outros).forEach(t => t.start());\n    check(this);\n  }\n}\n\nfunction check(tm) {\n  if (!tm.started || tm.outros.length || tm.outroChildren) return;\n\n  // If all outros are complete, and we haven't already done this,\n  // we notify the parent if there is one, otherwise\n  // start detaching nodes\n  if (!tm.outrosComplete) {\n    tm.outrosComplete = true;\n\n    if (tm.parent) tm.parent.decrementOutros(tm);\n\n    if (allOutrosComplete(tm)) {\n      tm.detachNodes();\n    }\n  }\n\n  // Once everything is done, we can notify parent transition\n  // manager and call the callback\n  if (!tm.intros.length && !tm.totalChildren) {\n    if (isFunction(tm.callback)) {\n      tm.callback();\n    }\n\n    if (tm.parent && !tm.notifiedTotal) {\n      tm.notifiedTotal = true;\n      tm.parent.decrementTotal();\n    }\n  }\n}\n\nfunction allOutrosComplete(manager) {\n  return !manager || (manager.outrosComplete && allOutrosComplete(manager.parent));\n}\n\n// check through the detach queue to see if a node is up or downstream from a\n// transition and if not, go ahead and detach it\nfunction detachImmediate(manager) {\n  const queue = manager.detachQueue;\n  const outros = collectAllOutros(manager);\n\n  if (!outros.length) {\n    manager.detachNodes();\n  } else {\n    let i = queue.length;\n    let j = 0;\n    let node, trans;\n    const nqueue = (manager.detachQueue = []);\n\n    start: while (i--) {\n      node = queue[i].node;\n      j = outros.length;\n      while (j--) {\n        trans = outros[j].element.node;\n        // check to see if the node is, contains, or is contained by the transitioning node\n        if (trans === node || trans.contains(node) || node.contains(trans)) {\n          nqueue.push(queue[i]);\n          continue start;\n        }\n      }\n\n      // no match, we can drop it\n      queue[i].detach();\n    }\n  }\n}\n\nfunction collectAllOutros(manager, _list) {\n  let list = _list;\n\n  // if there's no list, we're starting at the root to build one\n  if (!list) {\n    list = [];\n    let parent = manager;\n    while (parent.parent) parent = parent.parent;\n    return collectAllOutros(parent, list);\n  } else {\n    // grab all outros from child managers\n    let i = manager.children.length;\n    while (i--) {\n      list = collectAllOutros(manager.children[i], list);\n    }\n\n    // grab any from this manager if there are any\n    if (manager.outros.length) list = list.concat(manager.outros);\n\n    return list;\n  }\n}\n","import { addToArray } from 'utils/array';\nimport TransitionManager from './TransitionManager';\n\nexport let batch;\n\nconst runloop = {\n  active() {\n    return !!batch;\n  },\n\n  start() {\n    let fulfilPromise;\n    const promise = new Promise(f => (fulfilPromise = f));\n\n    batch = {\n      previousBatch: batch,\n      transitionManager: new TransitionManager(fulfilPromise, batch && batch.transitionManager),\n      fragments: [],\n      tasks: [],\n      immediateObservers: [],\n      deferredObservers: [],\n      promise\n    };\n\n    return promise;\n  },\n\n  end() {\n    flushChanges();\n\n    if (!batch.previousBatch) batch.transitionManager.start();\n    else batch.transitionManager.checkStart();\n\n    batch = batch.previousBatch;\n  },\n\n  addFragment(fragment) {\n    addToArray(batch.fragments, fragment);\n  },\n\n  // TODO: come up with a better way to handle fragments that trigger their own update\n  addFragmentToRoot(fragment) {\n    if (!batch) return;\n\n    let b = batch;\n    while (b.previousBatch) {\n      b = b.previousBatch;\n    }\n\n    addToArray(b.fragments, fragment);\n  },\n\n  addObserver(observer, defer) {\n    if (!batch) {\n      observer.dispatch();\n    } else {\n      addToArray(defer ? batch.deferredObservers : batch.immediateObservers, observer);\n    }\n  },\n\n  registerTransition(transition) {\n    transition._manager = batch.transitionManager;\n    batch.transitionManager.add(transition);\n  },\n\n  // synchronise node detachments with transition ends\n  detachWhenReady(thing) {\n    batch.transitionManager.detachQueue.push(thing);\n  },\n\n  scheduleTask(task, postRender) {\n    let _batch;\n\n    if (!batch) {\n      task();\n    } else {\n      _batch = batch;\n      while (postRender && _batch.previousBatch) {\n        // this can't happen until the DOM has been fully updated\n        // otherwise in some situations (with components inside elements)\n        // transitions and decorators will initialise prematurely\n        _batch = _batch.previousBatch;\n      }\n\n      _batch.tasks.push(task);\n    }\n  },\n\n  promise() {\n    if (!batch) return Promise.resolve();\n\n    let target = batch;\n    while (target.previousBatch) {\n      target = target.previousBatch;\n    }\n\n    return target.promise || Promise.resolve();\n  }\n};\n\nexport default runloop;\n\nfunction dispatch(observer) {\n  observer.dispatch();\n}\n\nfunction flushChanges() {\n  let which = batch.immediateObservers;\n  batch.immediateObservers = [];\n  which.forEach(dispatch);\n\n  // Now that changes have been fully propagated, we can update the DOM\n  // and complete other tasks\n  let i = batch.fragments.length;\n  let fragment;\n\n  which = batch.fragments;\n  batch.fragments = [];\n\n  while (i--) {\n    fragment = which[i];\n    fragment.update();\n  }\n\n  batch.transitionManager.ready();\n\n  which = batch.deferredObservers;\n  batch.deferredObservers = [];\n  which.forEach(dispatch);\n\n  const tasks = batch.tasks;\n  batch.tasks = [];\n\n  for (i = 0; i < tasks.length; i += 1) {\n    tasks[i]();\n  }\n\n  // If updating the view caused some model blowback - e.g. a triple\n  // containing <option> elements caused the binding on the <select>\n  // to update - then we start over\n  if (\n    batch.fragments.length ||\n    batch.immediateObservers.length ||\n    batch.deferredObservers.length ||\n    batch.tasks.length\n  )\n    return flushChanges();\n}\n","import runloop from 'src/global/runloop';\n\n// TODO what happens if a transition is aborted?\n\nconst tickers = [];\nlet running = false;\n\nfunction tick() {\n  runloop.start();\n\n  const now = performance.now();\n\n  let i;\n  let ticker;\n\n  for (i = 0; i < tickers.length; i += 1) {\n    ticker = tickers[i];\n\n    if (!ticker.tick(now)) {\n      // ticker is complete, remove it from the stack, and decrement i so we don't miss one\n      tickers.splice(i--, 1);\n    }\n  }\n\n  runloop.end();\n\n  if (tickers.length) {\n    requestAnimationFrame(tick);\n  } else {\n    running = false;\n  }\n}\n\nexport default class Ticker {\n  constructor(options) {\n    this.duration = options.duration;\n    this.step = options.step;\n    this.complete = options.complete;\n    this.easing = options.easing;\n\n    this.start = performance.now();\n    this.end = this.start + this.duration;\n\n    this.running = true;\n\n    tickers.push(this);\n    if (!running) requestAnimationFrame(tick);\n  }\n\n  tick(now) {\n    if (!this.running) return false;\n\n    if (now > this.end) {\n      if (this.step) this.step(1);\n      if (this.complete) this.complete(1);\n\n      return false;\n    }\n\n    const elapsed = now - this.start;\n    const eased = this.easing(elapsed / this.duration);\n\n    if (this.step) this.step(eased);\n\n    return true;\n  }\n\n  stop() {\n    if (this.abort) this.abort();\n    this.running = false;\n  }\n}\n","import { hasOwn } from 'utils/object';\nimport { isString, isObjectType } from 'utils/is';\n\nconst prefixers = {};\n\n// TODO this is legacy. sooner we can replace the old adaptor API the better\n/* istanbul ignore next */\nfunction prefixKeypath(obj, prefix) {\n  const prefixed = {};\n\n  if (!prefix) {\n    return obj;\n  }\n\n  prefix += '.';\n\n  for (const key in obj) {\n    if (hasOwn(obj, key)) {\n      prefixed[prefix + key] = obj[key];\n    }\n  }\n\n  return prefixed;\n}\n\nexport default function getPrefixer(rootKeypath) {\n  let rootDot;\n\n  if (!prefixers[rootKeypath]) {\n    rootDot = rootKeypath ? rootKeypath + '.' : '';\n\n    /* istanbul ignore next */\n    prefixers[rootKeypath] = function(relativeKeypath, value) {\n      let obj;\n\n      if (isString(relativeKeypath)) {\n        obj = {};\n        obj[rootDot + relativeKeypath] = value;\n        return obj;\n      }\n\n      if (isObjectType(relativeKeypath)) {\n        // 'relativeKeypath' is in fact a hash, not a keypath\n        return rootDot ? prefixKeypath(relativeKeypath, rootKeypath) : relativeKeypath;\n      }\n    };\n  }\n\n  return prefixers[rootKeypath];\n}\n","import ModelBase, { checkDataLink, maybeBind, shuffle } from './ModelBase';\nimport LinkModel from './LinkModel'; // eslint-disable-line no-unused-vars\nimport getComputationSignature from 'src/Ractive/helpers/getComputationSignature';\nimport { capture } from 'src/global/capture';\nimport { isArray, isEqual, isNumeric, isObjectLike, isUndefined } from 'utils/is';\nimport { handleChange, mark, markForce, marked, teardown } from 'shared/methodCallers';\nimport Ticker from 'shared/Ticker';\nimport getPrefixer from './helpers/getPrefixer';\nimport { unescapeKey } from 'shared/keypaths';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn, keys } from 'utils/object';\nimport { buildNewIndices } from 'utils/array';\n\nexport const shared = {};\n\nexport default class Model extends ModelBase {\n  constructor(parent, key) {\n    super(parent);\n\n    this.ticker = null;\n\n    if (parent) {\n      this.key = unescapeKey(key);\n      this.isReadonly = parent.isReadonly;\n\n      if (parent.value) {\n        this.value = parent.value[this.key];\n        if (isArray(this.value)) this.length = this.value.length;\n        this.adapt();\n      }\n    }\n  }\n\n  adapt() {\n    const adaptors = this.root.adaptors;\n    const len = adaptors.length;\n\n    this.rewrap = false;\n\n    // Exit early if no adaptors\n    if (len === 0) return;\n\n    const value = this.wrapper\n      ? 'newWrapperValue' in this\n        ? this.newWrapperValue\n        : this.wrapperValue\n      : this.value;\n\n    // TODO remove this legacy nonsense\n    const ractive = this.root.ractive;\n    const keypath = this.getKeypath();\n\n    // tear previous adaptor down if present\n    if (this.wrapper) {\n      const shouldTeardown =\n        this.wrapperValue === value\n          ? false\n          : !this.wrapper.reset || this.wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        this.wrapper.teardown();\n        delete this.wrapper;\n        delete this.wrapperValue;\n        delete this.newWrapperValue;\n\n        // don't branch for undefined values\n        if (this.value !== undefined) {\n          const parentValue = this.parent.value || this.parent.createBranch(this.key);\n          if (parentValue[this.key] !== value) parentValue[this.key] = value;\n          this.value = value;\n        }\n      } else {\n        delete this.newWrapperValue;\n        this.value = this.wrapper.get();\n        return;\n      }\n    }\n\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const adaptor = adaptors[i];\n      if (adaptor.filter(value, keypath, ractive)) {\n        this.wrapper = adaptor.wrap(ractive, value, keypath, getPrefixer(keypath));\n        this.wrapperValue = value;\n        this.wrapper.__model = this; // massive temporary hack to enable array adaptor\n\n        this.value = this.wrapper.get();\n\n        break;\n      }\n    }\n  }\n\n  animate(from, to, options, interpolator) {\n    if (this.ticker) this.ticker.stop();\n\n    let fulfilPromise;\n    const promise = new Promise(fulfil => (fulfilPromise = fulfil));\n\n    this.ticker = new Ticker({\n      duration: options.duration,\n      easing: options.easing,\n      step: t => {\n        const value = interpolator(t);\n        this.applyValue(value);\n        if (options.step) options.step(t, value);\n      },\n      complete: () => {\n        this.applyValue(to);\n        if (options.complete) options.complete(to);\n\n        this.ticker = null;\n        fulfilPromise(to);\n      }\n    });\n\n    promise.stop = this.ticker.stop;\n    return promise;\n  }\n\n  applyValue(value, notify = true) {\n    if (isEqual(value, this.value)) return;\n    if (this.boundValue) this.boundValue = null;\n\n    if (this.parent.wrapper && this.parent.wrapper.set) {\n      this.parent.wrapper.set(this.key, value);\n      this.parent.value = this.parent.wrapper.get();\n\n      this.value = this.parent.value[this.key];\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    } else if (this.wrapper) {\n      this.newWrapperValue = value;\n      this.adapt();\n    } else {\n      const parentValue = this.parent.value || this.parent.createBranch(this.key);\n      if (isObjectLike(parentValue)) {\n        parentValue[this.key] = value;\n      } else {\n        warnIfDebug(`Attempted to set a property of a non-object '${this.getKeypath()}'`);\n        return;\n      }\n\n      this.value = value;\n      this.adapt();\n    }\n\n    if (this.dataModel || (value && value.viewmodel && value.viewmodel.isRoot)) {\n      checkDataLink(this, value);\n    }\n\n    // keep track of array stuff\n    if (isArray(value)) {\n      this.length = value.length;\n      this.isArray = true;\n    } else {\n      this.isArray = false;\n    }\n\n    // notify dependants\n    this.links.forEach(handleChange);\n    this.children.forEach(mark);\n    this.deps.forEach(handleChange);\n\n    if (notify) this.notifyUpstream();\n\n    if (this.parent.isArray) {\n      if (this.key === 'length') this.parent.length = value;\n      else this.parent.joinKey('length').mark();\n    }\n  }\n\n  compute(key, computed) {\n    const registry = this.computed || (this.computed = {});\n\n    if (registry[key]) {\n      registry[key].signature = getComputationSignature(this.root.ractive, key, computed);\n      registry[key].mark();\n    } else {\n      registry[key] = new shared.Computation(\n        this,\n        getComputationSignature(this.root.ractive, key, computed),\n        key\n      );\n    }\n\n    return registry[key];\n  }\n\n  createBranch(key) {\n    const branch = isNumeric(key) ? [] : {};\n    this.applyValue(branch, false);\n\n    return branch;\n  }\n\n  get(shouldCapture, opts) {\n    if (this._link) return this._link.get(shouldCapture, opts);\n    if (shouldCapture) capture(this);\n    // if capturing, this value needs to be unwrapped because it's for external use\n    if (opts && opts.virtual) return this.getVirtual(false);\n    return maybeBind(\n      this,\n      (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  joinKey(key, opts) {\n    if (this._link) {\n      if (opts && opts.lastLink !== false && (isUndefined(key) || key === '')) return this;\n      return this._link.joinKey(key);\n    }\n\n    if (isUndefined(key) || key === '') return this;\n\n    let child;\n    if (hasOwn(this.childByKey, key)) child = this.childByKey[key];\n    else child = this.computed && this.computed[key];\n\n    if (!child) {\n      let computed;\n      if (this.isRoot && this.ractive && (computed = this.ractive.computed[key])) {\n        child = this.compute(key, computed);\n      } else if (!this.isRoot && this.root.ractive) {\n        const registry = this.root.ractive.computed;\n        for (const k in registry) {\n          computed = registry[k];\n          if (computed.pattern && computed.pattern.test(this.getKeypath() + '.' + key)) {\n            child = this.compute(key, computed);\n          }\n        }\n      }\n    }\n\n    if (!child) {\n      child = new Model(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n\n      if (key === 'data') {\n        const val = this.retrieve();\n        if (val && val.viewmodel && val.viewmodel.isRoot) {\n          child.link(val.viewmodel, 'data');\n          this.dataModel = val;\n        }\n      }\n    }\n\n    if (child._link && (!opts || opts.lastLink !== false)) return child._link;\n\n    return child;\n  }\n\n  mark(force) {\n    if (this._link) return this._link.mark(force);\n\n    const old = this.value;\n    const value = this.retrieve();\n\n    if (this.dataModel || (value && value.viewmodel && value.viewmodel.isRoot)) {\n      checkDataLink(this, value);\n    }\n\n    if (force || !isEqual(value, old)) {\n      this.value = value;\n      if (this.boundValue) this.boundValue = null;\n\n      // make sure the wrapper stays in sync\n      if (old !== value || this.rewrap) {\n        if (this.wrapper) this.newWrapperValue = value;\n        this.adapt();\n      }\n\n      // keep track of array stuff\n      if (isArray(value)) {\n        this.length = value.length;\n        this.isArray = true;\n      } else {\n        this.isArray = false;\n      }\n\n      this.children.forEach(force ? markForce : mark);\n      this.links.forEach(marked);\n\n      this.deps.forEach(handleChange);\n    }\n  }\n\n  merge(array, comparator) {\n    const newIndices = buildNewIndices(\n      this.value === array ? recreateArray(this) : this.value,\n      array,\n      comparator\n    );\n    this.parent.value[this.key] = array;\n    this.shuffle(newIndices, true);\n  }\n\n  retrieve() {\n    return this.parent.value ? this.parent.value[this.key] : undefined;\n  }\n\n  set(value) {\n    if (this.ticker) this.ticker.stop();\n    this.applyValue(value);\n  }\n\n  shuffle(newIndices, unsafe) {\n    shuffle(this, newIndices, false, unsafe);\n  }\n\n  source() {\n    return this;\n  }\n\n  teardown() {\n    if (this._link) {\n      this._link.teardown();\n      this._link = null;\n    }\n    this.children.forEach(teardown);\n    if (this.wrapper) this.wrapper.teardown();\n    if (this.computed) keys(this.computed).forEach(k => this.computed[k].teardown());\n  }\n}\n\nfunction recreateArray(model) {\n  const array = [];\n\n  for (let i = 0; i < model.length; i++) {\n    array[i] = (model.childByKey[i] || {}).value;\n  }\n\n  return array;\n}\n","/* global global */\nimport Model from '../Model';\nimport { base } from 'config/environment';\n\nexport const data = {};\n\nexport class SharedModel extends Model {\n  constructor(value, name, ractive) {\n    super(null, `@${name}`);\n    this.key = `@${name}`;\n    this.value = value;\n    this.isRoot = true;\n    this.root = this;\n    this.adaptors = [];\n    this.ractive = ractive;\n  }\n\n  getKeypath() {\n    return this.key;\n  }\n\n  retrieve() {\n    return this.value;\n  }\n}\n\nexport default new SharedModel(data, 'shared');\n\nexport const GlobalModel = new SharedModel(base, 'global');\n","import noop from 'utils/noop';\nimport { assign, create } from 'utils/object';\n\nexport const extern = {};\n\nexport default function getRactiveContext(ractive, ...assigns) {\n  const fragment =\n    ractive.fragment ||\n    ractive._fakeFragment ||\n    (ractive._fakeFragment = new FakeFragment(ractive));\n  return fragment.getContext.apply(fragment, assigns);\n}\n\nexport function getContext(...assigns) {\n  if (!this.ctx) this.ctx = new extern.Context(this);\n  assigns.unshift(create(this.ctx));\n  return assign.apply(null, assigns);\n}\n\nexport class FakeFragment {\n  constructor(ractive) {\n    this.ractive = ractive;\n  }\n\n  findContext() {\n    return this.ractive.viewmodel;\n  }\n}\nconst proto = FakeFragment.prototype;\nproto.getContext = getContext;\nproto.find = proto.findComponent = proto.findAll = proto.findAllComponents = noop;\n\nexport function findParentWithContext(fragment) {\n  let frag = fragment;\n  while (frag && !frag.context) frag = frag.parent;\n  if (!frag) return fragment && fragment.ractive.fragment;\n  else return frag;\n}\n","import {\n  isArray,\n  isDate,\n  isObject,\n  isObjectType,\n  isFunction,\n  isString,\n  isUndefined\n} from 'utils/is';\nimport { warnIfDebug } from 'utils/log';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from '../global/runloop';\nimport { splitKeypath } from './keypaths';\nimport { FakeFragment } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\n\nexport let keep = false;\n\nexport function set(pairs, options) {\n  const k = keep;\n\n  const deep = options && options.deep;\n  const shuffle = options && options.shuffle;\n  const promise = runloop.start();\n  if (options && 'keep' in options) keep = options.keep;\n\n  let i = pairs.length;\n  while (i--) {\n    const model = pairs[i][0];\n    const value = pairs[i][1];\n    const keypath = pairs[i][2];\n\n    if (!model) {\n      runloop.end();\n      throw new Error(`Failed to set invalid keypath '${keypath}'`);\n    }\n\n    if (deep) deepSet(model, value);\n    else if (shuffle) {\n      let array = value;\n      const target = model.get();\n      // shuffle target array with itself\n      if (!array) array = target;\n\n      // if there's not an array there yet, go ahead and set\n      if (isUndefined(target)) {\n        model.set(array);\n      } else {\n        if (!isArray(target) || !isArray(array)) {\n          runloop.end();\n          throw new Error('You cannot merge an array with a non-array');\n        }\n\n        const comparator = getComparator(shuffle);\n        model.merge(array, comparator);\n      }\n    } else model.set(value);\n  }\n\n  runloop.end();\n\n  keep = k;\n\n  if (pairs.length === 1) return promise.then(() => pairs[0][1]);\n  else return promise;\n}\n\nconst star = /\\*/;\nexport function gather(ractive, keypath, base, isolated) {\n  if (!base && (keypath[0] === '.' || keypath[1] === '^')) {\n    warnIfDebug(\n      `Attempted to set a relative keypath from a non-relative context. You can use a context object to set relative keypaths.`\n    );\n    return [];\n  }\n\n  const keys = splitKeypath(keypath);\n  const model = base || ractive.viewmodel;\n\n  if (star.test(keypath)) {\n    return model.findMatches(keys);\n  } else {\n    if (model === ractive.viewmodel) {\n      // allow implicit mappings\n      if (\n        ractive.component &&\n        !ractive.isolated &&\n        !model.has(keys[0]) &&\n        keypath[0] !== '@' &&\n        keypath[0] &&\n        !isolated\n      ) {\n        return [resolveReference(ractive.fragment || new FakeFragment(ractive), keypath)];\n      } else {\n        return [model.joinAll(keys)];\n      }\n    } else {\n      return [model.joinAll(keys)];\n    }\n  }\n}\n\nexport function build(ractive, keypath, value, isolated) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push.apply(sets, gather(ractive, k, null, isolated).map(m => [m, keypath[k], k]));\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push.apply(sets, gather(ractive, keypath, null, isolated).map(m => [m, value, keypath]));\n  }\n\n  return sets;\n}\n\nconst deepOpts = { virtual: false };\nfunction deepSet(model, value) {\n  const dest = model.get(false, deepOpts);\n\n  // if dest doesn't exist, just set it\n  if (dest == null || !isObjectType(value) || isDate(value)) return model.set(value);\n  if (!isObjectType(dest)) return model.set(value);\n\n  for (const k in value) {\n    if (hasOwn(value, k)) {\n      deepSet(model.joinKey(k), value[k]);\n    }\n  }\n}\n\nconst comparators = {};\nfunction getComparator(option) {\n  if (option === true) return null; // use existing arrays\n  if (isFunction(option)) return option;\n\n  if (isString(option)) {\n    return comparators[option] || (comparators[option] = thing => thing[option]);\n  }\n\n  throw new Error('If supplied, options.compare must be a string, function, or true'); // TODO link to docs\n}\n","import { isNumeric, isString } from 'utils/is';\nimport { build, set } from 'shared/set';\n\nconst errorMessage = 'Cannot add to a non-numeric value';\n\nexport default function add(ractive, keypath, d, options) {\n  if (!isString(keypath) || !isNumeric(d)) {\n    throw new Error('Bad arguments');\n  }\n\n  const sets = build(ractive, keypath, d, options && options.isolated);\n\n  return set(\n    sets.map(pair => {\n      const [model, add] = pair;\n      const value = model.get();\n      if (!isNumeric(add) || !isNumeric(value)) throw new Error(errorMessage);\n      return [model, value + add];\n    })\n  );\n}\n","import runloop from 'src/global/runloop';\nimport easing from 'src/Ractive/static/easing';\nimport interpolate from 'shared/interpolate';\nimport { isEqual, isFunction, isObjectType } from 'utils/is';\nimport noop from 'utils/noop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { defineProperty, keys as objectKeys } from 'utils/object';\n\nfunction immediate(value) {\n  const result = Promise.resolve(value);\n  defineProperty(result, 'stop', { value: noop });\n  return result;\n}\n\nconst linear = easing.linear;\n\nfunction getOptions(options, instance) {\n  options = options || {};\n\n  let easing;\n  if (options.easing) {\n    easing = isFunction(options.easing) ? options.easing : instance.easing[options.easing];\n  }\n\n  return {\n    easing: easing || linear,\n    duration: 'duration' in options ? options.duration : 400,\n    complete: options.complete || noop,\n    step: options.step || noop,\n    interpolator: options.interpolator\n  };\n}\n\nexport function animate(ractive, model, to, options) {\n  options = getOptions(options, ractive);\n  const from = model.get();\n\n  // don't bother animating values that stay the same\n  if (isEqual(from, to)) {\n    options.complete(options.to);\n    return immediate(to);\n  }\n\n  const interpolator = interpolate(from, to, ractive, options.interpolator);\n\n  // if we can't interpolate the value, set it immediately\n  if (!interpolator) {\n    runloop.start();\n    model.set(to);\n    runloop.end();\n\n    return immediate(to);\n  }\n\n  return model.animate(from, to, options, interpolator);\n}\n\nexport default function Ractive$animate(keypath, to, options) {\n  if (isObjectType(keypath)) {\n    const keys = objectKeys(keypath);\n\n    throw new Error(`ractive.animate(...) no longer supports objects. Instead of ractive.animate({\n  ${keys.map(key => `'${key}': ${keypath[key]}`).join('\\n  ')}\n}, {...}), do\n\n${keys.map(key => `ractive.animate('${key}', ${keypath[key]}, {...});`).join('\\n')}\n`);\n  }\n\n  return animate(this, this.viewmodel.joinAll(splitKeypath(keypath)), to, options);\n}\n","import { enqueue, dequeue } from './eventStack';\n\nconst initStars = {};\nconst bubbleStars = {};\n\n// cartesian product of name parts and stars\n// adjusted appropriately for special cases\nfunction variants(name, initial) {\n  const map = initial ? initStars : bubbleStars;\n  if (map[name]) return map[name];\n\n  const parts = name.split('.');\n  const result = [];\n  let base = false;\n\n  // initial events the implicit namespace of 'this'\n  if (initial) {\n    parts.unshift('this');\n    base = true;\n  }\n\n  // use max - 1 bits as a bitmap to pick a part or a *\n  // need to skip the full star case if the namespace is synthetic\n  const max = Math.pow(2, parts.length) - (initial ? 1 : 0);\n  for (let i = 0; i < max; i++) {\n    const join = [];\n    for (let j = 0; j < parts.length; j++) {\n      join.push(1 & (i >> j) ? '*' : parts[j]);\n    }\n    result.unshift(join.join('.'));\n  }\n\n  if (base) {\n    // include non-this-namespaced versions\n    if (parts.length > 2) {\n      result.push.apply(result, variants(name, false));\n    } else {\n      result.push('*');\n      result.push(name);\n    }\n  }\n\n  map[name] = result;\n  return result;\n}\n\nexport default function fireEvent(ractive, eventName, context, args = []) {\n  if (!eventName) {\n    return;\n  }\n\n  context.name = eventName;\n  args.unshift(context);\n\n  const eventNames = ractive._nsSubs ? variants(eventName, true) : ['*', eventName];\n\n  return fireEventAs(ractive, eventNames, context, args, true);\n}\n\nfunction fireEventAs(ractive, eventNames, context, args, initialFire = false) {\n  let bubble = true;\n\n  if (initialFire || ractive._nsSubs) {\n    enqueue(ractive, context);\n\n    let i = eventNames.length;\n    while (i--) {\n      if (eventNames[i] in ractive._subs) {\n        bubble = notifySubscribers(ractive, ractive._subs[eventNames[i]], context, args) && bubble;\n      }\n    }\n\n    dequeue(ractive);\n  }\n\n  if (ractive.parent && bubble) {\n    if (initialFire && ractive.component) {\n      const fullName = ractive.component.name + '.' + eventNames[eventNames.length - 1];\n      eventNames = variants(fullName, false);\n\n      if (context && !context.component) {\n        context.component = ractive;\n      }\n    }\n\n    bubble = fireEventAs(ractive.parent, eventNames, context, args);\n  }\n\n  return bubble;\n}\n\nfunction notifySubscribers(ractive, subscribers, context, args) {\n  let originalEvent = null;\n  let stopEvent = false;\n\n  // subscribers can be modified inflight, e.g. \"once\" functionality\n  // so we need to copy to make sure everyone gets called\n  subscribers = subscribers.slice();\n\n  for (let i = 0, len = subscribers.length; i < len; i += 1) {\n    if (!subscribers[i].off && subscribers[i].handler.apply(ractive, args) === false) {\n      stopEvent = true;\n    }\n  }\n\n  if (context && stopEvent && (originalEvent = context.event)) {\n    originalEvent.preventDefault && originalEvent.preventDefault();\n    originalEvent.stopPropagation && originalEvent.stopPropagation();\n  }\n\n  return !stopEvent;\n}\n","import fireEvent from './fireEvent';\nimport getRactiveContext from '../shared/getRactiveContext';\n\nexport class Hook {\n  constructor(event) {\n    this.event = event;\n    this.method = 'on' + event;\n  }\n\n  fire(ractive, arg) {\n    const context = getRactiveContext(ractive);\n    const method = this.method;\n\n    if (ractive[method]) {\n      arg ? ractive[method](context, arg) : ractive[method](context);\n    }\n\n    fireEvent(ractive, this.event, context, arg ? [arg, ractive] : [ractive]);\n  }\n}\n\nfunction getChildQueue(queue, ractive) {\n  return queue[ractive._guid] || (queue[ractive._guid] = []);\n}\n\nfunction fire(hookQueue, ractive) {\n  const childQueue = getChildQueue(hookQueue.queue, ractive);\n\n  hookQueue.hook.fire(ractive);\n\n  // queue is \"live\" because components can end up being\n  // added while hooks fire on parents that modify data values.\n  while (childQueue.length) {\n    fire(hookQueue, childQueue.shift());\n  }\n\n  delete hookQueue.queue[ractive._guid];\n}\n\nexport class HookQueue {\n  constructor(event) {\n    this.hook = new Hook(event);\n    this.inProcess = {};\n    this.queue = {};\n  }\n\n  begin(ractive) {\n    this.inProcess[ractive._guid] = true;\n  }\n\n  end(ractive) {\n    const parent = ractive.parent;\n\n    // If this is *isn't* a child of a component that's in process,\n    // it should call methods or fire at this point\n    if (!parent || !this.inProcess[parent._guid]) {\n      fire(this, ractive);\n    } else {\n      // elsewise, handoff to parent to fire when ready\n      getChildQueue(this.queue, parent).push(ractive);\n    }\n\n    delete this.inProcess[ractive._guid];\n  }\n}\n\nconst hooks = {};\n[\n  'construct',\n  'config',\n  'attachchild',\n  'detach',\n  'detachchild',\n  'insert',\n  'complete',\n  'reset',\n  'render',\n  'unrendering',\n  'unrender',\n  'teardown',\n  'destruct',\n  'update'\n].forEach(hook => {\n  hooks[hook] = new Hook(hook);\n});\nhooks.init = new HookQueue('init');\n\nexport default hooks;\n","export const TEXT = 1;\nexport const INTERPOLATOR = 2;\nexport const TRIPLE = 3;\nexport const SECTION = 4;\nexport const INVERTED = 5;\nexport const CLOSING = 6;\nexport const ELEMENT = 7;\nexport const PARTIAL = 8;\nexport const COMMENT = 9;\nexport const DELIMCHANGE = 10;\nexport const ANCHOR = 11;\nexport const ATTRIBUTE = 13;\nexport const CLOSING_TAG = 14;\nexport const COMPONENT = 15;\nexport const YIELDER = 16;\nexport const INLINE_PARTIAL = 17;\nexport const DOCTYPE = 18;\nexport const ALIAS = 19;\n\nexport const AWAIT = 55;\n\nexport const NUMBER_LITERAL = 20;\nexport const STRING_LITERAL = 21;\nexport const ARRAY_LITERAL = 22;\nexport const OBJECT_LITERAL = 23;\nexport const BOOLEAN_LITERAL = 24;\nexport const REGEXP_LITERAL = 25;\n\nexport const GLOBAL = 26;\nexport const KEY_VALUE_PAIR = 27;\n\nexport const REFERENCE = 30;\nexport const REFINEMENT = 31;\nexport const MEMBER = 32;\nexport const PREFIX_OPERATOR = 33;\nexport const BRACKETED = 34;\nexport const CONDITIONAL = 35;\nexport const INFIX_OPERATOR = 36;\n\nexport const INVOCATION = 40;\n\nexport const SECTION_IF = 50;\nexport const SECTION_UNLESS = 51;\nexport const SECTION_EACH = 52;\nexport const SECTION_WITH = 53;\nexport const SECTION_IF_WITH = 54;\n\nexport const ELSE = 60;\nexport const ELSEIF = 61;\nexport const THEN = 62;\nexport const CATCH = 63;\n\nexport const EVENT = 70;\nexport const DECORATOR = 71;\nexport const TRANSITION = 72;\nexport const BINDING_FLAG = 73;\nexport const DELEGATE_FLAG = 74;\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\nimport getNewIndices from 'shared/getNewIndices';\nimport { isArray, isUndefined } from 'utils/is';\n\nconst arrayProto = Array.prototype;\n\nexport default function(methodName) {\n  function path(keypath, ...args) {\n    return model(this.viewmodel.joinAll(splitKeypath(keypath)), args);\n  }\n\n  function model(mdl, args) {\n    let array = mdl.get();\n\n    if (!isArray(array)) {\n      if (isUndefined(array)) {\n        array = [];\n        const result = arrayProto[methodName].apply(array, args);\n        const promise = runloop.start().then(() => result);\n        mdl.set(array);\n        runloop.end();\n        return promise;\n      } else {\n        throw new Error(\n          `shuffle array method ${methodName} called on non-array at ${mdl.getKeypath()}`\n        );\n      }\n    }\n\n    const newIndices = getNewIndices(array.length, methodName, args);\n    const result = arrayProto[methodName].apply(array, args);\n\n    const promise = runloop.start().then(() => result);\n    promise.result = result;\n\n    if (newIndices) {\n      if (mdl.shuffle) {\n        mdl.shuffle(newIndices);\n      } else {\n        // it's a computation, which don't have a shuffle, so just invalidate\n        mdl.mark();\n      }\n    } else {\n      mdl.set(result);\n    }\n\n    runloop.end();\n\n    return promise;\n  }\n\n  return { path, model };\n}\n","import noop from 'utils/noop';\nimport { isFunction } from 'utils/is';\n\nexport default function wrap(parent, name, method) {\n  if (!/_super/.test(method)) return method;\n\n  function wrapper() {\n    const superMethod = getSuperMethod(wrapper._parent, name);\n    const hasSuper = '_super' in this;\n    const oldSuper = this._super;\n\n    this._super = superMethod;\n\n    const result = method.apply(this, arguments);\n\n    if (hasSuper) {\n      this._super = oldSuper;\n    } else {\n      delete this._super;\n    }\n\n    return result;\n  }\n\n  wrapper._parent = parent;\n  wrapper._method = method;\n\n  return wrapper;\n}\n\nfunction getSuperMethod(parent, name) {\n  if (name in parent) {\n    const value = parent[name];\n\n    return isFunction(value) ? value : () => value;\n  }\n\n  return noop;\n}\n","import { warnIfDebug } from 'utils/log';\nimport { isArray } from 'utils/is';\n\nfunction getMessage(deprecated, correct, isError) {\n  return (\n    `options.${deprecated} has been deprecated in favour of options.${correct}.` +\n    (isError ? ` You cannot specify both options, please use options.${correct}.` : '')\n  );\n}\n\nfunction deprecateOption(options, deprecatedOption, correct) {\n  if (deprecatedOption in options) {\n    if (!(correct in options)) {\n      warnIfDebug(getMessage(deprecatedOption, correct));\n      options[correct] = options[deprecatedOption];\n    } else {\n      throw new Error(getMessage(deprecatedOption, correct, true));\n    }\n  }\n}\n\nexport default function deprecate(options) {\n  deprecateOption(options, 'beforeInit', 'onconstruct');\n  deprecateOption(options, 'init', 'onrender');\n  deprecateOption(options, 'complete', 'oncomplete');\n  deprecateOption(options, 'eventDefinitions', 'events');\n\n  // Using extend with Component instead of options,\n  // like Human.extend( Spider ) means adaptors as a registry\n  // gets copied to options. So we have to check if actually an array\n  if (isArray(options.adaptors)) {\n    deprecateOption(options, 'adaptors', 'adapt');\n  }\n}\n","export default function(camelCaseStr) {\n  return camelCaseStr.replace(/([A-Z])/g, (match, $1) => {\n    return '-' + $1.toLowerCase();\n  });\n}\n","import hooks from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\nimport { cancel } from 'shared/methodCallers';\nimport { warnIfDebug } from 'utils/log';\n\n// Teardown. This goes through the root fragment and all its children, removing observers\n// and generally cleaning up after itself\n\nexport default function Ractive$teardown() {\n  if (this.torndown) {\n    warnIfDebug('ractive.teardown() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  this.shouldDestroy = true;\n  return teardown(this, () => (this.fragment.rendered ? this.unrender() : Promise.resolve()));\n}\n\nexport function teardown(instance, getPromise) {\n  instance.torndown = true;\n  instance.fragment.unbind();\n  instance._observers.slice().forEach(cancel);\n\n  if (instance.el && instance.el.__ractive_instances__) {\n    removeFromArray(instance.el.__ractive_instances__, instance);\n  }\n\n  const promise = getPromise();\n\n  hooks.teardown.fire(instance);\n\n  promise.then(() => {\n    hooks.destruct.fire(instance);\n    instance.viewmodel.teardown();\n  });\n\n  return promise;\n}\n","import { create, toPairs } from 'utils/object';\nimport { isFunction, isObjectType } from 'utils/is';\n\nexport default function subscribe(instance, options, type) {\n  const subs = (instance.constructor[`_${type}`] || []).concat(toPairs(options[type] || []));\n  const single = type === 'on' ? 'once' : `${type}Once`;\n\n  subs.forEach(([target, config]) => {\n    if (isFunction(config)) {\n      instance[type](target, config);\n    } else if (isObjectType(config) && isFunction(config.handler)) {\n      instance[config.once ? single : type](target, config.handler, create(config));\n    }\n  });\n}\n","import getFunction from 'shared/getFunction';\nimport ExpressionProxy from 'src/view/resolvers/ExpressionProxy';\nimport resolveReference from '../../resolvers/resolveReference';\n\nexport function setupArgsFn(item, template, fragment, opts = {}) {\n  if (template && template.f && template.f.s) {\n    if (opts.register) {\n      item.model = new ExpressionProxy(fragment, template.f);\n      item.model.register(item);\n    } else {\n      item.fn = getFunction(template.f.s, template.f.r.length);\n    }\n  }\n}\n\nexport function resolveArgs(item, template, fragment, opts = {}) {\n  return template.f.r.map((ref, i) => {\n    let model;\n\n    if (opts.specialRef && (model = opts.specialRef(ref, i))) return model;\n\n    model = resolveReference(fragment, ref);\n\n    return model;\n  });\n}\n\nexport function teardownArgsFn(item) {\n  if (item.model) item.model.unregister(item);\n}\n","// This is the handler for DOM events that would lead to a change in the model\n// (i.e. change, sometimes, input, and occasionally click and keyup)\nexport default function handleDomEvent() {\n  this._ractive.binding.handleChange();\n}\n","import { toArray } from './array';\n\nexport default function getSelectedOptions(select) {\n  /* istanbul ignore next */\n  return select.selectedOptions\n    ? toArray(select.selectedOptions)\n    : select.options\n    ? toArray(select.options).filter(option => option.selected)\n    : [];\n}\n","import { INTERPOLATOR, TRIPLE } from 'config/types';\nimport { warnIfDebug } from 'utils/log';\nimport CheckboxBinding from './CheckboxBinding';\nimport CheckboxNameBinding from './CheckboxNameBinding';\nimport ContentEditableBinding from './ContentEditableBinding';\nimport FileBinding from './FileBinding';\nimport GenericBinding from './GenericBinding';\nimport MultipleSelectBinding from './MultipleSelectBinding';\nimport NumericBinding from './NumericBinding';\nimport RadioBinding from './RadioBinding';\nimport RadioNameBinding from './RadioNameBinding';\nimport SingleSelectBinding from './SingleSelectBinding';\n\nexport function isBindable(attribute) {\n  // The fragment must be a single non-string fragment\n  if (\n    !attribute ||\n    !attribute.template.f ||\n    attribute.template.f.length !== 1 ||\n    attribute.template.f[0].s\n  )\n    return false;\n\n  // A binding is an interpolator `{{ }}`, yey.\n  if (attribute.template.f[0].t === INTERPOLATOR) return true;\n\n  // The above is probably the only true case. For the rest, show an appropriate\n  // warning before returning false.\n\n  // You can't bind a triple curly. HTML values on an attribute makes no sense.\n  if (attribute.template.f[0].t === TRIPLE)\n    warnIfDebug('It is not possible create a binding using a triple mustache.');\n\n  return false;\n}\n\nexport default function selectBinding(element) {\n  const name = element.name;\n  const attributes = element.attributeByName;\n  if (name !== 'input' && name !== 'textarea' && name !== 'select' && !attributes.contenteditable)\n    return;\n  const isBindableByValue = isBindable(attributes.value);\n  const isBindableByContentEditable = isBindable(attributes.contenteditable);\n  const isContentEditable = element.getAttribute('contenteditable');\n\n  // contenteditable\n  // Bind if the contenteditable is true or a binding that may become true.\n  if ((isContentEditable || isBindableByContentEditable) && isBindableByValue)\n    return ContentEditableBinding;\n\n  // <input>\n  if (name === 'input') {\n    const type = element.getAttribute('type');\n\n    if (type === 'radio') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // For radios we can either bind the name or checked, but not both.\n      // Name binding is handed instead.\n      if (isBindableByName && isBindableByChecked) {\n        warnIfDebug(\n          'A radio input can have two-way binding on its name attribute, or its checked attribute - not both',\n          { ractive: element.root }\n        );\n        return RadioNameBinding;\n      }\n\n      if (isBindableByName) return RadioNameBinding;\n\n      if (isBindableByChecked) return RadioBinding;\n\n      // Dead end. Unknown binding on radio input.\n      return null;\n    }\n\n    if (type === 'checkbox') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // A checkbox with bindings for both name and checked. Checked treated as\n      // the checkbox value, name is treated as a regular binding.\n      //\n      // See https://github.com/ractivejs/ractive/issues/1749\n      if (isBindableByName && isBindableByChecked) return CheckboxBinding;\n\n      if (isBindableByName) return CheckboxNameBinding;\n\n      if (isBindableByChecked) return CheckboxBinding;\n\n      // Dead end. Unknown binding on checkbox input.\n      return null;\n    }\n\n    if (type === 'file' && isBindableByValue) return FileBinding;\n\n    if (type === 'number' && isBindableByValue) return NumericBinding;\n\n    if (type === 'range' && isBindableByValue) return NumericBinding;\n\n    // Some input of unknown type (browser usually falls back to text).\n    if (isBindableByValue) return GenericBinding;\n\n    // Dead end. Some unknown input and an unbindable.\n    return null;\n  }\n\n  // <select>\n  if (name === 'select' && isBindableByValue) {\n    return element.getAttribute('multiple') ? MultipleSelectBinding : SingleSelectBinding;\n  }\n\n  // <textarea>\n  if (name === 'textarea' && isBindableByValue) return GenericBinding;\n\n  // Dead end. Some unbindable element.\n  return null;\n}\n","import { doc } from 'config/environment';\n\nexport default function progressiveText(item, target, occupants, text) {\n  if (occupants) {\n    let n = occupants[0];\n    if (n && n.nodeType === 3) {\n      const idx = n.nodeValue.indexOf(text);\n      occupants.shift();\n\n      if (idx === 0) {\n        if (n.nodeValue.length !== text.length) {\n          occupants.unshift(n.splitText(text.length));\n        }\n      } else {\n        n.nodeValue = text;\n      }\n    } else {\n      n = item.node = doc.createTextNode(text);\n      if (occupants[0]) {\n        target.insertBefore(n, occupants[0]);\n      } else {\n        target.appendChild(n);\n      }\n    }\n\n    item.node = n;\n  } else {\n    if (!item.node) item.node = doc.createTextNode(text);\n    target.appendChild(item.node);\n  }\n}\n","import resolveReference from './resolveReference';\nimport ExpressionProxy from './ExpressionProxy';\nimport ReferenceExpressionProxy from './ReferenceExpressionProxy';\n\nexport default function resolve(fragment, template) {\n  if (template.r) {\n    return resolveReference(fragment, template.r);\n  } else if (template.x) {\n    return new ExpressionProxy(fragment, template.x);\n  } else if (template.rx) {\n    return new ReferenceExpressionProxy(fragment, template.rx);\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { fillGaps, hasOwn } from 'utils/object';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { findInstance } from 'shared/registry';\nimport { isArray, isFunction } from 'utils/is';\nimport { addFunctions } from 'shared/getFunction';\n\nexport default function getPartialTemplate(ractive, name, up) {\n  // If the partial in instance or view heirarchy instances, great\n  let partial = getPartialFromRegistry(ractive, name, up || {});\n  if (partial) return partial;\n\n  // Does it exist on the page as a script tag?\n  partial = parser.fromId(name, { noThrow: true });\n  if (partial) {\n    // parse and register to this ractive instance\n    const parsed = parser.parseFor(partial, ractive);\n\n    // register extra partials on the ractive instance if they don't already exist\n    if (parsed.p) fillGaps(ractive.partials, parsed.p);\n\n    // register (and return main partial if there are others in the template)\n    return (ractive.partials[name] = parsed.t);\n  }\n}\n\nfunction getPartialFromRegistry(ractive, name, up) {\n  // if there was an instance up-hierarchy, cool\n  let partial = findParentPartial(name, up.owner);\n  if (partial) return partial;\n\n  // find first instance in the ractive or view hierarchy that has this partial\n  const instance = findInstance('partials', ractive, name);\n\n  if (!instance) {\n    return;\n  }\n\n  partial = instance.partials[name];\n\n  // partial is a function?\n  let fn;\n  if (isFunction(partial)) {\n    fn = partial;\n    // super partial\n    if (fn.styleSet) return fn;\n\n    fn = partial.bind(instance);\n    fn.isOwner = hasOwn(instance.partials, name);\n    partial = fn.call(ractive, parser);\n  }\n\n  if (!partial && partial !== '') {\n    warnIfDebug(noRegistryFunctionReturn, name, 'partial', 'partial', {\n      ractive\n    });\n    return;\n  }\n\n  // If this was added manually to the registry,\n  // but hasn't been parsed, parse it now\n  if (!parser.isParsed(partial)) {\n    // use the parseOptions of the ractive instance on which it was found\n    const parsed = parser.parseFor(partial, instance);\n\n    // Partials cannot contain nested partials!\n    // TODO add a test for this\n    if (parsed.p) {\n      warnIfDebug('Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive });\n    }\n\n    // if fn, use instance to store result, otherwise needs to go\n    // in the correct point in prototype chain on instance or constructor\n    const target = fn ? instance : findOwner(instance, name);\n\n    // may be a template with partials, which need to be registered and main template extracted\n    target.partials[name] = partial = parsed.t;\n  }\n\n  // store for reset\n  if (fn) partial._fn = fn;\n\n  // if the partial is a pre-parsed template object, import any expressions and update the registry\n  if (partial.v) {\n    addFunctions(partial);\n    return (instance.partials[name] = partial.t);\n  } else {\n    return partial;\n  }\n}\n\nfunction findOwner(ractive, key) {\n  return hasOwn(ractive.partials, key) ? ractive : findConstructor(ractive.constructor, key);\n}\n\nfunction findConstructor(constructor, key) {\n  if (!constructor) {\n    return;\n  }\n  return hasOwn(constructor.partials, key) ? constructor : findConstructor(constructor.Parent, key);\n}\n\nfunction findParentPartial(name, parent) {\n  if (parent) {\n    if (\n      parent.template &&\n      parent.template.p &&\n      !isArray(parent.template.p) &&\n      hasOwn(parent.template.p, name)\n    ) {\n      return parent.template.p[name];\n    } else if (parent.up && parent.up.owner) {\n      return findParentPartial(name, parent.up.owner);\n    }\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { findInstance } from 'shared/registry';\nimport { hasOwn } from 'utils/object';\nimport { isFunction, isString } from 'utils/is';\n\n// finds the component constructor in the registry or view hierarchy registries\nexport default function getComponentConstructor(ractive, name) {\n  const instance = findInstance('components', ractive, name);\n  let Component;\n\n  if (instance) {\n    Component = instance.components[name];\n\n    if (Component && !Component.isInstance) {\n      if (Component.default && Component.default.isInstance) Component = Component.default;\n      else if (!Component.then && isFunction(Component)) {\n        // function option, execute and store for reset\n        const fn = Component.bind(instance);\n        fn.isOwner = hasOwn(instance.components, name);\n        Component = fn();\n\n        if (!Component) {\n          warnIfDebug(noRegistryFunctionReturn, name, 'component', 'component', {\n            ractive\n          });\n          return;\n        }\n\n        if (isString(Component)) {\n          // allow string lookup\n          Component = getComponentConstructor(ractive, Component);\n        }\n\n        Component._fn = fn;\n        instance.components[name] = Component;\n      }\n    }\n  }\n\n  return Component;\n}\n","import Partial from './Partial';\nimport { ELEMENT } from 'config/types';\nimport { assign } from 'utils/object';\n\nexport default function asyncProxy(promise, options) {\n  const partials = options.template.p || {};\n  const name = options.template.e;\n\n  const opts = assign({}, options, {\n    template: { t: ELEMENT, e: name },\n    macro(handle) {\n      handle.setTemplate(partials['async-loading'] || []);\n      promise.then(\n        cmp => {\n          options.up.ractive.components[name] = cmp;\n          if (partials['async-loaded']) {\n            handle.partials.component = [options.template];\n            handle.setTemplate(partials['async-loaded']);\n          } else {\n            handle.setTemplate([options.template]);\n          }\n        },\n        err => {\n          if (partials['async-failed']) {\n            handle.aliasLocal('error', 'error');\n            handle.set('@local.error', err);\n            handle.setTemplate(partials['async-failed']);\n          } else {\n            handle.setTemplate([]);\n          }\n        }\n      );\n    }\n  });\n  return new Partial(opts);\n}\n","import { ATTRIBUTE, CATCH, ELEMENT, ELSE, INTERPOLATOR, SECTION, THEN } from 'src/config/types';\nimport Partial from './Partial';\nimport { assign } from 'utils/object';\nimport { isFunction, isUndefined } from 'utils/is';\n\nfunction extract(tpl, type, name) {\n  const p = tpl.f.find(s => s.t === type);\n  if (p) {\n    if (p.n)\n      return [\n        {\n          t: 19,\n          n: 54,\n          f: p.f || [],\n          z: [{ n: p.n, x: { r: `__await.${name}` } }]\n        }\n      ];\n    else return p.f || [];\n  } else return [];\n}\n\nexport default function Await(options) {\n  const tpl = options.template;\n\n  const success = extract(tpl, THEN, 'value');\n  const error = extract(tpl, CATCH, 'error');\n  const pending = extract(tpl, SECTION);\n  const undef = extract(tpl, ELSE);\n\n  const opts = assign({}, options, {\n    template: {\n      t: ELEMENT,\n      m: [\n        {\n          t: ATTRIBUTE,\n          n: 'for',\n          f: [{ t: INTERPOLATOR, r: tpl.r, rx: tpl.rx, x: tpl.x }]\n        }\n      ]\n    },\n    macro(handle, attrs) {\n      handle.aliasLocal('__await');\n\n      function update(attrs) {\n        if (attrs.for && isFunction(attrs.for.then)) {\n          handle.setTemplate(pending);\n\n          attrs.for.then(\n            v => {\n              handle.set('@local.value', v);\n              handle.setTemplate(success);\n            },\n            e => {\n              handle.set('@local.error', e);\n              handle.setTemplate(error);\n            }\n          );\n        } else if (isUndefined(attrs.for)) {\n          handle.setTemplate(undef);\n        } else {\n          handle.set('@local.value', attrs.for);\n          handle.setTemplate(success);\n        }\n      }\n\n      update(attrs);\n\n      return {\n        update\n      };\n    }\n  });\n\n  opts.macro.attributes = ['for'];\n\n  return new Partial(opts);\n}\n","import { TEXT } from 'config/types';\n\n// TODO all this code needs to die\nexport default function processItems(items, values, guid, counter = 0) {\n  return items\n    .map(item => {\n      if (item.type === TEXT) {\n        return item.template;\n      }\n\n      if (item.fragment) {\n        if (item.fragment.iterations) {\n          return item.fragment.iterations\n            .map(fragment => {\n              return processItems(fragment.items, values, guid, counter);\n            })\n            .join('');\n        } else {\n          return processItems(item.fragment.items, values, guid, counter);\n        }\n      }\n\n      const placeholderId = `${guid}-${counter++}`;\n      const model = item.model || item.newModel;\n\n      values[placeholderId] = model\n        ? model.wrapper\n          ? model.wrapperValue\n          : model.get()\n        : undefined;\n\n      return '${' + placeholderId + '}';\n    })\n    .join('');\n}\n","import { logIfDebug, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport { isArray } from 'utils/is';\nimport config from './config/config';\nimport Fragment from 'src/view/Fragment';\nimport hooks from 'src/events/Hook';\nimport Ractive from '../Ractive';\nimport subscribe from './helpers/subscribe';\n\nexport default function initialise(ractive, userOptions, options) {\n  // initialize settable computeds\n  const computed = ractive.viewmodel.computed;\n  if (computed) {\n    for (const k in computed) {\n      if (k in ractive.viewmodel.value && computed[k] && !computed[k].isReadonly) {\n        computed[k].set(ractive.viewmodel.value[k]);\n      }\n    }\n  }\n\n  // init config from Parent and options\n  config.init(ractive.constructor, ractive, userOptions);\n\n  // call any passed in plugins\n  if (isArray(userOptions.use))\n    ractive.use.apply(ractive, userOptions.use.filter(p => !p.construct));\n\n  hooks.config.fire(ractive);\n\n  hooks.init.begin(ractive);\n\n  const fragment = (ractive.fragment = createFragment(ractive, options));\n  if (fragment) fragment.bind(ractive.viewmodel);\n\n  hooks.init.end(ractive);\n\n  // general config done, set up observers\n  subscribe(ractive, userOptions, 'observe');\n\n  if (fragment) {\n    // render automatically ( if `el` is specified )\n    const el = (ractive.el = ractive.target = getElement(ractive.el || ractive.target));\n    if (el && !ractive.component) {\n      const promise = ractive.render(el, ractive.append);\n\n      if (Ractive.DEBUG_PROMISES) {\n        promise.catch(err => {\n          warnOnceIfDebug(\n            'Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;'\n          );\n          warnIfDebug('An error happened during rendering', { ractive });\n          logIfDebug(err);\n\n          throw err;\n        });\n      }\n    }\n  }\n}\n\nexport function createFragment(ractive, options = {}) {\n  if (ractive.template) {\n    const cssIds = [].concat(ractive.constructor._cssIds || [], options.cssIds || []);\n\n    return new Fragment({\n      owner: ractive,\n      template: ractive.template,\n      cssIds\n    });\n  }\n}\n","import { doc } from 'config/environment';\nimport { applyCSS } from 'src/global/css';\nimport hooks from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport { createFragment } from './initialise';\n\nexport default function render(ractive, target, anchor, occupants) {\n  // set a flag to let any transitions know that this instance is currently rendering\n  ractive.rendering = true;\n\n  const promise = runloop.start();\n  runloop.scheduleTask(() => hooks.render.fire(ractive), true);\n\n  if (ractive.fragment.rendered) {\n    throw new Error(\n      'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first'\n    );\n  }\n\n  if (ractive.destroyed) {\n    ractive.destroyed = false;\n    ractive.fragment = createFragment(ractive).bind(ractive.viewmodel);\n  }\n\n  anchor = getElement(anchor) || ractive.anchor;\n\n  ractive.el = ractive.target = target;\n  ractive.anchor = anchor;\n\n  // ensure encapsulated CSS is up-to-date\n  if (ractive.cssId) applyCSS();\n\n  if (target) {\n    (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(ractive);\n\n    if (anchor) {\n      const docFrag = doc.createDocumentFragment();\n      ractive.fragment.render(docFrag);\n      target.insertBefore(docFrag, anchor);\n    } else {\n      ractive.fragment.render(target, occupants);\n    }\n  }\n\n  runloop.end();\n  ractive.rendering = false;\n\n  return promise.then(() => {\n    if (ractive.torndown) return;\n\n    hooks.complete.fire(ractive);\n  });\n}\n","import { getElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport { warnIfDebug } from 'utils/log';\nimport render from '../render';\nimport { teardown } from 'shared/methodCallers';\n\nexport default function Ractive$render(target, anchor) {\n  if (this.torndown) {\n    warnIfDebug('ractive.render() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  target = getElement(target) || this.el;\n\n  if (!this.append && target) {\n    // Teardown any existing instances *before* trying to set up the new one -\n    // avoids certain weird bugs\n    const others = target.__ractive_instances__;\n    if (others) others.forEach(teardown);\n\n    // make sure we are the only occupants\n    if (!this.enhance) {\n      target.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n    }\n  }\n\n  const occupants = this.enhance ? toArray(target.childNodes) : null;\n  const promise = render(this, target, anchor, occupants);\n\n  if (occupants) {\n    while (occupants.length) target.removeChild(occupants.pop());\n  }\n\n  return promise;\n}\n","import runloop from 'src/global/runloop';\nimport { PARTIAL, COMPONENT, ELEMENT } from 'config/types';\nimport { isArray } from 'utils/is';\nimport { handleChange } from 'shared/methodCallers';\n\nfunction collect(source, name, attr, dest) {\n  source.forEach(item => {\n    // queue to rerender if the item is a partial and the current name matches\n    if (item.type === PARTIAL && (item.refName === name || item.name === name)) {\n      item.inAttribute = attr;\n      dest.push(item);\n      return; // go no further\n    }\n\n    // if it has a fragment, process its items\n    if (item.fragment) {\n      collect(item.fragment.iterations || item.fragment.items, name, attr, dest);\n    } else if (isArray(item.items)) {\n      // or if it is itself a fragment, process its items\n      collect(item.items, name, attr, dest);\n    } else if (item.type === COMPONENT && item.instance) {\n      // or if it is a component, step in and process its items\n      // ...unless the partial is shadowed\n      if (item.instance.partials[name]) return;\n      collect(item.instance.fragment.items, name, attr, dest);\n    }\n\n    // if the item is an element, process its attributes too\n    if (item.type === ELEMENT) {\n      if (isArray(item.attributes)) {\n        collect(item.attributes, name, true, dest);\n      }\n    }\n  });\n}\n\nexport default function(name, partial) {\n  const collection = [];\n  collect(this.fragment.items, name, false, collection);\n\n  const promise = runloop.start();\n\n  this.partials[name] = partial;\n  collection.forEach(handleChange);\n\n  runloop.end();\n\n  return promise;\n}\n","import { createDocumentFragment } from 'utils/dom';\nimport Fragment from 'src/view/Fragment';\nimport runloop from 'src/global/runloop';\nimport { default as templateConfigurator } from '../config/custom/template';\n\n// TODO should resetTemplate be asynchronous? i.e. should it be a case\n// of outro, update template, intro? I reckon probably not, since that\n// could be achieved with unrender-resetTemplate-render. Also, it should\n// conceptually be similar to resetPartial, which couldn't be async\n\nexport default function Ractive$resetTemplate(template) {\n  templateConfigurator.init(null, this, { template });\n\n  const transitionsEnabled = this.transitionsEnabled;\n  this.transitionsEnabled = false;\n\n  // Is this is a component, we need to set the `shouldDestroy`\n  // flag, otherwise it will assume by default that a parent node\n  // will be detached, and therefore it doesn't need to bother\n  // detaching its own nodes\n  const component = this.component;\n  if (component) component.shouldDestroy = true;\n  this.unrender();\n  if (component) component.shouldDestroy = false;\n\n  const promise = runloop.start();\n\n  // remove existing fragment and create new one\n  this.fragment.unbind().unrender(true);\n\n  this.fragment = new Fragment({\n    template: this.template,\n    root: this,\n    owner: this\n  });\n\n  const docFrag = createDocumentFragment();\n  this.fragment.bind(this.viewmodel).render(docFrag);\n\n  // if this is a component, its el may not be valid, so find a\n  // target based on the component container\n  if (component && !component.external) {\n    this.fragment.findParentNode().insertBefore(docFrag, component.findNextNode());\n  } else {\n    this.el.insertBefore(docFrag, this.anchor);\n  }\n\n  runloop.end();\n\n  this.transitionsEnabled = transitionsEnabled;\n\n  return promise;\n}\n","import { build, set } from 'shared/set';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$set(keypath, value, options) {\n  const ractive = this;\n\n  const opts = isObjectType(keypath) ? value : options;\n\n  return set(build(ractive, keypath, value, opts && opts.isolated), opts);\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$subtract(keypath, d, options) {\n  const num = isNumber(d) ? -d : -1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","export default function() {}\n","export function findInViewHierarchy(registryName, ractive, name) {\n  const instance = findInstance(registryName, ractive, name);\n  return instance ? instance[registryName][name] : null;\n}\n\nexport function findInstance(registryName, ractive, name) {\n  while (ractive) {\n    if (name in ractive[registryName]) {\n      return ractive;\n    }\n\n    if (ractive.isolated) {\n      return null;\n    }\n\n    ractive = ractive.parent;\n  }\n}\n","import { fatal } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport interpolators from '../Ractive/static/interpolators';\nimport { findInViewHierarchy } from './registry';\n\nexport default function interpolate(from, to, ractive, type) {\n  if (from === to) return null;\n\n  if (type) {\n    const interpol = findInViewHierarchy('interpolators', ractive, type);\n    if (interpol) return interpol(from, to) || null;\n\n    fatal(missingPlugin(type, 'interpolator'));\n  }\n\n  return (\n    interpolators.number(from, to) ||\n    interpolators.array(from, to) ||\n    interpolators.object(from, to) ||\n    null\n  );\n}\n","import { isArray, isString, isUndefined } from './is';\n\nexport function addToArray(array, value) {\n  const index = array.indexOf(value);\n\n  if (index === -1) {\n    array.push(value);\n  }\n}\n\nexport function arrayContains(array, value) {\n  for (let i = 0, c = array.length; i < c; i++) {\n    if (array[i] == value) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function arrayContentsMatch(a, b) {\n  let i;\n\n  if (!isArray(a) || !isArray(b)) {\n    return false;\n  }\n\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  i = a.length;\n  while (i--) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function ensureArray(x) {\n  if (isString(x)) {\n    return [x];\n  }\n\n  if (isUndefined(x)) {\n    return [];\n  }\n\n  return x;\n}\n\nexport function lastItem(array) {\n  return array[array.length - 1];\n}\n\nexport function removeFromArray(array, member) {\n  if (!array) {\n    return;\n  }\n\n  const index = array.indexOf(member);\n\n  if (index !== -1) {\n    array.splice(index, 1);\n  }\n}\n\nexport function combine(...arrays) {\n  const res = arrays.concat.apply([], arrays);\n  let i = res.length;\n  while (i--) {\n    const idx = res.indexOf(res[i]);\n    if (~idx && idx < i) res.splice(i, 1);\n  }\n\n  return res;\n}\n\nexport function toArray(arrayLike) {\n  const array = [];\n  let i = arrayLike.length;\n  while (i--) {\n    array[i] = arrayLike[i];\n  }\n\n  return array;\n}\n\nexport function findMap(array, fn) {\n  const len = array.length;\n  for (let i = 0; i < len; i++) {\n    const result = fn(array[i]);\n    if (result) return result;\n  }\n}\n\nexport function buildNewIndices(one, two, comparator) {\n  let oldArray = one;\n  let newArray = two;\n  if (comparator) {\n    oldArray = oldArray.map(comparator);\n    newArray = newArray.map(comparator);\n  }\n\n  const oldLength = oldArray.length;\n\n  const usedIndices = {};\n  let firstUnusedIndex = 0;\n\n  const result = oldArray.map(item => {\n    let index;\n    let start = firstUnusedIndex;\n\n    do {\n      index = newArray.indexOf(item, start);\n\n      if (index === -1) {\n        return -1;\n      }\n\n      start = index + 1;\n    } while (usedIndices[index] === true && start < oldLength);\n\n    // keep track of the first unused index, so we don't search\n    // the whole of newArray for each item in oldArray unnecessarily\n    if (index === firstUnusedIndex) {\n      firstUnusedIndex += 1;\n    }\n    // allow next instance of next \"equal\" to be found item\n    usedIndices[index] = true;\n    return index;\n  });\n\n  const len = (result.oldLen = oldArray.length);\n  result.newLen = newArray.length;\n\n  if (len === result.newLen) {\n    let i = 0;\n    for (i; i < len; i++) {\n      if (result[i] !== i) break;\n    }\n\n    if (i === len) result.same = true;\n  }\n\n  return result;\n}\n","export function bind(x) {\n  x.bind();\n}\nexport function cancel(x) {\n  x.cancel();\n}\nexport function destroyed(x) {\n  x.destroyed();\n}\nexport function handleChange(x) {\n  x.handleChange();\n}\nexport function mark(x) {\n  x.mark();\n}\nexport function markForce(x) {\n  x.mark(true);\n}\nexport function marked(x) {\n  x.marked();\n}\nexport function markedAll(x) {\n  x.markedAll();\n}\nexport function render(x) {\n  x.render();\n}\nexport function shuffled(x) {\n  x.shuffled();\n}\nexport function teardown(x) {\n  x.teardown();\n}\nexport function unbind(x) {\n  x.unbind();\n}\nexport function unrender(x) {\n  x.unrender();\n}\nexport function unrenderAndDestroy(x) {\n  x.unrender(true);\n}\nexport function update(x) {\n  x.update();\n}\nexport function toString(x) {\n  return x.toString();\n}\nexport function toEscapedString(x) {\n  return x.toString(true);\n}\n","import { splitKeypath } from './keypaths';\nimport { isString } from 'utils/is';\n\n// this is the dry method of checking to see if a rebind applies to\n// a particular keypath because in some cases, a dep may be bound\n// directly to a particular keypath e.g. foo.bars.0.baz and need\n// to avoid getting kicked to foo.bars.1.baz if foo.bars is unshifted\nexport function rebindMatch(template, next, previous, fragment) {\n  const keypath = template.r || template;\n\n  // no valid keypath, go with next\n  if (!keypath || !isString(keypath)) return next;\n\n  // completely contextual ref, go with next\n  if (\n    keypath === '.' ||\n    keypath[0] === '@' ||\n    (next || previous).isKey ||\n    (next || previous).isKeypath\n  )\n    return next;\n\n  const parts = keypath.split('/');\n  let keys = splitKeypath(parts[parts.length - 1]);\n  const last = keys[keys.length - 1];\n\n  // check the keypath against the model keypath to see if it matches\n  let model = next || previous;\n\n  // check to see if this was an alias\n  if (model && keys.length === 1 && last !== model.key && fragment) {\n    keys = findAlias(last, fragment) || keys;\n  }\n\n  let i = keys.length;\n  let match = true;\n  let shuffling = false;\n\n  while (model && i--) {\n    if (model.shuffling) shuffling = true;\n    // non-strict comparison to account for indices in keypaths\n    if (keys[i] != model.key) match = false;\n    model = model.parent;\n  }\n\n  // next is undefined, but keypath is shuffling and previous matches\n  if (!next && match && shuffling) return previous;\n  else if (next && !match && shuffling)\n    // next is defined, but doesn't match the keypath\n    return previous;\n  else return next;\n}\n\nfunction findAlias(name, fragment) {\n  while (fragment) {\n    const z = fragment.aliases;\n    if (z && z[name]) {\n      const aliases = (fragment.owner.iterations ? fragment.owner : fragment).owner.template.z;\n      for (let i = 0; i < aliases.length; i++) {\n        if (aliases[i].n === name) {\n          const alias = aliases[i].x;\n          if (!alias.r) return false;\n          const parts = alias.r.split('/');\n          return splitKeypath(parts[parts.length - 1]);\n        }\n      }\n      return;\n    }\n\n    fragment = fragment.componentParent || fragment.parent;\n  }\n}\n","export function fromExpression(body, length = 0) {\n  const args = new Array(length);\n\n  while (length--) {\n    args[length] = `_${length}`;\n  }\n\n  // Functions created directly with new Function() look like this:\n  //     function anonymous (_0 /**/) { return _0*2 }\n  //\n  // With this workaround, we get a little more compact:\n  //     function (_0){return _0*2}\n  return new Function([], `return function (${args.join(',')}){return(${body});};`)();\n}\n","import { fatal } from 'utils/log';\nimport bind from 'utils/bind';\nimport { createFunctionFromString } from '../config/runtime-parser';\nimport { isFunction, isString, isObjectType } from 'utils/is';\n\nexport default function getComputationSignature(ractive, key, signature) {\n  let getter;\n  let setter;\n\n  // useful for debugging\n  let getterString;\n  let getterUseStack;\n  let setterString;\n\n  if (isFunction(signature)) {\n    getter = bind(signature, ractive);\n    getterString = signature.toString();\n    getterUseStack = true;\n  }\n\n  if (isString(signature)) {\n    getter = createFunctionFromString(signature, ractive);\n    getterString = signature;\n  }\n\n  if (isObjectType(signature)) {\n    if (isString(signature.get)) {\n      getter = createFunctionFromString(signature.get, ractive);\n      getterString = signature.get;\n    } else if (isFunction(signature.get)) {\n      getter = bind(signature.get, ractive);\n      getterString = signature.get.toString();\n      getterUseStack = true;\n    } else {\n      fatal('`%s` computation must have a `get()` method', key);\n    }\n\n    if (isFunction(signature.set)) {\n      setter = bind(signature.set, ractive);\n      setterString = signature.set.toString();\n    }\n  }\n\n  return {\n    getter,\n    setter,\n    getterString,\n    setterString,\n    getterUseStack\n  };\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport SharedModel, {\n  GlobalModel,\n  SharedModel as ContextModel\n} from 'src/model/specials/SharedModel';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nfunction findContext(fragment) {\n  let frag = fragment;\n  while (frag && !frag.context && !frag.aliases) frag = frag.parent;\n  return frag;\n}\n\nexport default function resolveReference(fragment, ref) {\n  const initialFragment = fragment;\n  // current context ref\n  if (ref === '.') return fragment.findContext();\n\n  // ancestor references\n  if (ref[0] === '~') return fragment.ractive.viewmodel.joinAll(splitKeypath(ref.slice(2)));\n\n  // scoped references\n  if (ref[0] === '.' || ref[0] === '^') {\n    let frag = fragment;\n    const parts = ref.split('/');\n    const explicitContext = parts[0] === '^^';\n\n    // find nearest context node\n    while (frag && !frag.context) {\n      frag = up(frag);\n    }\n    let context = frag && frag.context;\n\n    // walk up the context chain\n    while (frag && parts[0] === '^^') {\n      parts.shift();\n\n      // the current fragment should always be a context,\n      // and if it happens to be an iteration, jump above the each block\n      if (frag.isIteration) {\n        frag = frag.parent.parent;\n      } else {\n        // otherwise jump above the current fragment\n        frag = up(frag);\n      }\n\n      // walk to the next contexted fragment\n      while (frag && !frag.context) {\n        frag = up(frag);\n      }\n      context = frag && frag.context;\n    }\n\n    if (!context && explicitContext) {\n      throw new Error(\n        `Invalid context parent reference ('${ref}'). There is not context at that level.`\n      );\n    }\n\n    // walk up the context path\n    while (parts[0] === '.' || parts[0] === '..') {\n      const part = parts.shift();\n\n      if (part === '..') {\n        context = context.parent;\n      }\n    }\n\n    ref = parts.join('/');\n\n    // special case - `{{.foo}}` means the same as `{{./foo}}`\n    if (ref[0] === '.') ref = ref.slice(1);\n    return context.joinAll(splitKeypath(ref));\n  }\n\n  const keys = splitKeypath(ref);\n  if (!keys.length) return;\n  const base = keys.shift();\n\n  // special refs\n  if (base[0] === '@') {\n    // shorthand from outside the template\n    // @this referring to local ractive instance\n    if (base === '@this' || base === '@') {\n      return fragment.ractive.viewmodel.getRactiveModel().joinAll(keys);\n    } else if (base === '@index' || base === '@key') {\n      // @index or @key referring to the nearest repeating index or key\n      if (keys.length) badReference(base);\n      const repeater = findIter(fragment);\n      return repeater && repeater[`get${base[1] === 'i' ? 'Index' : 'Key'}`]();\n    } else if (base === '@last') {\n      const repeater = findIter(fragment);\n      return repeater && repeater.parent.getLast();\n    } else if (base === '@global') {\n      // @global referring to window or global\n      return GlobalModel.joinAll(keys);\n    } else if (base === '@shared') {\n      // @global referring to window or global\n      return SharedModel.joinAll(keys);\n    } else if (base === '@keypath' || base === '@rootpath') {\n      // @keypath or @rootpath, the current keypath string\n      const root = ref[1] === 'r' ? fragment.ractive.root : null;\n      let f = fragment;\n\n      while (\n        f &&\n        (!f.context || (f.isRoot && f.ractive.component && (root || !f.ractive.isolated)))\n      ) {\n        f = f.isRoot ? f.componentParent : f.parent;\n      }\n\n      return f.getKeypath(root);\n    } else if (base === '@context') {\n      return new ContextModel(fragment.getContext(), 'context').joinAll(keys);\n    } else if (base === '@local') {\n      // @context-local data\n      return fragment.getContext()._data.joinAll(keys);\n    } else if (base === '@style') {\n      // @style shared model\n      return fragment.ractive.constructor._cssModel.joinAll(keys);\n    } else if (base === '@helpers') {\n      // @helpers instance model\n      return fragment.ractive.viewmodel.getHelpers().joinAll(keys);\n    } else if (base === '@macro') {\n      const handle = findMacro(fragment);\n      if (handle) return new ContextModel(handle, 'macro').joinAll(keys);\n      else return;\n    } else {\n      // nope\n      throw new Error(`Invalid special reference '${base}'`);\n    }\n  }\n\n  // helpers\n  if (base && !keys.length) {\n    const helpers = fragment.ractive.viewmodel.getHelpers();\n    if (helpers.has(base)) return helpers.joinKey(base);\n  }\n\n  let context = findContext(fragment);\n\n  // check immediate context for a match\n  if (context) {\n    if (context.context) {\n      context = context.context;\n    } else {\n      // alias block, so get next full context for later\n      context = fragment.findContext();\n    }\n  } else {\n    context = fragment.findContext();\n  }\n\n  // walk up the fragment hierarchy looking for a matching ref, alias, or key in a context\n  let createMapping = false;\n  const shouldWarn = fragment.ractive.warnAboutAmbiguity;\n  let crossed = 0;\n  let model;\n\n  while (fragment) {\n    // repeated fragments\n    if (fragment.isIteration) {\n      if (base === fragment.parent.keyRef) {\n        model = fragment.getKey();\n      } else if (base === fragment.parent.indexRef) {\n        model = fragment.getIndex();\n      }\n\n      if (model && keys.length) badReference(base);\n    }\n\n    // alias node or iteration\n    if (!model && fragment.aliases && hasOwn(fragment.aliases, base)) {\n      model = fragment.aliases[base];\n    }\n\n    // check fragment context to see if it has the key we need\n    if (!model && fragment.context && fragment.context.has(base)) {\n      model = fragment.context.joinKey(base);\n\n      // this is an implicit mapping\n      if (createMapping) {\n        if (shouldWarn)\n          warnIfDebug(\n            `'${ref}' resolved but is ambiguous and will create a mapping to a parent component.`\n          );\n      } else if (shouldWarn && crossed) warnIfDebug(`'${ref}' resolved but is ambiguous.`);\n    }\n\n    if (model) {\n      if (createMapping) {\n        model = initialFragment.ractive.viewmodel.createLink(base, model, base, { implicit: true });\n      }\n\n      if (keys.length > 0 && isFunction(model.joinAll)) {\n        model = model.joinAll(keys);\n      }\n\n      return model;\n    }\n\n    // don't consider alias blocks when checking for ambiguity\n    if (fragment.context && !fragment.aliases) crossed = 1;\n\n    if (\n      !fragment.ractive.isolated &&\n      !(fragment.owner && fragment.owner.containerFragment) &&\n      (fragment.componentParent || (!fragment.parent && fragment.ractive.component))\n    ) {\n      // ascend through component boundary\n      fragment = fragment.componentParent || fragment.ractive.component.up;\n      createMapping = true;\n    } else {\n      fragment = fragment.parent;\n    }\n  }\n\n  // if enabled, check the instance for a match\n  const instance = initialFragment.ractive;\n  if (instance.resolveInstanceMembers && base !== 'data' && base in instance) {\n    return instance.viewmodel\n      .getRactiveModel()\n      .joinKey(base)\n      .joinAll(keys);\n  }\n\n  if (shouldWarn) {\n    warnIfDebug(`'${ref}' is ambiguous and did not resolve.`);\n  }\n\n  // didn't find anything, so go ahead and create the key on the local model\n  return context.joinKey(base).joinAll(keys);\n}\n\nfunction up(fragment) {\n  return (\n    fragment &&\n    ((!fragment.ractive.isolated &&\n      !(fragment.owner && fragment.owner.containerFragment) &&\n      (fragment.componentParent || (!fragment.parent && fragment.ractive.component))) ||\n      fragment.parent)\n  );\n}\n\nfunction findIter(start) {\n  let fragment = start;\n  let next;\n  while (!fragment.isIteration && (next = up(fragment))) {\n    fragment = next;\n  }\n\n  return fragment.isIteration && fragment;\n}\n\nfunction findMacro(start) {\n  let fragment = start;\n  while (fragment) {\n    if (fragment.owner.handle) return fragment.owner.handle;\n    fragment = up(fragment);\n  }\n}\n\nfunction badReference(key) {\n  throw new Error(`An index or key reference (${key}) cannot have child properties`);\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$add(keypath, d, options) {\n  const num = isNumber(d) ? d : 1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","export function enqueue(ractive, event) {\n  if (ractive.event) {\n    ractive._eventQueue.push(ractive.event);\n  }\n\n  ractive.event = event;\n}\n\nexport function dequeue(ractive) {\n  if (ractive._eventQueue.length) {\n    ractive.event = ractive._eventQueue.pop();\n  } else {\n    ractive.event = null;\n  }\n}\n","export function findAnchors(fragment, name = null) {\n  const res = [];\n\n  findAnchorsIn(fragment, name, res, fragment.ractive);\n\n  return res;\n}\n\nfunction findAnchorsIn(item, name, result, instance) {\n  if (item.isAnchor) {\n    if (!name || item.name === name) {\n      result.push(item);\n    }\n  } else if (item.items) {\n    item.items.forEach(i => findAnchorsIn(i, name, result, instance));\n  } else if (item.iterations) {\n    item.iterations.forEach(i => findAnchorsIn(i, name, result, instance));\n  } else if (item.fragment && (!item.component || item.fragment.ractive === instance)) {\n    findAnchorsIn(item.fragment, name, result, instance);\n  } else if (item.instance && item.instance.fragment) {\n    const anchors = [];\n    findAnchorsIn(item.instance.fragment, name, anchors, instance);\n    anchors.forEach(a => a.ractive === instance && result.push(a));\n  }\n}\n\nexport function updateAnchors(instance, name = null) {\n  const anchors = findAnchors(instance.fragment, name);\n  const idxs = {};\n  const children = instance._children.byName;\n\n  anchors.forEach(a => {\n    const name = a.name;\n    if (!(name in idxs)) idxs[name] = 0;\n    const idx = idxs[name];\n    const child = (children[name] || [])[idx];\n\n    if (child && child.lastBound !== a) {\n      if (child.lastBound) child.lastBound.removeChild(child);\n      a.addChild(child);\n    }\n\n    idxs[name]++;\n  });\n}\n\nexport function unrenderChild(meta) {\n  if (meta.instance.fragment.rendered) {\n    meta.shouldDestroy = true;\n    meta.instance.unrender();\n  }\n  meta.instance.el = null;\n}\n","import hooks from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { unrenderChild, updateAnchors } from 'shared/anchors';\n\nexport default function attachChild(child, options = {}) {\n  const children = this._children;\n  let idx;\n\n  if (child.parent && child.parent !== this)\n    throw new Error(\n      `Instance ${child._guid} is already attached to a different instance ${\n        child.parent._guid\n      }. Please detach it from the other instance using detachChild first.`\n    );\n  else if (child.parent)\n    throw new Error(`Instance ${child._guid} is already attached to this instance.`);\n\n  const meta = {\n    instance: child,\n    ractive: this,\n    name: options.name || child.constructor.name || 'Ractive',\n    target: options.target || false,\n    bubble,\n    findNextNode\n  };\n  meta.nameOption = options.name;\n\n  // child is managing itself\n  if (!meta.target) {\n    meta.up = this.fragment;\n    meta.external = true;\n  } else {\n    let list;\n    if (!(list = children.byName[meta.target])) {\n      list = [];\n      this.set(`@this.children.byName.${meta.target}`, list);\n    }\n    idx = options.prepend ? 0 : options.insertAt !== undefined ? options.insertAt : list.length;\n  }\n\n  child.parent = this;\n  child.root = this.root;\n  child.component = meta;\n  children.push(meta);\n\n  const promise = runloop.start();\n\n  const rm = child.viewmodel.getRactiveModel();\n  rm.joinKey('parent', { lastLink: false }).link(this.viewmodel.getRactiveModel());\n  rm.joinKey('root', { lastLink: false }).link(this.root.viewmodel.getRactiveModel());\n\n  hooks.attachchild.fire(child);\n\n  if (meta.target) {\n    unrenderChild(meta);\n    this.splice(`@this.children.byName.${meta.target}`, idx, 0, meta);\n    updateAnchors(this, meta.target);\n  } else {\n    if (!child.isolated) child.viewmodel.attached(this.fragment);\n  }\n\n  runloop.end();\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n\nfunction bubble() {\n  runloop.addFragment(this.instance.fragment);\n}\n\nfunction findNextNode() {\n  if (this.anchor) return this.anchor.findNextNode();\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport { isString, isFunction } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport { fireShuffleTasks } from 'src/model/ModelBase';\n\nexport function compute(path, computed) {\n  this.computed[path] = computed;\n  if (isString(computed) || isFunction(computed))\n    computed = this.computed[path] = { get: computed };\n\n  const keys = splitKeypath(path);\n  if (!~path.indexOf('*')) {\n    const last = keys.pop();\n    return this.viewmodel.joinAll(keys).compute(last, computed);\n  } else {\n    computed.pattern = new RegExp(\n      '^' +\n        keys\n          .map(k => k.replace(/\\*\\*/g, '(.+)').replace(/\\*/g, '((?:\\\\\\\\.|[^\\\\.])+)'))\n          .join('\\\\.') +\n        '$'\n    );\n  }\n}\n\nexport default function Ractive$compute(path, computed) {\n  const promise = runloop.start();\n  const comp = compute.call(this, path, computed);\n\n  if (comp) {\n    const keys = splitKeypath(path);\n    if (keys.length === 1 && !comp.isReadonly) {\n      comp.set(this.viewmodel.value[keys[0]]);\n    }\n\n    const first = keys.reduce((a, c) => a && a.childByKey[c], this.viewmodel);\n    if (first) {\n      first.rebind(comp, first, false);\n      if (first.parent) delete first.parent.childByKey[first.key];\n      fireShuffleTasks();\n    }\n  }\n\n  runloop.end();\n\n  return promise;\n}\n","import hooks from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\n\nexport default function Ractive$detach() {\n  if (this.isDetached) {\n    return this.el;\n  }\n\n  if (this.el) {\n    removeFromArray(this.el.__ractive_instances__, this);\n  }\n\n  this.el = this.fragment.detach();\n  this.isDetached = true;\n\n  hooks.detach.fire(this);\n  return this.el;\n}\n","import hooks from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\n\nexport default function detachChild(child) {\n  const children = this._children;\n  let meta, index;\n\n  let i = children.length;\n  while (i--) {\n    if (children[i].instance === child) {\n      index = i;\n      meta = children[i];\n      break;\n    }\n  }\n\n  if (!meta || child.parent !== this)\n    throw new Error(`Instance ${child._guid} is not attached to this instance.`);\n\n  const promise = runloop.start();\n\n  if (meta.anchor) meta.anchor.removeChild(meta);\n  if (!child.isolated) child.viewmodel.detached();\n\n  children.splice(index, 1);\n  if (meta.target) {\n    this.splice(\n      `@this.children.byName.${meta.target}`,\n      children.byName[meta.target].indexOf(meta),\n      1\n    );\n    updateAnchors(this, meta.target);\n  }\n  const rm = child.viewmodel.getRactiveModel();\n  rm.joinKey('parent', { lastLink: false }).unlink();\n  rm.joinKey('root', { lastLink: false }).link(rm);\n  child.root = child;\n  child.parent = null;\n  child.component = null;\n\n  hooks.detachchild.fire(child);\n\n  runloop.end();\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n","export default function Ractive$find(selector, options = {}) {\n  if (!this.rendered)\n    throw new Error(\n      `Cannot call ractive.find('${selector}') unless instance is rendered to the DOM`\n    );\n\n  let node = this.fragment.find(selector, options);\n  if (node) return node;\n\n  if (options.remote) {\n    for (let i = 0; i < this._children.length; i++) {\n      if (!this._children[i].instance.fragment.rendered) continue;\n      node = this._children[i].instance.find(selector, options);\n      if (node) return node;\n    }\n  }\n}\n","import { isArray } from 'utils/is';\n\nexport default function Ractive$findAll(selector, options = {}) {\n  if (!this.rendered)\n    throw new Error(\n      `Cannot call ractive.findAll('${selector}', ...) unless instance is rendered to the DOM`\n    );\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAll(selector, options);\n\n  if (options.remote) {\n    // seach non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        c.instance.findAll(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isArray, isObjectType } from 'utils/is';\n\nexport default function Ractive$findAllComponents(selector, options) {\n  if (!options && isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  options = options || {};\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAllComponents(selector, options);\n\n  if (options.remote) {\n    // search non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        if (!selector || c.name === selector) {\n          options.result.push(c.instance);\n        }\n\n        c.instance.findAllComponents(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isObjectType } from 'utils/is';\n\nexport default function Ractive$findComponent(selector, options = {}) {\n  if (isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  let child = this.fragment.findComponent(selector, options);\n  if (child) return child;\n\n  if (options.remote) {\n    if (!selector && this._children.length) return this._children[0].instance;\n    for (let i = 0; i < this._children.length; i++) {\n      // skip children that are or should be in an anchor\n      if (this._children[i].target) continue;\n      if (this._children[i].name === selector) return this._children[i].instance;\n      child = this._children[i].instance.findComponent(selector, options);\n      if (child) return child;\n    }\n  }\n}\n","export default function Ractive$findContainer(selector) {\n  if (this.container) {\n    if (this.container.component && this.container.component.name === selector) {\n      return this.container;\n    } else {\n      return this.container.findContainer(selector);\n    }\n  }\n\n  return null;\n}\n","export default function Ractive$findParent(selector) {\n  if (this.parent) {\n    if (this.parent.component && this.parent.component.name === selector) {\n      return this.parent;\n    } else {\n      return this.parent.findParent(selector);\n    }\n  }\n\n  return null;\n}\n","import { ANCHOR, COMPONENT, ELEMENT } from 'config/types';\n\nexport default function findElement(start, orComponent = true, name) {\n  while (\n    start &&\n    (start.type !== ELEMENT || (name && start.name !== name)) &&\n    (!orComponent || (start.type !== COMPONENT && start.type !== ANCHOR))\n  ) {\n    // start is a fragment - look at the owner\n    if (start.owner) start = start.owner;\n    else if (start.component || start.yield)\n      // start is a component or yielder - look at the container\n      start = start.containerFragment || start.component.up;\n    else if (start.parent)\n      // start is an item - look at the parent\n      start = start.parent;\n    else if (start.up)\n      // start is an item without a parent - look at the parent fragment\n      start = start.up;\n    else start = undefined;\n  }\n\n  return start;\n}\n","import { isNumber, isUndefined } from 'utils/is';\n\n// This function takes an array, the name of a mutator method, and the\n// arguments to call that mutator method with, and returns an array that\n// maps the old indices to their new indices.\n\n// So if you had something like this...\n//\n//     array = [ 'a', 'b', 'c', 'd' ];\n//     array.push( 'e' );\n//\n// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n// have changed. If you then did this...\n//\n//     array.unshift( 'z' );\n//\n// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n// one higher to make room for the 'z'. If you removed an item, the new index\n// would be -1...\n//\n//     array.splice( 2, 2 );\n//\n// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n//\n// This information is used to enable fast, non-destructive shuffling of list\n// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\nexport default function getNewIndices(length, methodName, args) {\n  const newIndices = [];\n\n  const spliceArguments = getSpliceEquivalent(length, methodName, args);\n\n  if (!spliceArguments) {\n    return null; // TODO support reverse and sort?\n  }\n\n  const balance = spliceArguments.length - 2 - spliceArguments[1];\n\n  const removeStart = Math.min(length, spliceArguments[0]);\n  const removeEnd = removeStart + spliceArguments[1];\n  newIndices.startIndex = removeStart;\n\n  let i;\n  for (i = 0; i < removeStart; i += 1) {\n    newIndices.push(i);\n  }\n\n  for (; i < removeEnd; i += 1) {\n    newIndices.push(-1);\n  }\n\n  for (; i < length; i += 1) {\n    newIndices.push(i + balance);\n  }\n\n  // there is a net shift for the rest of the array starting with index + balance\n  if (balance !== 0) {\n    newIndices.touchedFrom = spliceArguments[0];\n  } else {\n    newIndices.touchedFrom = length;\n  }\n\n  return newIndices;\n}\n\n// The pop, push, shift an unshift methods can all be represented\n// as an equivalent splice\nfunction getSpliceEquivalent(length, methodName, args) {\n  switch (methodName) {\n    case 'splice':\n      if (args[0] !== undefined && args[0] < 0) {\n        args[0] = length + Math.max(args[0], -length);\n      }\n\n      if (isUndefined(args[0])) args[0] = 0;\n\n      while (args.length < 2) {\n        args.push(length - args[0]);\n      }\n\n      if (!isNumber(args[1])) {\n        args[1] = length - args[0];\n      }\n\n      // ensure we only remove elements that exist\n      args[1] = Math.min(args[1], length - args[0]);\n\n      return args;\n\n    case 'sort':\n    case 'reverse':\n      return null;\n\n    case 'pop':\n      if (length) {\n        return [length - 1, 1];\n      }\n      return [0, 0];\n\n    case 'push':\n      return [length, 0].concat(args);\n\n    case 'shift':\n      return [0, length ? 1 : 0];\n\n    case 'unshift':\n      return [0, 0].concat(args);\n  }\n}\n","import hooks from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isString } from 'utils/is';\n\nexport function update(ractive, model, options) {\n  // if the parent is wrapped, the adaptor will need to be updated before\n  // updating on this keypath\n  if (model.parent && model.parent.wrapper) {\n    model.parent.adapt();\n  }\n\n  const promise = runloop.start();\n\n  model.mark(options && options.force);\n\n  // notify upstream of changes\n  model.notifyUpstream();\n\n  runloop.end();\n\n  hooks.update.fire(ractive, model);\n\n  return promise;\n}\n\nexport default function Ractive$update(keypath, options) {\n  let opts, path;\n\n  if (isString(keypath)) {\n    path = splitKeypath(keypath);\n    opts = options;\n  } else {\n    opts = keypath;\n  }\n\n  return update(this, path ? this.viewmodel.joinAll(path) : this.viewmodel, opts);\n}\n","import fireEvent from 'src/events/fireEvent';\nimport Context from 'shared/Context';\nimport { assign, create } from 'utils/object';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$fire(eventName, ...args) {\n  let ctx;\n\n  // watch for reproxy\n  if (args[0] instanceof Context) {\n    const proto = args.shift();\n    ctx = create(proto);\n    assign(ctx, proto);\n  } else if (isObjectType(args[0]) && (args[0] === null || args[0].constructor === Object)) {\n    ctx = Context.forRactive(this, args.shift());\n  } else {\n    ctx = Context.forRactive(this);\n  }\n\n  return fireEvent(this, eventName, ctx, args);\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport { FakeFragment } from 'shared/getRactiveContext';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$get(keypath, opts) {\n  if (!isString(keypath)) return this.viewmodel.get(true, keypath);\n\n  const keys = splitKeypath(keypath);\n  const key = keys[0];\n\n  let model;\n\n  if (!this.viewmodel.has(key)) {\n    // if this is an inline component, we may need to create\n    // an implicit mapping\n    if (this.component && !this.isolated) {\n      model = resolveReference(this.fragment || new FakeFragment(this), key);\n    }\n  }\n\n  model = this.viewmodel.joinAll(keys);\n  return model.get(true, opts);\n}\n","import { localFragment } from '../../shared/Context';\nexport default function getLocalContext() {\n  if (localFragment.f) return localFragment.f.getContext();\n}\n","import staticContext from '../static/getContext';\nimport getRactiveContext from 'src/shared/getRactiveContext';\nimport { isString } from 'utils/is';\n\nexport default function getContext(node, options) {\n  if (!node) return getRactiveContext(this);\n\n  if (isString(node)) {\n    node = this.find(node, options);\n  }\n\n  return staticContext(node);\n}\n","import hooks from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\n\nexport default function Ractive$insert(target, anchor) {\n  if (!this.fragment.rendered) {\n    // TODO create, and link to, documentation explaining this\n    throw new Error(\n      'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.'\n    );\n  }\n\n  target = getElement(target);\n  anchor = getElement(anchor) || null;\n\n  if (!target) {\n    throw new Error('You must specify a valid target to insert into');\n  }\n\n  target.insertBefore(this.detach(), anchor);\n  this.el = target;\n\n  (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(this);\n  this.isDetached = false;\n\n  fireInsertHook(this);\n}\n\nfunction fireInsertHook(ractive) {\n  hooks.insert.fire(ractive);\n\n  ractive.findAllComponents('*').forEach(child => {\n    fireInsertHook(child.instance);\n  });\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from 'src/global/runloop';\n\nexport default function link(there, here, options) {\n  let model;\n  const target = (options && (options.ractive || options.instance)) || this;\n\n  // may need to allow a mapping to resolve implicitly\n  const sourcePath = splitKeypath(there);\n  if (!target.viewmodel.has(sourcePath[0]) && target.component) {\n    model = resolveReference(target.component.up, sourcePath[0]);\n    model = model.joinAll(sourcePath.slice(1));\n  }\n\n  const src = model || target.viewmodel.joinAll(sourcePath);\n  const dest = this.viewmodel.joinAll(splitKeypath(here), { lastLink: false });\n\n  if (isUpstream(src, dest) || isUpstream(dest, src)) {\n    throw new Error('A keypath cannot be linked to itself.');\n  }\n\n  const promise = runloop.start();\n\n  dest.link(src, (options && options.keypath) || there);\n\n  runloop.end();\n\n  return promise;\n}\n\nfunction isUpstream(check, start) {\n  let model = start;\n  while (model) {\n    if (model === check || model.owner === check) return true;\n    model = model.target || model.parent;\n  }\n}\n","import { escapeKey, splitKeypath as splitKeypathI, unescapeKey } from 'shared/keypaths';\n\nexport function joinKeys(...keys) {\n  return keys.map(escapeKey).join('.');\n}\n\nexport function splitKeypath(keypath) {\n  return splitKeypathI(keypath).map(unescapeKey);\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport Observer from './observe/Observer';\nimport PatternObserver from './observe/Pattern';\nimport ArrayObserver from './observe/Array';\nimport { keys } from 'utils/object';\n\nexport default function observe(keypath, callback, options) {\n  const observers = [];\n  let map;\n  let opts;\n\n  if (isObject(keypath)) {\n    map = keypath;\n    opts = callback || {};\n  } else {\n    if (isFunction(keypath)) {\n      map = { '': keypath };\n      opts = callback || {};\n    } else {\n      map = {};\n      map[keypath] = callback;\n      opts = options || {};\n    }\n  }\n\n  let silent = false;\n  keys(map).forEach(keypath => {\n    const callback = map[keypath];\n    const caller = function(...args) {\n      if (silent) return;\n      return callback.apply(this, args);\n    };\n\n    let keypaths = keypath.split(' ');\n    if (keypaths.length > 1) keypaths = keypaths.filter(k => k);\n\n    keypaths.forEach(keypath => {\n      opts.keypath = keypath;\n      const observer = createObserver(this, keypath, caller, opts);\n      if (observer) observers.push(observer);\n    });\n  });\n\n  // add observers to the Ractive instance, so they can be\n  // cancelled on ractive.teardown()\n  this._observers.push.apply(this._observers, observers);\n\n  return {\n    cancel: () => observers.forEach(o => o.cancel()),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n\nfunction createObserver(ractive, keypath, callback, options) {\n  const keys = splitKeypath(keypath);\n  let wildcardIndex = keys.indexOf('*');\n  if (!~wildcardIndex) wildcardIndex = keys.indexOf('**');\n\n  options.fragment = options.fragment || ractive.fragment;\n\n  let model;\n  if (!options.fragment) {\n    model = ractive.viewmodel.joinKey(keys[0]);\n  } else {\n    // .*.whatever relative wildcard is a special case because splitkeypath doesn't handle the leading .\n    if (~keys[0].indexOf('.*')) {\n      model = options.fragment.findContext();\n      wildcardIndex = 0;\n      keys[0] = keys[0].slice(1);\n    } else {\n      model =\n        wildcardIndex === 0\n          ? options.fragment.findContext()\n          : resolveReference(options.fragment, keys[0]);\n    }\n  }\n\n  // the model may not exist key\n  if (!model) model = ractive.viewmodel.joinKey(keys[0]);\n\n  if (!~wildcardIndex) {\n    model = model.joinAll(keys.slice(1));\n    if (options.array) {\n      return new ArrayObserver(ractive, model, callback, options);\n    } else {\n      return new Observer(ractive, model, callback, options);\n    }\n  } else {\n    const double = keys.indexOf('**');\n    if (~double) {\n      if (double + 1 !== keys.length || ~keys.indexOf('*')) {\n        warnOnceIfDebug(\n          `Recursive observers may only specify a single '**' at the end of the path.`\n        );\n        return;\n      }\n    }\n\n    model = model.joinAll(keys.slice(1, wildcardIndex));\n\n    return new PatternObserver(ractive, model, keys.slice(wildcardIndex), callback, options);\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\n\nexport default function Ractive$off(eventName, callback) {\n  // if no event is specified, remove _all_ event listeners\n  if (!eventName) {\n    this._subs = {};\n  } else {\n    // Handle multiple space-separated event names\n    const eventNames = eventName\n      .split(' ')\n      .map(trim)\n      .filter(notEmptyString);\n\n    eventNames.forEach(event => {\n      const subs = this._subs[event];\n      // if given a specific callback to remove, remove only it\n      if (subs && callback) {\n        const entry = subs.find(s => s.callback === callback);\n        if (entry) {\n          removeFromArray(subs, entry);\n          entry.off = true;\n\n          if (event.indexOf('.')) this._nsSubs--;\n        }\n      } else if (subs) {\n        // otherwise, remove all listeners for this event\n        if (event.indexOf('.')) this._nsSubs -= subs.length;\n        subs.length = 0;\n      }\n    });\n  }\n\n  return this;\n}\n","import trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\nimport { hasOwn } from 'utils/object';\nimport { isObjectType, isString } from 'utils/is';\n\nexport default function Ractive$on(eventName, callback) {\n  // eventName may already be a map\n  const map = isObjectType(eventName) ? eventName : {};\n  // or it may be a string along with a callback\n  if (isString(eventName)) map[eventName] = callback;\n\n  let silent = false;\n  const events = [];\n\n  for (const k in map) {\n    const callback = map[k];\n    const caller = function(...args) {\n      if (!silent) return callback.apply(this, args);\n    };\n    const entry = {\n      callback,\n      handler: caller\n    };\n\n    if (hasOwn(map, k)) {\n      const names = k\n        .split(' ')\n        .map(trim)\n        .filter(notEmptyString);\n      names.forEach(n => {\n        (this._subs[n] || (this._subs[n] = [])).push(entry);\n        if (n.indexOf('.')) this._nsSubs++;\n        events.push([n, entry]);\n      });\n    }\n  }\n\n  return {\n    cancel: () => events.forEach(e => this.off(e[0], e[1].callback)),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n","export default function Ractive$once(eventName, handler) {\n  const listener = this.on(eventName, function() {\n    handler.apply(this, arguments);\n    listener.cancel();\n  });\n\n  // so we can still do listener.cancel() manually\n  return listener;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function readLink(keypath, options = {}) {\n  const path = splitKeypath(keypath);\n\n  if (this.viewmodel.has(path[0])) {\n    let model = this.viewmodel.joinAll(path);\n\n    if (!model.isLink) return;\n\n    while ((model = model.target) && options.canonical !== false) {\n      if (!model.isLink) break;\n    }\n\n    if (model) return { ractive: model.root.ractive, keypath: model.getKeypath() };\n  }\n}\n","function s4() {\n  return Math.floor((1 + Math.random()) * 0x10000)\n    .toString(16)\n    .substring(1);\n}\n\nexport function uuid() {\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\n","import { applyCSS } from '../../global/css';\nimport transformCSS from '../config/custom/css/transform';\nimport { evalCSS } from '../config/custom/css/css';\nimport { build, set } from '../../shared/set';\nimport runloop from '../../global/runloop';\nimport { isObjectType, isFunction } from 'utils/is';\n\nexport default function setCSSData(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = this._cssModel;\n\n  model.locked = true;\n  const promise = set(build({ viewmodel: model }, keypath, value, true), opts);\n  model.locked = false;\n\n  const cascade = runloop.start();\n  this.extensions.forEach(e => {\n    const model = e._cssModel;\n    model.mark();\n    model.downstreamChanged('', 1);\n  });\n  runloop.end();\n\n  applyChanges(this, !opts || opts.apply !== false);\n\n  return promise.then(() => cascade);\n}\n\nexport function applyChanges(component, apply) {\n  const local = recomputeCSS(component);\n  const child = component.extensions\n    .map(e => applyChanges(e, false))\n    .reduce((a, c) => c || a, false);\n\n  if (apply && (local || child)) {\n    const def = component._cssDef;\n    if (!def || (def && def.applied)) applyCSS(true);\n  }\n\n  return local || child;\n}\n\nexport function recomputeCSS(component) {\n  const css = component.css;\n\n  if (!isFunction(css)) return;\n\n  const def = component._cssDef;\n  const result = evalCSS(component, css);\n  const styles = def.transform ? transformCSS(result, def.id) : result;\n\n  if (def.styles === styles) return;\n\n  def.styles = styles;\n\n  return true;\n}\n"],"names":["this","nodes","splice","i","n","target","removeChild","slice","occupants","length","anchor","const","frag","createDocumentFragment","forEach","appendChild","insertBefore","rendered","Triple__proto__","toString","let","value","model","get","inAttribute","decodeCharacterReferences","unrender","node","runloop","detachWhenReady","detach","detachNode","update","dirty","render","up","findParentNode","findNextNode","Mustache","constructors","ALIAS","Section","ANCHOR","Component","AWAIT","Await","DOCTYPE","Doctype","INTERPOLATOR","Interpolator","PARTIAL","Partial","SECTION","TRIPLE","Triple","YIELDER","ATTRIBUTE","Attribute","BINDING_FLAG","BindingFlag","DECORATOR","Decorator","EVENT","EventDirective","TRANSITION","Transition","COMMENT","Comment","specialElements","doctype","form","Form","input","Input","option","Option","select","Select","textarea","Textarea","Fragment","options","owner","isRoot","parent","ractive","componentParent","component","containerFragment","delegate","context","cssIds","dirtyValue","template","createItems","Fragment__proto__","prototype","bind","z","aliases","resolveAliases","len","items","bound","bubble","addFragment","index","max","this$1","createItem","destroyed","pathModel","rootModel","docFrag","xs","find","selector","findMap","findAll","findComponent","name","findAllComponents","findContext","base","findParentWithContext","viewmodel","item","it","firstNode","fragment","type","ELEMENT","el","Error","skipParent","getKey","keyModel","KeyModel","key","getIndex","idxModel","rebind","next","rebound","k","unreference","x","applyValue","getKeypath","root","resetTemplate","wasBound","wasRendered","unbind","parentNode","shuffled","escape","map","toEscapedString","join","view","yielder","shouldDestroy","updating","addFragmentToRoot","valueOf","values","source","processItems","_guid","parsed","parseJSON","getContext","shouldRerender","reverse","makeArrayMethod","path","shift","sort","unshift","proto","add","animate","attachChild","compute","detachChild","findContainer","findParent","fire","getLocalContext","insert","link","observe","observeOnce","off","on","once","pop","push","readLink","reset","resetPartial","set","subtract","teardown","toggle","toCSS","toCss","toHTML","toHtml","toText","transition","unlink","updateModel","use","styles","callsSuper","defineProperties","Ractive","sharedGet","sharedSet","styleGet","configurable","styleSet","addCSS","addStyle","hasCSS","hasStyle","win","opts","script","document","currentScript","querySelector","getAttribute","indexOf","warn","assign","defaults","constructor","DEBUG","writable","DEBUG_PROMISES","extend","extendWith","escapeKey","evalObjectString","findPlugin","getCSS","isInstance","joinKeys","macro","normaliseKeypath","normalise","parse","splitKeypath","unescapeKey","enhance","svg","tick","batch","promise","VERSION","adaptors","components","decorators","easing","events","extensions","helpers","interpolators","partials","transitions","cssData","perComponentStyleElements","splitTag","sharedData","Context","extern","defineProperty","CSSModel","attrValue","Element","leadingWhitespace","ParseError","message","e","stack","Parser","str","lineStart","pos","lines","split","lineEnds","line","lineEnd","init","read","leftover","remaining","result","postProcess","converters","getContextMessage","ref","getLinePos","lineNum","columnNum","contextLines","contextUp","contextDown","start","replace","numTabs","annotation","match","char","Array","error","msg","character","shortMessage","matchString","string","substr","matchPattern","pattern","exec","sp","substring","nextChar","charAt","warnIfDebug","Parent","Child","call","create","hasOwn","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","singleMatcher","makeQuotedStringMatcher","doubleMatcher","numberPattern","identifier","specials","true","false","null","undefined","specialsPattern","RegExp","keys","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","JsonParser","test","v","parser","placeholder","special","number","stringLiteral","readStringLiteral","$1","pair","getKeyValuePair","valueToken","Mapping","Item","super","element","findElement","attributeByName","f","Mapping__proto__","instance","joinKey","isString","isArray","createMapping","boundFragment","resolve","joinAll","mapping","unregister","a","isUndefined","Option__proto__","selectedAttribute","selected","attributes","_ractive","attribute","getValue","isSelected","optionValue","selectValue","compare","removeFromArray","MustacheContainer","container","r","rx","refName","fn","partialFromValue","partial","warnOnceIfDebug","createFragment","initMacro","handleChange","dirtyTemplate","externalChange","_attrs","refreshAttrs","handle","proxy","last","fnTemplate","isFunction","getPartialTemplate","contextifyTemplate","unbindAttrs","scheduleTask","_cssDef","applied","applyCSS","dirtyAttrs","invalidate","extras","isReadonly","isKey","deps","links","children","KeyModel__proto__","c","upstream","unregisterChild","shouldCapture","capture","has","previous","relinking","register","dependant","registerChild","child","addToArray","registerLink","unregisterLink","reference","noop","keypathString","RepeatedFragment","findDelegate","iterations","indexRef","keyRef","pendingNewIndices","previousIterations","RepeatedFragment__proto__","shuffler","s","shuffleValues","isComputed","createIteration","isObject","refs","ks","bubbled","rebounding","isIteration","swizzleFragment","iteration","getLast","lastModel","contextFor","shuffle","newIndices","merge","newIndex","oldIndex","shouldRebind","updatePostShuffle","buildNewIndices","same","toRemove","oldKeys","wasArray","lastValue","i$1","newLength","updateLast","fragment$1","nextNode","indices","idx","dest","prev","iters","stash","isObjectType","plen","isAlias","t","sectionType","SECTION_WITH","templateSectionType","subordinate","l","Section__proto__","sibling","nextSibling","SECTION_UNLESS","isTruthy","detached","SECTION_IF_WITH","isEmpty","safe","SECTION_IF","SECTION_EACH","siblingFalsey","lastType","getType","newFragment","fragmentShouldExist","attach","keep","then","Select__proto__","foundNode","binding","selectedOptions","getSelectedOptions","sync","defaultSelected","selectNode","toArray","o","setFromNode","isMultiple","array","optionWasSelected","shouldSelect","valueContains","forceUpdate","comparator","deferContent","isBindable","Textarea__proto__","Text","TEXT","Text__proto__","inAttributes","progressiveText","escapeHtml","visible","hidden","doc","prefix","vendors","vendor","addEventListener","onChange","onHide","onShow","isClient","prefixCache","testStyle","createElement","style","prop","hyphenateCamel","createTransitions","prefix$1","vendorPattern","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","linear","canUseCssTransitions","cannotUseCssTransitions","webkitTransition","to","changedProperties","setTimeout","transitionDone","clearTimeout","cssTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","unregisterCompleteHandler","isIntro","transitionEndHandler","event","propertyName","cssTransitionsDone","property","duration","timing","removeEventListener","hashPrefix","namespaceURI","tagName","delay","registerCompleteHandler","easingName","hyphenate","cssTiming","hash","suffix","interpolator","originalValue","propertiesToTransitionInJs","initial","getStyle","interpolate","parseFloat","missingPlugin","Ticker","step","complete","createTransitions$1","getComputedStyle","resolved","Promise","names","t0","t1","t2","onComplete","Transition__proto__","animateStyle","arguments","setStyle","fulfil","propertyNames","computedStyle","current","originals","targets","intro","outro","eventName","params","_fn","findInViewHierarchy","setupArgsFn","getParams","resolveArgs","apply","props","processParams","isNumber","shouldFire","transitionsEnabled","rendering","nearestProp","unrendering","nested","starting","completed","args","noReset","_manager","remove","concat","unbinding","ieBug","ieBlacklist","elementCache","innerHTML","err","TABLE","THEAD","TBODY","TR","SELECT","nodeType","matches","queryResult","queryAllResult","querySelectorAll","html","insertHtml","outerHTML","nodeValue","setDependencies","dependencies","Computation__proto__","mark","signature","setter","computed","Model","Computation","ComputationChild","shared","ExpressionProxy","allowExpressions","getFunction","models","resolveReference","ExpressionProxy__proto__","actuallyChanged","keypath","startCapturing","m","stopCapturing","filter","d","notifyUpstream","rebindMatch","addShuffleRegister","retrieve","collect","dep","computation","missingDecorator","Decorator__proto__","warnOnce","localFragment","teardownArgsFn","Doctype__proto__","Binding","twowayBinding","setRoot","isTwoway","wasUndefined","getInitialValue","lastVal","parentForm","resetValue","formBindings","Binding__proto__","registerTwowayBinding","locked","end","setting","unregisterTwowayBinding","CheckboxBinding","CheckboxBinding__proto__","handleDomEvent","attachEvent","checked","BindingGroup","bindings","BindingGroup__proto__","b","CheckboxNameBinding","checkboxName","group","getBindingGroup","noInitialValue","existingValue","bindingValue","arrayContains","CheckboxNameBinding__proto__","isChecked","mval","valueSoFar","ContentEditableBinding","ContentEditableBinding__proto__","lazy","GenericBinding","GenericBinding__proto__","timeout","isNumeric","handler","handleDelay","handleBlur","FileBinding","FileBinding__proto__","files","MultipleSelectBinding","MultipleSelectBinding__proto__","selectedValues","previousValue","arrayContentsMatch","NumericBinding","NumericBinding__proto__","isNaN","siblings","RadioBinding","getSiblings","RadioBinding__proto__","RadioNameBinding","pathChanged","updateName","RadioNameBinding__proto__","SingleSelectBinding","SingleSelectBinding__proto__","disabled","endsWithSemi","ContainerItem","toLowerCase","attrs","attr","val","cls","leftovers","g","statics","DELEGATE_FLAG","ConditionalAttribute","Element__proto__","recreateTwowayBinding","createTwowayBinding","twoway","selectBinding","assigns","ctx","callback","listeners","delegateHandler","rem","namespace","getNamespace","existing","nodeName","toUpperCase","setAttribute","isOutro","registerTransition","childNodes","removeAttribute","ls","stringifyAttribute","safeAttributeString","inputIsCheckedRadio","getString","inlineClass","voidElements","stop","immediate","prevent","UIEvent","Form__proto__","handleReset","DOMEvent","fatal","DOMEvent__proto__","directive","original","CustomEvent","eventPlugin","CustomEvent__proto__","RactiveEvent","RactiveEvent__proto__","cancel","specialPattern","dollarArgsPattern","EventDirective__proto__","COMPONENT","rs","action","refire","specialRef","specialMatch","dollarMatch","obj","which","wrapper","wrapperValue","oldEvent","returned","preventDefault","stopPropagation","fireEvent","ReferenceExpressionProxy","LinkModel","rootLink","ReferenceExpressionProxy__proto__","members","Missing","addShuffleTask","tpl","REFERENCE","reduce","list","String","fireShuffleTasks","refreshPathDeps","eproto","isStatic","Mustache__proto__","pre","y","Object","Interpolator__proto__","safeToStringValue","data","Input__proto__","defaultValue","build","Context__proto__","modelShift","findModel","drop","modelSplice","modelSort","num","here","_link","unlisten","modelUnshift","protoUpdate","cascade","updateFromBindings","isBound","getBindingModel","getBindingPath","getBinding","setBinding","prototypeAccessors","forRactive","getRactiveContext","div","methodNames","unprefixed","prefixed","j","makeFunction","query","mathml","xlink","xml","xmlns","namespaces","customStr","ns","is","createElementNS","wrap","methodName","cloneNode","Observer","old","oldContext","oldFn","dispatch","updateOld","Observer__proto__","cancelled","resolver","_observers","newValue","oldValue","isEqual","strict","addObserver","defer","star","PatternObserver","baseModel","baseKeypath","recursive","oldValues","newValues","changed","cache","findMatches","registerPatternObserver","PatternObserver__proto__","unregisterPatternObserver","wildcards","notify","touchedFrom","count","isLink","ok","check","ArrayObserver","pending","sliced","ArrayObserver__proto__","negativeOne","inserted","deleted","hadIndex","onceOptions","trim","notEmptyString","PREFIX","styleDefinitions","isDirty","styleElement","useCssText","_splitTag","adaptConfigurator","adapt","combine","ensureArray","selectorsPattern","importPattern","importEndPattern","keyframesDeclarationPattern","selectorUnitPattern","excludePattern","dataRvcGuidPattern","SharedModel","CSSModel__proto__","downstreamChanged","depth","_cssModel","applyChanges","hasCurly","cssConfigurator","_cssIds","gatherIds","css","initCSS","dataConfigurator","_r_unbound","TEMPLATE_VERSION","templateConfigurator","parseTemplate","getDynamicTemplate","_config","p","extendPartials","registryNames","registriesOnDefaults","Registry","useDefaults","Registry__proto__","configure","registry","addFunctions","isOwner","registries","putInDefaults","config","order","custom","defaultKeys","isStandardKey","makeObj","isBlacklisted","_super","booleanAttributes","allowfullscreen","async","autofocus","autoplay","compact","controls","declare","default","defaultchecked","defaultmuted","defaultselected","enabled","formnovalidate","indeterminate","inert","ismap","itemscope","loop","multiple","muted","nohref","noresize","noshade","novalidate","nowrap","open","pauseonexit","readonly","required","reversed","scoped","seamless","sortable","translate","truespeed","typemustmatch","area","br","col","command","embed","hr","img","keygen","meta","param","track","wbr","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","codePointSupport","fromCodePoint","codeToChar","fromCharCode","lessThan","greaterThan","invalid","Item__proto__","ContainerItem__proto__","space","textTypes","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","maxlength","pubdate","rowspan","tabindex","usemap","ConditionalAttribute__proto__","isSvg","parseAttributes","notIn","updateDelegate","Attribute__proto__","useProperty","isBoolean","lookupNamespace","getUpdateDelegate","flag","bubbler","BindingFlag__proto__","createComment","RactiveModel","RactiveModel__proto__","initLink","specialModels","@this","getRactiveModel","@global","GlobalModel","@shared","@style","@helpers","getHelpers","RootModel","RootModel__proto__","attached","attachImplicits","createLink","targetPath","childByKey","detachImplicits","virtual","getVirtual","SharedBase","ractiveModel","getValueChildren","unescapedKey","shouldTeardown","protoRegistries","uid","ComponentConstructor","isAnchor","content","_partials","addChild","construct","mappings","_inlinePartials","eventHandlers","Component__proto__","initialise","checking","checkAnchors","callRender","isolated","unrenderItem","syncComputedChildren","prototypeAccessors$1","ComputationChild__proto__","parentValue","newWrapperValue","unwrap","boundValue","marked","prototypeAccessors$2","active","maybeBind","shouldBind","noVirtual","getter","hasConsole","console","groupCollapsed","sig","getterUseStack","groupEnd","gather","Ractive$toCSS","cssId","uniqueCssIds","ids","id","Ractive$toHTML","Ractive$transition","HTMLElement","lastLink","Ractive$unrender","hooks","__ractive_instances__","Ractive$updateModel","plugins","object","buildCSS","transform","recomputeCSS","extendOne","Class","Target","_on","toPairs","_observe","optional","TypeError","sourcesLength","sources","nextSource","nextKey","hasOwnProperty","thisArg","arrayLength","window","Node","contains","performance","now","nowOffset","Date","global","implementation","hasFeature","PENDING","FULFILLED","REJECTED","dispatchHandlers","fulfilledHandlers","rejectedHandlers","state","makeResolver","newState","makeDispatcher","wait","fulfill","reject","onFulfilled","onRejected","promise2","processResolutionHandler","handlers","forward","p1result","catch","finally","all","promises","processPromise","race","fail","reason","called","resolvePromise","rejectPromise","requestAnimationFrame","cancelAnimationFrame","lastTime","currentTime","timeToNextCall","Math","log","printWarning","welcome","append","delimiters","tripleDelimiters","staticDelimiters","staticTripleDelimiters","csp","preserveWhitespace","preserveStandaloneSections","sanitize","stripComments","resolveInstanceMembers","warnAboutAmbiguity","noIntro","noOutro","nestedTransitions","noCSSTransform","easeIn","pow","easeOut","easeInOut","alreadyWarned","welcomeIntro","welcomeMessage","WELCOME_MESSAGE","hasGroup","badArguments","noRegistryFunctionReturn","from","intermediate","min","properties","refPattern","splitPattern","escapeKeyPattern","unescapeKeyPattern","fnBind","Function","shuffleTasks","early","registerQueue","ModelBase","ModelBase__proto__","task","stage","existingMatches","objectKeys","isObjectLike","startPath","patterns","notifiedUpstream","dataModel","checkDataLink","observer","oneway","findBoundValue","captureGroup","shufle","sourcePath","LinkModel__proto__","isDetached","force","markedAll","relinked","shuffling","lnk","implicit","ln","functions","parseOptions","TEMPLATE_INSTRUCTIONS","COMPUTATION_INSTRUCTIONS","fromId","noThrow","getElementById","textContent","isParsed","getParseOptions","throwNoParse","parseFor","TransitionManager","intros","outros","totalChildren","outroChildren","detachQueue","outrosComplete","TransitionManager__proto__","checkStart","started","decrementOutros","decrementTotal","detachNodes","ready","detachImmediate","fulfilPromise","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","flushChanges","thing","postRender","_batch","tickers","running","Ticker__proto__","elapsed","eased","abort","prefixers","ticker","Model__proto__","rewrap","createBranch","adaptor","getPrefixer","__model","getComputationSignature","branch","markForce","recreateArray","unsafe","SharedModel__proto__","SharedModel$1","FakeFragment","deepOpts","comparators","errorMessage","initStars","bubbleStars","Hook","method","arg","HookQueue","hook","inProcess","queue","HookQueue__proto__","begin","getChildQueue","NUMBER_LITERAL","STRING_LITERAL","ELSE","THEN","CATCH","arrayProto","modelPush","modelPop","modelReverse","ContextData","ContextData__proto__","_data","protoAnimate","getParent","hasListener","findEvent","there","listen","raise","ev","childValue","validate","parentIsFn","emptyData","childIsFn","callDataFunction","fromProperties","primary","secondary","parseAsString","existingPartials","newPartials","overwrite","superMethod","getSuperMethod","_parent","hasSuper","oldSuper","_method","getMessage","deprecated","correct","isError","deprecateOption","deprecatedOption","deprecate","extendOtherMethods","member","RactiveProto","wrapPrototype","entity","code","parseInt","validateCode","camelCaseStr","readStyle","cleanCss","reconstruct","rule","rules","readClass","updateMultipleSelectValue","updateSelectValue","updateStringValue","updateContentEditableValue","updateRadioValue","updateValue","updateRadioName","updateCheckboxName","updateStyleAttribute","updateInlineStyle","updateClassName","updateInlineClass","updateBoolean","updateNamespacedAttribute","updateAttribute","wasSelected","selectedIndex","wasChecked","safeValue","valueAttribute","setProperty","getPropertyValue","className","baseVal","getAttributeNS","removeAttributeNS","setAttributeNS","haystack","needle","qualified","hasAttribute","Ractive$teardown","torndown","getPromise","destruct","_marking","mdl","subscribe","subs","single","initialiseProperties","handleAttributes","onconstruct","_attributePartial","getAdaptors","protoAdapt","lookup","srcs","_subs","_nsSubs","_eventQueue","_children","byName","mapAll","nameOption","renderItem","lastBound","updateAnchors","res","isBindableByValue","isBindableByContentEditable","isContentEditable","isBindableByName","isBindableByChecked","nameAttr","stopImmediatePropagation","currentTarget","endEl","prevented","oldStop","oldImmediate","oldPrevent","correspondingUseElement","stopImmediaitePropagation","text","splitText","createTextNode","okQuote","literal","done","charCodeAt","JSON","quote","readNumberLiteral","readKey","token","namePattern","childData","getPartialFromRegistry","fillGaps","findParentPartial","findInstance","findOwner","findConstructor","self","okToParse","parsePartial","setTemplate","initing","aliasLocal","findFirstNode","out","section","hasIndexRef","selectedOption","firstChild","getComponentConstructor","asyncProxy","cmp","extract","success","undef","ctor","guid","counter","placeholderId","newModel","userOptions","getElement","logIfDebug","Ractive$render","others","Ractive$reset","rerender","changes","collection","Ractive$resetTemplate","external","Ractive$set","Ractive$subtract","Ractive$toggle","pairs","isFinite","isDate","format","registryName","interpol","arrays","arrayLike","one","two","oldArray","newArray","oldLength","usedIndices","firstUnusedIndex","oldLen","newLen","isKeypath","parts","findAlias","alias","fromExpression","body","createFunction","exp","instructions","createFunctionFromString","bindTo","expression","getterString","setterString","tm","allOutrosComplete","notifiedTotal","manager","collectAllOutros","trans","nqueue","_list","prefixKeypath","rootKeypath","rootDot","relativeKeypath","initialFragment","explicitContext","badReference","repeater","findIter","ContextModel","findMacro","shouldWarn","crossed","_fakeFragment","deep","deepSet","getComparator","sets","Ractive$add","getOptions","Ractive$animate","enqueue","dequeue","variants","eventNames","fireEventAs","initialFire","notifySubscribers","fullName","subscribers","originalEvent","stopEvent","hookQueue","childQueue","findAnchors","findAnchorsIn","anchors","idxs","unrenderChild","prepend","insertAt","rm","attachchild","Ractive$compute","comp","first","Ractive$detach","detachchild","Ractive$find","remote","Ractive$findAll","Ractive$findAllComponents","Ractive$findComponent","Ractive$findContainer","Ractive$findParent","orComponent","getNewIndices","spliceArguments","getSpliceEquivalent","balance","removeStart","removeEnd","startIndex","Ractive$update","Ractive$fire","Ractive$get","instances","staticContext","output","Ractive$insert","fireInsertHook","src","isUpstream","fresh","splitKeypathI","vals","olds","observers","silent","caller","keypaths","createObserver","isSilenced","silence","resume","wildcardIndex","double","Ractive$off","entry","Ractive$on","Ractive$once","listener","canonical","styleDefinition","styleSheet","cssText","filteredStyleDefinitions","makeStyle","getElementsByTagName","additionalReplaceRules","extractString","unit","transformSelector","selectorUnits","modifiers","transformed","appended","prepended","transformCss","dataAttr","selectors","s4","floor","random","uuid","setCSSData","local","def","evalCSS","transformCSS","__proto__","cssProp","noCssTransform"],"mappings":"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"}